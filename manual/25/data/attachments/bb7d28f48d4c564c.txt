[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_node_not_connected_directly_to_relaying_node with id: 2025-01-30_11-41-38__0b123229-92c1-4a81-b15d-e8b5685c02b2
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-30_11-41-38__0b123229-92c1-4a81-b15d-e8b5685c02b2__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2025-01-30_11-41-38__0b123229-92c1-4a81-b15d-e8b5685c02b2__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2025-01-30_11-41-38__0b123229-92c1-4a81-b15d-e8b5685c02b2__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:33 Network waku created
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.204.119
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['18157', '18158', '18159', '18160', '18161']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 18157:18157 -p 18158:18158 -p 18159:18159 -p 18160:18160 -p 18161:18161 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18159 --rest-port=18157 --tcp-port=18158 --discv5-udp-port=18160 --rest-address=0.0.0.0 --nat=extip:172.18.204.119 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=46ee06cbe96a61ccb4996c7d0a8e5d9baf76a2c9b107bfb33f2bc97dfbcda258 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18161 --metrics-logging=true --filter=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.204.119 waku 434daf57755923888abd5571c258269abeb32b4f619e37ce71636acd97cad448
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 434daf577559. Setting up logs at ./log/docker/node1_2025-01-30_11-41-38__0b123229-92c1-4a81-b15d-e8b5685c02b2__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 18157
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18157/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18157/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.204.119/tcp/18158/p2p/16Uiu2HAm2JtG9s62Ds2jyX4RSApKqAjLDDZuvQdgKt6KX9Neg4E8","/ip4/172.18.204.119/tcp/18159/ws/p2p/16Uiu2HAm2JtG9s62Ds2jyX4RSApKqAjLDDZuvQdgKt6KX9Neg4E8"],"enrUri":"enr:-L24QKQibtip25W6XVsS4qi9ifiXJ8lZVR_seSo1K0e2CKTuVDt1fk48kOcnhfNu1KW8_v8z5_vuDWEjZcJUfZZGLoYCgmlkgnY0gmlwhKwSzHeKbXVsdGlhZGRyc5YACASsEsx3BkbuAAoErBLMdwZG790DgnJzhQADAQAAiXNlY3AyNTZrMaECZkShVPqL6ZCNPzLyobW-o5rqIpL8hCO1pKlSlwYwPO2DdGNwgkbug3VkcIJG8IV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.125.78
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3950', '3951', '3952', '3953', '3954']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3950:3950 -p 3951:3951 -p 3952:3952 -p 3953:3953 -p 3954:3954 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3952 --rest-port=3950 --tcp-port=3951 --discv5-udp-port=3953 --rest-address=0.0.0.0 --nat=extip:172.18.125.78 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=07f5e2a3cdabdaacaec6792d53f50049dadd07fe0af464f4934de892d2bffc81 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3954 --metrics-logging=true --filter=true --relay=true --discv5-bootstrap-node=enr:-L24QKQibtip25W6XVsS4qi9ifiXJ8lZVR_seSo1K0e2CKTuVDt1fk48kOcnhfNu1KW8_v8z5_vuDWEjZcJUfZZGLoYCgmlkgnY0gmlwhKwSzHeKbXVsdGlhZGRyc5YACASsEsx3BkbuAAoErBLMdwZG790DgnJzhQADAQAAiXNlY3AyNTZrMaECZkShVPqL6ZCNPzLyobW-o5rqIpL8hCO1pKlSlwYwPO2DdGNwgkbug3VkcIJG8IV3YWt1MgU
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.125.78 waku 0b69075b1d0f849d64ad92abecbd36a99a1ed1b7cc79bddff0ae159d2f029771
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0b69075b1d0f. Setting up logs at ./log/docker/node2_2025-01-30_11-41-38__0b123229-92c1-4a81-b15d-e8b5685c02b2__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 3950
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3950/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3950/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.125.78/tcp/3951/p2p/16Uiu2HAmVCpNYRDxAmmsJseyz2Rx5G1TH2jbKUuXNCPYz5ZUZ4ot","/ip4/172.18.125.78/tcp/3952/ws/p2p/16Uiu2HAmVCpNYRDxAmmsJseyz2Rx5G1TH2jbKUuXNCPYz5ZUZ4ot"],"enrUri":"enr:-L24QGG5GutQuIIRMMSHziiLkFLwJRIEEWnK58GHfdnA-Ox3R7jMn1HubCNhEQGDQKk6R_S-DyvVwVj36Mb3OQSZBsUCgmlkgnY0gmlwhKwSfU6KbXVsdGlhZGRyc5YACASsEn1OBg9vAAoErBJ9TgYPcN0DgnJzhQADAQAAiXNlY3AyNTZrMaED9eJLSdwFk-o09mXauIwHvVf88FHKNzdm49Zrjw8pajuDdGNwgg9vg3VkcIIPcYV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.20.29
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['45763', '45764', '45765', '45766', '45767']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 45763:45763 -p 45764:45764 -p 45765:45765 -p 45766:45766 -p 45767:45767 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45765 --rest-port=45763 --tcp-port=45764 --discv5-udp-port=45766 --rest-address=0.0.0.0 --nat=extip:172.18.20.29 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ffe220b8e6cadc5c4a70f1bce4efb89dfebbe8fcbc5be001a7bbeadab057e70a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45767 --metrics-logging=true --relay=false --filternode=/ip4/172.18.125.78/tcp/3951/p2p/16Uiu2HAmVCpNYRDxAmmsJseyz2Rx5G1TH2jbKUuXNCPYz5ZUZ4ot --discv5-bootstrap-node=enr:-L24QGG5GutQuIIRMMSHziiLkFLwJRIEEWnK58GHfdnA-Ox3R7jMn1HubCNhEQGDQKk6R_S-DyvVwVj36Mb3OQSZBsUCgmlkgnY0gmlwhKwSfU6KbXVsdGlhZGRyc5YACASsEn1OBg9vAAoErBJ9TgYPcN0DgnJzhQADAQAAiXNlY3AyNTZrMaED9eJLSdwFk-o09mXauIwHvVf88FHKNzdm49Zrjw8pajuDdGNwgg9vg3VkcIIPcYV3YWt1MgU
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.20.29 waku 2255a65f500d7ae19be4a75fbc5a3618cfc421ac117946ae832b001afc04d0b2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2255a65f500d. Setting up logs at ./log/docker/node3_2025-01-30_11-41-38__0b123229-92c1-4a81-b15d-e8b5685c02b2__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 45763
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45763/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45763/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.20.29/tcp/45764/p2p/16Uiu2HAmFw6ZvDAx3B3Ux8MABaXd3xQUAUdKza6NXcopQJc6Thy1","/ip4/172.18.20.29/tcp/45765/ws/p2p/16Uiu2HAmFw6ZvDAx3B3Ux8MABaXd3xQUAUdKza6NXcopQJc6Thy1"],"enrUri":"enr:-L24QIrgAh5be9Qq1dgLXg4OTEYD-XBxAGkertFCNvWrb4vmOK1rm2LnLAfZWqwoZvgtAo5X9xI9dueLLTABkzFHivsCgmlkgnY0gmlwhKwSFB2KbXVsdGlhZGRyc5YACASsEhQdBrLEAAoErBIUHQayxd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDMLNiVp6Yj-MAWjShZqmAqMcbcPprM76dGOjq9VP121CDdGNwgrLEg3VkcIKyxoV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18157/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3950/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45763/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18157/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.125.78/tcp/3951/p2p/16Uiu2HAmVCpNYRDxAmmsJseyz2Rx5G1TH2jbKUuXNCPYz5ZUZ4ot","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/filter-subscribe/2.0.0-beta1","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3950/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.204.119/tcp/18158/p2p/16Uiu2HAm2JtG9s62Ds2jyX4RSApKqAjLDDZuvQdgKt6KX9Neg4E8","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/filter-subscribe/2.0.0-beta1","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"},{"multiaddr":"/ip4/172.18.20.29/tcp/45764/p2p/16Uiu2HAmFw6ZvDAx3B3Ux8MABaXd3xQUAUdKza6NXcopQJc6Thy1","protocols":[{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45763/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.125.78/tcp/3951/p2p/16Uiu2HAmVCpNYRDxAmmsJseyz2Rx5G1TH2jbKUuXNCPYz5ZUZ4ot","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/filter-subscribe/2.0.0-beta1","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 30 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18157/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:quay.io/wakuorg/nwaku-pr:3234 can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45763/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738237336188023040,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 434daf577559
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 0b69075b1d0f
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 434daf577559. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 2255a65f500d
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 0b69075b1d0f. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.