[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-09-13_10-24-56__f7dbef49-1417-49cd-9b99-5d264ac13aaf
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3036
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-13_10-24-56__f7dbef49-1417-49cd-9b99-5d264ac13aaf__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.6.77
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['50836', '50837', '50838', '50839', '50840']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 50836:50836 -p 50837:50837 -p 50838:50838 -p 50839:50839 -p 50840:50840 quay.io/wakuorg/nwaku-pr:3036 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50838 --rest-port=50836 --tcp-port=50837 --discv5-udp-port=50839 --rest-address=0.0.0.0 --nat=extip:172.18.6.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=adc5ced3a34b4eaf96ff681791a10961abfd68efd8c80ec78cd53e543cda6a16 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50840 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.6.77 waku a13a2535f5f4dc8ef9bdc14f78a5d6cb9587ba16fe87e6310e9fa4541525edbf
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID a13a2535f5f4. Setting up logs at ./log/docker/receiving_node1_2024-09-13_10-24-56__f7dbef49-1417-49cd-9b99-5d264ac13aaf__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image quay.io/wakuorg/nwaku-pr:3036. REST: 50836
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50836/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50836/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.6.77/tcp/50837/p2p/16Uiu2HAm75VfoFu289jCmJ5vJGA6TfqxXYdGAp5VBHd9HwTT8XFg","/ip4/172.18.6.77/tcp/50838/ws/p2p/16Uiu2HAm75VfoFu289jCmJ5vJGA6TfqxXYdGAp5VBHd9HwTT8XFg"],"enrUri":"enr:-LO4QA7ZNpTj7347bE00IirLARSFJjVHIoyVNE4gjkLpM_XeGlg_u301DEq9W7ZAShkPasofxRhZQ-fr_n493G35INcBgmlkgnY0gmlwhKwSBk2KbXVsdGlhZGRyc4wACgSsEgZNBsaW3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKtIPgV8c--j88FmFtvTkRAsn7OTlMjpn76ap2IAhWkA4N0Y3CCxpWDdWRwgsaXhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3036
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-13_10-24-56__f7dbef49-1417-49cd-9b99-5d264ac13aaf__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.117.0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['26155', '26156', '26157', '26158', '26159']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 26155:26155 -p 26156:26156 -p 26157:26157 -p 26158:26158 -p 26159:26159 quay.io/wakuorg/nwaku-pr:3036 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26157 --rest-port=26155 --tcp-port=26156 --discv5-udp-port=26158 --rest-address=0.0.0.0 --nat=extip:172.18.117.0 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=07cc4ebc355f5bbd9bdab544bf3d7efafbe9ec8ada3bc5c9a4a11aae270a183a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26159 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.117.0 waku 9eba1b72fdefb84dd7b7b8c1c1e2c45fcf18df4b3d8fb31c78780611ca454cbb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9eba1b72fdef. Setting up logs at ./log/docker/receiving_node2_2024-09-13_10-24-56__f7dbef49-1417-49cd-9b99-5d264ac13aaf__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image quay.io/wakuorg/nwaku-pr:3036. REST: 26155
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26155/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26155/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.117.0/tcp/26156/p2p/16Uiu2HAm8bsJ8LLgt5ZizCwZN2bi2sDpj6M3hmBLKdiYCRjksvqi","/ip4/172.18.117.0/tcp/26157/ws/p2p/16Uiu2HAm8bsJ8LLgt5ZizCwZN2bi2sDpj6M3hmBLKdiYCRjksvqi"],"enrUri":"enr:-LO4QOq5FtT9jfjkdyToTzvZ3tCMi17pBD4BOPWx9wpm4V8ETg6Wa5E7u6GYKPhWFwJ39ip_zcMitExRSSQHE0_TEgwBgmlkgnY0gmlwhKwSdQCKbXVsdGlhZGRyc4wACgSsEnUABmYt3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLDxIiFgkUf40NByRHJZCRTvuBQzH4_v-ZTxDmfVIa_vYN0Y3CCZiyDdWRwgmYuhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26155/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.6.77/tcp/50837/p2p/16Uiu2HAm75VfoFu289jCmJ5vJGA6TfqxXYdGAp5VBHd9HwTT8XFg"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-13_10-24-56__f7dbef49-1417-49cd-9b99-5d264ac13aaf__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.222.33
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['16035', '16036', '16037', '16038', '16039']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 16035:16035 -p 16036:16036 -p 16037:16037 -p 16038:16038 -p 16039:16039 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=16037 --rest-port=16035 --tcp-port=16036 --discv5-udp-port=16038 --rest-address=0.0.0.0 --nat=extip:172.18.222.33 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=368eb6edd45a8f47c8be87cfe8e970bbc81cfd1cf0d338ac2c4a2fab5ed3c0ad --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-LO4QA7ZNpTj7347bE00IirLARSFJjVHIoyVNE4gjkLpM_XeGlg_u301DEq9W7ZAShkPasofxRhZQ-fr_n493G35INcBgmlkgnY0gmlwhKwSBk2KbXVsdGlhZGRyc4wACgSsEgZNBsaW3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKtIPgV8c--j88FmFtvTkRAsn7OTlMjpn76ap2IAhWkA4N0Y3CCxpWDdWRwgsaXhXdha3UyCQ --lightpushnode=/ip4/172.18.6.77/tcp/50837/p2p/16Uiu2HAm75VfoFu289jCmJ5vJGA6TfqxXYdGAp5VBHd9HwTT8XFg --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.222.33 waku b797c1aa1335704bba52aeaa72c021eeb0ec127ce6eadef7ebbca4fd3ddc07b6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID b797c1aa1335. Setting up logs at ./log/docker/lightpush_node1_2024-09-13_10-24-56__f7dbef49-1417-49cd-9b99-5d264ac13aaf__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/go-waku:latest. REST: 16035
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16035/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QOOsJjBZ0OQbbSWlJ5yV7AO-Cus7TbU21UuPoyHydTfJU3VCTZAlr5VTMCTTrF-HOrxwvbqLNbQW7KEXJMhEnWaGAZHq6i2QgmlkgnY0gmlwhKwRAASJc2VjcDI1NmsxoQJoTd5ds73y0sGcruRgJjeKMeQwiXR5FDPSy1zZDHUzYIN0Y3CCPqSDdWRwgj6mhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/16036/p2p/16Uiu2HAm2SqFLREKs5xEBFLnWaTYScEpAaYhsbTnzXzMYsKcYz5m","/ip4/127.0.0.1/tcp/16037/ws/p2p/16Uiu2HAm2SqFLREKs5xEBFLnWaTYScEpAaYhsbTnzXzMYsKcYz5m","/ip4/172.17.0.4/tcp/16036/p2p/16Uiu2HAm2SqFLREKs5xEBFLnWaTYScEpAaYhsbTnzXzMYsKcYz5m","/ip4/172.17.0.4/tcp/16037/ws/p2p/16Uiu2HAm2SqFLREKs5xEBFLnWaTYScEpAaYhsbTnzXzMYsKcYz5m"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16035/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.6.77/tcp/50837/p2p/16Uiu2HAm75VfoFu289jCmJ5vJGA6TfqxXYdGAp5VBHd9HwTT8XFg", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16035/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.117.0/tcp/26156/p2p/16Uiu2HAm8bsJ8LLgt5ZizCwZN2bi2sDpj6M3hmBLKdiYCRjksvqi", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50836/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26155/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16035/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726223102448019200, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:quay.io/wakuorg/nwaku-pr:3036 can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50836/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726223102448019200,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:quay.io/wakuorg/nwaku-pr:3036 can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26155/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726223102448019200,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16035/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726223102609299200, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:quay.io/wakuorg/nwaku-pr:3036 can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50836/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726223102609299200,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:quay.io/wakuorg/nwaku-pr:3036 can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26155/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726223102609299200,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a13a2535f5f4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9eba1b72fdef
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b797c1aa1335
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.