[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2025-01-23_11-39-33__7e63a8f0-857c-4c7a-9b87-925509667588
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image harbor.status.im/wakuorg/nwaku:test-debug-flag
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-23_11-39-33__7e63a8f0-857c-4c7a-9b87-925509667588__harbor.status.im_wakuorg_nwaku:test-debug-flag.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image harbor.status.im/wakuorg/nwaku:test-debug-flag
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2025-01-23_11-39-33__7e63a8f0-857c-4c7a-9b87-925509667588__harbor.status.im_wakuorg_nwaku:test-debug-flag.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image harbor.status.im/wakuorg/nwaku:test-debug-flag
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2025-01-23_11-39-33__7e63a8f0-857c-4c7a-9b87-925509667588__harbor.status.im_wakuorg_nwaku:test-debug-flag.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:389 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:33 Network waku created
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.242.5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['22621', '22622', '22623', '22624', '22625']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 22621:22621 -p 22622:22622 -p 22623:22623 -p 22624:22624 -p 22625:22625 harbor.status.im/wakuorg/nwaku:test-debug-flag --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22623 --rest-port=22621 --tcp-port=22622 --discv5-udp-port=22624 --rest-address=0.0.0.0 --nat=extip:172.18.242.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fd9fb2ffcae47ca802d853abe4f0c2cd0bb37a0c1cbddbb6af1c6e2a55aaf42e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22625 --metrics-logging=true --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.242.5 waku a583f7a67979958854470b3f426715ecf39e2f4f18635216d75a6cc254a95ef2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a583f7a67979. Setting up logs at ./log/docker/node1_2025-01-23_11-39-33__7e63a8f0-857c-4c7a-9b87-925509667588__harbor.status.im_wakuorg_nwaku:test-debug-flag.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image harbor.status.im/wakuorg/nwaku:test-debug-flag. REST: 22621
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22621/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22621/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.242.5/tcp/22622/p2p/16Uiu2HAmNheJgbrd8885g1fMnomdxikEC96scZPXggsjP32bJbti","/ip4/172.18.242.5/tcp/22623/ws/p2p/16Uiu2HAmNheJgbrd8885g1fMnomdxikEC96scZPXggsjP32bJbti"],"enrUri":"enr:-L24QKiqm4S_IyWX0KCnmUE1GEpGmQ_OWKIWrOfDEDtTnIuuBK2RJH967DzKrcbgO4LT58wHWMYE1AoqFzszW_uYX1cCgmlkgnY0gmlwhKwS8gWKbXVsdGlhZGRyc5YACASsEvIFBlheAAoErBLyBQZYX90DgnJzhQADAQAAiXNlY3AyNTZrMaEDlULyYho8DUxeZ07immoA-1zrSzTw0o9KWTTN1TM3_meDdGNwglheg3VkcIJYYIV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.125.211
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['55036', '55037', '55038', '55039', '55040']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 55036:55036 -p 55037:55037 -p 55038:55038 -p 55039:55039 -p 55040:55040 harbor.status.im/wakuorg/nwaku:test-debug-flag --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55038 --rest-port=55036 --tcp-port=55037 --discv5-udp-port=55039 --rest-address=0.0.0.0 --nat=extip:172.18.125.211 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=87b5bbe733e2892d44f55c9ec5de369f4f40d149f909b2b17ddc365cdf5fea23 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55040 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QKiqm4S_IyWX0KCnmUE1GEpGmQ_OWKIWrOfDEDtTnIuuBK2RJH967DzKrcbgO4LT58wHWMYE1AoqFzszW_uYX1cCgmlkgnY0gmlwhKwS8gWKbXVsdGlhZGRyc5YACASsEvIFBlheAAoErBLyBQZYX90DgnJzhQADAQAAiXNlY3AyNTZrMaEDlULyYho8DUxeZ07immoA-1zrSzTw0o9KWTTN1TM3_meDdGNwglheg3VkcIJYYIV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.125.211 waku a0de8541ac81c025db45f45594cf87463b169fd6848b1826f22e32f61023d468
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a0de8541ac81. Setting up logs at ./log/docker/node2_2025-01-23_11-39-33__7e63a8f0-857c-4c7a-9b87-925509667588__harbor.status.im_wakuorg_nwaku:test-debug-flag.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image harbor.status.im/wakuorg/nwaku:test-debug-flag. REST: 55036
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55036/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55036/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.125.211/tcp/55037/p2p/16Uiu2HAmBQ8DY6fgGnUvckya6jt8ybeCdXR6DfpgBF2mgC5V3w93","/ip4/172.18.125.211/tcp/55038/ws/p2p/16Uiu2HAmBQ8DY6fgGnUvckya6jt8ybeCdXR6DfpgBF2mgC5V3w93"],"enrUri":"enr:-L24QFXGQe_RoOikghzYwRsoAuWjAnHuwaJyHQTKAiJSF6BCRZJiuXhwZ7nX64BzDWm5-R9oykLCd68vkZDTtLo4B0sCgmlkgnY0gmlwhKwSfdOKbXVsdGlhZGRyc5YACASsEn3TBtb9AAoErBJ90wbW_t0DgnJzhQADAQAAiXNlY3AyNTZrMaEC7VV-1CUr--7nFZjFzXTKksJkdQu-VYjoCE0akZ3VHDqDdGNwgtb9g3VkcILW_4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.22.92
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['47809', '47810', '47811', '47812', '47813']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 47809:47809 -p 47810:47810 -p 47811:47811 -p 47812:47812 -p 47813:47813 harbor.status.im/wakuorg/nwaku:test-debug-flag --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47811 --rest-port=47809 --tcp-port=47810 --discv5-udp-port=47812 --rest-address=0.0.0.0 --nat=extip:172.18.22.92 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8fecc96648ff2c45ea3ddc0be9ec122aebee87f6bd8d8a0f1f05639acec4c0eb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47813 --metrics-logging=true --relay=false --storenode=/ip4/172.18.125.211/tcp/55037/p2p/16Uiu2HAmBQ8DY6fgGnUvckya6jt8ybeCdXR6DfpgBF2mgC5V3w93 --discv5-bootstrap-node=enr:-L24QFXGQe_RoOikghzYwRsoAuWjAnHuwaJyHQTKAiJSF6BCRZJiuXhwZ7nX64BzDWm5-R9oykLCd68vkZDTtLo4B0sCgmlkgnY0gmlwhKwSfdOKbXVsdGlhZGRyc5YACASsEn3TBtb9AAoErBJ90wbW_t0DgnJzhQADAQAAiXNlY3AyNTZrMaEC7VV-1CUr--7nFZjFzXTKksJkdQu-VYjoCE0akZ3VHDqDdGNwgtb9g3VkcILW_4V3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.22.92 waku dc4ae5c3045013eb468a7599700cc0df70143c42c89dfcd57205f4263320c618
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID dc4ae5c30450. Setting up logs at ./log/docker/node3_2025-01-23_11-39-33__7e63a8f0-857c-4c7a-9b87-925509667588__harbor.status.im_wakuorg_nwaku:test-debug-flag.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image harbor.status.im/wakuorg/nwaku:test-debug-flag. REST: 47809
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47809/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47809/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.22.92/tcp/47810/p2p/16Uiu2HAmPXqPvwSNdD17CHkzs5GWramS4AYMFpnBVfsDs28UyL8K","/ip4/172.18.22.92/tcp/47811/ws/p2p/16Uiu2HAmPXqPvwSNdD17CHkzs5GWramS4AYMFpnBVfsDs28UyL8K"],"enrUri":"enr:-L24QKOI86-Z_pSBLXGWtW-_arSCgCjAUsoT8dMk-qZbDgJDTky7JuL6O-hmpRK6Y4AbADXdP19rUYMNVIz8MvdYLa8CgmlkgnY0gmlwhKwSFlyKbXVsdGlhZGRyc5YACASsEhZcBrrCAAoErBIWXAa6w90DgnJzhQADAQAAiXNlY3AyNTZrMaEDoZtdnRdWkOhzeZ-nKSuh0IwOGo62CA2W2KwXump8d2SDdGNwgrrCg3VkcIK6xIV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:394 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22621/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55036/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22621/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.125.211/tcp/55037/p2p/16Uiu2HAmBQ8DY6fgGnUvckya6jt8ybeCdXR6DfpgBF2mgC5V3w93","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55036/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.242.5/tcp/22622/p2p/16Uiu2HAmNheJgbrd8885g1fMnomdxikEC96scZPXggsjP32bJbti","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:399 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22621/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:404 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer harbor.status.im/wakuorg/nwaku:test-debug-flag can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47809/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"add3f058da628d97b20e","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:408 Response for store when ephemeral = true is strPeer harbor.status.im/wakuorg/nwaku:test-debug-flag couldn't find any messages. Actual response: {'requestId': 'add3f058da628d97b20e', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:410 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id a583f7a67979
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id a0de8541ac81
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a583f7a67979. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id dc4ae5c30450
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a0de8541ac81. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.