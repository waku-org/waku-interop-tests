[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_relay_unsubscribe_from_single_pubsub_topic with id: 2025-01-17_11-54-18__e5b7ad25-44fe-4185-ac25-6e6f5489bf7c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3240
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-17_11-54-18__e5b7ad25-44fe-4185-ac25-6e6f5489bf7c__quay.io_wakuorg_nwaku-pr:3240.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.38.99
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['45834', '45835', '45836', '45837', '45838']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 45834:45834 -p 45835:45835 -p 45836:45836 -p 45837:45837 -p 45838:45838 quay.io/wakuorg/nwaku-pr:3240 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45836 --rest-port=45834 --tcp-port=45835 --discv5-udp-port=45837 --rest-address=0.0.0.0 --nat=extip:172.18.38.99 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9dbddf4fcdab4a5428543f2fb5ad9a7a9bab23beff7e1b6f68da66066c4bf298 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45838 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.203.21
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['23006', '23007', '23008', '23009', '23010']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 23006:23006 -p 23007:23007 -p 23008:23008 -p 23009:23009 -p 23010:23010 quay.io/wakuorg/nwaku-pr:3240 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23008 --rest-port=23006 --tcp-port=23007 --discv5-udp-port=23009 --rest-address=0.0.0.0 --nat=extip:172.18.203.21 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c8e1ccffd5eefffcb7654202f47bfdd26c8f2285311766194a4d4d4b261ffa96 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23010 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.203.21 waku 568d18029303af9adb1ce6a139591cc72621cf9c45f4f68e4646392e11eaeffb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 568d18029303. Setting up logs at ./log/docker/node1_2025-01-17_11-54-18__e5b7ad25-44fe-4185-ac25-6e6f5489bf7c__quay.io_wakuorg_nwaku-pr:3240.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3240. REST: 23006
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 30597bfae193. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23006/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23006/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.203.21/tcp/23007/p2p/16Uiu2HAm3XVgVegJjwA2BUaPWseH81zRrYmiN4GHYqeSsXfS7ngy","/ip4/172.18.203.21/tcp/23008/ws/p2p/16Uiu2HAm3XVgVegJjwA2BUaPWseH81zRrYmiN4GHYqeSsXfS7ngy"],"enrUri":"enr:-L24QBJrPbt4qbjXMTJfVrfkcEH8iGwQMaEMdWTRJZr9Jn3FCHghcQlPfBcmbEwVZVKYqsMmDvwM6Y9k4nAsijPjVQ8CgmlkgnY0gmlwhKwSyxWKbXVsdGlhZGRyc5YACASsEssVBlnfAAoErBLLFQZZ4N0DgnJzhQADAQAAiXNlY3AyNTZrMaECeFtWA5UGcvvNLpXm9WmevT3xVFSKl665LxmePZXKbSKDdGNwglnfg3VkcIJZ4YV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3240
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2025-01-17_11-54-18__e5b7ad25-44fe-4185-ac25-6e6f5489bf7c__quay.io_wakuorg_nwaku-pr:3240.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.253.69
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['8404', '8405', '8406', '8407', '8408']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 8404:8404 -p 8405:8405 -p 8406:8406 -p 8407:8407 -p 8408:8408 quay.io/wakuorg/nwaku-pr:3240 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8406 --rest-port=8404 --tcp-port=8405 --discv5-udp-port=8407 --rest-address=0.0.0.0 --nat=extip:172.18.253.69 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d137b8025bc91fb7efc14c6fea4dcf527eff4a0fff23ee1adaaaffeb7079a414 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8408 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QBJrPbt4qbjXMTJfVrfkcEH8iGwQMaEMdWTRJZr9Jn3FCHghcQlPfBcmbEwVZVKYqsMmDvwM6Y9k4nAsijPjVQ8CgmlkgnY0gmlwhKwSyxWKbXVsdGlhZGRyc5YACASsEssVBlnfAAoErBLLFQZZ4N0DgnJzhQADAQAAiXNlY3AyNTZrMaECeFtWA5UGcvvNLpXm9WmevT3xVFSKl665LxmePZXKbSKDdGNwglnfg3VkcIJZ4YV3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.253.69 waku 483a702e189997ab2b43ca1db14e4ae50d0cf74a4595fc189d8aa1d99c8f0f90
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 483a702e1899. Setting up logs at ./log/docker/node2_2025-01-17_11-54-18__e5b7ad25-44fe-4185-ac25-6e6f5489bf7c__quay.io_wakuorg_nwaku-pr:3240.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3240. REST: 8404
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8404/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8404/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.253.69/tcp/8405/p2p/16Uiu2HAm1P2TJJZsvVc9B2uf914uJG9msr4NQVDxiZie2udTeGos","/ip4/172.18.253.69/tcp/8406/ws/p2p/16Uiu2HAm1P2TJJZsvVc9B2uf914uJG9msr4NQVDxiZie2udTeGos"],"enrUri":"enr:-L24QF7d3-RsqQ0GQwpi3IOGBZK5C0DAL63ZT-BIdy6jNbpOJBsaaK1k7NJSEExWIlqW4JMPnrUjBregSwO4QcweY14CgmlkgnY0gmlwhKwS_UWKbXVsdGlhZGRyc5YACASsEv1FBiDVAAoErBL9RQYg1t0DgnJzhQADAQAAiXNlY3AyNTZrMaECWHiHiDUMqphYCltg5JGVsskyli4NhRDkwjsRNiS-rCKDdGNwgiDVg3VkcIIg14V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8404/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.203.21/tcp/23007/p2p/16Uiu2HAm3XVgVegJjwA2BUaPWseH81zRrYmiN4GHYqeSsXfS7ngy"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23006/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8404/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23006/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:quay.io/wakuorg/nwaku-pr:3240 can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23006/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1737114861458300160,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:quay.io/wakuorg/nwaku-pr:3240 can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8404/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1737114861458300160,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X DELETE "http://127.0.0.1:23006/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X DELETE "http://127.0.0.1:8404/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23006/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23006/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/3/1'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 568d18029303
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 483a702e1899
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 568d18029303. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.