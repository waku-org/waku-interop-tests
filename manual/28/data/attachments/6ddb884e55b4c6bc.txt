[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2025-01-31_08-33-27__53ccdb13-5fc1-4851-9160-ea4e326f450c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-01-31_08-33-27__53ccdb13-5fc1-4851-9160-ea4e326f450c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.117.112
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['4332', '4333', '4334', '4335', '4336']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 4332:4332 -p 4333:4333 -p 4334:4334 -p 4335:4335 -p 4336:4336 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4334 --rest-port=4332 --tcp-port=4333 --discv5-udp-port=4335 --rest-address=0.0.0.0 --nat=extip:172.18.117.112 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=22c7fbf5a86525abf9fa486771c8bed12d51f38bbfdcd9bc7c3f8a4fcbd5d90d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4336 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.117.112 waku cdedae6485d0583bf7d8d78c9ec7be2c71c1a59d7bc5d2046bf8d658591dbb9a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID cdedae6485d0. Setting up logs at ./log/docker/publishing_node1_2025-01-31_08-33-27__53ccdb13-5fc1-4851-9160-ea4e326f450c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 4332
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 859908dbc82e. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4332/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4332/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.117.112/tcp/4333/p2p/16Uiu2HAmUHPCHtFch5Hh7yjqLRbSsJWvQDCd9jaY1x3BfoAQhRdR","/ip4/172.18.117.112/tcp/4334/ws/p2p/16Uiu2HAmUHPCHtFch5Hh7yjqLRbSsJWvQDCd9jaY1x3BfoAQhRdR"],"enrUri":"enr:-L24QILjRqxSIK8DBE9aT4w4n-FUswWeX7OfOpY9VqS4j5q9N_HSrB9BolXYGGoDHluFkrXHAyp_cNWcirm4C7rpMSICgmlkgnY0gmlwhKwSdXCKbXVsdGlhZGRyc5YACASsEnVwBhDtAAoErBJ1cAYQ7t0DgnJzhQADAQAAiXNlY3AyNTZrMaED6DILNdyhL4ewPqWOuO1tPMDy-AKSVokUJjNUuFEZgXCDdGNwghDtg3VkcIIQ74V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2025-01-31_08-33-27__53ccdb13-5fc1-4851-9160-ea4e326f450c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.72.119
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['32433', '32434', '32435', '32436', '32437']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 32433:32433 -p 32434:32434 -p 32435:32435 -p 32436:32436 -p 32437:32437 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32435 --rest-port=32433 --tcp-port=32434 --discv5-udp-port=32436 --rest-address=0.0.0.0 --nat=extip:172.18.72.119 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9cdba7dd1fd3d4dfe76ce96f299a0decce6db82c2ba2eaa9aea10ff0853bfd1a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32437 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QILjRqxSIK8DBE9aT4w4n-FUswWeX7OfOpY9VqS4j5q9N_HSrB9BolXYGGoDHluFkrXHAyp_cNWcirm4C7rpMSICgmlkgnY0gmlwhKwSdXCKbXVsdGlhZGRyc5YACASsEnVwBhDtAAoErBJ1cAYQ7t0DgnJzhQADAQAAiXNlY3AyNTZrMaED6DILNdyhL4ewPqWOuO1tPMDy-AKSVokUJjNUuFEZgXCDdGNwghDtg3VkcIIQ74V3YWt1MgM --storenode=/ip4/172.18.117.112/tcp/4333/p2p/16Uiu2HAmUHPCHtFch5Hh7yjqLRbSsJWvQDCd9jaY1x3BfoAQhRdR --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.72.119 waku 32ab88f79aa8d69ee0d99a181b4a8fb820cb73de65ab9f884797f046b4e0d1d3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 32ab88f79aa8. Setting up logs at ./log/docker/store_node1_2025-01-31_08-33-27__53ccdb13-5fc1-4851-9160-ea4e326f450c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 32433
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32433/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32433/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.72.119/tcp/32434/p2p/16Uiu2HAmPmkyyBt24s79YM2TyzhzEwfxZE19ZvcUVHM91dYQm2sC","/ip4/172.18.72.119/tcp/32435/ws/p2p/16Uiu2HAmPmkyyBt24s79YM2TyzhzEwfxZE19ZvcUVHM91dYQm2sC"],"enrUri":"enr:-L24QEyhr6ce5E00BD_AtFFavKPDbTmCd7Slm8R98sCYu706Fko0cEBbjl1kNCyHfzQneBDNfzttl_6Ge4k2BRXEY44CgmlkgnY0gmlwhKwSSHeKbXVsdGlhZGRyc5YACASsEkh3Bn6yAAoErBJIdwZ-s90DgnJzhQADAQAAiXNlY3AyNTZrMaEDpSyBz041lWdHL8H2CXgNh-2cazH8U51-sqUCYs3rgzODdGNwgn6yg3VkcIJ-tIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32433/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.117.112/tcp/4333/p2p/16Uiu2HAmUHPCHtFch5Hh7yjqLRbSsJWvQDCd9jaY1x3BfoAQhRdR"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4332/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32433/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4332/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer quay.io/wakuorg/nwaku-pr:3234 can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4332/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x16469bea5d52255f8ef80978d9b401cf8e9564daf4ca88b3cafcc230e513fced"}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer quay.io/wakuorg/nwaku-pr:3234 can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32433/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"07ac382358e78989e8e1","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x16469bea5d52255f8ef80978d9b401cf8e9564daf4ca88b3cafcc230e513fced"}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id cdedae6485d0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 32ab88f79aa8
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container cdedae6485d0. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.