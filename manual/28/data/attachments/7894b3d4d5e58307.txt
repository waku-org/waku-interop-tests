[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_relay with id: 2025-01-31_08-25-41__65bc46dc-e43f-4a82-a94c-d671f015d6ef
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-31_08-25-41__65bc46dc-e43f-4a82-a94c-d671f015d6ef__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:33 Network waku created
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.68.13
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['52809', '52810', '52811', '52812', '52813']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 52809:52809 -p 52810:52810 -p 52811:52811 -p 52812:52812 -p 52813:52813 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52811 --rest-port=52809 --tcp-port=52810 --discv5-udp-port=52812 --rest-address=0.0.0.0 --nat=extip:172.18.68.13 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f6e191c21cfa9dd76aa04dd83ddd90c244291f830ac3cb95ce4c6a632e664c3d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52813 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.68.13 waku cfe4b1fccb4f81684701f98363be7d11428e1d081f089c8f1cb6c8b2a87fae64
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID cfe4b1fccb4f. Setting up logs at ./log/docker/node1_2025-01-31_08-25-41__65bc46dc-e43f-4a82-a94c-d671f015d6ef__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 52809
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52809/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52809/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.68.13/tcp/52810/p2p/16Uiu2HAmF2sjUi4ifPpYNtvm6ccwvPBHSWsCgcjvQ5Qw3nGWtjQq","/ip4/172.18.68.13/tcp/52811/ws/p2p/16Uiu2HAmF2sjUi4ifPpYNtvm6ccwvPBHSWsCgcjvQ5Qw3nGWtjQq"],"enrUri":"enr:-L24QEXXMbGfm_VvdJEPbnqI6LBDO_YXiF2xQZqoSOzCa_u9S4_u4iZJAyqd3qPtBHXRLoXcgsLTnlE39pDXwy7SJNwCgmlkgnY0gmlwhKwSRA2KbXVsdGlhZGRyc5YACASsEkQNBs5KAAoErBJEDQbOS90DgnJzhQADAQAAiXNlY3AyNTZrMaEDI1KrVsQKr2Mp48NFu-Ao3t_wVaJt_L8V2dPGTTHBtLaDdGNwgs5Kg3VkcILOTIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-31_08-25-41__65bc46dc-e43f-4a82-a94c-d671f015d6ef__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.94.10
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['18457', '18458', '18459', '18460', '18461']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 18457:18457 -p 18458:18458 -p 18459:18459 -p 18460:18460 -p 18461:18461 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18459 --rest-port=18457 --tcp-port=18458 --discv5-udp-port=18460 --rest-address=0.0.0.0 --nat=extip:172.18.94.10 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b4fdb7aeca5a2ddefea92c2cb3808b6c7a3f9db323392ed02fcfe77ed9fee8ab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18461 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QEXXMbGfm_VvdJEPbnqI6LBDO_YXiF2xQZqoSOzCa_u9S4_u4iZJAyqd3qPtBHXRLoXcgsLTnlE39pDXwy7SJNwCgmlkgnY0gmlwhKwSRA2KbXVsdGlhZGRyc5YACASsEkQNBs5KAAoErBJEDQbOS90DgnJzhQADAQAAiXNlY3AyNTZrMaEDI1KrVsQKr2Mp48NFu-Ao3t_wVaJt_L8V2dPGTTHBtLaDdGNwgs5Kg3VkcILOTIV3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.94.10 waku 82640c1c74b19d1e1539a1047e7cf187e9435304114d342df528c012bd2b6987
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 82640c1c74b1. Setting up logs at ./log/docker/node1_2025-01-31_08-25-41__65bc46dc-e43f-4a82-a94c-d671f015d6ef__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 18457
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18457/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18457/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.94.10/tcp/18458/p2p/16Uiu2HAkz6v2oFdzjLtrYuV31i4p49tof1NUvrt6dinVBJjPhSQV","/ip4/172.18.94.10/tcp/18459/ws/p2p/16Uiu2HAkz6v2oFdzjLtrYuV31i4p49tof1NUvrt6dinVBJjPhSQV"],"enrUri":"enr:-L24QPZHXz60yQKz3ANQ5JfAms_-4FT5YCdBzr4ceT3g7yEnHFqLbBcnn1S8lHPKD4nIdamUhpM_eO66NUK5xeDNVD4CgmlkgnY0gmlwhKwSXgqKbXVsdGlhZGRyc5YACASsEl4KBkgaAAoErBJeCgZIG90DgnJzhQADAQAAiXNlY3AyNTZrMaECRXxJpd2CgcKFj5NCU-Z6wqtVigQwcaTonovL9tbRJPaDdGNwgkgag3VkcIJIHIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52809/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18457/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52809/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:quay.io/wakuorg/nwaku-pr:3234 can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52809/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738311947762878976,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:quay.io/wakuorg/nwaku-pr:3234 can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18457/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738311947762878976,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id cfe4b1fccb4f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 82640c1c74b1
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container cfe4b1fccb4f. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.