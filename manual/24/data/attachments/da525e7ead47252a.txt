[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2025-01-30_11-17-56__2a10973e-9851-4503-ba17-fdf274bb055c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-01-30_11-17-56__2a10973e-9851-4503-ba17-fdf274bb055c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.78.114
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['54529', '54530', '54531', '54532', '54533']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 54529:54529 -p 54530:54530 -p 54531:54531 -p 54532:54532 -p 54533:54533 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54531 --rest-port=54529 --tcp-port=54530 --discv5-udp-port=54532 --rest-address=0.0.0.0 --nat=extip:172.18.78.114 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eccf8ffdda7d5cf264da53c1cd5cbde1c9be04eefbec63ebaaf0fce7d3ac14ee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54533 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.78.114 waku 88ef38aff2cc7c96b5beff97170c82fb8b6659aceb870502a3c2f4896dd29ab3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 88ef38aff2cc. Setting up logs at ./log/docker/publishing_node1_2025-01-30_11-17-56__2a10973e-9851-4503-ba17-fdf274bb055c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 54529
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container e879aa06fdd0. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54529/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54529/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.78.114/tcp/54530/p2p/16Uiu2HAm4AmQc53CWvwbcJg2rbAuUNMC4D5ze2i8beDiHiLqij3n","/ip4/172.18.78.114/tcp/54531/ws/p2p/16Uiu2HAm4AmQc53CWvwbcJg2rbAuUNMC4D5ze2i8beDiHiLqij3n"],"enrUri":"enr:-L24QJe8Jf8f5ONiFixiV4_NeIMz-EQNb6waWs2YyqAGfUMlTrhepEOiOdrVL-pjIM7nM-K3ohQ5783ZUUwZG7b-oJQCgmlkgnY0gmlwhKwSTnKKbXVsdGlhZGRyc5YACASsEk5yBtUCAAoErBJOcgbVA90DgnJzhQADAQAAiXNlY3AyNTZrMaECgeebgDjIGSfxhBe_X6IivUZtWaMPungOndybPycvxBGDdGNwgtUCg3VkcILVBIV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3234
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2025-01-30_11-17-56__2a10973e-9851-4503-ba17-fdf274bb055c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.240.62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['65304', '65305', '65306', '65307', '65308']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 65304:65304 -p 65305:65305 -p 65306:65306 -p 65307:65307 -p 65308:65308 quay.io/wakuorg/nwaku-pr:3234 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65306 --rest-port=65304 --tcp-port=65305 --discv5-udp-port=65307 --rest-address=0.0.0.0 --nat=extip:172.18.240.62 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f1c9db9cd140f8e333119da9554b61f09f240d457b18cfe98ef1c2a6962e7caf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65308 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QJe8Jf8f5ONiFixiV4_NeIMz-EQNb6waWs2YyqAGfUMlTrhepEOiOdrVL-pjIM7nM-K3ohQ5783ZUUwZG7b-oJQCgmlkgnY0gmlwhKwSTnKKbXVsdGlhZGRyc5YACASsEk5yBtUCAAoErBJOcgbVA90DgnJzhQADAQAAiXNlY3AyNTZrMaECgeebgDjIGSfxhBe_X6IivUZtWaMPungOndybPycvxBGDdGNwgtUCg3VkcILVBIV3YWt1MgM --storenode=/ip4/172.18.78.114/tcp/54530/p2p/16Uiu2HAm4AmQc53CWvwbcJg2rbAuUNMC4D5ze2i8beDiHiLqij3n --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.240.62 waku cf44f144a8f0b69cb30ac5ad5a00669c2883d47f6f1bd4ac2edb9bd6928cd3f2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID cf44f144a8f0. Setting up logs at ./log/docker/store_node1_2025-01-30_11-17-56__2a10973e-9851-4503-ba17-fdf274bb055c__quay.io_wakuorg_nwaku-pr:3234.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image quay.io/wakuorg/nwaku-pr:3234. REST: 65304
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65304/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65304/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.240.62/tcp/65305/p2p/16Uiu2HAm6JVZj5hK8nPbc7YytUJMmwFTPy6o1TKj9sMtknKzXG4T","/ip4/172.18.240.62/tcp/65306/ws/p2p/16Uiu2HAm6JVZj5hK8nPbc7YytUJMmwFTPy6o1TKj9sMtknKzXG4T"],"enrUri":"enr:-L24QP2wrIYA3dfU-LlziiS0Fa7_ID6j_qnwW8uXjsVrElf9c09mrUsWFnymS29oyrDe6xpNzZgia5jLByqqhhd7dywCgmlkgnY0gmlwhKwS8D6KbXVsdGlhZGRyc5YACASsEvA-Bv8ZAAoErBLwPgb_Gt0DgnJzhQADAQAAiXNlY3AyNTZrMaECoZm23Ji2rOPz3z1WsC5e6gn5YZqBxpn5VPdCHH_LBCSDdGNwgv8Zg3VkcIL_G4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65304/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.78.114/tcp/54530/p2p/16Uiu2HAm4AmQc53CWvwbcJg2rbAuUNMC4D5ze2i8beDiHiLqij3n"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54529/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65304/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54529/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:47 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer quay.io/wakuorg/nwaku-pr:3234 can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54529/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x33f93c56948472ebca29ff99e68526febf1d8d879b78d12d77815114fbc7266d"}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer quay.io/wakuorg/nwaku-pr:3234 can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65304/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"8ef4d1e95bf90a71997f","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x33f93c56948472ebca29ff99e68526febf1d8d879b78d12d77815114fbc7266d"}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 88ef38aff2cc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id cf44f144a8f0
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 88ef38aff2cc. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.