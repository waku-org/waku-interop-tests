2025-02-06 15:48:54.743 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 15:48:54.744 DEBUG [tests.conftest] Running test: test_filter_unsubscribe_from_single_content_topic with id: 2025-02-06_15-48-54__ad52fe39-1748-442b-9ddd-6b99c0525f59
2025-02-06 15:48:54.744 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 15:48:54.744 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-06 15:48:54.744 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-06 15:48:54.751 DEBUG [src.node.docker_mananger] Docker client initialized with image quay.io/wakuorg/nwaku-pr:3281
2025-02-06 15:48:54.751 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_15-48-54__ad52fe39-1748-442b-9ddd-6b99c0525f59__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:48:54.751 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:48:54.751 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:48:54.753 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:48:54.753 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.253.64
2025-02-06 15:48:54.753 DEBUG [src.node.docker_mananger] Generated ports ['27807', '27808', '27809', '27810', '27811']
2025-02-06 15:48:54.753 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:48:54.753 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:48:54.753 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:48:54.753 DEBUG [src.node.docker_mananger] docker run -i -t -p 27807:27807 -p 27808:27808 -p 27809:27809 -p 27810:27810 -p 27811:27811 quay.io/wakuorg/nwaku-pr:3281 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27809 --rest-port=27807 --tcp-port=27808 --discv5-udp-port=27810 --rest-address=0.0.0.0 --nat=extip:172.18.253.64 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4b2f4dbae215887bfc4fdff96b322d56bfbfe9925fb3b0bd5a6ffdca1bbbcb78 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27811 --metrics-logging=true --relay=true --filter=true
2025-02-06 15:48:54.988 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.253.64 waku c6b941ca2fedb683e48ad15f360f40f4b82ccb831a3bc3e84e76c7e96ed37286
2025-02-06 15:48:55.039 DEBUG [src.node.docker_mananger] Container started with ID c6b941ca2fed. Setting up logs at ./log/docker/node1_2025-02-06_15-48-54__ad52fe39-1748-442b-9ddd-6b99c0525f59__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:48:55.040 DEBUG [src.node.waku_node] Started container from image quay.io/wakuorg/nwaku-pr:3281. REST: 27807
2025-02-06 15:48:55.040 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:48:55.544 ERROR [src.node.docker_mananger] Max retries reached for container 45042358574e. Exiting log stream.
2025-02-06 15:48:56.040 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27807/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:48:56.043 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 15:48:56.043 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 15:48:56.044 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27807/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:48:56.046 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.253.64/tcp/27808/p2p/16Uiu2HAmVeE5L1YbunHd956dcCZ1eygvxhbVLxtXJHpQWQLc8HS1","/ip4/172.18.253.64/tcp/27809/ws/p2p/16Uiu2HAmVeE5L1YbunHd956dcCZ1eygvxhbVLxtXJHpQWQLc8HS1"],"enrUri":"enr:-L24QL0xBsPJZBSEHpCcGUXJCEtJNoWOzUI3KOjrHAlkayWSQ2sS-2uupWwh5YfBSbSldGSbLjJOnGRA9chp63WaifACgmlkgnY0gmlwhKwS_UCKbXVsdGlhZGRyc5YACASsEv1ABmygAAoErBL9QAZsod0DgnJzhQADAQAAiXNlY3AyNTZrMaED_GSdmZ_irDya08E4F9PylRS9w-5ZP4KAm0SSkTpn2FKDdGNwgmygg3VkcIJsooV3YWt1MgU"}'
2025-02-06 15:48:56.046 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:48:56.046 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-06 15:48:56.052 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-06 15:48:56.052 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_15-48-54__ad52fe39-1748-442b-9ddd-6b99c0525f59__wakuorg_go-waku:latest.log
2025-02-06 15:48:56.052 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:48:56.053 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:48:56.054 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:48:56.054 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.31.68
2025-02-06 15:48:56.054 DEBUG [src.node.docker_mananger] Generated ports ['41897', '41898', '41899', '41900', '41901']
2025-02-06 15:48:56.054 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:48:56.054 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:48:56.055 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:48:56.055 DEBUG [src.node.docker_mananger] docker run -i -t -p 41897:41897 -p 41898:41898 -p 41899:41899 -p 41900:41900 -p 41901:41901 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=41899 --rest-port=41897 --tcp-port=41898 --discv5-udp-port=41900 --rest-address=0.0.0.0 --nat=extip:172.18.31.68 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ad439ea1c0316defea65ed7ebc0e0cd98e1dee338eee1452cf4e2edadff7d23c --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QL0xBsPJZBSEHpCcGUXJCEtJNoWOzUI3KOjrHAlkayWSQ2sS-2uupWwh5YfBSbSldGSbLjJOnGRA9chp63WaifACgmlkgnY0gmlwhKwS_UCKbXVsdGlhZGRyc5YACASsEv1ABmygAAoErBL9QAZsod0DgnJzhQADAQAAiXNlY3AyNTZrMaED_GSdmZ_irDya08E4F9PylRS9w-5ZP4KAm0SSkTpn2FKDdGNwgmygg3VkcIJsooV3YWt1MgU --filternode=/ip4/172.18.253.64/tcp/27808/p2p/16Uiu2HAmVeE5L1YbunHd956dcCZ1eygvxhbVLxtXJHpQWQLc8HS1 --pubsub-topic=/waku/2/rs/3/1
2025-02-06 15:48:56.290 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.31.68 waku 5df5e303873dd2bbf4723d8cffda5451813d6535ab0de5d22d2f4677dce79e52
2025-02-06 15:48:56.342 DEBUG [src.node.docker_mananger] Container started with ID 5df5e303873d. Setting up logs at ./log/docker/node2_2025-02-06_15-48-54__ad52fe39-1748-442b-9ddd-6b99c0525f59__wakuorg_go-waku:latest.log
2025-02-06 15:48:56.343 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 41897
2025-02-06 15:48:56.344 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:48:57.345 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41897/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:48:57.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QAXJJrRBEFmeDFoXyZqw2vbWndFUJWScv3Z7a3n89-sdBM8mLhBL0RwGTapo8w6sM9GAwq8qg9DgA0C104VrstaGAZTb8zORgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQMN0HsibWG3tV12lRONp-clHon1xHMOKn5kVDaFOOQDcIN0Y3CCo6qDdWRwgqOshXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/41898/p2p/16Uiu2HAmDav2q4wS8VGW7f7kRBu3RyEzgrmKnipnfiZu2fVyqKVH","/ip4/127.0.0.1/tcp/41899/ws/p2p/16Uiu2HAmDav2q4wS8VGW7f7kRBu3RyEzgrmKnipnfiZu2fVyqKVH","/ip4/172.17.0.3/tcp/41898/p2p/16Uiu2HAmDav2q4wS8VGW7f7kRBu3RyEzgrmKnipnfiZu2fVyqKVH","/ip4/172.17.0.3/tcp/41899/ws/p2p/16Uiu2HAmDav2q4wS8VGW7f7kRBu3RyEzgrmKnipnfiZu2fVyqKVH"]}'
2025-02-06 15:48:57.347 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:48:57.348 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41897/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.253.64/tcp/27808/p2p/16Uiu2HAmVeE5L1YbunHd956dcCZ1eygvxhbVLxtXJHpQWQLc8HS1", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-06 15:48:57.349 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-06 15:48:57.350 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-06 15:48:57.350 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27807/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 15:48:57.353 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:48:57.353 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41897/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "a6d63d38-68c4-4fd2-b097-1aa5a66f9d15", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 15:48:57.358 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"a6d63d38-68c4-4fd2-b097-1aa5a66f9d15","statusDesc":"OK"}'
2025-02-06 15:48:57.360 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27807/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:48:57.366 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:48:57.367 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:48:57.467 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:48:57.467 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41897/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:48:57.469 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738856937360388352,"ephemeral":false}]'
2025-02-06 15:48:57.471 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:41897/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 15:48:57.475 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-06 15:48:57.476 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27807/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:48:57.479 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:48:57.479 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:48:57.580 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:48:57.580 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41897/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:48:57.582 ERROR [src.node.api_clients.base_client] HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:41897/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'not subscribed to pubsubTopic:/waku/2/rs/3/1 contentTopic: /test/1/waku-filter/proto'
2025-02-06 15:48:57.584 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 15:48:57.585 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 15:48:57.586 DEBUG [src.node.waku_node] Stopping container with id c6b941ca2fed
2025-02-06 15:48:58.194 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:48:58.194 DEBUG [src.node.waku_node] Stopping container with id 5df5e303873d
2025-02-06 15:48:58.840 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:48:58.840 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 15:48:58.851 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 15:48:58.853 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
