2025-02-06 15:46:32.895 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 15:46:32.896 DEBUG [tests.conftest] Running test: test_store_node_not_connected_directly_to_lightpushing_node with id: 2025-02-06_15-46-32__f9ed59ed-796b-415a-b1f0-8c42647936d5
2025-02-06 15:46:32.896 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 15:46:32.896 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-06 15:46:32.897 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-06 15:46:32.905 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-06 15:46:32.905 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_15-46-32__f9ed59ed-796b-415a-b1f0-8c42647936d5__wakuorg_go-waku:latest.log
2025-02-06 15:46:32.911 DEBUG [src.node.docker_mananger] Docker client initialized with image quay.io/wakuorg/nwaku-pr:3281
2025-02-06 15:46:32.911 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_15-46-32__f9ed59ed-796b-415a-b1f0-8c42647936d5__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:46:32.917 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-06 15:46:32.917 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-06_15-46-32__f9ed59ed-796b-415a-b1f0-8c42647936d5__wakuorg_go-waku:latest.log
2025-02-06 15:46:32.917 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-06 15:46:32.917 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-06 15:46:32.918 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:46:32.919 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:46:32.982 DEBUG [src.node.docker_mananger] Network waku created
2025-02-06 15:46:32.983 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.52.227
2025-02-06 15:46:32.983 DEBUG [src.node.docker_mananger] Generated ports ['23831', '23832', '23833', '23834', '23835']
2025-02-06 15:46:32.983 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:46:32.983 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:46:32.983 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:46:32.983 DEBUG [src.node.docker_mananger] docker run -i -t -p 23831:23831 -p 23832:23832 -p 23833:23833 -p 23834:23834 -p 23835:23835 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=23833 --rest-port=23831 --tcp-port=23832 --discv5-udp-port=23834 --rest-address=0.0.0.0 --nat=extip:172.18.52.227 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0f892500e51f26af5f1bbdfa29def997ec4edcaafaacd4067c3a0d4cb374ce31 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --lightpush=true
2025-02-06 15:46:35.913 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.52.227 waku 2817038d48edc18668df27b5e1e9e8e71ad2e80d08cfa97624acb4b7b677164a
2025-02-06 15:46:35.963 DEBUG [src.node.docker_mananger] Container started with ID 2817038d48ed. Setting up logs at ./log/docker/node1_2025-02-06_15-46-32__f9ed59ed-796b-415a-b1f0-8c42647936d5__wakuorg_go-waku:latest.log
2025-02-06 15:46:35.964 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 23831
2025-02-06 15:46:35.965 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:46:36.966 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23831/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:36.968 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QCO3FKxxql1GJTtVqV8mBemQ0F0aE5_UyP4ctbvLx_OrZXGemG51sBiBh6nU6jzQKs89aQEeM9IKQdgwSiiyeUqGAZTb8Q86gmlkgnY0gmlwhKwRAAKCcnODAAMAiXNlY3AyNTZrMaEDpDuWnJhChXNGaqik3bvsmEm4pIlP_a7ZhbEL_2fCyLuDdGNwgl0Yg3VkcIJdGoV3YWt1Mgk","listenAddresses":["/ip4/127.0.0.1/tcp/23832/p2p/16Uiu2HAmPi5uvXQsiB56HCb4dhTy9ybRS6f6CiotnEYkEpQRDq9k","/ip4/127.0.0.1/tcp/23833/ws/p2p/16Uiu2HAmPi5uvXQsiB56HCb4dhTy9ybRS6f6CiotnEYkEpQRDq9k","/ip4/172.17.0.2/tcp/23832/p2p/16Uiu2HAmPi5uvXQsiB56HCb4dhTy9ybRS6f6CiotnEYkEpQRDq9k","/ip4/172.17.0.2/tcp/23833/ws/p2p/16Uiu2HAmPi5uvXQsiB56HCb4dhTy9ybRS6f6CiotnEYkEpQRDq9k"]}'
2025-02-06 15:46:36.969 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:46:36.969 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:46:36.969 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:46:36.970 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:46:36.971 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.110.151
2025-02-06 15:46:36.971 DEBUG [src.node.docker_mananger] Generated ports ['56829', '56830', '56831', '56832', '56833']
2025-02-06 15:46:36.971 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:46:36.971 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:46:36.971 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:46:36.971 DEBUG [src.node.docker_mananger] docker run -i -t -p 56829:56829 -p 56830:56830 -p 56831:56831 -p 56832:56832 -p 56833:56833 quay.io/wakuorg/nwaku-pr:3281 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56831 --rest-port=56829 --tcp-port=56830 --discv5-udp-port=56832 --rest-address=0.0.0.0 --nat=extip:172.18.110.151 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5a2a0a255a7b88b63c9a58507dd62a8109d4cfd75ffea45b8a20be1daeee0d8b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56833 --metrics-logging=true --lightpush=true --store=true --relay=true --discv5-bootstrap-node=enr:-J-4QCO3FKxxql1GJTtVqV8mBemQ0F0aE5_UyP4ctbvLx_OrZXGemG51sBiBh6nU6jzQKs89aQEeM9IKQdgwSiiyeUqGAZTb8Q86gmlkgnY0gmlwhKwRAAKCcnODAAMAiXNlY3AyNTZrMaEDpDuWnJhChXNGaqik3bvsmEm4pIlP_a7ZhbEL_2fCyLuDdGNwgl0Yg3VkcIJdGoV3YWt1Mgk --lightpushnode=/ip4/172.18.52.227/tcp/23832/p2p/16Uiu2HAmPi5uvXQsiB56HCb4dhTy9ybRS6f6CiotnEYkEpQRDq9k
2025-02-06 15:46:45.234 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.110.151 waku 2fd7952e248f500ce9af947cc1780841673e6a2fe29af3eb9af6483bd7a2a625
2025-02-06 15:46:45.289 DEBUG [src.node.docker_mananger] Container started with ID 2fd7952e248f. Setting up logs at ./log/docker/node2_2025-02-06_15-46-32__f9ed59ed-796b-415a-b1f0-8c42647936d5__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:46:45.290 DEBUG [src.node.waku_node] Started container from image quay.io/wakuorg/nwaku-pr:3281. REST: 56829
2025-02-06 15:46:45.290 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:46:46.291 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56829/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:46.293 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 15:46:46.294 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 15:46:46.294 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56829/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:46.296 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.110.151/tcp/56830/p2p/16Uiu2HAmTdqyANujpg9zXTvHT5vLA4FtH9tc9fujeDRY5EjjniG6","/ip4/172.18.110.151/tcp/56831/ws/p2p/16Uiu2HAmTdqyANujpg9zXTvHT5vLA4FtH9tc9fujeDRY5EjjniG6"],"enrUri":"enr:-L24QEb1xfwkZA-WUP-9CLsDqZd2DB0M1YHbr_7T4Hd9jmW4HxOZ1wXWsJYsU94LqmKDj79nLzH7UBEV_iNe7eMZa5wCgmlkgnY0gmlwhKwSbpeKbXVsdGlhZGRyc5YACASsEm6XBt3-AAoErBJulwbd_90DgnJzhQADAQAAiXNlY3AyNTZrMaED3pQ-_4jeyAKM8tN3HVfEcG2zaasGx2Lvkdis-Nbq6leDdGNwgt3-g3VkcILeAIV3YWt1Mgs"}'
2025-02-06 15:46:46.296 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:46:46.297 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:46:46.297 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:46:46.298 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:46:46.298 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.150.62
2025-02-06 15:46:46.298 DEBUG [src.node.docker_mananger] Generated ports ['49812', '49813', '49814', '49815', '49816']
2025-02-06 15:46:46.298 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:46:46.299 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:46:46.299 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:46:46.299 DEBUG [src.node.docker_mananger] docker run -i -t -p 49812:49812 -p 49813:49813 -p 49814:49814 -p 49815:49815 -p 49816:49816 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=49814 --rest-port=49812 --tcp-port=49813 --discv5-udp-port=49815 --rest-address=0.0.0.0 --nat=extip:172.18.150.62 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=46132fb6dffecd1f09f018bcccefa1483dedbec03e6ce88d75d8e565b87fca1b --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --storenode=/ip4/172.18.110.151/tcp/56830/p2p/16Uiu2HAmTdqyANujpg9zXTvHT5vLA4FtH9tc9fujeDRY5EjjniG6 --discv5-bootstrap-node=enr:-L24QEb1xfwkZA-WUP-9CLsDqZd2DB0M1YHbr_7T4Hd9jmW4HxOZ1wXWsJYsU94LqmKDj79nLzH7UBEV_iNe7eMZa5wCgmlkgnY0gmlwhKwSbpeKbXVsdGlhZGRyc5YACASsEm6XBt3-AAoErBJulwbd_90DgnJzhQADAQAAiXNlY3AyNTZrMaED3pQ-_4jeyAKM8tN3HVfEcG2zaasGx2Lvkdis-Nbq6leDdGNwgt3-g3VkcILeAIV3YWt1Mgs --pubsub-topic=/waku/2/rs/3/1
2025-02-06 15:46:46.533 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.150.62 waku fdcdb2ef66ab84422c489fdbb278b5764fe00ee71d39c2448eb6fdbe58bf3aa5
2025-02-06 15:46:46.592 DEBUG [src.node.docker_mananger] Container started with ID fdcdb2ef66ab. Setting up logs at ./log/docker/node3_2025-02-06_15-46-32__f9ed59ed-796b-415a-b1f0-8c42647936d5__wakuorg_go-waku:latest.log
2025-02-06 15:46:46.593 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 49812
2025-02-06 15:46:46.593 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:46:47.595 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49812/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:47.597 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QA2eCuXtcOocYYcUnZvLSrK4q2jJHtIck18MsKlvX__FdJnYyZOIl-Opd0arkCMtOTkW7MA22ZVq70nKCHTpB_6GAZTb8Ti2gmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQNe4b8X5iLxeUzpfUondbwOOSxN-FX44gB9F1rOpuDWw4N0Y3CCwpWDdWRwgsKXhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/49813/p2p/16Uiu2HAmK3NKqLS5NtPUbzCdJ3xDTgzUDcTHTiNWCNMtyap99XhU","/ip4/127.0.0.1/tcp/49814/ws/p2p/16Uiu2HAmK3NKqLS5NtPUbzCdJ3xDTgzUDcTHTiNWCNMtyap99XhU","/ip4/172.17.0.4/tcp/49813/p2p/16Uiu2HAmK3NKqLS5NtPUbzCdJ3xDTgzUDcTHTiNWCNMtyap99XhU","/ip4/172.17.0.4/tcp/49814/ws/p2p/16Uiu2HAmK3NKqLS5NtPUbzCdJ3xDTgzUDcTHTiNWCNMtyap99XhU"]}'
2025-02-06 15:46:47.597 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:46:47.598 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23831/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 15:46:47.600 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-06 15:46:47.600 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56829/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 15:46:47.604 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:46:47.604 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23831/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:47.606 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-06 15:46:48.606 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23831/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:48.608 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-06 15:46:49.609 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23831/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:49.611 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-06 15:46:50.612 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23831/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:50.614 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"id":"16Uiu2HAmTdqyANujpg9zXTvHT5vLA4FtH9tc9fujeDRY5EjjniG6","multiaddrs":["/ip4/172.18.110.151/tcp/56830/p2p/16Uiu2HAmTdqyANujpg9zXTvHT5vLA4FtH9tc9fujeDRY5EjjniG6","/ip4/172.18.110.151/tcp/56831/ws/p2p/16Uiu2HAmTdqyANujpg9zXTvHT5vLA4FtH9tc9fujeDRY5EjjniG6"],"protocols":["/vac/waku/store-query/3.0.0","/vac/waku/lightpush/2.0.0-beta1","/vac/waku/store/2.0.0-beta4","/vac/waku/relay/2.0.0","/vac/waku/filter-push/2.0.0-beta1"],"connected":true,"pubsubTopics":["/waku/2/rs/3/0","/waku/2/rs/3/1"]}]'
2025-02-06 15:46:50.615 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56829/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:46:50.618 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.17.0.2/tcp/23832/p2p/16Uiu2HAmPi5uvXQsiB56HCb4dhTy9ybRS6f6CiotnEYkEpQRDq9k","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"},{"multiaddr":"/ip4/172.17.0.4/tcp/49813/p2p/16Uiu2HAmK3NKqLS5NtPUbzCdJ3xDTgzUDcTHTiNWCNMtyap99XhU","protocols":[{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
2025-02-06 15:46:50.618 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-06 15:47:20.619 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23831/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": 1738856840619157504}}'
2025-02-06 15:47:20.627 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-06 15:47:20.627 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:47:21.628 DEBUG [src.steps.store] Checking that peer wakuorg/go-waku:latest can find the stored messages
2025-02-06 15:47:21.628 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49812/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&contentTopics=%2Ftest%2F1%2Fwaku-filter%2Fproto&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:21.634 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"request_id":"70518fc6d9e94c583a3ceaa66e0459953f5adc35de714a32e880fa68151decc1","status_code":200,"status_desc":"OK","messages":[{"message_hash":"WxCSvmtsb24Y2bxQupRgm7+OIMkEg8z9HR/aala/fws="}]}'
2025-02-06 15:47:21.637 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 15:47:21.638 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 15:47:21.638 DEBUG [src.node.waku_node] Stopping container with id 2817038d48ed
2025-02-06 15:47:22.149 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:47:22.149 DEBUG [src.node.waku_node] Stopping container with id 2fd7952e248f
2025-02-06 15:47:22.962 ERROR [src.node.docker_mananger] Max retries reached for container 2817038d48ed. Exiting log stream.
2025-02-06 15:47:23.279 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:47:23.280 DEBUG [src.node.waku_node] Stopping container with id fdcdb2ef66ab
2025-02-06 15:47:23.799 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:47:23.801 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 15:47:23.806 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 15:47:23.826 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 15:47:23.829 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
