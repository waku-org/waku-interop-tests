2025-02-06 15:47:00.298 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 15:47:00.298 DEBUG [tests.conftest] Running test: test_lightpush with id: 2025-02-06_15-47-00__4af2a678-0f01-453d-a65a-599b3bab9a12
2025-02-06 15:47:00.298 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 15:47:00.299 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-06 15:47:00.299 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-06 15:47:00.299 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-06 15:47:00.299 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-06 15:47:00.306 DEBUG [src.node.docker_mananger] Docker client initialized with image quay.io/wakuorg/nwaku-pr:3281
2025-02-06 15:47:00.306 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_15-47-00__4af2a678-0f01-453d-a65a-599b3bab9a12__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:47:00.306 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:47:00.306 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:47:00.307 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:47:00.308 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.65.63
2025-02-06 15:47:00.308 DEBUG [src.node.docker_mananger] Generated ports ['43606', '43607', '43608', '43609', '43610']
2025-02-06 15:47:00.308 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:47:00.308 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:47:00.308 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:47:00.308 DEBUG [src.node.docker_mananger] docker run -i -t -p 43606:43606 -p 43607:43607 -p 43608:43608 -p 43609:43609 -p 43610:43610 quay.io/wakuorg/nwaku-pr:3281 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43608 --rest-port=43606 --tcp-port=43607 --discv5-udp-port=43609 --rest-address=0.0.0.0 --nat=extip:172.18.65.63 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f5aaeffb5dbee696e7e02eb04cfa890e30ebbbf62f778f5a518c6f4555e2fbdf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43610 --metrics-logging=true --lightpush=true --relay=true
2025-02-06 15:47:00.532 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.65.63 waku cc7dced839a3b7720485eb6a0ac2bbb423f2c95642acc2d12e89ebd5604d3e7d
2025-02-06 15:47:00.597 DEBUG [src.node.docker_mananger] Container started with ID cc7dced839a3. Setting up logs at ./log/docker/node1_2025-02-06_15-47-00__4af2a678-0f01-453d-a65a-599b3bab9a12__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:47:00.598 DEBUG [src.node.waku_node] Started container from image quay.io/wakuorg/nwaku-pr:3281. REST: 43606
2025-02-06 15:47:00.598 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:47:00.617 ERROR [src.node.docker_mananger] Max retries reached for container fc1d1b6b99c5. Exiting log stream.
2025-02-06 15:47:01.106 ERROR [src.node.docker_mananger] Max retries reached for container fe6027bf3528. Exiting log stream.
2025-02-06 15:47:01.599 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43606/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:01.602 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 15:47:01.602 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 15:47:01.602 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43606/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:01.605 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.65.63/tcp/43607/p2p/16Uiu2HAmAh3A898idbmM4V7Mbc3ji8Ub9dVEq46MzYieYvchf1LJ","/ip4/172.18.65.63/tcp/43608/ws/p2p/16Uiu2HAmAh3A898idbmM4V7Mbc3ji8Ub9dVEq46MzYieYvchf1LJ"],"enrUri":"enr:-L24QOBwjcZRxR8TfomhNjO_V-oTmQ2KCDcbNNnD9jttEZxYWbngrrIcQ0OLwYhPPUSNKtn9om5yzzWrZgmv3UjmRcQCgmlkgnY0gmlwhKwSQT-KbXVsdGlhZGRyc5YACASsEkE_BqpXAAoErBJBPwaqWN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4s72Uo8bGcmadfilO4GdDoHVuuacx0WwOzFUbB8tyW-DdGNwgqpXg3VkcIKqWYV3YWt1Mgk"}'
2025-02-06 15:47:01.605 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:47:01.612 DEBUG [src.node.docker_mananger] Docker client initialized with image quay.io/wakuorg/nwaku-pr:3281
2025-02-06 15:47:01.612 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_15-47-00__4af2a678-0f01-453d-a65a-599b3bab9a12__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:47:01.612 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:47:01.612 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:47:01.614 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:47:01.614 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.102.51
2025-02-06 15:47:01.614 DEBUG [src.node.docker_mananger] Generated ports ['62964', '62965', '62966', '62967', '62968']
2025-02-06 15:47:01.614 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:47:01.614 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:47:01.614 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:47:01.614 DEBUG [src.node.docker_mananger] docker run -i -t -p 62964:62964 -p 62965:62965 -p 62966:62966 -p 62967:62967 -p 62968:62968 quay.io/wakuorg/nwaku-pr:3281 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62966 --rest-port=62964 --tcp-port=62965 --discv5-udp-port=62967 --rest-address=0.0.0.0 --nat=extip:172.18.102.51 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=29f8719ffb2dff7dcb6f6dc16f7ae504bdc2e3d24cf89fad3f3f40adcdba1981 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62968 --metrics-logging=true --lightpush=false --relay=true --discv5-bootstrap-node=enr:-L24QOBwjcZRxR8TfomhNjO_V-oTmQ2KCDcbNNnD9jttEZxYWbngrrIcQ0OLwYhPPUSNKtn9om5yzzWrZgmv3UjmRcQCgmlkgnY0gmlwhKwSQT-KbXVsdGlhZGRyc5YACASsEkE_BqpXAAoErBJBPwaqWN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4s72Uo8bGcmadfilO4GdDoHVuuacx0WwOzFUbB8tyW-DdGNwgqpXg3VkcIKqWYV3YWt1Mgk
2025-02-06 15:47:01.842 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.102.51 waku c54b0c21ef0750cb58b42eb094403a8649c46dc934c4919734bc2cd3c67c42a4
2025-02-06 15:47:01.893 DEBUG [src.node.docker_mananger] Container started with ID c54b0c21ef07. Setting up logs at ./log/docker/node1_2025-02-06_15-47-00__4af2a678-0f01-453d-a65a-599b3bab9a12__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:47:01.894 DEBUG [src.node.waku_node] Started container from image quay.io/wakuorg/nwaku-pr:3281. REST: 62964
2025-02-06 15:47:01.894 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:47:02.896 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62964/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:02.899 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 15:47:02.899 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 15:47:02.899 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62964/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:02.901 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.102.51/tcp/62965/p2p/16Uiu2HAmMNqd1ghTM6uXXi4rCyu77omfmbgYbrLwDNNJa7q8T6TT","/ip4/172.18.102.51/tcp/62966/ws/p2p/16Uiu2HAmMNqd1ghTM6uXXi4rCyu77omfmbgYbrLwDNNJa7q8T6TT"],"enrUri":"enr:-L24QFjsRijpEYQLH_j_aSVSSKJJPKmGwwrDsRNMpL-3QQ5zCOenvlOYFYv98HRPS1p-YbgSOIDxvEfukg6_TjJdtgUCgmlkgnY0gmlwhKwSZjOKbXVsdGlhZGRyc5YACASsEmYzBvX1AAoErBJmMwb19t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDgZYFArZB2dgKRb3cNnTuT2lighb8C_BH8ZT03s2M4DKDdGNwgvX1g3VkcIL194V3YWt1MgE"}'
2025-02-06 15:47:02.901 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:47:02.907 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-06 15:47:02.908 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_15-47-00__4af2a678-0f01-453d-a65a-599b3bab9a12__wakuorg_go-waku:latest.log
2025-02-06 15:47:02.908 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:47:02.908 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:47:02.909 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:47:02.910 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.169.67
2025-02-06 15:47:02.910 DEBUG [src.node.docker_mananger] Generated ports ['49828', '49829', '49830', '49831', '49832']
2025-02-06 15:47:02.910 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:47:02.910 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:47:02.910 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:47:02.910 DEBUG [src.node.docker_mananger] docker run -i -t -p 49828:49828 -p 49829:49829 -p 49830:49830 -p 49831:49831 -p 49832:49832 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=49830 --rest-port=49828 --tcp-port=49829 --discv5-udp-port=49831 --rest-address=0.0.0.0 --nat=extip:172.18.169.67 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=54cdba035db89dbfbd5ffa3ccbca7fbf185ab87aeac887c6dd87df31a4ccef24 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --lightpush=true --relay=false --discv5-bootstrap-node=enr:-L24QOBwjcZRxR8TfomhNjO_V-oTmQ2KCDcbNNnD9jttEZxYWbngrrIcQ0OLwYhPPUSNKtn9om5yzzWrZgmv3UjmRcQCgmlkgnY0gmlwhKwSQT-KbXVsdGlhZGRyc5YACASsEkE_BqpXAAoErBJBPwaqWN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4s72Uo8bGcmadfilO4GdDoHVuuacx0WwOzFUbB8tyW-DdGNwgqpXg3VkcIKqWYV3YWt1Mgk --lightpushnode=/ip4/172.18.65.63/tcp/43607/p2p/16Uiu2HAmAh3A898idbmM4V7Mbc3ji8Ub9dVEq46MzYieYvchf1LJ --pubsub-topic=/waku/2/rs/3/1
2025-02-06 15:47:03.154 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.169.67 waku 354ed490075ba117733f786a31dc78062401f9d922a063d642f99c4cfd59cd56
2025-02-06 15:47:03.211 DEBUG [src.node.docker_mananger] Container started with ID 354ed490075b. Setting up logs at ./log/docker/node1_2025-02-06_15-47-00__4af2a678-0f01-453d-a65a-599b3bab9a12__wakuorg_go-waku:latest.log
2025-02-06 15:47:03.211 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 49828
2025-02-06 15:47:03.211 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:47:04.212 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49828/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:04.214 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QCUCgAm7sKKAZUNxz_232CY2Gdn2RIWGUBu-ldl0fh-PJ_G4O217cm9xkEUt7h2p2cx1ql1hp945WHdb-O_7zymGAZTb8XmjgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQP9LUD_9cx-CPYhwq4BEUjF0pHt_5jMFuccGAUo7IxLOIN0Y3CCwqWDdWRwgsKnhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/49829/p2p/16Uiu2HAmVhHXAiKQXmTvU1eoitriqFKomAw36UPDeUZJoJrfeR91","/ip4/127.0.0.1/tcp/49830/ws/p2p/16Uiu2HAmVhHXAiKQXmTvU1eoitriqFKomAw36UPDeUZJoJrfeR91","/ip4/172.17.0.4/tcp/49829/p2p/16Uiu2HAmVhHXAiKQXmTvU1eoitriqFKomAw36UPDeUZJoJrfeR91","/ip4/172.17.0.4/tcp/49830/ws/p2p/16Uiu2HAmVhHXAiKQXmTvU1eoitriqFKomAw36UPDeUZJoJrfeR91"]}'
2025-02-06 15:47:04.215 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:47:04.215 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43606/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 15:47:04.219 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:47:04.220 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62964/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 15:47:04.225 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:47:04.227 DEBUG [src.steps.light_push] Lightpushing message
2025-02-06 15:47:04.228 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:49828/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1738856824227696128}}'
2025-02-06 15:47:14.489 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-06 15:47:14.491 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:47:14.593 DEBUG [src.steps.light_push] Checking that peer NODE_1:quay.io/wakuorg/nwaku-pr:3281 can find the lightpushed message
2025-02-06 15:47:14.593 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43606/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:14.596 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738856824227696128,"ephemeral":false}]'
2025-02-06 15:47:14.598 DEBUG [src.steps.light_push] Checking that peer NODE_2:quay.io/wakuorg/nwaku-pr:3281 can find the lightpushed message
2025-02-06 15:47:14.598 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62964/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:47:14.600 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738856824227696128,"ephemeral":false}]'
2025-02-06 15:47:14.604 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 15:47:14.605 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 15:47:14.605 DEBUG [src.node.waku_node] Stopping container with id cc7dced839a3
2025-02-06 15:47:15.361 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:47:15.361 DEBUG [src.node.waku_node] Stopping container with id c54b0c21ef07
2025-02-06 15:47:16.174 ERROR [src.node.docker_mananger] Max retries reached for container cc7dced839a3. Exiting log stream.
2025-02-06 15:47:16.337 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:47:16.337 DEBUG [src.node.waku_node] Stopping container with id 354ed490075b
2025-02-06 15:47:16.846 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:47:16.847 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 15:47:16.856 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 15:47:16.864 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 15:47:16.866 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
