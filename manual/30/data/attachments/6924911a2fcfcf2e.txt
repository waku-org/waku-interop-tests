2025-02-06 15:36:20.692 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 15:36:20.692 DEBUG [tests.conftest] Running test: test_filter_get_message_with_valid_timestamps with id: 2025-02-06_15-36-20__11c5ef30-91f4-46fd-acb0-8687ca89212f
2025-02-06 15:36:20.693 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 15:36:20.693 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-06 15:36:20.693 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-06 15:36:20.702 DEBUG [src.node.docker_mananger] Docker client initialized with image quay.io/wakuorg/nwaku-pr:3281
2025-02-06 15:36:20.702 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_15-36-20__11c5ef30-91f4-46fd-acb0-8687ca89212f__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:36:20.702 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:36:20.702 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:36:20.770 DEBUG [src.node.docker_mananger] Network waku created
2025-02-06 15:36:20.770 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.191.17
2025-02-06 15:36:20.770 DEBUG [src.node.docker_mananger] Generated ports ['59904', '59905', '59906', '59907', '59908']
2025-02-06 15:36:20.770 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:36:20.770 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:36:20.770 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:36:20.771 DEBUG [src.node.docker_mananger] docker run -i -t -p 59904:59904 -p 59905:59905 -p 59906:59906 -p 59907:59907 -p 59908:59908 quay.io/wakuorg/nwaku-pr:3281 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59906 --rest-port=59904 --tcp-port=59905 --discv5-udp-port=59907 --rest-address=0.0.0.0 --nat=extip:172.18.191.17 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ef98587edcc6cbdfb6bc5dfb1becd5ef91afdade85c2dcb70d8adff706a8cf4c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59908 --metrics-logging=true --relay=true --filter=true
2025-02-06 15:36:24.613 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.191.17 waku e5db42f44c997a007618278ce0eae6286f312275c057de6d2a1b748b3c5d2128
2025-02-06 15:36:24.670 DEBUG [src.node.docker_mananger] Container started with ID e5db42f44c99. Setting up logs at ./log/docker/node1_2025-02-06_15-36-20__11c5ef30-91f4-46fd-acb0-8687ca89212f__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:36:24.670 DEBUG [src.node.waku_node] Started container from image quay.io/wakuorg/nwaku-pr:3281. REST: 59904
2025-02-06 15:36:24.671 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:36:25.672 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59904/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:25.675 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 15:36:25.675 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 15:36:25.675 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59904/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:25.678 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.191.17/tcp/59905/p2p/16Uiu2HAmVaPLuGfCpzv6cx1uXyPk3KfAjF2cGcfri13MDNeKPaVC","/ip4/172.18.191.17/tcp/59906/ws/p2p/16Uiu2HAmVaPLuGfCpzv6cx1uXyPk3KfAjF2cGcfri13MDNeKPaVC"],"enrUri":"enr:-L24QFA2HR4_gHoXED-QhJkkzTOuGGFFIe-O6mym9YmzmwX-R_NoGPGwJExNGqCdlF6YhOQGeFIDrw9h3HdMAXD63PsCgmlkgnY0gmlwhKwSvxGKbXVsdGlhZGRyc5YACASsEr8RBuoBAAoErBK_EQbqAt0DgnJzhQADAQAAiXNlY3AyNTZrMaED-2jFtwzHuiYdomcqIGle2UtLWezFsQdl5QabiZxzQ_eDdGNwguoBg3VkcILqA4V3YWt1MgU"}'
2025-02-06 15:36:25.678 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:36:25.678 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-06 15:36:25.684 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-06 15:36:25.685 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_15-36-20__11c5ef30-91f4-46fd-acb0-8687ca89212f__wakuorg_go-waku:latest.log
2025-02-06 15:36:25.685 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:36:25.685 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:36:25.686 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:36:25.686 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.199.176
2025-02-06 15:36:25.687 DEBUG [src.node.docker_mananger] Generated ports ['44592', '44593', '44594', '44595', '44596']
2025-02-06 15:36:25.687 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:36:25.687 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:36:25.687 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:36:25.687 DEBUG [src.node.docker_mananger] docker run -i -t -p 44592:44592 -p 44593:44593 -p 44594:44594 -p 44595:44595 -p 44596:44596 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=44594 --rest-port=44592 --tcp-port=44593 --discv5-udp-port=44595 --rest-address=0.0.0.0 --nat=extip:172.18.199.176 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c6de96c2d7bebdcad3593290bbe6ae63bf4d79dccc98da0ccf41ebbbb824deea --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QFA2HR4_gHoXED-QhJkkzTOuGGFFIe-O6mym9YmzmwX-R_NoGPGwJExNGqCdlF6YhOQGeFIDrw9h3HdMAXD63PsCgmlkgnY0gmlwhKwSvxGKbXVsdGlhZGRyc5YACASsEr8RBuoBAAoErBK_EQbqAt0DgnJzhQADAQAAiXNlY3AyNTZrMaED-2jFtwzHuiYdomcqIGle2UtLWezFsQdl5QabiZxzQ_eDdGNwguoBg3VkcILqA4V3YWt1MgU --filternode=/ip4/172.18.191.17/tcp/59905/p2p/16Uiu2HAmVaPLuGfCpzv6cx1uXyPk3KfAjF2cGcfri13MDNeKPaVC --pubsub-topic=/waku/2/rs/3/1
2025-02-06 15:36:28.598 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.199.176 waku 6f0b7578369ef70f9e27599e3dedcd11f04c2c2bb2600a551ace358876c1bbbc
2025-02-06 15:36:28.658 DEBUG [src.node.docker_mananger] Container started with ID 6f0b7578369e. Setting up logs at ./log/docker/node2_2025-02-06_15-36-20__11c5ef30-91f4-46fd-acb0-8687ca89212f__wakuorg_go-waku:latest.log
2025-02-06 15:36:28.660 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 44592
2025-02-06 15:36:28.660 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:36:29.661 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:29.664 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QI99T7ZbU11xT_SKy5B3jOrqxr1HpsT-SpOaEira7KmPNl8hHnjuqXqBdWsejg88vLN9x5elfWYsSfqWOhKzyu6GAZTb58rjgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQPjWlPurR7cmPo0ZO2GCz11EAtJz-p_5ivFGi2zRFV7tIN0Y3CCrjGDdWRwgq4zhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/44593/p2p/16Uiu2HAmTxUnT6sVLCLptoukNwHRrFfpEtLKGUSedSv2knicx92s","/ip4/127.0.0.1/tcp/44594/ws/p2p/16Uiu2HAmTxUnT6sVLCLptoukNwHRrFfpEtLKGUSedSv2knicx92s","/ip4/172.17.0.3/tcp/44593/p2p/16Uiu2HAmTxUnT6sVLCLptoukNwHRrFfpEtLKGUSedSv2knicx92s","/ip4/172.17.0.3/tcp/44594/ws/p2p/16Uiu2HAmTxUnT6sVLCLptoukNwHRrFfpEtLKGUSedSv2knicx92s"]}'
2025-02-06 15:36:29.664 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:36:29.665 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44592/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.191.17/tcp/59905/p2p/16Uiu2HAmVaPLuGfCpzv6cx1uXyPk3KfAjF2cGcfri13MDNeKPaVC", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-06 15:36:29.666 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-06 15:36:29.667 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-06 15:36:29.667 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 15:36:29.670 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:29.671 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44592/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d34bc881-af5d-4532-8b46-e157b06a91c7", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 15:36:29.677 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"d34bc881-af5d-4532-8b46-e157b06a91c7","statusDesc":"OK"}'
2025-02-06 15:36:29.678 DEBUG [tests.filter.test_get_messages] Running test with timestamp Now
2025-02-06 15:36:29.679 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:36:29.685 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:29.686 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:36:29.786 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:36:29.787 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:29.789 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738856180179401984,"ephemeral":false}]'
2025-02-06 15:36:29.791 DEBUG [tests.filter.test_get_messages] Running test with timestamp Far future
2025-02-06 15:36:29.791 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:36:29.798 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:29.799 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:36:29.899 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:36:29.899 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:29.902 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":2054216180179387136,"ephemeral":false}]'
2025-02-06 15:36:29.903 DEBUG [tests.filter.test_get_messages] Running test with timestamp Recent past
2025-02-06 15:36:29.904 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:36:29.911 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:29.911 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:36:30.012 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:36:30.012 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:30.014 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738852580179387136,"ephemeral":false}]'
2025-02-06 15:36:30.016 DEBUG [tests.filter.test_get_messages] Running test with timestamp Near future
2025-02-06 15:36:30.017 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:36:30.024 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:30.024 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:36:30.124 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:36:30.125 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:30.127 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738859780179387136,"ephemeral":false}]'
2025-02-06 15:36:30.129 DEBUG [tests.filter.test_get_messages] Running test with timestamp Positive number
2025-02-06 15:36:30.129 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:36:30.136 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:30.137 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:36:30.237 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:36:30.238 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:30.240 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1,"ephemeral":false}]'
2025-02-06 15:36:30.242 DEBUG [tests.filter.test_get_messages] Running test with timestamp Negative number
2025-02-06 15:36:30.242 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:36:30.249 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:30.249 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:36:30.350 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:36:30.350 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:30.352 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":-1,"ephemeral":false}]'
2025-02-06 15:36:30.354 DEBUG [tests.filter.test_get_messages] Running test with timestamp DST change
2025-02-06 15:36:30.354 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:36:30.361 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:36:30.361 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 15:36:30.461 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 15:36:30.462 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44592/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:36:30.464 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1583632800000000000,"ephemeral":false}]'
2025-02-06 15:36:30.467 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 15:36:30.468 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 15:36:30.469 DEBUG [src.node.waku_node] Stopping container with id e5db42f44c99
2025-02-06 15:36:31.267 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:36:31.267 DEBUG [src.node.waku_node] Stopping container with id 6f0b7578369e
2025-02-06 15:36:31.792 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:36:31.793 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 15:36:31.799 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 15:36:31.803 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
