2025-02-06 15:37:58.071 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 15:37:58.071 DEBUG [tests.conftest] Running test: test_store_with_peerAddr with id: 2025-02-06_15-37-58__67a20c5a-4bab-4601-bda1-f78c9f3d5072
2025-02-06 15:37:58.071 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 15:37:58.072 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-06 15:37:58.072 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-06 15:37:58.078 DEBUG [src.node.docker_mananger] Docker client initialized with image quay.io/wakuorg/nwaku-pr:3281
2025-02-06 15:37:58.078 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-06_15-37-58__67a20c5a-4bab-4601-bda1-f78c9f3d5072__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:37:58.079 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:37:58.079 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:37:58.080 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:37:58.080 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.127.6
2025-02-06 15:37:58.080 DEBUG [src.node.docker_mananger] Generated ports ['26217', '26218', '26219', '26220', '26221']
2025-02-06 15:37:58.081 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:37:58.081 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:37:58.081 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:37:58.081 DEBUG [src.node.docker_mananger] docker run -i -t -p 26217:26217 -p 26218:26218 -p 26219:26219 -p 26220:26220 -p 26221:26221 quay.io/wakuorg/nwaku-pr:3281 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26219 --rest-port=26217 --tcp-port=26218 --discv5-udp-port=26220 --rest-address=0.0.0.0 --nat=extip:172.18.127.6 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ce953710b74b69ff58062feced1f11cdddec6a84edd14a9d2cdfb2f24d1e6d8f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26221 --metrics-logging=true --store=true --relay=true
2025-02-06 15:37:58.194 ERROR [src.node.docker_mananger] Max retries reached for container 172ee1e41559. Exiting log stream.
2025-02-06 15:37:58.312 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.127.6 waku 5d879e60ee57316ed5260e5a65d1cbe7095c6f6153fa61de4ba1f798bf42040b
2025-02-06 15:37:58.362 DEBUG [src.node.docker_mananger] Container started with ID 5d879e60ee57. Setting up logs at ./log/docker/publishing_node1_2025-02-06_15-37-58__67a20c5a-4bab-4601-bda1-f78c9f3d5072__quay.io_wakuorg_nwaku-pr:3281.log
2025-02-06 15:37:58.363 DEBUG [src.node.waku_node] Started container from image quay.io/wakuorg/nwaku-pr:3281. REST: 26217
2025-02-06 15:37:58.363 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:37:58.864 ERROR [src.node.docker_mananger] Max retries reached for container fca7aa4538d1. Exiting log stream.
2025-02-06 15:37:59.364 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26217/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:37:59.366 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 15:37:59.367 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 15:37:59.367 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26217/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:37:59.369 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.127.6/tcp/26218/p2p/16Uiu2HAmRogA7a2HKXP2taVxQezcsRvK1NcnVTXjMrK8x9EuRGD2","/ip4/172.18.127.6/tcp/26219/ws/p2p/16Uiu2HAmRogA7a2HKXP2taVxQezcsRvK1NcnVTXjMrK8x9EuRGD2"],"enrUri":"enr:-L24QN2NQmtc5zgx-zRuxZtZUxnpYpcdRTkRasc4P8ugXLnKJ_50IhH0cD8rp5-P-WxDADSLu9RC4eK2dKjxWT-VgXACgmlkgnY0gmlwhKwSfwaKbXVsdGlhZGRyc5YACASsEn8GBmZqAAoErBJ_BgZma90DgnJzhQADAQAAiXNlY3AyNTZrMaEDw2GWN8UNwVSSnxBbiWeW8oEaFrkM6PokOkny-GckTnWDdGNwgmZqg3VkcIJmbIV3YWt1MgM"}'
2025-02-06 15:37:59.369 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:37:59.376 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-06 15:37:59.376 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-06_15-37-58__67a20c5a-4bab-4601-bda1-f78c9f3d5072__wakuorg_go-waku:latest.log
2025-02-06 15:37:59.376 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 15:37:59.376 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 15:37:59.378 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 15:37:59.378 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.195.234
2025-02-06 15:37:59.378 DEBUG [src.node.docker_mananger] Generated ports ['50883', '50884', '50885', '50886', '50887']
2025-02-06 15:37:59.378 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 15:37:59.378 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 15:37:59.378 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 15:37:59.378 DEBUG [src.node.docker_mananger] docker run -i -t -p 50883:50883 -p 50884:50884 -p 50885:50885 -p 50886:50886 -p 50887:50887 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=50885 --rest-port=50883 --tcp-port=50884 --discv5-udp-port=50886 --rest-address=0.0.0.0 --nat=extip:172.18.195.234 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f32d2ed2c2a3f7658ba0d6af1ab9ed8807f4243289efde1d80165aa8a6dcf2ef --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QN2NQmtc5zgx-zRuxZtZUxnpYpcdRTkRasc4P8ugXLnKJ_50IhH0cD8rp5-P-WxDADSLu9RC4eK2dKjxWT-VgXACgmlkgnY0gmlwhKwSfwaKbXVsdGlhZGRyc5YACASsEn8GBmZqAAoErBJ_BgZma90DgnJzhQADAQAAiXNlY3AyNTZrMaEDw2GWN8UNwVSSnxBbiWeW8oEaFrkM6PokOkny-GckTnWDdGNwgmZqg3VkcIJmbIV3YWt1MgM --storenode=/ip4/172.18.127.6/tcp/26218/p2p/16Uiu2HAmRogA7a2HKXP2taVxQezcsRvK1NcnVTXjMrK8x9EuRGD2 --store=true --relay=true
2025-02-06 15:37:59.619 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.195.234 waku a28281b018a12497824ad2fcfae49bb03f7302a91df26f1f89c676577ac346fa
2025-02-06 15:37:59.675 DEBUG [src.node.docker_mananger] Container started with ID a28281b018a1. Setting up logs at ./log/docker/store_node1_2025-02-06_15-37-58__67a20c5a-4bab-4601-bda1-f78c9f3d5072__wakuorg_go-waku:latest.log
2025-02-06 15:37:59.676 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 50883
2025-02-06 15:37:59.677 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 15:38:00.678 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50883/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:38:00.680 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QOr4x0hE_Gq4bq0teQLotvm4PE5ozx28hXSOTx2GvyVpa74HCZrjcH5a6hVD623hV3aKe9fiwXZ1C6xIX_WwFCSGAZTb6S54gmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDqwa01hHeCmZpgpNCWRpTyFZayDJXVL6kTB-XKa_equKDdGNwgsbEg3VkcILGxoV3YWt1MgM","listenAddresses":["/ip4/127.0.0.1/tcp/50884/p2p/16Uiu2HAmQAbzquFSrwHH6uDP2h88pvwmVfMhPZKZfwoPgWX3bKiZ","/ip4/127.0.0.1/tcp/50885/ws/p2p/16Uiu2HAmQAbzquFSrwHH6uDP2h88pvwmVfMhPZKZfwoPgWX3bKiZ","/ip4/172.17.0.3/tcp/50884/p2p/16Uiu2HAmQAbzquFSrwHH6uDP2h88pvwmVfMhPZKZfwoPgWX3bKiZ","/ip4/172.17.0.3/tcp/50885/ws/p2p/16Uiu2HAmQAbzquFSrwHH6uDP2h88pvwmVfMhPZKZfwoPgWX3bKiZ"]}'
2025-02-06 15:38:00.681 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 15:38:00.681 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50883/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.127.6/tcp/26218/p2p/16Uiu2HAmRogA7a2HKXP2taVxQezcsRvK1NcnVTXjMrK8x9EuRGD2", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-06 15:38:00.700 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-06 15:38:00.701 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26217/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 15:38:00.707 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:38:00.707 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50883/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 15:38:00.709 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-06 15:38:00.712 DEBUG [src.steps.store] Relaying message
2025-02-06 15:38:00.713 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26217/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 15:38:00.726 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 15:38:00.728 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-06 15:38:00.928 DEBUG [src.steps.store] Checking that peer wakuorg/go-waku:latest can find the stored messages
2025-02-06 15:38:00.929 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50883/store/v3/messages?peerAddr=%2Fip4%2F172.18.127.6%2Ftcp%2F26218%2Fp2p%2F16Uiu2HAmRogA7a2HKXP2taVxQezcsRvK1NcnVTXjMrK8x9EuRGD2&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-06 15:38:00.934 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"request_id":"64a24b78813afb0533cbec003b412c5b7e7bd6de090beccbdbcf9b8661140f6a","status_code":200,"status_desc":"OK","messages":[{"message_hash":"jm2c2Bn5J2wiIwN+Qvx1mh4Pd7w3n//pVWG8CtaQUy4="}]}'
2025-02-06 15:38:00.937 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 15:38:00.938 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 15:38:00.938 DEBUG [src.node.waku_node] Stopping container with id 5d879e60ee57
2025-02-06 15:38:01.543 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:38:01.543 DEBUG [src.node.waku_node] Stopping container with id a28281b018a1
2025-02-06 15:38:02.186 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 15:38:02.188 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 15:38:02.193 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 15:38:02.197 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
