[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_valid_version with id: 2024-09-13_09-50-47__991ef58b-2079-4a0f-a94f-c51c9ae52e6b
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3036
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-13_09-50-47__991ef58b-2079-4a0f-a94f-c51c9ae52e6b__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.239.91
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['45592', '45593', '45594', '45595', '45596']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 45592:45592 -p 45593:45593 -p 45594:45594 -p 45595:45595 -p 45596:45596 quay.io/wakuorg/nwaku-pr:3036 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45594 --rest-port=45592 --tcp-port=45593 --discv5-udp-port=45595 --rest-address=0.0.0.0 --nat=extip:172.18.239.91 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cad3cc9e9e2e5fdb2ea2a6b633daeef6f70fdc9fc64e0716ef3c26840a2dfe6c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45596 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.239.91 waku 3b95916bbcfa1dae66c143d46f9f8c360479ab53c32d27554e0b8edb934d6c68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 3b95916bbcfa. Setting up logs at ./log/docker/receiving_node1_2024-09-13_09-50-47__991ef58b-2079-4a0f-a94f-c51c9ae52e6b__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image quay.io/wakuorg/nwaku-pr:3036. REST: 45592
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45592/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45592/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.239.91/tcp/45593/p2p/16Uiu2HAm8dQmiiotdNJ2aD9iRTttNFreeTvp5y1Uuw2og5LdSv1t","/ip4/172.18.239.91/tcp/45594/ws/p2p/16Uiu2HAm8dQmiiotdNJ2aD9iRTttNFreeTvp5y1Uuw2og5LdSv1t"],"enrUri":"enr:-LO4QH-lm9pwOee0omQFRgu3-Su9Ya663yrd7LaGatSXhDcIBQxLNAj6VFw0lCg22HDPKY3aKQzyC2I8Jwe6JK_mW8EBgmlkgnY0gmlwhKwS71uKbXVsdGlhZGRyc4wACgSsEu9bBrIa3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLEKbQuFw8OqVslYh2d4l6vWem0MQzVOmxMbVt9Od7aL4N0Y3CCshmDdWRwgrIbhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3036
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-13_09-50-47__991ef58b-2079-4a0f-a94f-c51c9ae52e6b__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.184.46
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['5246', '5247', '5248', '5249', '5250']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 5246:5246 -p 5247:5247 -p 5248:5248 -p 5249:5249 -p 5250:5250 quay.io/wakuorg/nwaku-pr:3036 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5248 --rest-port=5246 --tcp-port=5247 --discv5-udp-port=5249 --rest-address=0.0.0.0 --nat=extip:172.18.184.46 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4ae9e5d3eab974ef8a4abe648bfab27ff5dbdc9f7df8bd9fde65b0ff9afadc51 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5250 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.184.46 waku cd3db37edb8ffeb0d5bfeb3fbcaea47ef22acc47a4d479ab9f2956c63f066967
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID cd3db37edb8f. Setting up logs at ./log/docker/receiving_node2_2024-09-13_09-50-47__991ef58b-2079-4a0f-a94f-c51c9ae52e6b__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image quay.io/wakuorg/nwaku-pr:3036. REST: 5246
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5246/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5246/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.184.46/tcp/5247/p2p/16Uiu2HAmUsvRi5Dy4xaVMAbsXQ9cBmuBuB9QrbkWBZ3FDhVeHKLX","/ip4/172.18.184.46/tcp/5248/ws/p2p/16Uiu2HAmUsvRi5Dy4xaVMAbsXQ9cBmuBuB9QrbkWBZ3FDhVeHKLX"],"enrUri":"enr:-LO4QEtgnFyN4jDg3FrXSjIssFVTz6hsJw8azelC9SagkQe7aWzPjEAdNBAZ63dFoOWNbO95I2s_r5dT1R9-6gQIaIQBgmlkgnY0gmlwhKwSuC6KbXVsdGlhZGRyc4wACgSsErguBhSA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPxCxrL-aVAz5Jx_z-FnjUqU3FVbWf598-b86__US_uRIN0Y3CCFH-DdWRwghSBhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5246/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.239.91/tcp/45593/p2p/16Uiu2HAm8dQmiiotdNJ2aD9iRTttNFreeTvp5y1Uuw2og5LdSv1t"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image quay.io/wakuorg/nwaku-pr:3036
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-13_09-50-47__991ef58b-2079-4a0f-a94f-c51c9ae52e6b__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.1.216
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['42831', '42832', '42833', '42834', '42835']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 42831:42831 -p 42832:42832 -p 42833:42833 -p 42834:42834 -p 42835:42835 quay.io/wakuorg/nwaku-pr:3036 --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42833 --rest-port=42831 --tcp-port=42832 --discv5-udp-port=42834 --rest-address=0.0.0.0 --nat=extip:172.18.1.216 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ca05af5ed7a29bfbeb223f28be926ec3c99c585d66f13b6c0152ecda70c89afb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42835 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QH-lm9pwOee0omQFRgu3-Su9Ya663yrd7LaGatSXhDcIBQxLNAj6VFw0lCg22HDPKY3aKQzyC2I8Jwe6JK_mW8EBgmlkgnY0gmlwhKwS71uKbXVsdGlhZGRyc4wACgSsEu9bBrIa3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLEKbQuFw8OqVslYh2d4l6vWem0MQzVOmxMbVt9Od7aL4N0Y3CCshmDdWRwgrIbhXdha3UyCQ --lightpushnode=/ip4/172.18.239.91/tcp/45593/p2p/16Uiu2HAm8dQmiiotdNJ2aD9iRTttNFreeTvp5y1Uuw2og5LdSv1t --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.1.216 waku aad954926442af5737998f7f4804d4afa0f0918310fab818d10c78fd21bb489a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID aad954926442. Setting up logs at ./log/docker/lightpush_node1_2024-09-13_09-50-47__991ef58b-2079-4a0f-a94f-c51c9ae52e6b__quay.io_wakuorg_nwaku-pr:3036.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image quay.io/wakuorg/nwaku-pr:3036. REST: 42831
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42831/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42831/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.1.216/tcp/42832/p2p/16Uiu2HAkxWYDrNEskiL1h5Baa72v4shty7RHCiHUtrR3QDBAXsBJ","/ip4/172.18.1.216/tcp/42833/ws/p2p/16Uiu2HAkxWYDrNEskiL1h5Baa72v4shty7RHCiHUtrR3QDBAXsBJ"],"enrUri":"enr:-LO4QMNfLVIuklCXJVik70L-YqIj6D6aYEQ5cnezcyTt1S2WBz3sp4Tli7VwS0WfMv51IxjYPYJ8CqXqaz4WxWNVLlQBgmlkgnY0gmlwhKwSAdiKbXVsdGlhZGRyc4wACgSsEgHYBqdR3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIt0jF5tOBb9LZ98Bxjp0ro96vjfANZN-JaIq3xi-OsXYN0Y3CCp1CDdWRwgqdShXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42831/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.239.91/tcp/45593/p2p/16Uiu2HAm8dQmiiotdNJ2aD9iRTttNFreeTvp5y1Uuw2og5LdSv1t"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42831/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.184.46/tcp/5247/p2p/16Uiu2HAmUsvRi5Dy4xaVMAbsXQ9cBmuBuB9QrbkWBZ3FDhVeHKLX"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45592/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5246/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42831/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726221053898673408, "version": 10}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:quay.io/wakuorg/nwaku-pr:3036 can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45592/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":10,"timestamp":1726221053898673408,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:quay.io/wakuorg/nwaku-pr:3036 can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5246/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":10,"timestamp":1726221053898673408,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3b95916bbcfa
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id cd3db37edb8f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id aad954926442
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.