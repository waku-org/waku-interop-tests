[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2024-12-21_04-08-37__22370573-a104-4ce4-b1bb-d7d23520d9f8
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-21_04-08-37__22370573-a104-4ce4-b1bb-d7d23520d9f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-21_04-08-37__22370573-a104-4ce4-b1bb-d7d23520d9f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-12-21_04-08-37__22370573-a104-4ce4-b1bb-d7d23520d9f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:389 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.69.58
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29654', '29655', '29656', '29657', '29658']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29654:29654 -p 29655:29655 -p 29656:29656 -p 29657:29657 -p 29658:29658 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29656 --rest-port=29654 --tcp-port=29655 --discv5-udp-port=29657 --rest-address=0.0.0.0 --nat=extip:172.18.69.58 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=edfad717f8ded60c8fdfff4597ea9af68cf85c59e33a7735a10d5e6ca405cc0f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29658 --metrics-logging=true --relay=true --store=true
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 0a74bb351de4. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.69.58 waku ad0bb94dc589da345090d37fb7ab54b42a2465138c84200a0b72c4ac44b75321
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ad0bb94dc589. Setting up logs at ./log/docker/node1_2024-12-21_04-08-37__22370573-a104-4ce4-b1bb-d7d23520d9f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 29654
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29654/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29654/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.69.58/tcp/29655/p2p/16Uiu2HAm9bNH9qew1nDVJ1Q9AXtGHwN15vUVPwBReYvRSHGQGocH","/ip4/172.18.69.58/tcp/29656/ws/p2p/16Uiu2HAm9bNH9qew1nDVJ1Q9AXtGHwN15vUVPwBReYvRSHGQGocH"],"enrUri":"enr:-L24QDdJqGfPgw85k5syXes638Uiw_j4XPM4Ibp4sYs5UxUheXjzDQzEjYpmciQvGNjG_8-0qWp8spegKVkJSYucTUcCgmlkgnY0gmlwhKwSRTqKbXVsdGlhZGRyc5YACASsEkU6BnPXAAoErBJFOgZz2N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC0n9pK4G4EpYnzyXpjeqwZwqnUsPKpoeLVXWB2_osBh6DdGNwgnPXg3VkcIJz2YV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.205.218
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['16394', '16395', '16396', '16397', '16398']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 16394:16394 -p 16395:16395 -p 16396:16396 -p 16397:16397 -p 16398:16398 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16396 --rest-port=16394 --tcp-port=16395 --discv5-udp-port=16397 --rest-address=0.0.0.0 --nat=extip:172.18.205.218 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=69cd9e01a1f503197eeca68dc5cdbca45ea4de28a603d0a18571d305abb72f6a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16398 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QDdJqGfPgw85k5syXes638Uiw_j4XPM4Ibp4sYs5UxUheXjzDQzEjYpmciQvGNjG_8-0qWp8spegKVkJSYucTUcCgmlkgnY0gmlwhKwSRTqKbXVsdGlhZGRyc5YACASsEkU6BnPXAAoErBJFOgZz2N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC0n9pK4G4EpYnzyXpjeqwZwqnUsPKpoeLVXWB2_osBh6DdGNwgnPXg3VkcIJz2YV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.205.218 waku 2fa38b5d34bb059a242bad8cc353f5978f2e85215dc463b053ab33286da06075
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2fa38b5d34bb. Setting up logs at ./log/docker/node2_2024-12-21_04-08-37__22370573-a104-4ce4-b1bb-d7d23520d9f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 16394
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16394/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16394/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.205.218/tcp/16395/p2p/16Uiu2HAmHAdfXP5Aexn3yDcfsgnCEMhKZ217UdxS3PY1CRpnuhhA","/ip4/172.18.205.218/tcp/16396/ws/p2p/16Uiu2HAmHAdfXP5Aexn3yDcfsgnCEMhKZ217UdxS3PY1CRpnuhhA"],"enrUri":"enr:-L24QClSx9zsa8Ga3Bgd45FDSIaiZ_5cxzlecvG6k5C0n_HPEl0uCPpuSxZKbcqcZ2vbXXZlHbX91C43GOxuyuZjiOUCgmlkgnY0gmlwhKwSzdqKbXVsdGlhZGRyc5YACASsEs3aBkALAAoErBLN2gZADN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDQwbIXiCCU0Ciq5o84n_tpREz2iq-DbNmY1AZk6AesomDdGNwgkALg3VkcIJADYV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.63.121
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59174', '59175', '59176', '59177', '59178']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59174:59174 -p 59175:59175 -p 59176:59176 -p 59177:59177 -p 59178:59178 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59176 --rest-port=59174 --tcp-port=59175 --discv5-udp-port=59177 --rest-address=0.0.0.0 --nat=extip:172.18.63.121 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6aa6dd6381edd6da83facafdcd242dcbefd4fc8991eec6e8dd439e44fa558e9b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59178 --metrics-logging=true --relay=false --storenode=/ip4/172.18.205.218/tcp/16395/p2p/16Uiu2HAmHAdfXP5Aexn3yDcfsgnCEMhKZ217UdxS3PY1CRpnuhhA --discv5-bootstrap-node=enr:-L24QClSx9zsa8Ga3Bgd45FDSIaiZ_5cxzlecvG6k5C0n_HPEl0uCPpuSxZKbcqcZ2vbXXZlHbX91C43GOxuyuZjiOUCgmlkgnY0gmlwhKwSzdqKbXVsdGlhZGRyc5YACASsEs3aBkALAAoErBLN2gZADN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDQwbIXiCCU0Ciq5o84n_tpREz2iq-DbNmY1AZk6AesomDdGNwgkALg3VkcIJADYV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.63.121 waku 8b23737cdb69b89c52191157e96e587050a9c01a40dfd7ebc3d5a80e76bc9503
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 8b23737cdb69. Setting up logs at ./log/docker/node3_2024-12-21_04-08-37__22370573-a104-4ce4-b1bb-d7d23520d9f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 59174
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59174/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59174/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.63.121/tcp/59175/p2p/16Uiu2HAmSFi6DHm4Q2SM2iuARvgdZDposFgtv5MVgAnXzDFHbfwB","/ip4/172.18.63.121/tcp/59176/ws/p2p/16Uiu2HAmSFi6DHm4Q2SM2iuARvgdZDposFgtv5MVgAnXzDFHbfwB"],"enrUri":"enr:-L24QHvy07wpjH_sSTMrukpSg-MQvL87pwuDqe4Un-Ma6GSqBJfJyYrgSlT80Li9upur9pJZ9f5Cmx0QLD2pV-_RndYCgmlkgnY0gmlwhKwSP3mKbXVsdGlhZGRyc5YACASsEj95BucnAAoErBI_eQbnKN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDygzfiF4GThn8OkeXp0mMZC04l-Dooev88E7ljiV_pi6DdGNwgucng3VkcILnKYV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:394 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29654/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16394/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29654/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.205.218/tcp/16395/p2p/16Uiu2HAmHAdfXP5Aexn3yDcfsgnCEMhKZ217UdxS3PY1CRpnuhhA","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16394/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.69.58/tcp/29655/p2p/16Uiu2HAm9bNH9qew1nDVJ1Q9AXtGHwN15vUVPwBReYvRSHGQGocH","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:399 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29654/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:404 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59174/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"7f6e8d26f4a9c799b9ee","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:408 Response for store when ephemeral = true is strPeer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '7f6e8d26f4a9c799b9ee', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:410 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id ad0bb94dc589
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 2fa38b5d34bb
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ad0bb94dc589. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 8b23737cdb69
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 2fa38b5d34bb. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.