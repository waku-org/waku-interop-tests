[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_subscribe_refresh with id: 2024-09-01_04-17-56__30fb6957-b198-401d-aab7-ff66b335cdd1
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-01_04-17-56__30fb6957-b198-401d-aab7-ff66b335cdd1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.95.136
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['10020', '10021', '10022', '10023', '10024']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 10020:10020 -p 10021:10021 -p 10022:10022 -p 10023:10023 -p 10024:10024 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10022 --rest-port=10020 --tcp-port=10021 --discv5-udp-port=10023 --rest-address=0.0.0.0 --nat=extip:172.18.95.136 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c5ccd080e5b6c8507d07d3ff9be096da74ceafd55ffdbe099e0387620bf294fe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10024 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.95.136 waku 1a48ecd3d0d768aae96863a336336310de1a83c5ce6f8be9cfd85972d42d5931
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 1a48ecd3d0d7. Setting up logs at ./log/docker/node1_2024-09-01_04-17-56__30fb6957-b198-401d-aab7-ff66b335cdd1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 10020
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10020/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10020/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.95.136/tcp/10021/p2p/16Uiu2HAmRhnGe9XuiKTSJ3rKV2FKrErVk5wkz7HRtqVmnKePXD29","/ip4/172.18.95.136/tcp/10022/ws/p2p/16Uiu2HAmRhnGe9XuiKTSJ3rKV2FKrErVk5wkz7HRtqVmnKePXD29"],"enrUri":"enr:-LO4QEA939YXoNbLeQYkeF9kD3tjAKy94MWTs2OLnyXXPuDbC2m0W9Mukz0m_L_mpqrs0_BJKL4qHwH67j-x8Zp9YYkBgmlkgnY0gmlwhKwSX4iKbXVsdGlhZGRyc4wACgSsEl-IBicm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPB3wNuXPy_h9mICZMkk4qTpOVmRiuEhnZeR9Rq65NzIoN0Y3CCJyWDdWRwgicnhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-01_04-17-56__30fb6957-b198-401d-aab7-ff66b335cdd1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.71.76
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['9836', '9837', '9838', '9839', '9840']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 9836:9836 -p 9837:9837 -p 9838:9838 -p 9839:9839 -p 9840:9840 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9838 --rest-port=9836 --tcp-port=9837 --discv5-udp-port=9839 --rest-address=0.0.0.0 --nat=extip:172.18.71.76 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4d4afbd99ed71fdbe02bb6f6f346ad466dbaf0ccbedeb0baafd4846e5ecceda9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9840 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QEA939YXoNbLeQYkeF9kD3tjAKy94MWTs2OLnyXXPuDbC2m0W9Mukz0m_L_mpqrs0_BJKL4qHwH67j-x8Zp9YYkBgmlkgnY0gmlwhKwSX4iKbXVsdGlhZGRyc4wACgSsEl-IBicm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPB3wNuXPy_h9mICZMkk4qTpOVmRiuEhnZeR9Rq65NzIoN0Y3CCJyWDdWRwgicnhXdha3UyBQ --filternode=/ip4/172.18.95.136/tcp/10021/p2p/16Uiu2HAmRhnGe9XuiKTSJ3rKV2FKrErVk5wkz7HRtqVmnKePXD29
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.71.76 waku bac95ded5d8b0cefa2a09f93d9414c7e9ac489b1e79420c7a8e0fd0143506916
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID bac95ded5d8b. Setting up logs at ./log/docker/node2_2024-09-01_04-17-56__30fb6957-b198-401d-aab7-ff66b335cdd1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 9836
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9836/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9836/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.71.76/tcp/9837/p2p/16Uiu2HAm4cNcFcR28w26Jo4uaZJCYYApyCFAsPQq2mhv55x2CZGN","/ip4/172.18.71.76/tcp/9838/ws/p2p/16Uiu2HAm4cNcFcR28w26Jo4uaZJCYYApyCFAsPQq2mhv55x2CZGN"],"enrUri":"enr:-LO4QOW8udUBZUpCtzFw_JJXgFn9bFzuTDOj5Upur0RAuXxVCJLAEY1tVY_0PpwZ-pHW3BIFi9w_N3SDwQP7mYVoZH0BgmlkgnY0gmlwhKwSR0yKbXVsdGlhZGRyc4wACgSsEkdMBiZu3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKIdu3pPy46RFud3RRvqrUyspB8gosYL6UA_JGbq8R6I4N0Y3CCJm2DdWRwgiZvhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9836/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.95.136/tcp/10021/p2p/16Uiu2HAmRhnGe9XuiKTSJ3rKV2FKrErVk5wkz7HRtqVmnKePXD29"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10020/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9836/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "67dfb674-fe5d-4226-92d9-11dc712e90d0", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"67dfb674-fe5d-4226-92d9-11dc712e90d0","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10020/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9836/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1725164280175498752,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10020/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9836/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "9142c0f4-015b-44d7-ba1f-5d2955ce141f", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"9142c0f4-015b-44d7-ba1f-5d2955ce141f","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10020/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9836/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1725164280297443328,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1a48ecd3d0d7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id bac95ded5d8b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.