[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-11-14_04-16-23__6d4fdf0f-2b13-4c21-8266-f9c2249078d8
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-14_04-16-23__6d4fdf0f-2b13-4c21-8266-f9c2249078d8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.253.40
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['49974', '49975', '49976', '49977', '49978']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 49974:49974 -p 49975:49975 -p 49976:49976 -p 49977:49977 -p 49978:49978 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49976 --rest-port=49974 --tcp-port=49975 --discv5-udp-port=49977 --rest-address=0.0.0.0 --nat=extip:172.18.253.40 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dfc0dfe89cc8ef914aaa56b24e7d12fbf6bd70da9f40ebfecb2c45c09acfda9d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49978 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.253.40 waku 5973cd55106dc4be324d2355ec876ebf4c6d9ee77c4c7976f575bc891e4b5eb0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 5973cd55106d. Setting up logs at ./log/docker/receiving_node1_2024-11-14_04-16-23__6d4fdf0f-2b13-4c21-8266-f9c2249078d8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 49974
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c2a24d5fa154. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49974/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49974/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.253.40/tcp/49975/p2p/16Uiu2HAkwYRkLrA4KJwwkY44mFBHBALgdd2QQLQQqMTvSwyujrrZ","/ip4/172.18.253.40/tcp/49976/ws/p2p/16Uiu2HAkwYRkLrA4KJwwkY44mFBHBALgdd2QQLQQqMTvSwyujrrZ"],"enrUri":"enr:-L24QMgayzWCHJI9K-0JZ-Dx0gF5cwlmpvCon6RHOEjimQdhM3RH5ntw4OYb28Q64Hws4UDofJqdX50OvJjGvRJjavkCgmlkgnY0gmlwhKwS_SiKbXVsdGlhZGRyc5YACASsEv0oBsM3AAoErBL9KAbDON0DgnJzhQADAQAAiXNlY3AyNTZrMaECH3JY8nbV6FueSp8s7STSyEyCA3cvwZl0Z91uFeJsTO6DdGNwgsM3g3VkcILDOYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-14_04-16-23__6d4fdf0f-2b13-4c21-8266-f9c2249078d8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.180.187
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['24894', '24895', '24896', '24897', '24898']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 24894:24894 -p 24895:24895 -p 24896:24896 -p 24897:24897 -p 24898:24898 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24896 --rest-port=24894 --tcp-port=24895 --discv5-udp-port=24897 --rest-address=0.0.0.0 --nat=extip:172.18.180.187 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0a3fab1d3e0faca0c4cfc450bdb35cdc6f474fecffff60b0fd1cf4bf6b23faff --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24898 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.180.187 waku 951210476a6d2cc6adbe7e6523192010ad9dcb0c85224709ded1206a93539807
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 951210476a6d. Setting up logs at ./log/docker/receiving_node2_2024-11-14_04-16-23__6d4fdf0f-2b13-4c21-8266-f9c2249078d8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 24894
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24894/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24894/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.180.187/tcp/24895/p2p/16Uiu2HAkwarVneCZjASprTkrxRWcgaDUYy5MP3UyUMqm8g75CYHN","/ip4/172.18.180.187/tcp/24896/ws/p2p/16Uiu2HAkwarVneCZjASprTkrxRWcgaDUYy5MP3UyUMqm8g75CYHN"],"enrUri":"enr:-L24QNwFbjLxFM59Z_NxiEm_dNqphZtaWWtbNFk479LGz4zAJ0kQFA9pXO-w8f0XO1oaw0BATxcvp4y31iGfN7kucr0CgmlkgnY0gmlwhKwStLuKbXVsdGlhZGRyc5YACASsErS7BmE_AAoErBK0uwZhQN0DgnJzhQADAQAAiXNlY3AyNTZrMaECIBF-LvwWV8wPW53FXUGSIYTzq3HJ79V_ITmDsrOcQgmDdGNwgmE_g3VkcIJhQYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:24894/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.253.40/tcp/49975/p2p/16Uiu2HAkwYRkLrA4KJwwkY44mFBHBALgdd2QQLQQqMTvSwyujrrZ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-14_04-16-23__6d4fdf0f-2b13-4c21-8266-f9c2249078d8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.31.222
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['46969', '46970', '46971', '46972', '46973']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 46969:46969 -p 46970:46970 -p 46971:46971 -p 46972:46972 -p 46973:46973 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46971 --rest-port=46969 --tcp-port=46970 --discv5-udp-port=46972 --rest-address=0.0.0.0 --nat=extip:172.18.31.222 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f5a5dadf13e7edfdec320a17b5a3ff6996fcd6d632ed5b4cdae15d94eb9bd6be --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46973 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QMgayzWCHJI9K-0JZ-Dx0gF5cwlmpvCon6RHOEjimQdhM3RH5ntw4OYb28Q64Hws4UDofJqdX50OvJjGvRJjavkCgmlkgnY0gmlwhKwS_SiKbXVsdGlhZGRyc5YACASsEv0oBsM3AAoErBL9KAbDON0DgnJzhQADAQAAiXNlY3AyNTZrMaECH3JY8nbV6FueSp8s7STSyEyCA3cvwZl0Z91uFeJsTO6DdGNwgsM3g3VkcILDOYV3YWt1Mgk --lightpushnode=/ip4/172.18.253.40/tcp/49975/p2p/16Uiu2HAkwYRkLrA4KJwwkY44mFBHBALgdd2QQLQQqMTvSwyujrrZ --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.31.222 waku 7d0d20a722216fde3d21220a557d73c877c6f7de5b6501a63b58673a50e22d0d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 7d0d20a72221. Setting up logs at ./log/docker/lightpush_node1_2024-11-14_04-16-23__6d4fdf0f-2b13-4c21-8266-f9c2249078d8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 46969
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46969/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46969/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.31.222/tcp/46970/p2p/16Uiu2HAky3nJe1LmLsadguGbwUX74Q75xbd5cQvLGJF7CCRxCSzH","/ip4/172.18.31.222/tcp/46971/ws/p2p/16Uiu2HAky3nJe1LmLsadguGbwUX74Q75xbd5cQvLGJF7CCRxCSzH"],"enrUri":"enr:-L24QJJ26j4D52L-m2frt2T0ZPp-3qOFKEfGj68MizY0Ia3gE9SWUAj8pzUArxm1RT9iAdBbmzx7gfl60t7QoWK1puYCgmlkgnY0gmlwhKwSH96KbXVsdGlhZGRyc5YACASsEh_eBrd6AAoErBIf3ga3e90DgnJzhQADAQAAiXNlY3AyNTZrMaECNdMfG5xAvh8awxoBo5essllgt3zZbHqnWvZqjQQGgOaDdGNwgrd6g3VkcIK3fIV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46969/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.253.40/tcp/49975/p2p/16Uiu2HAkwYRkLrA4KJwwkY44mFBHBALgdd2QQLQQqMTvSwyujrrZ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46969/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.180.187/tcp/24895/p2p/16Uiu2HAkwarVneCZjASprTkrxRWcgaDUYy5MP3UyUMqm8g75CYHN"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49974/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:24894/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46969/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1731557788654343936}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49974/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731557788654343936,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731557788654343936,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46969/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1731557788654343936}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:46969/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 5973cd55106d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 951210476a6d
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 5973cd55106d. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 7d0d20a72221
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 951210476a6d. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.