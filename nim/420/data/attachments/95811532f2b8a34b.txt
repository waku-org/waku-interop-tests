[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-11-05_04-12-50__366d15e5-4224-42ce-b162-1a916f90d735
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-05_04-12-50__366d15e5-4224-42ce-b162-1a916f90d735__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.216.181
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29326', '29327', '29328', '29329', '29330']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29326:29326 -p 29327:29327 -p 29328:29328 -p 29329:29329 -p 29330:29330 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29328 --rest-port=29326 --tcp-port=29327 --discv5-udp-port=29329 --rest-address=0.0.0.0 --nat=extip:172.18.216.181 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fad0dc1508a301186346db9c7c38daae9dbfad6c778bfeb1e5cd4ff56bb4b7b4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29330 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.216.181 waku 73a5829dc51833a01767543122a1db3e0a656bc873c06e856c1aae21f3f6b21f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 73a5829dc518. Setting up logs at ./log/docker/receiving_node1_2024-11-05_04-12-50__366d15e5-4224-42ce-b162-1a916f90d735__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 29326
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 1ed855a0d399. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29326/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29326/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.216.181/tcp/29327/p2p/16Uiu2HAmErMWLxi2jsubmyL1efAquKNsYg9pH8MUkoYRnAYktNCn","/ip4/172.18.216.181/tcp/29328/ws/p2p/16Uiu2HAmErMWLxi2jsubmyL1efAquKNsYg9pH8MUkoYRnAYktNCn"],"enrUri":"enr:-L24QL92ur_jeGTFo4AMvnopEr3y6ob6na1wg1MZPRi_W9U5Uu5OXTmNmCHjv0bGz5mlDgtuFGCFJfhiDc-m_h9leLoCgmlkgnY0gmlwhKwS2LWKbXVsdGlhZGRyc5YACASsEti1BnKPAAoErBLYtQZykN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIKCvHk2kOlfYaN1Z5N5iR1svuNltp9GikC_9HNM5y2eDdGNwgnKPg3VkcIJykYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-05_04-12-50__366d15e5-4224-42ce-b162-1a916f90d735__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.4.113
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['38348', '38349', '38350', '38351', '38352']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 38348:38348 -p 38349:38349 -p 38350:38350 -p 38351:38351 -p 38352:38352 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38350 --rest-port=38348 --tcp-port=38349 --discv5-udp-port=38351 --rest-address=0.0.0.0 --nat=extip:172.18.4.113 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cb20b0fe0deef72caead9e0ceccb56aad94efa99d87cbd7047ddc7cde999bbee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38352 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.4.113 waku 012c8789b3c5d432fdba0c0f7de4642b99764ebc7340cd73b13bd98a2c331d40
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 012c8789b3c5. Setting up logs at ./log/docker/receiving_node2_2024-11-05_04-12-50__366d15e5-4224-42ce-b162-1a916f90d735__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 38348
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38348/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38348/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.4.113/tcp/38349/p2p/16Uiu2HAmAD9pURWRJkRVwZE4Uboquark5zB69SmLJtfXCKefWjb3","/ip4/172.18.4.113/tcp/38350/ws/p2p/16Uiu2HAmAD9pURWRJkRVwZE4Uboquark5zB69SmLJtfXCKefWjb3"],"enrUri":"enr:-L24QHTRHjT9XN8O-TONrpCd5rl_dRiT0e-FwqPYlVT0udk0QLbKBtSOTUer9h0y2OEe77dTMUck16t35e2vdAwS2DQCgmlkgnY0gmlwhKwSBHGKbXVsdGlhZGRyc5YACASsEgRxBpXNAAoErBIEcQaVzt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC26o7PDwC5dQYeVQ96vmK_yJH3ucOcyreV2rLhaZSOKaDdGNwgpXNg3VkcIKVz4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38348/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.216.181/tcp/29327/p2p/16Uiu2HAmErMWLxi2jsubmyL1efAquKNsYg9pH8MUkoYRnAYktNCn"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-05_04-12-50__366d15e5-4224-42ce-b162-1a916f90d735__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.164.36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['22026', '22027', '22028', '22029', '22030']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 22026:22026 -p 22027:22027 -p 22028:22028 -p 22029:22029 -p 22030:22030 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22028 --rest-port=22026 --tcp-port=22027 --discv5-udp-port=22029 --rest-address=0.0.0.0 --nat=extip:172.18.164.36 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6e6aa98dcb5a3f3a9b720a165aa0dece534d63b28dfd63fecb78eb3cab901f24 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22030 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QL92ur_jeGTFo4AMvnopEr3y6ob6na1wg1MZPRi_W9U5Uu5OXTmNmCHjv0bGz5mlDgtuFGCFJfhiDc-m_h9leLoCgmlkgnY0gmlwhKwS2LWKbXVsdGlhZGRyc5YACASsEti1BnKPAAoErBLYtQZykN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIKCvHk2kOlfYaN1Z5N5iR1svuNltp9GikC_9HNM5y2eDdGNwgnKPg3VkcIJykYV3YWt1Mgk --lightpushnode=/ip4/172.18.216.181/tcp/29327/p2p/16Uiu2HAmErMWLxi2jsubmyL1efAquKNsYg9pH8MUkoYRnAYktNCn --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.164.36 waku 68903f6c6868d386ae21fd7fdcf0897fa5edab7a1d31078c69e3a7232797329f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 68903f6c6868. Setting up logs at ./log/docker/lightpush_node1_2024-11-05_04-12-50__366d15e5-4224-42ce-b162-1a916f90d735__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22026
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22026/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22026/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.164.36/tcp/22027/p2p/16Uiu2HAmTNtLe6Loym4Wss5VMkGD2rQ1F9V7y3H8iePNDziq9Erw","/ip4/172.18.164.36/tcp/22028/ws/p2p/16Uiu2HAmTNtLe6Loym4Wss5VMkGD2rQ1F9V7y3H8iePNDziq9Erw"],"enrUri":"enr:-L24QLZpHOe9AwXX_vwwAsPyZE52AzrgPKnI1iMSTqjYIIiDVOm67Pj6buQv0a-HQsf1zMdFtR835-IXKorOMKJjpv4CgmlkgnY0gmlwhKwSpCSKbXVsdGlhZGRyc5YACASsEqQkBlYLAAoErBKkJAZWDN0DgnJzhQADAQAAiXNlY3AyNTZrMaED2r82zQMC1vdxWb0rArRmCRyH4fQSeDEnW9Os_oMa0ESDdGNwglYLg3VkcIJWDYV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22026/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.216.181/tcp/29327/p2p/16Uiu2HAmErMWLxi2jsubmyL1efAquKNsYg9pH8MUkoYRnAYktNCn"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22026/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.4.113/tcp/38349/p2p/16Uiu2HAmAD9pURWRJkRVwZE4Uboquark5zB69SmLJtfXCKefWjb3"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29326/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38348/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22026/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1730779975254596864}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29326/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730779975254596864,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.216.181/tcp/29327"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.216.181/tcp/29327"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 73a5829dc518
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 012c8789b3c5
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 73a5829dc518. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 68903f6c6868
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 012c8789b3c5. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.