[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_refresh_existing with id: 2024-11-05_04-07-49__b7f682be-5021-4334-b951-dd0a024e973a
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-05_04-07-49__b7f682be-5021-4334-b951-dd0a024e973a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.151.123
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['51109', '51110', '51111', '51112', '51113']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 51109:51109 -p 51110:51110 -p 51111:51111 -p 51112:51112 -p 51113:51113 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51111 --rest-port=51109 --tcp-port=51110 --discv5-udp-port=51112 --rest-address=0.0.0.0 --nat=extip:172.18.151.123 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=95aed4d9b52fc9df7bbd0de3b9f9c3358db8cb7b76ac8c1d86e3ced3d88fbe27 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51113 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.151.123 waku 7247cf1d4a2608e3f3127f171eacd7c31df0eb793e4b90eb15c0d8f5be5baae3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 7247cf1d4a26. Setting up logs at ./log/docker/node1_2024-11-05_04-07-49__b7f682be-5021-4334-b951-dd0a024e973a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 51109
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c335f343d8b5. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51109/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51109/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.151.123/tcp/51110/p2p/16Uiu2HAmQkzRDMHmdHxJVD965ScqkEvTGEK8pXexfZc5jn2D448q","/ip4/172.18.151.123/tcp/51111/ws/p2p/16Uiu2HAmQkzRDMHmdHxJVD965ScqkEvTGEK8pXexfZc5jn2D448q"],"enrUri":"enr:-L24QIRXKc7pv7Dm-EiSsezNNYwfx0sL_UF9bVpLFZpTcYMgIDN10dpwzmba8osrdNmhhFDdgeHm0QhRXNAAkaoJIpkCgmlkgnY0gmlwhKwSl3uKbXVsdGlhZGRyc5YACASsEpd7BsemAAoErBKXewbHp90DgnJzhQADAQAAiXNlY3AyNTZrMaEDs9XN8XzI1M40rl7X4SCCs7WjgK4mwmF_9ZRPXcgFTkqDdGNwgsemg3VkcILHqIV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-05_04-07-49__b7f682be-5021-4334-b951-dd0a024e973a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.206.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['48082', '48083', '48084', '48085', '48086']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 48082:48082 -p 48083:48083 -p 48084:48084 -p 48085:48085 -p 48086:48086 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48084 --rest-port=48082 --tcp-port=48083 --discv5-udp-port=48085 --rest-address=0.0.0.0 --nat=extip:172.18.206.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7d93062fd6ca6ea1ed7cae7b8cc1bbc4ae266614ecedceba3bfa98db3b41990b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48086 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QIRXKc7pv7Dm-EiSsezNNYwfx0sL_UF9bVpLFZpTcYMgIDN10dpwzmba8osrdNmhhFDdgeHm0QhRXNAAkaoJIpkCgmlkgnY0gmlwhKwSl3uKbXVsdGlhZGRyc5YACASsEpd7BsemAAoErBKXewbHp90DgnJzhQADAQAAiXNlY3AyNTZrMaEDs9XN8XzI1M40rl7X4SCCs7WjgK4mwmF_9ZRPXcgFTkqDdGNwgsemg3VkcILHqIV3YWt1MgU --filternode=/ip4/172.18.151.123/tcp/51110/p2p/16Uiu2HAmQkzRDMHmdHxJVD965ScqkEvTGEK8pXexfZc5jn2D448q
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.206.183 waku 755229b2a61bf3209af405c8f5291d6d4e15d95344edb52f85c3a5a2afd7b0f1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 755229b2a61b. Setting up logs at ./log/docker/node2_2024-11-05_04-07-49__b7f682be-5021-4334-b951-dd0a024e973a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 48082
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48082/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48082/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.206.183/tcp/48083/p2p/16Uiu2HAmDr4dHyfy5KC5ATCtnGygMNX62wJKDy1B7d6dp66ddFWT","/ip4/172.18.206.183/tcp/48084/ws/p2p/16Uiu2HAmDr4dHyfy5KC5ATCtnGygMNX62wJKDy1B7d6dp66ddFWT"],"enrUri":"enr:-L24QNUy_InvOVwKYSJj1BMmPdJQuE8mfVLHEOwdk9mNddw8TuGNUygS0x41bkKF-AXIHL-oCOHsapHKQnFkZS47JAUCgmlkgnY0gmlwhKwSzreKbXVsdGlhZGRyc5YACASsEs63BrvTAAoErBLOtwa71N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDEbHpHwuwyXZvI0ZmJ6FCHl9YHQktwePHgTKN1QGkAWSDdGNwgrvTg3VkcIK71YV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48082/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.151.123/tcp/51110/p2p/16Uiu2HAmQkzRDMHmdHxJVD965ScqkEvTGEK8pXexfZc5jn2D448q"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51109/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48082/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "bfb5d6f1-7a52-4676-bf77-9c6c4a4103b8", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"bfb5d6f1-7a52-4676-bf77-9c6c4a4103b8","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:48082/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51109/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48082/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1730779673156644864,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7247cf1d4a26
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 755229b2a61b
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 7247cf1d4a26. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.