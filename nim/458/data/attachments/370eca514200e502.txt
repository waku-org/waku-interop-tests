[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_content_topic_different_shard with id: 2024-11-22_04-23-46__f063fe23-6096-4907-ad76-df0bc167469f
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-22_04-23-46__f063fe23-6096-4907-ad76-df0bc167469f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.39.165
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['5635', '5636', '5637', '5638', '5639']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 5635:5635 -p 5636:5636 -p 5637:5637 -p 5638:5638 -p 5639:5639 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5637 --rest-port=5635 --tcp-port=5636 --discv5-udp-port=5638 --rest-address=0.0.0.0 --nat=extip:172.18.39.165 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=9ff5e1c59cb68d4fb42ace4ac3a0ea0d7aebe1d02ccb7ebc2e028b8d89affa8b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5639 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.39.165 waku 26ff8d4397ad57e783e15cb71dfefff57da3cda0d5bcadef71913d172846d036
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 1758424a3144. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 26ff8d4397ad. Setting up logs at ./log/docker/node1_2024-11-22_04-23-46__f063fe23-6096-4907-ad76-df0bc167469f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 5635
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5635/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5635/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.165/tcp/5636/p2p/16Uiu2HAmLVqAS6rGwHtHUpewqrdNyvUP8taZkq2kofBTrQVSh5mi","/ip4/172.18.39.165/tcp/5637/ws/p2p/16Uiu2HAmLVqAS6rGwHtHUpewqrdNyvUP8taZkq2kofBTrQVSh5mi"],"enrUri":"enr:-L24QNyUwdAH70z_xx2SkUJa3sg-qcOQ2-DP75K5QRL4W5HNMRInQpdNWowCmUUoRSmD_nuvN-KKgjr5cJjDK29QX48CgmlkgnY0gmlwhKwSJ6WKbXVsdGlhZGRyc5YACASsEielBhYEAAoErBInpQYWBd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDdIThUc_I34ubzl_2llCL8sY6K_4C3bwJ4VnWU20foUGDdGNwghYEg3VkcIIWBoV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-22_04-23-46__f063fe23-6096-4907-ad76-df0bc167469f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.80.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['60462', '60463', '60464', '60465', '60466']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 60462:60462 -p 60463:60463 -p 60464:60464 -p 60465:60465 -p 60466:60466 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60464 --rest-port=60462 --tcp-port=60463 --discv5-udp-port=60465 --rest-address=0.0.0.0 --nat=extip:172.18.80.183 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=03219aeaaea1053dcc43bbf6a71a3d0ce65280fc9e780f505a3d841c69f8f1b0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60466 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QNyUwdAH70z_xx2SkUJa3sg-qcOQ2-DP75K5QRL4W5HNMRInQpdNWowCmUUoRSmD_nuvN-KKgjr5cJjDK29QX48CgmlkgnY0gmlwhKwSJ6WKbXVsdGlhZGRyc5YACASsEielBhYEAAoErBInpQYWBd0DgnJzhQACAQAAiXNlY3AyNTZrMaEDdIThUc_I34ubzl_2llCL8sY6K_4C3bwJ4VnWU20foUGDdGNwghYEg3VkcIIWBoV3YWt1MgU --content-topic=/waku/2/content/test.js
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.80.183 waku f9d0a35fb5c567b4e1e59515e104656af32a176b91e47bc91f7d3f311822bea3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f9d0a35fb5c5. Setting up logs at ./log/docker/node2_2024-11-22_04-23-46__f063fe23-6096-4907-ad76-df0bc167469f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 60462
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60462/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60462/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.80.183/tcp/60463/p2p/16Uiu2HAmPeyuCAag8NRf4ZH7QyxaWAao1i5sp7F8nSXHhmTUEwbX","/ip4/172.18.80.183/tcp/60464/ws/p2p/16Uiu2HAmPeyuCAag8NRf4ZH7QyxaWAao1i5sp7F8nSXHhmTUEwbX"],"enrUri":"enr:-L24QJwfseHDAIIGP5RJDuC-G5RZ1Ni76f8Hu9I8zrvPp7sxRSPFlui0fs72X1Y6S20JRg2DcXaJw8yH8ycvJK5o1akCgmlkgnY0gmlwhKwSULeKbXVsdGlhZGRyc5YACASsElC3BuwvAAoErBJQtwbsMN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDo3AMJQ2VUNXWfFs-CBn01m5shJW6IorLiUge0gg3A2KDdGNwguwvg3VkcILsMYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60462/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.165/tcp/5636/p2p/16Uiu2HAmLVqAS6rGwHtHUpewqrdNyvUP8taZkq2kofBTrQVSh5mi"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5635/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60462/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/content/test.js"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5635/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5635/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1732249430098516736,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60462/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:60462/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto. Response content: b'/myapp/1/latest/proto'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 26ff8d4397ad
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id f9d0a35fb5c5
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 26ff8d4397ad. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.