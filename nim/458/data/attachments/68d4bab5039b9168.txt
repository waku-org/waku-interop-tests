[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_missing_content_topic with id: 2024-11-22_04-19-19__8b289260-ea82-48b1-b2df-3863dd38b0dc
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-22_04-19-19__8b289260-ea82-48b1-b2df-3863dd38b0dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.47.231
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['15350', '15351', '15352', '15353', '15354']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 15350:15350 -p 15351:15351 -p 15352:15352 -p 15353:15353 -p 15354:15354 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15352 --rest-port=15350 --tcp-port=15351 --discv5-udp-port=15353 --rest-address=0.0.0.0 --nat=extip:172.18.47.231 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fbba3e7aefb4228ce75f9cfb97db8040a6a5b16deafde21e7fd878d7ff89e6d2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15354 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.47.231 waku b03e77db2d9b79c0a9a4d3bfd8bcfe79141785c785fcdd890aa0d86123ca82e3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b03e77db2d9b. Setting up logs at ./log/docker/node1_2024-11-22_04-19-19__8b289260-ea82-48b1-b2df-3863dd38b0dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 15350
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 8184063c6ca5. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15350/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15350/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.47.231/tcp/15351/p2p/16Uiu2HAmVsV7t8UPyZiRkKfDuUHs7dT4pkLT3cUsJd27C8CqTtHK","/ip4/172.18.47.231/tcp/15352/ws/p2p/16Uiu2HAmVsV7t8UPyZiRkKfDuUHs7dT4pkLT3cUsJd27C8CqTtHK"],"enrUri":"enr:-L24QLSKzA16bsYACyfABYMK0ysb1eJOUnUm1hvSQs-c0GCyGMFT_pyFbTur0kT7HtmaasFCJ6lNA4U4Mxc9lgRXTAACgmlkgnY0gmlwhKwSL-eKbXVsdGlhZGRyc5YACASsEi_nBjv3AAoErBIv5wY7-N0DgnJzhQADAQAAiXNlY3AyNTZrMaED_8otLf_kTc_6RILM5-YE4hnTPumViAbfgxB84Ee74g6DdGNwgjv3g3VkcII7-YV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-22_04-19-19__8b289260-ea82-48b1-b2df-3863dd38b0dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.242.168
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['17643', '17644', '17645', '17646', '17647']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 17643:17643 -p 17644:17644 -p 17645:17645 -p 17646:17646 -p 17647:17647 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17645 --rest-port=17643 --tcp-port=17644 --discv5-udp-port=17646 --rest-address=0.0.0.0 --nat=extip:172.18.242.168 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1f0b6c2a172d68d50b9c9cfceced631cb8a51335b4e744dc166454cb0db0eb52 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17647 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QLSKzA16bsYACyfABYMK0ysb1eJOUnUm1hvSQs-c0GCyGMFT_pyFbTur0kT7HtmaasFCJ6lNA4U4Mxc9lgRXTAACgmlkgnY0gmlwhKwSL-eKbXVsdGlhZGRyc5YACASsEi_nBjv3AAoErBIv5wY7-N0DgnJzhQADAQAAiXNlY3AyNTZrMaED_8otLf_kTc_6RILM5-YE4hnTPumViAbfgxB84Ee74g6DdGNwgjv3g3VkcII7-YV3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.242.168 waku 76f51e406199d9e16c33252cda5fdb551647ef1df8c73d7b269786ab0efc0e6a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 76f51e406199. Setting up logs at ./log/docker/node2_2024-11-22_04-19-19__8b289260-ea82-48b1-b2df-3863dd38b0dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 17643
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17643/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17643/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.242.168/tcp/17644/p2p/16Uiu2HAmF1H5vEdAe7cGuH7Bi8Gu3h1fKQ2TMPN7a8ExgHa7hKgi","/ip4/172.18.242.168/tcp/17645/ws/p2p/16Uiu2HAmF1H5vEdAe7cGuH7Bi8Gu3h1fKQ2TMPN7a8ExgHa7hKgi"],"enrUri":"enr:-L24QEnQfNWWkOXWqjUdtrjmJ3WAw28LM-adgpRrXJn-a8dKKsgq-q68Fw1grlduj_0_WH784QCVl0VsNAbyF3ihcl4CgmlkgnY0gmlwhKwS8qiKbXVsdGlhZGRyc5YACASsEvKoBkTsAAoErBLyqAZE7d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIunpjs6TYncgJJkXptwLq8qg_PvqVXuAfHF2y21OzkeDdGNwgkTsg3VkcIJE7oV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17643/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.47.231/tcp/15351/p2p/16Uiu2HAmVsV7t8UPyZiRkKfDuUHs7dT4pkLT3cUsJd27C8CqTtHK"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15350/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17643/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15350/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15350/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1732249163165980160,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17643/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1732249163165980160,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15350/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "timestamp": '$(date +%s%N)'}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15350/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id b03e77db2d9b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 76f51e406199
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b03e77db2d9b. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.