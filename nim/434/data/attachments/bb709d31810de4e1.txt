[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_works_with_static_sharding with id: 2024-11-07_05-01-42__c9a8c73b-e8a9-41d9-9c3a-0d04e08989c9
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-07_05-01-42__c9a8c73b-e8a9-41d9-9c3a-0d04e08989c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.141.124
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3740', '3741', '3742', '3743', '3744']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3740:3740 -p 3741:3741 -p 3742:3742 -p 3743:3743 -p 3744:3744 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3742 --rest-port=3740 --tcp-port=3741 --discv5-udp-port=3743 --rest-address=0.0.0.0 --nat=extip:172.18.141.124 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=6bbd3c5aefc3557a44aad9ef9eab94db04bd53ac3dcfaa5821f1fdd7bbd29a6f --max-connections=1000 --filter-subscription-timeout=600 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3744 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.141.124 waku 30312947a186c07ef588940f009a9d0a65b39e6c348c732ae593ebb06a94ce61
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 30312947a186. Setting up logs at ./log/docker/node1_2024-11-07_05-01-42__c9a8c73b-e8a9-41d9-9c3a-0d04e08989c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 3740
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 2f72d9bfc835. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3740/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3740/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.141.124/tcp/3741/p2p/16Uiu2HAm9y4rGWCg8eeY6L2pBUK9x62tEBRXjq1GnFQstoW8rcko","/ip4/172.18.141.124/tcp/3742/ws/p2p/16Uiu2HAm9y4rGWCg8eeY6L2pBUK9x62tEBRXjq1GnFQstoW8rcko"],"enrUri":"enr:-L24QJK0heFQa1LHMtEnO5R8dkGmUsaLLtvdfuODHbsMxV7BII7BrcHt3nM8SAZJczlo5LQiOG9wtn87t_lpTBDBtvoCgmlkgnY0gmlwhKwSjXyKbXVsdGlhZGRyc5YACASsEo18Bg6dAAoErBKNfAYOnt0DgnJzhQACAQAAiXNlY3AyNTZrMaEC2A57RU9c1bs0flAq8e6tNDhQApzDKQlYk-GSfHjCtRCDdGNwgg6dg3VkcIIOn4V3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-07_05-01-42__c9a8c73b-e8a9-41d9-9c3a-0d04e08989c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.100.245
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['26140', '26141', '26142', '26143', '26144']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 26140:26140 -p 26141:26141 -p 26142:26142 -p 26143:26143 -p 26144:26144 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26142 --rest-port=26140 --tcp-port=26141 --discv5-udp-port=26143 --rest-address=0.0.0.0 --nat=extip:172.18.100.245 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=dfddc6ed9da9ab4ea0dbe4c5513ede84c1f50add5f06befcafabf2785da981ec --max-connections=1000 --filter-subscription-timeout=600 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26144 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QJK0heFQa1LHMtEnO5R8dkGmUsaLLtvdfuODHbsMxV7BII7BrcHt3nM8SAZJczlo5LQiOG9wtn87t_lpTBDBtvoCgmlkgnY0gmlwhKwSjXyKbXVsdGlhZGRyc5YACASsEo18Bg6dAAoErBKNfAYOnt0DgnJzhQACAQAAiXNlY3AyNTZrMaEC2A57RU9c1bs0flAq8e6tNDhQApzDKQlYk-GSfHjCtRCDdGNwgg6dg3VkcIIOn4V3YWt1MgU --filternode=/ip4/172.18.141.124/tcp/3741/p2p/16Uiu2HAm9y4rGWCg8eeY6L2pBUK9x62tEBRXjq1GnFQstoW8rcko --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.100.245 waku 53561ceac046d8f0b0a3ef4d835ca8f782f6f4c8921a2a697cd8086834028d1a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 53561ceac046. Setting up logs at ./log/docker/node2_2024-11-07_05-01-42__c9a8c73b-e8a9-41d9-9c3a-0d04e08989c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 26140
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26140/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26140/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.100.245/tcp/26141/p2p/16Uiu2HAm3mbUn5mdbFQ2n3s3pieQ4dLA1PHodjJQteoRzs4X8wjN","/ip4/172.18.100.245/tcp/26142/ws/p2p/16Uiu2HAm3mbUn5mdbFQ2n3s3pieQ4dLA1PHodjJQteoRzs4X8wjN"],"enrUri":"enr:-L24QE9oI1Nf2QVA_8L_zAKHEgCUVEEdTUVBvjfdh5F7g41GWPm-NuRMs8z8FE4dUsCKfFnXLiEeQwACh2ZiSWLPomMCgmlkgnY0gmlwhKwSZPWKbXVsdGlhZGRyc5YACASsEmT1BmYdAAoErBJk9QZmHt0DgnJzhQACAQAAiXNlY3AyNTZrMaECe_gF640MiiEyzL-1eQydo8VinHJdN1fm0IVsg3ugPgmDdGNwgmYdg3VkcIJmH4V3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26140/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.141.124/tcp/3741/p2p/16Uiu2HAm9y4rGWCg8eeY6L2pBUK9x62tEBRXjq1GnFQstoW8rcko"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3740/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26140/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "3f31d10d-11b4-48f6-9a57-dbb4ca79004f", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"3f31d10d-11b4-48f6-9a57-dbb4ca79004f","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3740/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:186 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26140/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730955706252301312,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 30312947a186
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 53561ceac046
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 30312947a186. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.