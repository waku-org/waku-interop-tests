[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-11-23_04-18-25__2215ba1b-be3f-46df-ae74-ce63737895dc
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-23_04-18-25__2215ba1b-be3f-46df-ae74-ce63737895dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.38.221
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['61234', '61235', '61236', '61237', '61238']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 61234:61234 -p 61235:61235 -p 61236:61236 -p 61237:61237 -p 61238:61238 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61236 --rest-port=61234 --tcp-port=61235 --discv5-udp-port=61237 --rest-address=0.0.0.0 --nat=extip:172.18.38.221 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cd24beeea0a9d2ecef83ede314d6df98d6e13dec1a90647eddab7ad7f2144ea8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61238 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.38.221 waku 268a642c4b116c4b90ece1dfedc79ce00948cd7622ee0884c927b15cad5dc642
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 268a642c4b11. Setting up logs at ./log/docker/receiving_node1_2024-11-23_04-18-25__2215ba1b-be3f-46df-ae74-ce63737895dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 61234
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 6e3bbe93ce80. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61234/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61234/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.221/tcp/61235/p2p/16Uiu2HAmCxPeVbbNPWJavLMhbgPVgVeUwWg8d6g2GPSqMiWDZ1oq","/ip4/172.18.38.221/tcp/61236/ws/p2p/16Uiu2HAmCxPeVbbNPWJavLMhbgPVgVeUwWg8d6g2GPSqMiWDZ1oq"],"enrUri":"enr:-L24QPFuXlcbrZjAFtdgnF_zonOMuF-87kItgw3NuLaBXjaeIRomzR2TTv8tsxpZEQ4qI8BuMRbCj21b4j047oMcX-QCgmlkgnY0gmlwhKwSJt2KbXVsdGlhZGRyc5YACASsEibdBu8zAAoErBIm3QbvNN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDBHU3H6o-A632TspsSAVJZe5pvvoi-egNiZC3StggK7yDdGNwgu8zg3VkcILvNYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-23_04-18-25__2215ba1b-be3f-46df-ae74-ce63737895dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.188.251
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['61407', '61408', '61409', '61410', '61411']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 61407:61407 -p 61408:61408 -p 61409:61409 -p 61410:61410 -p 61411:61411 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61409 --rest-port=61407 --tcp-port=61408 --discv5-udp-port=61410 --rest-address=0.0.0.0 --nat=extip:172.18.188.251 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dd8ba4f12fa1af08210ffeddfde54db7b52504faa6adabedc66c9c77e0efb87f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61411 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.188.251 waku cd12d9989a125ffb4e8036adc61b3d22112f7574345eed0c558f5e2b70695935
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID cd12d9989a12. Setting up logs at ./log/docker/receiving_node2_2024-11-23_04-18-25__2215ba1b-be3f-46df-ae74-ce63737895dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 61407
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61407/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61407/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.188.251/tcp/61408/p2p/16Uiu2HAm71rwB9HTFDJtxwqZX2Eg7XgsX589weYn3uL1BXdUM8tA","/ip4/172.18.188.251/tcp/61409/ws/p2p/16Uiu2HAm71rwB9HTFDJtxwqZX2Eg7XgsX589weYn3uL1BXdUM8tA"],"enrUri":"enr:-L24QP-wTrRVT_EvFq4dFy1aFKpNVOfFY3XRFtv4sKDSaKS0Pf3swgzdo9a6P0aTxxTX0D3hp9cE7kiQeoXK5CAugjECgmlkgnY0gmlwhKwSvPuKbXVsdGlhZGRyc5YACASsErz7Bu_gAAoErBK8-wbv4d0DgnJzhQADAQAAiXNlY3AyNTZrMaECrDKwvk8NnWnG2cvGsE5pvX6CWS0FqIK14eZ-TqR-AGODdGNwgu_gg3VkcILv4oV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61407/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.38.221/tcp/61235/p2p/16Uiu2HAmCxPeVbbNPWJavLMhbgPVgVeUwWg8d6g2GPSqMiWDZ1oq"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-23_04-18-25__2215ba1b-be3f-46df-ae74-ce63737895dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.34.21
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['47242', '47243', '47244', '47245', '47246']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 47242:47242 -p 47243:47243 -p 47244:47244 -p 47245:47245 -p 47246:47246 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47244 --rest-port=47242 --tcp-port=47243 --discv5-udp-port=47245 --rest-address=0.0.0.0 --nat=extip:172.18.34.21 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=79c8aa50989adbc9f5e3d7dbfcbb6f1ba87fe7c43c0fe2d8cbc50b7adbc42ab7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47246 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QPFuXlcbrZjAFtdgnF_zonOMuF-87kItgw3NuLaBXjaeIRomzR2TTv8tsxpZEQ4qI8BuMRbCj21b4j047oMcX-QCgmlkgnY0gmlwhKwSJt2KbXVsdGlhZGRyc5YACASsEibdBu8zAAoErBIm3QbvNN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDBHU3H6o-A632TspsSAVJZe5pvvoi-egNiZC3StggK7yDdGNwgu8zg3VkcILvNYV3YWt1Mgk --lightpushnode=/ip4/172.18.38.221/tcp/61235/p2p/16Uiu2HAmCxPeVbbNPWJavLMhbgPVgVeUwWg8d6g2GPSqMiWDZ1oq --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.34.21 waku aabe32dd2f51350cd1ef3c9ec18aaa10e2cab52c71944325deb78cee59fd66dd
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID aabe32dd2f51. Setting up logs at ./log/docker/lightpush_node1_2024-11-23_04-18-25__2215ba1b-be3f-46df-ae74-ce63737895dc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 47242
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47242/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47242/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.34.21/tcp/47243/p2p/16Uiu2HAm1oWMRXhS7yXCu7SDQfWbhfuUcFHhb45BvEADZfRNEXsw","/ip4/172.18.34.21/tcp/47244/ws/p2p/16Uiu2HAm1oWMRXhS7yXCu7SDQfWbhfuUcFHhb45BvEADZfRNEXsw"],"enrUri":"enr:-L24QKHQXtY5X1Xh_BD3p-wHHyRoxrWlWyNz-7TNFKu2Qpuxdb160718gAzxpM7C0_-OsoZlLDM4mKRVTbX2uAmSEGgCgmlkgnY0gmlwhKwSIhWKbXVsdGlhZGRyc5YACASsEiIVBriLAAoErBIiFQa4jN0DgnJzhQADAQAAiXNlY3AyNTZrMaECXr4DlYgr4n6vRs0txi7JeOSefFc6tbef4yjyjU590pqDdGNwgriLg3VkcIK4jYV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47242/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.38.221/tcp/61235/p2p/16Uiu2HAmCxPeVbbNPWJavLMhbgPVgVeUwWg8d6g2GPSqMiWDZ1oq"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47242/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.188.251/tcp/61408/p2p/16Uiu2HAm71rwB9HTFDJtxwqZX2Eg7XgsX589weYn3uL1BXdUM8tA"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61234/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61407/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47242/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1732335510584789248}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61234/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1732335510584789248,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.38.221/tcp/61235"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.38.221/tcp/61235"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 268a642c4b11
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id cd12d9989a12
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 268a642c4b11. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id aabe32dd2f51
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container cd12d9989a12. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.