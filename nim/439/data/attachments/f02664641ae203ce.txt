[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_lightpush with id: 2024-11-07_12-31-20__361aff39-7aff-47ef-b6e5-e0d35c42a4f3
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-07_12-31-20__361aff39-7aff-47ef-b6e5-e0d35c42a4f3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.160.241
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['60770', '60771', '60772', '60773', '60774']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 60770:60770 -p 60771:60771 -p 60772:60772 -p 60773:60773 -p 60774:60774 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60772 --rest-port=60770 --tcp-port=60771 --discv5-udp-port=60773 --rest-address=0.0.0.0 --nat=extip:172.18.160.241 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=554dec06faf0ab5d0884bdeaeaefcfab8f89f44eaffcded994a264696839cdeb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60774 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.160.241 waku ae11d64af2a76796e24eb0a71d03272cbe4e276d381980ca5760089b10d7196e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ae11d64af2a7. Setting up logs at ./log/docker/node1_2024-11-07_12-31-20__361aff39-7aff-47ef-b6e5-e0d35c42a4f3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 60770
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container de1e32bc6971. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60770/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60770/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.160.241/tcp/60771/p2p/16Uiu2HAkx3zh8anJ1hYUDm9cxGSSKV5tcbQnxr48vJu58Jhx56zT","/ip4/172.18.160.241/tcp/60772/ws/p2p/16Uiu2HAkx3zh8anJ1hYUDm9cxGSSKV5tcbQnxr48vJu58Jhx56zT"],"enrUri":"enr:-L24QB7x_cf2_vcqov_JOa_knzIEDyChYvZ9y324Q2XDBaVCJBKXEvoXDVwvpaOFBRj6jNh6ExtoYNVsA_79rTo1h1kCgmlkgnY0gmlwhKwSoPGKbXVsdGlhZGRyc5YACASsEqDxBu1jAAoErBKg8QbtZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECJwVxB8JcGwL1Jhl-Qv3cOE_WIm2XOvBd7kbb01GAgoiDdGNwgu1jg3VkcILtZYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-07_12-31-20__361aff39-7aff-47ef-b6e5-e0d35c42a4f3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.150.85
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20854', '20855', '20856', '20857', '20858']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20854:20854 -p 20855:20855 -p 20856:20856 -p 20857:20857 -p 20858:20858 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20856 --rest-port=20854 --tcp-port=20855 --discv5-udp-port=20857 --rest-address=0.0.0.0 --nat=extip:172.18.150.85 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5a4e3dc35f0a9adad4abe9bcadae32df0ad01a58bc1ec34d6bdaff172ffcdbf5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20858 --metrics-logging=true --lightpush=false --relay=true --discv5-bootstrap-node=enr:-L24QB7x_cf2_vcqov_JOa_knzIEDyChYvZ9y324Q2XDBaVCJBKXEvoXDVwvpaOFBRj6jNh6ExtoYNVsA_79rTo1h1kCgmlkgnY0gmlwhKwSoPGKbXVsdGlhZGRyc5YACASsEqDxBu1jAAoErBKg8QbtZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECJwVxB8JcGwL1Jhl-Qv3cOE_WIm2XOvBd7kbb01GAgoiDdGNwgu1jg3VkcILtZYV3YWt1Mgk
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.150.85 waku 76257a37db03b2c2264f39956b938eaafc00a02644d1db02dfdf4801d3bd44b0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 76257a37db03. Setting up logs at ./log/docker/node1_2024-11-07_12-31-20__361aff39-7aff-47ef-b6e5-e0d35c42a4f3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 20854
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20854/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20854/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.150.85/tcp/20855/p2p/16Uiu2HAmGimEbs8d1X7SyvAaBHN46zGSH5hzaJfQLzLZrLoPhzXZ","/ip4/172.18.150.85/tcp/20856/ws/p2p/16Uiu2HAmGimEbs8d1X7SyvAaBHN46zGSH5hzaJfQLzLZrLoPhzXZ"],"enrUri":"enr:-L24QBhSUPSRzTUvSLeDnTI6MNa2-Qrg2E-PacCU9c43gnbbDeBrck4qajArWBrGIjcL121IZQ3Ci5FWnQwaCg86CF8CgmlkgnY0gmlwhKwSllWKbXVsdGlhZGRyc5YACASsEpZVBlF3AAoErBKWVQZReN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDPGY9zU6v1UrVHBOXBn-4CxswPmbVthKFwnOp8pq4n5CDdGNwglF3g3VkcIJReYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-07_12-31-20__361aff39-7aff-47ef-b6e5-e0d35c42a4f3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.209.18
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['48982', '48983', '48984', '48985', '48986']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 48982:48982 -p 48983:48983 -p 48984:48984 -p 48985:48985 -p 48986:48986 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48984 --rest-port=48982 --tcp-port=48983 --discv5-udp-port=48985 --rest-address=0.0.0.0 --nat=extip:172.18.209.18 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=00e9ae7f4341ef54d7e2ddcfe430ece41dbd6ec4b69fce37abffd5dcc32cb660 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48986 --metrics-logging=true --lightpush=true --relay=false --discv5-bootstrap-node=enr:-L24QB7x_cf2_vcqov_JOa_knzIEDyChYvZ9y324Q2XDBaVCJBKXEvoXDVwvpaOFBRj6jNh6ExtoYNVsA_79rTo1h1kCgmlkgnY0gmlwhKwSoPGKbXVsdGlhZGRyc5YACASsEqDxBu1jAAoErBKg8QbtZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECJwVxB8JcGwL1Jhl-Qv3cOE_WIm2XOvBd7kbb01GAgoiDdGNwgu1jg3VkcILtZYV3YWt1Mgk --lightpushnode=/ip4/172.18.160.241/tcp/60771/p2p/16Uiu2HAkx3zh8anJ1hYUDm9cxGSSKV5tcbQnxr48vJu58Jhx56zT
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.209.18 waku 02c3270a212471c9b8cd3025dc6ff09a12ad913dc8a3987bfb648437368ad118
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 02c3270a2124. Setting up logs at ./log/docker/node1_2024-11-07_12-31-20__361aff39-7aff-47ef-b6e5-e0d35c42a4f3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 48982
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48982/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48982/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.209.18/tcp/48983/p2p/16Uiu2HAmN1XqeMmkGQBwxMPgGg8BK3guRcwh3mWJ2Piwqv2bVwVT","/ip4/172.18.209.18/tcp/48984/ws/p2p/16Uiu2HAmN1XqeMmkGQBwxMPgGg8BK3guRcwh3mWJ2Piwqv2bVwVT"],"enrUri":"enr:-L24QDPtGycG9huHxvp_9LjSz0gfbuqWU_VHbXKAddTYuIGCDeZoxHvQcFFbPcchnWR7IGxkXlY21NVf9Yx_1Ntv_7ACgmlkgnY0gmlwhKwS0RKKbXVsdGlhZGRyc5YACASsEtESBr9XAAoErBLREga_WN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDivxnMiVW8AmRzsFg586IGJ2oaRv8KYbFgzBTyMwqLWqDdGNwgr9Xg3VkcIK_WYV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60770/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20854/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48982/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1730982684722493696}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60770/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730982684722493696,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20854/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730982684722493696,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ae11d64af2a7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 76257a37db03
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ae11d64af2a7. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 02c3270a2124
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 76257a37db03. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.