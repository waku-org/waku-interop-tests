[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_invalid_meta with id: 2024-11-07_12-44-48__716a28ea-1fdb-4073-9e01-6a29e44fc73c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-07_12-44-48__716a28ea-1fdb-4073-9e01-6a29e44fc73c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.150.178
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['18280', '18281', '18282', '18283', '18284']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 18280:18280 -p 18281:18281 -p 18282:18282 -p 18283:18283 -p 18284:18284 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18282 --rest-port=18280 --tcp-port=18281 --discv5-udp-port=18283 --rest-address=0.0.0.0 --nat=extip:172.18.150.178 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d49c5eb78f4ceb2aefc49178bf1c686be8db3edaca1d95cc0fe490cad9b59ed1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18284 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.150.178 waku baaa95e97f37f43a6ab2ffd6f7abcb7d3688e004fec753ba4d70b9ec667d23a9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID baaa95e97f37. Setting up logs at ./log/docker/node1_2024-11-07_12-44-48__716a28ea-1fdb-4073-9e01-6a29e44fc73c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 18280
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3c68ca99282f. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18280/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18280/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.150.178/tcp/18281/p2p/16Uiu2HAm6YBjZNdg5nK37WZNggpUjNJtC6GCWLgttc6GTRAf4N1d","/ip4/172.18.150.178/tcp/18282/ws/p2p/16Uiu2HAm6YBjZNdg5nK37WZNggpUjNJtC6GCWLgttc6GTRAf4N1d"],"enrUri":"enr:-L24QI6k0GE9sICO9RcHY4yVhaEGA5szvFlTXAaBiB6xDsH0JPx0TBeTWjJCS3RGl4EHkcD_8-3wQEMe_2m7DvdcVv4CgmlkgnY0gmlwhKwSlrKKbXVsdGlhZGRyc5YACASsEpayBkdpAAoErBKWsgZHat0DgnJzhQADAQAAiXNlY3AyNTZrMaECpRuvRVMvqzvpdGCNQHvrXJNijj3nItwfUfpAzgajgZCDdGNwgkdpg3VkcIJHa4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-07_12-44-48__716a28ea-1fdb-4073-9e01-6a29e44fc73c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.153.136
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['52443', '52444', '52445', '52446', '52447']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 52443:52443 -p 52444:52444 -p 52445:52445 -p 52446:52446 -p 52447:52447 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52445 --rest-port=52443 --tcp-port=52444 --discv5-udp-port=52446 --rest-address=0.0.0.0 --nat=extip:172.18.153.136 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=100a7093fbbb8da9ca5fbcfa9aa0b57ad1147cba2956eac820ba6d8989ab7f55 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52447 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QI6k0GE9sICO9RcHY4yVhaEGA5szvFlTXAaBiB6xDsH0JPx0TBeTWjJCS3RGl4EHkcD_8-3wQEMe_2m7DvdcVv4CgmlkgnY0gmlwhKwSlrKKbXVsdGlhZGRyc5YACASsEpayBkdpAAoErBKWsgZHat0DgnJzhQADAQAAiXNlY3AyNTZrMaECpRuvRVMvqzvpdGCNQHvrXJNijj3nItwfUfpAzgajgZCDdGNwgkdpg3VkcIJHa4V3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.153.136 waku b4f984a04ca61df6540d4300d99c1f78e78f2faad963507662f32e1e4774c675
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b4f984a04ca6. Setting up logs at ./log/docker/node2_2024-11-07_12-44-48__716a28ea-1fdb-4073-9e01-6a29e44fc73c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 52443
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52443/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52443/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.153.136/tcp/52444/p2p/16Uiu2HAmJHyuWFcM8mKjEZrruNp73LzEv3SU8BE3qZdYyWaLfhmB","/ip4/172.18.153.136/tcp/52445/ws/p2p/16Uiu2HAmJHyuWFcM8mKjEZrruNp73LzEv3SU8BE3qZdYyWaLfhmB"],"enrUri":"enr:-L24QNJ0cdCeIR7D9_hBsCfK805JucsYNMCDxptnzP3qhMxnOmJFKnBaEUcrjxk2Ks1mtWvX2CTlM3Wd1K28hmdRMYwCgmlkgnY0gmlwhKwSmYiKbXVsdGlhZGRyc5YACASsEpmIBszcAAoErBKZiAbM3d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDU8RsAXaaqGAnsWFQRRGve2Q8A_uN-hYDGaMn-ZJYg6KDdGNwgszcg3VkcILM3oV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52443/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.150.178/tcp/18281/p2p/16Uiu2HAm6YBjZNdg5nK37WZNggpUjNJtC6GCWLgttc6GTRAf4N1d"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18280/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52443/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18280/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18280/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730983491754324480,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730983491754324480,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18280/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "meta": "Relay works!!"}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:18280/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Incorrect base64 string'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id baaa95e97f37
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b4f984a04ca6
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container baaa95e97f37. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.