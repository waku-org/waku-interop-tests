[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_filter_get_message_after_node2_restarts with id: 2024-04-30_04-13-07__66069f63-85b4-4066-807d-fd92f5b789a2
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/node1_2024-04-30_04-13-07__66069f63-85b4-4066-807d-fd92f5b789a2__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.108.247
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['34637', '34638', '34639', '34640', '34641']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 34637:34637 -p 34638:34638 -p 34639:34639 -p 34640:34640 -p 34641:34641 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34639 --rest-port=34637 --tcp-port=34638 --discv5-udp-port=34640 --rest-address=0.0.0.0 --nat=extip:172.18.108.247 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34641 --metrics-logging=true --relay=true --filter=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.108.247 waku 68cbacb71cc05f44e4ddbcf69a94007ddb00085ab6b423ef4bfc4d73bac2d96f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 68cbacb71cc0. Setting up logs at ./log/docker/node1_2024-04-30_04-13-07__66069f63-85b4-4066-807d-fd92f5b789a2__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 34637
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34637/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.108.247/tcp/34638/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.108.247/tcp/34639/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QGqwoyimW7J5J-QoWeMJu12N4behFC_yIg0HB52TaeEacmg118ZbmIHiFeOltxLF5cSHUjfinJquohHsAtRdwAwBgmlkgnY0gmlwhKwSbPeKbXVsdGlhZGRyc4wACgSsEmz3BodP3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCh06DdWRwgodQhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/node2_2024-04-30_04-13-07__66069f63-85b4-4066-807d-fd92f5b789a2__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.99.22
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['55793', '55794', '55795', '55796', '55797']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 55793:55793 -p 55794:55794 -p 55795:55795 -p 55796:55796 -p 55797:55797 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55795 --rest-port=55793 --tcp-port=55794 --discv5-udp-port=55796 --rest-address=0.0.0.0 --nat=extip:172.18.99.22 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55797 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QGqwoyimW7J5J-QoWeMJu12N4behFC_yIg0HB52TaeEacmg118ZbmIHiFeOltxLF5cSHUjfinJquohHsAtRdwAwBgmlkgnY0gmlwhKwSbPeKbXVsdGlhZGRyc4wACgSsEmz3BodP3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCh06DdWRwgodQhXdha3UyBQ --filternode=/ip4/172.18.108.247/tcp/34638/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.99.22 waku 4bf80afe041412ae60cb71238b51bbbb829acaad6ccbb88d74584eb5ca382d67
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 4bf80afe0414. Setting up logs at ./log/docker/node2_2024-04-30_04-13-07__66069f63-85b4-4066-807d-fd92f5b789a2__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 55793
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55793/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.99.22/tcp/55794/p2p/16Uiu2HAmH21zyhSifJRa8Hnre5LKeWxbT6ioPFvsAZ1G8g8tsqdd","/ip4/172.18.99.22/tcp/55795/ws/p2p/16Uiu2HAmH21zyhSifJRa8Hnre5LKeWxbT6ioPFvsAZ1G8g8tsqdd"],"enrUri":"enr:-LO4QPR2l3pwdOyOfQH7YMjfXB73l_c4nD80V8LI71Y3FAN1SC32MKsDao8b-ru3bphM6taA3YPNQxemcHEL00ibPckBgmlkgnY0gmlwhKwSYxaKbXVsdGlhZGRyc4wACgSsEmMWBtnz3QOCcnOFAAABAACJc2VjcDI1NmsxoQNA0c9k1Xci_ADaPV49nCD3YUlapV5ac9-19yykO5rgrIN0Y3CC2fKDdWRwgtn0hXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55793/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.108.247/tcp/34638/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34637/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55793/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "73192234-2071-4fa9-8358-de91fedfb53d", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"73192234-2071-4fa9-8358-de91fedfb53d","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34637/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:97 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55793/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1714450390269675520,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:174 Restarting container with id 4bf80afe0414
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55793/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55793/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.99.22/tcp/55794/p2p/16Uiu2HAmCBfB1TPUjSBAu46BMNGcBgE8LSDi5VqFUD5LbkviSZkg","/ip4/172.18.99.22/tcp/55795/ws/p2p/16Uiu2HAmCBfB1TPUjSBAu46BMNGcBgE8LSDi5VqFUD5LbkviSZkg"],"enrUri":"enr:-LO4QF8W5GUmjPNaa5eXcZpmA7lPeD1bEdYTsmGa9WDkH1I0Of3QmF87elb7zKcNwjn4IZtsX22vFUdfjlwL2hbvbfwBgmlkgnY0gmlwhKwSYxaKbXVsdGlhZGRyc4wACgSsEmMWBtnz3QOCcnOFAAABAACJc2VjcDI1NmsxoQL4_6JlHDtsxrf53vVPdpzkqYoRkWnBPKAwQB8nWsSivYN0Y3CC2fKDdWRwgtn0hXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34637/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55793/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d2f84491-c193-4648-a46d-ec2e7e908f02", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"d2f84491-c193-4648-a46d-ec2e7e908f02","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34637/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:97 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55793/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1714450395751558400,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 68cbacb71cc0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 4bf80afe0414
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.