[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_subscribe_refresh with id: 2024-09-08_04-16-56__0ac95515-2218-4643-ab3b-696a28f31a4b
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-08_04-16-56__0ac95515-2218-4643-ab3b-696a28f31a4b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.89.43
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['19729', '19730', '19731', '19732', '19733']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 19729:19729 -p 19730:19730 -p 19731:19731 -p 19732:19732 -p 19733:19733 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19731 --rest-port=19729 --tcp-port=19730 --discv5-udp-port=19732 --rest-address=0.0.0.0 --nat=extip:172.18.89.43 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e862bcae8bdd26bf5eba5a30dba22ba0f42fb27daab8a60eb4a4fb72fd1a5a5a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19733 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.89.43 waku 5512b38333ae72908d1a9ec36f75cc1621134ca79b4378e7538184c486e3024e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 5512b38333ae. Setting up logs at ./log/docker/node1_2024-09-08_04-16-56__0ac95515-2218-4643-ab3b-696a28f31a4b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 19729
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19729/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19729/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.89.43/tcp/19730/p2p/16Uiu2HAmNT8CcDykkR4UpHc4QgkJsRYd9yJ2xSbDn3U8E4vcbB7c","/ip4/172.18.89.43/tcp/19731/ws/p2p/16Uiu2HAmNT8CcDykkR4UpHc4QgkJsRYd9yJ2xSbDn3U8E4vcbB7c"],"enrUri":"enr:-LO4QCpofaGjD1cyERcEbiquF0vEekYzaC548ZCboVSm94-pZhd7ca76xv4apKopuE8kkw2t9nF11I8Un5Pjt1HhKgkBgmlkgnY0gmlwhKwSWSuKbXVsdGlhZGRyc4wACgSsElkrBk0T3QOCcnOFAAMBAACJc2VjcDI1NmsxoQORisajlj5gP8WjgYorpxdXBG-bVrPoetNzAiz9KUfxx4N0Y3CCTRKDdWRwgk0UhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-08_04-16-56__0ac95515-2218-4643-ab3b-696a28f31a4b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.131.107
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['51375', '51376', '51377', '51378', '51379']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 51375:51375 -p 51376:51376 -p 51377:51377 -p 51378:51378 -p 51379:51379 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51377 --rest-port=51375 --tcp-port=51376 --discv5-udp-port=51378 --rest-address=0.0.0.0 --nat=extip:172.18.131.107 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f26a74c3fcee39d7ba90c3ca6be8bbea2dfdc242fb9bafa55bfda0bcbe3298bb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51379 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QCpofaGjD1cyERcEbiquF0vEekYzaC548ZCboVSm94-pZhd7ca76xv4apKopuE8kkw2t9nF11I8Un5Pjt1HhKgkBgmlkgnY0gmlwhKwSWSuKbXVsdGlhZGRyc4wACgSsElkrBk0T3QOCcnOFAAMBAACJc2VjcDI1NmsxoQORisajlj5gP8WjgYorpxdXBG-bVrPoetNzAiz9KUfxx4N0Y3CCTRKDdWRwgk0UhXdha3UyBQ --filternode=/ip4/172.18.89.43/tcp/19730/p2p/16Uiu2HAmNT8CcDykkR4UpHc4QgkJsRYd9yJ2xSbDn3U8E4vcbB7c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.131.107 waku 633014879bafca158f86790f3f6b85747fe5ae20ab97ab232deaf875181afd79
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 633014879baf. Setting up logs at ./log/docker/node2_2024-09-08_04-16-56__0ac95515-2218-4643-ab3b-696a28f31a4b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 51375
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51375/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51375/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.131.107/tcp/51376/p2p/16Uiu2HAmA5G1QXTs1YUVDapbQVLNFDUmgnUjxuTktmELhWTjHHHx","/ip4/172.18.131.107/tcp/51377/ws/p2p/16Uiu2HAmA5G1QXTs1YUVDapbQVLNFDUmgnUjxuTktmELhWTjHHHx"],"enrUri":"enr:-LO4QH4v5chsljzpPYC-C9fuFD7H4z9fUSCB3T-_TQngJOeqaYGhN9Km8bp6qefNoSPU4XUD8FyR0t0TWIS41Gm2s4MBgmlkgnY0gmlwhKwSg2uKbXVsdGlhZGRyc4wACgSsEoNrBsix3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLZpJUPsXgQsSU-HezQxYKWdwEB4ZyhYFdXANYWP1sFt4N0Y3CCyLCDdWRwgsiyhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51375/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.89.43/tcp/19730/p2p/16Uiu2HAmNT8CcDykkR4UpHc4QgkJsRYd9yJ2xSbDn3U8E4vcbB7c"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19729/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51375/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "bb647611-0839-4d09-bdb7-f1c7f611d67a", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"bb647611-0839-4d09-bdb7-f1c7f611d67a","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19729/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51375/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1725769019860079616,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19729/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51375/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "b74d7c12-af28-4791-80bb-ded98c78cd51", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"b74d7c12-af28-4791-80bb-ded98c78cd51","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19729/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51375/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1725769019990619904,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 5512b38333ae
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 633014879baf
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.