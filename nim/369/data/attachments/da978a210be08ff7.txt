[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_subscribe_refresh with id: 2024-09-23_04-16-23__c0d5901b-fd4b-4246-acb7-aaf3c7992216
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-23_04-16-23__c0d5901b-fd4b-4246-acb7-aaf3c7992216__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.57.105
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['14238', '14239', '14240', '14241', '14242']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 14238:14238 -p 14239:14239 -p 14240:14240 -p 14241:14241 -p 14242:14242 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14240 --rest-port=14238 --tcp-port=14239 --discv5-udp-port=14241 --rest-address=0.0.0.0 --nat=extip:172.18.57.105 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4f8baf23bafadcbbae44ec3cfb5646d3779c02586db3bdbebc8b10dea44ead1f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14242 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.57.105 waku 981bcfe6f4c4cbd0d5061945740422e46cf2e05737e1a6e969fffb8a9a0528c5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 981bcfe6f4c4. Setting up logs at ./log/docker/node1_2024-09-23_04-16-23__c0d5901b-fd4b-4246-acb7-aaf3c7992216__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 14238
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14238/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14238/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.57.105/tcp/14239/p2p/16Uiu2HAmEuHbef7cuz8Minq5TgxLZkvBJwfhiFr3uLug9KXEkAAj","/ip4/172.18.57.105/tcp/14240/ws/p2p/16Uiu2HAmEuHbef7cuz8Minq5TgxLZkvBJwfhiFr3uLug9KXEkAAj"],"enrUri":"enr:-LO4QMm-WKiteONYn72qtn2U0kseGsj7w5gn11iV9N6ZzgMEBxKFfA5Z-v9-F680udkildaF-SFDnLOFwFIfNjQ0UeQBgmlkgnY0gmlwhKwSOWmKbXVsdGlhZGRyc4wACgSsEjlpBjeg3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMhYQHQwPKwGfogf_mQSPvW-2J7AA5a0Rna-OBiZe3vQIN0Y3CCN5-DdWRwgjehhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-23_04-16-23__c0d5901b-fd4b-4246-acb7-aaf3c7992216__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.201.77
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['4522', '4523', '4524', '4525', '4526']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 4522:4522 -p 4523:4523 -p 4524:4524 -p 4525:4525 -p 4526:4526 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4524 --rest-port=4522 --tcp-port=4523 --discv5-udp-port=4525 --rest-address=0.0.0.0 --nat=extip:172.18.201.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1ff55dbdf98a8bcd8a8a4f70915bbc5cd5fad7a329a75b6fdad3a892cc6d7f00 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4526 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QMm-WKiteONYn72qtn2U0kseGsj7w5gn11iV9N6ZzgMEBxKFfA5Z-v9-F680udkildaF-SFDnLOFwFIfNjQ0UeQBgmlkgnY0gmlwhKwSOWmKbXVsdGlhZGRyc4wACgSsEjlpBjeg3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMhYQHQwPKwGfogf_mQSPvW-2J7AA5a0Rna-OBiZe3vQIN0Y3CCN5-DdWRwgjehhXdha3UyBQ --filternode=/ip4/172.18.57.105/tcp/14239/p2p/16Uiu2HAmEuHbef7cuz8Minq5TgxLZkvBJwfhiFr3uLug9KXEkAAj
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.201.77 waku b525ede7251c063f84461751194df6f700df5066305fa28b988278997b307257
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID b525ede7251c. Setting up logs at ./log/docker/node2_2024-09-23_04-16-23__c0d5901b-fd4b-4246-acb7-aaf3c7992216__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 4522
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4522/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4522/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.201.77/tcp/4523/p2p/16Uiu2HAm9H5Z7kRmd1eBZsxduzsiTM1K7QaXwk8nhay4tUpLVqRN","/ip4/172.18.201.77/tcp/4524/ws/p2p/16Uiu2HAm9H5Z7kRmd1eBZsxduzsiTM1K7QaXwk8nhay4tUpLVqRN"],"enrUri":"enr:-LO4QGajXXATIF2RnBBI69w9QR7N6kc81AFWpQYs7TD4C1XbS_5dYv9MrKb18DnVueeYVsKOYIUv3jdInWDm6ff52c4BgmlkgnY0gmlwhKwSyU2KbXVsdGlhZGRyc4wACgSsEslNBhGs3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLN0Aumnv6YuWrVlPdk_B08XFKZtm9SVLw4MW8jsCdwdYN0Y3CCEauDdWRwghGthXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4522/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.57.105/tcp/14239/p2p/16Uiu2HAmEuHbef7cuz8Minq5TgxLZkvBJwfhiFr3uLug9KXEkAAj"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14238/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4522/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "3f445cf7-6354-4593-912e-daec1555ca96", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"3f445cf7-6354-4593-912e-daec1555ca96","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14238/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4522/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1727064987243293696,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14238/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4522/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "be4dabd7-a6e2-4f3f-8dc4-3d54e6e0dd3a", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"be4dabd7-a6e2-4f3f-8dc4-3d54e6e0dd3a","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14238/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4522/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1727064987375589632,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 981bcfe6f4c4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b525ede7251c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.