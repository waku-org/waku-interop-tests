[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_valid_version with id: 2024-09-23_04-22-27__023c71bb-a2d8-4848-b4d7-e2503622bfbb
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-23_04-22-27__023c71bb-a2d8-4848-b4d7-e2503622bfbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.128.4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['14317', '14318', '14319', '14320', '14321']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 14317:14317 -p 14318:14318 -p 14319:14319 -p 14320:14320 -p 14321:14321 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14319 --rest-port=14317 --tcp-port=14318 --discv5-udp-port=14320 --rest-address=0.0.0.0 --nat=extip:172.18.128.4 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=745e0fe43bfca9db2a864cfa6b5c2eda74d2a92ddabdd42a9af3178dccdfcfe2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14321 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.128.4 waku 4169d3cd5d868ab56746332f019e0f132f740f32e330cf6493a670b924a901ee
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 4169d3cd5d86. Setting up logs at ./log/docker/node1_2024-09-23_04-22-27__023c71bb-a2d8-4848-b4d7-e2503622bfbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 14317
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14317/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14317/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.128.4/tcp/14318/p2p/16Uiu2HAmRZsBbRm5wsgANWydV8UF2GjsTVTSYuibcvWopgbA1rdP","/ip4/172.18.128.4/tcp/14319/ws/p2p/16Uiu2HAmRZsBbRm5wsgANWydV8UF2GjsTVTSYuibcvWopgbA1rdP"],"enrUri":"enr:-LO4QNkcKbUzkhCGahL4yYJ2s2dF2oq08L3dUG308UflnsEwHpgK_pCJ24YOUlRxCDwNKiXIBG2e7K5OyXNoTWdPPowBgmlkgnY0gmlwhKwSgASKbXVsdGlhZGRyc4wACgSsEoAEBjfv3QOCcnOFAAMBAACJc2VjcDI1NmsxoQO_1-wMFf8kjpLx3Mb8RUFrndwbKxh7QbSkqaLtZylOMoN0Y3CCN-6DdWRwgjfwhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-23_04-22-27__023c71bb-a2d8-4848-b4d7-e2503622bfbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.141.103
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['12157', '12158', '12159', '12160', '12161']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 12157:12157 -p 12158:12158 -p 12159:12159 -p 12160:12160 -p 12161:12161 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12159 --rest-port=12157 --tcp-port=12158 --discv5-udp-port=12160 --rest-address=0.0.0.0 --nat=extip:172.18.141.103 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=044d8df0b23cb5eac6ea1c6f141b6ebe866afde5b0eeedbcea14c7dca1ca4c5e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12161 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QNkcKbUzkhCGahL4yYJ2s2dF2oq08L3dUG308UflnsEwHpgK_pCJ24YOUlRxCDwNKiXIBG2e7K5OyXNoTWdPPowBgmlkgnY0gmlwhKwSgASKbXVsdGlhZGRyc4wACgSsEoAEBjfv3QOCcnOFAAMBAACJc2VjcDI1NmsxoQO_1-wMFf8kjpLx3Mb8RUFrndwbKxh7QbSkqaLtZylOMoN0Y3CCN-6DdWRwgjfwhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.141.103 waku e2be40ff3c82ed2ef68db990cf876a4fea5a366ba46d24919485818d0fc7b96a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e2be40ff3c82. Setting up logs at ./log/docker/node2_2024-09-23_04-22-27__023c71bb-a2d8-4848-b4d7-e2503622bfbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 12157
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12157/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12157/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.141.103/tcp/12158/p2p/16Uiu2HAmJppFmT4A7zVFqXEXxjsd3dn5zFGR6h6tJZqL1kGjbHu4","/ip4/172.18.141.103/tcp/12159/ws/p2p/16Uiu2HAmJppFmT4A7zVFqXEXxjsd3dn5zFGR6h6tJZqL1kGjbHu4"],"enrUri":"enr:-LO4QI1qwuoGUcSC6kNTmm8ZaHMUJMa6-_WrCHRbyNxAz9IrZd_pXyWhXE3XAg4f3c0F2A_qxlmNQLyfywD9CvrkfCQBgmlkgnY0gmlwhKwSjWeKbXVsdGlhZGRyc4wACgSsEo1nBi9_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNbqoPTql2i0TupgrsAvLvzEhj3d0_aoPFqs9gg7zbYG4N0Y3CCL36DdWRwgi-AhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12157/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.128.4/tcp/14318/p2p/16Uiu2HAmRZsBbRm5wsgANWydV8UF2GjsTVTSYuibcvWopgbA1rdP"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14317/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12157/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14317/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14317/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1727065351562312960,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12157/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1727065351562312960,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14317/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14317/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1727065351697481216,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12157/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1727065351697481216,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 4169d3cd5d86
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e2be40ff3c82
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.