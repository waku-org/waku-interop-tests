[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_main_node_relay_and_store__peer_relay_and_store with id: 2024-11-16_04-37-06__411e61d9-ffd2-4a06-aa79-4b863ed14204
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-11-16_04-37-06__411e61d9-ffd2-4a06-aa79-4b863ed14204__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.248.169
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['21180', '21181', '21182', '21183', '21184']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 21180:21180 -p 21181:21181 -p 21182:21182 -p 21183:21183 -p 21184:21184 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21182 --rest-port=21180 --tcp-port=21181 --discv5-udp-port=21183 --rest-address=0.0.0.0 --nat=extip:172.18.248.169 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a9ca0bdb80ebfdb2afab1c7cf3a5a8af51ddeac6cadf7ac18eb6b2fb81944c86 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21184 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.248.169 waku bb52ef1d2db5e4036688ab6442e2fdc790d3e20b03c9339cc30ea6d146d10e63
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID bb52ef1d2db5. Setting up logs at ./log/docker/publishing_node1_2024-11-16_04-37-06__411e61d9-ffd2-4a06-aa79-4b863ed14204__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 21180
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d7b94756f383. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21180/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21180/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.248.169/tcp/21181/p2p/16Uiu2HAmRPBQ3mD7wPzVnpDqeY76hmRyzvUvum5dbVBiyahsBQrb","/ip4/172.18.248.169/tcp/21182/ws/p2p/16Uiu2HAmRPBQ3mD7wPzVnpDqeY76hmRyzvUvum5dbVBiyahsBQrb"],"enrUri":"enr:-L24QH0AIZBq6KQJpgMB9wuwXmIXc3vlWxC8jR7l-mJ8TAC4PurUgXkAtm544tYpOpCda8Tf6VAlBpE9aW41IvK0WocCgmlkgnY0gmlwhKwS-KmKbXVsdGlhZGRyc5YACASsEvipBlK9AAoErBL4qQZSvt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDvRsg7OjQJ3mzEzdTXB-KrDTYra5HOgBdyPtePJpb9GiDdGNwglK9g3VkcIJSv4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-11-16_04-37-06__411e61d9-ffd2-4a06-aa79-4b863ed14204__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.96.94
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['30382', '30383', '30384', '30385', '30386']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 30382:30382 -p 30383:30383 -p 30384:30384 -p 30385:30385 -p 30386:30386 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30384 --rest-port=30382 --tcp-port=30383 --discv5-udp-port=30385 --rest-address=0.0.0.0 --nat=extip:172.18.96.94 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=63cdc40bc8161f1dff2d1f27ca960bb23a6abb07ff4c7a7fabf9c699efaedceb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30386 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QH0AIZBq6KQJpgMB9wuwXmIXc3vlWxC8jR7l-mJ8TAC4PurUgXkAtm544tYpOpCda8Tf6VAlBpE9aW41IvK0WocCgmlkgnY0gmlwhKwS-KmKbXVsdGlhZGRyc5YACASsEvipBlK9AAoErBL4qQZSvt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDvRsg7OjQJ3mzEzdTXB-KrDTYra5HOgBdyPtePJpb9GiDdGNwglK9g3VkcIJSv4V3YWt1MgM --storenode=/ip4/172.18.248.169/tcp/21181/p2p/16Uiu2HAmRPBQ3mD7wPzVnpDqeY76hmRyzvUvum5dbVBiyahsBQrb --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.96.94 waku 9732aa6cef81ee462e6630ec2b8a02fbb19aa35898845c207e2c0274141e7c5e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9732aa6cef81. Setting up logs at ./log/docker/store_node1_2024-11-16_04-37-06__411e61d9-ffd2-4a06-aa79-4b863ed14204__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 30382
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30382/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30382/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.96.94/tcp/30383/p2p/16Uiu2HAm5HTroRWyEURbxH4JgxEB7u16Zfsrh1UEsLsQREAq96cs","/ip4/172.18.96.94/tcp/30384/ws/p2p/16Uiu2HAm5HTroRWyEURbxH4JgxEB7u16Zfsrh1UEsLsQREAq96cs"],"enrUri":"enr:-L24QLsAd_YKlqZlhsK3eADesUs-FGVApxO3sQcSVH85OI-JJl8xYTmiARspHvBAI9V4MYS2JXEZaEzRZ6Bn2Uc8K2oCgmlkgnY0gmlwhKwSYF6KbXVsdGlhZGRyc5YACASsEmBeBnavAAoErBJgXgZ2sN0DgnJzhQADAQAAiXNlY3AyNTZrMaECknqEndW7yYzsPLEAsSJLFRlSzLxHtzTovSfpyfUBVPSDdGNwgnavg3VkcIJ2sYV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30382/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.248.169/tcp/21181/p2p/16Uiu2HAmRPBQ3mD7wPzVnpDqeY76hmRyzvUvum5dbVBiyahsBQrb"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21180/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30382/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21180/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21180/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"xuzCeQxa6/UxVW/emDg9l1dHLmEp7aZ738I5rrhJ4Ro="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30382/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"xuzCeQxa6/UxVW/emDg9l1dHLmEp7aZ738I5rrhJ4Ro="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id bb52ef1d2db5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 9732aa6cef81
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container bb52ef1d2db5. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.