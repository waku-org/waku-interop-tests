[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_same_shard with id: 2024-08-26_15-11-35__03ef6911-28c5-4060-a62b-da26f034faa5
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-11-35__03ef6911-28c5-4060-a62b-da26f034faa5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.98.166
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['31460', '31461', '31462', '31463', '31464']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 31460:31460 -p 31461:31461 -p 31462:31462 -p 31463:31463 -p 31464:31464 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31462 --rest-port=31460 --tcp-port=31461 --discv5-udp-port=31463 --rest-address=0.0.0.0 --nat=extip:172.18.98.166 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a6fdb61cf5ab1a343bfbad59d94292dfc5552d548a8d18f691315da73ab12d6b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31464 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.98.166 waku 95a870a92497e12b091a7c003816888ab7d60db38826f660d0a14d169dcb9c60
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 95a870a92497. Setting up logs at ./log/docker/node1_2024-08-26_15-11-35__03ef6911-28c5-4060-a62b-da26f034faa5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 31460
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31460/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31460/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.98.166/tcp/31461/p2p/16Uiu2HAmHem1YNeDERA88on9fjXYuyE7vT143ZoNmhpbGBTgLdvS","/ip4/172.18.98.166/tcp/31462/ws/p2p/16Uiu2HAmHem1YNeDERA88on9fjXYuyE7vT143ZoNmhpbGBTgLdvS"],"enrUri":"enr:-LO4QHhnBcUIrMLUNhunt6G5EKVmfXpyHnnHiz2-XfSEz0S6ehQdUlQCUeb5Ragjl2RAVeOhZR0vHJku9AaOMTqxs4IBgmlkgnY0gmlwhKwSYqaKbXVsdGlhZGRyc4wACgSsEmKmBnrm3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNKO1m6LC7H09opYnswD8ETYyHj8h4IJ3r4pbrTlHsZ04N0Y3CCeuWDdWRwgnrnhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-11-35__03ef6911-28c5-4060-a62b-da26f034faa5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.91.229
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['60661', '60662', '60663', '60664', '60665']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 60661:60661 -p 60662:60662 -p 60663:60663 -p 60664:60664 -p 60665:60665 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60663 --rest-port=60661 --tcp-port=60662 --discv5-udp-port=60664 --rest-address=0.0.0.0 --nat=extip:172.18.91.229 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=68ff01ead23830c8ff8cde60ac03018a8aafb482afcaf16fa0d17ea22b6fbdd6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60665 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QHhnBcUIrMLUNhunt6G5EKVmfXpyHnnHiz2-XfSEz0S6ehQdUlQCUeb5Ragjl2RAVeOhZR0vHJku9AaOMTqxs4IBgmlkgnY0gmlwhKwSYqaKbXVsdGlhZGRyc4wACgSsEmKmBnrm3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNKO1m6LC7H09opYnswD8ETYyHj8h4IJ3r4pbrTlHsZ04N0Y3CCeuWDdWRwgnrnhXdha3UyBQ --pubsub-topic=/waku/2/rs/4/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.91.229 waku 65302175f9d1a1132bc4ccf1e814ed472dc31b281802c153ad125aa59c8dce9a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 65302175f9d1. Setting up logs at ./log/docker/node2_2024-08-26_15-11-35__03ef6911-28c5-4060-a62b-da26f034faa5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 60661
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60661/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60661/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.91.229/tcp/60662/p2p/16Uiu2HAmLEjeeLGKpBzNRq14fDFsqsz6cTVC3frqY5A2nrDVsfRy","/ip4/172.18.91.229/tcp/60663/ws/p2p/16Uiu2HAmLEjeeLGKpBzNRq14fDFsqsz6cTVC3frqY5A2nrDVsfRy"],"enrUri":"enr:-LO4QKvv1jtBinByXPADt0DTGOZAYIrcCGdJbz4Lo7sGEynjRPvaE30-wwpiIAm5Cp9a-Zn0UpEe9_BSeMS_2YbXr1IBgmlkgnY0gmlwhKwSW-WKbXVsdGlhZGRyc4wACgSsElvlBuz33QOCcnOFAAQBAACJc2VjcDI1NmsxoQNwpu8LN8T4Ktwfzl87QOvbHUcazcv9PgLK5fcMTFcD0IN0Y3CC7PaDdWRwguz4hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60661/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.98.166/tcp/31461/p2p/16Uiu2HAmHem1YNeDERA88on9fjXYuyE7vT143ZoNmhpbGBTgLdvS"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31460/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60661/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31460/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31460/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724685099087112192,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60661/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:60661/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 95a870a92497
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 65302175f9d1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:11:39.200+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=404 meth=GET peer=172.17.0.1:38882 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0 error_status="404 Not Found" error_content_type=text/plain error_message=']
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_same_shard with id: 2024-08-26_15-11-44__07cf6cde-95e9-469b-a283-e54f37145ae8
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-11-44__07cf6cde-95e9-469b-a283-e54f37145ae8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.233.177
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['22427', '22428', '22429', '22430', '22431']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 22427:22427 -p 22428:22428 -p 22429:22429 -p 22430:22430 -p 22431:22431 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22429 --rest-port=22427 --tcp-port=22428 --discv5-udp-port=22430 --rest-address=0.0.0.0 --nat=extip:172.18.233.177 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=5ddbb0522fdaf590a6c05bb4fa1921ee2adf274844ddb8dfca1eccd9b65744be --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22431 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.233.177 waku a5f19d5583cb8b024112e6fec0852bb06d3cddc5e73bdfd23fe000649f2d86ec
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID a5f19d5583cb. Setting up logs at ./log/docker/node1_2024-08-26_15-11-44__07cf6cde-95e9-469b-a283-e54f37145ae8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22427
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22427/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22427/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.233.177/tcp/22428/p2p/16Uiu2HAm7bP29wtGSczVFto9SYHUuUAtr5EHd3f7ZbRxwMpgkEk8","/ip4/172.18.233.177/tcp/22429/ws/p2p/16Uiu2HAm7bP29wtGSczVFto9SYHUuUAtr5EHd3f7ZbRxwMpgkEk8"],"enrUri":"enr:-LO4QH4XGwrWHpPG56JEbYTdX--1shKew8Rg25JX3TrJXWGqOz-oWKgMAk3w1DogoOnW28DnwcH6jaSauTr-ofo3OYcBgmlkgnY0gmlwhKwS6bGKbXVsdGlhZGRyc4wACgSsEumxBled3QOCcnOFAAIBAACJc2VjcDI1NmsxoQK0yOASmNIL02GdOAPTYUF-ZgrPq1AUu8GYS9N2AopSIYN0Y3CCV5yDdWRwgleehXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-11-44__07cf6cde-95e9-469b-a283-e54f37145ae8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.251.201
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['51087', '51088', '51089', '51090', '51091']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 51087:51087 -p 51088:51088 -p 51089:51089 -p 51090:51090 -p 51091:51091 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51089 --rest-port=51087 --tcp-port=51088 --discv5-udp-port=51090 --rest-address=0.0.0.0 --nat=extip:172.18.251.201 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=f6aeaebaac5c68faae54bbcbedccf61b88a0e0fcaaedc4fa13c584b1c1a1cbf6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51091 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QH4XGwrWHpPG56JEbYTdX--1shKew8Rg25JX3TrJXWGqOz-oWKgMAk3w1DogoOnW28DnwcH6jaSauTr-ofo3OYcBgmlkgnY0gmlwhKwS6bGKbXVsdGlhZGRyc4wACgSsEumxBled3QOCcnOFAAIBAACJc2VjcDI1NmsxoQK0yOASmNIL02GdOAPTYUF-ZgrPq1AUu8GYS9N2AopSIYN0Y3CCV5yDdWRwgleehXdha3UyBQ --pubsub-topic=/waku/2/rs/4/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.251.201 waku a52b737a1ba55469e183bd76f3f9a699ab2483b920365047875cc14eb4bec032
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID a52b737a1ba5. Setting up logs at ./log/docker/node2_2024-08-26_15-11-44__07cf6cde-95e9-469b-a283-e54f37145ae8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 51087
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51087/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51087/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.251.201/tcp/51088/p2p/16Uiu2HAmJoa4MEGKSV4ZbWdUxCPKCKrDAoBAXiJmX5XWysBLjasd","/ip4/172.18.251.201/tcp/51089/ws/p2p/16Uiu2HAmJoa4MEGKSV4ZbWdUxCPKCKrDAoBAXiJmX5XWysBLjasd"],"enrUri":"enr:-LO4QOOq3Z9pBmNRxmQc67OqR0zOkRMIvmf-_92VrysRduy8O2b_58xXxW4qm0czgc5IBcvC1aD4MGRixtph9qBFki0BgmlkgnY0gmlwhKwS-8mKbXVsdGlhZGRyc4wACgSsEvvJBseR3QOCcnOFAAQBAACJc2VjcDI1NmsxoQNbWOG3XfDS-ELBgbc22ki2ELIjpd1iRRIamgG1u6blnIN0Y3CCx5CDdWRwgseShXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51087/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.233.177/tcp/22428/p2p/16Uiu2HAm7bP29wtGSczVFto9SYHUuUAtr5EHd3f7ZbRxwMpgkEk8"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22427/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51087/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22427/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22427/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724685107850185984,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51087/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:51087/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a5f19d5583cb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a52b737a1ba5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:11:47.962+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=404 meth=GET peer=172.17.0.1:43964 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0 error_status="404 Not Found" error_content_type=text/plain error_message=']
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_same_shard with id: 2024-08-26_15-11-51__29aefc89-9278-4235-be06-e5c328f0077a
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-11-51__29aefc89-9278-4235-be06-e5c328f0077a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.113.178
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['48305', '48306', '48307', '48308', '48309']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 48305:48305 -p 48306:48306 -p 48307:48307 -p 48308:48308 -p 48309:48309 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48307 --rest-port=48305 --tcp-port=48306 --discv5-udp-port=48308 --rest-address=0.0.0.0 --nat=extip:172.18.113.178 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=afea26b047b4c3bd2decd0fc5ee70d7ddabdf4262bc6e1d14c7e2bd3ba325d85 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48309 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.113.178 waku 8f46b954675d4320c5da235b414a653595305adb5bfe49fcc751b79326285c90
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 8f46b954675d. Setting up logs at ./log/docker/node1_2024-08-26_15-11-51__29aefc89-9278-4235-be06-e5c328f0077a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 48305
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48305/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48305/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.113.178/tcp/48306/p2p/16Uiu2HAmL1uGRjaEGRDkRBwx8nT8NGA4bMCQTVm2yKktvbvQbesb","/ip4/172.18.113.178/tcp/48307/ws/p2p/16Uiu2HAmL1uGRjaEGRDkRBwx8nT8NGA4bMCQTVm2yKktvbvQbesb"],"enrUri":"enr:-LO4QGeSw6Qwnz32Yht2SSiFhXoitRKEWNwB-Xu8gV1duMRMZWKcMXl_QHySjgwJPoWlLutwYgZuZ0nwIIt1P2CVpnUBgmlkgnY0gmlwhKwScbKKbXVsdGlhZGRyc4wACgSsEnGyBryz3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNtXUHVTNUdzURZv7zJcp7-6WBM1iIV2E3y6uWP0B2bioN0Y3CCvLKDdWRwgry0hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-11-51__29aefc89-9278-4235-be06-e5c328f0077a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.173.58
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['36222', '36223', '36224', '36225', '36226']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 36222:36222 -p 36223:36223 -p 36224:36224 -p 36225:36225 -p 36226:36226 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36224 --rest-port=36222 --tcp-port=36223 --discv5-udp-port=36225 --rest-address=0.0.0.0 --nat=extip:172.18.173.58 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=a45e1daef0feb56ae7eefa1bee37dd498b3faeffdbbf118c29c6b38dbdbba6e6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36226 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QGeSw6Qwnz32Yht2SSiFhXoitRKEWNwB-Xu8gV1duMRMZWKcMXl_QHySjgwJPoWlLutwYgZuZ0nwIIt1P2CVpnUBgmlkgnY0gmlwhKwScbKKbXVsdGlhZGRyc4wACgSsEnGyBryz3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNtXUHVTNUdzURZv7zJcp7-6WBM1iIV2E3y6uWP0B2bioN0Y3CCvLKDdWRwgry0hXdha3UyBQ --pubsub-topic=/waku/2/rs/4/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.173.58 waku 0f686a25468c0369e55ff1e5795635a8927cf7cf09a6974ad38457c0840ad1b3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 0f686a25468c. Setting up logs at ./log/docker/node2_2024-08-26_15-11-51__29aefc89-9278-4235-be06-e5c328f0077a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 36222
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36222/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36222/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.173.58/tcp/36223/p2p/16Uiu2HAmRJf3VKZzG1Fmct5zWMrAuh9hMyJD8fFY8338vhdEpEhN","/ip4/172.18.173.58/tcp/36224/ws/p2p/16Uiu2HAmRJf3VKZzG1Fmct5zWMrAuh9hMyJD8fFY8338vhdEpEhN"],"enrUri":"enr:-LO4QGYuMyWiidhpkxktc7lVw7JfrPQsGcZI-9-0moYR6mbXGzRDKCM1Z81nT3ICBJbhip5ZDvlkLbZEg0LgG3LIDREBgmlkgnY0gmlwhKwSrTqKbXVsdGlhZGRyc4wACgSsEq06Bo2A3QOCcnOFAAQBAACJc2VjcDI1NmsxoQO78nvElH6tBW-OMTZY9sMup9RqrJtKTfncI7UfgM2nIYN0Y3CCjX-DdWRwgo2BhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36222/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.113.178/tcp/48306/p2p/16Uiu2HAmL1uGRjaEGRDkRBwx8nT8NGA4bMCQTVm2yKktvbvQbesb"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48305/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36222/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724685115631228928,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36222/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:36222/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 8f46b954675d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 0f686a25468c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:11:55.742+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=404 meth=GET peer=172.17.0.1:45568 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0 error_status="404 Not Found" error_content_type=text/plain error_message=']