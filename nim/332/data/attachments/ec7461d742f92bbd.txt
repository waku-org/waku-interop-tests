[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_payload_equal_or_more_150_kb with id: 2024-08-26_15-02-20__abe3c8d0-cc3a-4df1-b87f-e2eb2a59097c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-02-20__abe3c8d0-cc3a-4df1-b87f-e2eb2a59097c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.127.75
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['40411', '40412', '40413', '40414', '40415']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 40411:40411 -p 40412:40412 -p 40413:40413 -p 40414:40414 -p 40415:40415 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40413 --rest-port=40411 --tcp-port=40412 --discv5-udp-port=40414 --rest-address=0.0.0.0 --nat=extip:172.18.127.75 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fdef9d1a9410fe5faf7fc1c6fbcaa007bff4dc9eb8808787a2de37feabec0c0e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40415 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.127.75 waku 05712dc517cd8d2817cd7ac7d9841e420dcaf7f665aa313db85d3a01cc217b55
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 05712dc517cd. Setting up logs at ./log/docker/node1_2024-08-26_15-02-20__abe3c8d0-cc3a-4df1-b87f-e2eb2a59097c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 40411
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40411/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40411/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.127.75/tcp/40412/p2p/16Uiu2HAmPQyAuSnj9aQRQC66FYEgSifUvHu5ebgn4uPcyD33uFLW","/ip4/172.18.127.75/tcp/40413/ws/p2p/16Uiu2HAmPQyAuSnj9aQRQC66FYEgSifUvHu5ebgn4uPcyD33uFLW"],"enrUri":"enr:-LO4QJ0jfvLv_SGPBC0lFlkt5kX9eGXYh--PvNfko6BngNKfcLc1p-QHvQzZt0kzfdfjvfCah4euPjo-xIIxYMYQaQYBgmlkgnY0gmlwhKwSf0uKbXVsdGlhZGRyc4wACgSsEn9LBp3d3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOf2Rd6Ksk90MjgPnZe2ztMKSrp_qm5NAGr2og_6IXf44N0Y3CCndyDdWRwgp3ehXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-02-20__abe3c8d0-cc3a-4df1-b87f-e2eb2a59097c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.17.147
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['32397', '32398', '32399', '32400', '32401']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 32397:32397 -p 32398:32398 -p 32399:32399 -p 32400:32400 -p 32401:32401 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32399 --rest-port=32397 --tcp-port=32398 --discv5-udp-port=32400 --rest-address=0.0.0.0 --nat=extip:172.18.17.147 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b20e52c9c0833ebf3caca680bcf093325ed5cafad15f7dbc8bcab1c3ea7fb70e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32401 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QJ0jfvLv_SGPBC0lFlkt5kX9eGXYh--PvNfko6BngNKfcLc1p-QHvQzZt0kzfdfjvfCah4euPjo-xIIxYMYQaQYBgmlkgnY0gmlwhKwSf0uKbXVsdGlhZGRyc4wACgSsEn9LBp3d3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOf2Rd6Ksk90MjgPnZe2ztMKSrp_qm5NAGr2og_6IXf44N0Y3CCndyDdWRwgp3ehXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.17.147 waku 491c83a466fcbbec2806c247172762b9a9a2790fbd67d182865acdb8104ac74f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 491c83a466fc. Setting up logs at ./log/docker/node2_2024-08-26_15-02-20__abe3c8d0-cc3a-4df1-b87f-e2eb2a59097c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 32397
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32397/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32397/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.17.147/tcp/32398/p2p/16Uiu2HAmSw9zcNbvDWHs6HjdWizi3z8BbEPCpsRLGveo4JHXpXZx","/ip4/172.18.17.147/tcp/32399/ws/p2p/16Uiu2HAmSw9zcNbvDWHs6HjdWizi3z8BbEPCpsRLGveo4JHXpXZx"],"enrUri":"enr:-LO4QBw4kjaPvUaevdlIIdiIpK1jMZjH-68n52OKTQ6dB3mxcnrNTyg3z_7YR_pJuxJau4Jy79DFXJlXvV5YvZxoK8sBgmlkgnY0gmlwhKwSEZOKbXVsdGlhZGRyc4wACgSsEhGTBn6P3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPUJ9BV9e4UPaRErQDZJFn5IJGYIdAj8UfZxBe7noC2p4N0Y3CCfo6DdWRwgn6QhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32397/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.127.75/tcp/40412/p2p/16Uiu2HAmPQyAuSnj9aQRQC66FYEgSifUvHu5ebgn4uPcyD33uFLW"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40411/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32397/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40411/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40411/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684544287226880,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32397/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684544287226880,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[35mDEBUG   [0m tests.relay.test_publish:test_publish.py:55 Running test with payload length of 204800 bytes
[32mINFO    [0m src.node.api_clients.base_client:custom_logger.py:10 Log line was discarded because it's longer than max_log_line_length=5000
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40411/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.relay.test_publish:test_publish.py:55 Running test with payload length of 1048576 bytes
[32mINFO    [0m src.node.api_clients.base_client:custom_logger.py:10 Log line was discarded because it's longer than max_log_line_length=5000
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40411/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
[35mDEBUG   [0m tests.relay.test_publish:test_publish.py:55 Running test with payload length of 10485760 bytes
[32mINFO    [0m src.node.api_clients.base_client:custom_logger.py:10 Log line was discarded because it's longer than max_log_line_length=5000
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40411/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 05712dc517cd
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 491c83a466fc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:02:24.409+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:37866 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Invalid content body, could not decode. Unable to deserialize data"', 'ERR 2024-08-26 15:02:24.468+00:00 too large Waku message                     topics="waku relay" tid=1 file=protocol.nim:356 msg_hash=0x49d9116104bdb819815b66f4eda1a205d88d42519b15761e0283ee96b0630480 error="Message size exceeded maximum of 153600 bytes" messageSizeBytes=1048626 maxMessageSize=153600', 'DBG 2024-08-26 15:02:24.468+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:37868 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Failed to publish: Message size exceeded maximum of 153600 bytes"', 'ERR 2024-08-26 15:02:25.036+00:00 too large Waku message                     topics="waku relay" tid=1 file=protocol.nim:356 msg_hash=0x1aa5864623c4e5e8bd2124035caf1f74bf4d9bfd19c03a9358e5aed7f19142fa error="Message size exceeded maximum of 153600 bytes" messageSizeBytes=10485811 maxMessageSize=153600', 'DBG 2024-08-26 15:02:25.036+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:37876 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Failed to publish: Message size exceeded maximum of 153600 bytes"']
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_payload_equal_or_more_150_kb with id: 2024-08-26_15-02-29__9cd111e3-edf8-4302-b055-6834db6e2c98
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-02-29__9cd111e3-edf8-4302-b055-6834db6e2c98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.8.248
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['59391', '59392', '59393', '59394', '59395']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 59391:59391 -p 59392:59392 -p 59393:59393 -p 59394:59394 -p 59395:59395 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59393 --rest-port=59391 --tcp-port=59392 --discv5-udp-port=59394 --rest-address=0.0.0.0 --nat=extip:172.18.8.248 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a0a71604cfeb4d76d12df9abb46b1613c211f99952bd2fde6ddaa3d05585e5ca --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59395 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.8.248 waku d1e67a392ce4e86298a185bf2aec3caa4ecb71701390a474fa3f90f27faa1672
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID d1e67a392ce4. Setting up logs at ./log/docker/node1_2024-08-26_15-02-29__9cd111e3-edf8-4302-b055-6834db6e2c98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 59391
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59391/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59391/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.8.248/tcp/59392/p2p/16Uiu2HAmLfK6HxP8TNLHGZoxMCZofYcLzX1h749KWNDhpz26JheJ","/ip4/172.18.8.248/tcp/59393/ws/p2p/16Uiu2HAmLfK6HxP8TNLHGZoxMCZofYcLzX1h749KWNDhpz26JheJ"],"enrUri":"enr:-LO4QHIE-Xr6QEEyZpL6wmGJuImgEUyRckG8pF7g9pHYlhPmMuCcowz3dKGDFZbRA-zGpU8K6D1Wv_TaReTYoA5vPp0BgmlkgnY0gmlwhKwSCPiKbXVsdGlhZGRyc4wACgSsEgj4BugB3QOCcnOFAAMBAACJc2VjcDI1NmsxoQN28q-5MkSNKC-cO3s1B3CBUnkb9eFt70dC9SDYB93Xa4N0Y3CC6ACDdWRwgugChXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-02-29__9cd111e3-edf8-4302-b055-6834db6e2c98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.21.167
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['57988', '57989', '57990', '57991', '57992']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 57988:57988 -p 57989:57989 -p 57990:57990 -p 57991:57991 -p 57992:57992 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57990 --rest-port=57988 --tcp-port=57989 --discv5-udp-port=57991 --rest-address=0.0.0.0 --nat=extip:172.18.21.167 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8dadb736e44dd6ed8cca9a84f99e7d4d45e10de0ce765ae6bcfab4c04be9d356 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57992 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QHIE-Xr6QEEyZpL6wmGJuImgEUyRckG8pF7g9pHYlhPmMuCcowz3dKGDFZbRA-zGpU8K6D1Wv_TaReTYoA5vPp0BgmlkgnY0gmlwhKwSCPiKbXVsdGlhZGRyc4wACgSsEgj4BugB3QOCcnOFAAMBAACJc2VjcDI1NmsxoQN28q-5MkSNKC-cO3s1B3CBUnkb9eFt70dC9SDYB93Xa4N0Y3CC6ACDdWRwgugChXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.21.167 waku 17492b721abcc0a7f2ddc7e735a941bdc1c378d1b254d9db107fc9f66dcdee62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 17492b721abc. Setting up logs at ./log/docker/node2_2024-08-26_15-02-29__9cd111e3-edf8-4302-b055-6834db6e2c98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 57988
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57988/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57988/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.21.167/tcp/57989/p2p/16Uiu2HAmLiHzA46KZxPtNj1GPqrVcRQimJkBuWkgQqgZkHDVUrqb","/ip4/172.18.21.167/tcp/57990/ws/p2p/16Uiu2HAmLiHzA46KZxPtNj1GPqrVcRQimJkBuWkgQqgZkHDVUrqb"],"enrUri":"enr:-LO4QDp-rYssjzNd6KvCE5HCEbG06LQlK1DfwjfwqAHix-5xG7XxxmF7E3_rmB5S-6wz87P2ePl36_DDzMY3qNZdKVYBgmlkgnY0gmlwhKwSFaeKbXVsdGlhZGRyc4wACgSsEhWnBuKG3QOCcnOFAAMBAACJc2VjcDI1NmsxoQN3ti2zW85KtLzYAe3j9eaOaUBYRScjX-hmiYnOaZoH3oN0Y3CC4oWDdWRwguKHhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57988/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.8.248/tcp/59392/p2p/16Uiu2HAmLfK6HxP8TNLHGZoxMCZofYcLzX1h749KWNDhpz26JheJ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59391/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57988/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59391/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59391/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684552625909248,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57988/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684552625909248,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[35mDEBUG   [0m tests.relay.test_publish:test_publish.py:55 Running test with payload length of 204800 bytes
[32mINFO    [0m src.node.api_clients.base_client:custom_logger.py:10 Log line was discarded because it's longer than max_log_line_length=5000
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59391/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.relay.test_publish:test_publish.py:55 Running test with payload length of 1048576 bytes
[32mINFO    [0m src.node.api_clients.base_client:custom_logger.py:10 Log line was discarded because it's longer than max_log_line_length=5000
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59391/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
[35mDEBUG   [0m tests.relay.test_publish:test_publish.py:55 Running test with payload length of 10485760 bytes
[32mINFO    [0m src.node.api_clients.base_client:custom_logger.py:10 Log line was discarded because it's longer than max_log_line_length=5000
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59391/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d1e67a392ce4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 17492b721abc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:02:32.755+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:41868 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Invalid content body, could not decode. Unable to deserialize data"', 'ERR 2024-08-26 15:02:32.834+00:00 too large Waku message                     topics="waku relay" tid=1 file=protocol.nim:356 msg_hash=0x0c490e034bad7ef70a74386e8330e707c5ae0b8eced956a4cbf129a912aa07e4 error="Message size exceeded maximum of 153600 bytes" messageSizeBytes=1048626 maxMessageSize=153600', 'DBG 2024-08-26 15:02:32.834+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:35240 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Failed to publish: Message size exceeded maximum of 153600 bytes"', 'ERR 2024-08-26 15:02:33.433+00:00 too large Waku message                     topics="waku relay" tid=1 file=protocol.nim:356 msg_hash=0x8017bcdcc8eed9c1fe33535da250ad57ac69050f45cff41cfac82a62b64df739 error="Message size exceeded maximum of 153600 bytes" messageSizeBytes=10485811 maxMessageSize=153600', 'DBG 2024-08-26 15:02:33.433+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:35242 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Failed to publish: Message size exceeded maximum of 153600 bytes"']