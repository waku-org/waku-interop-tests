[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_works_with_auto_sharding with id: 2024-08-26_15-06-16__65ff744a-bde9-413a-b6ba-d970f82f387c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-06-16__65ff744a-bde9-413a-b6ba-d970f82f387c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.32.104
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['45879', '45880', '45881', '45882', '45883']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 45879:45879 -p 45880:45880 -p 45881:45881 -p 45882:45882 -p 45883:45883 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45881 --rest-port=45879 --tcp-port=45880 --discv5-udp-port=45882 --rest-address=0.0.0.0 --nat=extip:172.18.32.104 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e425eacbb0dea3d30f9a7c0fcc84b8dc41ef609c6442e060680f5780ee293ca5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45883 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.32.104 waku 19d3bb2639949eefdf2e008ee8f110d74a8e086948dec69d64def1c2532a0ed9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 19d3bb263994. Setting up logs at ./log/docker/node1_2024-08-26_15-06-16__65ff744a-bde9-413a-b6ba-d970f82f387c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 45879
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45879/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45879/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.32.104/tcp/45880/p2p/16Uiu2HAkukWVQEbpfbPwLRocFVq7r1DcSSrZ17keWyAUUGfzt4wc","/ip4/172.18.32.104/tcp/45881/ws/p2p/16Uiu2HAkukWVQEbpfbPwLRocFVq7r1DcSSrZ17keWyAUUGfzt4wc"],"enrUri":"enr:-LO4QKNUJfJkicJTenO5SCzl3KDFYWBWLP-W9W2tQFztcr-CcmLypiSEnsVkwI7tpfZ3u1l2SHw8qgz40OQf6TqedsMBgmlkgnY0gmlwhKwSIGiKbXVsdGlhZGRyc4wACgSsEiBoBrM53QOCcnOFAAIBAACJc2VjcDI1NmsxoQIE0043zezqwBfNw1YuUhrjW933oX4xTkL22kTQUkgeU4N0Y3CCsziDdWRwgrM6hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-06-16__65ff744a-bde9-413a-b6ba-d970f82f387c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.109.222
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['38768', '38769', '38770', '38771', '38772']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 38768:38768 -p 38769:38769 -p 38770:38770 -p 38771:38771 -p 38772:38772 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38770 --rest-port=38768 --tcp-port=38769 --discv5-udp-port=38771 --rest-address=0.0.0.0 --nat=extip:172.18.109.222 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bf7a665cdafd3dfdcc7bed1c7deb607eaee154fb7ae6e738dddd119799b4db77 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38772 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QKNUJfJkicJTenO5SCzl3KDFYWBWLP-W9W2tQFztcr-CcmLypiSEnsVkwI7tpfZ3u1l2SHw8qgz40OQf6TqedsMBgmlkgnY0gmlwhKwSIGiKbXVsdGlhZGRyc4wACgSsEiBoBrM53QOCcnOFAAIBAACJc2VjcDI1NmsxoQIE0043zezqwBfNw1YuUhrjW933oX4xTkL22kTQUkgeU4N0Y3CCsziDdWRwgrM6hXdha3UyBQ --filternode=/ip4/172.18.32.104/tcp/45880/p2p/16Uiu2HAkukWVQEbpfbPwLRocFVq7r1DcSSrZ17keWyAUUGfzt4wc --content-topic=/myapp/1/latest/proto --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.109.222 waku 99ba071e9e97211f0a78e341027a8c8c979f4e8c3f92e09b84679985e0f6aad4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 99ba071e9e97. Setting up logs at ./log/docker/node2_2024-08-26_15-06-16__65ff744a-bde9-413a-b6ba-d970f82f387c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 38768
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38768/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38768/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.109.222/tcp/38769/p2p/16Uiu2HAmDLrAkTCMT9P2eiYVqWov7YNU5yrNaiDhiMpJ7b3HDSFA","/ip4/172.18.109.222/tcp/38770/ws/p2p/16Uiu2HAmDLrAkTCMT9P2eiYVqWov7YNU5yrNaiDhiMpJ7b3HDSFA"],"enrUri":"enr:-LO4QAi2sTAnivDMusIZQqkcoRMXCmDPL_9LSq3DG1no_cEDTId9RjJaDCq2uqpr56XoEaUoJSFvlCF-x9Km_ppjlAwBgmlkgnY0gmlwhKwSbd6KbXVsdGlhZGRyc4wACgSsEm3eBpdy3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMKNfsz3MQUKQ5oWGJ60zbXDlhvV1o7dZamzYyd3txkWYN0Y3CCl3GDdWRwgpdzhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38768/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.32.104/tcp/45880/p2p/16Uiu2HAkukWVQEbpfbPwLRocFVq7r1DcSSrZ17keWyAUUGfzt4wc"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45879/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38768/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "4e3eca11-c625-4b0c-8b31-f01bfdca6f61", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"4e3eca11-c625-4b0c-8b31-f01bfdca6f61","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45879/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:186 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38768/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724684779840291584,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 19d3bb263994
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 99ba071e9e97
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.