[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_message_with_both_ephemeral_true_and_false with id: 2024-08-26_15-14-31__64241210-1ca7-483a-adbf-455ae62c9104
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-08-26_15-14-31__64241210-1ca7-483a-adbf-455ae62c9104__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.20.38
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['63908', '63909', '63910', '63911', '63912']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 63908:63908 -p 63909:63909 -p 63910:63910 -p 63911:63911 -p 63912:63912 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63910 --rest-port=63908 --tcp-port=63909 --discv5-udp-port=63911 --rest-address=0.0.0.0 --nat=extip:172.18.20.38 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2a04b71df12e8eeb4eaf9cd40f49361a4afac1abd6b84b36cb68563fd8f4dd58 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63912 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.20.38 waku e852893921adecb093ce091a63fc3e9a41cda0ae77d66b7bcba442c242ec500c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e852893921ad. Setting up logs at ./log/docker/publishing_node1_2024-08-26_15-14-31__64241210-1ca7-483a-adbf-455ae62c9104__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 63908
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63908/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63908/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.20.38/tcp/63909/p2p/16Uiu2HAm1tkhH7SwDbYPtp6mXK8pmjwvVNK8BwC8U7dQK6we5LWA","/ip4/172.18.20.38/tcp/63910/ws/p2p/16Uiu2HAm1tkhH7SwDbYPtp6mXK8pmjwvVNK8BwC8U7dQK6we5LWA"],"enrUri":"enr:-LO4QJPonkMWYp4zVFv4kIEGXhHCT1YDKnDxoaUIKey7XcffB-M6EZupF3QFDsPhFDueKg2ogfDzxB37kbeddi9d-JEBgmlkgnY0gmlwhKwSFCaKbXVsdGlhZGRyc4wACgSsEhQmBvmm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJgFiKNCehM5yHG8A8_fjyDa7-AwuC1i_QR3bJrlqd3N4N0Y3CC-aWDdWRwgvmnhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-08-26_15-14-31__64241210-1ca7-483a-adbf-455ae62c9104__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.138.42
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['27957', '27958', '27959', '27960', '27961']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 27957:27957 -p 27958:27958 -p 27959:27959 -p 27960:27960 -p 27961:27961 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27959 --rest-port=27957 --tcp-port=27958 --discv5-udp-port=27960 --rest-address=0.0.0.0 --nat=extip:172.18.138.42 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=10cc0cc867a40e4ba73670cbba3fe9cf5681d2b852a83deb5bdbd2ac3aa0a717 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27961 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QJPonkMWYp4zVFv4kIEGXhHCT1YDKnDxoaUIKey7XcffB-M6EZupF3QFDsPhFDueKg2ogfDzxB37kbeddi9d-JEBgmlkgnY0gmlwhKwSFCaKbXVsdGlhZGRyc4wACgSsEhQmBvmm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJgFiKNCehM5yHG8A8_fjyDa7-AwuC1i_QR3bJrlqd3N4N0Y3CC-aWDdWRwgvmnhXdha3UyAw --storenode=/ip4/172.18.20.38/tcp/63909/p2p/16Uiu2HAm1tkhH7SwDbYPtp6mXK8pmjwvVNK8BwC8U7dQK6we5LWA --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.138.42 waku c6da552128677f151a6d7c3326f5792d6530ee24d028a54cacf248953bbfeb77
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c6da55212867. Setting up logs at ./log/docker/store_node1_2024-08-26_15-14-31__64241210-1ca7-483a-adbf-455ae62c9104__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 27957
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27957/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27957/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.138.42/tcp/27958/p2p/16Uiu2HAkwm2CA1FNcucYESJNMRsmtn28QC4gVh3RuMHLBje7Fz7M","/ip4/172.18.138.42/tcp/27959/ws/p2p/16Uiu2HAkwm2CA1FNcucYESJNMRsmtn28QC4gVh3RuMHLBje7Fz7M"],"enrUri":"enr:-LO4QJjtzNwYxr17ef4TCMknlShLnpZD1kx_RZ42sV1efm9IJ2zBAEI8emrJ2yE1nUiZtsVsUUcm_Zo8GfKX4GW3jmkBgmlkgnY0gmlwhKwSiiqKbXVsdGlhZGRyc4wACgSsEooqBm033QOCcnOFAAMBAACJc2VjcDI1NmsxoQIirEOpaAavMNX2360D2wkwfdlEmyJk5_oREEyCNVSdpIN0Y3CCbTaDdWRwgm04hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27957/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.20.38/tcp/63909/p2p/16Uiu2HAm1tkhH7SwDbYPtp6mXK8pmjwvVNK8BwC8U7dQK6we5LWA"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63908/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27957/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63908/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63908/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63908/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"rKQQWVaKHFcwyQry5SJj0BGruahNmpDp5Z5kXQYSTF0="}]}'
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27957/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"rKQQWVaKHFcwyQry5SJj0BGruahNmpDp5Z5kXQYSTF0="}]}'
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63908/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63908/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63908/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"rKQQWVaKHFcwyQry5SJj0BGruahNmpDp5Z5kXQYSTF0="},{"messageHash":"odbTAj7q7tKuwRt03mQxApisCTk1+BlIRlo9lPi8UN8="}]}'
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27957/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"rKQQWVaKHFcwyQry5SJj0BGruahNmpDp5Z5kXQYSTF0="},{"messageHash":"odbTAj7q7tKuwRt03mQxApisCTk1+BlIRlo9lPi8UN8="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e852893921ad
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c6da55212867
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.