[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_extra_field with id: 2024-08-26_15-03-51__8fcac8df-4765-4189-8f07-03889715752d
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-03-51__8fcac8df-4765-4189-8f07-03889715752d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.42.38
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['31116', '31117', '31118', '31119', '31120']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 31116:31116 -p 31117:31117 -p 31118:31118 -p 31119:31119 -p 31120:31120 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31118 --rest-port=31116 --tcp-port=31117 --discv5-udp-port=31119 --rest-address=0.0.0.0 --nat=extip:172.18.42.38 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=95f8b6182e897acb144bc13b6a47e77be706bb8fec4856c8c15d8ac3b3e8297e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31120 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.42.38 waku e41eb3ed541a240a5dc22cb021b5ffe52b2117f6efe99fc0ec5707cb0bbdbca1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e41eb3ed541a. Setting up logs at ./log/docker/node1_2024-08-26_15-03-51__8fcac8df-4765-4189-8f07-03889715752d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 31116
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31116/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31116/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.42.38/tcp/31117/p2p/16Uiu2HAm5X2Qmu5cnDHcgKdvKT4G9GZPdJoxqqrZR9jamG11JcSj","/ip4/172.18.42.38/tcp/31118/ws/p2p/16Uiu2HAm5X2Qmu5cnDHcgKdvKT4G9GZPdJoxqqrZR9jamG11JcSj"],"enrUri":"enr:-LO4QPseh9vSzezFSNRTGXMV_xTXd5E7gI3Wq0uQzKEfyd9UeKMwALiDon8Cu8wMRYPF219oY_m66mzqirrfIJfh_CkBgmlkgnY0gmlwhKwSKiaKbXVsdGlhZGRyc4wACgSsEiomBnmO3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKV89_YEQBDEQw9-RQnRT2cKLlHG30duo3SX010S_Y_KIN0Y3CCeY2DdWRwgnmPhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-03-51__8fcac8df-4765-4189-8f07-03889715752d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.152.135
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['12095', '12096', '12097', '12098', '12099']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 12095:12095 -p 12096:12096 -p 12097:12097 -p 12098:12098 -p 12099:12099 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12097 --rest-port=12095 --tcp-port=12096 --discv5-udp-port=12098 --rest-address=0.0.0.0 --nat=extip:172.18.152.135 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ec63360bff65dfd3e5ecdb7fb32a4a3ddae60be4e3ed4941aebd48a1ff6ddffc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12099 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QPseh9vSzezFSNRTGXMV_xTXd5E7gI3Wq0uQzKEfyd9UeKMwALiDon8Cu8wMRYPF219oY_m66mzqirrfIJfh_CkBgmlkgnY0gmlwhKwSKiaKbXVsdGlhZGRyc4wACgSsEiomBnmO3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKV89_YEQBDEQw9-RQnRT2cKLlHG30duo3SX010S_Y_KIN0Y3CCeY2DdWRwgnmPhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.152.135 waku e05a340132ca5a824cfcc7977b5cd6bac5ca97d4e6274031cd73fbedad238fc2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e05a340132ca. Setting up logs at ./log/docker/node2_2024-08-26_15-03-51__8fcac8df-4765-4189-8f07-03889715752d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 12095
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12095/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12095/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.152.135/tcp/12096/p2p/16Uiu2HAmBJPLFxep4aKYY1XRfauCFXZ18MYmNfcCYJfJrJxMxcrp","/ip4/172.18.152.135/tcp/12097/ws/p2p/16Uiu2HAmBJPLFxep4aKYY1XRfauCFXZ18MYmNfcCYJfJrJxMxcrp"],"enrUri":"enr:-LO4QAyRrdzqYuoTCysiRcqYnB9KiQuBkyESHjL8nLHLbyLGaEpIjuhlhm01BWrfhg4to75SP3KOnKQYlYj67O6QtqgBgmlkgnY0gmlwhKwSmIeKbXVsdGlhZGRyc4wACgSsEpiHBi9B3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLr3RonbNTBjAyGXYu592hxJDItjVUFH7ZfqIp2N73mLYN0Y3CCL0CDdWRwgi9ChXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12095/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.42.38/tcp/31117/p2p/16Uiu2HAm5X2Qmu5cnDHcgKdvKT4G9GZPdJoxqqrZR9jamG11JcSj"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31116/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12095/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31116/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31116/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684634980856576,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12095/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684634980856576,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31116/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "extraField": "extraValue"}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:31116/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e41eb3ed541a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e05a340132ca
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:03:55.103+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:51488 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Invalid content body, could not decode. Unable to deserialize data"']
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_extra_field with id: 2024-08-26_15-04-00__b0826df2-ee14-4933-94c6-1847cfcc0a29
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-04-00__b0826df2-ee14-4933-94c6-1847cfcc0a29__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.39.118
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['7080', '7081', '7082', '7083', '7084']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 7080:7080 -p 7081:7081 -p 7082:7082 -p 7083:7083 -p 7084:7084 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7082 --rest-port=7080 --tcp-port=7081 --discv5-udp-port=7083 --rest-address=0.0.0.0 --nat=extip:172.18.39.118 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6af33a39d47eec20dcc00dbdcbfdcefda22ccbe48daa1e02faf8b13d2daceaec --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7084 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.39.118 waku 100c2c7154a4b9f0e40ffe1e4e880718997a5e798dea9bcfd18abee03b1979bd
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 100c2c7154a4. Setting up logs at ./log/docker/node1_2024-08-26_15-04-00__b0826df2-ee14-4933-94c6-1847cfcc0a29__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 7080
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7080/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7080/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.118/tcp/7081/p2p/16Uiu2HAmLdUUM3ytgorKrCVdPcoKmmYBsFWzje3yBZbzeEhMnyMg","/ip4/172.18.39.118/tcp/7082/ws/p2p/16Uiu2HAmLdUUM3ytgorKrCVdPcoKmmYBsFWzje3yBZbzeEhMnyMg"],"enrUri":"enr:-LO4QFzG5IN0CThgJ5xxvbsgAfBVa6yInUM1S2H4SNlXMO1kB1QBcRAG-9Mdo4F5kFITM2zlPGLIWnB399FrzSVLijwBgmlkgnY0gmlwhKwSJ3aKbXVsdGlhZGRyc4wACgSsEid2Bhuq3QOCcnOFAAMBAACJc2VjcDI1NmsxoQN2eiGNTGxvkWsZuWh8XAYYA-x_fVwY9YZygzWmRqd2l4N0Y3CCG6mDdWRwghurhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-04-00__b0826df2-ee14-4933-94c6-1847cfcc0a29__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.222.146
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['6977', '6978', '6979', '6980', '6981']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 6977:6977 -p 6978:6978 -p 6979:6979 -p 6980:6980 -p 6981:6981 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6979 --rest-port=6977 --tcp-port=6978 --discv5-udp-port=6980 --rest-address=0.0.0.0 --nat=extip:172.18.222.146 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f89b94fdc134ea6d575fb1cadc2ba9f3fa78f6cafb021de09f33ff9aa58d91ba --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6981 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QFzG5IN0CThgJ5xxvbsgAfBVa6yInUM1S2H4SNlXMO1kB1QBcRAG-9Mdo4F5kFITM2zlPGLIWnB399FrzSVLijwBgmlkgnY0gmlwhKwSJ3aKbXVsdGlhZGRyc4wACgSsEid2Bhuq3QOCcnOFAAMBAACJc2VjcDI1NmsxoQN2eiGNTGxvkWsZuWh8XAYYA-x_fVwY9YZygzWmRqd2l4N0Y3CCG6mDdWRwghurhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.222.146 waku 3bace0ddf67fe4567b8a27f66e89264263c360a7d94b6eae7b185ce7802b8841
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 3bace0ddf67f. Setting up logs at ./log/docker/node2_2024-08-26_15-04-00__b0826df2-ee14-4933-94c6-1847cfcc0a29__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 6977
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6977/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6977/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.222.146/tcp/6978/p2p/16Uiu2HAmBF1QE2VKm7rPBNoUrFK2og6mxw9v24pZf8gf1hWjVfqA","/ip4/172.18.222.146/tcp/6979/ws/p2p/16Uiu2HAmBF1QE2VKm7rPBNoUrFK2og6mxw9v24pZf8gf1hWjVfqA"],"enrUri":"enr:-LO4QACbICFc4-YUQdyv0nXg1mfEkalvniE99guhUy2pdSvWPYDG5Wgt6Xcg_WNAAVzT9wCSnGV36eJUUPd0jOnuEmYBgmlkgnY0gmlwhKwS3pKKbXVsdGlhZGRyc4wACgSsEt6SBhtD3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLq_4_ELCYgN7lHYGcGjCJ51CKKdxbaEzy413iOLEFUYYN0Y3CCG0KDdWRwghtEhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6977/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.118/tcp/7081/p2p/16Uiu2HAmLdUUM3ytgorKrCVdPcoKmmYBsFWzje3yBZbzeEhMnyMg"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7080/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6977/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7080/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7080/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684644124708864,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6977/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684644124708864,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7080/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "extraField": "extraValue"}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:7080/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 100c2c7154a4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3bace0ddf67f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:04:04.248+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:46346 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Invalid content body, could not decode. Unable to deserialize data"']
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_extra_field with id: 2024-08-26_15-04-10__5c30c5fa-c21a-4ed6-aa9a-578f72554aaa
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_15-04-10__5c30c5fa-c21a-4ed6-aa9a-578f72554aaa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.131.36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['32345', '32346', '32347', '32348', '32349']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 32345:32345 -p 32346:32346 -p 32347:32347 -p 32348:32348 -p 32349:32349 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32347 --rest-port=32345 --tcp-port=32346 --discv5-udp-port=32348 --rest-address=0.0.0.0 --nat=extip:172.18.131.36 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bea2d8213dcf7afde3ed2ff63535bfa03b1d56d4c32dc46a49d0e3a461cf542c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32349 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.131.36 waku 7f37616664f04e9cd749830175b1ab176b3bc340aa20a0b417b1090507ab3612
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7f37616664f0. Setting up logs at ./log/docker/node1_2024-08-26_15-04-10__5c30c5fa-c21a-4ed6-aa9a-578f72554aaa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 32345
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32345/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32345/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.131.36/tcp/32346/p2p/16Uiu2HAmRAmddTgHzUtyAxiw5avc4wvf2owZ3xr9cpBWJMNcfBa5","/ip4/172.18.131.36/tcp/32347/ws/p2p/16Uiu2HAmRAmddTgHzUtyAxiw5avc4wvf2owZ3xr9cpBWJMNcfBa5"],"enrUri":"enr:-LO4QGAyJZ-qZAngfGluAnOVtt4KlTj_5ZPOivTILIWn6a3kKgJyauUt9g1t_ezbRgoqdPPFE17964YrAFOnCzRiD5sBgmlkgnY0gmlwhKwSgySKbXVsdGlhZGRyc4wACgSsEoMkBn5b3QOCcnOFAAMBAACJc2VjcDI1NmsxoQO57UlqYlxLdhr2RcNFsQfXeNQcMEs6lUROTNs7AU6ApoN0Y3CCflqDdWRwgn5chXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_15-04-10__5c30c5fa-c21a-4ed6-aa9a-578f72554aaa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.156.112
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['37489', '37490', '37491', '37492', '37493']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 37489:37489 -p 37490:37490 -p 37491:37491 -p 37492:37492 -p 37493:37493 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37491 --rest-port=37489 --tcp-port=37490 --discv5-udp-port=37492 --rest-address=0.0.0.0 --nat=extip:172.18.156.112 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=edaa39385f5cd0f2cefa45159e7311220ce6b5ac5aa8cfd8fddd10bccddd3eb9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37493 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QGAyJZ-qZAngfGluAnOVtt4KlTj_5ZPOivTILIWn6a3kKgJyauUt9g1t_ezbRgoqdPPFE17964YrAFOnCzRiD5sBgmlkgnY0gmlwhKwSgySKbXVsdGlhZGRyc4wACgSsEoMkBn5b3QOCcnOFAAMBAACJc2VjcDI1NmsxoQO57UlqYlxLdhr2RcNFsQfXeNQcMEs6lUROTNs7AU6ApoN0Y3CCflqDdWRwgn5chXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.156.112 waku 271728a99a6bc2aa505abda6870f46f7a3ab8bca2b35f7548a88ae1a27f725a8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 271728a99a6b. Setting up logs at ./log/docker/node2_2024-08-26_15-04-10__5c30c5fa-c21a-4ed6-aa9a-578f72554aaa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 37489
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37489/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37489/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.156.112/tcp/37490/p2p/16Uiu2HAmLGQ6bpF26LX9w2Gex2MGe198eXTXbaW8jwuJ2oxLN1uX","/ip4/172.18.156.112/tcp/37491/ws/p2p/16Uiu2HAmLGQ6bpF26LX9w2Gex2MGe198eXTXbaW8jwuJ2oxLN1uX"],"enrUri":"enr:-LO4QDdYJPMyC2FMEbedg8JOpqtm51jRzlLtx_yJkfBtoSsuBUYPuOoKd4W11AbiDHUZMHl9NU181GdesOeDhu5QcIsBgmlkgnY0gmlwhKwSnHCKbXVsdGlhZGRyc4wACgSsEpxwBpJz3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNxE_zByFNdUC-a2j0gzdWqchAlLbQKCgVcdYqkV1PpvoN0Y3CCknKDdWRwgpJ0hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37489/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.131.36/tcp/32346/p2p/16Uiu2HAmRAmddTgHzUtyAxiw5avc4wvf2owZ3xr9cpBWJMNcfBa5"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32345/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37489/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32345/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32345/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684654330334976,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37489/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724684654330334976,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32345/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "extraField": "extraValue"}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:32345/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7f37616664f0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 271728a99a6b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'error': ['DBG 2024-08-26 15:04:14.471+00:00 Received error response from handler       tid=1 file=serverprivate.nim:314 status=400 meth=POST peer=172.17.0.1:53112 uri=/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1 error_status="400 Bad Request" error_content_type=text/plain error_message="Invalid content body, could not decode. Unable to deserialize data"']