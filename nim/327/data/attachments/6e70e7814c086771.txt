[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-08-22_04-21-09__ac2b7ccf-5a7c-4d96-83a9-07581269030b
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-22_04-21-09__ac2b7ccf-5a7c-4d96-83a9-07581269030b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.57.0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['24314', '24315', '24316', '24317', '24318']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 24314:24314 -p 24315:24315 -p 24316:24316 -p 24317:24317 -p 24318:24318 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24316 --rest-port=24314 --tcp-port=24315 --discv5-udp-port=24317 --rest-address=0.0.0.0 --nat=extip:172.18.57.0 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ef0ffbcbd9a2b1b7d5c9f7effcefbc4ab38a1fd60bad6382b3a13dfa59b8188a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24318 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.57.0 waku 3424b6c46573ed958993ae2877232544b87ae0730a46713aba9a6ff95bcfc87b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 3424b6c46573. Setting up logs at ./log/docker/receiving_node1_2024-08-22_04-21-09__ac2b7ccf-5a7c-4d96-83a9-07581269030b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 24314
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24314/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24314/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.57.0/tcp/24315/p2p/16Uiu2HAmM1NsRFSkcwrsMaCeq8MghLyk5jkbTpk1jjGAvcXRrsNx","/ip4/172.18.57.0/tcp/24316/ws/p2p/16Uiu2HAmM1NsRFSkcwrsMaCeq8MghLyk5jkbTpk1jjGAvcXRrsNx"],"enrUri":"enr:-LO4QKuIDT-l58JpHNwoWk9fAyP1IDHq-ZQqKA1hntVGZtrLdOOtl8CQbUFusC-67gOkO2ofUf2o31XWQnYDMDDIwyoBgmlkgnY0gmlwhKwSOQCKbXVsdGlhZGRyc4wACgSsEjkABl783QOCcnOFAAMBAACJc2VjcDI1NmsxoQN8FpMOFglXQAkvPZO5jlKPU7UVdW5DYSHceDSyx8RoKYN0Y3CCXvuDdWRwgl79hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-08-22_04-21-09__ac2b7ccf-5a7c-4d96-83a9-07581269030b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.234.150
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['49494', '49495', '49496', '49497', '49498']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 49494:49494 -p 49495:49495 -p 49496:49496 -p 49497:49497 -p 49498:49498 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49496 --rest-port=49494 --tcp-port=49495 --discv5-udp-port=49497 --rest-address=0.0.0.0 --nat=extip:172.18.234.150 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=95b8c08d7a24b1e47235deccafe5d6d975c8cda07fda41b356eb662ace7c8ecc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49498 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.234.150 waku 802ea2b4a52df7deec8b320f18d85aa6c5a729345167ad11c6a2f538199a49b9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 802ea2b4a52d. Setting up logs at ./log/docker/receiving_node2_2024-08-22_04-21-09__ac2b7ccf-5a7c-4d96-83a9-07581269030b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 49494
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49494/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49494/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.234.150/tcp/49495/p2p/16Uiu2HAmP8hA6yqYYcuvSfGAmFrQcucLSt6Txw7wMooDrctU2NiZ","/ip4/172.18.234.150/tcp/49496/ws/p2p/16Uiu2HAmP8hA6yqYYcuvSfGAmFrQcucLSt6Txw7wMooDrctU2NiZ"],"enrUri":"enr:-LO4QEfVE21JJSR8WT1zwD6mPaZA42oVufeDVFWu_l7MF5QlCWEOWUcyF1Ja4o2QvziLbYFMv9Mz3nHfs7Wj72BDti8BgmlkgnY0gmlwhKwS6paKbXVsdGlhZGRyc4wACgSsEuqWBsFY3QOCcnOFAAMBAACJc2VjcDI1NmsxoQObrbEfh2tzSWaFsE9Ybp_Eid7hwgMulI3lyFYwnXAUVoN0Y3CCwVeDdWRwgsFZhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49494/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.57.0/tcp/24315/p2p/16Uiu2HAmM1NsRFSkcwrsMaCeq8MghLyk5jkbTpk1jjGAvcXRrsNx"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-22_04-21-09__ac2b7ccf-5a7c-4d96-83a9-07581269030b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.34.182
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['43218', '43219', '43220', '43221', '43222']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 43218:43218 -p 43219:43219 -p 43220:43220 -p 43221:43221 -p 43222:43222 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43220 --rest-port=43218 --tcp-port=43219 --discv5-udp-port=43221 --rest-address=0.0.0.0 --nat=extip:172.18.34.182 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=85d2ee6f3c67b3483fbfdbc6bf8c6b7c0dc2333ffd7c3e7da8d75651d8eebe0d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43222 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QKuIDT-l58JpHNwoWk9fAyP1IDHq-ZQqKA1hntVGZtrLdOOtl8CQbUFusC-67gOkO2ofUf2o31XWQnYDMDDIwyoBgmlkgnY0gmlwhKwSOQCKbXVsdGlhZGRyc4wACgSsEjkABl783QOCcnOFAAMBAACJc2VjcDI1NmsxoQN8FpMOFglXQAkvPZO5jlKPU7UVdW5DYSHceDSyx8RoKYN0Y3CCXvuDdWRwgl79hXdha3UyCQ --lightpushnode=/ip4/172.18.57.0/tcp/24315/p2p/16Uiu2HAmM1NsRFSkcwrsMaCeq8MghLyk5jkbTpk1jjGAvcXRrsNx --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.34.182 waku cc3f1ab56f178b90b31851f16ae021841f4f374c622be110be500ea34fae20c1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID cc3f1ab56f17. Setting up logs at ./log/docker/lightpush_node1_2024-08-22_04-21-09__ac2b7ccf-5a7c-4d96-83a9-07581269030b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 43218
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43218/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43218/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.34.182/tcp/43219/p2p/16Uiu2HAm8Rww9CDawLUr9veQDLEs2zvWa6hF9irsWoxMjTvXXgn9","/ip4/172.18.34.182/tcp/43220/ws/p2p/16Uiu2HAm8Rww9CDawLUr9veQDLEs2zvWa6hF9irsWoxMjTvXXgn9"],"enrUri":"enr:-LO4QENdRoESesRsLWTc9o4H_6fEJiQ5VYwlTrP1GCpq1gZsKaWIIx-PLN0JUz0cIoy4bJGXDMKmZnhMp8r34Lirh7YBgmlkgnY0gmlwhKwSIraKbXVsdGlhZGRyc4wACgSsEiK2BqjU3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLBOfg4aittB7BonpEYn54n2aADxf5LR9uNWVjPeMpi5oN0Y3CCqNODdWRwgqjVhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43218/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.57.0/tcp/24315/p2p/16Uiu2HAmM1NsRFSkcwrsMaCeq8MghLyk5jkbTpk1jjGAvcXRrsNx"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43218/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.234.150/tcp/49495/p2p/16Uiu2HAmP8hA6yqYYcuvSfGAmFrQcucLSt6Txw7wMooDrctU2NiZ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:24314/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49494/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43218/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724300475187811328, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24314/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724300475187811328,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49494/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724300475187811328,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43218/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724300475320306944, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24314/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724300475320306944,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49494/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724300475320306944,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 3424b6c46573
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 802ea2b4a52d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id cc3f1ab56f17
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.