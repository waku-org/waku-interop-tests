[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_message_with_both_ephemeral_true_and_false with id: 2024-08-22_04-31-44__8afbe268-2f25-47ba-b23f-c012675dea24
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-08-22_04-31-44__8afbe268-2f25-47ba-b23f-c012675dea24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.84.254
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['48451', '48452', '48453', '48454', '48455']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 48451:48451 -p 48452:48452 -p 48453:48453 -p 48454:48454 -p 48455:48455 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48453 --rest-port=48451 --tcp-port=48452 --discv5-udp-port=48454 --rest-address=0.0.0.0 --nat=extip:172.18.84.254 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c1e5cd062bb882e2eb63b741af19fdd6b8f2c782270e42cb1d200a01ed7ab200 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48455 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.84.254 waku 9d6ed4cc518be314e0d202c6d5848d43509bbb05a8c064dad7aa9a929acb1e36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 9d6ed4cc518b. Setting up logs at ./log/docker/publishing_node1_2024-08-22_04-31-44__8afbe268-2f25-47ba-b23f-c012675dea24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 48451
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48451/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48451/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.84.254/tcp/48452/p2p/16Uiu2HAkvkmsfmJs8j5FNxcevS58x76Ns6fcnoaPfRt8xYSw9QKu","/ip4/172.18.84.254/tcp/48453/ws/p2p/16Uiu2HAkvkmsfmJs8j5FNxcevS58x76Ns6fcnoaPfRt8xYSw9QKu"],"enrUri":"enr:-LO4QBdF-WRJ1RSRQkw4qdkHtB-k8h337QdltjnK7WqyWsO3XnqmbwwPDwvklMzJUqS2cODCpjwEba14JMhZfTZouhQBgmlkgnY0gmlwhKwSVP6KbXVsdGlhZGRyc4wACgSsElT-Br1F3QOCcnOFAAMBAACJc2VjcDI1NmsxoQITwGMavPok9V13mXeMqLauwJUgCTGpofG7sbXuPU8KBIN0Y3CCvUSDdWRwgr1GhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/store_node1_2024-08-22_04-31-44__8afbe268-2f25-47ba-b23f-c012675dea24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.177.141
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['28089', '28090', '28091', '28092', '28093']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 28089:28089 -p 28090:28090 -p 28091:28091 -p 28092:28092 -p 28093:28093 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=28091 --rest-port=28089 --tcp-port=28090 --discv5-udp-port=28092 --rest-address=0.0.0.0 --nat=extip:172.18.177.141 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3a7faa7e7cedaea2b9fbe8fa55aa0d7a9db82bdceabda3b3fd8f32cbf7b37e5a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=28093 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QBdF-WRJ1RSRQkw4qdkHtB-k8h337QdltjnK7WqyWsO3XnqmbwwPDwvklMzJUqS2cODCpjwEba14JMhZfTZouhQBgmlkgnY0gmlwhKwSVP6KbXVsdGlhZGRyc4wACgSsElT-Br1F3QOCcnOFAAMBAACJc2VjcDI1NmsxoQITwGMavPok9V13mXeMqLauwJUgCTGpofG7sbXuPU8KBIN0Y3CCvUSDdWRwgr1GhXdha3UyAw --storenode=/ip4/172.18.84.254/tcp/48452/p2p/16Uiu2HAkvkmsfmJs8j5FNxcevS58x76Ns6fcnoaPfRt8xYSw9QKu --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.177.141 waku 692815109b0f4f2236d87990d05704185a88009fa384edf17f7c66cf074b95cf
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 692815109b0f. Setting up logs at ./log/docker/store_node1_2024-08-22_04-31-44__8afbe268-2f25-47ba-b23f-c012675dea24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 28089
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:28089/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:28089/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.141/tcp/28090/p2p/16Uiu2HAkvrwxF8o2wP7eUCGQTqnowvLr6eFBvwb4211qqC95DyL9","/ip4/172.18.177.141/tcp/28091/ws/p2p/16Uiu2HAkvrwxF8o2wP7eUCGQTqnowvLr6eFBvwb4211qqC95DyL9"],"enrUri":"enr:-LO4QAkVz8Y5qt1gI-ylc-7SxS1ed617MdW5PVZW7RghqXNEeQuXVSDbdOqRtKxkpnT0iw_tuKAJR-bZr-_7BotMuikBgmlkgnY0gmlwhKwSsY2KbXVsdGlhZGRyc4wACgSsErGNBm273QOCcnOFAAMBAACJc2VjcDI1NmsxoQIVVUSpn1LuB0B-0MkH-g-wkad3c0rJp7wZ-tLPPAhkFoN0Y3CCbbqDdWRwgm28hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:28089/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.84.254/tcp/48452/p2p/16Uiu2HAkvkmsfmJs8j5FNxcevS58x76Ns6fcnoaPfRt8xYSw9QKu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48451/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:28089/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48451/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48451/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48451/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"2zSl6P2GOr7J4ze7z1lYf7O+P0PcllxR57Js4aFvkVc="}]}'
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:28089/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"2zSl6P2GOr7J4ze7z1lYf7O+P0PcllxR57Js4aFvkVc="}]}'
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48451/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48451/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48451/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"2zSl6P2GOr7J4ze7z1lYf7O+P0PcllxR57Js4aFvkVc="},{"messageHash":"pLxL+J6C8h2e97knnGtsJ2x8uMAtnK0X6sBulewfXIU="}]}'
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:28089/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"2zSl6P2GOr7J4ze7z1lYf7O+P0PcllxR57Js4aFvkVc="},{"messageHash":"pLxL+J6C8h2e97knnGtsJ2x8uMAtnK0X6sBulewfXIU="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 9d6ed4cc518b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 692815109b0f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.