[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_same_shard with id: 2024-11-21_04-25-53__2acbd7d2-29ca-4096-b1fd-9dc59e0e18bd
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-21_04-25-53__2acbd7d2-29ca-4096-b1fd-9dc59e0e18bd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.169.249
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['25951', '25952', '25953', '25954', '25955']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 25951:25951 -p 25952:25952 -p 25953:25953 -p 25954:25954 -p 25955:25955 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25953 --rest-port=25951 --tcp-port=25952 --discv5-udp-port=25954 --rest-address=0.0.0.0 --nat=extip:172.18.169.249 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=c0d4de52c765ef9bee20bf85b6e0f3e8d6dccc71be4b1e029c2eebd5dacbd41d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25955 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.169.249 waku fc37447be1b9dca9951f77d7fe0c5611ac316fa38a17d868944ea61058dc6961
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d2b4070a1c1a. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID fc37447be1b9. Setting up logs at ./log/docker/node1_2024-11-21_04-25-53__2acbd7d2-29ca-4096-b1fd-9dc59e0e18bd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 25951
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25951/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25951/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.169.249/tcp/25952/p2p/16Uiu2HAkxxC1saFM6AxxCJVMzC8wn7DC9nK39r87iqJXwBqxrQdW","/ip4/172.18.169.249/tcp/25953/ws/p2p/16Uiu2HAkxxC1saFM6AxxCJVMzC8wn7DC9nK39r87iqJXwBqxrQdW"],"enrUri":"enr:-L24QKzF6EJQwdi1kK8I2R1E6ioMNvPHNIzMU-RJb_pU0ZSkSybBEw8mR7RZetEeR6_u8lu1fVfuY9WtSrEL4jzDRYgCgmlkgnY0gmlwhKwSqfmKbXVsdGlhZGRyc5YACASsEqn5BmVgAAoErBKp-QZlYd0DgnJzhQACAQAAiXNlY3AyNTZrMaECNGRyWo2cJ6KTQjtPc_9m716Q9MKZSblHzIJAj8SM6hmDdGNwgmVgg3VkcIJlYoV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-21_04-25-53__2acbd7d2-29ca-4096-b1fd-9dc59e0e18bd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.149.73
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['48325', '48326', '48327', '48328', '48329']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 48325:48325 -p 48326:48326 -p 48327:48327 -p 48328:48328 -p 48329:48329 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48327 --rest-port=48325 --tcp-port=48326 --discv5-udp-port=48328 --rest-address=0.0.0.0 --nat=extip:172.18.149.73 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=dcd90ae3c83dfa37e21bebc26ca69c90b586a43eba1dbc6d4bf2944fdfc15da3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48329 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QKzF6EJQwdi1kK8I2R1E6ioMNvPHNIzMU-RJb_pU0ZSkSybBEw8mR7RZetEeR6_u8lu1fVfuY9WtSrEL4jzDRYgCgmlkgnY0gmlwhKwSqfmKbXVsdGlhZGRyc5YACASsEqn5BmVgAAoErBKp-QZlYd0DgnJzhQACAQAAiXNlY3AyNTZrMaECNGRyWo2cJ6KTQjtPc_9m716Q9MKZSblHzIJAj8SM6hmDdGNwgmVgg3VkcIJlYoV3YWt1MgU --pubsub-topic=/waku/2/rs/4/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.149.73 waku bfdb71deec363b6418bbd6b29dbcd5e135949534e0fe3e635acf98e76f05bebc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID bfdb71deec36. Setting up logs at ./log/docker/node2_2024-11-21_04-25-53__2acbd7d2-29ca-4096-b1fd-9dc59e0e18bd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 48325
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48325/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48325/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.149.73/tcp/48326/p2p/16Uiu2HAmShgy83xPZCsbB6eA3sAtni45599Kx66Pu9cRFwnuey94","/ip4/172.18.149.73/tcp/48327/ws/p2p/16Uiu2HAmShgy83xPZCsbB6eA3sAtni45599Kx66Pu9cRFwnuey94"],"enrUri":"enr:-L24QPI6QnQkDzvYCJBoP62Cj9xMCks3DhMRz0mNhvXAsOdAZ40VxSA0pUqV3ZJgwjc21WPZwdIx-grMIVAcUwsWg2kCgmlkgnY0gmlwhKwSlUmKbXVsdGlhZGRyc5YACASsEpVJBrzGAAoErBKVSQa8x90DgnJzhQAEAQAAiXNlY3AyNTZrMaED0LS0jV2xbvhRNEFdsQhmFLsURpy1Ip36t_ttFGJdSFuDdGNwgrzGg3VkcIK8yIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48325/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.169.249/tcp/25952/p2p/16Uiu2HAkxxC1saFM6AxxCJVMzC8wn7DC9nK39r87iqJXwBqxrQdW"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25951/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48325/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25951/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25951/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1732163157579440128,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:48325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id fc37447be1b9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id bfdb71deec36
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container fc37447be1b9. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.