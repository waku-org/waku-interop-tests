[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_unsubscribe_from_single_content_topic with id: 2024-10-28_04-07-09__80802f50-7185-4cc1-ba69-0f53b9c4558c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-28_04-07-09__80802f50-7185-4cc1-ba69-0f53b9c4558c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.214.47
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['31739', '31740', '31741', '31742', '31743']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 31739:31739 -p 31740:31740 -p 31741:31741 -p 31742:31742 -p 31743:31743 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31741 --rest-port=31739 --tcp-port=31740 --discv5-udp-port=31742 --rest-address=0.0.0.0 --nat=extip:172.18.214.47 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3d2cc8d4335577d1aafa2e2cc4a94eb7adcdc9cbfabeff87f48f6db04df226a7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31743 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.214.47 waku 6bcb84452dff182f8cac1cef857da2795e183d0dc66825a45d2f8dd693f888e3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 6bcb84452dff. Setting up logs at ./log/docker/node1_2024-10-28_04-07-09__80802f50-7185-4cc1-ba69-0f53b9c4558c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 31739
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 99ee458bcdd2. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31739/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31739/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.47/tcp/31740/p2p/16Uiu2HAmSEfGY9L14GnZwBDqEmXPLKwFiorTFSNLMZqt5VaUX9b1","/ip4/172.18.214.47/tcp/31741/ws/p2p/16Uiu2HAmSEfGY9L14GnZwBDqEmXPLKwFiorTFSNLMZqt5VaUX9b1"],"enrUri":"enr:-LO4QGtWkqaoR4U6gPd7OVLa6lM0C1QWHkF4myJQ-Fo6QkYbEwdLD_8bnsG0aYMpYw8GkPljh_J_LvrNQPIUyP9qCr4BgmlkgnY0gmlwhKwS1i-KbXVsdGlhZGRyc4wACgSsEtYvBnv93QOCcnOFAAMBAACJc2VjcDI1NmsxoQPJyBn-lnKz4XVY1I9lVEk0-CXG32doyGC_5tjcVmTn1IN0Y3CCe_yDdWRwgnv-hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-28_04-07-09__80802f50-7185-4cc1-ba69-0f53b9c4558c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.49.160
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['12075', '12076', '12077', '12078', '12079']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 12075:12075 -p 12076:12076 -p 12077:12077 -p 12078:12078 -p 12079:12079 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12077 --rest-port=12075 --tcp-port=12076 --discv5-udp-port=12078 --rest-address=0.0.0.0 --nat=extip:172.18.49.160 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ccaedbbbcfc62ab38bea4df887497acdf341b8b7eca095d67aba7511cc9f035f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12079 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QGtWkqaoR4U6gPd7OVLa6lM0C1QWHkF4myJQ-Fo6QkYbEwdLD_8bnsG0aYMpYw8GkPljh_J_LvrNQPIUyP9qCr4BgmlkgnY0gmlwhKwS1i-KbXVsdGlhZGRyc4wACgSsEtYvBnv93QOCcnOFAAMBAACJc2VjcDI1NmsxoQPJyBn-lnKz4XVY1I9lVEk0-CXG32doyGC_5tjcVmTn1IN0Y3CCe_yDdWRwgnv-hXdha3UyBQ --filternode=/ip4/172.18.214.47/tcp/31740/p2p/16Uiu2HAmSEfGY9L14GnZwBDqEmXPLKwFiorTFSNLMZqt5VaUX9b1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.49.160 waku d77066d253cd16b7c819239859756c815eed084f4720aa5a84052826370780ef
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d77066d253cd. Setting up logs at ./log/docker/node2_2024-10-28_04-07-09__80802f50-7185-4cc1-ba69-0f53b9c4558c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 12075
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12075/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12075/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.49.160/tcp/12076/p2p/16Uiu2HAmH2R9mxppKJQ1FWnXFukFbY1ScJovUsob13XHy9a1zZJM","/ip4/172.18.49.160/tcp/12077/ws/p2p/16Uiu2HAmH2R9mxppKJQ1FWnXFukFbY1ScJovUsob13XHy9a1zZJM"],"enrUri":"enr:-LO4QEphfgY9jFxP9vVFxW8sAXttPpEDsUQpuWyr7z_LM1o0dKYKYEwBGk34R6O-PQWe7HaFojmFMJrn5UpKwTSvAdkBgmlkgnY0gmlwhKwSMaCKbXVsdGlhZGRyc4wACgSsEjGgBi8t3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNA6_ziGQpSsf0-q0SYJ8L5RloT1pwCj9EGtF2QYENG9oN0Y3CCLyyDdWRwgi8uhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12075/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.214.47/tcp/31740/p2p/16Uiu2HAmSEfGY9L14GnZwBDqEmXPLKwFiorTFSNLMZqt5VaUX9b1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31739/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12075/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "7c79faf2-f437-43ca-ad6c-f9809dab3e99", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"7c79faf2-f437-43ca-ad6c-f9809dab3e99","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31739/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12075/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1730088432973179392,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X DELETE "http://127.0.0.1:12075/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31739/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12075/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:12075/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 6bcb84452dff
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d77066d253cd
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 6bcb84452dff. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.