[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_add_a_new_content_topic with id: 2024-11-06_23-45-35__ce6d8e34-f76e-43a4-8486-abf00d48f230
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-06_23-45-35__ce6d8e34-f76e-43a4-8486-abf00d48f230__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.166.18
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['47537', '47538', '47539', '47540', '47541']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 47537:47537 -p 47538:47538 -p 47539:47539 -p 47540:47540 -p 47541:47541 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47539 --rest-port=47537 --tcp-port=47538 --discv5-udp-port=47540 --rest-address=0.0.0.0 --nat=extip:172.18.166.18 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=43a56737f3eb4c89be7a1825c6ebc8c65b58be0bdc6fc791c1c2bc6afaaaa65f --max-connections=1000 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47541 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.166.18 waku 80a448b07193adcca9e83201dc78bc2548408187c3d672a59ed748c350b5e53c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 80a448b07193. Setting up logs at ./log/docker/node1_2024-11-06_23-45-35__ce6d8e34-f76e-43a4-8486-abf00d48f230__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/nwaku:latest. REST: 47537
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d2b40161d73d. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47537/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:278 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47537/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.166.18/tcp/47538/p2p/16Uiu2HAmFCu7VCtrte8zrPQSZQxWJYudi3JkJBvgdoz6KtwwN2Ar","/ip4/172.18.166.18/tcp/47539/ws/p2p/16Uiu2HAmFCu7VCtrte8zrPQSZQxWJYudi3JkJBvgdoz6KtwwN2Ar"],"enrUri":"enr:-L24QIePJfIzZPns6kBTr0SjFqrD3kxV0MP0-y8-VeQfysopWWJTKtme140jQ8Mu721M5EtNi0Fg6sYHBjlMvRFb31ACgmlkgnY0gmlwhKwSphKKbXVsdGlhZGRyc5YACASsEqYSBrmyAAoErBKmEga5s90DgnJzhQADAQAAiXNlY3AyNTZrMaEDJeQJgh47vcUavCCWjIjI-QruZ5brpsSZHngZ5hHG-IeDdGNwgrmyg3VkcIK5tIV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-06_23-45-35__ce6d8e34-f76e-43a4-8486-abf00d48f230__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.255.93
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['37526', '37527', '37528', '37529', '37530']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 37526:37526 -p 37527:37527 -p 37528:37528 -p 37529:37529 -p 37530:37530 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37528 --rest-port=37526 --tcp-port=37527 --discv5-udp-port=37529 --rest-address=0.0.0.0 --nat=extip:172.18.255.93 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ee2dbac230e202e8932ce5fb9fd0e682e4bb5a4e3ac534e62ce7047bed9e3c3a --max-connections=1000 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37530 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QIePJfIzZPns6kBTr0SjFqrD3kxV0MP0-y8-VeQfysopWWJTKtme140jQ8Mu721M5EtNi0Fg6sYHBjlMvRFb31ACgmlkgnY0gmlwhKwSphKKbXVsdGlhZGRyc5YACASsEqYSBrmyAAoErBKmEga5s90DgnJzhQADAQAAiXNlY3AyNTZrMaEDJeQJgh47vcUavCCWjIjI-QruZ5brpsSZHngZ5hHG-IeDdGNwgrmyg3VkcIK5tIV3YWt1MgU --filternode=/ip4/172.18.166.18/tcp/47538/p2p/16Uiu2HAmFCu7VCtrte8zrPQSZQxWJYudi3JkJBvgdoz6KtwwN2Ar
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.255.93 waku 2502995f01d573496dfe54f050ad466cc6308caab7fdc46f8e691875ac14d0f1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2502995f01d5. Setting up logs at ./log/docker/node2_2024-11-06_23-45-35__ce6d8e34-f76e-43a4-8486-abf00d48f230__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/nwaku:latest. REST: 37526
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37526/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:278 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37526/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.255.93/tcp/37527/p2p/16Uiu2HAmVjirTjSe34i2dB5L9zQ9Uvos842oi8uhK8bz7sku7VhQ","/ip4/172.18.255.93/tcp/37528/ws/p2p/16Uiu2HAmVjirTjSe34i2dB5L9zQ9Uvos842oi8uhK8bz7sku7VhQ"],"enrUri":"enr:-L24QLqKgddbRxIN3poZurO2HDAFRiEun-HffHD6ALIyB9sTZ0rRNAs7S0JzSgqzorpALU7Kg6_XotFYll2vn18G2t4CgmlkgnY0gmlwhKwS_12KbXVsdGlhZGRyc5YACASsEv9dBpKXAAoErBL_XQaSmN0DgnJzhQADAQAAiXNlY3AyNTZrMaED_c0PKi3dH67HdB21cIPaXG8fk9IradOz2Leo7o11j6eDdGNwgpKXg3VkcIKSmYV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37526/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.166.18/tcp/47538/p2p/16Uiu2HAmFCu7VCtrte8zrPQSZQxWJYudi3JkJBvgdoz6KtwwN2Ar"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47537/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37526/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "6c7bad55-34df-427e-ac80-514a0703cde3", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"6c7bad55-34df-427e-ac80-514a0703cde3","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:37526/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47537/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37526/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1730936738865818112,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47537/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37526/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1730936738977941504,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 80a448b07193
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 2502995f01d5
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 80a448b07193. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.