[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_valid_payloads_lightpush_at_spam_rate with id: 2024-08-27_04-14-05__59e12ca4-846d-436e-8148-cfde5ac88406
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.rln:rln.py:130 Registering RLN credentials for single node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node_2024-08-27_04-14-05__cb90198f-c39b-49b4-9e25-a9fc50236821__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:187 Registering RLN credentials...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:31 Network waku created
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.21.195
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['55162', '55163', '55164', '55165', '55166']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 55162:55162 -p 55163:55163 -p 55164:55164 -p 55165:55165 -p 55166:55166 wakuorg/nwaku:latest generateRlnKeystore --execute --rln-relay-user-message-limit=100 --rln-relay-cred-path=/keystore/keystore.json --rln-relay-cred-password=password --rln-relay-eth-client-address=https://sepolia.infura.io/v3/0fbc961f49944da4b8fde35715e2171b --rln-relay-eth-contract-address=0xCB33Aa5B38d79E3D9Fa8B10afF38AA201399a7e3 --rln-relay-eth-private-key=d5f76ef141a96d916f99c72878a92cc6fb479af8441670d103e307d1184ab367
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.21.195 waku 9de53dc6135362534c48089d616ca466c1c744a09904a8f91f67c843006a9a11
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 9de53dc61353. Setting up logs at ./log/docker/node_2024-08-27_04-14-05__cb90198f-c39b-49b4-9e25-a9fc50236821__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:206 Executed container from image wakuorg/nwaku:latest. REST: 55162 to register RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:208 Waiting for keystore /home/runner/work/waku-interop-tests/waku-interop-tests/keystore_tvqm_1/keystore.json
[35mDEBUG   [0m src.steps.rln:rln.py:130 Registering RLN credentials for single node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node_2024-08-27_04-14-24__5d189f41-260b-4ae3-9aca-ba8517f18105__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:187 Registering RLN credentials...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.19.16
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['37099', '37100', '37101', '37102', '37103']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 37099:37099 -p 37100:37100 -p 37101:37101 -p 37102:37102 -p 37103:37103 wakuorg/nwaku:latest generateRlnKeystore --execute --rln-relay-user-message-limit=100 --rln-relay-cred-path=/keystore/keystore.json --rln-relay-cred-password=password --rln-relay-eth-client-address=https://sepolia.infura.io/v3/0fbc961f49944da4b8fde35715e2171b --rln-relay-eth-contract-address=0xCB33Aa5B38d79E3D9Fa8B10afF38AA201399a7e3 --rln-relay-eth-private-key=6bafcb0228b6b369b2de376bd9e37cdd3f5d30ce0787992b235acfacfa5de52e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.19.16 waku 61780bc3d5ac7207aef1c2fba835c5b00b3feffe564292eb0b4a44c26492dec1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 61780bc3d5ac. Setting up logs at ./log/docker/node_2024-08-27_04-14-24__5d189f41-260b-4ae3-9aca-ba8517f18105__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:206 Executed container from image wakuorg/nwaku:latest. REST: 37099 to register RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:208 Waiting for keystore /home/runner/work/waku-interop-tests/waku-interop-tests/keystore_ydnr_2/keystore.json
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-27_04-14-05__59e12ca4-846d-436e-8148-cfde5ac88406__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.163.246
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['39068', '39069', '39070', '39071', '39072']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes ['/home/runner/work/waku-interop-tests/waku-interop-tests/rln_tree_tvqm_1:/etc/rln_tree', '/home/runner/work/waku-interop-tests/waku-interop-tests/keystore_tvqm_1:/keystore']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 39068:39068 -p 39069:39069 -p 39070:39070 -p 39071:39071 -p 39072:39072 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39070 --rest-port=39068 --tcp-port=39069 --discv5-udp-port=39071 --rest-address=0.0.0.0 --nat=extip:172.18.163.246 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1262f91e7f67ae4c9476ded2ae7a13db8f5fc156cdba7c9dda3ace7d8acacc64 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39072 --metrics-logging=true --relay=true --rln-relay-membership-index=1 --lightpush=true --rln-relay-user-message-limit=1 --rln-relay-epoch-sec=1 --rln-relay=true --rln-relay-cred-path=/keystore/keystore.json --rln-relay-cred-password=password
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.163.246 waku 7bafddab95351e65c6b1a4fe643e4efb838af9b43bbe902344d18c547aa827b8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 7bafddab9535. Setting up logs at ./log/docker/node1_2024-08-27_04-14-05__59e12ca4-846d-436e-8148-cfde5ac88406__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 39068
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39068/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Initializing","protocolsHealth":[{"Rln Relay":"Ready"}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39068/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[{"Rln Relay":"Ready"}]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39068/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.163.246/tcp/39069/p2p/16Uiu2HAmFNwBwdS3u5wFSrvnb5BV1654reM1qSK73dS5K1Xj2Rhw","/ip4/172.18.163.246/tcp/39070/ws/p2p/16Uiu2HAmFNwBwdS3u5wFSrvnb5BV1654reM1qSK73dS5K1Xj2Rhw"],"enrUri":"enr:-LO4QPkhC76n7MXsRLdyM3BnPQrq12x1dFmUIuIs0gjJm86TXB6oQGjWK19Re53caX8vS0KuWg_psglzkQBSN3bc8DYBgmlkgnY0gmlwhKwSo_aKbXVsdGlhZGRyc4wACgSsEqP2Bpie3QOCcnOFAAMBAACJc2VjcDI1NmsxoQModjGJP7fC7XZ3fUteOgumZbYqbH1HjKaP-iYZ46yXLoN0Y3CCmJ2DdWRwgpifhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/lightpush_node2_2024-08-27_04-14-05__59e12ca4-846d-436e-8148-cfde5ac88406__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.33.10
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['47373', '47374', '47375', '47376', '47377']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes ['/home/runner/work/waku-interop-tests/waku-interop-tests/rln_tree_ydnr_2:/etc/rln_tree', '/home/runner/work/waku-interop-tests/waku-interop-tests/keystore_ydnr_2:/keystore']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 47373:47373 -p 47374:47374 -p 47375:47375 -p 47376:47376 -p 47377:47377 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47375 --rest-port=47373 --tcp-port=47374 --discv5-udp-port=47376 --rest-address=0.0.0.0 --nat=extip:172.18.33.10 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e43f1a4af8fbaa97ff12d87f7d8caa17a8daab5defabe0d7a0dffd27bb5acc3c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47377 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QPkhC76n7MXsRLdyM3BnPQrq12x1dFmUIuIs0gjJm86TXB6oQGjWK19Re53caX8vS0KuWg_psglzkQBSN3bc8DYBgmlkgnY0gmlwhKwSo_aKbXVsdGlhZGRyc4wACgSsEqP2Bpie3QOCcnOFAAMBAACJc2VjcDI1NmsxoQModjGJP7fC7XZ3fUteOgumZbYqbH1HjKaP-iYZ46yXLoN0Y3CCmJ2DdWRwgpifhXdha3UyCQ --lightpush=true --lightpushnode=/ip4/172.18.163.246/tcp/39069/p2p/16Uiu2HAmFNwBwdS3u5wFSrvnb5BV1654reM1qSK73dS5K1Xj2Rhw --rln-relay-membership-index=1 --rln-relay-user-message-limit=1 --rln-relay-epoch-sec=1 --rln-relay=true --rln-relay-cred-path=/keystore/keystore.json --rln-relay-cred-password=password
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.33.10 waku fd28b8e2fcabdad675589253697c29b1567c4a2d1f179068343665476bc0d3cb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID fd28b8e2fcab. Setting up logs at ./log/docker/lightpush_node2_2024-08-27_04-14-05__59e12ca4-846d-436e-8148-cfde5ac88406__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 47373
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47373/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Initializing","protocolsHealth":[{"Rln Relay":"Ready"}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47373/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[{"Rln Relay":"Ready"}]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47373/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.33.10/tcp/47374/p2p/16Uiu2HAkxK8RoQ9CmTYSbxYQ2wxkHnGuShUjQbWXxJAyrzdy2WSC","/ip4/172.18.33.10/tcp/47375/ws/p2p/16Uiu2HAkxK8RoQ9CmTYSbxYQ2wxkHnGuShUjQbWXxJAyrzdy2WSC"],"enrUri":"enr:-LO4QAIV1fvFCyRP9r6Q9amBoGveigC4svRlgNcQ5rHLkL-ief_Xk5h1aq8vs6mHAVPTagw7k9TGKpjVyJcEa3jUiGEBgmlkgnY0gmlwhKwSIQqKbXVsdGlhZGRyc4wACgSsEiEKBrkP3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIq5eaB0SMR2ktEA2OpdTLk0G3ugFnIs0iWFc6OMhEHsYN0Y3CCuQ6DdWRwgrkQhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47373/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.163.246/tcp/39069/p2p/16Uiu2HAmFNwBwdS3u5wFSrvnb5BV1654reM1qSK73dS5K1Xj2Rhw"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39068/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/1/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47373/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/1/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:30 Running test with payload A simple string
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:33 Sending message No. #1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47373/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/1/0", "message": {"payload": "SGVsbG8gV29ybGQh", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": 1724732089439676928}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:30 Running test with payload An integer
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:33 Sending message No. #2
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47373/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/1/0", "message": {"payload": "MTIzNDU2Nzg5MA==", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": 1724732089726234880}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:47373/lightpush/v1/message. Response content: b'Failed to request a message push: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 1 & nonceLimit: 1'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:30 Running test with payload A dictionary
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:33 Sending message No. #3
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47373/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/1/0", "message": {"payload": "eyJrZXkiOiAidmFsdWUifQ==", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": 1724732089734333440}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:47373/lightpush/v1/message. Response content: b'Failed to request a message push: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 2 & nonceLimit: 1'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:30 Running test with payload Chinese characters
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:33 Sending message No. #4
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47373/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/1/0", "message": {"payload": "6L+Z5piv5LiA5Lqb5Lit5paH", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": 1724732089740252672}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:47373/lightpush/v1/message. Response content: b'Failed to request a message push: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 3 & nonceLimit: 1'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:30 Running test with payload Emojis
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:33 Sending message No. #5
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47373/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/1/0", "message": {"payload": "8J+agPCfjJ/inKg=", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": 1724732089746468096}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:47373/lightpush/v1/message. Response content: b'Failed to request a message push: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 4 & nonceLimit: 1'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 7bafddab9535
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id fd28b8e2fcab
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.