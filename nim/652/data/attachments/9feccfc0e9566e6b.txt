2025-02-15 04:08:40.254 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:08:40.255 DEBUG [tests.conftest] Running test: test_cant_publish_on_not_subscribed_shard with id: 2025-02-15_04-08-40__7d4de058-c776-4c9e-ad00-f7ce6ed7ab1d
2025-02-15 04:08:40.255 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:08:40.255 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-15 04:08:40.255 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-15 04:08:40.265 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:08:40.265 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_04-08-40__7d4de058-c776-4c9e-ad00-f7ce6ed7ab1d__wakuorg_nwaku:latest.log
2025-02-15 04:08:40.265 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:08:40.266 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:08:40.268 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:08:40.268 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.65.10
2025-02-15 04:08:40.268 DEBUG [src.node.docker_mananger] Generated ports ['27188', '27189', '27190', '27191', '27192']
2025-02-15 04:08:40.269 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2025-02-15 04:08:40.269 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:08:40.269 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:08:40.269 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:08:40.270 DEBUG [src.node.docker_mananger] docker run -i -t -p 27188:27188 -p 27189:27189 -p 27190:27190 -p 27191:27191 -p 27192:27192 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27190 --rest-port=27188 --tcp-port=27189 --discv5-udp-port=27191 --rest-address=0.0.0.0 --nat=extip:172.18.65.10 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=56c5037be47eac2cae3bba7def5ffdf58b02cde8b61754295a5a1fecfe08ce06 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27192 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
2025-02-15 04:08:40.450 ERROR [src.node.docker_mananger] Max retries reached for container 575b89a2eb5b. Exiting log stream.
2025-02-15 04:08:40.495 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.65.10 waku 8603cc0f7627482af144bef9bcb530187eb0cb0f8b088a6aec719d11f7b2f05a
2025-02-15 04:08:40.543 DEBUG [src.node.docker_mananger] Container started with ID 8603cc0f7627. Setting up logs at ./log/docker/node1_2025-02-15_04-08-40__7d4de058-c776-4c9e-ad00-f7ce6ed7ab1d__wakuorg_nwaku:latest.log
2025-02-15 04:08:40.544 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 27188
2025-02-15 04:08:40.544 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:08:41.082 ERROR [src.node.docker_mananger] Max retries reached for container b3ad200d6f8a. Exiting log stream.
2025-02-15 04:08:41.545 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27188/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:41.548 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:08:41.548 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:08:41.548 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27188/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:41.551 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.65.10/tcp/27189/p2p/16Uiu2HAkzvY9h9Bmu24w8ShUACSWgUkkJCpUnfZrDvQMUewH3pCK","/ip4/172.18.65.10/tcp/27190/ws/p2p/16Uiu2HAkzvY9h9Bmu24w8ShUACSWgUkkJCpUnfZrDvQMUewH3pCK"],"enrUri":"enr:-L24QMGCYp-pZrvxmLYKkEuGMBMghjsHXUHeRwX429AguOqJbnRUoiF8ONYyflqXgOo64nOZaup_DW-IEmLdnr5lwFQCgmlkgnY0gmlwhKwSQQqKbXVsdGlhZGRyc5YACASsEkEKBmo1AAoErBJBCgZqNt0DgnJzhQACAQAAiXNlY3AyNTZrMaECUa9s6oaIckzXjo664rMZEiOn24PWNqzlO7U2vx-1cfyDdGNwgmo1g3VkcIJqN4V3YWt1MgU"}'
2025-02-15 04:08:41.551 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:08:41.557 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:08:41.557 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-15_04-08-40__7d4de058-c776-4c9e-ad00-f7ce6ed7ab1d__wakuorg_nwaku:latest.log
2025-02-15 04:08:41.557 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:08:41.557 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:08:41.559 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:08:41.559 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.209.40
2025-02-15 04:08:41.559 DEBUG [src.node.docker_mananger] Generated ports ['50496', '50497', '50498', '50499', '50500']
2025-02-15 04:08:41.559 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2025-02-15 04:08:41.559 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:08:41.560 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:08:41.560 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:08:41.560 DEBUG [src.node.docker_mananger] docker run -i -t -p 50496:50496 -p 50497:50497 -p 50498:50498 -p 50499:50499 -p 50500:50500 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50498 --rest-port=50496 --tcp-port=50497 --discv5-udp-port=50499 --rest-address=0.0.0.0 --nat=extip:172.18.209.40 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=9b78de9eaaa5fba17ca82719b66ddf609ff3eafa1b7e0e6cb033b0edb942b5a1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50500 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMGCYp-pZrvxmLYKkEuGMBMghjsHXUHeRwX429AguOqJbnRUoiF8ONYyflqXgOo64nOZaup_DW-IEmLdnr5lwFQCgmlkgnY0gmlwhKwSQQqKbXVsdGlhZGRyc5YACASsEkEKBmo1AAoErBJBCgZqNt0DgnJzhQACAQAAiXNlY3AyNTZrMaECUa9s6oaIckzXjo664rMZEiOn24PWNqzlO7U2vx-1cfyDdGNwgmo1g3VkcIJqN4V3YWt1MgU --pubsub-topic=/waku/2/rs/2/0
2025-02-15 04:08:41.785 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.209.40 waku 3f3b0b2dd1d9d39ee79ed22c95bf5c05f18b3284b202f6d30bd7a06d7bbd2a3f
2025-02-15 04:08:41.837 DEBUG [src.node.docker_mananger] Container started with ID 3f3b0b2dd1d9. Setting up logs at ./log/docker/node2_2025-02-15_04-08-40__7d4de058-c776-4c9e-ad00-f7ce6ed7ab1d__wakuorg_nwaku:latest.log
2025-02-15 04:08:41.837 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50496
2025-02-15 04:08:41.838 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:08:42.839 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50496/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:42.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:08:42.848 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:08:42.848 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50496/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:42.852 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.209.40/tcp/50497/p2p/16Uiu2HAmQ6xhWn8UWLHpKqNQ8Wbckiwej2TMAR3wsCw57mmMs332","/ip4/172.18.209.40/tcp/50498/ws/p2p/16Uiu2HAmQ6xhWn8UWLHpKqNQ8Wbckiwej2TMAR3wsCw57mmMs332"],"enrUri":"enr:-L24QM0VJQOh1pGAMjCBegKCS-vAqF7f9ozzkzUckXrBIpbcO95fJ8aVGX0HspRraW2a2J2PiCMCci6sQyIsn9FSy-sCgmlkgnY0gmlwhKwS0SiKbXVsdGlhZGRyc5YACASsEtEoBsVBAAoErBLRKAbFQt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDqhfKQ1nyVZCvxgtmOb0dvaroGhlAe8hOw7yijeJNgU2DdGNwgsVBg3VkcILFQ4V3YWt1MgE"}'
2025-02-15 04:08:42.852 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:08:42.852 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50496/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.65.10/tcp/27189/p2p/16Uiu2HAkzvY9h9Bmu24w8ShUACSWgUkkJCpUnfZrDvQMUewH3pCK"]'
2025-02-15 04:08:42.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:42.855 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27188/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-15 04:08:42.857 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:42.858 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50496/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-15 04:08:42.860 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:42.861 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27188/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:08:42.863 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:27188/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/2/1'
2025-02-15 04:08:42.865 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:08:42.866 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:08:42.866 DEBUG [src.node.waku_node] Stopping container with id 8603cc0f7627
2025-02-15 04:08:44.012 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:08:44.012 DEBUG [src.node.waku_node] Stopping container with id 3f3b0b2dd1d9
2025-02-15 04:08:44.825 ERROR [src.node.docker_mananger] Max retries reached for container 8603cc0f7627. Exiting log stream.
2025-02-15 04:08:45.533 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:08:45.534 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:08:45.539 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:08:45.545 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
