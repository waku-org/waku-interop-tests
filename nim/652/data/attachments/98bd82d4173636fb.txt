2025-02-15 04:02:45.927 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:02:45.927 DEBUG [tests.conftest] Running test: test_filter_resubscribe_to_unsubscribed_topics with id: 2025-02-15_04-02-45__964d3444-5030-48ad-ba20-8a76d09258b4
2025-02-15 04:02:45.927 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:02:45.927 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-15 04:02:45.928 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-15 04:02:45.934 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:02:45.934 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_04-02-45__964d3444-5030-48ad-ba20-8a76d09258b4__wakuorg_nwaku:latest.log
2025-02-15 04:02:45.935 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:02:45.935 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:02:45.936 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:02:45.936 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.143.1
2025-02-15 04:02:45.936 DEBUG [src.node.docker_mananger] Generated ports ['40182', '40183', '40184', '40185', '40186']
2025-02-15 04:02:45.936 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:02:45.937 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:02:45.937 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:02:45.937 DEBUG [src.node.docker_mananger] docker run -i -t -p 40182:40182 -p 40183:40183 -p 40184:40184 -p 40185:40185 -p 40186:40186 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40184 --rest-port=40182 --tcp-port=40183 --discv5-udp-port=40185 --rest-address=0.0.0.0 --nat=extip:172.18.143.1 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=221172835d6fd066db4d7fe973485de3f0d1bafcb83fecccbb3ef7589f7ecb75 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40186 --metrics-logging=true --relay=true --filter=true
2025-02-15 04:02:46.152 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.143.1 waku ee02b65a42be5e4d3d0284273107c48a620423d59498d8bb5ff487c762c0ee28
2025-02-15 04:02:46.193 DEBUG [src.node.docker_mananger] Container started with ID ee02b65a42be. Setting up logs at ./log/docker/node1_2025-02-15_04-02-45__964d3444-5030-48ad-ba20-8a76d09258b4__wakuorg_nwaku:latest.log
2025-02-15 04:02:46.194 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40182
2025-02-15 04:02:46.195 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:02:46.729 ERROR [src.node.docker_mananger] Max retries reached for container da8e8356686a. Exiting log stream.
2025-02-15 04:02:47.195 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40182/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:47.198 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:02:47.198 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:02:47.198 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40182/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:47.200 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.143.1/tcp/40183/p2p/16Uiu2HAmASmEnYoiYzy2WW2eutx5AuFMvhnqS3Vgt3RjQs8ENc4v","/ip4/172.18.143.1/tcp/40184/ws/p2p/16Uiu2HAmASmEnYoiYzy2WW2eutx5AuFMvhnqS3Vgt3RjQs8ENc4v"],"enrUri":"enr:-L24QNewGVdDDxvGf_Gr6Te1k7cZ9AnpjCX47gYkRAx1nZdRXNRlQdz11eoYUCrwF7DWZgNF0DkfCenVGut79YWfhKsCgmlkgnY0gmlwhKwSjwGKbXVsdGlhZGRyc5YACASsEo8BBpz3AAoErBKPAQac-N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC3ybUm8PJGNPfgGWlbn8JDo3JBoLU8sXWRAdctDo2Z0eDdGNwgpz3g3VkcIKc-YV3YWt1MgU"}'
2025-02-15 04:02:47.200 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:02:47.201 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-15 04:02:47.206 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:02:47.206 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-15_04-02-45__964d3444-5030-48ad-ba20-8a76d09258b4__wakuorg_nwaku:latest.log
2025-02-15 04:02:47.207 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:02:47.207 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:02:47.208 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:02:47.208 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.235.81
2025-02-15 04:02:47.208 DEBUG [src.node.docker_mananger] Generated ports ['6599', '6600', '6601', '6602', '6603']
2025-02-15 04:02:47.208 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:02:47.209 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:02:47.209 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:02:47.209 DEBUG [src.node.docker_mananger] docker run -i -t -p 6599:6599 -p 6600:6600 -p 6601:6601 -p 6602:6602 -p 6603:6603 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6601 --rest-port=6599 --tcp-port=6600 --discv5-udp-port=6602 --rest-address=0.0.0.0 --nat=extip:172.18.235.81 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6209d39dc9cb96fc355dccc26aff4aecfab6f1ba0cb2e0d3db748e53be8a7026 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6603 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QNewGVdDDxvGf_Gr6Te1k7cZ9AnpjCX47gYkRAx1nZdRXNRlQdz11eoYUCrwF7DWZgNF0DkfCenVGut79YWfhKsCgmlkgnY0gmlwhKwSjwGKbXVsdGlhZGRyc5YACASsEo8BBpz3AAoErBKPAQac-N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC3ybUm8PJGNPfgGWlbn8JDo3JBoLU8sXWRAdctDo2Z0eDdGNwgpz3g3VkcIKc-YV3YWt1MgU --filternode=/ip4/172.18.143.1/tcp/40183/p2p/16Uiu2HAmASmEnYoiYzy2WW2eutx5AuFMvhnqS3Vgt3RjQs8ENc4v
2025-02-15 04:02:47.451 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.235.81 waku 1d7f5cdf2cc5ebf1990345133d7815dcf6d20ca66866c24ae266abfbb1603ef7
2025-02-15 04:02:47.495 DEBUG [src.node.docker_mananger] Container started with ID 1d7f5cdf2cc5. Setting up logs at ./log/docker/node2_2025-02-15_04-02-45__964d3444-5030-48ad-ba20-8a76d09258b4__wakuorg_nwaku:latest.log
2025-02-15 04:02:47.496 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6599
2025-02-15 04:02:47.496 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:02:48.496 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6599/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:48.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:02:48.499 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:02:48.499 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6599/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:48.501 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.81/tcp/6600/p2p/16Uiu2HAmT4Px9X9vPkJUGDyYuAwHNHXWk2Rp8EVzZL8CJYnjuSHQ","/ip4/172.18.235.81/tcp/6601/ws/p2p/16Uiu2HAmT4Px9X9vPkJUGDyYuAwHNHXWk2Rp8EVzZL8CJYnjuSHQ"],"enrUri":"enr:-L24QBeNYbMpVZC1v_2hYbk2jogHISfzNuSXQL6O5uIx2tT6IhbdQc5r3mBcPU63FYWwOnpmxEaD0m2BbmaEmqg1XRUCgmlkgnY0gmlwhKwS61GKbXVsdGlhZGRyc5YACASsEutRBhnIAAoErBLrUQYZyd0DgnJzhQADAQAAiXNlY3AyNTZrMaED1gKpS6BkzS4eKL-odbcNFdPgm_YdRypyOx2d1sQLH1uDdGNwghnIg3VkcIIZyoV3YWt1MgA"}'
2025-02-15 04:02:48.502 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:02:48.502 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6599/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.143.1/tcp/40183/p2p/16Uiu2HAmASmEnYoiYzy2WW2eutx5AuFMvhnqS3Vgt3RjQs8ENc4v"]'
2025-02-15 04:02:48.542 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:48.544 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-15 04:02:48.544 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40182/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:02:48.561 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:48.563 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6599/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "f5af9748-0296-4159-86ab-9843177a66f6", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-15 04:02:48.574 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"f5af9748-0296-4159-86ab-9843177a66f6","statusDesc":"OK"}'
2025-02-15 04:02:48.575 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40182/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:02:48.582 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:48.582 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:02:48.683 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:02:48.683 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6599/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:48.685 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739592168575217920,"ephemeral":false}]'
2025-02-15 04:02:48.687 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:6599/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-15 04:02:48.695 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-15 04:02:48.695 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40182/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:02:48.698 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:48.698 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:02:48.799 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:02:48.799 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6599/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:48.801 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:6599/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
2025-02-15 04:02:48.803 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40182/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:02:48.805 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:48.805 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6599/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "65fa47f4-5d69-4a2f-aa35-6e26362c148a", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-15 04:02:48.813 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"65fa47f4-5d69-4a2f-aa35-6e26362c148a","statusDesc":"OK"}'
2025-02-15 04:02:48.814 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40182/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:02:48.818 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:48.818 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:02:48.918 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:02:48.918 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6599/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:48.920 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739592168814366208,"ephemeral":false}]'
2025-02-15 04:02:48.923 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:02:48.924 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:02:48.924 DEBUG [src.node.waku_node] Stopping container with id ee02b65a42be
2025-02-15 04:02:49.760 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:02:49.760 DEBUG [src.node.waku_node] Stopping container with id 1d7f5cdf2cc5
2025-02-15 04:02:50.572 ERROR [src.node.docker_mananger] Max retries reached for container ee02b65a42be. Exiting log stream.
2025-02-15 04:02:51.269 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:02:51.270 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:02:51.276 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:02:51.282 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
