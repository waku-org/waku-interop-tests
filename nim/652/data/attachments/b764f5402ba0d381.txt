2025-02-15 04:04:32.174 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:04:32.175 DEBUG [tests.conftest] Running test: test_lightpush_with_a_single_receiving_node with id: 2025-02-15_04-04-32__e2084023-ffc2-469a-86a5-a497850d9dbc
2025-02-15 04:04:32.175 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:04:32.175 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-15 04:04:32.181 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:04:32.181 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-15_04-04-32__e2084023-ffc2-469a-86a5-a497850d9dbc__wakuorg_nwaku:latest.log
2025-02-15 04:04:32.182 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:04:32.182 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:04:32.183 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:04:32.183 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.241.5
2025-02-15 04:04:32.183 DEBUG [src.node.docker_mananger] Generated ports ['30076', '30077', '30078', '30079', '30080']
2025-02-15 04:04:32.183 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:04:32.184 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:04:32.184 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:04:32.184 DEBUG [src.node.docker_mananger] docker run -i -t -p 30076:30076 -p 30077:30077 -p 30078:30078 -p 30079:30079 -p 30080:30080 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30078 --rest-port=30076 --tcp-port=30077 --discv5-udp-port=30079 --rest-address=0.0.0.0 --nat=extip:172.18.241.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e5ed97f1ca11c7fa27b73ceb5bc3f1e02d5c5b536eb79ccc977c9da5ba3ddfde --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30080 --metrics-logging=true --lightpush=true --relay=true
2025-02-15 04:04:32.413 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.241.5 waku 83655ea0721c057602eaa827c87c49a5c3f9853cc934c6512d21e6fb6cc3ecbe
2025-02-15 04:04:32.464 DEBUG [src.node.docker_mananger] Container started with ID 83655ea0721c. Setting up logs at ./log/docker/receiving_node1_2025-02-15_04-04-32__e2084023-ffc2-469a-86a5-a497850d9dbc__wakuorg_nwaku:latest.log
2025-02-15 04:04:32.464 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30076
2025-02-15 04:04:32.465 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:04:32.958 ERROR [src.node.docker_mananger] Max retries reached for container 4e9910596d7b. Exiting log stream.
2025-02-15 04:04:33.465 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30076/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:33.468 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:04:33.468 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:04:33.468 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30076/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:33.471 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.5/tcp/30077/p2p/16Uiu2HAmFpgybp3UeizUaW23GpdBeJCYvYDkT1kZ1yo8gXXw6i7m","/ip4/172.18.241.5/tcp/30078/ws/p2p/16Uiu2HAmFpgybp3UeizUaW23GpdBeJCYvYDkT1kZ1yo8gXXw6i7m"],"enrUri":"enr:-L24QMNndkl7m5ybHpsjaKN21CdBjj0QioaYRso_M4UbSpwPR-iTAThGXyHR5hc5Swg5HV-sa51xtVxtZhip1oomC2QCgmlkgnY0gmlwhKwS8QWKbXVsdGlhZGRyc5YACASsEvEFBnV9AAoErBLxBQZ1ft0DgnJzhQADAQAAiXNlY3AyNTZrMaEDLw85XbpcBGDll3tEs1wGmaOPg2_uchWcw2j3QGX0UTSDdGNwgnV9g3VkcIJ1f4V3YWt1Mgk"}'
2025-02-15 04:04:33.471 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:04:33.477 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:04:33.477 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-15_04-04-32__e2084023-ffc2-469a-86a5-a497850d9dbc__wakuorg_nwaku:latest.log
2025-02-15 04:04:33.478 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:04:33.478 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:04:33.479 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:04:33.479 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.166.47
2025-02-15 04:04:33.479 DEBUG [src.node.docker_mananger] Generated ports ['26702', '26703', '26704', '26705', '26706']
2025-02-15 04:04:33.479 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:04:33.480 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:04:33.480 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:04:33.480 DEBUG [src.node.docker_mananger] docker run -i -t -p 26702:26702 -p 26703:26703 -p 26704:26704 -p 26705:26705 -p 26706:26706 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26704 --rest-port=26702 --tcp-port=26703 --discv5-udp-port=26705 --rest-address=0.0.0.0 --nat=extip:172.18.166.47 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2c2d857cc8fb5afe201945ca1bef4d3952cdd2efba058eff1f5afed4fad44eb2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26706 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QMNndkl7m5ybHpsjaKN21CdBjj0QioaYRso_M4UbSpwPR-iTAThGXyHR5hc5Swg5HV-sa51xtVxtZhip1oomC2QCgmlkgnY0gmlwhKwS8QWKbXVsdGlhZGRyc5YACASsEvEFBnV9AAoErBLxBQZ1ft0DgnJzhQADAQAAiXNlY3AyNTZrMaEDLw85XbpcBGDll3tEs1wGmaOPg2_uchWcw2j3QGX0UTSDdGNwgnV9g3VkcIJ1f4V3YWt1Mgk --lightpushnode=/ip4/172.18.241.5/tcp/30077/p2p/16Uiu2HAmFpgybp3UeizUaW23GpdBeJCYvYDkT1kZ1yo8gXXw6i7m --lightpush=true --relay=false
2025-02-15 04:04:33.707 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.166.47 waku ef944ec9c494cd9b27f0446c765220c41b244cbb27c7e56bc96cbdca36b8d96a
2025-02-15 04:04:33.756 DEBUG [src.node.docker_mananger] Container started with ID ef944ec9c494. Setting up logs at ./log/docker/lightpush_node1_2025-02-15_04-04-32__e2084023-ffc2-469a-86a5-a497850d9dbc__wakuorg_nwaku:latest.log
2025-02-15 04:04:33.756 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 26702
2025-02-15 04:04:33.756 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:04:34.757 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26702/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:34.760 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:04:34.760 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:04:34.760 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26702/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:34.762 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.166.47/tcp/26703/p2p/16Uiu2HAm5ioGxi4BXy1a8eDyRud75yf5VEetaqr6n9zzpu2rGT7g","/ip4/172.18.166.47/tcp/26704/ws/p2p/16Uiu2HAm5ioGxi4BXy1a8eDyRud75yf5VEetaqr6n9zzpu2rGT7g"],"enrUri":"enr:-L24QF1CyuO9ptegD-F0xX4FUtGSt2nCWjDbCPkWawwwitFbToo2UFS1w0bMFLDg_GQ6zZq9IMFeeKkJxsKAV-tbtakCgmlkgnY0gmlwhKwSpi-KbXVsdGlhZGRyc5YACASsEqYvBmhPAAoErBKmLwZoUN0DgnJzhQADAQAAiXNlY3AyNTZrMaECmPf-HM2TPGG11TtSAr1I82eRUbUIao7ZPlOc4dVQArODdGNwgmhPg3VkcIJoUYV3YWt1Mgg"}'
2025-02-15 04:04:34.762 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:04:34.763 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26702/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.5/tcp/30077/p2p/16Uiu2HAmFpgybp3UeizUaW23GpdBeJCYvYDkT1kZ1yo8gXXw6i7m"]'
2025-02-15 04:04:34.798 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:34.799 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30076/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:04:34.819 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:34.821 DEBUG [src.steps.light_push] Lightpushing message
2025-02-15 04:04:34.821 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26702/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739592274821066496}}'
2025-02-15 04:04:34.832 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:26702/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
2025-02-15 04:04:34.834 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:04:34.835 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:04:34.835 DEBUG [src.node.waku_node] Stopping container with id 83655ea0721c
2025-02-15 04:04:35.940 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:04:35.940 DEBUG [src.node.waku_node] Stopping container with id ef944ec9c494
2025-02-15 04:04:36.752 ERROR [src.node.docker_mananger] Max retries reached for container 83655ea0721c. Exiting log stream.
2025-02-15 04:04:37.424 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:04:37.425 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:04:37.429 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:04:37.434 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
