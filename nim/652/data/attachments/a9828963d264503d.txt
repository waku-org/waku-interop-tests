2025-02-15 04:05:19.187 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:05:19.188 DEBUG [tests.conftest] Running test: test_legacy_store_v1 with id: 2025-02-15_04-05-19__170b2d21-66dd-4788-aa4a-dcc99070172b
2025-02-15 04:05:19.188 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:05:19.188 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-15 04:05:19.189 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-15 04:05:19.195 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:05:19.195 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-15_04-05-19__170b2d21-66dd-4788-aa4a-dcc99070172b__wakuorg_nwaku:latest.log
2025-02-15 04:05:19.195 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:05:19.195 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:05:19.197 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:05:19.197 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.95.146
2025-02-15 04:05:19.197 DEBUG [src.node.docker_mananger] Generated ports ['28643', '28644', '28645', '28646', '28647']
2025-02-15 04:05:19.197 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:05:19.197 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:05:19.197 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:05:19.198 DEBUG [src.node.docker_mananger] docker run -i -t -p 28643:28643 -p 28644:28644 -p 28645:28645 -p 28646:28646 -p 28647:28647 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=28645 --rest-port=28643 --tcp-port=28644 --discv5-udp-port=28646 --rest-address=0.0.0.0 --nat=extip:172.18.95.146 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6c03bdf84e80aad010dbc0c71aec7327fdacdb0ef5ce2b44410bc86b6bce117d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=28647 --metrics-logging=true --store=true --relay=true
2025-02-15 04:05:19.435 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.95.146 waku 1b54f7d4acf0e37f54d632cc1c8e252670d2403047a4a2287a5e310c92601f6b
2025-02-15 04:05:19.477 DEBUG [src.node.docker_mananger] Container started with ID 1b54f7d4acf0. Setting up logs at ./log/docker/publishing_node1_2025-02-15_04-05-19__170b2d21-66dd-4788-aa4a-dcc99070172b__wakuorg_nwaku:latest.log
2025-02-15 04:05:19.479 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 28643
2025-02-15 04:05:19.479 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:05:19.971 ERROR [src.node.docker_mananger] Max retries reached for container 6f04ac1f99d3. Exiting log stream.
2025-02-15 04:05:20.480 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28643/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:20.482 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:05:20.483 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:05:20.483 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28643/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:20.485 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.95.146/tcp/28644/p2p/16Uiu2HAmNaSMjcZB6WYN88X4jJNVKXAiwXf9qCxRTzc7juvCWtvL","/ip4/172.18.95.146/tcp/28645/ws/p2p/16Uiu2HAmNaSMjcZB6WYN88X4jJNVKXAiwXf9qCxRTzc7juvCWtvL"],"enrUri":"enr:-L24QBPOlCksBzNSBJBGZljzSLKcYBKzrTWCmBEZBfr1PnQPCI4OoikvSZVBYpeRXw5ARMCDmNDKhVmvLdIzLLrFdrECgmlkgnY0gmlwhKwSX5KKbXVsdGlhZGRyc5YACASsEl-SBm_kAAoErBJfkgZv5d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDk2pfSHsZoA2ZwQ9TFZG1xmGhEkCwvrLKaKlUq1Nr8JmDdGNwgm_kg3VkcIJv5oV3YWt1MgM"}'
2025-02-15 04:05:20.485 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:05:20.492 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:05:20.492 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-15_04-05-19__170b2d21-66dd-4788-aa4a-dcc99070172b__wakuorg_nwaku:latest.log
2025-02-15 04:05:20.492 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:05:20.492 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:05:20.494 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:05:20.494 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.25.126
2025-02-15 04:05:20.494 DEBUG [src.node.docker_mananger] Generated ports ['21093', '21094', '21095', '21096', '21097']
2025-02-15 04:05:20.494 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:05:20.494 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:05:20.494 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:05:20.494 DEBUG [src.node.docker_mananger] docker run -i -t -p 21093:21093 -p 21094:21094 -p 21095:21095 -p 21096:21096 -p 21097:21097 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21095 --rest-port=21093 --tcp-port=21094 --discv5-udp-port=21096 --rest-address=0.0.0.0 --nat=extip:172.18.25.126 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4de0a419d2bcb3db1d18982afdded8c3a9fa1dcb974ad8fa9e0d036b1e47a9eb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21097 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QBPOlCksBzNSBJBGZljzSLKcYBKzrTWCmBEZBfr1PnQPCI4OoikvSZVBYpeRXw5ARMCDmNDKhVmvLdIzLLrFdrECgmlkgnY0gmlwhKwSX5KKbXVsdGlhZGRyc5YACASsEl-SBm_kAAoErBJfkgZv5d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDk2pfSHsZoA2ZwQ9TFZG1xmGhEkCwvrLKaKlUq1Nr8JmDdGNwgm_kg3VkcIJv5oV3YWt1MgM --storenode=/ip4/172.18.95.146/tcp/28644/p2p/16Uiu2HAmNaSMjcZB6WYN88X4jJNVKXAiwXf9qCxRTzc7juvCWtvL --store=true --relay=true
2025-02-15 04:05:20.717 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.25.126 waku 00369559412c58e39b69941a419a00206fbe876ac4e5a9911a1a41511c026ba3
2025-02-15 04:05:20.768 DEBUG [src.node.docker_mananger] Container started with ID 00369559412c. Setting up logs at ./log/docker/store_node1_2025-02-15_04-05-19__170b2d21-66dd-4788-aa4a-dcc99070172b__wakuorg_nwaku:latest.log
2025-02-15 04:05:20.768 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 21093
2025-02-15 04:05:20.768 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:05:21.769 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21093/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:21.771 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:05:21.772 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:05:21.772 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21093/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:21.774 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.25.126/tcp/21094/p2p/16Uiu2HAmGF4uEG1Yk1prRuCM1hR47Ud7uejSN2W4jm2ANrFjXwCY","/ip4/172.18.25.126/tcp/21095/ws/p2p/16Uiu2HAmGF4uEG1Yk1prRuCM1hR47Ud7uejSN2W4jm2ANrFjXwCY"],"enrUri":"enr:-L24QBWmZJPElQEFRpY6MRp_ixa75YEOeH_l3wTVC29EpSBWFwxvxAb2tQzJtMwTwBUc45aDbhX-kUpH3U2AK0c04uQCgmlkgnY0gmlwhKwSGX6KbXVsdGlhZGRyc5YACASsEhl-BlJmAAoErBIZfgZSZ90DgnJzhQADAQAAiXNlY3AyNTZrMaEDNU30KZrWoK8P9S4gO85PeK5jyDBTNRvtz9mFglY5rgWDdGNwglJmg3VkcIJSaIV3YWt1MgM"}'
2025-02-15 04:05:21.774 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:05:21.774 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21093/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.95.146/tcp/28644/p2p/16Uiu2HAmNaSMjcZB6WYN88X4jJNVKXAiwXf9qCxRTzc7juvCWtvL"]'
2025-02-15 04:05:21.777 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:21.777 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28643/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:05:21.779 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:21.780 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21093/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:05:21.782 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:21.783 DEBUG [src.steps.store] Relaying message
2025-02-15 04:05:21.783 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28643/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:05:21.788 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:21.790 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-15 04:05:21.990 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28643/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:21.993 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739592321783305216,"ephemeral":false}]}'
2025-02-15 04:05:21.993 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21093/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:21.996 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739592321783305216,"ephemeral":false}]}'
2025-02-15 04:05:21.998 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:05:21.999 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:05:21.999 DEBUG [src.node.waku_node] Stopping container with id 1b54f7d4acf0
2025-02-15 04:05:23.023 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:05:23.023 DEBUG [src.node.waku_node] Stopping container with id 00369559412c
2025-02-15 04:05:23.835 ERROR [src.node.docker_mananger] Max retries reached for container 1b54f7d4acf0. Exiting log stream.
2025-02-15 04:05:24.132 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:05:24.133 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:05:24.139 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:05:24.144 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
