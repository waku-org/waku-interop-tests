2025-02-15 04:03:53.075 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:03:53.075 DEBUG [tests.conftest] Running test: test_publish_with_missing_payload with id: 2025-02-15_04-03-53__0095e9a4-7b8c-493e-bc63-46586232ee34
2025-02-15 04:03:53.076 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:03:53.076 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-15 04:03:53.076 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-15 04:03:53.082 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:03:53.082 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_04-03-53__0095e9a4-7b8c-493e-bc63-46586232ee34__wakuorg_nwaku:latest.log
2025-02-15 04:03:53.083 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:03:53.083 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:03:53.084 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:03:53.084 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.32.26
2025-02-15 04:03:53.084 DEBUG [src.node.docker_mananger] Generated ports ['16134', '16135', '16136', '16137', '16138']
2025-02-15 04:03:53.085 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:03:53.085 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:03:53.085 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:03:53.085 DEBUG [src.node.docker_mananger] docker run -i -t -p 16134:16134 -p 16135:16135 -p 16136:16136 -p 16137:16137 -p 16138:16138 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16136 --rest-port=16134 --tcp-port=16135 --discv5-udp-port=16137 --rest-address=0.0.0.0 --nat=extip:172.18.32.26 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c4a0bdc9ecb38bdc9eb1f4ed1dcd8cd6692c3e6527be69cfa3ac8d7dcdecec4c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16138 --metrics-logging=true --relay=true
2025-02-15 04:03:53.300 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.32.26 waku b9712733e93b822941b9dabe787f42b379fd3ffe9b5ab9e7fdb650227c5202fa
2025-02-15 04:03:53.347 DEBUG [src.node.docker_mananger] Container started with ID b9712733e93b. Setting up logs at ./log/docker/node1_2025-02-15_04-03-53__0095e9a4-7b8c-493e-bc63-46586232ee34__wakuorg_nwaku:latest.log
2025-02-15 04:03:53.348 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16134
2025-02-15 04:03:53.348 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:03:53.882 ERROR [src.node.docker_mananger] Max retries reached for container c2a0ffb3e0ea. Exiting log stream.
2025-02-15 04:03:54.349 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16134/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:54.352 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:03:54.352 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:03:54.352 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16134/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:54.354 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.32.26/tcp/16135/p2p/16Uiu2HAkyjtqSAKrimNVwmj6ujpekrfKk6hKyLjLuoAvVWChwE5x","/ip4/172.18.32.26/tcp/16136/ws/p2p/16Uiu2HAkyjtqSAKrimNVwmj6ujpekrfKk6hKyLjLuoAvVWChwE5x"],"enrUri":"enr:-L24QOSPzFoYeW6D2DBHC4rJg4-eesFRG4hURiz_4ypIMJOjAEJsIZt6jotzH8gnoRNrKaCdewiT3deh5Y8lkjjGxtACgmlkgnY0gmlwhKwSIBqKbXVsdGlhZGRyc5YACASsEiAaBj8HAAoErBIgGgY_CN0DgnJzhQADAQAAiXNlY3AyNTZrMaECQBm9C7VMT0N1ZMB7kX8eiSdIPLpgQvxlpeXQB8z_KwODdGNwgj8Hg3VkcII_CYV3YWt1MgE"}'
2025-02-15 04:03:54.354 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:03:54.360 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:03:54.361 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-15_04-03-53__0095e9a4-7b8c-493e-bc63-46586232ee34__wakuorg_nwaku:latest.log
2025-02-15 04:03:54.361 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:03:54.361 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:03:54.362 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:03:54.362 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.240.131
2025-02-15 04:03:54.362 DEBUG [src.node.docker_mananger] Generated ports ['8625', '8626', '8627', '8628', '8629']
2025-02-15 04:03:54.362 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:03:54.363 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:03:54.363 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:03:54.363 DEBUG [src.node.docker_mananger] docker run -i -t -p 8625:8625 -p 8626:8626 -p 8627:8627 -p 8628:8628 -p 8629:8629 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8627 --rest-port=8625 --tcp-port=8626 --discv5-udp-port=8628 --rest-address=0.0.0.0 --nat=extip:172.18.240.131 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2d50369febde6be85ace4149e2bce7df0dd31cbc757bb47bdeb25ed65abac2a6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8629 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOSPzFoYeW6D2DBHC4rJg4-eesFRG4hURiz_4ypIMJOjAEJsIZt6jotzH8gnoRNrKaCdewiT3deh5Y8lkjjGxtACgmlkgnY0gmlwhKwSIBqKbXVsdGlhZGRyc5YACASsEiAaBj8HAAoErBIgGgY_CN0DgnJzhQADAQAAiXNlY3AyNTZrMaECQBm9C7VMT0N1ZMB7kX8eiSdIPLpgQvxlpeXQB8z_KwODdGNwgj8Hg3VkcII_CYV3YWt1MgE
2025-02-15 04:03:54.587 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.240.131 waku e40e982a0a934a3ebd07c78f6be5f24241a09a306ba92bf0384e359394d0dce7
2025-02-15 04:03:54.638 DEBUG [src.node.docker_mananger] Container started with ID e40e982a0a93. Setting up logs at ./log/docker/node2_2025-02-15_04-03-53__0095e9a4-7b8c-493e-bc63-46586232ee34__wakuorg_nwaku:latest.log
2025-02-15 04:03:54.639 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8625
2025-02-15 04:03:54.639 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:03:55.640 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8625/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:55.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:03:55.648 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:03:55.648 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8625/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:55.651 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.240.131/tcp/8626/p2p/16Uiu2HAm22rQj98LaQYuDuEinwYcqzhHxyzFkpqyexiGwTXioNJZ","/ip4/172.18.240.131/tcp/8627/ws/p2p/16Uiu2HAm22rQj98LaQYuDuEinwYcqzhHxyzFkpqyexiGwTXioNJZ"],"enrUri":"enr:-L24QCpzkwyAxwrJjAcGru2H9TVVMyyBJ24VxfHPiZCdmk3sEWgLvi6Dv7CB34aixdinH5o_BmHGHrRPMmD0mzU1gXICgmlkgnY0gmlwhKwS8IOKbXVsdGlhZGRyc5YACASsEvCDBiGyAAoErBLwgwYhs90DgnJzhQADAQAAiXNlY3AyNTZrMaECYik-NONGYf4fT0q4ZyBNwj6BN3x3vpWsMga4Tk5soe6DdGNwgiGyg3VkcIIhtIV3YWt1MgE"}'
2025-02-15 04:03:55.652 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:03:55.652 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8625/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.32.26/tcp/16135/p2p/16Uiu2HAkyjtqSAKrimNVwmj6ujpekrfKk6hKyLjLuoAvVWChwE5x"]'
2025-02-15 04:03:55.655 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:55.655 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-15 04:03:55.655 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16134/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:03:55.659 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:55.659 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8625/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:03:55.665 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:55.666 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16134/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:03:55.671 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:55.672 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:03:55.772 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 04:03:55.772 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16134/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:55.775 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592235666788096,"ephemeral":false}]'
2025-02-15 04:03:55.776 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:03:55.776 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8625/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:55.778 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592235666788096,"ephemeral":false}]'
2025-02-15 04:03:55.780 INFO [src.steps.relay] WARM UP successful!!
2025-02-15 04:03:55.780 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16134/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:03:55.783 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:16134/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-15 04:03:55.785 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:03:55.785 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:03:55.786 DEBUG [src.node.waku_node] Stopping container with id b9712733e93b
2025-02-15 04:03:56.812 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:03:56.812 DEBUG [src.node.waku_node] Stopping container with id e40e982a0a93
2025-02-15 04:03:57.624 ERROR [src.node.docker_mananger] Max retries reached for container b9712733e93b. Exiting log stream.
2025-02-15 04:03:58.329 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:03:58.330 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:03:58.336 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:03:58.342 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
