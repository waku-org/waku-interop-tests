2025-02-15 04:03:33.123 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:03:33.123 DEBUG [tests.conftest] Running test: test_light_push_with_no_timestamp with id: 2025-02-15_04-03-33__4a59b761-0938-48bb-bd61-f25e7b2d51fb
2025-02-15 04:03:33.123 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:03:33.124 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-15 04:03:33.130 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:03:33.130 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-15_04-03-33__4a59b761-0938-48bb-bd61-f25e7b2d51fb__wakuorg_nwaku:latest.log
2025-02-15 04:03:33.130 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:03:33.130 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:03:33.132 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:03:33.132 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.88.233
2025-02-15 04:03:33.132 DEBUG [src.node.docker_mananger] Generated ports ['4644', '4645', '4646', '4647', '4648']
2025-02-15 04:03:33.132 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:03:33.132 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:03:33.132 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:03:33.132 DEBUG [src.node.docker_mananger] docker run -i -t -p 4644:4644 -p 4645:4645 -p 4646:4646 -p 4647:4647 -p 4648:4648 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4646 --rest-port=4644 --tcp-port=4645 --discv5-udp-port=4647 --rest-address=0.0.0.0 --nat=extip:172.18.88.233 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d1c9a4ef9bc1ba76564f3a4538bbdcedbfd6cadcb16ffb8db096bac8b8af6ae1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4648 --metrics-logging=true --lightpush=true --relay=true
2025-02-15 04:03:33.359 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.88.233 waku 0d2c827e70629d477ffe3b5ccc1b8e2689809a102c1abed01c458a7603e4e30a
2025-02-15 04:03:33.411 DEBUG [src.node.docker_mananger] Container started with ID 0d2c827e7062. Setting up logs at ./log/docker/receiving_node1_2025-02-15_04-03-33__4a59b761-0938-48bb-bd61-f25e7b2d51fb__wakuorg_nwaku:latest.log
2025-02-15 04:03:33.412 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 4644
2025-02-15 04:03:33.413 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:03:33.932 ERROR [src.node.docker_mananger] Max retries reached for container e37f2c69c126. Exiting log stream.
2025-02-15 04:03:34.414 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4644/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:34.417 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:03:34.417 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:03:34.417 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4644/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:34.419 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.88.233/tcp/4645/p2p/16Uiu2HAky1DsSEyEVNESSQQyUcqyWAUdefprMtruek8cVvyCxFWe","/ip4/172.18.88.233/tcp/4646/ws/p2p/16Uiu2HAky1DsSEyEVNESSQQyUcqyWAUdefprMtruek8cVvyCxFWe"],"enrUri":"enr:-L24QKs479ZelyPNfStSr89lVV-Ycfiub_XsXNQhkz46K9IpJYIHniabjIvrR1wYP5iZwd4KL7ttgwopUw4nD14BuAwCgmlkgnY0gmlwhKwSWOmKbXVsdGlhZGRyc5YACASsEljpBhIlAAoErBJY6QYSJt0DgnJzhQADAQAAiXNlY3AyNTZrMaECNStJOuQvoQBKllYyQtMhTayJxa9NqOPwoFxOR8SbhjeDdGNwghIlg3VkcIISJ4V3YWt1Mgk"}'
2025-02-15 04:03:34.420 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:03:34.426 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:03:34.426 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-15_04-03-33__4a59b761-0938-48bb-bd61-f25e7b2d51fb__wakuorg_nwaku:latest.log
2025-02-15 04:03:34.426 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:03:34.426 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:03:34.428 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:03:34.428 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.221.75
2025-02-15 04:03:34.428 DEBUG [src.node.docker_mananger] Generated ports ['62664', '62665', '62666', '62667', '62668']
2025-02-15 04:03:34.428 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:03:34.428 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:03:34.428 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:03:34.429 DEBUG [src.node.docker_mananger] docker run -i -t -p 62664:62664 -p 62665:62665 -p 62666:62666 -p 62667:62667 -p 62668:62668 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62666 --rest-port=62664 --tcp-port=62665 --discv5-udp-port=62667 --rest-address=0.0.0.0 --nat=extip:172.18.221.75 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5edf7cae7cf7eb5ed3c4faf894bbb9e50d1ed4b1408ac0f78c3638ecb87c2fbb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62668 --metrics-logging=true --lightpush=false --relay=true
2025-02-15 04:03:34.650 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.221.75 waku 1dcc27e65db7fa2c087a0920d415a54e845258999729d272dc8c3e5f85edd6d1
2025-02-15 04:03:34.694 DEBUG [src.node.docker_mananger] Container started with ID 1dcc27e65db7. Setting up logs at ./log/docker/receiving_node2_2025-02-15_04-03-33__4a59b761-0938-48bb-bd61-f25e7b2d51fb__wakuorg_nwaku:latest.log
2025-02-15 04:03:34.695 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62664
2025-02-15 04:03:34.695 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:03:35.695 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62664/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:35.698 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:03:35.698 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:03:35.698 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62664/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:35.700 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.221.75/tcp/62665/p2p/16Uiu2HAmAz4HtxQ2nU9dEs7qPvHLvb5T7mteNxELhkSy85Dn7oVv","/ip4/172.18.221.75/tcp/62666/ws/p2p/16Uiu2HAmAz4HtxQ2nU9dEs7qPvHLvb5T7mteNxELhkSy85Dn7oVv"],"enrUri":"enr:-L24QD0j0BJ8AXmdJ7lCpCBrm1IDTO-ELZDkEjG493OMjdLAOqH-f9GyKxnOsyEpALTwdEyhZOn4ytWKNt8wmJfbG7ACgmlkgnY0gmlwhKwS3UuKbXVsdGlhZGRyc5YACASsEt1LBvTJAAoErBLdSwb0yt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC5yseQTUgiabybbSRS8_hmhv3upKagwtW68i-61t678WDdGNwgvTJg3VkcIL0y4V3YWt1MgE"}'
2025-02-15 04:03:35.701 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:03:35.701 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62664/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.88.233/tcp/4645/p2p/16Uiu2HAky1DsSEyEVNESSQQyUcqyWAUdefprMtruek8cVvyCxFWe"]'
2025-02-15 04:03:35.740 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:35.748 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:03:35.748 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-15_04-03-33__4a59b761-0938-48bb-bd61-f25e7b2d51fb__wakuorg_nwaku:latest.log
2025-02-15 04:03:35.748 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:03:35.749 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:03:35.750 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:03:35.750 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.53.244
2025-02-15 04:03:35.750 DEBUG [src.node.docker_mananger] Generated ports ['20860', '20861', '20862', '20863', '20864']
2025-02-15 04:03:35.750 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:03:35.751 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:03:35.751 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:03:35.751 DEBUG [src.node.docker_mananger] docker run -i -t -p 20860:20860 -p 20861:20861 -p 20862:20862 -p 20863:20863 -p 20864:20864 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20862 --rest-port=20860 --tcp-port=20861 --discv5-udp-port=20863 --rest-address=0.0.0.0 --nat=extip:172.18.53.244 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5bd619cd9f023ae272c5df9ceead8f7afb89c1aaf78aeecb519dc0e8f99b6dab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20864 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QKs479ZelyPNfStSr89lVV-Ycfiub_XsXNQhkz46K9IpJYIHniabjIvrR1wYP5iZwd4KL7ttgwopUw4nD14BuAwCgmlkgnY0gmlwhKwSWOmKbXVsdGlhZGRyc5YACASsEljpBhIlAAoErBJY6QYSJt0DgnJzhQADAQAAiXNlY3AyNTZrMaECNStJOuQvoQBKllYyQtMhTayJxa9NqOPwoFxOR8SbhjeDdGNwghIlg3VkcIISJ4V3YWt1Mgk --lightpushnode=/ip4/172.18.88.233/tcp/4645/p2p/16Uiu2HAky1DsSEyEVNESSQQyUcqyWAUdefprMtruek8cVvyCxFWe --lightpush=true --relay=false
2025-02-15 04:03:35.991 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.53.244 waku 2eb86390ec4d8d1fd29628f2ebce184ffc0c7fdc32076d430d26ff2f63d0c97e
2025-02-15 04:03:36.034 DEBUG [src.node.docker_mananger] Container started with ID 2eb86390ec4d. Setting up logs at ./log/docker/lightpush_node1_2025-02-15_04-03-33__4a59b761-0938-48bb-bd61-f25e7b2d51fb__wakuorg_nwaku:latest.log
2025-02-15 04:03:36.034 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20860
2025-02-15 04:03:36.034 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:03:37.035 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20860/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:37.038 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:03:37.038 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:03:37.038 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20860/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:37.040 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.53.244/tcp/20861/p2p/16Uiu2HAm1hQ3ZFUu2vdy74meZD6XWE2hNozXdUDNYc53QrQrAYCt","/ip4/172.18.53.244/tcp/20862/ws/p2p/16Uiu2HAm1hQ3ZFUu2vdy74meZD6XWE2hNozXdUDNYc53QrQrAYCt"],"enrUri":"enr:-L24QHAhKCgAmu5mH7swwNEkOPNmM3ib26yviFlNwLK6e_EdafN0hYM0BcbacPYYRaN4WbAhZiNQYp6XJTyNL5tmtHECgmlkgnY0gmlwhKwSNfSKbXVsdGlhZGRyc5YACASsEjX0BlF9AAoErBI19AZRft0DgnJzhQADAQAAiXNlY3AyNTZrMaECXS1liFGSdxEeWJf_qJxi6T3dz9cAdbSjjzybdSIm-KWDdGNwglF9g3VkcIJRf4V3YWt1Mgg"}'
2025-02-15 04:03:37.040 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:03:37.040 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20860/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.88.233/tcp/4645/p2p/16Uiu2HAky1DsSEyEVNESSQQyUcqyWAUdefprMtruek8cVvyCxFWe"]'
2025-02-15 04:03:37.077 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:37.078 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20860/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.221.75/tcp/62665/p2p/16Uiu2HAmAz4HtxQ2nU9dEs7qPvHLvb5T7mteNxELhkSy85Dn7oVv"]'
2025-02-15 04:03:37.106 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:37.109 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4644/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:03:37.118 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:37.119 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62664/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:03:37.123 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:37.124 DEBUG [src.steps.light_push] Lightpushing message
2025-02-15 04:03:37.124 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20860/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto"}}'
2025-02-15 04:03:37.133 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:03:37.134 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:03:37.234 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-15 04:03:37.234 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:37.236 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739592217126196736,"ephemeral":false}]'
2025-02-15 04:03:37.238 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-15 04:03:37.238 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62664/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:03:37.240 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739592217126196736,"ephemeral":false}]'
2025-02-15 04:03:37.243 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:03:37.244 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:03:37.244 DEBUG [src.node.waku_node] Stopping container with id 0d2c827e7062
2025-02-15 04:03:37.885 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:03:37.885 DEBUG [src.node.waku_node] Stopping container with id 1dcc27e65db7
2025-02-15 04:03:38.696 ERROR [src.node.docker_mananger] Max retries reached for container 0d2c827e7062. Exiting log stream.
2025-02-15 04:03:39.381 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:03:39.381 DEBUG [src.node.waku_node] Stopping container with id 2eb86390ec4d
2025-02-15 04:03:40.193 ERROR [src.node.docker_mananger] Max retries reached for container 1dcc27e65db7. Exiting log stream.
2025-02-15 04:03:40.873 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:03:40.875 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:03:40.882 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:03:40.889 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:03:40.895 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
