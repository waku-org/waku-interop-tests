2025-02-15 04:08:03.006 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:08:03.006 DEBUG [tests.conftest] Running test: test_store_lightpushed_message with id: 2025-02-15_04-08-03__e1d04476-7c2d-4cc6-87eb-3e3516d57e61
2025-02-15 04:08:03.006 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:08:03.006 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-15 04:08:03.013 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:08:03.013 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-15_04-08-03__e1d04476-7c2d-4cc6-87eb-3e3516d57e61__wakuorg_nwaku:latest.log
2025-02-15 04:08:03.013 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:08:03.014 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:08:03.015 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:08:03.015 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.152.77
2025-02-15 04:08:03.015 DEBUG [src.node.docker_mananger] Generated ports ['22855', '22856', '22857', '22858', '22859']
2025-02-15 04:08:03.015 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:08:03.016 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:08:03.016 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:08:03.016 DEBUG [src.node.docker_mananger] docker run -i -t -p 22855:22855 -p 22856:22856 -p 22857:22857 -p 22858:22858 -p 22859:22859 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22857 --rest-port=22855 --tcp-port=22856 --discv5-udp-port=22858 --rest-address=0.0.0.0 --nat=extip:172.18.152.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dca142ed5aa3228cca000d0aecef2bf0bb45dccce0dabba126eebaceedfc3ffa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22859 --metrics-logging=true --store=true --relay=true --lightpush=true
2025-02-15 04:08:03.240 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.152.77 waku 5785050280cb16474b5ece1aecb320c2f37920ac7d31709de7bc639fa74b7804
2025-02-15 04:08:03.286 DEBUG [src.node.docker_mananger] Container started with ID 5785050280cb. Setting up logs at ./log/docker/publishing_node1_2025-02-15_04-08-03__e1d04476-7c2d-4cc6-87eb-3e3516d57e61__wakuorg_nwaku:latest.log
2025-02-15 04:08:03.287 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22855
2025-02-15 04:08:03.288 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:08:03.809 ERROR [src.node.docker_mananger] Max retries reached for container 965ed0f76f69. Exiting log stream.
2025-02-15 04:08:04.289 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22855/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:04.293 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:08:04.293 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:08:04.293 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22855/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:04.295 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.152.77/tcp/22856/p2p/16Uiu2HAm46aPei2zayZvFqww1LLVA1Tw8FvYJuNSrUbgpWsQwayK","/ip4/172.18.152.77/tcp/22857/ws/p2p/16Uiu2HAm46aPei2zayZvFqww1LLVA1Tw8FvYJuNSrUbgpWsQwayK"],"enrUri":"enr:-L24QOkH2orBECspOdqk57MOVZMiL8OIfJaUYyaoIC5SwocKdXbepjFwrf80IhTsiz5RKzuunei82d2x7ka5fMVLCbwCgmlkgnY0gmlwhKwSmE2KbXVsdGlhZGRyc5YACASsEphNBllIAAoErBKYTQZZSd0DgnJzhQADAQAAiXNlY3AyNTZrMaECgNTT7WQxlVXVf2lCx-InwMSUUFw2TT3eLNi8c_ijCkaDdGNwgllIg3VkcIJZSoV3YWt1Mgs"}'
2025-02-15 04:08:04.296 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:08:04.302 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:08:04.302 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node2_2025-02-15_04-08-03__e1d04476-7c2d-4cc6-87eb-3e3516d57e61__wakuorg_nwaku:latest.log
2025-02-15 04:08:04.302 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:08:04.303 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:08:04.304 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:08:04.304 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.19.41
2025-02-15 04:08:04.304 DEBUG [src.node.docker_mananger] Generated ports ['19858', '19859', '19860', '19861', '19862']
2025-02-15 04:08:04.304 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:08:04.304 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:08:04.304 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:08:04.305 DEBUG [src.node.docker_mananger] docker run -i -t -p 19858:19858 -p 19859:19859 -p 19860:19860 -p 19861:19861 -p 19862:19862 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19860 --rest-port=19858 --tcp-port=19859 --discv5-udp-port=19861 --rest-address=0.0.0.0 --nat=extip:172.18.19.41 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=accc7c6b89f8a2bb79de67a4ee186f28fbdad2fa53bb2e15665c16fd6c1c190e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19862 --metrics-logging=true --store=false --relay=true
2025-02-15 04:08:04.527 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.19.41 waku 1224fa79a92c4faea299df59f3a0c766e2009535a8a6467bda2e5f7b2aad9360
2025-02-15 04:08:04.571 DEBUG [src.node.docker_mananger] Container started with ID 1224fa79a92c. Setting up logs at ./log/docker/publishing_node2_2025-02-15_04-08-03__e1d04476-7c2d-4cc6-87eb-3e3516d57e61__wakuorg_nwaku:latest.log
2025-02-15 04:08:04.571 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19858
2025-02-15 04:08:04.572 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:08:05.573 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19858/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:05.576 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:08:05.576 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:08:05.576 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19858/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:05.578 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.41/tcp/19859/p2p/16Uiu2HAm7DvJh59vXhcSa7fe9SaaMoRNQRXawAG84maKbSKACx5q","/ip4/172.18.19.41/tcp/19860/ws/p2p/16Uiu2HAm7DvJh59vXhcSa7fe9SaaMoRNQRXawAG84maKbSKACx5q"],"enrUri":"enr:-L24QC9gIfVyOlMcry7nTvdvZsDeZwvLoeCuY1ueYFOwcAGVILYKLdeZj54XFg54K-3zDVDR4IPlAOjHmYNAOSSQwmsCgmlkgnY0gmlwhKwSEymKbXVsdGlhZGRyc5YACASsEhMpBk2TAAoErBITKQZNlN0DgnJzhQADAQAAiXNlY3AyNTZrMaECr0l4v8CnYcy_n6-4EAFVgb1e_yk22NK4VcXqQAhak5yDdGNwgk2Tg3VkcIJNlYV3YWt1MgE"}'
2025-02-15 04:08:05.578 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:08:05.579 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19858/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.152.77/tcp/22856/p2p/16Uiu2HAm46aPei2zayZvFqww1LLVA1Tw8FvYJuNSrUbgpWsQwayK"]'
2025-02-15 04:08:05.618 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:05.628 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:08:05.628 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-15_04-08-03__e1d04476-7c2d-4cc6-87eb-3e3516d57e61__wakuorg_nwaku:latest.log
2025-02-15 04:08:05.628 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:08:05.628 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:08:05.630 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:08:05.630 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.197.54
2025-02-15 04:08:05.630 DEBUG [src.node.docker_mananger] Generated ports ['23769', '23770', '23771', '23772', '23773']
2025-02-15 04:08:05.630 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:08:05.630 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:08:05.631 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:08:05.631 DEBUG [src.node.docker_mananger] docker run -i -t -p 23769:23769 -p 23770:23770 -p 23771:23771 -p 23772:23772 -p 23773:23773 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23771 --rest-port=23769 --tcp-port=23770 --discv5-udp-port=23772 --rest-address=0.0.0.0 --nat=extip:172.18.197.54 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a43caa8ba07d1188eb1cc75e0aedd9efac382cd8e6dbfb55b3edd92ca0df4d60 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23773 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QOkH2orBECspOdqk57MOVZMiL8OIfJaUYyaoIC5SwocKdXbepjFwrf80IhTsiz5RKzuunei82d2x7ka5fMVLCbwCgmlkgnY0gmlwhKwSmE2KbXVsdGlhZGRyc5YACASsEphNBllIAAoErBKYTQZZSd0DgnJzhQADAQAAiXNlY3AyNTZrMaECgNTT7WQxlVXVf2lCx-InwMSUUFw2TT3eLNi8c_ijCkaDdGNwgllIg3VkcIJZSoV3YWt1Mgs --storenode=/ip4/172.18.152.77/tcp/22856/p2p/16Uiu2HAm46aPei2zayZvFqww1LLVA1Tw8FvYJuNSrUbgpWsQwayK --store=false --relay=false --lightpush=true --lightpushnode=/ip4/172.18.152.77/tcp/22856/p2p/16Uiu2HAm46aPei2zayZvFqww1LLVA1Tw8FvYJuNSrUbgpWsQwayK
2025-02-15 04:08:05.877 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.197.54 waku 022321b3bb6c6833ca1b4698e1c8f2875a471b7756acd494806da941c417accc
2025-02-15 04:08:05.925 DEBUG [src.node.docker_mananger] Container started with ID 022321b3bb6c. Setting up logs at ./log/docker/store_node1_2025-02-15_04-08-03__e1d04476-7c2d-4cc6-87eb-3e3516d57e61__wakuorg_nwaku:latest.log
2025-02-15 04:08:05.925 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23769
2025-02-15 04:08:05.925 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:08:06.926 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23769/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:06.928 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:08:06.929 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:08:06.929 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23769/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:06.931 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.197.54/tcp/23770/p2p/16Uiu2HAmSgK1po3U4NaCoYQ18qUeaucd6rPRe5ysPJmoKkASp9So","/ip4/172.18.197.54/tcp/23771/ws/p2p/16Uiu2HAmSgK1po3U4NaCoYQ18qUeaucd6rPRe5ysPJmoKkASp9So"],"enrUri":"enr:-L24QBxSPYGXm0s9Bn6iJk5i2uXhvBYUJVGXJiQCbs3144ejOwnLohLJYxhCFdurpM16qFwkDzOL6PkbaL1QUQ9fDlgCgmlkgnY0gmlwhKwSxTaKbXVsdGlhZGRyc5YACASsEsU2BlzaAAoErBLFNgZc290DgnJzhQADAQAAiXNlY3AyNTZrMaED0FpNOsOy0gytfNcXj-TvCsHXzBbRAwDe3SP1oWkNaUCDdGNwglzag3VkcIJc3IV3YWt1Mgg"}'
2025-02-15 04:08:06.931 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:08:06.932 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23769/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.152.77/tcp/22856/p2p/16Uiu2HAm46aPei2zayZvFqww1LLVA1Tw8FvYJuNSrUbgpWsQwayK"]'
2025-02-15 04:08:06.972 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:06.975 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23769/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.19.41/tcp/19859/p2p/16Uiu2HAm7DvJh59vXhcSa7fe9SaaMoRNQRXawAG84maKbSKACx5q"]'
2025-02-15 04:08:07.002 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:07.003 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22855/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:08:07.011 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:07.013 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19858/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:08:07.017 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:07.018 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23769/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739592487018240256}}'
2025-02-15 04:08:07.030 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:08:07.030 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-15 04:08:07.231 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-15 04:08:07.231 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22855/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:07.234 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3036d0dd795569c7d664035b4ca8223ae2dc45a496fdd0197e35da221fde3954"}]}'
2025-02-15 04:08:07.235 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-15 04:08:07.235 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23769/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:08:07.243 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"70304e257962ce85f742","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x3036d0dd795569c7d664035b4ca8223ae2dc45a496fdd0197e35da221fde3954"}]}'
2025-02-15 04:08:07.244 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:08:07.245 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:08:07.245 DEBUG [src.node.waku_node] Stopping container with id 5785050280cb
2025-02-15 04:08:07.784 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:08:07.784 DEBUG [src.node.waku_node] Stopping container with id 1224fa79a92c
2025-02-15 04:08:08.599 ERROR [src.node.docker_mananger] Max retries reached for container 5785050280cb. Exiting log stream.
2025-02-15 04:08:09.117 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:08:09.118 DEBUG [src.node.waku_node] Stopping container with id 022321b3bb6c
2025-02-15 04:08:09.929 ERROR [src.node.docker_mananger] Max retries reached for container 1224fa79a92c. Exiting log stream.
2025-02-15 04:08:10.610 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:08:10.610 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:08:10.621 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:08:10.627 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:08:10.634 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
