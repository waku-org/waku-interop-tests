2025-02-15 04:04:06.718 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:04:06.718 DEBUG [tests.conftest] Running test: test_relay_subscribe_to_already_existing_pubsub_topic with id: 2025-02-15_04-04-06__734385ba-9260-4980-9e94-aad7adc41095
2025-02-15 04:04:06.718 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:04:06.719 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-15 04:04:06.719 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-15 04:04:06.725 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:04:06.725 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_04-04-06__734385ba-9260-4980-9e94-aad7adc41095__wakuorg_nwaku:latest.log
2025-02-15 04:04:06.726 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:04:06.726 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:04:06.727 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:04:06.727 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.67.127
2025-02-15 04:04:06.728 DEBUG [src.node.docker_mananger] Generated ports ['62839', '62840', '62841', '62842', '62843']
2025-02-15 04:04:06.728 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:04:06.728 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:04:06.728 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:04:06.728 DEBUG [src.node.docker_mananger] docker run -i -t -p 62839:62839 -p 62840:62840 -p 62841:62841 -p 62842:62842 -p 62843:62843 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62841 --rest-port=62839 --tcp-port=62840 --discv5-udp-port=62842 --rest-address=0.0.0.0 --nat=extip:172.18.67.127 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a8e453013eeab0bb7dc9fac489f9942d974a69ea1da768f4a30e95dcecfad2a7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62843 --metrics-logging=true --relay=true
2025-02-15 04:04:06.974 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.67.127 waku ba7eb105732962b083ccb938a2f2e7e192452bc8c8845b05aa0172e810778fbc
2025-02-15 04:04:07.026 DEBUG [src.node.docker_mananger] Container started with ID ba7eb1057329. Setting up logs at ./log/docker/node1_2025-02-15_04-04-06__734385ba-9260-4980-9e94-aad7adc41095__wakuorg_nwaku:latest.log
2025-02-15 04:04:07.026 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62839
2025-02-15 04:04:07.028 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:04:07.508 ERROR [src.node.docker_mananger] Max retries reached for container 29dc0f03010c. Exiting log stream.
2025-02-15 04:04:08.028 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62839/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:08.031 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:04:08.031 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:04:08.031 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62839/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:08.033 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.67.127/tcp/62840/p2p/16Uiu2HAm8YRXuC3TeGxDcpY7VysJGpPxjnUkzip8arPUV5DpdgfK","/ip4/172.18.67.127/tcp/62841/ws/p2p/16Uiu2HAm8YRXuC3TeGxDcpY7VysJGpPxjnUkzip8arPUV5DpdgfK"],"enrUri":"enr:-L24QKGm-dtxaIiQck-EBpNJZ8MfBDLu-i2Zd6uFtK0amrtPRLqA9tSLu2AvPaLwi4qswYEvb091BgOduCnenpZZYjsCgmlkgnY0gmlwhKwSQ3-KbXVsdGlhZGRyc5YACASsEkN_BvV4AAoErBJDfwb1ed0DgnJzhQADAQAAiXNlY3AyNTZrMaECwuKpPFi1ARuZ3vdSQbhcorIFhe2vaF0OGBoE7_AcUjqDdGNwgvV4g3VkcIL1eoV3YWt1MgE"}'
2025-02-15 04:04:08.033 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:04:08.039 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:04:08.040 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-15_04-04-06__734385ba-9260-4980-9e94-aad7adc41095__wakuorg_nwaku:latest.log
2025-02-15 04:04:08.040 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:04:08.040 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:04:08.041 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:04:08.041 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.218.146
2025-02-15 04:04:08.041 DEBUG [src.node.docker_mananger] Generated ports ['8147', '8148', '8149', '8150', '8151']
2025-02-15 04:04:08.042 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:04:08.042 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:04:08.042 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:04:08.042 DEBUG [src.node.docker_mananger] docker run -i -t -p 8147:8147 -p 8148:8148 -p 8149:8149 -p 8150:8150 -p 8151:8151 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8149 --rest-port=8147 --tcp-port=8148 --discv5-udp-port=8150 --rest-address=0.0.0.0 --nat=extip:172.18.218.146 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=85e9dde6f32cbedf2bb6e33ccdaa4cb52a6dff6cc46bd17dfb5bb3b444533f4e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8151 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QKGm-dtxaIiQck-EBpNJZ8MfBDLu-i2Zd6uFtK0amrtPRLqA9tSLu2AvPaLwi4qswYEvb091BgOduCnenpZZYjsCgmlkgnY0gmlwhKwSQ3-KbXVsdGlhZGRyc5YACASsEkN_BvV4AAoErBJDfwb1ed0DgnJzhQADAQAAiXNlY3AyNTZrMaECwuKpPFi1ARuZ3vdSQbhcorIFhe2vaF0OGBoE7_AcUjqDdGNwgvV4g3VkcIL1eoV3YWt1MgE
2025-02-15 04:04:08.270 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.218.146 waku 4235799e9c8219af2925c01393a90ba60c7c8c23e21bd57fbacbf5b3d61bab14
2025-02-15 04:04:08.328 DEBUG [src.node.docker_mananger] Container started with ID 4235799e9c82. Setting up logs at ./log/docker/node2_2025-02-15_04-04-06__734385ba-9260-4980-9e94-aad7adc41095__wakuorg_nwaku:latest.log
2025-02-15 04:04:08.328 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8147
2025-02-15 04:04:08.328 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:04:09.328 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8147/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:09.331 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:04:09.331 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:04:09.331 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8147/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:09.334 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.218.146/tcp/8148/p2p/16Uiu2HAmJmXwXPCq3DAhw3C1xrhR28czib4s94g4nL9wXb2ugcs3","/ip4/172.18.218.146/tcp/8149/ws/p2p/16Uiu2HAmJmXwXPCq3DAhw3C1xrhR28czib4s94g4nL9wXb2ugcs3"],"enrUri":"enr:-L24QOvGuPdjkNBOpLBEtWn-t6FLYBqq34xtE3m0DDzuzbd3QuuCUXplzUxWKNqiuqXjtQsz3rJ4Y1j04SMmTZza0RICgmlkgnY0gmlwhKwS2pKKbXVsdGlhZGRyc5YACASsEtqSBh_UAAoErBLakgYf1d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDWtNTXFTXdqpOrK4QFUINRkAET_eJxehv9fc8qbHNqbqDdGNwgh_Ug3VkcIIf1oV3YWt1MgE"}'
2025-02-15 04:04:09.334 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:04:09.334 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8147/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.67.127/tcp/62840/p2p/16Uiu2HAm8YRXuC3TeGxDcpY7VysJGpPxjnUkzip8arPUV5DpdgfK"]'
2025-02-15 04:04:09.337 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:09.338 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62839/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:04:09.342 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:09.342 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8147/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:04:09.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:09.349 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62839/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:09.355 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:09.355 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:04:09.455 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 04:04:09.456 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62839/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:09.458 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592249348957184,"ephemeral":false}]'
2025-02-15 04:04:09.460 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:04:09.460 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8147/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:09.462 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592249348957184,"ephemeral":false}]'
2025-02-15 04:04:09.464 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62839/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:04:09.466 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:09.466 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8147/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:04:09.469 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:09.469 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62839/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:09.474 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:09.474 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:04:09.575 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 04:04:09.575 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62839/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:09.578 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592249469488640,"ephemeral":false}]'
2025-02-15 04:04:09.579 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:04:09.580 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8147/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:09.582 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592249469488640,"ephemeral":false}]'
2025-02-15 04:04:09.585 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:04:09.586 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:04:09.586 DEBUG [src.node.waku_node] Stopping container with id ba7eb1057329
2025-02-15 04:04:10.521 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:04:10.522 DEBUG [src.node.waku_node] Stopping container with id 4235799e9c82
2025-02-15 04:04:11.335 ERROR [src.node.docker_mananger] Max retries reached for container ba7eb1057329. Exiting log stream.
2025-02-15 04:04:12.029 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:04:12.030 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:04:12.036 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:04:12.041 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
