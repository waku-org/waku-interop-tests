2025-02-15 04:05:54.335 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:05:54.336 DEBUG [tests.conftest] Running test: test_main_node_only_relay__peer_only_relay with id: 2025-02-15_04-05-54__003b3af0-6634-43c7-b5e4-bfad5815bf85
2025-02-15 04:05:54.336 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:05:54.336 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-15 04:05:54.343 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:05:54.343 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-15_04-05-54__003b3af0-6634-43c7-b5e4-bfad5815bf85__wakuorg_nwaku:latest.log
2025-02-15 04:05:54.343 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:05:54.343 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:05:54.344 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:05:54.345 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.91.51
2025-02-15 04:05:54.345 DEBUG [src.node.docker_mananger] Generated ports ['62077', '62078', '62079', '62080', '62081']
2025-02-15 04:05:54.345 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:05:54.345 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:05:54.345 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:05:54.345 DEBUG [src.node.docker_mananger] docker run -i -t -p 62077:62077 -p 62078:62078 -p 62079:62079 -p 62080:62080 -p 62081:62081 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62079 --rest-port=62077 --tcp-port=62078 --discv5-udp-port=62080 --rest-address=0.0.0.0 --nat=extip:172.18.91.51 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b1b79c445b79eaee2d0a96e88e6cb7e32aa1c1e96cf458d830fabefcceeec226 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62081 --metrics-logging=true --store=false --relay=true
2025-02-15 04:05:54.576 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.91.51 waku c8b0e8cdd446bc27bbbc4b57947d597cb1a2655eede63271cdeff3e2387c6795
2025-02-15 04:05:54.628 DEBUG [src.node.docker_mananger] Container started with ID c8b0e8cdd446. Setting up logs at ./log/docker/publishing_node1_2025-02-15_04-05-54__003b3af0-6634-43c7-b5e4-bfad5815bf85__wakuorg_nwaku:latest.log
2025-02-15 04:05:54.628 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62077
2025-02-15 04:05:54.628 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:05:55.141 ERROR [src.node.docker_mananger] Max retries reached for container 7158661d7949. Exiting log stream.
2025-02-15 04:05:55.629 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62077/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:55.631 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:05:55.631 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:05:55.631 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62077/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:55.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.91.51/tcp/62078/p2p/16Uiu2HAkxT27kog8ayecVUh4iSpk32YhaDkJmXq1SMjypKbXSUd3","/ip4/172.18.91.51/tcp/62079/ws/p2p/16Uiu2HAkxT27kog8ayecVUh4iSpk32YhaDkJmXq1SMjypKbXSUd3"],"enrUri":"enr:-L24QLVqEkVOcKoC_U8wP8KPL_RVMXZtYpdICc99fCuGaZLhAAMLlj2_HPoUHolZVtjadMomI4BZBh-NQ2M8lMQHfbYCgmlkgnY0gmlwhKwSWzOKbXVsdGlhZGRyc5YACASsElszBvJ-AAoErBJbMwbyf90DgnJzhQADAQAAiXNlY3AyNTZrMaECLOtpMAsDKIlai6_DKA67Sf_Q0sQW-VmXwD-hbvDksf6DdGNwgvJ-g3VkcILygIV3YWt1MgE"}'
2025-02-15 04:05:55.634 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:05:55.640 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:05:55.640 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-15_04-05-54__003b3af0-6634-43c7-b5e4-bfad5815bf85__wakuorg_nwaku:latest.log
2025-02-15 04:05:55.640 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:05:55.640 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:05:55.642 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:05:55.642 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.243.149
2025-02-15 04:05:55.642 DEBUG [src.node.docker_mananger] Generated ports ['33677', '33678', '33679', '33680', '33681']
2025-02-15 04:05:55.642 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:05:55.642 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:05:55.642 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:05:55.643 DEBUG [src.node.docker_mananger] docker run -i -t -p 33677:33677 -p 33678:33678 -p 33679:33679 -p 33680:33680 -p 33681:33681 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33679 --rest-port=33677 --tcp-port=33678 --discv5-udp-port=33680 --rest-address=0.0.0.0 --nat=extip:172.18.243.149 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=235f4cdb0582bb2ea02b3da47dbf706dbc4e5a6ab5198ec7dadf65a7354cbe7a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33681 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QLVqEkVOcKoC_U8wP8KPL_RVMXZtYpdICc99fCuGaZLhAAMLlj2_HPoUHolZVtjadMomI4BZBh-NQ2M8lMQHfbYCgmlkgnY0gmlwhKwSWzOKbXVsdGlhZGRyc5YACASsElszBvJ-AAoErBJbMwbyf90DgnJzhQADAQAAiXNlY3AyNTZrMaECLOtpMAsDKIlai6_DKA67Sf_Q0sQW-VmXwD-hbvDksf6DdGNwgvJ-g3VkcILygIV3YWt1MgE --storenode=/ip4/172.18.91.51/tcp/62078/p2p/16Uiu2HAkxT27kog8ayecVUh4iSpk32YhaDkJmXq1SMjypKbXSUd3 --store=false --relay=true
2025-02-15 04:05:55.866 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.243.149 waku 3a0e4477c419b6b90a812dec73d6a9460ce4e46033813ed8867c260b03674a2d
2025-02-15 04:05:55.918 DEBUG [src.node.docker_mananger] Container started with ID 3a0e4477c419. Setting up logs at ./log/docker/store_node1_2025-02-15_04-05-54__003b3af0-6634-43c7-b5e4-bfad5815bf85__wakuorg_nwaku:latest.log
2025-02-15 04:05:55.918 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33677
2025-02-15 04:05:55.918 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:05:56.919 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33677/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:56.921 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:05:56.921 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:05:56.921 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33677/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:56.923 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.243.149/tcp/33678/p2p/16Uiu2HAm1KKe7YizSwGt7Yzv9pqZyEciey54qyxKvfkdzC1WiosT","/ip4/172.18.243.149/tcp/33679/ws/p2p/16Uiu2HAm1KKe7YizSwGt7Yzv9pqZyEciey54qyxKvfkdzC1WiosT"],"enrUri":"enr:-L24QIVe-lIg5Cjj7LbRACWVGxHHT9Ban0eAsNcoZBWnUz31FsBNPH3upc_2suLKO1qztKN5Da1RibvCYslVp07tKLUCgmlkgnY0gmlwhKwS85WKbXVsdGlhZGRyc5YACASsEvOVBoOOAAoErBLzlQaDj90DgnJzhQADAQAAiXNlY3AyNTZrMaECV4Wjk-fXVMLhn9vXyFA6H1_H0rsQssCCb-1RyQzD8F6DdGNwgoOOg3VkcIKDkIV3YWt1MgE"}'
2025-02-15 04:05:56.923 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:05:56.924 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33677/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.91.51/tcp/62078/p2p/16Uiu2HAkxT27kog8ayecVUh4iSpk32YhaDkJmXq1SMjypKbXSUd3"]'
2025-02-15 04:06:05.887 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:06:05.888 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62077/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:06:05.891 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:06:05.891 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33677/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 04:06:05.893 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:06:05.894 DEBUG [src.steps.store] Relaying message
2025-02-15 04:06:05.894 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62077/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:06:05.898 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:06:05.899 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-15 04:06:06.099 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-15 04:06:06.100 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33677/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:06:06.114 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":504,"statusDesc":"PEER_DIAL_FAILURE: 16Uiu2HAkxT27kog8ayecVUh4iSpk32YhaDkJmXq1SMjypKbXSUd3","messages":[]}'
2025-02-15 04:06:06.116 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:06:06.118 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:06:06.118 DEBUG [src.node.waku_node] Stopping container with id c8b0e8cdd446
2025-02-15 04:06:07.097 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:06:07.097 DEBUG [src.node.waku_node] Stopping container with id 3a0e4477c419
2025-02-15 04:06:07.926 ERROR [src.node.docker_mananger] Max retries reached for container c8b0e8cdd446. Exiting log stream.
2025-02-15 04:06:08.589 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:06:08.590 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:06:08.602 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:06:08.608 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
