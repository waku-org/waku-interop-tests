2025-02-15 04:04:10.251 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:04:10.252 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-15_04-04-10__eb8408de-bfd5-4017-855a-b03d738ef9f9
2025-02-15 04:04:10.253 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:04:10.253 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-15 04:04:10.254 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-15 04:04:10.262 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:04:10.262 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_04-04-10__eb8408de-bfd5-4017-855a-b03d738ef9f9__wakuorg_nwaku:latest.log
2025-02-15 04:04:10.262 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:04:10.263 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:04:10.266 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:04:10.267 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.181.148
2025-02-15 04:04:10.267 DEBUG [src.node.docker_mananger] Generated ports ['42192', '42193', '42194', '42195', '42196']
2025-02-15 04:04:10.267 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:04:10.267 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:04:10.268 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:04:10.268 DEBUG [src.node.docker_mananger] docker run -i -t -p 42192:42192 -p 42193:42193 -p 42194:42194 -p 42195:42195 -p 42196:42196 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42194 --rest-port=42192 --tcp-port=42193 --discv5-udp-port=42195 --rest-address=0.0.0.0 --nat=extip:172.18.181.148 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9b72d4ba6be2ff2bd9c2e5d19ccfe0bedf9663d64edc7f8c696dc5dd27f35ee9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42196 --metrics-logging=true --relay=true
2025-02-15 04:04:10.487 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.181.148 waku 461bf5137d37880db613e3a6afae9c7d16cc344c80c0aade03a8e7e7fd89f5a9
2025-02-15 04:04:10.532 DEBUG [src.node.docker_mananger] Container started with ID 461bf5137d37. Setting up logs at ./log/docker/node1_2025-02-15_04-04-10__eb8408de-bfd5-4017-855a-b03d738ef9f9__wakuorg_nwaku:latest.log
2025-02-15 04:04:10.533 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42192
2025-02-15 04:04:10.534 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:04:11.076 ERROR [src.node.docker_mananger] Max retries reached for container b4fe21355792. Exiting log stream.
2025-02-15 04:04:11.534 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42192/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:11.536 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:04:11.537 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:04:11.537 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42192/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:11.539 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.181.148/tcp/42193/p2p/16Uiu2HAmQRBnSyFgUQZYSTP4TyPtJoq8fiw8mBKvoq2aJLhNvZMX","/ip4/172.18.181.148/tcp/42194/ws/p2p/16Uiu2HAmQRBnSyFgUQZYSTP4TyPtJoq8fiw8mBKvoq2aJLhNvZMX"],"enrUri":"enr:-L24QF9Hlyzb5j9KIehTnyDSSYAU4ofIQqh_0ATo9_HAsFTEZuAJLfCrype9qDHmh3Imvy_WhKGd0k772zpydl3VPQ4CgmlkgnY0gmlwhKwStZSKbXVsdGlhZGRyc5YACASsErWUBqTRAAoErBK1lAak0t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDrsMKPRpIa2PKZYSDzD0GyKR8J_jR9d7wtVHX4mTkav6DdGNwgqTRg3VkcIKk04V3YWt1MgE"}'
2025-02-15 04:04:11.539 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:04:11.545 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:04:11.545 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-15_04-04-10__eb8408de-bfd5-4017-855a-b03d738ef9f9__wakuorg_nwaku:latest.log
2025-02-15 04:04:11.545 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:04:11.545 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:04:11.547 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:04:11.547 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.158.35
2025-02-15 04:04:11.547 DEBUG [src.node.docker_mananger] Generated ports ['61563', '61564', '61565', '61566', '61567']
2025-02-15 04:04:11.547 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:04:11.547 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:04:11.547 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:04:11.547 DEBUG [src.node.docker_mananger] docker run -i -t -p 61563:61563 -p 61564:61564 -p 61565:61565 -p 61566:61566 -p 61567:61567 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61565 --rest-port=61563 --tcp-port=61564 --discv5-udp-port=61566 --rest-address=0.0.0.0 --nat=extip:172.18.158.35 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cc8fe5ea06c2dc1369b45a7d56c270edcfb739c1dce7bf36e5bbe9b1eaba2a76 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61567 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QF9Hlyzb5j9KIehTnyDSSYAU4ofIQqh_0ATo9_HAsFTEZuAJLfCrype9qDHmh3Imvy_WhKGd0k772zpydl3VPQ4CgmlkgnY0gmlwhKwStZSKbXVsdGlhZGRyc5YACASsErWUBqTRAAoErBK1lAak0t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDrsMKPRpIa2PKZYSDzD0GyKR8J_jR9d7wtVHX4mTkav6DdGNwgqTRg3VkcIKk04V3YWt1MgE
2025-02-15 04:04:11.774 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.158.35 waku 9be14b4bbdc4852e0484dcec5a29963a031f70ee7a3312854eb99aa43bd879ea
2025-02-15 04:04:11.821 DEBUG [src.node.docker_mananger] Container started with ID 9be14b4bbdc4. Setting up logs at ./log/docker/node2_2025-02-15_04-04-10__eb8408de-bfd5-4017-855a-b03d738ef9f9__wakuorg_nwaku:latest.log
2025-02-15 04:04:11.821 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61563
2025-02-15 04:04:11.821 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:04:12.822 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61563/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:12.838 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:04:12.839 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:04:12.839 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61563/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:12.845 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.35/tcp/61564/p2p/16Uiu2HAkwJisucr5P5bz5jWQG8zNDcDmakb5Y6vDJXLD5rL9nGhs","/ip4/172.18.158.35/tcp/61565/ws/p2p/16Uiu2HAkwJisucr5P5bz5jWQG8zNDcDmakb5Y6vDJXLD5rL9nGhs"],"enrUri":"enr:-L24QN0SNuvFhFq3O6Ud1_nDpfo7w6ENRxLD0-xiAnLW20H8KfsBgIIsXadjcg03ksjNo1kvOhG7Gm_-gsbsFVjHFJYCgmlkgnY0gmlwhKwSniOKbXVsdGlhZGRyc5YACASsEp4jBvB8AAoErBKeIwbwfd0DgnJzhQADAQAAiXNlY3AyNTZrMaECG--V53QsLYp8iKClDcLJfYKhzKJip_L0DsAPbHxwQQaDdGNwgvB8g3VkcILwfoV3YWt1MgE"}'
2025-02-15 04:04:12.846 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:04:12.848 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61563/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.181.148/tcp/42193/p2p/16Uiu2HAmQRBnSyFgUQZYSTP4TyPtJoq8fiw8mBKvoq2aJLhNvZMX"]'
2025-02-15 04:04:12.853 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:12.853 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-15 04:04:12.853 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42192/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:04:12.858 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:12.858 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61563/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:04:12.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:12.865 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:12.870 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:04:12.870 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:04:12.971 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 04:04:12.971 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:12.974 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592252865074432,"ephemeral":false}]'
2025-02-15 04:04:12.976 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:04:12.976 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61563/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:04:12.978 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592252865074432,"ephemeral":false}]'
2025-02-15 04:04:12.980 INFO [src.steps.relay] WARM UP successful!!
2025-02-15 04:04:12.981 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-15 04:04:12.981 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:12.983 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-15 04:04:12.983 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-15 04:04:12.984 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:12.986 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-15 04:04:12.986 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-15 04:04:12.986 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:12.989 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-15 04:04:12.989 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-15 04:04:12.989 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:12.991 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-15 04:04:12.992 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-15 04:04:12.992 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-15 04:04:12.994 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:42192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-15 04:04:12.996 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:04:12.997 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:04:12.997 DEBUG [src.node.waku_node] Stopping container with id 461bf5137d37
2025-02-15 04:04:13.695 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:04:13.695 DEBUG [src.node.waku_node] Stopping container with id 9be14b4bbdc4
2025-02-15 04:04:14.331 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:04:14.334 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:04:14.342 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:04:14.348 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
