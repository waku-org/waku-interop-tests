2025-02-15 04:02:20.865 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:02:20.865 DEBUG [tests.conftest] Running test: test_relay with id: 2025-02-15_04-02-20__cf42fdba-912d-43dc-a9e5-7ad426379be2
2025-02-15 04:02:20.865 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:02:20.866 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-15 04:02:20.866 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-15 04:02:20.866 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-15 04:02:20.866 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-15 04:02:20.874 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:02:20.875 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_04-02-20__cf42fdba-912d-43dc-a9e5-7ad426379be2__wakuorg_nwaku:latest.log
2025-02-15 04:02:20.875 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:02:20.875 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:02:20.938 DEBUG [src.node.docker_mananger] Network waku created
2025-02-15 04:02:20.938 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.168.39
2025-02-15 04:02:20.938 DEBUG [src.node.docker_mananger] Generated ports ['27105', '27106', '27107', '27108', '27109']
2025-02-15 04:02:20.939 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:02:20.939 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:02:20.939 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:02:20.939 DEBUG [src.node.docker_mananger] docker run -i -t -p 27105:27105 -p 27106:27106 -p 27107:27107 -p 27108:27108 -p 27109:27109 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27107 --rest-port=27105 --tcp-port=27106 --discv5-udp-port=27108 --rest-address=0.0.0.0 --nat=extip:172.18.168.39 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=92f8b35cfdfce3eeedd7fe784ea11e7fb1daa5c07893d51bf9d95193dbbb31ec --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27109 --metrics-logging=true --relay=true
2025-02-15 04:02:22.912 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.168.39 waku 961ee95fc10e49805d48fc04877f240da0b472c32bb4891c179aa3191ca924aa
2025-02-15 04:02:22.965 DEBUG [src.node.docker_mananger] Container started with ID 961ee95fc10e. Setting up logs at ./log/docker/node1_2025-02-15_04-02-20__cf42fdba-912d-43dc-a9e5-7ad426379be2__wakuorg_nwaku:latest.log
2025-02-15 04:02:22.966 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 27105
2025-02-15 04:02:22.966 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:02:23.967 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27105/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:23.970 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:02:23.970 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:02:23.970 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27105/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:23.972 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.168.39/tcp/27106/p2p/16Uiu2HAmTphuNHT6h54c86HpjnYLYrrKC74uxQVg1H4tEMj5k9nV","/ip4/172.18.168.39/tcp/27107/ws/p2p/16Uiu2HAmTphuNHT6h54c86HpjnYLYrrKC74uxQVg1H4tEMj5k9nV"],"enrUri":"enr:-L24QCfs_h4v5dH0rdPm0KKLu1Ln7aroYV4-krfxspQP_WN4VM9SAc_AAVy6Yrl05kqTlMwJ2y8ElyTVaFs_VGZSR-cCgmlkgnY0gmlwhKwSqCeKbXVsdGlhZGRyc5YACASsEqgnBmniAAoErBKoJwZp490DgnJzhQADAQAAiXNlY3AyNTZrMaED4VyD7-9UmA28wmyEcXTrhHLYdglZMQd9nGFzRQczjyaDdGNwgmnig3VkcIJp5IV3YWt1MgE"}'
2025-02-15 04:02:23.973 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:02:23.982 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:02:23.982 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_04-02-20__cf42fdba-912d-43dc-a9e5-7ad426379be2__wakuorg_nwaku:latest.log
2025-02-15 04:02:23.982 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:02:23.982 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:02:23.984 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:02:23.984 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.107.185
2025-02-15 04:02:23.984 DEBUG [src.node.docker_mananger] Generated ports ['20231', '20232', '20233', '20234', '20235']
2025-02-15 04:02:23.984 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:02:23.984 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:02:23.984 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:02:23.985 DEBUG [src.node.docker_mananger] docker run -i -t -p 20231:20231 -p 20232:20232 -p 20233:20233 -p 20234:20234 -p 20235:20235 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20233 --rest-port=20231 --tcp-port=20232 --discv5-udp-port=20234 --rest-address=0.0.0.0 --nat=extip:172.18.107.185 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=75f697e693a607abfff0ca1f90fc5b3dceb57ff35141e7beed6ef524de4860fe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20235 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QCfs_h4v5dH0rdPm0KKLu1Ln7aroYV4-krfxspQP_WN4VM9SAc_AAVy6Yrl05kqTlMwJ2y8ElyTVaFs_VGZSR-cCgmlkgnY0gmlwhKwSqCeKbXVsdGlhZGRyc5YACASsEqgnBmniAAoErBKoJwZp490DgnJzhQADAQAAiXNlY3AyNTZrMaED4VyD7-9UmA28wmyEcXTrhHLYdglZMQd9nGFzRQczjyaDdGNwgmnig3VkcIJp5IV3YWt1MgE
2025-02-15 04:02:24.209 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.107.185 waku 2fa6d94a0807629bdbd55137dea328bbf02925846af23e0310f08690ef0352e9
2025-02-15 04:02:24.259 DEBUG [src.node.docker_mananger] Container started with ID 2fa6d94a0807. Setting up logs at ./log/docker/node1_2025-02-15_04-02-20__cf42fdba-912d-43dc-a9e5-7ad426379be2__wakuorg_nwaku:latest.log
2025-02-15 04:02:24.259 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20231
2025-02-15 04:02:24.259 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:02:25.260 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20231/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:25.268 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:02:25.268 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:02:25.269 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20231/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:25.271 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.107.185/tcp/20232/p2p/16Uiu2HAkxTPYtVs4Ugi9PqXCbTu8tx4RgAcbM2zV2Ewbeo1ucuLd","/ip4/172.18.107.185/tcp/20233/ws/p2p/16Uiu2HAkxTPYtVs4Ugi9PqXCbTu8tx4RgAcbM2zV2Ewbeo1ucuLd"],"enrUri":"enr:-L24QOHhy1XIXZyupOLumge1zWbeYMfeUTG0OBzMtiowzackeD3Il66v9jZs9LNytAK7-rVkiUQggcRGR7kfznL-1jkCgmlkgnY0gmlwhKwSa7mKbXVsdGlhZGRyc5YACASsEmu5Bk8IAAoErBJruQZPCd0DgnJzhQADAQAAiXNlY3AyNTZrMaECLQOlR4yKNNu8T9xnqi8380bdoOyVzpBCBUdYdkgByHqDdGNwgk8Ig3VkcIJPCoV3YWt1MgE"}'
2025-02-15 04:02:25.271 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:02:25.271 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27105/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:02:25.275 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:25.276 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20231/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:02:25.282 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:25.282 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27105/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 04:02:25.288 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:02:25.289 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 04:02:25.389 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 04:02:25.389 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27105/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:25.392 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592145282723328,"ephemeral":false}]'
2025-02-15 04:02:25.393 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-15 04:02:25.394 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20231/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:02:25.396 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592145282723328,"ephemeral":false}]'
2025-02-15 04:02:25.399 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:02:25.400 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:02:25.400 DEBUG [src.node.waku_node] Stopping container with id 961ee95fc10e
2025-02-15 04:02:26.416 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:02:26.417 DEBUG [src.node.waku_node] Stopping container with id 2fa6d94a0807
2025-02-15 04:02:27.227 ERROR [src.node.docker_mananger] Max retries reached for container 961ee95fc10e. Exiting log stream.
2025-02-15 04:02:27.904 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:02:27.905 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:02:27.914 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:02:27.919 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
