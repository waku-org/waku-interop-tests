2025-02-15 04:05:23.294 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 04:05:23.295 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-15_04-05-23__f98a02c3-62d4-4f1a-aff2-5967ec3f4223
2025-02-15 04:05:23.297 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 04:05:23.297 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-15 04:05:23.297 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-15 04:05:23.298 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-15 04:05:23.298 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-15 04:05:23.307 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:05:23.308 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-15_04-05-23__f98a02c3-62d4-4f1a-aff2-5967ec3f4223__wakuorg_nwaku:latest.log
2025-02-15 04:05:23.308 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:05:23.308 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:05:23.310 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:05:23.310 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.85.42
2025-02-15 04:05:23.310 DEBUG [src.node.docker_mananger] Generated ports ['53371', '53372', '53373', '53374', '53375']
2025-02-15 04:05:23.310 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:05:23.311 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:05:23.311 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:05:23.311 DEBUG [src.node.docker_mananger] docker run -i -t -p 53371:53371 -p 53372:53372 -p 53373:53373 -p 53374:53374 -p 53375:53375 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53373 --rest-port=53371 --tcp-port=53372 --discv5-udp-port=53374 --rest-address=0.0.0.0 --nat=extip:172.18.85.42 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ae32deab0cdcbadaaaf836f3b16cffe8fa2cddf2ba2f8fffeabaf7d8b3f821fd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53375 --metrics-logging=true --lightpush=true --relay=true
2025-02-15 04:05:23.537 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.85.42 waku 1cbbf02416fc0ab1c3bb3039ebbd76f0d34e3ff7e17f9476c1d710ddb5b9e0d7
2025-02-15 04:05:23.595 DEBUG [src.node.docker_mananger] Container started with ID 1cbbf02416fc. Setting up logs at ./log/docker/receiving_node1_2025-02-15_04-05-23__f98a02c3-62d4-4f1a-aff2-5967ec3f4223__wakuorg_nwaku:latest.log
2025-02-15 04:05:23.596 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53371
2025-02-15 04:05:23.596 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:05:24.129 ERROR [src.node.docker_mananger] Max retries reached for container a5af0db47d9b. Exiting log stream.
2025-02-15 04:05:24.597 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53371/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:24.600 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:05:24.600 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:05:24.600 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53371/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:24.602 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.85.42/tcp/53372/p2p/16Uiu2HAkyV7UUjSxG8XVW4zC9NV8jRFKMq8aTmWUoxb7qMhy5f19","/ip4/172.18.85.42/tcp/53373/ws/p2p/16Uiu2HAkyV7UUjSxG8XVW4zC9NV8jRFKMq8aTmWUoxb7qMhy5f19"],"enrUri":"enr:-L24QHE8ybfdyJ8OWldYBDJGT25aF6svxVECoSrb1E4BJsB_c5Lr_Llf1eplYrRw2cpg11MyO4X2FOgfkHDxeMD6YXACgmlkgnY0gmlwhKwSVSqKbXVsdGlhZGRyc5YACASsElUqBtB8AAoErBJVKgbQfd0DgnJzhQADAQAAiXNlY3AyNTZrMaECPFBRIx7CPgzEx1yMwvQruaPMmgk68hcP-kVt86Q5Q4CDdGNwgtB8g3VkcILQfoV3YWt1Mgk"}'
2025-02-15 04:05:24.603 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:05:24.609 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:05:24.609 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-15_04-05-23__f98a02c3-62d4-4f1a-aff2-5967ec3f4223__wakuorg_nwaku:latest.log
2025-02-15 04:05:24.610 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:05:24.610 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:05:24.611 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:05:24.611 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.227.53
2025-02-15 04:05:24.611 DEBUG [src.node.docker_mananger] Generated ports ['42814', '42815', '42816', '42817', '42818']
2025-02-15 04:05:24.612 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:05:24.612 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:05:24.612 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:05:24.612 DEBUG [src.node.docker_mananger] docker run -i -t -p 42814:42814 -p 42815:42815 -p 42816:42816 -p 42817:42817 -p 42818:42818 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42816 --rest-port=42814 --tcp-port=42815 --discv5-udp-port=42817 --rest-address=0.0.0.0 --nat=extip:172.18.227.53 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=50bb5bdcbd0a4a913ffdeaa79cde0fd6f5aca6e5ee0526fe7602002bdaa5fd9d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42818 --metrics-logging=true --lightpush=false --relay=true
2025-02-15 04:05:24.836 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.227.53 waku 02cbc5b17dbff267ba0b5e960a8dadc2b479b4b70742fd37abcdb645a6af74a5
2025-02-15 04:05:24.884 DEBUG [src.node.docker_mananger] Container started with ID 02cbc5b17dbf. Setting up logs at ./log/docker/receiving_node2_2025-02-15_04-05-23__f98a02c3-62d4-4f1a-aff2-5967ec3f4223__wakuorg_nwaku:latest.log
2025-02-15 04:05:24.885 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42814
2025-02-15 04:05:24.885 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:05:25.887 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42814/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:25.890 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:05:25.890 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:05:25.891 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42814/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:25.893 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.227.53/tcp/42815/p2p/16Uiu2HAmBj9Tk9ScQUNu6Y3UdCWMw1BqBnwdktdwt6ea2ArBoadG","/ip4/172.18.227.53/tcp/42816/ws/p2p/16Uiu2HAmBj9Tk9ScQUNu6Y3UdCWMw1BqBnwdktdwt6ea2ArBoadG"],"enrUri":"enr:-L24QFkg7GEicHEcvAd6OyTt9SDddBovPjd4zVT-aPh2CSu1Zb3mmnmwkyeTTsHCPCz7nR-sVCwiopyC8vv869Fr3mACgmlkgnY0gmlwhKwS4zWKbXVsdGlhZGRyc5YACASsEuM1Bqc_AAoErBLjNQanQN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC8jTwQCGywXoH4gH2LeS_nUq8ZMGOKtzr9C4EgW7IZQuDdGNwgqc_g3VkcIKnQYV3YWt1MgE"}'
2025-02-15 04:05:25.893 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:05:25.893 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42814/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.85.42/tcp/53372/p2p/16Uiu2HAkyV7UUjSxG8XVW4zC9NV8jRFKMq8aTmWUoxb7qMhy5f19"]'
2025-02-15 04:05:25.931 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:25.939 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 04:05:25.940 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-15_04-05-23__f98a02c3-62d4-4f1a-aff2-5967ec3f4223__wakuorg_nwaku:latest.log
2025-02-15 04:05:25.940 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 04:05:25.940 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 04:05:25.942 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 04:05:25.942 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.98.221
2025-02-15 04:05:25.942 DEBUG [src.node.docker_mananger] Generated ports ['9479', '9480', '9481', '9482', '9483']
2025-02-15 04:05:25.942 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 04:05:25.942 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 04:05:25.942 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 04:05:25.943 DEBUG [src.node.docker_mananger] docker run -i -t -p 9479:9479 -p 9480:9480 -p 9481:9481 -p 9482:9482 -p 9483:9483 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9481 --rest-port=9479 --tcp-port=9480 --discv5-udp-port=9482 --rest-address=0.0.0.0 --nat=extip:172.18.98.221 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0bd68223ceb0e1777707463d374aed001fd3fcd8eb592dfccbcdfb51fe024da3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9483 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHE8ybfdyJ8OWldYBDJGT25aF6svxVECoSrb1E4BJsB_c5Lr_Llf1eplYrRw2cpg11MyO4X2FOgfkHDxeMD6YXACgmlkgnY0gmlwhKwSVSqKbXVsdGlhZGRyc5YACASsElUqBtB8AAoErBJVKgbQfd0DgnJzhQADAQAAiXNlY3AyNTZrMaECPFBRIx7CPgzEx1yMwvQruaPMmgk68hcP-kVt86Q5Q4CDdGNwgtB8g3VkcILQfoV3YWt1Mgk --lightpushnode=/ip4/172.18.85.42/tcp/53372/p2p/16Uiu2HAkyV7UUjSxG8XVW4zC9NV8jRFKMq8aTmWUoxb7qMhy5f19 --lightpush=true --relay=false
2025-02-15 04:05:26.203 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.98.221 waku 457fc4612cfaee89999b654eacf72bab72449c860bff9c3586423b8c7def8d36
2025-02-15 04:05:26.254 DEBUG [src.node.docker_mananger] Container started with ID 457fc4612cfa. Setting up logs at ./log/docker/lightpush_node1_2025-02-15_04-05-23__f98a02c3-62d4-4f1a-aff2-5967ec3f4223__wakuorg_nwaku:latest.log
2025-02-15 04:05:26.255 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 9479
2025-02-15 04:05:26.256 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 04:05:27.256 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9479/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:27.259 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 04:05:27.260 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 04:05:27.260 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9479/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:27.262 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.98.221/tcp/9480/p2p/16Uiu2HAmSoe7qtymfa83jmv6sdmeJDTMmhaS9UpeTguoe37V37G6","/ip4/172.18.98.221/tcp/9481/ws/p2p/16Uiu2HAmSoe7qtymfa83jmv6sdmeJDTMmhaS9UpeTguoe37V37G6"],"enrUri":"enr:-L24QFlre1CRthTeBIZ-DV5o29HMMoP9W3qR2tW-4QAsBip6TARKOCBY1sIyCOHIonfrjVv9eJrleJ9I_nPsOMcjXJgCgmlkgnY0gmlwhKwSYt2KbXVsdGlhZGRyc5YACASsEmLdBiUIAAoErBJi3QYlCd0DgnJzhQADAQAAiXNlY3AyNTZrMaED0jr30hyRXGJbmoJ9HPiZTceFMmRfYMilChA8EdWgmRODdGNwgiUIg3VkcIIlCoV3YWt1Mgg"}'
2025-02-15 04:05:27.262 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 04:05:27.262 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9479/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.85.42/tcp/53372/p2p/16Uiu2HAkyV7UUjSxG8XVW4zC9NV8jRFKMq8aTmWUoxb7qMhy5f19"]'
2025-02-15 04:05:27.304 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:27.306 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9479/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.227.53/tcp/42815/p2p/16Uiu2HAmBj9Tk9ScQUNu6Y3UdCWMw1BqBnwdktdwt6ea2ArBoadG"]'
2025-02-15 04:05:27.334 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:27.335 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53371/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:05:27.345 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:27.346 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42814/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 04:05:27.353 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:27.359 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9479/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1739592327359104768}}'
2025-02-15 04:05:27.370 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 04:05:27.370 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-15 04:05:27.871 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53371/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 04:05:27.874 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739592327359104768,"ephemeral":false}]'
2025-02-15 04:05:27.874 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-15 04:05:32.875 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.85.42/tcp/53372"} has 1
2025-02-15 04:05:32.879 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.85.42/tcp/53372"} with value 1.0
2025-02-15 04:05:32.879 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-15 04:05:32.882 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-15 04:05:32.883 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-15 04:05:32.886 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-15 04:05:32.886 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-15 04:05:32.889 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-15 04:05:32.890 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-15 04:05:32.893 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-15 04:05:32.893 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-15 04:05:32.896 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-15 04:05:32.896 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-15 04:05:32.899 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-15 04:05:32.899 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-15 04:05:32.902 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-15 04:05:32.903 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-15 04:05:32.906 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-15 04:05:32.906 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-15 04:05:32.909 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-15 04:05:32.911 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 04:05:32.912 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 04:05:32.912 DEBUG [src.node.waku_node] Stopping container with id 1cbbf02416fc
2025-02-15 04:05:33.850 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:05:33.852 DEBUG [src.node.waku_node] Stopping container with id 02cbc5b17dbf
2025-02-15 04:05:34.663 ERROR [src.node.docker_mananger] Max retries reached for container 1cbbf02416fc. Exiting log stream.
2025-02-15 04:05:35.360 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:05:35.362 DEBUG [src.node.waku_node] Stopping container with id 457fc4612cfa
2025-02-15 04:05:36.175 ERROR [src.node.docker_mananger] Max retries reached for container 02cbc5b17dbf. Exiting log stream.
2025-02-15 04:05:36.880 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 04:05:36.882 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 04:05:36.890 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:05:36.898 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 04:05:36.904 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
