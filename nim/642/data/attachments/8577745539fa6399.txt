2025-02-06 04:04:27.586 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:04:27.586 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/5/1] with id: 2025-02-06_04-04-27__59db9d83-e79d-4c62-a4c5-e7bba96b20a8
2025-02-06 04:04:27.586 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:04:27.586 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-06 04:04:27.587 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-06 04:04:27.593 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:04:27.594 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_04-04-27__59db9d83-e79d-4c62-a4c5-e7bba96b20a8__wakuorg_nwaku:latest.log
2025-02-06 04:04:27.594 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:04:27.594 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:04:27.595 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:04:27.595 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.217.72
2025-02-06 04:04:27.596 DEBUG [src.node.docker_mananger] Generated ports ['10808', '10809', '10810', '10811', '10812']
2025-02-06 04:04:27.596 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-06 04:04:27.596 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:04:27.596 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:04:27.596 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:04:27.596 DEBUG [src.node.docker_mananger] docker run -i -t -p 10808:10808 -p 10809:10809 -p 10810:10810 -p 10811:10811 -p 10812:10812 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10810 --rest-port=10808 --tcp-port=10809 --discv5-udp-port=10811 --rest-address=0.0.0.0 --nat=extip:172.18.217.72 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=c0db8feafe3e403827beb9bb8e17292beb0de73141e726efd8813ebcfddf6b9d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10812 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/5/1
2025-02-06 04:04:27.831 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.217.72 waku c200c0c82fde92a443f7f0675ccd8965758225fcf64d36a40d7eb8384395992c
2025-02-06 04:04:27.886 DEBUG [src.node.docker_mananger] Container started with ID c200c0c82fde. Setting up logs at ./log/docker/node1_2025-02-06_04-04-27__59db9d83-e79d-4c62-a4c5-e7bba96b20a8__wakuorg_nwaku:latest.log
2025-02-06 04:04:27.888 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10808
2025-02-06 04:04:27.888 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:04:28.391 ERROR [src.node.docker_mananger] Max retries reached for container a27f5fda784a. Exiting log stream.
2025-02-06 04:04:28.888 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10808/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:28.891 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:04:28.892 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:04:28.892 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10808/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:28.894 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.217.72/tcp/10809/p2p/16Uiu2HAkukaqkpzzmrWKP7nPNEvH1A9poJgvKBh6XhGFn8aGU1XU","/ip4/172.18.217.72/tcp/10810/ws/p2p/16Uiu2HAkukaqkpzzmrWKP7nPNEvH1A9poJgvKBh6XhGFn8aGU1XU"],"enrUri":"enr:-L24QC1xokM4MdBjoR9hbniQM7FRTfY6yPYjCKcQWGwV1Km8c1wfnA5K3UdMoHpnZocpROa3nbufaTIjE4GVdiKcuyACgmlkgnY0gmlwhKwS2UiKbXVsdGlhZGRyc5YACASsEtlIBio5AAoErBLZSAYqOt0DgnJzhQAFAQABiXNlY3AyNTZrMaECBNg5pO8uBrXsAfTYFd7zcCiKbrdOf6Najpe68qbAju-DdGNwgio5g3VkcIIqO4V3YWt1MgU"}'
2025-02-06 04:04:28.894 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:04:28.901 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:04:28.901 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_04-04-27__59db9d83-e79d-4c62-a4c5-e7bba96b20a8__wakuorg_nwaku:latest.log
2025-02-06 04:04:28.901 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:04:28.901 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:04:28.902 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:04:28.903 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.121.215
2025-02-06 04:04:28.903 DEBUG [src.node.docker_mananger] Generated ports ['10701', '10702', '10703', '10704', '10705']
2025-02-06 04:04:28.903 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-06 04:04:28.903 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:04:28.903 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:04:28.903 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:04:28.903 DEBUG [src.node.docker_mananger] docker run -i -t -p 10701:10701 -p 10702:10702 -p 10703:10703 -p 10704:10704 -p 10705:10705 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10703 --rest-port=10701 --tcp-port=10702 --discv5-udp-port=10704 --rest-address=0.0.0.0 --nat=extip:172.18.121.215 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=fecff2c74ceafa9b17bd4dfcd0c76cea5cfd0edfcad40e984f5fa7fb30f44914 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10705 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QC1xokM4MdBjoR9hbniQM7FRTfY6yPYjCKcQWGwV1Km8c1wfnA5K3UdMoHpnZocpROa3nbufaTIjE4GVdiKcuyACgmlkgnY0gmlwhKwS2UiKbXVsdGlhZGRyc5YACASsEtlIBio5AAoErBLZSAYqOt0DgnJzhQAFAQABiXNlY3AyNTZrMaECBNg5pO8uBrXsAfTYFd7zcCiKbrdOf6Najpe68qbAju-DdGNwgio5g3VkcIIqO4V3YWt1MgU --pubsub-topic=/waku/2/rs/5/1
2025-02-06 04:04:29.130 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.121.215 waku 5dc3654b310cfaeae8a87556c5dffc946f888dfdfef47fe37d5832ebe96ad0a2
2025-02-06 04:04:29.184 DEBUG [src.node.docker_mananger] Container started with ID 5dc3654b310c. Setting up logs at ./log/docker/node2_2025-02-06_04-04-27__59db9d83-e79d-4c62-a4c5-e7bba96b20a8__wakuorg_nwaku:latest.log
2025-02-06 04:04:29.184 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10701
2025-02-06 04:04:29.185 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:04:30.186 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10701/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:30.194 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:04:30.194 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:04:30.195 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10701/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:30.198 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.121.215/tcp/10702/p2p/16Uiu2HAmUYgJiRr9PcB4JrjjzWP6jiANicvpcbzqAYvKLfo2ugC7","/ip4/172.18.121.215/tcp/10703/ws/p2p/16Uiu2HAmUYgJiRr9PcB4JrjjzWP6jiANicvpcbzqAYvKLfo2ugC7"],"enrUri":"enr:-L24QIpE4-QcuOU-DX7QXGvyA82UTJJQ8i0ZNOVXJEXc1xV6ENizZst9EVlFWsRZee-In5O4CTNYzBhn1JaOQe9kBusCgmlkgnY0gmlwhKwSedeKbXVsdGlhZGRyc5YACASsEnnXBinOAAoErBJ51wYpz90DgnJzhQAFAQABiXNlY3AyNTZrMaED7B0aZT2jreEVP7Y8S7QARVVCfiNsP9bDPppRYHj97_CDdGNwginOg3VkcIIp0IV3YWt1MgE"}'
2025-02-06 04:04:30.198 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:04:30.199 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10701/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.217.72/tcp/10809/p2p/16Uiu2HAkukaqkpzzmrWKP7nPNEvH1A9poJgvKBh6XhGFn8aGU1XU"]'
2025-02-06 04:04:30.202 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:30.202 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10808/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/1"]'
2025-02-06 04:04:30.204 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:30.205 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10701/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/1"]'
2025-02-06 04:04:30.207 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:30.207 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10808/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 04:04:30.213 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:30.213 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:04:30.314 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 04:04:30.314 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10808/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:30.317 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814670207816960,"ephemeral":false}]'
2025-02-06 04:04:30.319 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-06 04:04:30.319 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10701/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:30.321 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814670207816960,"ephemeral":false}]'
2025-02-06 04:04:30.324 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:04:30.325 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:04:30.325 DEBUG [src.node.waku_node] Stopping container with id c200c0c82fde
2025-02-06 04:04:31.363 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:04:31.365 DEBUG [src.node.waku_node] Stopping container with id 5dc3654b310c
2025-02-06 04:04:32.190 ERROR [src.node.docker_mananger] Max retries reached for container c200c0c82fde. Exiting log stream.
2025-02-06 04:04:32.861 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:04:32.862 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:04:32.870 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:04:32.875 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
