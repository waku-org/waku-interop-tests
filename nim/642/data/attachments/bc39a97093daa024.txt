2025-02-06 04:02:59.272 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:02:59.272 DEBUG [tests.conftest] Running test: test_filter_update_subscription_with_invalid_content_topic_format with id: 2025-02-06_04-02-59__1c57f57e-3f6a-4bc9-8739-ecc60ad768f5
2025-02-06 04:02:59.272 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:02:59.273 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-06 04:02:59.273 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-06 04:02:59.279 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:02:59.279 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_04-02-59__1c57f57e-3f6a-4bc9-8739-ecc60ad768f5__wakuorg_nwaku:latest.log
2025-02-06 04:02:59.280 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:02:59.280 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:02:59.281 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:02:59.281 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.146.145
2025-02-06 04:02:59.281 DEBUG [src.node.docker_mananger] Generated ports ['52758', '52759', '52760', '52761', '52762']
2025-02-06 04:02:59.282 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:02:59.282 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:02:59.282 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:02:59.282 DEBUG [src.node.docker_mananger] docker run -i -t -p 52758:52758 -p 52759:52759 -p 52760:52760 -p 52761:52761 -p 52762:52762 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52760 --rest-port=52758 --tcp-port=52759 --discv5-udp-port=52761 --rest-address=0.0.0.0 --nat=extip:172.18.146.145 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fdda26f8de9e7ff4b39e20e59ddcf082367daad9c9d7a80e22fd8de82fd4ca0c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52762 --metrics-logging=true --relay=true --filter=true
2025-02-06 04:02:59.517 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.146.145 waku dff996790cdb1d9d99d7c5ffa2b1717914ce099f2aa076867fa3ebae0110385c
2025-02-06 04:02:59.569 DEBUG [src.node.docker_mananger] Container started with ID dff996790cdb. Setting up logs at ./log/docker/node1_2025-02-06_04-02-59__1c57f57e-3f6a-4bc9-8739-ecc60ad768f5__wakuorg_nwaku:latest.log
2025-02-06 04:02:59.569 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 52758
2025-02-06 04:02:59.570 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:03:00.073 ERROR [src.node.docker_mananger] Max retries reached for container a49c903b2e89. Exiting log stream.
2025-02-06 04:03:00.571 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:52758/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:00.574 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:03:00.574 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:03:00.574 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:52758/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:00.577 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.146.145/tcp/52759/p2p/16Uiu2HAm84wx9jNEPNwhyAGLYbqKS2WPhUxDqh9qrA47bLomne4o","/ip4/172.18.146.145/tcp/52760/ws/p2p/16Uiu2HAm84wx9jNEPNwhyAGLYbqKS2WPhUxDqh9qrA47bLomne4o"],"enrUri":"enr:-L24QBwx6-Y9Gk8EYlFOOtwWRsVtA0Kk0j4KPkkzNoEN3YW4emsnKAOmiusj5VJoAvCs864N4N9O0VeqrUGpn7pNx9ICgmlkgnY0gmlwhKwSkpGKbXVsdGlhZGRyc5YACASsEpKRBs4XAAoErBKSkQbOGN0DgnJzhQADAQAAiXNlY3AyNTZrMaECu9jK0-M4GpxCJ8ORk41HE8W8HI88iyYE1fWA4oYVXViDdGNwgs4Xg3VkcILOGYV3YWt1MgU"}'
2025-02-06 04:03:00.577 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:03:00.577 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-06 04:03:00.584 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:03:00.584 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_04-02-59__1c57f57e-3f6a-4bc9-8739-ecc60ad768f5__wakuorg_nwaku:latest.log
2025-02-06 04:03:00.584 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:03:00.584 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:03:00.586 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:03:00.586 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.87.211
2025-02-06 04:03:00.586 DEBUG [src.node.docker_mananger] Generated ports ['58089', '58090', '58091', '58092', '58093']
2025-02-06 04:03:00.586 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:03:00.586 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:03:00.586 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:03:00.586 DEBUG [src.node.docker_mananger] docker run -i -t -p 58089:58089 -p 58090:58090 -p 58091:58091 -p 58092:58092 -p 58093:58093 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58091 --rest-port=58089 --tcp-port=58090 --discv5-udp-port=58092 --rest-address=0.0.0.0 --nat=extip:172.18.87.211 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7d6ed504e76dbac18cda8df1cc8af62c9229a5e1abd0edfeb2cf783b19c5ddbb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58093 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QBwx6-Y9Gk8EYlFOOtwWRsVtA0Kk0j4KPkkzNoEN3YW4emsnKAOmiusj5VJoAvCs864N4N9O0VeqrUGpn7pNx9ICgmlkgnY0gmlwhKwSkpGKbXVsdGlhZGRyc5YACASsEpKRBs4XAAoErBKSkQbOGN0DgnJzhQADAQAAiXNlY3AyNTZrMaECu9jK0-M4GpxCJ8ORk41HE8W8HI88iyYE1fWA4oYVXViDdGNwgs4Xg3VkcILOGYV3YWt1MgU --filternode=/ip4/172.18.146.145/tcp/52759/p2p/16Uiu2HAm84wx9jNEPNwhyAGLYbqKS2WPhUxDqh9qrA47bLomne4o
2025-02-06 04:03:00.823 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.87.211 waku df7ee843eca4c1758a8a347ab6316d343229e11c3f7c2fd89e8d137097ea32fc
2025-02-06 04:03:00.869 DEBUG [src.node.docker_mananger] Container started with ID df7ee843eca4. Setting up logs at ./log/docker/node2_2025-02-06_04-02-59__1c57f57e-3f6a-4bc9-8739-ecc60ad768f5__wakuorg_nwaku:latest.log
2025-02-06 04:03:00.869 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58089
2025-02-06 04:03:00.869 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:03:01.870 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58089/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:01.873 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:03:01.873 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:03:01.873 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58089/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:01.875 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.87.211/tcp/58090/p2p/16Uiu2HAmALepjpdaqkkzZcw1BfPns9iLWadSs6BzsAw8KNFruiH9","/ip4/172.18.87.211/tcp/58091/ws/p2p/16Uiu2HAmALepjpdaqkkzZcw1BfPns9iLWadSs6BzsAw8KNFruiH9"],"enrUri":"enr:-L24QAyj06NozzyxIHAdcHrEwh9Rh8fI1_eZQXRHl6GgGjI3bwGkCmVGtz6V3JXbwOdAWEQk3X2Ff5RGPh5_sjlC2BYCgmlkgnY0gmlwhKwSV9OKbXVsdGlhZGRyc5YACASsElfTBuLqAAoErBJX0wbi690DgnJzhQADAQAAiXNlY3AyNTZrMaEC3ZYXtrYYEOaODLROiGNDJ6-2ik-_SWQK4ZOC7Lc65JyDdGNwguLqg3VkcILi7IV3YWt1MgA"}'
2025-02-06 04:03:01.875 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:03:01.876 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58089/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.146.145/tcp/52759/p2p/16Uiu2HAm84wx9jNEPNwhyAGLYbqKS2WPhUxDqh9qrA47bLomne4o"]'
2025-02-06 04:03:01.914 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:01.917 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-06 04:03:01.918 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:52758/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 04:03:01.934 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:01.935 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58089/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "cd3526d8-a221-401d-8751-781e41495f26", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 04:03:01.947 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"cd3526d8-a221-401d-8751-781e41495f26","statusDesc":"OK"}'
2025-02-06 04:03:01.948 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic Empty string
2025-02-06 04:03:01.948 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:58089/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "Empty string", "value": ""}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 04:03:01.951 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58089/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-06 04:03:01.952 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic A dictionary
2025-02-06 04:03:01.952 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:58089/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A dictionary", "value": {"key": "YWFh"}}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 04:03:01.955 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58089/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-06 04:03:01.956 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic An integer
2025-02-06 04:03:01.957 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:58089/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "An integer", "value": 1234567890}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 04:03:01.959 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58089/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-06 04:03:01.960 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic A list
2025-02-06 04:03:01.960 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:58089/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A list", "value": ["YWFh"]}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 04:03:01.963 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58089/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-06 04:03:01.964 DEBUG [tests.filter.test_subscribe_update] Running test with contetn topic A bool
2025-02-06 04:03:01.964 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:58089/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A bool", "value": true}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-06 04:03:01.966 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58089/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-06 04:03:01.969 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:03:01.970 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:03:01.970 DEBUG [src.node.waku_node] Stopping container with id dff996790cdb
2025-02-06 04:03:02.641 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:03:02.642 DEBUG [src.node.waku_node] Stopping container with id df7ee843eca4
2025-02-06 04:03:03.467 ERROR [src.node.docker_mananger] Max retries reached for container dff996790cdb. Exiting log stream.
2025-02-06 04:03:03.845 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:03:03.845 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:03:03.854 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:03:03.857 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
