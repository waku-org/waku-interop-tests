2025-02-06 04:07:21.314 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:07:21.315 DEBUG [tests.conftest] Running test: test_publish_with_payload_equal_or_more_150_kb with id: 2025-02-06_04-07-21__5cd937d9-0e8a-4b3f-a9f0-9217608fea7c
2025-02-06 04:07:21.315 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:07:21.315 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-06 04:07:21.316 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-06 04:07:21.323 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:07:21.323 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_04-07-21__5cd937d9-0e8a-4b3f-a9f0-9217608fea7c__wakuorg_nwaku:latest.log
2025-02-06 04:07:21.323 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:07:21.323 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:07:21.325 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:07:21.325 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.45.85
2025-02-06 04:07:21.325 DEBUG [src.node.docker_mananger] Generated ports ['7086', '7087', '7088', '7089', '7090']
2025-02-06 04:07:21.325 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:07:21.325 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:07:21.326 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:07:21.326 DEBUG [src.node.docker_mananger] docker run -i -t -p 7086:7086 -p 7087:7087 -p 7088:7088 -p 7089:7089 -p 7090:7090 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7088 --rest-port=7086 --tcp-port=7087 --discv5-udp-port=7089 --rest-address=0.0.0.0 --nat=extip:172.18.45.85 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7402b2f4ffafcdd6e775eff6e1ebfcb9833274be6ccfbeffda9658d50c2c642e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7090 --metrics-logging=true --relay=true
2025-02-06 04:07:21.553 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.45.85 waku 52bbaf5befa6c98a4ed4ef5c2f4f254e49efe0a8df351a1f9e5f5df76ed380dc
2025-02-06 04:07:21.601 DEBUG [src.node.docker_mananger] Container started with ID 52bbaf5befa6. Setting up logs at ./log/docker/node1_2025-02-06_04-07-21__5cd937d9-0e8a-4b3f-a9f0-9217608fea7c__wakuorg_nwaku:latest.log
2025-02-06 04:07:21.602 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 7086
2025-02-06 04:07:21.603 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:07:22.117 ERROR [src.node.docker_mananger] Max retries reached for container 92fecb36615f. Exiting log stream.
2025-02-06 04:07:22.603 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7086/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:22.606 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:07:22.606 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:07:22.606 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7086/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:22.608 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.45.85/tcp/7087/p2p/16Uiu2HAmLzubRAT1mmzidtmcc9cZxU6jouhXB97U1n8d8dr65vfm","/ip4/172.18.45.85/tcp/7088/ws/p2p/16Uiu2HAmLzubRAT1mmzidtmcc9cZxU6jouhXB97U1n8d8dr65vfm"],"enrUri":"enr:-L24QGFG2wZn3NBz8r1MgY9Z1l12Qk6MHXTFGDGU24s56aFVHTsgwivwpodM-R6Lk0XxXSUniq9tw18U7AZXvO7Rp4QCgmlkgnY0gmlwhKwSLVWKbXVsdGlhZGRyc5YACASsEi1VBhuvAAoErBItVQYbsN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDe_e7xfJKLzEAK0URsEnIfgDqh0olOTp6MpqfVbKsl0yDdGNwghuvg3VkcIIbsYV3YWt1MgE"}'
2025-02-06 04:07:22.608 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:07:22.614 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:07:22.615 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_04-07-21__5cd937d9-0e8a-4b3f-a9f0-9217608fea7c__wakuorg_nwaku:latest.log
2025-02-06 04:07:22.615 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:07:22.615 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:07:22.616 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:07:22.616 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.19.173
2025-02-06 04:07:22.616 DEBUG [src.node.docker_mananger] Generated ports ['10490', '10491', '10492', '10493', '10494']
2025-02-06 04:07:22.617 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:07:22.617 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:07:22.617 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:07:22.617 DEBUG [src.node.docker_mananger] docker run -i -t -p 10490:10490 -p 10491:10491 -p 10492:10492 -p 10493:10493 -p 10494:10494 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10492 --rest-port=10490 --tcp-port=10491 --discv5-udp-port=10493 --rest-address=0.0.0.0 --nat=extip:172.18.19.173 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=62dbafbf2a92c1c11faa351a18bedffc687ea7edd5b3dfcbbfeb6df1c9ceb4b1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10494 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QGFG2wZn3NBz8r1MgY9Z1l12Qk6MHXTFGDGU24s56aFVHTsgwivwpodM-R6Lk0XxXSUniq9tw18U7AZXvO7Rp4QCgmlkgnY0gmlwhKwSLVWKbXVsdGlhZGRyc5YACASsEi1VBhuvAAoErBItVQYbsN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDe_e7xfJKLzEAK0URsEnIfgDqh0olOTp6MpqfVbKsl0yDdGNwghuvg3VkcIIbsYV3YWt1MgE
2025-02-06 04:07:22.835 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.19.173 waku aa3dc56235cf723497c8cfbd2196679684f11ead60bf45e57f526fd67a6b7037
2025-02-06 04:07:22.884 DEBUG [src.node.docker_mananger] Container started with ID aa3dc56235cf. Setting up logs at ./log/docker/node2_2025-02-06_04-07-21__5cd937d9-0e8a-4b3f-a9f0-9217608fea7c__wakuorg_nwaku:latest.log
2025-02-06 04:07:22.884 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10490
2025-02-06 04:07:22.884 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:07:23.885 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10490/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:23.891 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:07:23.892 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:07:23.893 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10490/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:23.897 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.173/tcp/10491/p2p/16Uiu2HAmFgHGq7Yr8pCtubrLkALRVihdrmMredFy6aZaZsVMMCMU","/ip4/172.18.19.173/tcp/10492/ws/p2p/16Uiu2HAmFgHGq7Yr8pCtubrLkALRVihdrmMredFy6aZaZsVMMCMU"],"enrUri":"enr:-L24QKr5MRbBO5cxA5G_JEEPhbcRZz0ulSOTrWhwo52qdOy4JvNBs-8VAXJpVpdr--I9hZ4u5LFFMExxKFXgCi6pJOgCgmlkgnY0gmlwhKwSE62KbXVsdGlhZGRyc5YACASsEhOtBij7AAoErBITrQYo_N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDLOfG0AHCwgyIQgGEqG0Bf3ntmAA-u4GmDvDdnn2e-I-DdGNwgij7g3VkcIIo_YV3YWt1MgE"}'
2025-02-06 04:07:23.897 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:07:23.897 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10490/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.45.85/tcp/7087/p2p/16Uiu2HAmLzubRAT1mmzidtmcc9cZxU6jouhXB97U1n8d8dr65vfm"]'
2025-02-06 04:07:23.900 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:23.900 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-06 04:07:23.901 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7086/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 04:07:23.904 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:23.905 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10490/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 04:07:23.910 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:23.911 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7086/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 04:07:23.918 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:23.918 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:07:24.019 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 04:07:24.019 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7086/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:24.021 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738814843911364864,"ephemeral":false}]'
2025-02-06 04:07:24.023 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-06 04:07:24.023 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10490/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:24.025 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738814843911364864,"ephemeral":false}]'
2025-02-06 04:07:24.026 INFO [src.steps.relay] WARM UP successful!!
2025-02-06 04:07:24.027 DEBUG [tests.relay.test_publish] Running test with payload length of 204800 bytes
2025-02-06 04:07:24.031 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-06 04:07:24.049 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:7086/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
2025-02-06 04:07:24.050 DEBUG [tests.relay.test_publish] Running test with payload length of 1048576 bytes
2025-02-06 04:07:24.068 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-06 04:07:24.134 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:7086/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
2025-02-06 04:07:24.135 DEBUG [tests.relay.test_publish] Running test with payload length of 10485760 bytes
2025-02-06 04:07:24.274 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-06 04:07:24.838 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:7086/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Message size exceeded maximum of 153600 bytes'
2025-02-06 04:07:24.841 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:07:24.842 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:07:24.842 DEBUG [src.node.waku_node] Stopping container with id 52bbaf5befa6
2025-02-06 04:07:25.963 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:07:25.963 DEBUG [src.node.waku_node] Stopping container with id aa3dc56235cf
2025-02-06 04:07:26.776 ERROR [src.node.docker_mananger] Max retries reached for container 52bbaf5befa6. Exiting log stream.
2025-02-06 04:07:27.460 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:07:27.461 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:07:27.466 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:07:27.472 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
