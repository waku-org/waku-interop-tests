2025-02-06 04:03:13.209 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:03:13.209 DEBUG [tests.conftest] Running test: test_light_push_with_ephemeral with id: 2025-02-06_04-03-13__f091cde6-97f4-451f-a5f7-e96b097019f9
2025-02-06 04:03:13.210 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:03:13.210 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-06 04:03:13.216 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:03:13.216 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-06_04-03-13__f091cde6-97f4-451f-a5f7-e96b097019f9__wakuorg_nwaku:latest.log
2025-02-06 04:03:13.216 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:03:13.217 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:03:13.218 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:03:13.218 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.85.69
2025-02-06 04:03:13.218 DEBUG [src.node.docker_mananger] Generated ports ['63107', '63108', '63109', '63110', '63111']
2025-02-06 04:03:13.218 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:03:13.218 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:03:13.219 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:03:13.219 DEBUG [src.node.docker_mananger] docker run -i -t -p 63107:63107 -p 63108:63108 -p 63109:63109 -p 63110:63110 -p 63111:63111 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63109 --rest-port=63107 --tcp-port=63108 --discv5-udp-port=63110 --rest-address=0.0.0.0 --nat=extip:172.18.85.69 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f0c1186ecbee1fcd5ed79d0cac96399695b1aafaca3626c02f2aea5afd120abc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63111 --metrics-logging=true --lightpush=true --relay=true
2025-02-06 04:03:13.445 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.85.69 waku 7bd591f44559f0a39edeef3c0431a0c01a0aec2bf9c940c98ebe6a9b63afb8b1
2025-02-06 04:03:13.494 DEBUG [src.node.docker_mananger] Container started with ID 7bd591f44559. Setting up logs at ./log/docker/receiving_node1_2025-02-06_04-03-13__f091cde6-97f4-451f-a5f7-e96b097019f9__wakuorg_nwaku:latest.log
2025-02-06 04:03:13.495 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 63107
2025-02-06 04:03:13.496 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:03:14.009 ERROR [src.node.docker_mananger] Max retries reached for container a34e992c3d6b. Exiting log stream.
2025-02-06 04:03:14.496 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63107/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:14.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:03:14.499 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:03:14.499 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63107/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:14.501 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.85.69/tcp/63108/p2p/16Uiu2HAm7CjHe7FctVFczUqfUCPPqJT9b8gokzqs1TKhw7f3syBv","/ip4/172.18.85.69/tcp/63109/ws/p2p/16Uiu2HAm7CjHe7FctVFczUqfUCPPqJT9b8gokzqs1TKhw7f3syBv"],"enrUri":"enr:-L24QBFJo0r-tc6_Pa9xVWL7JUIkfTTRVMEpHPCfBukzJmQ-RuXKLZCxfMVVQVvcxWSi_qoMMU-RBhjoIaRknAupWS8CgmlkgnY0gmlwhKwSVUWKbXVsdGlhZGRyc5YACASsElVFBvaEAAoErBJVRQb2hd0DgnJzhQADAQAAiXNlY3AyNTZrMaECrvtuwT1DdLr7pZAZ09-_YVRmrStqxQHKornajVkrLomDdGNwgvaEg3VkcIL2hoV3YWt1Mgk"}'
2025-02-06 04:03:14.501 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:03:14.508 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:03:14.508 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-06_04-03-13__f091cde6-97f4-451f-a5f7-e96b097019f9__wakuorg_nwaku:latest.log
2025-02-06 04:03:14.508 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:03:14.508 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:03:14.509 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:03:14.510 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.34.73
2025-02-06 04:03:14.510 DEBUG [src.node.docker_mananger] Generated ports ['24323', '24324', '24325', '24326', '24327']
2025-02-06 04:03:14.510 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:03:14.510 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:03:14.510 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:03:14.510 DEBUG [src.node.docker_mananger] docker run -i -t -p 24323:24323 -p 24324:24324 -p 24325:24325 -p 24326:24326 -p 24327:24327 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24325 --rest-port=24323 --tcp-port=24324 --discv5-udp-port=24326 --rest-address=0.0.0.0 --nat=extip:172.18.34.73 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3ca422be01805dcb9f08a14ae3ef2e52a38ef7fe5ca763ec2afeb00db341ec4d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24327 --metrics-logging=true --lightpush=false --relay=true
2025-02-06 04:03:14.730 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.34.73 waku ea085f035fa4fc34d6ed3f9450d1b0e36362e697a8faa39d1d8e5f702f151b3b
2025-02-06 04:03:14.780 DEBUG [src.node.docker_mananger] Container started with ID ea085f035fa4. Setting up logs at ./log/docker/receiving_node2_2025-02-06_04-03-13__f091cde6-97f4-451f-a5f7-e96b097019f9__wakuorg_nwaku:latest.log
2025-02-06 04:03:14.780 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24323
2025-02-06 04:03:14.781 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:03:15.781 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24323/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:15.784 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:03:15.784 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:03:15.784 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24323/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:15.786 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.34.73/tcp/24324/p2p/16Uiu2HAkwwWhnp6oRJe3B8rj6DPycWHNkoBSBctasa8daYK3CWN7","/ip4/172.18.34.73/tcp/24325/ws/p2p/16Uiu2HAkwwWhnp6oRJe3B8rj6DPycWHNkoBSBctasa8daYK3CWN7"],"enrUri":"enr:-L24QNdz5cs-aywoChtUd1LVscZbH7z5uwo7OUBhHnkPFYD3K3ekAOms18QRoxYd_qitCgvitmPfHf6QNOOBn99ouTgCgmlkgnY0gmlwhKwSIkmKbXVsdGlhZGRyc5YACASsEiJJBl8EAAoErBIiSQZfBd0DgnJzhQADAQAAiXNlY3AyNTZrMaECJVxPUEurNL7ZD6gOjpgcb2vBqJRYxucMeEClkL-umzSDdGNwgl8Eg3VkcIJfBoV3YWt1MgE"}'
2025-02-06 04:03:15.786 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:03:15.787 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24323/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.85.69/tcp/63108/p2p/16Uiu2HAm7CjHe7FctVFczUqfUCPPqJT9b8gokzqs1TKhw7f3syBv"]'
2025-02-06 04:03:15.822 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:15.832 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:03:15.832 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-06_04-03-13__f091cde6-97f4-451f-a5f7-e96b097019f9__wakuorg_nwaku:latest.log
2025-02-06 04:03:15.832 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:03:15.832 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:03:15.834 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:03:15.834 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.141.187
2025-02-06 04:03:15.834 DEBUG [src.node.docker_mananger] Generated ports ['22813', '22814', '22815', '22816', '22817']
2025-02-06 04:03:15.834 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:03:15.834 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:03:15.834 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:03:15.835 DEBUG [src.node.docker_mananger] docker run -i -t -p 22813:22813 -p 22814:22814 -p 22815:22815 -p 22816:22816 -p 22817:22817 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22815 --rest-port=22813 --tcp-port=22814 --discv5-udp-port=22816 --rest-address=0.0.0.0 --nat=extip:172.18.141.187 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aa7cbaf574ddf4e9c22bf5ec24e31dd055d0bb9cbdcdceeeb9c1e7a5dd1b4d3e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22817 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QBFJo0r-tc6_Pa9xVWL7JUIkfTTRVMEpHPCfBukzJmQ-RuXKLZCxfMVVQVvcxWSi_qoMMU-RBhjoIaRknAupWS8CgmlkgnY0gmlwhKwSVUWKbXVsdGlhZGRyc5YACASsElVFBvaEAAoErBJVRQb2hd0DgnJzhQADAQAAiXNlY3AyNTZrMaECrvtuwT1DdLr7pZAZ09-_YVRmrStqxQHKornajVkrLomDdGNwgvaEg3VkcIL2hoV3YWt1Mgk --lightpushnode=/ip4/172.18.85.69/tcp/63108/p2p/16Uiu2HAm7CjHe7FctVFczUqfUCPPqJT9b8gokzqs1TKhw7f3syBv --lightpush=true --relay=false
2025-02-06 04:03:16.068 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.141.187 waku 2e7918edd421eed6309a08f2c3372ebe8037b503f53831b4303096620af46c84
2025-02-06 04:03:16.117 DEBUG [src.node.docker_mananger] Container started with ID 2e7918edd421. Setting up logs at ./log/docker/lightpush_node1_2025-02-06_04-03-13__f091cde6-97f4-451f-a5f7-e96b097019f9__wakuorg_nwaku:latest.log
2025-02-06 04:03:16.117 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22813
2025-02-06 04:03:16.117 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:03:17.118 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22813/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:17.121 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:03:17.121 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:03:17.121 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22813/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:17.123 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.141.187/tcp/22814/p2p/16Uiu2HAmUav8e8yTgyQZXxMBrzuPEmvAPKBWvuG65TiyXvsSYtme","/ip4/172.18.141.187/tcp/22815/ws/p2p/16Uiu2HAmUav8e8yTgyQZXxMBrzuPEmvAPKBWvuG65TiyXvsSYtme"],"enrUri":"enr:-L24QDexIB293cNLFG7mlf_iZ2i9XA81PfgrYCOYsy3LNpUkLU7O7bivHwg-3Zj98elZCiUr0pb9B3nmfcIayAz9Rj8CgmlkgnY0gmlwhKwSjbuKbXVsdGlhZGRyc5YACASsEo27BlkeAAoErBKNuwZZH90DgnJzhQADAQAAiXNlY3AyNTZrMaED7K_l72_gnaCcgSpLuqZuGKhHEfANpCijbPTjNl6CczGDdGNwglkeg3VkcIJZIIV3YWt1Mgg"}'
2025-02-06 04:03:17.124 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:03:17.124 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22813/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.85.69/tcp/63108/p2p/16Uiu2HAm7CjHe7FctVFczUqfUCPPqJT9b8gokzqs1TKhw7f3syBv"]'
2025-02-06 04:03:17.162 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:17.163 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22813/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.34.73/tcp/24324/p2p/16Uiu2HAkwwWhnp6oRJe3B8rj6DPycWHNkoBSBctasa8daYK3CWN7"]'
2025-02-06 04:03:17.192 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:17.193 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63107/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 04:03:17.201 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:17.205 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24323/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 04:03:17.213 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:17.215 DEBUG [tests.light_push.test_publish] Running test with Ephemeral True
2025-02-06 04:03:17.216 DEBUG [src.steps.light_push] Lightpushing message
2025-02-06 04:03:17.216 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22813/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738814597216514048, "ephemeral": true}}'
2025-02-06 04:03:17.226 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:17.226 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:03:17.326 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-06 04:03:17.327 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63107/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:17.329 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814597216514048,"ephemeral":true}]'
2025-02-06 04:03:17.330 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-06 04:03:17.330 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24323/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:17.333 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814597216514048,"ephemeral":true}]'
2025-02-06 04:03:17.334 DEBUG [tests.light_push.test_publish] Running test with Ephemeral False
2025-02-06 04:03:17.334 DEBUG [src.steps.light_push] Lightpushing message
2025-02-06 04:03:17.335 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22813/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738814597334649344, "ephemeral": false}}'
2025-02-06 04:03:17.344 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:03:17.344 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:03:17.445 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-06 04:03:17.445 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63107/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:17.448 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814597334649344,"ephemeral":false}]'
2025-02-06 04:03:17.449 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-06 04:03:17.449 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24323/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:03:17.452 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814597334649344,"ephemeral":false}]'
2025-02-06 04:03:17.455 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:03:17.455 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:03:17.456 DEBUG [src.node.waku_node] Stopping container with id 7bd591f44559
2025-02-06 04:03:18.952 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:03:18.953 DEBUG [src.node.waku_node] Stopping container with id ea085f035fa4
2025-02-06 04:03:19.764 ERROR [src.node.docker_mananger] Max retries reached for container 7bd591f44559. Exiting log stream.
2025-02-06 04:03:20.467 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:03:20.468 DEBUG [src.node.waku_node] Stopping container with id 2e7918edd421
2025-02-06 04:03:21.279 ERROR [src.node.docker_mananger] Max retries reached for container ea085f035fa4. Exiting log stream.
2025-02-06 04:03:21.968 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:03:21.970 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:03:21.977 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:03:21.984 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:03:21.989 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
