2025-02-06 04:07:18.053 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:07:18.055 DEBUG [tests.conftest] Running test: test_messages_with_timestamps_far_from_now with id: 2025-02-06_04-07-18__8feca01f-b5be-40cd-a88d-6fa408c3a40f
2025-02-06 04:07:18.055 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:07:18.056 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-06 04:07:18.056 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-06 04:07:18.064 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:07:18.064 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-06_04-07-18__8feca01f-b5be-40cd-a88d-6fa408c3a40f__wakuorg_nwaku:latest.log
2025-02-06 04:07:18.065 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:07:18.065 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:07:18.068 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:07:18.068 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.134.48
2025-02-06 04:07:18.069 DEBUG [src.node.docker_mananger] Generated ports ['39177', '39178', '39179', '39180', '39181']
2025-02-06 04:07:18.069 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:07:18.069 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:07:18.069 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:07:18.069 DEBUG [src.node.docker_mananger] docker run -i -t -p 39177:39177 -p 39178:39178 -p 39179:39179 -p 39180:39180 -p 39181:39181 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39179 --rest-port=39177 --tcp-port=39178 --discv5-udp-port=39180 --rest-address=0.0.0.0 --nat=extip:172.18.134.48 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d4cfba5abaefb8771cbbacbacd75b147eae5fc0f2e1d7dc2bebd5a1fdcb4ce2d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39181 --metrics-logging=true --store=true --relay=true
2025-02-06 04:07:18.292 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.134.48 waku 701ba3c0603bc47e0071416fe564632905edd0bc86076d9bb151db04c2965cf1
2025-02-06 04:07:18.338 DEBUG [src.node.docker_mananger] Container started with ID 701ba3c0603b. Setting up logs at ./log/docker/publishing_node1_2025-02-06_04-07-18__8feca01f-b5be-40cd-a88d-6fa408c3a40f__wakuorg_nwaku:latest.log
2025-02-06 04:07:18.339 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39177
2025-02-06 04:07:18.339 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:07:18.893 ERROR [src.node.docker_mananger] Max retries reached for container 78782db3d04f. Exiting log stream.
2025-02-06 04:07:19.341 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39177/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:19.344 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:07:19.344 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:07:19.344 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39177/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:19.346 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.134.48/tcp/39178/p2p/16Uiu2HAmBNwtWtnHBHq8vMpYmxmghyRJSzGeGDpxhfVuk51YvMC5","/ip4/172.18.134.48/tcp/39179/ws/p2p/16Uiu2HAmBNwtWtnHBHq8vMpYmxmghyRJSzGeGDpxhfVuk51YvMC5"],"enrUri":"enr:-L24QIIhXEvhRhZTLnIrgMIU3r_y_c1vDtI_ehH1mfxonMzeRfvgM60_Ynbd3iajMrgKNjMCzsNOhqXo7A5TAM3jI6ICgmlkgnY0gmlwhKwShjCKbXVsdGlhZGRyc5YACASsEoYwBpkKAAoErBKGMAaZC90DgnJzhQADAQAAiXNlY3AyNTZrMaEC7Qg8nQ9x0c2osy2cVs673ytm0x1rqTg4zj45bB2H-QqDdGNwgpkKg3VkcIKZDIV3YWt1MgM"}'
2025-02-06 04:07:19.346 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:07:19.353 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:07:19.353 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-06_04-07-18__8feca01f-b5be-40cd-a88d-6fa408c3a40f__wakuorg_nwaku:latest.log
2025-02-06 04:07:19.353 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:07:19.353 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:07:19.355 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:07:19.355 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.220.25
2025-02-06 04:07:19.355 DEBUG [src.node.docker_mananger] Generated ports ['22134', '22135', '22136', '22137', '22138']
2025-02-06 04:07:19.355 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:07:19.355 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:07:19.355 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:07:19.356 DEBUG [src.node.docker_mananger] docker run -i -t -p 22134:22134 -p 22135:22135 -p 22136:22136 -p 22137:22137 -p 22138:22138 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22136 --rest-port=22134 --tcp-port=22135 --discv5-udp-port=22137 --rest-address=0.0.0.0 --nat=extip:172.18.220.25 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b1bda3ba6bbdbbcf95cecb2d0a56b7c19efe1d2afb14e7faa10835859e17a278 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22138 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QIIhXEvhRhZTLnIrgMIU3r_y_c1vDtI_ehH1mfxonMzeRfvgM60_Ynbd3iajMrgKNjMCzsNOhqXo7A5TAM3jI6ICgmlkgnY0gmlwhKwShjCKbXVsdGlhZGRyc5YACASsEoYwBpkKAAoErBKGMAaZC90DgnJzhQADAQAAiXNlY3AyNTZrMaEC7Qg8nQ9x0c2osy2cVs673ytm0x1rqTg4zj45bB2H-QqDdGNwgpkKg3VkcIKZDIV3YWt1MgM --storenode=/ip4/172.18.134.48/tcp/39178/p2p/16Uiu2HAmBNwtWtnHBHq8vMpYmxmghyRJSzGeGDpxhfVuk51YvMC5 --store=true --relay=true
2025-02-06 04:07:19.580 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.220.25 waku be6c9619d3eeab0e634a1e283a35e4b76ac3ef6ac36cb0bdb617bc9289906d45
2025-02-06 04:07:19.629 DEBUG [src.node.docker_mananger] Container started with ID be6c9619d3ee. Setting up logs at ./log/docker/store_node1_2025-02-06_04-07-18__8feca01f-b5be-40cd-a88d-6fa408c3a40f__wakuorg_nwaku:latest.log
2025-02-06 04:07:19.631 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22134
2025-02-06 04:07:19.631 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:07:20.632 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22134/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:20.635 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:07:20.635 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:07:20.635 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22134/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:20.637 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.220.25/tcp/22135/p2p/16Uiu2HAmHFgxptBSMV3zASxAE9tbTPYbYu4Mu2u4gpDUDoux2V31","/ip4/172.18.220.25/tcp/22136/ws/p2p/16Uiu2HAmHFgxptBSMV3zASxAE9tbTPYbYu4Mu2u4gpDUDoux2V31"],"enrUri":"enr:-L24QAcpQWLaHVtkp6eWtNH2tzpldzr5IlB6Aj_1vfj_EH4eNAPd5zpHHNC-bz-o4K_PHNXHKBWjm6KXEu4uq5wRaXQCgmlkgnY0gmlwhKwS3BmKbXVsdGlhZGRyc5YACASsEtwZBlZ3AAoErBLcGQZWeN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDRFJqiAnhGsE3HRbENdNqsxO2jeArnwm_E1RawaESMfyDdGNwglZ3g3VkcIJWeYV3YWt1MgM"}'
2025-02-06 04:07:20.638 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:07:20.638 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22134/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.134.48/tcp/39178/p2p/16Uiu2HAmBNwtWtnHBHq8vMpYmxmghyRJSzGeGDpxhfVuk51YvMC5"]'
2025-02-06 04:07:20.641 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:20.641 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39177/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 04:07:20.643 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:20.644 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22134/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 04:07:20.646 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:20.647 DEBUG [tests.store.test_time_filter] Running test with payload 20 sec Past
2025-02-06 04:07:20.647 DEBUG [src.steps.store] Relaying message
2025-02-06 04:07:20.647 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39177/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 04:07:20.652 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:20.652 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-06 04:07:20.853 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-06 04:07:20.854 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39177/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:20.857 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-06 04:07:20.857 DEBUG [tests.store.test_time_filter] Running test with payload 40 sec Future
2025-02-06 04:07:20.857 DEBUG [src.steps.store] Relaying message
2025-02-06 04:07:20.857 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39177/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 04:07:20.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:07:20.863 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-06 04:07:21.064 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-06 04:07:21.064 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39177/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:07:21.067 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-06 04:07:21.069 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:07:21.070 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:07:21.070 DEBUG [src.node.waku_node] Stopping container with id 701ba3c0603b
2025-02-06 04:07:21.872 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:07:21.872 DEBUG [src.node.waku_node] Stopping container with id be6c9619d3ee
2025-02-06 04:07:22.700 ERROR [src.node.docker_mananger] Max retries reached for container 701ba3c0603b. Exiting log stream.
2025-02-06 04:07:23.349 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:07:23.350 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:07:23.359 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:07:23.365 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
