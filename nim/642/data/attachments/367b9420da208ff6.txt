2025-02-06 04:05:19.262 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:05:19.262 DEBUG [tests.conftest] Running test: test_publish_with_invalid_meta with id: 2025-02-06_04-05-19__f1fe98ae-151c-4b84-9b80-45958eb3d424
2025-02-06 04:05:19.263 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:05:19.263 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-06 04:05:19.264 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-06 04:05:19.273 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:05:19.273 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_04-05-19__f1fe98ae-151c-4b84-9b80-45958eb3d424__wakuorg_nwaku:latest.log
2025-02-06 04:05:19.273 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:05:19.274 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:05:19.276 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:05:19.277 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.170.78
2025-02-06 04:05:19.277 DEBUG [src.node.docker_mananger] Generated ports ['57653', '57654', '57655', '57656', '57657']
2025-02-06 04:05:19.277 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:05:19.277 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:05:19.277 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:05:19.278 DEBUG [src.node.docker_mananger] docker run -i -t -p 57653:57653 -p 57654:57654 -p 57655:57655 -p 57656:57656 -p 57657:57657 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57655 --rest-port=57653 --tcp-port=57654 --discv5-udp-port=57656 --rest-address=0.0.0.0 --nat=extip:172.18.170.78 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b6a18748fbc438b2c1e9bf11fb34c8bbc50dd62adebbc096f8b0bfabf57ef1bf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57657 --metrics-logging=true --relay=true
2025-02-06 04:05:19.503 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.170.78 waku b8918e8df53369e1bd77e9541015e91cee09cd9517e80de41c913fa3f5b5e88e
2025-02-06 04:05:19.547 DEBUG [src.node.docker_mananger] Container started with ID b8918e8df533. Setting up logs at ./log/docker/node1_2025-02-06_04-05-19__f1fe98ae-151c-4b84-9b80-45958eb3d424__wakuorg_nwaku:latest.log
2025-02-06 04:05:19.548 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57653
2025-02-06 04:05:19.548 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:05:20.100 ERROR [src.node.docker_mananger] Max retries reached for container c194332b8dcd. Exiting log stream.
2025-02-06 04:05:20.550 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57653/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:05:20.552 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:05:20.552 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:05:20.552 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57653/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:05:20.554 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.170.78/tcp/57654/p2p/16Uiu2HAm94AmFbBpZvdoVMsQDVRkuteuDHQLoVtkGpY3GrcDoss5","/ip4/172.18.170.78/tcp/57655/ws/p2p/16Uiu2HAm94AmFbBpZvdoVMsQDVRkuteuDHQLoVtkGpY3GrcDoss5"],"enrUri":"enr:-L24QAjeyQI6t7Jn14fUe4o1FeHQ4RJ89eGlsQCV1DBkrOZ0dMRv_eQqzqz1gVtUVgOEkXMRYIScA-enbSo0w3MycWsCgmlkgnY0gmlwhKwSqk6KbXVsdGlhZGRyc5YACASsEqpOBuE2AAoErBKqTgbhN90DgnJzhQADAQAAiXNlY3AyNTZrMaECyoFilPNw892Pp6GTKfEr4FXyBpP1wdBeh-nnp_qjXPCDdGNwguE2g3VkcILhOIV3YWt1MgE"}'
2025-02-06 04:05:20.555 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:05:20.561 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:05:20.561 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_04-05-19__f1fe98ae-151c-4b84-9b80-45958eb3d424__wakuorg_nwaku:latest.log
2025-02-06 04:05:20.561 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:05:20.561 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:05:20.563 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:05:20.563 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.42.122
2025-02-06 04:05:20.563 DEBUG [src.node.docker_mananger] Generated ports ['40601', '40602', '40603', '40604', '40605']
2025-02-06 04:05:20.563 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:05:20.563 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:05:20.563 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:05:20.563 DEBUG [src.node.docker_mananger] docker run -i -t -p 40601:40601 -p 40602:40602 -p 40603:40603 -p 40604:40604 -p 40605:40605 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40603 --rest-port=40601 --tcp-port=40602 --discv5-udp-port=40604 --rest-address=0.0.0.0 --nat=extip:172.18.42.122 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=af13c6e76fabeabcb7bdb34282909b40f1bedfec5dcac7d464a8d6a0ee8d6f39 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40605 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QAjeyQI6t7Jn14fUe4o1FeHQ4RJ89eGlsQCV1DBkrOZ0dMRv_eQqzqz1gVtUVgOEkXMRYIScA-enbSo0w3MycWsCgmlkgnY0gmlwhKwSqk6KbXVsdGlhZGRyc5YACASsEqpOBuE2AAoErBKqTgbhN90DgnJzhQADAQAAiXNlY3AyNTZrMaECyoFilPNw892Pp6GTKfEr4FXyBpP1wdBeh-nnp_qjXPCDdGNwguE2g3VkcILhOIV3YWt1MgE
2025-02-06 04:05:20.791 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.42.122 waku 00e66129c79dedf5857a4fd0350643129d580f27141205ccb22f7d388fd92b63
2025-02-06 04:05:20.838 DEBUG [src.node.docker_mananger] Container started with ID 00e66129c79d. Setting up logs at ./log/docker/node2_2025-02-06_04-05-19__f1fe98ae-151c-4b84-9b80-45958eb3d424__wakuorg_nwaku:latest.log
2025-02-06 04:05:20.838 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40601
2025-02-06 04:05:20.838 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:05:21.840 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40601/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:05:21.846 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:05:21.847 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:05:21.851 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40601/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:05:21.854 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.42.122/tcp/40602/p2p/16Uiu2HAm71Y3eLyg6QMBRANTVLeXampfP7GXtJsDxF2QoqegQ34o","/ip4/172.18.42.122/tcp/40603/ws/p2p/16Uiu2HAm71Y3eLyg6QMBRANTVLeXampfP7GXtJsDxF2QoqegQ34o"],"enrUri":"enr:-L24QDaBCthBcn434DNHO5cwGtB_XoGN6DTWJibHqVi2TL9TTnAEy8zHkSFDRDs6gh9tzZHaU30H8Cn5O-Gqp8ipjUsCgmlkgnY0gmlwhKwSKnqKbXVsdGlhZGRyc5YACASsEip6Bp6aAAoErBIqegaem90DgnJzhQADAQAAiXNlY3AyNTZrMaECrB1VSSr40L5qPncKu20qvQajkrMWGZGkzeHgLJ-gwkyDdGNwgp6ag3VkcIKenIV3YWt1MgE"}'
2025-02-06 04:05:21.854 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:05:21.855 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40601/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.170.78/tcp/57654/p2p/16Uiu2HAm94AmFbBpZvdoVMsQDVRkuteuDHQLoVtkGpY3GrcDoss5"]'
2025-02-06 04:05:21.857 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:05:21.858 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-06 04:05:21.858 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57653/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 04:05:21.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:05:21.862 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40601/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 04:05:21.868 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:05:21.869 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57653/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 04:05:21.874 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:05:21.874 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:05:21.975 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 04:05:21.975 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57653/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:05:21.978 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738814721869207552,"ephemeral":false}]'
2025-02-06 04:05:21.979 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-06 04:05:21.980 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40601/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:05:21.982 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738814721869207552,"ephemeral":false}]'
2025-02-06 04:05:21.983 INFO [src.steps.relay] WARM UP successful!!
2025-02-06 04:05:21.984 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57653/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "meta": "Relay works!!"}'
2025-02-06 04:05:21.987 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:57653/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Incorrect base64 string'
2025-02-06 04:05:21.989 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:05:21.990 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:05:21.990 DEBUG [src.node.waku_node] Stopping container with id b8918e8df533
2025-02-06 04:05:23.048 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:05:23.048 DEBUG [src.node.waku_node] Stopping container with id 00e66129c79d
2025-02-06 04:05:23.861 ERROR [src.node.docker_mananger] Max retries reached for container b8918e8df533. Exiting log stream.
2025-02-06 04:05:24.545 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:05:24.546 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:05:24.551 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:05:24.557 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
