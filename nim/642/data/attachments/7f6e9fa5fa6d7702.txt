2025-02-06 04:04:40.113 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:04:40.113 DEBUG [tests.conftest] Running test: test_light_push_with_no_timestamp with id: 2025-02-06_04-04-40__b335f40e-b4a7-4832-91f3-1aaffa24fbce
2025-02-06 04:04:40.114 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:04:40.114 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-06 04:04:40.120 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:04:40.121 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-06_04-04-40__b335f40e-b4a7-4832-91f3-1aaffa24fbce__wakuorg_nwaku:latest.log
2025-02-06 04:04:40.121 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:04:40.121 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:04:40.122 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:04:40.122 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.204.28
2025-02-06 04:04:40.122 DEBUG [src.node.docker_mananger] Generated ports ['23249', '23250', '23251', '23252', '23253']
2025-02-06 04:04:40.123 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:04:40.123 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:04:40.123 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:04:40.123 DEBUG [src.node.docker_mananger] docker run -i -t -p 23249:23249 -p 23250:23250 -p 23251:23251 -p 23252:23252 -p 23253:23253 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23251 --rest-port=23249 --tcp-port=23250 --discv5-udp-port=23252 --rest-address=0.0.0.0 --nat=extip:172.18.204.28 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bbcba14fcf3e2cfc4faf4b3276f07dcfb5f4eae5e0c83fb5e93e2ae6ab5cbfc3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23253 --metrics-logging=true --lightpush=true --relay=true
2025-02-06 04:04:40.346 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.204.28 waku f48bbc6d4d692588a06836944f48191c98b23d33494dcf4564b7b61738232c8a
2025-02-06 04:04:40.400 DEBUG [src.node.docker_mananger] Container started with ID f48bbc6d4d69. Setting up logs at ./log/docker/receiving_node1_2025-02-06_04-04-40__b335f40e-b4a7-4832-91f3-1aaffa24fbce__wakuorg_nwaku:latest.log
2025-02-06 04:04:40.400 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23249
2025-02-06 04:04:40.402 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:04:40.913 ERROR [src.node.docker_mananger] Max retries reached for container 11c2fad63a2b. Exiting log stream.
2025-02-06 04:04:41.402 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23249/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:41.405 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:04:41.406 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:04:41.406 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23249/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:41.408 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.204.28/tcp/23250/p2p/16Uiu2HAmH64JhEtCQa2YKsS4z8j9V5zXHyEhMvc3RALDJ65FkXyp","/ip4/172.18.204.28/tcp/23251/ws/p2p/16Uiu2HAmH64JhEtCQa2YKsS4z8j9V5zXHyEhMvc3RALDJ65FkXyp"],"enrUri":"enr:-L24QMokZhk8IuZptgK1k38Y83t647D6PwexRlhKmeEziJNgC4zqEQ9G4_iyCQ5ADH56SV9nF6gTTUoZRwUS0Yen69UCgmlkgnY0gmlwhKwSzByKbXVsdGlhZGRyc5YACASsEswcBlrSAAoErBLMHAZa090DgnJzhQADAQAAiXNlY3AyNTZrMaEDQdq9eprfMSimIyLHq115xkMXE0_P3om3FfJNXuhtWO-DdGNwglrSg3VkcIJa1IV3YWt1Mgk"}'
2025-02-06 04:04:41.409 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:04:41.416 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:04:41.416 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-06_04-04-40__b335f40e-b4a7-4832-91f3-1aaffa24fbce__wakuorg_nwaku:latest.log
2025-02-06 04:04:41.416 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:04:41.416 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:04:41.417 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:04:41.417 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.241.97
2025-02-06 04:04:41.418 DEBUG [src.node.docker_mananger] Generated ports ['6671', '6672', '6673', '6674', '6675']
2025-02-06 04:04:41.418 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:04:41.418 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:04:41.418 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:04:41.418 DEBUG [src.node.docker_mananger] docker run -i -t -p 6671:6671 -p 6672:6672 -p 6673:6673 -p 6674:6674 -p 6675:6675 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6673 --rest-port=6671 --tcp-port=6672 --discv5-udp-port=6674 --rest-address=0.0.0.0 --nat=extip:172.18.241.97 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=93d21ba43c1ed22edee44f8617a7faea1bf419bb636ab7f7eef0a16f2adc8650 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6675 --metrics-logging=true --lightpush=false --relay=true
2025-02-06 04:04:41.643 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.241.97 waku 55924d389172bc7f406946fc5fd50fe38f48a87a3fe56d2fd7402650dbc058ee
2025-02-06 04:04:41.692 DEBUG [src.node.docker_mananger] Container started with ID 55924d389172. Setting up logs at ./log/docker/receiving_node2_2025-02-06_04-04-40__b335f40e-b4a7-4832-91f3-1aaffa24fbce__wakuorg_nwaku:latest.log
2025-02-06 04:04:41.692 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6671
2025-02-06 04:04:41.693 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:04:42.693 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6671/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:42.696 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:04:42.696 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:04:42.696 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6671/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:42.698 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.97/tcp/6672/p2p/16Uiu2HAmLhcgsD5eensKkDqvEJhQzZPVGaSNH9f8EUQD9vnqZ8iM","/ip4/172.18.241.97/tcp/6673/ws/p2p/16Uiu2HAmLhcgsD5eensKkDqvEJhQzZPVGaSNH9f8EUQD9vnqZ8iM"],"enrUri":"enr:-L24QK4rUIB_hn9rq9EHhqQ4gJwMF_CfHvpBIIlyFmntSvHWXogOxET5-xHeLw9c71Q4qoBnToeF0HZzgoeUS5ll31gCgmlkgnY0gmlwhKwS8WGKbXVsdGlhZGRyc5YACASsEvFhBhoQAAoErBLxYQYaEd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDd4m-dvEMhIqn627BjruCYvgngKvspheqdh7KelMFz7qDdGNwghoQg3VkcIIaEoV3YWt1MgE"}'
2025-02-06 04:04:42.699 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:04:42.699 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6671/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.204.28/tcp/23250/p2p/16Uiu2HAmH64JhEtCQa2YKsS4z8j9V5zXHyEhMvc3RALDJ65FkXyp"]'
2025-02-06 04:04:42.741 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:42.751 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:04:42.751 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-06_04-04-40__b335f40e-b4a7-4832-91f3-1aaffa24fbce__wakuorg_nwaku:latest.log
2025-02-06 04:04:42.751 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:04:42.751 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:04:42.753 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:04:42.753 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.158.67
2025-02-06 04:04:42.753 DEBUG [src.node.docker_mananger] Generated ports ['3003', '3004', '3005', '3006', '3007']
2025-02-06 04:04:42.753 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:04:42.753 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:04:42.753 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:04:42.753 DEBUG [src.node.docker_mananger] docker run -i -t -p 3003:3003 -p 3004:3004 -p 3005:3005 -p 3006:3006 -p 3007:3007 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3005 --rest-port=3003 --tcp-port=3004 --discv5-udp-port=3006 --rest-address=0.0.0.0 --nat=extip:172.18.158.67 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bfea83df8ffdd38157e3a9fce43b5a098a1eafc56dac5b978be4637eb4aeb029 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3007 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QMokZhk8IuZptgK1k38Y83t647D6PwexRlhKmeEziJNgC4zqEQ9G4_iyCQ5ADH56SV9nF6gTTUoZRwUS0Yen69UCgmlkgnY0gmlwhKwSzByKbXVsdGlhZGRyc5YACASsEswcBlrSAAoErBLMHAZa090DgnJzhQADAQAAiXNlY3AyNTZrMaEDQdq9eprfMSimIyLHq115xkMXE0_P3om3FfJNXuhtWO-DdGNwglrSg3VkcIJa1IV3YWt1Mgk --lightpushnode=/ip4/172.18.204.28/tcp/23250/p2p/16Uiu2HAmH64JhEtCQa2YKsS4z8j9V5zXHyEhMvc3RALDJ65FkXyp --lightpush=true --relay=false
2025-02-06 04:04:42.992 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.158.67 waku 602ee3711ec1a3b20b5bceef193482d45faab6e5217944719b85134e4660a957
2025-02-06 04:04:43.045 DEBUG [src.node.docker_mananger] Container started with ID 602ee3711ec1. Setting up logs at ./log/docker/lightpush_node1_2025-02-06_04-04-40__b335f40e-b4a7-4832-91f3-1aaffa24fbce__wakuorg_nwaku:latest.log
2025-02-06 04:04:43.045 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3003
2025-02-06 04:04:43.045 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:04:44.046 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3003/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.048 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:04:44.049 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:04:44.049 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3003/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.051 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.67/tcp/3004/p2p/16Uiu2HAm9eD6Gi44JbATEdu67enLYCgsy4i14yMYCm1Zmk9svF9y","/ip4/172.18.158.67/tcp/3005/ws/p2p/16Uiu2HAm9eD6Gi44JbATEdu67enLYCgsy4i14yMYCm1Zmk9svF9y"],"enrUri":"enr:-L24QOBq_3GOZBjPUPWegYavURWhQerAFUXLckWDy_LvJfw8ENgEb3kMcsmVKgSxQQxOj9Yx59_Vf-5fHLtTNd14mNACgmlkgnY0gmlwhKwSnkOKbXVsdGlhZGRyc5YACASsEp5DBgu8AAoErBKeQwYLvd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC0znDyJ1XTKVSOY1vUCqwzijJlv-HmgNzcEhQyFKxsSiDdGNwggu8g3VkcIILvoV3YWt1Mgg"}'
2025-02-06 04:04:44.051 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:04:44.052 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3003/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.204.28/tcp/23250/p2p/16Uiu2HAmH64JhEtCQa2YKsS4z8j9V5zXHyEhMvc3RALDJ65FkXyp"]'
2025-02-06 04:04:44.088 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.090 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3003/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.97/tcp/6672/p2p/16Uiu2HAmLhcgsD5eensKkDqvEJhQzZPVGaSNH9f8EUQD9vnqZ8iM"]'
2025-02-06 04:04:44.120 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.121 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23249/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 04:04:44.129 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.130 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6671/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-06 04:04:44.135 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.138 DEBUG [src.steps.light_push] Lightpushing message
2025-02-06 04:04:44.138 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3003/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto"}}'
2025-02-06 04:04:44.148 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.149 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:04:44.249 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-06 04:04:44.249 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23249/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.252 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814684140163072,"ephemeral":false}]'
2025-02-06 04:04:44.254 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-06 04:04:44.254 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6671/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.256 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738814684140163072,"ephemeral":false}]'
2025-02-06 04:04:44.259 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:04:44.260 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:04:44.260 DEBUG [src.node.waku_node] Stopping container with id f48bbc6d4d69
2025-02-06 04:04:44.891 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:04:44.893 DEBUG [src.node.waku_node] Stopping container with id 55924d389172
2025-02-06 04:04:45.726 ERROR [src.node.docker_mananger] Max retries reached for container f48bbc6d4d69. Exiting log stream.
2025-02-06 04:04:46.403 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:04:46.403 DEBUG [src.node.waku_node] Stopping container with id 602ee3711ec1
2025-02-06 04:04:47.216 ERROR [src.node.docker_mananger] Max retries reached for container 55924d389172. Exiting log stream.
2025-02-06 04:04:47.904 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:04:47.905 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:04:47.920 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:04:47.926 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:04:47.932 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
