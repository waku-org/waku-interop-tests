2025-02-06 04:04:41.652 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 04:04:41.652 DEBUG [tests.conftest] Running test: test_publish_with_valid_version with id: 2025-02-06_04-04-41__76c5aac0-02a3-45a4-babf-eed36e341b81
2025-02-06 04:04:41.653 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 04:04:41.653 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-06 04:04:41.653 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-06 04:04:41.659 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:04:41.659 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_04-04-41__76c5aac0-02a3-45a4-babf-eed36e341b81__wakuorg_nwaku:latest.log
2025-02-06 04:04:41.659 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:04:41.659 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:04:41.661 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:04:41.661 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.48.238
2025-02-06 04:04:41.661 DEBUG [src.node.docker_mananger] Generated ports ['54858', '54859', '54860', '54861', '54862']
2025-02-06 04:04:41.661 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:04:41.662 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:04:41.662 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:04:41.662 DEBUG [src.node.docker_mananger] docker run -i -t -p 54858:54858 -p 54859:54859 -p 54860:54860 -p 54861:54861 -p 54862:54862 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54860 --rest-port=54858 --tcp-port=54859 --discv5-udp-port=54861 --rest-address=0.0.0.0 --nat=extip:172.18.48.238 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=58a5cd11eebf69cec8cb17a4ef97abbc0c8ad4809db073eb86a1bd7ff5068b3b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54862 --metrics-logging=true --relay=true
2025-02-06 04:04:41.886 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.48.238 waku 01b2e97a26db4d379d8e13ac1f3646bc44fe756a1f702adad135ef5e79f00654
2025-02-06 04:04:41.930 DEBUG [src.node.docker_mananger] Container started with ID 01b2e97a26db. Setting up logs at ./log/docker/node1_2025-02-06_04-04-41__76c5aac0-02a3-45a4-babf-eed36e341b81__wakuorg_nwaku:latest.log
2025-02-06 04:04:41.931 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54858
2025-02-06 04:04:41.933 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:04:42.435 ERROR [src.node.docker_mananger] Max retries reached for container c99de3af8b82. Exiting log stream.
2025-02-06 04:04:42.934 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54858/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:42.937 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:04:42.937 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:04:42.937 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54858/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:42.939 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.48.238/tcp/54859/p2p/16Uiu2HAkzPikt4Wi6ShxfFSnf9i6GwK9F2n4moe2bCRvZfYDqSCu","/ip4/172.18.48.238/tcp/54860/ws/p2p/16Uiu2HAkzPikt4Wi6ShxfFSnf9i6GwK9F2n4moe2bCRvZfYDqSCu"],"enrUri":"enr:-L24QGKTCrypnjMaQ2wtQSqvI0JIYCp-jVEhlGPzb0XtGgp7BcXzC2zczL3szcYLJaG7St_8FIjod08l7c_mr63MpGICgmlkgnY0gmlwhKwSMO6KbXVsdGlhZGRyc5YACASsEjDuBtZLAAoErBIw7gbWTN0DgnJzhQADAQAAiXNlY3AyNTZrMaECScpp1I9kiDkcN0bimG68Lv7UkHgMZGR3Ht6iGlQmnFaDdGNwgtZLg3VkcILWTYV3YWt1MgE"}'
2025-02-06 04:04:42.940 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:04:42.945 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 04:04:42.945 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_04-04-41__76c5aac0-02a3-45a4-babf-eed36e341b81__wakuorg_nwaku:latest.log
2025-02-06 04:04:42.946 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 04:04:42.946 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 04:04:42.947 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 04:04:42.947 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.78.61
2025-02-06 04:04:42.947 DEBUG [src.node.docker_mananger] Generated ports ['22903', '22904', '22905', '22906', '22907']
2025-02-06 04:04:42.948 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 04:04:42.948 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 04:04:42.948 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 04:04:42.948 DEBUG [src.node.docker_mananger] docker run -i -t -p 22903:22903 -p 22904:22904 -p 22905:22905 -p 22906:22906 -p 22907:22907 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22905 --rest-port=22903 --tcp-port=22904 --discv5-udp-port=22906 --rest-address=0.0.0.0 --nat=extip:172.18.78.61 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3e2456b1b2caebdb05ec0a05145194845fadfcb940ed3fd7376de6da80805bbc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22907 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QGKTCrypnjMaQ2wtQSqvI0JIYCp-jVEhlGPzb0XtGgp7BcXzC2zczL3szcYLJaG7St_8FIjod08l7c_mr63MpGICgmlkgnY0gmlwhKwSMO6KbXVsdGlhZGRyc5YACASsEjDuBtZLAAoErBIw7gbWTN0DgnJzhQADAQAAiXNlY3AyNTZrMaECScpp1I9kiDkcN0bimG68Lv7UkHgMZGR3Ht6iGlQmnFaDdGNwgtZLg3VkcILWTYV3YWt1MgE
2025-02-06 04:04:43.167 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.78.61 waku 7c8738d048fd15a8970b2ae274299ba2dc8b6d7c26b1c2aab9c34c2d2a168ebd
2025-02-06 04:04:43.215 DEBUG [src.node.docker_mananger] Container started with ID 7c8738d048fd. Setting up logs at ./log/docker/node2_2025-02-06_04-04-41__76c5aac0-02a3-45a4-babf-eed36e341b81__wakuorg_nwaku:latest.log
2025-02-06 04:04:43.215 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22903
2025-02-06 04:04:43.215 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 04:04:44.216 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22903/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.229 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 04:04:44.230 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 04:04:44.232 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22903/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.238 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.78.61/tcp/22904/p2p/16Uiu2HAmHh8Q9WFgxUZ9KTc68nyUKt9QRdn3QzPz2D3jds5vEumt","/ip4/172.18.78.61/tcp/22905/ws/p2p/16Uiu2HAmHh8Q9WFgxUZ9KTc68nyUKt9QRdn3QzPz2D3jds5vEumt"],"enrUri":"enr:-L24QNTdnxG490GeXRQknHX_rs4tV282s_ZqZz5eEL4HdEH_IepiMMEoiN_uilxHSwrKrFfhrYgH3C6HfYxXR7AlTG4CgmlkgnY0gmlwhKwSTj2KbXVsdGlhZGRyc5YACASsEk49Bll4AAoErBJOPQZZed0DgnJzhQADAQAAiXNlY3AyNTZrMaEDStaylQrsT1tr5uYtL5tUMtO2Vz_fOECQHZxZ3YZHzNODdGNwgll4g3VkcIJZeoV3YWt1MgE"}'
2025-02-06 04:04:44.238 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 04:04:44.239 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22903/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.48.238/tcp/54859/p2p/16Uiu2HAkzPikt4Wi6ShxfFSnf9i6GwK9F2n4moe2bCRvZfYDqSCu"]'
2025-02-06 04:04:44.244 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.244 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-06 04:04:44.244 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54858/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 04:04:44.248 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.248 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22903/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 04:04:44.254 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.255 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54858/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 04:04:44.262 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.263 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:04:44.363 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 04:04:44.363 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54858/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.365 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738814684254946048,"ephemeral":false}]'
2025-02-06 04:04:44.367 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-06 04:04:44.367 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22903/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.369 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738814684254946048,"ephemeral":false}]'
2025-02-06 04:04:44.370 INFO [src.steps.relay] WARM UP successful!!
2025-02-06 04:04:44.371 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54858/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
2025-02-06 04:04:44.376 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 04:04:44.376 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 04:04:44.477 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 04:04:44.477 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54858/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.479 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1738814684371736064,"ephemeral":false}]'
2025-02-06 04:04:44.481 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-06 04:04:44.481 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22903/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 04:04:44.483 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1738814684371736064,"ephemeral":false}]'
2025-02-06 04:04:44.486 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 04:04:44.487 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 04:04:44.487 DEBUG [src.node.waku_node] Stopping container with id 01b2e97a26db
2025-02-06 04:04:45.392 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:04:45.392 DEBUG [src.node.waku_node] Stopping container with id 7c8738d048fd
2025-02-06 04:04:46.204 ERROR [src.node.docker_mananger] Max retries reached for container 01b2e97a26db. Exiting log stream.
2025-02-06 04:04:46.707 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 04:04:46.708 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 04:04:46.714 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 04:04:46.719 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
