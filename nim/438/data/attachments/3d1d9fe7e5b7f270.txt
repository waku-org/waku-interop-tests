[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-11-07_09-05-54__423c7c85-8cda-474a-98f4-33265d2acf61
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-07_09-05-54__423c7c85-8cda-474a-98f4-33265d2acf61__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.171.51
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['54974', '54975', '54976', '54977', '54978']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 54974:54974 -p 54975:54975 -p 54976:54976 -p 54977:54977 -p 54978:54978 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54976 --rest-port=54974 --tcp-port=54975 --discv5-udp-port=54977 --rest-address=0.0.0.0 --nat=extip:172.18.171.51 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=df4bd5a7ea40b4bb9e4fae155abbf87b94cac27b6df37db5ecec4ce2a6d2b23e --max-connections=1000 --filter-subscription-timeout=600 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54978 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.171.51 waku 3fc2c28c25d668178a77c4d616c1316759068813c2ad659d69dfcce4e1d2fc8a
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b56652b0d2bd. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3fc2c28c25d6. Setting up logs at ./log/docker/receiving_node1_2024-11-07_09-05-54__423c7c85-8cda-474a-98f4-33265d2acf61__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 54974
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54974/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54974/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.171.51/tcp/54975/p2p/16Uiu2HAmHVFw1dZWdpB4dguHqSe3uedMfEBJKxnbMGss4YB5XXqQ","/ip4/172.18.171.51/tcp/54976/ws/p2p/16Uiu2HAmHVFw1dZWdpB4dguHqSe3uedMfEBJKxnbMGss4YB5XXqQ"],"enrUri":"enr:-L24QGAS-fJXzSM0wxQUYJM2FVRD4NnTnfOM3qqIhxebh6dAIKAYbMhSs-6gw8rRuSclDlP1ttmwSXy37lbIRqre0NECgmlkgnY0gmlwhKwSqzOKbXVsdGlhZGRyc5YACASsEqszBta_AAoErBKrMwbWwN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDR8w-l2we7ZxO38CpRIzHd5WyXSvlAFrXvGiZrYC2VZ-DdGNwgta_g3VkcILWwYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-07_09-05-54__423c7c85-8cda-474a-98f4-33265d2acf61__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.238.246
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['7418', '7419', '7420', '7421', '7422']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 7418:7418 -p 7419:7419 -p 7420:7420 -p 7421:7421 -p 7422:7422 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7420 --rest-port=7418 --tcp-port=7419 --discv5-udp-port=7421 --rest-address=0.0.0.0 --nat=extip:172.18.238.246 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1be5eed4a963ad10daaea395e81d189bee79c2b6edef0e22f63e2cddfeafd43e --max-connections=1000 --filter-subscription-timeout=600 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7422 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.238.246 waku 33c947f1b4e9510367000ed5c372e8da0094a23e9e7d4731a90c62fe45d6a3dd
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 33c947f1b4e9. Setting up logs at ./log/docker/receiving_node2_2024-11-07_09-05-54__423c7c85-8cda-474a-98f4-33265d2acf61__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 7418
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7418/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7418/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.238.246/tcp/7419/p2p/16Uiu2HAkxJrtSkZSq2opgh2c75EhSaWU4bcKAnAhgwMkDGC9K8a2","/ip4/172.18.238.246/tcp/7420/ws/p2p/16Uiu2HAkxJrtSkZSq2opgh2c75EhSaWU4bcKAnAhgwMkDGC9K8a2"],"enrUri":"enr:-L24QOjLOXdb0vMfmGxXX8mmvbpEBmSf7h552GdkUMUDugVbCo1846SzV3Ax8uDKvJuJ5xz5ztQdB9Rv2kCa7eU-mV8CgmlkgnY0gmlwhKwS7vaKbXVsdGlhZGRyc5YACASsEu72Bhz7AAoErBLu9gYc_N0DgnJzhQADAQAAiXNlY3AyNTZrMaECKtRUHfwHqWe6a0G806RwgzozB-UwCBN8QCWaEoK6D2eDdGNwghz7g3VkcIIc_YV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7418/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.171.51/tcp/54975/p2p/16Uiu2HAmHVFw1dZWdpB4dguHqSe3uedMfEBJKxnbMGss4YB5XXqQ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-07_09-05-54__423c7c85-8cda-474a-98f4-33265d2acf61__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.214.143
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['46411', '46412', '46413', '46414', '46415']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 46411:46411 -p 46412:46412 -p 46413:46413 -p 46414:46414 -p 46415:46415 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46413 --rest-port=46411 --tcp-port=46412 --discv5-udp-port=46414 --rest-address=0.0.0.0 --nat=extip:172.18.214.143 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=40dd5e5996add686cbd6656d72bb3df9dfcef3ed2f691fa9f1fdf22ebccc3c5a --max-connections=1000 --filter-subscription-timeout=600 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46415 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QGAS-fJXzSM0wxQUYJM2FVRD4NnTnfOM3qqIhxebh6dAIKAYbMhSs-6gw8rRuSclDlP1ttmwSXy37lbIRqre0NECgmlkgnY0gmlwhKwSqzOKbXVsdGlhZGRyc5YACASsEqszBta_AAoErBKrMwbWwN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDR8w-l2we7ZxO38CpRIzHd5WyXSvlAFrXvGiZrYC2VZ-DdGNwgta_g3VkcILWwYV3YWt1Mgk --lightpushnode=/ip4/172.18.171.51/tcp/54975/p2p/16Uiu2HAmHVFw1dZWdpB4dguHqSe3uedMfEBJKxnbMGss4YB5XXqQ --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.214.143 waku e20473ffe17e6ba9a9190ccc466b4155d36fc30db030a0c5d8826b990ce9d2f1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID e20473ffe17e. Setting up logs at ./log/docker/lightpush_node1_2024-11-07_09-05-54__423c7c85-8cda-474a-98f4-33265d2acf61__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 46411
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46411/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46411/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.143/tcp/46412/p2p/16Uiu2HAmCCY2436uqZNqDa9baENJSumeKiEKHAsjVaWXHYtZLKRy","/ip4/172.18.214.143/tcp/46413/ws/p2p/16Uiu2HAmCCY2436uqZNqDa9baENJSumeKiEKHAsjVaWXHYtZLKRy"],"enrUri":"enr:-L24QPOquuWhmpClOqcNiSIUe6Tp_LqYXB3ysE1oaerhZY7iWn8ipIkpfc7e0OZ61VYgyzctIuPXTU1m6PGJcC3m0SwCgmlkgnY0gmlwhKwS1o-KbXVsdGlhZGRyc5YACASsEtaPBrVMAAoErBLWjwa1Td0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-TkgKseytnnjh4eBjhC0jemcRtsrNW9TTnCIEKf7cciDdGNwgrVMg3VkcIK1ToV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46411/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.171.51/tcp/54975/p2p/16Uiu2HAmHVFw1dZWdpB4dguHqSe3uedMfEBJKxnbMGss4YB5XXqQ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46411/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.238.246/tcp/7419/p2p/16Uiu2HAkxJrtSkZSq2opgh2c75EhSaWU4bcKAnAhgwMkDGC9K8a2"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54974/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7418/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46411/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730970359661441280, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54974/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730970359661441280,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7418/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730970359661441280,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46411/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730970359791262976, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54974/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730970359791262976,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7418/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730970359791262976,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 3fc2c28c25d6
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 33c947f1b4e9
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3fc2c28c25d6. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id e20473ffe17e
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 33c947f1b4e9. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.