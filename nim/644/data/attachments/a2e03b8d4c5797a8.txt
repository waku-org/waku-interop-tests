2025-02-08 04:05:15.892 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:05:15.892 DEBUG [tests.conftest] Running test: test_publish_while_peer_is_paused with id: 2025-02-08_04-05-15__7adefecc-f08a-4a16-ad2d-19a199cc56c0
2025-02-08 04:05:15.892 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:05:15.892 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-08 04:05:15.893 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-08 04:05:15.898 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:15.899 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-08_04-05-15__7adefecc-f08a-4a16-ad2d-19a199cc56c0__wakuorg_nwaku:latest.log
2025-02-08 04:05:15.899 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:15.899 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:15.900 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:15.900 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.206.70
2025-02-08 04:05:15.900 DEBUG [src.node.docker_mananger] Generated ports ['35794', '35795', '35796', '35797', '35798']
2025-02-08 04:05:15.901 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:15.901 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:15.901 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:15.901 DEBUG [src.node.docker_mananger] docker run -i -t -p 35794:35794 -p 35795:35795 -p 35796:35796 -p 35797:35797 -p 35798:35798 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=35796 --rest-port=35794 --tcp-port=35795 --discv5-udp-port=35797 --rest-address=0.0.0.0 --nat=extip:172.18.206.70 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a70fcafd69be1e645f8b2a19e5df08fea9c8a4914fffc9fff7130398c4cf6f9e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=35798 --metrics-logging=true --relay=true
2025-02-08 04:05:16.125 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.206.70 waku 7ca7f8c64309ef0a91624e66c92f3a00b80f3ebeb795192dd8c393d9735cfe5a
2025-02-08 04:05:16.174 DEBUG [src.node.docker_mananger] Container started with ID 7ca7f8c64309. Setting up logs at ./log/docker/node1_2025-02-08_04-05-15__7adefecc-f08a-4a16-ad2d-19a199cc56c0__wakuorg_nwaku:latest.log
2025-02-08 04:05:16.176 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 35794
2025-02-08 04:05:16.176 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:16.699 ERROR [src.node.docker_mananger] Max retries reached for container c1638f9c02c4. Exiting log stream.
2025-02-08 04:05:17.176 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35794/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:17.179 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:17.179 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:17.179 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35794/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:17.182 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.206.70/tcp/35795/p2p/16Uiu2HAmVTQwYsN4GPD3XfiXrug7RQc1ne4ksmkDHPqoHUqkZzxM","/ip4/172.18.206.70/tcp/35796/ws/p2p/16Uiu2HAmVTQwYsN4GPD3XfiXrug7RQc1ne4ksmkDHPqoHUqkZzxM"],"enrUri":"enr:-L24QEoqEq0HngaDxgZ2pApsavvwemmKZ9eWko6nvSV-aMR1HAlavYc8luq-NqmAgwUA14PuZ5wK1bFMdo1GIDkP1d4CgmlkgnY0gmlwhKwSzkaKbXVsdGlhZGRyc5YACASsEs5GBovTAAoErBLORgaL1N0DgnJzhQADAQAAiXNlY3AyNTZrMaED-Z-DSLWyhiR8H1WzL5YIa-xHb_LaSN2h5h0IY3B0FP6DdGNwgovTg3VkcIKL1YV3YWt1MgE"}'
2025-02-08 04:05:17.182 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:17.188 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:17.188 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-08_04-05-15__7adefecc-f08a-4a16-ad2d-19a199cc56c0__wakuorg_nwaku:latest.log
2025-02-08 04:05:17.188 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:17.188 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:17.189 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:17.190 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.46.152
2025-02-08 04:05:17.190 DEBUG [src.node.docker_mananger] Generated ports ['28751', '28752', '28753', '28754', '28755']
2025-02-08 04:05:17.190 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:17.190 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:17.190 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:17.190 DEBUG [src.node.docker_mananger] docker run -i -t -p 28751:28751 -p 28752:28752 -p 28753:28753 -p 28754:28754 -p 28755:28755 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=28753 --rest-port=28751 --tcp-port=28752 --discv5-udp-port=28754 --rest-address=0.0.0.0 --nat=extip:172.18.46.152 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3e5a87d9dcbbebfa3fe1f893cbbaebdd2ce83b9ed0e35abf8e24c1f4bdb066c5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=28755 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QEoqEq0HngaDxgZ2pApsavvwemmKZ9eWko6nvSV-aMR1HAlavYc8luq-NqmAgwUA14PuZ5wK1bFMdo1GIDkP1d4CgmlkgnY0gmlwhKwSzkaKbXVsdGlhZGRyc5YACASsEs5GBovTAAoErBLORgaL1N0DgnJzhQADAQAAiXNlY3AyNTZrMaED-Z-DSLWyhiR8H1WzL5YIa-xHb_LaSN2h5h0IY3B0FP6DdGNwgovTg3VkcIKL1YV3YWt1MgE
2025-02-08 04:05:17.417 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.46.152 waku 975e7cd769373de396f53ff08bcef0ca97ed1496d47fc91e62879e3c76573b90
2025-02-08 04:05:17.462 DEBUG [src.node.docker_mananger] Container started with ID 975e7cd76937. Setting up logs at ./log/docker/node2_2025-02-08_04-05-15__7adefecc-f08a-4a16-ad2d-19a199cc56c0__wakuorg_nwaku:latest.log
2025-02-08 04:05:17.462 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 28751
2025-02-08 04:05:17.463 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:18.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28751/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:18.481 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:18.482 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:18.482 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28751/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:18.486 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.46.152/tcp/28752/p2p/16Uiu2HAmTwbTDzVNTsnchZnK2fs8nmEBQtfX2vhDRUyZNZ7iQ7G8","/ip4/172.18.46.152/tcp/28753/ws/p2p/16Uiu2HAmTwbTDzVNTsnchZnK2fs8nmEBQtfX2vhDRUyZNZ7iQ7G8"],"enrUri":"enr:-L24QJOfijZmzUpHOe2aCtn90MY9-Su_ehZhOpT0M7FKeZDbQKBhd7KXTzF4RkO2TMbs4nM-uPY5eEOLT9x4AkU0NhgCgmlkgnY0gmlwhKwSLpiKbXVsdGlhZGRyc5YACASsEi6YBnBQAAoErBIumAZwUd0DgnJzhQADAQAAiXNlY3AyNTZrMaED4yBJg81Oc_-loEJN7b5Ut8rY4oEIzJdmELUZAJwM5a2DdGNwgnBQg3VkcIJwUoV3YWt1MgE"}'
2025-02-08 04:05:18.486 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:18.486 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28751/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.206.70/tcp/35795/p2p/16Uiu2HAmVTQwYsN4GPD3XfiXrug7RQc1ne4ksmkDHPqoHUqkZzxM"]'
2025-02-08 04:05:18.490 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.490 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-08 04:05:18.490 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35794/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:05:18.494 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.495 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28751/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:05:18.500 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.501 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35794/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:18.506 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.506 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:05:18.607 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-08 04:05:18.607 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35794/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:18.609 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738987518501174528,"ephemeral":false}]'
2025-02-08 04:05:18.611 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:05:18.611 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28751/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:18.614 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738987518501174528,"ephemeral":false}]'
2025-02-08 04:05:18.615 INFO [src.steps.relay] WARM UP successful!!
2025-02-08 04:05:18.616 DEBUG [src.node.waku_node] Pausing container with id 975e7cd76937
2025-02-08 04:05:18.624 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35794/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:18.628 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.628 DEBUG [src.node.waku_node] Unpause container with id 975e7cd76937
2025-02-08 04:05:18.637 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28751/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:18.639 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738987518616103424,"ephemeral":false}]'
2025-02-08 04:05:18.642 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:05:18.643 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:05:18.643 DEBUG [src.node.waku_node] Stopping container with id 7ca7f8c64309
2025-02-08 04:05:19.668 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:19.669 DEBUG [src.node.waku_node] Stopping container with id 975e7cd76937
2025-02-08 04:05:20.495 ERROR [src.node.docker_mananger] Max retries reached for container 7ca7f8c64309. Exiting log stream.
2025-02-08 04:05:21.175 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:21.176 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:05:21.185 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:05:21.191 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
