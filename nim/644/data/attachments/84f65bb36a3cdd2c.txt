2025-02-08 04:04:52.214 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:04:52.214 DEBUG [tests.conftest] Running test: test_store_with_peerAddr with id: 2025-02-08_04-04-52__0adcd2a7-fe4a-40e0-8dd9-8018421d9868
2025-02-08 04:04:52.214 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:04:52.215 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-08 04:04:52.215 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-08 04:04:52.221 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:04:52.221 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-08_04-04-52__0adcd2a7-fe4a-40e0-8dd9-8018421d9868__wakuorg_nwaku:latest.log
2025-02-08 04:04:52.221 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:04:52.221 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:04:52.223 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:04:52.223 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.20.26
2025-02-08 04:04:52.223 DEBUG [src.node.docker_mananger] Generated ports ['4663', '4664', '4665', '4666', '4667']
2025-02-08 04:04:52.223 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:04:52.223 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:04:52.223 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:04:52.223 DEBUG [src.node.docker_mananger] docker run -i -t -p 4663:4663 -p 4664:4664 -p 4665:4665 -p 4666:4666 -p 4667:4667 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4665 --rest-port=4663 --tcp-port=4664 --discv5-udp-port=4666 --rest-address=0.0.0.0 --nat=extip:172.18.20.26 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=90c38511fb1bc3b98d6b0b66d19f318a2acffffbec4b6fc20fd8b833f7bb707e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4667 --metrics-logging=true --store=true --relay=true
2025-02-08 04:04:52.448 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.20.26 waku e19e7a21d887479ff555e1dd8fa0743ff0f0b669a8bafe02952b113cba3d60be
2025-02-08 04:04:52.500 DEBUG [src.node.docker_mananger] Container started with ID e19e7a21d887. Setting up logs at ./log/docker/publishing_node1_2025-02-08_04-04-52__0adcd2a7-fe4a-40e0-8dd9-8018421d9868__wakuorg_nwaku:latest.log
2025-02-08 04:04:52.500 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 4663
2025-02-08 04:04:52.501 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:04:53.019 ERROR [src.node.docker_mananger] Max retries reached for container c1b5b8738739. Exiting log stream.
2025-02-08 04:04:53.501 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4663/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:53.503 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:04:53.504 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:04:53.504 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4663/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:53.506 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.20.26/tcp/4664/p2p/16Uiu2HAm8DAHFBhvbY7CXnhCYtV3YuSS2Nbi6iBKhqDTxfqbiRVx","/ip4/172.18.20.26/tcp/4665/ws/p2p/16Uiu2HAm8DAHFBhvbY7CXnhCYtV3YuSS2Nbi6iBKhqDTxfqbiRVx"],"enrUri":"enr:-L24QHgX5b39iURK2n_pIqyjHElSWRjiI8FN0eEd8Ngx9AJwTHjhIpRr5p0rhnazKrAsikBfHm18m91pyYo4GC0CzwUCgmlkgnY0gmlwhKwSFBqKbXVsdGlhZGRyc5YACASsEhQaBhI4AAoErBIUGgYSOd0DgnJzhQADAQAAiXNlY3AyNTZrMaECvfNhI3scbROQb4DMfUhoiT9Q0IDVq88T4v94iopi3XeDdGNwghI4g3VkcIISOoV3YWt1MgM"}'
2025-02-08 04:04:53.506 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:04:53.512 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:04:53.513 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-08_04-04-52__0adcd2a7-fe4a-40e0-8dd9-8018421d9868__wakuorg_nwaku:latest.log
2025-02-08 04:04:53.513 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:04:53.513 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:04:53.514 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:04:53.514 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.191.131
2025-02-08 04:04:53.515 DEBUG [src.node.docker_mananger] Generated ports ['28230', '28231', '28232', '28233', '28234']
2025-02-08 04:04:53.515 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:04:53.515 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:04:53.515 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:04:53.515 DEBUG [src.node.docker_mananger] docker run -i -t -p 28230:28230 -p 28231:28231 -p 28232:28232 -p 28233:28233 -p 28234:28234 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=28232 --rest-port=28230 --tcp-port=28231 --discv5-udp-port=28233 --rest-address=0.0.0.0 --nat=extip:172.18.191.131 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fb7bd51d56d803a3b2b62df7b779cd4bbe0cfcf5c6f7b8801facb9f8dc0daaf6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=28234 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHgX5b39iURK2n_pIqyjHElSWRjiI8FN0eEd8Ngx9AJwTHjhIpRr5p0rhnazKrAsikBfHm18m91pyYo4GC0CzwUCgmlkgnY0gmlwhKwSFBqKbXVsdGlhZGRyc5YACASsEhQaBhI4AAoErBIUGgYSOd0DgnJzhQADAQAAiXNlY3AyNTZrMaECvfNhI3scbROQb4DMfUhoiT9Q0IDVq88T4v94iopi3XeDdGNwghI4g3VkcIISOoV3YWt1MgM --storenode=/ip4/172.18.20.26/tcp/4664/p2p/16Uiu2HAm8DAHFBhvbY7CXnhCYtV3YuSS2Nbi6iBKhqDTxfqbiRVx --store=true --relay=true
2025-02-08 04:04:53.748 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.191.131 waku 2b742a8cb1cc268bae28327e1ae7674ac1d0f68d23a3c66428f5ed9f47654873
2025-02-08 04:04:53.801 DEBUG [src.node.docker_mananger] Container started with ID 2b742a8cb1cc. Setting up logs at ./log/docker/store_node1_2025-02-08_04-04-52__0adcd2a7-fe4a-40e0-8dd9-8018421d9868__wakuorg_nwaku:latest.log
2025-02-08 04:04:53.803 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 28230
2025-02-08 04:04:53.803 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:04:54.803 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28230/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:54.806 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:04:54.806 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:04:54.806 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28230/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:54.808 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.191.131/tcp/28231/p2p/16Uiu2HAmF6cjoPuLDJgMJddavabCTuJAi8DMP85KTdNW8EYDNm7Y","/ip4/172.18.191.131/tcp/28232/ws/p2p/16Uiu2HAmF6cjoPuLDJgMJddavabCTuJAi8DMP85KTdNW8EYDNm7Y"],"enrUri":"enr:-L24QNPx91p7bhNCHwh7kWyCZ84pq6u8fGKTHlDLy8rANZDNU4WXg0ipZoaEUd9WQzzAef96vPOqBVHY3SXiBaxY6yUCgmlkgnY0gmlwhKwSv4OKbXVsdGlhZGRyc5YACASsEr-DBm5HAAoErBK_gwZuSN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDJEgJyyPwAi6T1bJ-bK_t90LoOcqnoQ0TWsnpzrJsvdODdGNwgm5Hg3VkcIJuSYV3YWt1MgM"}'
2025-02-08 04:04:54.808 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:04:54.808 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28230/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.20.26/tcp/4664/p2p/16Uiu2HAm8DAHFBhvbY7CXnhCYtV3YuSS2Nbi6iBKhqDTxfqbiRVx"]'
2025-02-08 04:05:03.799 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:03.799 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4663/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 04:05:03.802 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:03.802 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28230/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 04:05:03.804 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:03.805 DEBUG [src.steps.store] Relaying message
2025-02-08 04:05:03.805 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4663/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:03.812 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:03.812 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-08 04:05:04.013 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-08 04:05:04.013 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28230/store/v3/messages?peerAddr=%2Fip4%2F172.18.20.26%2Ftcp%2F4664%2Fp2p%2F16Uiu2HAm8DAHFBhvbY7CXnhCYtV3YuSS2Nbi6iBKhqDTxfqbiRVx&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:04.020 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"a3febc283c93706d374d","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x2d79c9058e965181c1bed7713055008a2d4ec39989b56460b2e21570f4ba44db"}]}'
2025-02-08 04:05:04.022 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:05:04.023 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:05:04.023 DEBUG [src.node.waku_node] Stopping container with id e19e7a21d887
2025-02-08 04:05:05.001 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:05.001 DEBUG [src.node.waku_node] Stopping container with id 2b742a8cb1cc
2025-02-08 04:05:05.780 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:05.781 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:05:05.788 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:05:05.794 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
