2025-02-08 04:04:13.264 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:04:13.265 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/5/999] with id: 2025-02-08_04-04-13__18d94cfc-066e-47e9-8343-d0a6f60df337
2025-02-08 04:04:13.265 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:04:13.265 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-08 04:04:13.265 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-08 04:04:13.272 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:04:13.272 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-08_04-04-13__18d94cfc-066e-47e9-8343-d0a6f60df337__wakuorg_nwaku:latest.log
2025-02-08 04:04:13.272 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:04:13.272 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:04:13.273 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:04:13.274 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.30.18
2025-02-08 04:04:13.274 DEBUG [src.node.docker_mananger] Generated ports ['55929', '55930', '55931', '55932', '55933']
2025-02-08 04:04:13.274 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-08 04:04:13.274 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:04:13.274 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:04:13.274 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:04:13.274 DEBUG [src.node.docker_mananger] docker run -i -t -p 55929:55929 -p 55930:55930 -p 55931:55931 -p 55932:55932 -p 55933:55933 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55931 --rest-port=55929 --tcp-port=55930 --discv5-udp-port=55932 --rest-address=0.0.0.0 --nat=extip:172.18.30.18 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=aefffaba9331ced92a3d3fda598aad09da8ce7aa84a15f1c00d307ab8edffcfc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55933 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/5/999
2025-02-08 04:04:13.500 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.30.18 waku 71fe4afe6723d8bd97b15d35660c38229c14e2ef1423fcbe022ec95c9f721555
2025-02-08 04:04:13.551 DEBUG [src.node.docker_mananger] Container started with ID 71fe4afe6723. Setting up logs at ./log/docker/node1_2025-02-08_04-04-13__18d94cfc-066e-47e9-8343-d0a6f60df337__wakuorg_nwaku:latest.log
2025-02-08 04:04:13.551 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55929
2025-02-08 04:04:13.552 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:04:14.066 ERROR [src.node.docker_mananger] Max retries reached for container b43dfb6641aa. Exiting log stream.
2025-02-08 04:04:14.553 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55929/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:14.555 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:04:14.555 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:04:14.556 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55929/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:14.558 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.30.18/tcp/55930/p2p/16Uiu2HAm4NLMoLm2Qk9KnYXCTeYkyWLe6X8qFpjWBziZsbPdUWvA","/ip4/172.18.30.18/tcp/55931/ws/p2p/16Uiu2HAm4NLMoLm2Qk9KnYXCTeYkyWLe6X8qFpjWBziZsbPdUWvA"],"enrUri":"enr:-L24QCfnNcVYKD33-CDiuYVcXUeIWi79E5w3FK3UGWvrgbZ7J7MRZ7R6pwBXJ5YyNwVnC6yzBixY-HstNE6PwsHMaiYCgmlkgnY0gmlwhKwSHhKKbXVsdGlhZGRyc5YACASsEh4SBtp6AAoErBIeEgbae90DgnJzhQAFAQPniXNlY3AyNTZrMaEChN5BPbRW5-pSCxwW9XzL9KMUcTcJCx1xfBBLrmhBzNeDdGNwgtp6g3VkcILafIV3YWt1MgU"}'
2025-02-08 04:04:14.558 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:04:14.564 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:04:14.564 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-08_04-04-13__18d94cfc-066e-47e9-8343-d0a6f60df337__wakuorg_nwaku:latest.log
2025-02-08 04:04:14.564 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:04:14.565 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:04:14.566 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:04:14.566 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.217.9
2025-02-08 04:04:14.566 DEBUG [src.node.docker_mananger] Generated ports ['8554', '8555', '8556', '8557', '8558']
2025-02-08 04:04:14.566 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-08 04:04:14.567 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:04:14.567 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:04:14.567 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:04:14.567 DEBUG [src.node.docker_mananger] docker run -i -t -p 8554:8554 -p 8555:8555 -p 8556:8556 -p 8557:8557 -p 8558:8558 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8556 --rest-port=8554 --tcp-port=8555 --discv5-udp-port=8557 --rest-address=0.0.0.0 --nat=extip:172.18.217.9 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=6b6a1b6035418c526f17b03f1fa2ede6f598ed71dc1cb9adaf2d5eac4c7dd0ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8558 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QCfnNcVYKD33-CDiuYVcXUeIWi79E5w3FK3UGWvrgbZ7J7MRZ7R6pwBXJ5YyNwVnC6yzBixY-HstNE6PwsHMaiYCgmlkgnY0gmlwhKwSHhKKbXVsdGlhZGRyc5YACASsEh4SBtp6AAoErBIeEgbae90DgnJzhQAFAQPniXNlY3AyNTZrMaEChN5BPbRW5-pSCxwW9XzL9KMUcTcJCx1xfBBLrmhBzNeDdGNwgtp6g3VkcILafIV3YWt1MgU --pubsub-topic=/waku/2/rs/5/999
2025-02-08 04:04:14.793 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.217.9 waku ca7d95128aa40919d9ae6b49d5f0ab3430f4c02a6c149cbaef1776bf9aa1f967
2025-02-08 04:04:14.839 DEBUG [src.node.docker_mananger] Container started with ID ca7d95128aa4. Setting up logs at ./log/docker/node2_2025-02-08_04-04-13__18d94cfc-066e-47e9-8343-d0a6f60df337__wakuorg_nwaku:latest.log
2025-02-08 04:04:14.839 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8554
2025-02-08 04:04:14.840 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:04:15.840 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8554/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:15.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:04:15.860 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:04:15.860 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8554/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:15.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.217.9/tcp/8555/p2p/16Uiu2HAmV8H1jkA1muRnKrvnjc4dacUtsuQ5GYH8hqU9Je8YYdMr","/ip4/172.18.217.9/tcp/8556/ws/p2p/16Uiu2HAmV8H1jkA1muRnKrvnjc4dacUtsuQ5GYH8hqU9Je8YYdMr"],"enrUri":"enr:-L24QCoE3qAOWi_Xb-qI6W-IuyFdkp6PKiCJ6o7p-ro6zUf3ewUhuGxvJAt64ffXB1_2m2s3u-zaaCX8yvFUCnoXtHICgmlkgnY0gmlwhKwS2QmKbXVsdGlhZGRyc5YACASsEtkJBiFrAAoErBLZCQYhbN0DgnJzhQAFAQPniXNlY3AyNTZrMaED9LiDcj-koeKJF3o0pLO9lQH_GBuayMBoB1ibgoNUBLGDdGNwgiFrg3VkcIIhbYV3YWt1MgE"}'
2025-02-08 04:04:15.863 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:04:15.864 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8554/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.30.18/tcp/55930/p2p/16Uiu2HAm4NLMoLm2Qk9KnYXCTeYkyWLe6X8qFpjWBziZsbPdUWvA"]'
2025-02-08 04:04:15.866 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:04:15.867 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55929/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/999"]'
2025-02-08 04:04:15.869 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:04:15.869 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8554/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/999"]'
2025-02-08 04:04:15.871 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:04:15.872 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55929/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:04:15.877 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:04:15.877 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:04:15.978 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-08 04:04:15.978 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55929/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:15.980 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738987455872432896,"ephemeral":false}]'
2025-02-08 04:04:15.982 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:04:15.982 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8554/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:04:15.984 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738987455872432896,"ephemeral":false}]'
2025-02-08 04:04:15.987 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:04:15.988 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:04:15.988 DEBUG [src.node.waku_node] Stopping container with id 71fe4afe6723
2025-02-08 04:04:17.025 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:04:17.025 DEBUG [src.node.waku_node] Stopping container with id ca7d95128aa4
2025-02-08 04:04:17.836 ERROR [src.node.docker_mananger] Max retries reached for container 71fe4afe6723. Exiting log stream.
2025-02-08 04:04:18.519 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:04:18.521 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:04:18.527 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:04:18.531 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
