2025-02-08 04:05:42.473 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:05:42.473 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-08_04-05-42__b99e75b8-81ec-4a4c-9d84-1e4b0bdc5d24
2025-02-08 04:05:42.473 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:05:42.473 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-08 04:05:42.474 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-08 04:05:42.482 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:42.482 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-08_04-05-42__b99e75b8-81ec-4a4c-9d84-1e4b0bdc5d24__wakuorg_nwaku:latest.log
2025-02-08 04:05:42.483 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:42.483 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:42.484 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:42.484 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.37.213
2025-02-08 04:05:42.484 DEBUG [src.node.docker_mananger] Generated ports ['60146', '60147', '60148', '60149', '60150']
2025-02-08 04:05:42.485 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:42.485 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:42.485 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:42.485 DEBUG [src.node.docker_mananger] docker run -i -t -p 60146:60146 -p 60147:60147 -p 60148:60148 -p 60149:60149 -p 60150:60150 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60148 --rest-port=60146 --tcp-port=60147 --discv5-udp-port=60149 --rest-address=0.0.0.0 --nat=extip:172.18.37.213 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cca53eeabbf83eff8c5fefdfcd9fedb67fbecead9a54c519af593b85fcd50ebd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60150 --metrics-logging=true --relay=true
2025-02-08 04:05:42.718 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.37.213 waku 4073ae31a92b517775f48e3186b331bfc9701f3b071a50ed2f1d9ce883aa793d
2025-02-08 04:05:42.766 DEBUG [src.node.docker_mananger] Container started with ID 4073ae31a92b. Setting up logs at ./log/docker/node1_2025-02-08_04-05-42__b99e75b8-81ec-4a4c-9d84-1e4b0bdc5d24__wakuorg_nwaku:latest.log
2025-02-08 04:05:42.767 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60146
2025-02-08 04:05:42.768 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:43.245 ERROR [src.node.docker_mananger] Max retries reached for container 67d2def4b2a2. Exiting log stream.
2025-02-08 04:05:43.768 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60146/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:43.771 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:43.771 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:43.772 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60146/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:43.774 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.37.213/tcp/60147/p2p/16Uiu2HAkuYF2PoTwRhc8XqGRaXE7aHZrghsvSpT5SZP9cJFiHFJg","/ip4/172.18.37.213/tcp/60148/ws/p2p/16Uiu2HAkuYF2PoTwRhc8XqGRaXE7aHZrghsvSpT5SZP9cJFiHFJg"],"enrUri":"enr:-L24QP_mUTGFmXXNuWRg0UAiUpwF4e8vxGpN2E8adQ3PhOEpFKaStjyhYE9fQRzxotIBtF9VLbxkhvPOVqJG8WFn42wCgmlkgnY0gmlwhKwSJdWKbXVsdGlhZGRyc5YACASsEiXVBurzAAoErBIl1Qbq9N0DgnJzhQADAQAAiXNlY3AyNTZrMaECAa7ZSOHiLcXx5q-LojP4WQrQH9zUgi8GnFJeppCriomDdGNwgurzg3VkcILq9YV3YWt1MgE"}'
2025-02-08 04:05:43.774 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:43.784 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:43.784 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-08_04-05-42__b99e75b8-81ec-4a4c-9d84-1e4b0bdc5d24__wakuorg_nwaku:latest.log
2025-02-08 04:05:43.784 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:43.784 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:43.786 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:43.786 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.122.217
2025-02-08 04:05:43.786 DEBUG [src.node.docker_mananger] Generated ports ['57251', '57252', '57253', '57254', '57255']
2025-02-08 04:05:43.786 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:43.786 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:43.786 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:43.786 DEBUG [src.node.docker_mananger] docker run -i -t -p 57251:57251 -p 57252:57252 -p 57253:57253 -p 57254:57254 -p 57255:57255 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57253 --rest-port=57251 --tcp-port=57252 --discv5-udp-port=57254 --rest-address=0.0.0.0 --nat=extip:172.18.122.217 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=45cc5b8bce2b19c1d2fe6facd0af06cc4d9eec19dbb0f23eeeccac1876c8bcdc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57255 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QP_mUTGFmXXNuWRg0UAiUpwF4e8vxGpN2E8adQ3PhOEpFKaStjyhYE9fQRzxotIBtF9VLbxkhvPOVqJG8WFn42wCgmlkgnY0gmlwhKwSJdWKbXVsdGlhZGRyc5YACASsEiXVBurzAAoErBIl1Qbq9N0DgnJzhQADAQAAiXNlY3AyNTZrMaECAa7ZSOHiLcXx5q-LojP4WQrQH9zUgi8GnFJeppCriomDdGNwgurzg3VkcILq9YV3YWt1MgE
2025-02-08 04:05:44.027 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.122.217 waku 16ed41bc9b3df1d72c535a09828d123914414a4da08d2ad720279479037f53f2
2025-02-08 04:05:44.078 DEBUG [src.node.docker_mananger] Container started with ID 16ed41bc9b3d. Setting up logs at ./log/docker/node2_2025-02-08_04-05-42__b99e75b8-81ec-4a4c-9d84-1e4b0bdc5d24__wakuorg_nwaku:latest.log
2025-02-08 04:05:44.078 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57251
2025-02-08 04:05:44.078 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:45.082 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57251/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:45.090 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:45.090 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:45.090 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57251/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:45.094 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.122.217/tcp/57252/p2p/16Uiu2HAmNC6Jw2AEAGtuTsxTMKDgM77mAJetDAFBGsFL4K5kwNJK","/ip4/172.18.122.217/tcp/57253/ws/p2p/16Uiu2HAmNC6Jw2AEAGtuTsxTMKDgM77mAJetDAFBGsFL4K5kwNJK"],"enrUri":"enr:-L24QJEzryBbbFYSb_wZM4Qf5BRRI90ARZXgN-9IlX-AcWcJZMDdKCvdiIrS5IviBtxFXnJXCxs7eNWVQkSLqi5SJD0CgmlkgnY0gmlwhKwSetmKbXVsdGlhZGRyc5YACASsEnrZBt-kAAoErBJ62Qbfpd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDjbDs-TG7SQIz7ssxPurlRiZyhfS_kbvIVevyUlFLE4CDdGNwgt-kg3VkcILfpoV3YWt1MgE"}'
2025-02-08 04:05:45.094 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:45.094 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57251/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.37.213/tcp/60147/p2p/16Uiu2HAkuYF2PoTwRhc8XqGRaXE7aHZrghsvSpT5SZP9cJFiHFJg"]'
2025-02-08 04:05:45.097 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:45.097 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-08 04:05:45.098 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:05:45.101 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:45.101 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57251/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:05:45.107 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:45.108 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.114 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:45.115 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:05:45.215 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-08 04:05:45.215 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:45.218 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738987545108710912,"ephemeral":false}]'
2025-02-08 04:05:45.219 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:05:45.219 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57251/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:45.222 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738987545108710912,"ephemeral":false}]'
2025-02-08 04:05:45.223 INFO [src.steps.relay] WARM UP successful!!
2025-02-08 04:05:45.224 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-08 04:05:45.224 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.226 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-08 04:05:45.227 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-08 04:05:45.228 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.230 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-08 04:05:45.231 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-08 04:05:45.231 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.233 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-08 04:05:45.234 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-08 04:05:45.234 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.236 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-08 04:05:45.237 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-08 04:05:45.237 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.240 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-08 04:05:45.240 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-08 04:05:45.241 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.243 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-08 04:05:45.244 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-08 04:05:45.244 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:05:45.246 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60146/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-08 04:05:45.249 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:05:45.250 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:05:45.250 DEBUG [src.node.waku_node] Stopping container with id 4073ae31a92b
2025-02-08 04:05:46.275 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:46.275 DEBUG [src.node.waku_node] Stopping container with id 16ed41bc9b3d
2025-02-08 04:05:47.089 ERROR [src.node.docker_mananger] Max retries reached for container 4073ae31a92b. Exiting log stream.
2025-02-08 04:05:47.792 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:47.793 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:05:47.798 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:05:47.803 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
