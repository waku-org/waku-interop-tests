2025-02-08 04:08:00.173 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:08:00.173 DEBUG [tests.conftest] Running test: test_store_with_filter with id: 2025-02-08_04-08-00__5254808c-4f7d-421b-a56a-8d80194f7dd2
2025-02-08 04:08:00.173 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:08:00.173 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-08 04:08:00.180 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:08:00.180 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-08_04-08-00__5254808c-4f7d-421b-a56a-8d80194f7dd2__wakuorg_nwaku:latest.log
2025-02-08 04:08:00.180 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:08:00.180 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:08:00.182 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:08:00.182 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.202.144
2025-02-08 04:08:00.182 DEBUG [src.node.docker_mananger] Generated ports ['13240', '13241', '13242', '13243', '13244']
2025-02-08 04:08:00.182 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:08:00.182 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:08:00.182 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:08:00.182 DEBUG [src.node.docker_mananger] docker run -i -t -p 13240:13240 -p 13241:13241 -p 13242:13242 -p 13243:13243 -p 13244:13244 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13242 --rest-port=13240 --tcp-port=13241 --discv5-udp-port=13243 --rest-address=0.0.0.0 --nat=extip:172.18.202.144 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f7ccbc670cccb4778fc2d86613d9a0fba107da4bdf9bcf6b9bd9bf36f8f55feb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13244 --metrics-logging=true --store=true --relay=true --filter=true
2025-02-08 04:08:00.407 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.202.144 waku 4343f76356feea747343566a6e3552d748419171992b11269b5463732e91c249
2025-02-08 04:08:00.459 DEBUG [src.node.docker_mananger] Container started with ID 4343f76356fe. Setting up logs at ./log/docker/publishing_node1_2025-02-08_04-08-00__5254808c-4f7d-421b-a56a-8d80194f7dd2__wakuorg_nwaku:latest.log
2025-02-08 04:08:00.460 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 13240
2025-02-08 04:08:00.460 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:08:00.972 ERROR [src.node.docker_mananger] Max retries reached for container 81adafd03a04. Exiting log stream.
2025-02-08 04:08:01.461 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13240/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:08:01.464 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:08:01.464 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:08:01.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13240/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:08:01.466 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.202.144/tcp/13241/p2p/16Uiu2HAkzEucsFzzuqLc3m7bpNkvKA5YmXnn2mYnocRFP3B8Hod2","/ip4/172.18.202.144/tcp/13242/ws/p2p/16Uiu2HAkzEucsFzzuqLc3m7bpNkvKA5YmXnn2mYnocRFP3B8Hod2"],"enrUri":"enr:-L24QIxvoTgQEwfRa-61JL3PEyEkQKIRK6wnKfFzinyqERtxZeDP8rsD4EwxRWpIllQDctUk1ZCz1QmFC8iMG3gI5_oCgmlkgnY0gmlwhKwSypCKbXVsdGlhZGRyc5YACASsEsqQBjO5AAoErBLKkAYzut0DgnJzhQADAQAAiXNlY3AyNTZrMaECR4h3tohMGaRt576wqMbuCkleq8cyekMvK6exwSyrWFGDdGNwgjO5g3VkcIIzu4V3YWt1Mgc"}'
2025-02-08 04:08:01.466 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:08:01.472 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:08:01.473 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-08_04-08-00__5254808c-4f7d-421b-a56a-8d80194f7dd2__wakuorg_nwaku:latest.log
2025-02-08 04:08:01.473 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:08:01.473 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:08:01.474 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:08:01.474 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.245.56
2025-02-08 04:08:01.474 DEBUG [src.node.docker_mananger] Generated ports ['54626', '54627', '54628', '54629', '54630']
2025-02-08 04:08:01.475 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:08:01.475 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:08:01.475 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:08:01.475 DEBUG [src.node.docker_mananger] docker run -i -t -p 54626:54626 -p 54627:54627 -p 54628:54628 -p 54629:54629 -p 54630:54630 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54628 --rest-port=54626 --tcp-port=54627 --discv5-udp-port=54629 --rest-address=0.0.0.0 --nat=extip:172.18.245.56 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=578e744fdec64c3bc1fceb480358c186bac3facf74fbfe40ae8fa18048e1db4b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54630 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QIxvoTgQEwfRa-61JL3PEyEkQKIRK6wnKfFzinyqERtxZeDP8rsD4EwxRWpIllQDctUk1ZCz1QmFC8iMG3gI5_oCgmlkgnY0gmlwhKwSypCKbXVsdGlhZGRyc5YACASsEsqQBjO5AAoErBLKkAYzut0DgnJzhQADAQAAiXNlY3AyNTZrMaECR4h3tohMGaRt576wqMbuCkleq8cyekMvK6exwSyrWFGDdGNwgjO5g3VkcIIzu4V3YWt1Mgc --storenode=/ip4/172.18.202.144/tcp/13241/p2p/16Uiu2HAkzEucsFzzuqLc3m7bpNkvKA5YmXnn2mYnocRFP3B8Hod2 --store=false --relay=false --filter=true
2025-02-08 04:08:01.703 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.245.56 waku 9135d4ec83f42b967437155bdef416b90983d924406a74faf44c9c1456496db9
2025-02-08 04:08:01.754 DEBUG [src.node.docker_mananger] Container started with ID 9135d4ec83f4. Setting up logs at ./log/docker/store_node1_2025-02-08_04-08-00__5254808c-4f7d-421b-a56a-8d80194f7dd2__wakuorg_nwaku:latest.log
2025-02-08 04:08:01.754 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54626
2025-02-08 04:08:01.754 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:08:02.755 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54626/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:08:02.758 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:08:02.758 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:08:02.758 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54626/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:08:02.760 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.245.56/tcp/54627/p2p/16Uiu2HAmTA7fjYz3QXHeS9SA54AGUJquBK37weegwSYN8VbDowjS","/ip4/172.18.245.56/tcp/54628/ws/p2p/16Uiu2HAmTA7fjYz3QXHeS9SA54AGUJquBK37weegwSYN8VbDowjS"],"enrUri":"enr:-L24QKqO9E4JdEw-_MPiUedLG9NH9CKeLcf7OBMAJzSLdBGBJPjTxfTzkqsocQvOnSHv50N-qwIWAwu7bSA0JK4twMcCgmlkgnY0gmlwhKwS9TiKbXVsdGlhZGRyc5YACASsEvU4BtVjAAoErBL1OAbVZN0DgnJzhQADAQAAiXNlY3AyNTZrMaED13m8JIl4X7UtJorfKm6a3czNqjWFvWJ0mnDjOvb9FeWDdGNwgtVjg3VkcILVZYV3YWt1MgQ"}'
2025-02-08 04:08:02.760 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:08:02.761 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54626/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.202.144/tcp/13241/p2p/16Uiu2HAkzEucsFzzuqLc3m7bpNkvKA5YmXnn2mYnocRFP3B8Hod2"]'
2025-02-08 04:08:02.796 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:08:02.797 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13240/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 04:08:02.816 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:08:02.817 DEBUG [src.steps.store] Relaying message
2025-02-08 04:08:02.817 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13240/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:08:02.823 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:08:02.824 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-08 04:08:03.025 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-08 04:08:03.026 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13240/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:08:03.028 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xab5891b8a60d0098043d5fcb5d87b921ed1852d545df90b396d640ae42204243"}]}'
2025-02-08 04:08:03.029 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-08 04:08:03.029 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54626/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:08:03.036 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"890573b58342071365c7","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xab5891b8a60d0098043d5fcb5d87b921ed1852d545df90b396d640ae42204243"}]}'
2025-02-08 04:08:03.038 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:08:03.039 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:08:03.039 DEBUG [src.node.waku_node] Stopping container with id 4343f76356fe
2025-02-08 04:08:03.976 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:08:03.977 DEBUG [src.node.waku_node] Stopping container with id 9135d4ec83f4
2025-02-08 04:08:04.787 ERROR [src.node.docker_mananger] Max retries reached for container 4343f76356fe. Exiting log stream.
2025-02-08 04:08:05.479 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:08:05.480 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:08:05.485 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:08:05.489 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
