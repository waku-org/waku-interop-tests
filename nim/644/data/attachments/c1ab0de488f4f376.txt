2025-02-08 04:05:14.890 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:05:14.891 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-08_04-05-14__68ed955d-8b61-43e5-854c-fca309d675e8
2025-02-08 04:05:14.891 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:05:14.891 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-08 04:05:14.891 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-08 04:05:14.892 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-08 04:05:14.892 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-08 04:05:14.899 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:14.899 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-08_04-05-14__68ed955d-8b61-43e5-854c-fca309d675e8__wakuorg_nwaku:latest.log
2025-02-08 04:05:14.899 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:14.899 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:14.901 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:14.901 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.186.61
2025-02-08 04:05:14.901 DEBUG [src.node.docker_mananger] Generated ports ['62238', '62239', '62240', '62241', '62242']
2025-02-08 04:05:14.901 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:14.901 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:14.902 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:14.902 DEBUG [src.node.docker_mananger] docker run -i -t -p 62238:62238 -p 62239:62239 -p 62240:62240 -p 62241:62241 -p 62242:62242 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62240 --rest-port=62238 --tcp-port=62239 --discv5-udp-port=62241 --rest-address=0.0.0.0 --nat=extip:172.18.186.61 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4d2bbab91ab230fad31f6ea93e59bbd28c56d55bfc6dec5caad9ecebaa2a1a71 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62242 --metrics-logging=true --lightpush=true --relay=true
2025-02-08 04:05:15.146 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.186.61 waku dc951acfb91ca85a8f6db34703349be330c3d8f301f9dfd86bc2b5d27ef984be
2025-02-08 04:05:15.198 DEBUG [src.node.docker_mananger] Container started with ID dc951acfb91c. Setting up logs at ./log/docker/receiving_node1_2025-02-08_04-05-14__68ed955d-8b61-43e5-854c-fca309d675e8__wakuorg_nwaku:latest.log
2025-02-08 04:05:15.199 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62238
2025-02-08 04:05:15.200 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:15.663 ERROR [src.node.docker_mananger] Max retries reached for container ac0619e6418b. Exiting log stream.
2025-02-08 04:05:16.200 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62238/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:16.203 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:16.203 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:16.203 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62238/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:16.206 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.186.61/tcp/62239/p2p/16Uiu2HAmJtCakrZWArt1TaVH4e6U7WLa5jC2b7fsVYhVWdvmoWqh","/ip4/172.18.186.61/tcp/62240/ws/p2p/16Uiu2HAmJtCakrZWArt1TaVH4e6U7WLa5jC2b7fsVYhVWdvmoWqh"],"enrUri":"enr:-L24QI6TUrV044tRY7LyXJJumjEAcdZ7Gqyb8jVrvqPHTcrcScs3mW2rHz2Id2xcFyzbFn01mW129CxsnSd7rPJkkhgCgmlkgnY0gmlwhKwSuj2KbXVsdGlhZGRyc5YACASsEro9BvMfAAoErBK6PQbzIN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDXIiAyGl8vy-zDGkPJnW0U5sJRKZ_F69O5zLuo2iZTayDdGNwgvMfg3VkcILzIYV3YWt1Mgk"}'
2025-02-08 04:05:16.206 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:16.212 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:16.212 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-08_04-05-14__68ed955d-8b61-43e5-854c-fca309d675e8__wakuorg_nwaku:latest.log
2025-02-08 04:05:16.213 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:16.213 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:16.214 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:16.214 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.42.45
2025-02-08 04:05:16.214 DEBUG [src.node.docker_mananger] Generated ports ['16858', '16859', '16860', '16861', '16862']
2025-02-08 04:05:16.214 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:16.214 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:16.215 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:16.215 DEBUG [src.node.docker_mananger] docker run -i -t -p 16858:16858 -p 16859:16859 -p 16860:16860 -p 16861:16861 -p 16862:16862 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16860 --rest-port=16858 --tcp-port=16859 --discv5-udp-port=16861 --rest-address=0.0.0.0 --nat=extip:172.18.42.45 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8e60292fc3fdeffe2beddec37bbc84b9b8793455267bb1e3ebbd50c300a4d49c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16862 --metrics-logging=true --lightpush=false --relay=true
2025-02-08 04:05:16.448 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.42.45 waku 5d76a9a784bde4fd8e6370b4c03fcd5a92ee49293bc3dabd5cfa094206c808b3
2025-02-08 04:05:16.494 DEBUG [src.node.docker_mananger] Container started with ID 5d76a9a784bd. Setting up logs at ./log/docker/receiving_node2_2025-02-08_04-05-14__68ed955d-8b61-43e5-854c-fca309d675e8__wakuorg_nwaku:latest.log
2025-02-08 04:05:16.494 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16858
2025-02-08 04:05:16.495 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:17.495 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16858/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:17.498 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:17.498 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:17.498 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16858/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:17.500 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.42.45/tcp/16859/p2p/16Uiu2HAmCFVXxuBToRvNaraVC9uK6uQJL24nztBJh96hYm8UPHpG","/ip4/172.18.42.45/tcp/16860/ws/p2p/16Uiu2HAmCFVXxuBToRvNaraVC9uK6uQJL24nztBJh96hYm8UPHpG"],"enrUri":"enr:-L24QDi7CFGv9Tj-ATWlnoKRkZyxW1_tUXxrTot5aiGPQTmWZupBSJAW8_oL8BtUfIo7qlekVP0-Yip4kbAmJc01Yy0CgmlkgnY0gmlwhKwSKi2KbXVsdGlhZGRyc5YACASsEiotBkHbAAoErBIqLQZB3N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-fsPIHszrPy6aePPzRbKwkzgG7hFnfb_Ltg_RfZtxvWDdGNwgkHbg3VkcIJB3YV3YWt1MgE"}'
2025-02-08 04:05:17.500 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:17.501 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16858/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.186.61/tcp/62239/p2p/16Uiu2HAmJtCakrZWArt1TaVH4e6U7WLa5jC2b7fsVYhVWdvmoWqh"]'
2025-02-08 04:05:17.543 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:17.553 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:17.553 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-08_04-05-14__68ed955d-8b61-43e5-854c-fca309d675e8__wakuorg_nwaku:latest.log
2025-02-08 04:05:17.553 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:17.553 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:17.554 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:17.555 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.35.181
2025-02-08 04:05:17.555 DEBUG [src.node.docker_mananger] Generated ports ['62662', '62663', '62664', '62665', '62666']
2025-02-08 04:05:17.555 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:17.555 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:17.555 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:17.555 DEBUG [src.node.docker_mananger] docker run -i -t -p 62662:62662 -p 62663:62663 -p 62664:62664 -p 62665:62665 -p 62666:62666 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62664 --rest-port=62662 --tcp-port=62663 --discv5-udp-port=62665 --rest-address=0.0.0.0 --nat=extip:172.18.35.181 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b5efdddb7bcca76eb1d7b7d3d06a1a0e284effb66ee970bc9d4ec8fbad02f5db --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62666 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QI6TUrV044tRY7LyXJJumjEAcdZ7Gqyb8jVrvqPHTcrcScs3mW2rHz2Id2xcFyzbFn01mW129CxsnSd7rPJkkhgCgmlkgnY0gmlwhKwSuj2KbXVsdGlhZGRyc5YACASsEro9BvMfAAoErBK6PQbzIN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDXIiAyGl8vy-zDGkPJnW0U5sJRKZ_F69O5zLuo2iZTayDdGNwgvMfg3VkcILzIYV3YWt1Mgk --lightpushnode=/ip4/172.18.186.61/tcp/62239/p2p/16Uiu2HAmJtCakrZWArt1TaVH4e6U7WLa5jC2b7fsVYhVWdvmoWqh --lightpush=true --relay=false
2025-02-08 04:05:17.802 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.35.181 waku f78e5703fab5bd8ae91d03ee4ff932e99012035454f90df617d0ae5cc74c1d85
2025-02-08 04:05:17.851 DEBUG [src.node.docker_mananger] Container started with ID f78e5703fab5. Setting up logs at ./log/docker/lightpush_node1_2025-02-08_04-05-14__68ed955d-8b61-43e5-854c-fca309d675e8__wakuorg_nwaku:latest.log
2025-02-08 04:05:17.852 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62662
2025-02-08 04:05:17.852 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:18.852 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62662/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:18.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:18.856 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:18.856 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62662/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:18.858 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.35.181/tcp/62663/p2p/16Uiu2HAmLVoKEKcTKdi7N1GCKqr4wa9CnCQbMgc1uyDuouw2hftX","/ip4/172.18.35.181/tcp/62664/ws/p2p/16Uiu2HAmLVoKEKcTKdi7N1GCKqr4wa9CnCQbMgc1uyDuouw2hftX"],"enrUri":"enr:-L24QHqObqnsfQH2PW4NrkvChh-dCfyhtttb2ViXgsaGCQ5rBslnwqn4Ifh2gcZHk52Z0v6LaA0qY1amUKlGund3Ca0CgmlkgnY0gmlwhKwSI7WKbXVsdGlhZGRyc5YACASsEiO1BvTHAAoErBIjtQb0yN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDdILKTUt6Noj8LWhwthm0pNjz0tGBhUaUc5R3okX6hhSDdGNwgvTHg3VkcIL0yYV3YWt1Mgg"}'
2025-02-08 04:05:18.858 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:18.858 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62662/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.186.61/tcp/62239/p2p/16Uiu2HAmJtCakrZWArt1TaVH4e6U7WLa5jC2b7fsVYhVWdvmoWqh"]'
2025-02-08 04:05:18.902 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.902 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62662/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.42.45/tcp/16859/p2p/16Uiu2HAmCFVXxuBToRvNaraVC9uK6uQJL24nztBJh96hYm8UPHpG"]'
2025-02-08 04:05:18.932 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.933 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62238/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:05:18.943 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.944 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16858/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:05:18.952 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.952 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62662/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1738987518952588544}}'
2025-02-08 04:05:18.963 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:18.963 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-08 04:05:19.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62238/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:19.467 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738987518952588544,"ephemeral":false}]'
2025-02-08 04:05:19.467 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-08 04:05:24.467 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.186.61/tcp/62239"} has 1
2025-02-08 04:05:24.471 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.186.61/tcp/62239"} with value 1.0
2025-02-08 04:05:24.471 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-08 04:05:24.474 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-08 04:05:24.475 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-08 04:05:24.477 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-08 04:05:24.478 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-08 04:05:24.481 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-08 04:05:24.481 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-08 04:05:24.484 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-08 04:05:24.485 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-08 04:05:24.487 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-08 04:05:24.488 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-08 04:05:24.491 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-08 04:05:24.491 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-08 04:05:24.494 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-08 04:05:24.494 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-08 04:05:24.497 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-08 04:05:24.497 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-08 04:05:24.500 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-08 04:05:24.502 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:05:24.503 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:05:24.503 DEBUG [src.node.waku_node] Stopping container with id dc951acfb91c
2025-02-08 04:05:25.713 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:25.713 DEBUG [src.node.waku_node] Stopping container with id 5d76a9a784bd
2025-02-08 04:05:26.525 ERROR [src.node.docker_mananger] Max retries reached for container dc951acfb91c. Exiting log stream.
2025-02-08 04:05:27.199 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:27.199 DEBUG [src.node.waku_node] Stopping container with id f78e5703fab5
2025-02-08 04:05:28.039 ERROR [src.node.docker_mananger] Max retries reached for container 5d76a9a784bd. Exiting log stream.
2025-02-08 04:05:28.693 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:28.694 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:05:28.703 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:05:28.716 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:05:28.722 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
