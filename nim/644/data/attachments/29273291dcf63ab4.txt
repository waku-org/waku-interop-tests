2025-02-08 04:05:11.383 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:05:11.383 DEBUG [tests.conftest] Running test: test_message_with_ephemeral_true with id: 2025-02-08_04-05-11__a1ada25d-b3cf-4133-9369-c378597179dc
2025-02-08 04:05:11.383 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:05:11.384 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-08 04:05:11.384 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-08 04:05:11.390 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:11.390 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-08_04-05-11__a1ada25d-b3cf-4133-9369-c378597179dc__wakuorg_nwaku:latest.log
2025-02-08 04:05:11.390 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:11.390 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:11.392 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:11.392 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.201.23
2025-02-08 04:05:11.392 DEBUG [src.node.docker_mananger] Generated ports ['50798', '50799', '50800', '50801', '50802']
2025-02-08 04:05:11.392 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:11.392 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:11.392 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:11.392 DEBUG [src.node.docker_mananger] docker run -i -t -p 50798:50798 -p 50799:50799 -p 50800:50800 -p 50801:50801 -p 50802:50802 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50800 --rest-port=50798 --tcp-port=50799 --discv5-udp-port=50801 --rest-address=0.0.0.0 --nat=extip:172.18.201.23 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=269d97ccdffdfaac1c050deffe97eb2aee70febda1e98aedceaaa4efeb4ee5c1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50802 --metrics-logging=true --store=true --relay=true
2025-02-08 04:05:11.617 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.201.23 waku 06975b3ce90277489122355044e01c887a626ef3094d41ad7d285af273f9c842
2025-02-08 04:05:11.667 DEBUG [src.node.docker_mananger] Container started with ID 06975b3ce902. Setting up logs at ./log/docker/publishing_node1_2025-02-08_04-05-11__a1ada25d-b3cf-4133-9369-c378597179dc__wakuorg_nwaku:latest.log
2025-02-08 04:05:11.668 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50798
2025-02-08 04:05:11.669 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:12.183 ERROR [src.node.docker_mananger] Max retries reached for container a1d07ebf9bdd. Exiting log stream.
2025-02-08 04:05:12.669 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50798/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:12.672 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:12.672 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:12.672 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50798/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:12.674 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.201.23/tcp/50799/p2p/16Uiu2HAm81SJevyjwZMXLPFubUuoZXAHnYsKPX5ZdCsHk9eJccfv","/ip4/172.18.201.23/tcp/50800/ws/p2p/16Uiu2HAm81SJevyjwZMXLPFubUuoZXAHnYsKPX5ZdCsHk9eJccfv"],"enrUri":"enr:-L24QBlDe8q2Tz2w09HboiZWYkl5KvtuJJfdINjpXbIOTd9ndRSwMROxTF9wz6p6oIvaE7mIR-KOzQzftTKnBZomyhoCgmlkgnY0gmlwhKwSyReKbXVsdGlhZGRyc5YACASsEskXBsZvAAoErBLJFwbGcN0DgnJzhQADAQAAiXNlY3AyNTZrMaECuvKHSf6P5qqDAvHBQArIFsXXJQLinkm3sn5Zk7dOq-WDdGNwgsZvg3VkcILGcYV3YWt1MgM"}'
2025-02-08 04:05:12.674 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:12.681 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:05:12.681 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-08_04-05-11__a1ada25d-b3cf-4133-9369-c378597179dc__wakuorg_nwaku:latest.log
2025-02-08 04:05:12.681 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:05:12.681 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:05:12.682 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:05:12.682 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.133.190
2025-02-08 04:05:12.683 DEBUG [src.node.docker_mananger] Generated ports ['9065', '9066', '9067', '9068', '9069']
2025-02-08 04:05:12.683 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:05:12.683 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:05:12.683 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:05:12.683 DEBUG [src.node.docker_mananger] docker run -i -t -p 9065:9065 -p 9066:9066 -p 9067:9067 -p 9068:9068 -p 9069:9069 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9067 --rest-port=9065 --tcp-port=9066 --discv5-udp-port=9068 --rest-address=0.0.0.0 --nat=extip:172.18.133.190 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3a26c62e4de620b1ccc9fde2fbda3de122aabfc15bbe0b78fd1df34f7d9a0a3c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9069 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QBlDe8q2Tz2w09HboiZWYkl5KvtuJJfdINjpXbIOTd9ndRSwMROxTF9wz6p6oIvaE7mIR-KOzQzftTKnBZomyhoCgmlkgnY0gmlwhKwSyReKbXVsdGlhZGRyc5YACASsEskXBsZvAAoErBLJFwbGcN0DgnJzhQADAQAAiXNlY3AyNTZrMaECuvKHSf6P5qqDAvHBQArIFsXXJQLinkm3sn5Zk7dOq-WDdGNwgsZvg3VkcILGcYV3YWt1MgM --storenode=/ip4/172.18.201.23/tcp/50799/p2p/16Uiu2HAm81SJevyjwZMXLPFubUuoZXAHnYsKPX5ZdCsHk9eJccfv --store=true --relay=true
2025-02-08 04:05:12.902 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.133.190 waku 9e159ee26227657ff443e3c6ec962cff6879232174103b605654eb7797a09605
2025-02-08 04:05:12.947 DEBUG [src.node.docker_mananger] Container started with ID 9e159ee26227. Setting up logs at ./log/docker/store_node1_2025-02-08_04-05-11__a1ada25d-b3cf-4133-9369-c378597179dc__wakuorg_nwaku:latest.log
2025-02-08 04:05:12.949 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 9065
2025-02-08 04:05:12.949 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:05:13.949 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9065/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:13.952 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:05:13.952 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:05:13.953 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9065/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:13.955 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.133.190/tcp/9066/p2p/16Uiu2HAm7hyo2CGC4LjUEgjuwjXEzjjyon3XTj8pE6ZeA2ubvDeL","/ip4/172.18.133.190/tcp/9067/ws/p2p/16Uiu2HAm7hyo2CGC4LjUEgjuwjXEzjjyon3XTj8pE6ZeA2ubvDeL"],"enrUri":"enr:-L24QAXzK5ZbT6pr79h_co5mTr9cb0p8w1DQjQBMtTXTVmO2AuqwxtJOf6yt_tIUMkmbojQZFK1QZhvhh3FFYsOnlMECgmlkgnY0gmlwhKwShb6KbXVsdGlhZGRyc5YACASsEoW-BiNqAAoErBKFvgYja90DgnJzhQADAQAAiXNlY3AyNTZrMaECtnmtwO8aC4m2lWurql6Wg_7kzmqcSI7bn5vGegT1Bs2DdGNwgiNqg3VkcIIjbIV3YWt1MgM"}'
2025-02-08 04:05:13.955 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:05:13.955 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9065/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.201.23/tcp/50799/p2p/16Uiu2HAm81SJevyjwZMXLPFubUuoZXAHnYsKPX5ZdCsHk9eJccfv"]'
2025-02-08 04:05:13.958 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:13.958 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50798/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 04:05:13.960 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:13.960 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9065/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 04:05:13.963 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:13.964 DEBUG [src.steps.store] Relaying message
2025-02-08 04:05:13.964 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50798/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
2025-02-08 04:05:13.968 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:05:13.969 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-08 04:05:14.169 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-08 04:05:14.170 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50798/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:05:14.172 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-08 04:05:14.174 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:05:14.175 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:05:14.175 DEBUG [src.node.waku_node] Stopping container with id 06975b3ce902
2025-02-08 04:05:15.162 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:15.162 DEBUG [src.node.waku_node] Stopping container with id 9e159ee26227
2025-02-08 04:05:15.973 ERROR [src.node.docker_mananger] Max retries reached for container 06975b3ce902. Exiting log stream.
2025-02-08 04:05:16.646 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:05:16.648 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:05:16.653 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:05:16.658 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
