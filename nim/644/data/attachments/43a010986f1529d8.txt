2025-02-08 04:03:36.717 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:03:36.718 DEBUG [tests.conftest] Running test: test_filter_subscribe_refresh with id: 2025-02-08_04-03-36__09d0a688-2c89-4dbb-a93c-6cbfe51fc30f
2025-02-08 04:03:36.718 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:03:36.718 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-08 04:03:36.718 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-08 04:03:36.724 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:03:36.724 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-08_04-03-36__09d0a688-2c89-4dbb-a93c-6cbfe51fc30f__wakuorg_nwaku:latest.log
2025-02-08 04:03:36.724 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:03:36.724 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:03:36.726 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:03:36.726 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.235.157
2025-02-08 04:03:36.726 DEBUG [src.node.docker_mananger] Generated ports ['38180', '38181', '38182', '38183', '38184']
2025-02-08 04:03:36.726 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:03:36.726 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:03:36.727 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:03:36.727 DEBUG [src.node.docker_mananger] docker run -i -t -p 38180:38180 -p 38181:38181 -p 38182:38182 -p 38183:38183 -p 38184:38184 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38182 --rest-port=38180 --tcp-port=38181 --discv5-udp-port=38183 --rest-address=0.0.0.0 --nat=extip:172.18.235.157 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7c9aec89c4eab146af07ffec1ca4dc71e3dc6febff17d2cffee42e78ded4a2d4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38184 --metrics-logging=true --relay=true --filter=true
2025-02-08 04:03:36.947 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.235.157 waku b7f73bf6caaaae397d8e7ed1bebc12b4e7bbf9f156162b2bab7ac1115615adfa
2025-02-08 04:03:36.993 DEBUG [src.node.docker_mananger] Container started with ID b7f73bf6caaa. Setting up logs at ./log/docker/node1_2025-02-08_04-03-36__09d0a688-2c89-4dbb-a93c-6cbfe51fc30f__wakuorg_nwaku:latest.log
2025-02-08 04:03:36.994 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 38180
2025-02-08 04:03:36.995 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:03:37.521 ERROR [src.node.docker_mananger] Max retries reached for container e040a670450d. Exiting log stream.
2025-02-08 04:03:37.995 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38180/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:37.998 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:03:37.998 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:03:37.998 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38180/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:38.000 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.157/tcp/38181/p2p/16Uiu2HAmVHgPcc4D5MrdttL1TYCxxDGuLm8QXfwTSxGjUHjruiBo","/ip4/172.18.235.157/tcp/38182/ws/p2p/16Uiu2HAmVHgPcc4D5MrdttL1TYCxxDGuLm8QXfwTSxGjUHjruiBo"],"enrUri":"enr:-L24QAAGt2k0Q-F4rhzQjyKS3ctboPIAip0QenxQSCh_e8JucDK5XDTnFz3bKtEsfZOOsDcTXhesNfdQMjYRDVoEZ4QCgmlkgnY0gmlwhKwS652KbXVsdGlhZGRyc5YACASsEuudBpUlAAoErBLrnQaVJt0DgnJzhQADAQAAiXNlY3AyNTZrMaED9yEsZONe7slC88Q_yKMPQ-9vvcg8ts_kH184BiDazSaDdGNwgpUlg3VkcIKVJ4V3YWt1MgU"}'
2025-02-08 04:03:38.000 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:03:38.001 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-08 04:03:38.006 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:03:38.006 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-08_04-03-36__09d0a688-2c89-4dbb-a93c-6cbfe51fc30f__wakuorg_nwaku:latest.log
2025-02-08 04:03:38.007 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:03:38.007 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:03:38.008 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:03:38.008 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.85.153
2025-02-08 04:03:38.008 DEBUG [src.node.docker_mananger] Generated ports ['29439', '29440', '29441', '29442', '29443']
2025-02-08 04:03:38.008 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:03:38.008 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:03:38.008 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:03:38.009 DEBUG [src.node.docker_mananger] docker run -i -t -p 29439:29439 -p 29440:29440 -p 29441:29441 -p 29442:29442 -p 29443:29443 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29441 --rest-port=29439 --tcp-port=29440 --discv5-udp-port=29442 --rest-address=0.0.0.0 --nat=extip:172.18.85.153 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b3d0d4396aca5da1c7bc01ffde5affd1d06aabc7c7a3ddffdff3a2a1d1a41311 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29443 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QAAGt2k0Q-F4rhzQjyKS3ctboPIAip0QenxQSCh_e8JucDK5XDTnFz3bKtEsfZOOsDcTXhesNfdQMjYRDVoEZ4QCgmlkgnY0gmlwhKwS652KbXVsdGlhZGRyc5YACASsEuudBpUlAAoErBLrnQaVJt0DgnJzhQADAQAAiXNlY3AyNTZrMaED9yEsZONe7slC88Q_yKMPQ-9vvcg8ts_kH184BiDazSaDdGNwgpUlg3VkcIKVJ4V3YWt1MgU --filternode=/ip4/172.18.235.157/tcp/38181/p2p/16Uiu2HAmVHgPcc4D5MrdttL1TYCxxDGuLm8QXfwTSxGjUHjruiBo
2025-02-08 04:03:38.233 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.85.153 waku e986ae6b212d3728021989ec01f2bb8a6c94388b75fc3d2eede5b14479e26d1e
2025-02-08 04:03:38.284 DEBUG [src.node.docker_mananger] Container started with ID e986ae6b212d. Setting up logs at ./log/docker/node2_2025-02-08_04-03-36__09d0a688-2c89-4dbb-a93c-6cbfe51fc30f__wakuorg_nwaku:latest.log
2025-02-08 04:03:38.285 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29439
2025-02-08 04:03:38.285 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:03:39.285 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29439/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:39.288 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:03:39.288 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:03:39.288 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29439/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:39.290 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.85.153/tcp/29440/p2p/16Uiu2HAm39U5BW6zYqkPepLutZvC14ZDrVkJkvzy1qfQHkjVM9rt","/ip4/172.18.85.153/tcp/29441/ws/p2p/16Uiu2HAm39U5BW6zYqkPepLutZvC14ZDrVkJkvzy1qfQHkjVM9rt"],"enrUri":"enr:-L24QMquOC2Guyk3sxxc2QGAl1KTpwPrtGcxvlroXQgBOhSSKU2XkRYlNSZ9WHdR-UD9arraAdI0y7H3Soc_bodGcFICgmlkgnY0gmlwhKwSVZmKbXVsdGlhZGRyc5YACASsElWZBnMAAAoErBJVmQZzAd0DgnJzhQADAQAAiXNlY3AyNTZrMaECcra9M45gXg3oiP2Vk4R3X6FuoC095-CLJqpHS7fkAU2DdGNwgnMAg3VkcIJzAoV3YWt1MgA"}'
2025-02-08 04:03:39.290 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:03:39.291 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29439/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.235.157/tcp/38181/p2p/16Uiu2HAmVHgPcc4D5MrdttL1TYCxxDGuLm8QXfwTSxGjUHjruiBo"]'
2025-02-08 04:03:39.330 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:39.331 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38180/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:03:39.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:39.348 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29439/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "16044be8-0e68-4579-9fb9-98efc1830dfb", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-08 04:03:39.359 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"16044be8-0e68-4579-9fb9-98efc1830dfb","statusDesc":"OK"}'
2025-02-08 04:03:39.360 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38180/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:39.368 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:39.368 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:39.468 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:39.468 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29439/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:39.471 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738987419360531456,"ephemeral":false}]'
2025-02-08 04:03:39.472 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38180/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:03:39.476 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:39.477 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29439/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d1bf88b0-8258-4735-a1c0-b6c2f571838c", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-08 04:03:39.485 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"d1bf88b0-8258-4735-a1c0-b6c2f571838c","statusDesc":"OK"}'
2025-02-08 04:03:39.486 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38180/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:39.490 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:39.490 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:39.590 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:39.590 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29439/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:39.593 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738987419486021888,"ephemeral":false}]'
2025-02-08 04:03:39.595 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:03:39.596 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:03:39.596 DEBUG [src.node.waku_node] Stopping container with id b7f73bf6caaa
2025-02-08 04:03:40.555 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:03:40.555 DEBUG [src.node.waku_node] Stopping container with id e986ae6b212d
2025-02-08 04:03:41.367 ERROR [src.node.docker_mananger] Max retries reached for container b7f73bf6caaa. Exiting log stream.
2025-02-08 04:03:42.054 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:03:42.055 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:03:42.060 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:03:42.064 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
