2025-02-08 04:03:25.402 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:03:25.402 DEBUG [tests.conftest] Running test: test_filter_get_message_with_valid_timestamps with id: 2025-02-08_04-03-25__390cb07f-ed51-4d0f-93fc-5dbc2a8f7eb3
2025-02-08 04:03:25.402 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:03:25.403 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-08 04:03:25.403 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-08 04:03:25.408 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:03:25.409 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-08_04-03-25__390cb07f-ed51-4d0f-93fc-5dbc2a8f7eb3__wakuorg_nwaku:latest.log
2025-02-08 04:03:25.409 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:03:25.409 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:03:25.410 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:03:25.410 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.173.213
2025-02-08 04:03:25.410 DEBUG [src.node.docker_mananger] Generated ports ['25954', '25955', '25956', '25957', '25958']
2025-02-08 04:03:25.411 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:03:25.411 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:03:25.411 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:03:25.411 DEBUG [src.node.docker_mananger] docker run -i -t -p 25954:25954 -p 25955:25955 -p 25956:25956 -p 25957:25957 -p 25958:25958 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25956 --rest-port=25954 --tcp-port=25955 --discv5-udp-port=25957 --rest-address=0.0.0.0 --nat=extip:172.18.173.213 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0ade5aadc9bfd2cfc7e88c468feb3267693aeae59cae0dbe4f13d6be0e5fea49 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25958 --metrics-logging=true --relay=true --filter=true
2025-02-08 04:03:25.626 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.173.213 waku 79a24e03d310208d44587b54f08ec6341c6232523a7b5e1b8943bb44780366cb
2025-02-08 04:03:25.675 DEBUG [src.node.docker_mananger] Container started with ID 79a24e03d310. Setting up logs at ./log/docker/node1_2025-02-08_04-03-25__390cb07f-ed51-4d0f-93fc-5dbc2a8f7eb3__wakuorg_nwaku:latest.log
2025-02-08 04:03:25.677 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25954
2025-02-08 04:03:25.677 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:03:26.085 ERROR [src.node.docker_mananger] Max retries reached for container 22ba5e618f21. Exiting log stream.
2025-02-08 04:03:26.677 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25954/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:26.680 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:03:26.680 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:03:26.680 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25954/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:26.682 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.173.213/tcp/25955/p2p/16Uiu2HAm5g8PpAEFNBcjwvuc5cNaqjN2PciM478jvPvx8p4aD5vo","/ip4/172.18.173.213/tcp/25956/ws/p2p/16Uiu2HAm5g8PpAEFNBcjwvuc5cNaqjN2PciM478jvPvx8p4aD5vo"],"enrUri":"enr:-L24QHLqVOmnXkjBDx9Ya4tCFZS7Idw74zrXz0vHJ9Iljur_avq5KiGmCKXiwe9EdUq-4ZonRpZvDl2H9t-uTkvFKGECgmlkgnY0gmlwhKwSrdWKbXVsdGlhZGRyc5YACASsEq3VBmVjAAoErBKt1QZlZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECmEjd_iOUHEQ1i7PGp0JcH2UCthGv94FodV5yJrgx0tCDdGNwgmVjg3VkcIJlZYV3YWt1MgU"}'
2025-02-08 04:03:26.683 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:03:26.683 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-08 04:03:26.689 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:03:26.689 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-08_04-03-25__390cb07f-ed51-4d0f-93fc-5dbc2a8f7eb3__wakuorg_nwaku:latest.log
2025-02-08 04:03:26.689 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:03:26.689 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:03:26.690 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:03:26.691 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.62.137
2025-02-08 04:03:26.691 DEBUG [src.node.docker_mananger] Generated ports ['15139', '15140', '15141', '15142', '15143']
2025-02-08 04:03:26.691 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:03:26.691 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:03:26.691 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:03:26.691 DEBUG [src.node.docker_mananger] docker run -i -t -p 15139:15139 -p 15140:15140 -p 15141:15141 -p 15142:15142 -p 15143:15143 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15141 --rest-port=15139 --tcp-port=15140 --discv5-udp-port=15142 --rest-address=0.0.0.0 --nat=extip:172.18.62.137 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d6c3c9ebadc5bf18aecf04ff95fbf4ef87efeb77ce2bbcd3fb0edae0be9ece07 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15143 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QHLqVOmnXkjBDx9Ya4tCFZS7Idw74zrXz0vHJ9Iljur_avq5KiGmCKXiwe9EdUq-4ZonRpZvDl2H9t-uTkvFKGECgmlkgnY0gmlwhKwSrdWKbXVsdGlhZGRyc5YACASsEq3VBmVjAAoErBKt1QZlZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECmEjd_iOUHEQ1i7PGp0JcH2UCthGv94FodV5yJrgx0tCDdGNwgmVjg3VkcIJlZYV3YWt1MgU --filternode=/ip4/172.18.173.213/tcp/25955/p2p/16Uiu2HAm5g8PpAEFNBcjwvuc5cNaqjN2PciM478jvPvx8p4aD5vo
2025-02-08 04:03:26.918 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.62.137 waku 6f94d09aa53379b1e51cee11abc70f65bf7cb2a82b38411e20672929913b4c22
2025-02-08 04:03:26.966 DEBUG [src.node.docker_mananger] Container started with ID 6f94d09aa533. Setting up logs at ./log/docker/node2_2025-02-08_04-03-25__390cb07f-ed51-4d0f-93fc-5dbc2a8f7eb3__wakuorg_nwaku:latest.log
2025-02-08 04:03:26.966 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15139
2025-02-08 04:03:26.966 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:03:27.967 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:27.970 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:03:27.970 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:03:27.970 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:27.972 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.62.137/tcp/15140/p2p/16Uiu2HAm5NfbwHPeeAaC1TGXdbpktTvGpwqy8Biu1r4SxeRhPDmM","/ip4/172.18.62.137/tcp/15141/ws/p2p/16Uiu2HAm5NfbwHPeeAaC1TGXdbpktTvGpwqy8Biu1r4SxeRhPDmM"],"enrUri":"enr:-L24QB_j86S4wEyDaUcPornWpNLPLjGCAOUjCcaJWU2AFkQyayqp-AyqrLRlRzkRNMPzppQ7IYuvcpstWbK-PN6YcMUCgmlkgnY0gmlwhKwSPomKbXVsdGlhZGRyc5YACASsEj6JBjskAAoErBI-iQY7Jd0DgnJzhQADAQAAiXNlY3AyNTZrMaECk8-zY7ryxDoqtfWKeOozgedGeLhzvaAlmPtSBwN1zGyDdGNwgjskg3VkcII7JoV3YWt1MgA"}'
2025-02-08 04:03:27.973 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:03:27.973 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15139/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.173.213/tcp/25955/p2p/16Uiu2HAm5g8PpAEFNBcjwvuc5cNaqjN2PciM478jvPvx8p4aD5vo"]'
2025-02-08 04:03:28.008 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.009 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-08 04:03:28.009 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 04:03:28.028 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.029 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15139/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "560e22aa-a9c3-4319-911a-ad2031f74f42", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-08 04:03:28.040 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"560e22aa-a9c3-4319-911a-ad2031f74f42","statusDesc":"OK"}'
2025-02-08 04:03:28.042 DEBUG [tests.filter.test_get_messages] Running test with timestamp Now
2025-02-08 04:03:28.043 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:28.050 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.050 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:28.150 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:28.151 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:28.153 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738987330814326528,"ephemeral":false}]'
2025-02-08 04:03:28.155 DEBUG [tests.filter.test_get_messages] Running test with timestamp Far future
2025-02-08 04:03:28.155 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:28.160 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.160 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:28.260 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:28.260 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:28.263 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":2054347330814295040,"ephemeral":false}]'
2025-02-08 04:03:28.264 DEBUG [tests.filter.test_get_messages] Running test with timestamp Recent past
2025-02-08 04:03:28.264 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:28.268 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.269 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:28.369 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:28.370 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:28.372 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738983730814295040,"ephemeral":false}]'
2025-02-08 04:03:28.373 DEBUG [tests.filter.test_get_messages] Running test with timestamp Near future
2025-02-08 04:03:28.374 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:28.378 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.378 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:28.478 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:28.479 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:28.481 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738990930814295040,"ephemeral":false}]'
2025-02-08 04:03:28.482 DEBUG [tests.filter.test_get_messages] Running test with timestamp Positive number
2025-02-08 04:03:28.483 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:28.487 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.487 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:28.587 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:28.588 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:28.590 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1,"ephemeral":false}]'
2025-02-08 04:03:28.591 DEBUG [tests.filter.test_get_messages] Running test with timestamp Negative number
2025-02-08 04:03:28.592 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:28.595 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.596 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:28.696 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:28.696 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:28.699 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":-1,"ephemeral":false}]'
2025-02-08 04:03:28.700 DEBUG [tests.filter.test_get_messages] Running test with timestamp DST change
2025-02-08 04:03:28.700 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25954/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-08 04:03:28.704 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:28.705 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:28.805 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-08 04:03:28.805 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15139/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:28.807 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1583632800000000000,"ephemeral":false}]'
2025-02-08 04:03:28.810 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:03:28.811 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:03:28.811 DEBUG [src.node.waku_node] Stopping container with id 79a24e03d310
2025-02-08 04:03:30.255 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:03:30.257 DEBUG [src.node.waku_node] Stopping container with id 6f94d09aa533
2025-02-08 04:03:31.083 ERROR [src.node.docker_mananger] Max retries reached for container 79a24e03d310. Exiting log stream.
2025-02-08 04:03:31.618 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:03:31.621 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:03:31.631 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:03:31.636 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
