2025-02-08 04:03:32.922 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 04:03:32.922 DEBUG [tests.conftest] Running test: test_main_node_full__peer_full with id: 2025-02-08_04-03-32__675d6271-e84a-4028-bf19-ea2706f50175
2025-02-08 04:03:32.922 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 04:03:32.923 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-08 04:03:32.929 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:03:32.929 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-08_04-03-32__675d6271-e84a-4028-bf19-ea2706f50175__wakuorg_nwaku:latest.log
2025-02-08 04:03:32.929 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:03:32.930 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:03:32.931 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:03:32.931 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.86.141
2025-02-08 04:03:32.931 DEBUG [src.node.docker_mananger] Generated ports ['17836', '17837', '17838', '17839', '17840']
2025-02-08 04:03:32.931 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:03:32.932 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:03:32.932 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:03:32.932 DEBUG [src.node.docker_mananger] docker run -i -t -p 17836:17836 -p 17837:17837 -p 17838:17838 -p 17839:17839 -p 17840:17840 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17838 --rest-port=17836 --tcp-port=17837 --discv5-udp-port=17839 --rest-address=0.0.0.0 --nat=extip:172.18.86.141 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=afe3636debcb72a2f8e58a158db5caafade4bac424af91ebfbc5dcca7618778d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17840 --metrics-logging=true --lightpush=true --relay=true --filter=true
2025-02-08 04:03:33.162 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.86.141 waku add65879851a6d975d80bdea4d3910d9ff1cdffc0b90ce5becb67369c623c8cb
2025-02-08 04:03:33.208 DEBUG [src.node.docker_mananger] Container started with ID add65879851a. Setting up logs at ./log/docker/receiving_node1_2025-02-08_04-03-32__675d6271-e84a-4028-bf19-ea2706f50175__wakuorg_nwaku:latest.log
2025-02-08 04:03:33.208 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17836
2025-02-08 04:03:33.209 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:03:33.717 ERROR [src.node.docker_mananger] Max retries reached for container 014a8fdcf59a. Exiting log stream.
2025-02-08 04:03:34.210 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17836/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:34.213 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:03:34.213 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:03:34.213 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17836/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:34.215 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.86.141/tcp/17837/p2p/16Uiu2HAkwjS9pFx78mV2QjXzjBrnMc9xiLPnukFmZ8Fq9WfHNtqj","/ip4/172.18.86.141/tcp/17838/ws/p2p/16Uiu2HAkwjS9pFx78mV2QjXzjBrnMc9xiLPnukFmZ8Fq9WfHNtqj"],"enrUri":"enr:-L24QF_EQw2aDa6ephyVdQw_9XgybUz8csccCUNO1rr6y2l9WM__2safpMWhD2TUYkwF-gwoxLEc9BwVfCfshYtskZICgmlkgnY0gmlwhKwSVo2KbXVsdGlhZGRyc5YACASsElaNBkWtAAoErBJWjQZFrt0DgnJzhQADAQAAiXNlY3AyNTZrMaECIkQxpmLFyr3wMfzqPSoWvbpuexmiH4UwXwrDd5zeNn6DdGNwgkWtg3VkcIJFr4V3YWt1Mg0"}'
2025-02-08 04:03:34.215 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:03:34.222 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 04:03:34.222 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-08_04-03-32__675d6271-e84a-4028-bf19-ea2706f50175__wakuorg_nwaku:latest.log
2025-02-08 04:03:34.222 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 04:03:34.222 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 04:03:34.223 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 04:03:34.223 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.246.68
2025-02-08 04:03:34.224 DEBUG [src.node.docker_mananger] Generated ports ['9854', '9855', '9856', '9857', '9858']
2025-02-08 04:03:34.224 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 04:03:34.224 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 04:03:34.224 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 04:03:34.224 DEBUG [src.node.docker_mananger] docker run -i -t -p 9854:9854 -p 9855:9855 -p 9856:9856 -p 9857:9857 -p 9858:9858 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9856 --rest-port=9854 --tcp-port=9855 --discv5-udp-port=9857 --rest-address=0.0.0.0 --nat=extip:172.18.246.68 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=66d1dcabcdc3f0dab97a6ddec360beb7a2b5b13a22af974fc3dac489feeb06b7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9858 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QF_EQw2aDa6ephyVdQw_9XgybUz8csccCUNO1rr6y2l9WM__2safpMWhD2TUYkwF-gwoxLEc9BwVfCfshYtskZICgmlkgnY0gmlwhKwSVo2KbXVsdGlhZGRyc5YACASsElaNBkWtAAoErBJWjQZFrt0DgnJzhQADAQAAiXNlY3AyNTZrMaECIkQxpmLFyr3wMfzqPSoWvbpuexmiH4UwXwrDd5zeNn6DdGNwgkWtg3VkcIJFr4V3YWt1Mg0 --lightpushnode=/ip4/172.18.86.141/tcp/17837/p2p/16Uiu2HAkwjS9pFx78mV2QjXzjBrnMc9xiLPnukFmZ8Fq9WfHNtqj --lightpush=true --relay=true --filter=true
2025-02-08 04:03:34.453 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.246.68 waku 583030f1505dbd82ddffe09d3c3ecc25e0b6a94ca907edd50f7f7db137b052fc
2025-02-08 04:03:34.508 DEBUG [src.node.docker_mananger] Container started with ID 583030f1505d. Setting up logs at ./log/docker/lightpush_node1_2025-02-08_04-03-32__675d6271-e84a-4028-bf19-ea2706f50175__wakuorg_nwaku:latest.log
2025-02-08 04:03:34.508 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 9854
2025-02-08 04:03:34.509 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 04:03:35.510 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9854/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:35.512 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 04:03:35.512 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 04:03:35.513 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9854/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:35.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.246.68/tcp/9855/p2p/16Uiu2HAmSC9dNdM66TuuVaKZA2BUWWoy3KwEhVm3iDNZgxzVLwTB","/ip4/172.18.246.68/tcp/9856/ws/p2p/16Uiu2HAmSC9dNdM66TuuVaKZA2BUWWoy3KwEhVm3iDNZgxzVLwTB"],"enrUri":"enr:-L24QDshtq2s9MM7ldyckLbGWen61_wkppG0Ca304_eRFzC8TGWohihy8nEos8xNSFFbd8-ZOu7NU79J0BUYeWFjgLkCgmlkgnY0gmlwhKwS9kSKbXVsdGlhZGRyc5YACASsEvZEBiZ_AAoErBL2RAYmgN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDySNszVvbl1bV7pOiCnSUZMdDO4GLUs_w7zZSCJRaRh6DdGNwgiZ_g3VkcIImgYV3YWt1Mg0"}'
2025-02-08 04:03:35.515 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 04:03:35.515 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9854/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.86.141/tcp/17837/p2p/16Uiu2HAkwjS9pFx78mV2QjXzjBrnMc9xiLPnukFmZ8Fq9WfHNtqj"]'
2025-02-08 04:03:44.475 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:44.475 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17836/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 04:03:44.478 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:44.478 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9854/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 04:03:44.480 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:44.480 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-08 04:03:44.981 DEBUG [src.steps.light_push] Lightpushing message
2025-02-08 04:03:44.981 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9854/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738987424981552384}}'
2025-02-08 04:03:44.993 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 04:03:44.993 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 04:03:45.094 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-08 04:03:45.094 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17836/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:45.096 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738987424981552384,"ephemeral":false}]'
2025-02-08 04:03:45.098 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-08 04:03:45.098 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9854/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-08 04:03:45.100 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738987424981552384,"ephemeral":false}]'
2025-02-08 04:03:45.102 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 04:03:45.103 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 04:03:45.103 DEBUG [src.node.waku_node] Stopping container with id add65879851a
2025-02-08 04:03:45.686 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:03:45.686 DEBUG [src.node.waku_node] Stopping container with id 583030f1505d
2025-02-08 04:03:46.499 ERROR [src.node.docker_mananger] Max retries reached for container add65879851a. Exiting log stream.
2025-02-08 04:03:46.749 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 04:03:46.750 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 04:03:46.756 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 04:03:46.761 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
