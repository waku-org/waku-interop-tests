2025-02-12 04:04:36.754 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:04:36.754 DEBUG [tests.conftest] Running test: test_publish_with_payload_less_than_150_kb with id: 2025-02-12_04-04-36__fb502010-d028-40ab-8005-106b13ecab97
2025-02-12 04:04:36.755 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:04:36.755 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-12 04:04:36.755 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-12 04:04:36.762 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:04:36.763 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-12_04-04-36__fb502010-d028-40ab-8005-106b13ecab97__wakuorg_nwaku:latest.log
2025-02-12 04:04:36.763 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:04:36.763 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:04:36.765 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:04:36.765 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.28.169
2025-02-12 04:04:36.765 DEBUG [src.node.docker_mananger] Generated ports ['11567', '11568', '11569', '11570', '11571']
2025-02-12 04:04:36.765 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:04:36.765 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:04:36.765 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:04:36.766 DEBUG [src.node.docker_mananger] docker run -i -t -p 11567:11567 -p 11568:11568 -p 11569:11569 -p 11570:11570 -p 11571:11571 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11569 --rest-port=11567 --tcp-port=11568 --discv5-udp-port=11570 --rest-address=0.0.0.0 --nat=extip:172.18.28.169 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=94f62aafabeb3aee9c23bb7dff252e3ccdbf2adec0b46fbe8bedc7f9a7e2feef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11571 --metrics-logging=true --relay=true
2025-02-12 04:04:37.011 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.28.169 waku 473e7fba474e9c3f8ac3458d4a10bc27716cdf6a4d3e1e8196d8163acb61e02c
2025-02-12 04:04:37.066 DEBUG [src.node.docker_mananger] Container started with ID 473e7fba474e. Setting up logs at ./log/docker/node1_2025-02-12_04-04-36__fb502010-d028-40ab-8005-106b13ecab97__wakuorg_nwaku:latest.log
2025-02-12 04:04:37.067 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 11567
2025-02-12 04:04:37.067 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:04:37.542 ERROR [src.node.docker_mananger] Max retries reached for container aa76e5ff6c87. Exiting log stream.
2025-02-12 04:04:38.068 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11567/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:38.070 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:04:38.071 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:04:38.071 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11567/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:38.073 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.28.169/tcp/11568/p2p/16Uiu2HAmPojWvbaCgqzMq896m9mHEdJT57hq1Ea1g68bNNdVR6ks","/ip4/172.18.28.169/tcp/11569/ws/p2p/16Uiu2HAmPojWvbaCgqzMq896m9mHEdJT57hq1Ea1g68bNNdVR6ks"],"enrUri":"enr:-L24QL_io4oo_SxhwVqM7LEhinZBOrCGAZEIoIDx42kBrx8dQmYKMXaDGBnWDTiKfWYRe0tji-tNbvY2jDKuw5aKDgwCgmlkgnY0gmlwhKwSHKmKbXVsdGlhZGRyc5YACASsEhypBi0wAAoErBIcqQYtMd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDpa4CwJMEv0834Eij9xkBYbIPpf1LEf8fNFnOzbHOO2SDdGNwgi0wg3VkcIItMoV3YWt1MgE"}'
2025-02-12 04:04:38.074 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:04:38.081 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:04:38.081 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-12_04-04-36__fb502010-d028-40ab-8005-106b13ecab97__wakuorg_nwaku:latest.log
2025-02-12 04:04:38.081 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:04:38.081 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:04:38.083 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:04:38.083 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.169.193
2025-02-12 04:04:38.083 DEBUG [src.node.docker_mananger] Generated ports ['62988', '62989', '62990', '62991', '62992']
2025-02-12 04:04:38.083 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:04:38.083 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:04:38.084 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:04:38.084 DEBUG [src.node.docker_mananger] docker run -i -t -p 62988:62988 -p 62989:62989 -p 62990:62990 -p 62991:62991 -p 62992:62992 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62990 --rest-port=62988 --tcp-port=62989 --discv5-udp-port=62991 --rest-address=0.0.0.0 --nat=extip:172.18.169.193 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=862bb0e5f1df5b0adaf9b8b2b6270dcedc21f4e058a9bf4d9b268cb0db333ec6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62992 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QL_io4oo_SxhwVqM7LEhinZBOrCGAZEIoIDx42kBrx8dQmYKMXaDGBnWDTiKfWYRe0tji-tNbvY2jDKuw5aKDgwCgmlkgnY0gmlwhKwSHKmKbXVsdGlhZGRyc5YACASsEhypBi0wAAoErBIcqQYtMd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDpa4CwJMEv0834Eij9xkBYbIPpf1LEf8fNFnOzbHOO2SDdGNwgi0wg3VkcIItMoV3YWt1MgE
2025-02-12 04:04:38.336 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.169.193 waku 6f67196eefa530f9a2388c84c6db0fb4cec92ca6daeacb9c2be8808f0715e502
2025-02-12 04:04:38.388 DEBUG [src.node.docker_mananger] Container started with ID 6f67196eefa5. Setting up logs at ./log/docker/node2_2025-02-12_04-04-36__fb502010-d028-40ab-8005-106b13ecab97__wakuorg_nwaku:latest.log
2025-02-12 04:04:38.388 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62988
2025-02-12 04:04:38.388 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:04:39.389 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62988/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:39.397 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:04:39.399 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:04:39.400 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62988/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:39.404 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.169.193/tcp/62989/p2p/16Uiu2HAm56HXUp9UtqqnVdBncEtRY6t1ie46StvZUkTCQUxGu1bY","/ip4/172.18.169.193/tcp/62990/ws/p2p/16Uiu2HAm56HXUp9UtqqnVdBncEtRY6t1ie46StvZUkTCQUxGu1bY"],"enrUri":"enr:-L24QOC4t_HCWm90neZQI2dAE1o2SCjJhAPtm2iMshlDwDNUGohreT8ZNseAAnc8EEI1AODU-3ueLuTdQXEoA67UnmACgmlkgnY0gmlwhKwSqcGKbXVsdGlhZGRyc5YACASsEqnBBvYNAAoErBKpwQb2Dt0DgnJzhQADAQAAiXNlY3AyNTZrMaECj51yCFJNmWcRn8cJc4tPSnb3MgZWsBZj7x9Hd7WuToODdGNwgvYNg3VkcIL2D4V3YWt1MgE"}'
2025-02-12 04:04:39.405 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:04:39.406 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62988/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.28.169/tcp/11568/p2p/16Uiu2HAmPojWvbaCgqzMq896m9mHEdJT57hq1Ea1g68bNNdVR6ks"]'
2025-02-12 04:04:39.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:39.410 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-12 04:04:39.410 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11567/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 04:04:39.414 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:39.415 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62988/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 04:04:39.421 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:39.423 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11567/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:04:39.429 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:39.429 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 04:04:39.530 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 04:04:39.530 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11567/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:39.533 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739333079423194112,"ephemeral":false}]'
2025-02-12 04:04:39.534 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-12 04:04:39.535 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62988/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:39.537 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739333079423194112,"ephemeral":false}]'
2025-02-12 04:04:39.539 INFO [src.steps.relay] WARM UP successful!!
2025-02-12 04:04:39.540 DEBUG [tests.relay.test_publish] Running test with payload length of 102400 bytes
2025-02-12 04:04:39.542 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-12 04:04:39.561 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:39.562 DEBUG [src.libs.common] Sleeping for 2 seconds
2025-02-12 04:04:41.562 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 04:04:41.562 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11567/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:41.567 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-12 04:04:41.569 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-12 04:04:41.569 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62988/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:41.573 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-12 04:04:41.578 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:04:41.579 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:04:41.579 DEBUG [src.node.waku_node] Stopping container with id 473e7fba474e
2025-02-12 04:04:42.592 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:04:42.592 DEBUG [src.node.waku_node] Stopping container with id 6f67196eefa5
2025-02-12 04:04:43.406 ERROR [src.node.docker_mananger] Max retries reached for container 473e7fba474e. Exiting log stream.
2025-02-12 04:04:44.121 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:04:44.123 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:04:44.128 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:04:44.133 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
