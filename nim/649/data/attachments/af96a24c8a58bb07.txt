2025-02-12 04:05:11.856 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:05:11.856 DEBUG [tests.conftest] Running test: test_store_with_peerAddr with id: 2025-02-12_04-05-11__d2c0343a-b335-4d2c-b9bd-5843d2b38b63
2025-02-12 04:05:11.857 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:05:11.857 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-12 04:05:11.857 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-12 04:05:11.866 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:05:11.866 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-12_04-05-11__d2c0343a-b335-4d2c-b9bd-5843d2b38b63__wakuorg_nwaku:latest.log
2025-02-12 04:05:11.866 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:05:11.866 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:05:11.868 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:05:11.868 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.41.121
2025-02-12 04:05:11.868 DEBUG [src.node.docker_mananger] Generated ports ['29610', '29611', '29612', '29613', '29614']
2025-02-12 04:05:11.868 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:05:11.869 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:05:11.869 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:05:11.869 DEBUG [src.node.docker_mananger] docker run -i -t -p 29610:29610 -p 29611:29611 -p 29612:29612 -p 29613:29613 -p 29614:29614 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29612 --rest-port=29610 --tcp-port=29611 --discv5-udp-port=29613 --rest-address=0.0.0.0 --nat=extip:172.18.41.121 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8ebfec48d49c8e6e67e40cabbdb4fda0e2e59eb6ebff9018b6b42f68a31c4aed --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29614 --metrics-logging=true --store=true --relay=true
2025-02-12 04:05:12.098 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.41.121 waku b9c494dccba46ed8b9537d8bf212ba39c32991507c029d924a010c6c5051ef60
2025-02-12 04:05:12.142 DEBUG [src.node.docker_mananger] Container started with ID b9c494dccba4. Setting up logs at ./log/docker/publishing_node1_2025-02-12_04-05-11__d2c0343a-b335-4d2c-b9bd-5843d2b38b63__wakuorg_nwaku:latest.log
2025-02-12 04:05:12.144 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29610
2025-02-12 04:05:12.144 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:05:12.657 ERROR [src.node.docker_mananger] Max retries reached for container cfe2de59e61a. Exiting log stream.
2025-02-12 04:05:13.145 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29610/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:13.148 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:05:13.148 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:05:13.148 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29610/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:13.151 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.41.121/tcp/29611/p2p/16Uiu2HAkvq56TvEQLbYcJiNqeCF79zuk4Bhs97CpTzbiC9urpvMd","/ip4/172.18.41.121/tcp/29612/ws/p2p/16Uiu2HAkvq56TvEQLbYcJiNqeCF79zuk4Bhs97CpTzbiC9urpvMd"],"enrUri":"enr:-L24QMujA0Pwcx_QxF2bvQZnubCKOBJ5Dozu9UQNUQjXq7ceCTx411WLcU3nSbZMrmHH34k0wVQ2AX2vi7hl87IxvKACgmlkgnY0gmlwhKwSKXmKbXVsdGlhZGRyc5YACASsEil5BnOrAAoErBIpeQZzrN0DgnJzhQADAQAAiXNlY3AyNTZrMaECFNouiOImPEmiOK1I0cfGZYeW2ecvVE-cf9bVZBviFYiDdGNwgnOrg3VkcIJzrYV3YWt1MgM"}'
2025-02-12 04:05:13.151 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:05:13.157 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:05:13.157 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-12_04-05-11__d2c0343a-b335-4d2c-b9bd-5843d2b38b63__wakuorg_nwaku:latest.log
2025-02-12 04:05:13.157 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:05:13.158 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:05:13.159 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:05:13.159 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.229.242
2025-02-12 04:05:13.159 DEBUG [src.node.docker_mananger] Generated ports ['15515', '15516', '15517', '15518', '15519']
2025-02-12 04:05:13.159 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:05:13.159 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:05:13.159 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:05:13.160 DEBUG [src.node.docker_mananger] docker run -i -t -p 15515:15515 -p 15516:15516 -p 15517:15517 -p 15518:15518 -p 15519:15519 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15517 --rest-port=15515 --tcp-port=15516 --discv5-udp-port=15518 --rest-address=0.0.0.0 --nat=extip:172.18.229.242 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=95be9f657fecd1b2a495386b0c5cc167bda818eb59073a5cea0fcb7cffe722f8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15519 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QMujA0Pwcx_QxF2bvQZnubCKOBJ5Dozu9UQNUQjXq7ceCTx411WLcU3nSbZMrmHH34k0wVQ2AX2vi7hl87IxvKACgmlkgnY0gmlwhKwSKXmKbXVsdGlhZGRyc5YACASsEil5BnOrAAoErBIpeQZzrN0DgnJzhQADAQAAiXNlY3AyNTZrMaECFNouiOImPEmiOK1I0cfGZYeW2ecvVE-cf9bVZBviFYiDdGNwgnOrg3VkcIJzrYV3YWt1MgM --storenode=/ip4/172.18.41.121/tcp/29611/p2p/16Uiu2HAkvq56TvEQLbYcJiNqeCF79zuk4Bhs97CpTzbiC9urpvMd --store=true --relay=true
2025-02-12 04:05:13.392 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.229.242 waku 7b8ca6b70c3c50e1103de63dee7c5d398f40c747fce4fc59865269dfc2b87351
2025-02-12 04:05:13.440 DEBUG [src.node.docker_mananger] Container started with ID 7b8ca6b70c3c. Setting up logs at ./log/docker/store_node1_2025-02-12_04-05-11__d2c0343a-b335-4d2c-b9bd-5843d2b38b63__wakuorg_nwaku:latest.log
2025-02-12 04:05:13.441 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15515
2025-02-12 04:05:13.441 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:05:14.443 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15515/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:14.446 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:05:14.446 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:05:14.446 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15515/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:14.448 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.229.242/tcp/15516/p2p/16Uiu2HAmB9J8PEy2iJApJzWhHEDMUUFUEsa1h3rwtRCXHQ1nfqUn","/ip4/172.18.229.242/tcp/15517/ws/p2p/16Uiu2HAmB9J8PEy2iJApJzWhHEDMUUFUEsa1h3rwtRCXHQ1nfqUn"],"enrUri":"enr:-L24QJ1GdmkVt26hkh-6QA7YAxP0tKs-zmnQbvSiXIFZxT-RXJev5C0aaSVSxgsWItgzavW8n7mTOrwyQfq9elC13RcCgmlkgnY0gmlwhKwS5fKKbXVsdGlhZGRyc5YACASsEuXyBjycAAoErBLl8gY8nd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6Yj9aFJw3PUCRQ4rfVLzN7Dxr98Fskb9pEaTLbC-FouDdGNwgjycg3VkcII8noV3YWt1MgM"}'
2025-02-12 04:05:14.449 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:05:14.449 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15515/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.41.121/tcp/29611/p2p/16Uiu2HAkvq56TvEQLbYcJiNqeCF79zuk4Bhs97CpTzbiC9urpvMd"]'
2025-02-12 04:05:14.452 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:14.452 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29610/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 04:05:14.454 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:14.455 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15515/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 04:05:14.457 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:14.458 DEBUG [src.steps.store] Relaying message
2025-02-12 04:05:14.458 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29610/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:05:14.464 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:14.464 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 04:05:14.664 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-12 04:05:14.665 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15515/store/v3/messages?peerAddr=%2Fip4%2F172.18.41.121%2Ftcp%2F29611%2Fp2p%2F16Uiu2HAkvq56TvEQLbYcJiNqeCF79zuk4Bhs97CpTzbiC9urpvMd&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:14.672 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"adce26a0af21490a5ef3","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x6b752a23c75a5756ef5d6c834d9a01f7c284b1da42c9d1736db481f2c63ef254"}]}'
2025-02-12 04:05:14.674 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:05:14.675 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:05:14.675 DEBUG [src.node.waku_node] Stopping container with id b9c494dccba4
2025-02-12 04:05:15.660 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:05:15.661 DEBUG [src.node.waku_node] Stopping container with id 7b8ca6b70c3c
2025-02-12 04:05:16.472 ERROR [src.node.docker_mananger] Max retries reached for container b9c494dccba4. Exiting log stream.
2025-02-12 04:05:17.167 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:05:17.168 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:05:17.174 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:05:17.179 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
