2025-02-12 04:06:05.235 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:06:05.235 DEBUG [tests.conftest] Running test: test_publish_on_multiple_content_topics_and_only_after_fetch_them[content_topic_list1] with id: 2025-02-12_04-06-05__30393b1d-9f73-4039-b999-04b7d5b312d2
2025-02-12 04:06:05.235 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:06:05.236 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-12 04:06:05.236 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-12 04:06:05.243 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:06:05.243 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-12_04-06-05__30393b1d-9f73-4039-b999-04b7d5b312d2__wakuorg_nwaku:latest.log
2025-02-12 04:06:05.243 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:06:05.244 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:06:05.245 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:06:05.245 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.3.178
2025-02-12 04:06:05.245 DEBUG [src.node.docker_mananger] Generated ports ['23230', '23231', '23232', '23233', '23234']
2025-02-12 04:06:05.246 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:06:05.246 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:06:05.246 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:06:05.246 DEBUG [src.node.docker_mananger] docker run -i -t -p 23230:23230 -p 23231:23231 -p 23232:23232 -p 23233:23233 -p 23234:23234 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23232 --rest-port=23230 --tcp-port=23231 --discv5-udp-port=23233 --rest-address=0.0.0.0 --nat=extip:172.18.3.178 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=2a6f395a093a8b127dc8dbdffee732ea62cdaca607fdeb55c3f39cd42f5bdf7d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23234 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-12 04:06:05.481 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.3.178 waku 99c6f9c77d5371b68ed9f1112a6317573124b3b081bdc813836dc92fb8e56e98
2025-02-12 04:06:05.526 DEBUG [src.node.docker_mananger] Container started with ID 99c6f9c77d53. Setting up logs at ./log/docker/node1_2025-02-12_04-06-05__30393b1d-9f73-4039-b999-04b7d5b312d2__wakuorg_nwaku:latest.log
2025-02-12 04:06:05.528 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23230
2025-02-12 04:06:05.528 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:06:06.039 ERROR [src.node.docker_mananger] Max retries reached for container aa9b1868d3ff. Exiting log stream.
2025-02-12 04:06:06.529 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23230/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:06.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:06:06.532 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:06:06.532 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23230/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:06.534 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.3.178/tcp/23231/p2p/16Uiu2HAm9ZanBsf2WdVmBENW65XLZJ7Exu5Pt9yC7JRxyYZ2x7k4","/ip4/172.18.3.178/tcp/23232/ws/p2p/16Uiu2HAm9ZanBsf2WdVmBENW65XLZJ7Exu5Pt9yC7JRxyYZ2x7k4"],"enrUri":"enr:-L24QDz9TTQCCVDyzBfcm7eWwiawYblCaCENoEVtHcIWmR2rHn0fdj3ju5k5DGtDpYydJtVghLaCN-towF6U_JRNQuECgmlkgnY0gmlwhKwSA7KKbXVsdGlhZGRyc5YACASsEgOyBlq_AAoErBIDsgZawN0DgnJzhQACAQAAiXNlY3AyNTZrMaEC0gpiOOiaC1Iv-0XIFIKd3kE4dVtJR-AL1KDK9AIAcQGDdGNwglq_g3VkcIJawYV3YWt1MgU"}'
2025-02-12 04:06:06.535 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:06:06.541 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:06:06.541 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-12_04-06-05__30393b1d-9f73-4039-b999-04b7d5b312d2__wakuorg_nwaku:latest.log
2025-02-12 04:06:06.542 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:06:06.542 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:06:06.543 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:06:06.543 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.33.47
2025-02-12 04:06:06.543 DEBUG [src.node.docker_mananger] Generated ports ['29713', '29714', '29715', '29716', '29717']
2025-02-12 04:06:06.544 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:06:06.544 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:06:06.544 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:06:06.544 DEBUG [src.node.docker_mananger] docker run -i -t -p 29713:29713 -p 29714:29714 -p 29715:29715 -p 29716:29716 -p 29717:29717 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29715 --rest-port=29713 --tcp-port=29714 --discv5-udp-port=29716 --rest-address=0.0.0.0 --nat=extip:172.18.33.47 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=7ff3cde2b4d3f22f43cffdf84a68fbddbfee85895e0341bfa59cbf5d85ceadc0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29717 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QDz9TTQCCVDyzBfcm7eWwiawYblCaCENoEVtHcIWmR2rHn0fdj3ju5k5DGtDpYydJtVghLaCN-towF6U_JRNQuECgmlkgnY0gmlwhKwSA7KKbXVsdGlhZGRyc5YACASsEgOyBlq_AAoErBIDsgZawN0DgnJzhQACAQAAiXNlY3AyNTZrMaEC0gpiOOiaC1Iv-0XIFIKd3kE4dVtJR-AL1KDK9AIAcQGDdGNwglq_g3VkcIJawYV3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-12 04:06:06.770 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.33.47 waku f98a50500ec2e27835db9696057343b4255bc95f374e400f264f448fba58de1e
2025-02-12 04:06:06.820 DEBUG [src.node.docker_mananger] Container started with ID f98a50500ec2. Setting up logs at ./log/docker/node2_2025-02-12_04-06-05__30393b1d-9f73-4039-b999-04b7d5b312d2__wakuorg_nwaku:latest.log
2025-02-12 04:06:06.820 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29713
2025-02-12 04:06:06.820 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:06:07.821 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:07.835 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:06:07.836 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:06:07.836 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:07.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.33.47/tcp/29714/p2p/16Uiu2HAmEo1H4y1An89hwffGMgcWapJXqEyvb5nhFB14wj998U1E","/ip4/172.18.33.47/tcp/29715/ws/p2p/16Uiu2HAmEo1H4y1An89hwffGMgcWapJXqEyvb5nhFB14wj998U1E"],"enrUri":"enr:-L24QFxUe0Oqbgy8QKgqEO27JrexO1WZufeXqbsASh6hkzUDRSdveJ7mzj_8MBiT5hJflNm4O7Ifwm7sl9yyfBp-7zoCgmlkgnY0gmlwhKwSIS-KbXVsdGlhZGRyc5YACASsEiEvBnQSAAoErBIhLwZ0E90DgnJzhQACAQAAiXNlY3AyNTZrMaEDH8URmWhjT4H8u4qOPiEnrsB24U4FpQ0iTzOk0cEqp_GDdGNwgnQSg3VkcIJ0FIV3YWt1MgE"}'
2025-02-12 04:06:07.844 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:06:07.845 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29713/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.3.178/tcp/23231/p2p/16Uiu2HAm9ZanBsf2WdVmBENW65XLZJ7Exu5Pt9yC7JRxyYZ2x7k4"]'
2025-02-12 04:06:07.849 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.849 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto", "/waku/2/content/test.js", "/app/22/sometopic/someencoding", "/toychat/2/huilong/proto", "/statusim/1/community/cbor", "/app/27/sometopic/someencoding", "/app/29/sometopic/someencoding", "/app/20/sometopic/someencoding"]'
2025-02-12 04:06:07.860 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.862 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29713/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto", "/waku/2/content/test.js", "/app/22/sometopic/someencoding", "/toychat/2/huilong/proto", "/statusim/1/community/cbor", "/app/27/sometopic/someencoding", "/app/29/sometopic/someencoding", "/app/20/sometopic/someencoding"]'
2025-02-12 04:06:07.881 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.882 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L215YXBwLzEvbGF0ZXN0L3Byb3Rv", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.894 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.895 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L3dha3UvMi9jb250ZW50L3Rlc3QuanM=", "contentTopic": "/waku/2/content/test.js", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.900 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.901 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yMi9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/22/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.906 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.907 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L3RveWNoYXQvMi9odWlsb25nL3Byb3Rv", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.911 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.912 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L3N0YXR1c2ltLzEvY29tbXVuaXR5L2Nib3I=", "contentTopic": "/statusim/1/community/cbor", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.917 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.919 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yNy9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/27/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.924 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.925 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yOS9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/29/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.930 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.931 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23230/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yMC9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/20/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:06:07.936 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:06:07.937 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 04:06:08.037 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L215YXBwLzEvbGF0ZXN0L3Byb3Rv","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739333167882032640,"ephemeral":false}]'
2025-02-12 04:06:08.041 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Fwaku%2F2%2Fcontent%2Ftest.js" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.043 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L3dha3UvMi9jb250ZW50L3Rlc3QuanM=","contentTopic":"/waku/2/content/test.js","version":0,"timestamp":1739333167894927616,"ephemeral":false}]'
2025-02-12 04:06:08.044 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Fapp%2F22%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.046 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yMi9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/22/sometopic/someencoding","version":0,"timestamp":1739333167900837376,"ephemeral":false}]'
2025-02-12 04:06:08.046 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.048 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L3RveWNoYXQvMi9odWlsb25nL3Byb3Rv","contentTopic":"/toychat/2/huilong/proto","version":0,"timestamp":1739333167907432960,"ephemeral":false}]'
2025-02-12 04:06:08.049 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Fstatusim%2F1%2Fcommunity%2Fcbor" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.051 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L3N0YXR1c2ltLzEvY29tbXVuaXR5L2Nib3I=","contentTopic":"/statusim/1/community/cbor","version":0,"timestamp":1739333167912346624,"ephemeral":false}]'
2025-02-12 04:06:08.051 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Fapp%2F27%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.053 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yNy9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/27/sometopic/someencoding","version":0,"timestamp":1739333167919176448,"ephemeral":false}]'
2025-02-12 04:06:08.054 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Fapp%2F29%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.056 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yOS9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/29/sometopic/someencoding","version":0,"timestamp":1739333167925006592,"ephemeral":false}]'
2025-02-12 04:06:08.056 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/relay/v1/auto/messages/%2Fapp%2F20%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:06:08.058 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yMC9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/20/sometopic/someencoding","version":0,"timestamp":1739333167931133440,"ephemeral":false}]'
2025-02-12 04:06:08.060 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:06:08.061 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:06:08.061 DEBUG [src.node.waku_node] Stopping container with id 99c6f9c77d53
2025-02-12 04:06:09.140 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:06:09.141 DEBUG [src.node.waku_node] Stopping container with id f98a50500ec2
2025-02-12 04:06:09.985 ERROR [src.node.docker_mananger] Max retries reached for container 99c6f9c77d53. Exiting log stream.
2025-02-12 04:06:10.670 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:06:10.672 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:06:10.687 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:06:10.695 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
