2025-02-12 04:03:40.336 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:03:40.337 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/5/999] with id: 2025-02-12_04-03-40__55ff6a59-a6c3-45fb-af1c-76a582b5879e
2025-02-12 04:03:40.338 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:03:40.339 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-12 04:03:40.339 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-12 04:03:40.350 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:03:40.351 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-12_04-03-40__55ff6a59-a6c3-45fb-af1c-76a582b5879e__wakuorg_nwaku:latest.log
2025-02-12 04:03:40.351 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:03:40.352 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:03:40.353 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:03:40.353 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.11.17
2025-02-12 04:03:40.353 DEBUG [src.node.docker_mananger] Generated ports ['49618', '49619', '49620', '49621', '49622']
2025-02-12 04:03:40.353 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-12 04:03:40.353 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:03:40.354 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:03:40.354 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:03:40.354 DEBUG [src.node.docker_mananger] docker run -i -t -p 49618:49618 -p 49619:49619 -p 49620:49620 -p 49621:49621 -p 49622:49622 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49620 --rest-port=49618 --tcp-port=49619 --discv5-udp-port=49621 --rest-address=0.0.0.0 --nat=extip:172.18.11.17 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=0cc7e25a8b2f6a43643f97ee661d0dd9f75701d9aee0aafaee24b0d3b4f926ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49622 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/5/999
2025-02-12 04:03:40.579 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.11.17 waku 8917e85c0ba7b2336f461759bae3a44c3e915c74650f11abf18f10335b681997
2025-02-12 04:03:40.625 DEBUG [src.node.docker_mananger] Container started with ID 8917e85c0ba7. Setting up logs at ./log/docker/node1_2025-02-12_04-03-40__55ff6a59-a6c3-45fb-af1c-76a582b5879e__wakuorg_nwaku:latest.log
2025-02-12 04:03:40.626 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 49618
2025-02-12 04:03:40.626 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:03:41.162 ERROR [src.node.docker_mananger] Max retries reached for container 36bc8b554b80. Exiting log stream.
2025-02-12 04:03:41.627 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49618/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:41.630 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:03:41.631 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:03:41.631 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49618/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:41.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.11.17/tcp/49619/p2p/16Uiu2HAkwe9cd46tra29yB5wbNxxAVHMQgNMQ3EktrFhHy1ALtoa","/ip4/172.18.11.17/tcp/49620/ws/p2p/16Uiu2HAkwe9cd46tra29yB5wbNxxAVHMQgNMQ3EktrFhHy1ALtoa"],"enrUri":"enr:-L24QNDVedsEayo2bG3yNVa2ieWd91bTiC6VQdXLcvn8NI_8a1brGsAui8BmaTCrthdAxBr1V-1tgvo_8po-epEZ6sICgmlkgnY0gmlwhKwSCxGKbXVsdGlhZGRyc5YACASsEgsRBsHTAAoErBILEQbB1N0DgnJzhQAFAQPniXNlY3AyNTZrMaECIOmXLUS-d3Kz04E9cAb5-PknrVOILhjLnCYJXq3AVUGDdGNwgsHTg3VkcILB1YV3YWt1MgU"}'
2025-02-12 04:03:41.633 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:03:41.639 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:03:41.640 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-12_04-03-40__55ff6a59-a6c3-45fb-af1c-76a582b5879e__wakuorg_nwaku:latest.log
2025-02-12 04:03:41.640 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:03:41.640 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:03:41.641 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:03:41.641 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.12.224
2025-02-12 04:03:41.641 DEBUG [src.node.docker_mananger] Generated ports ['33006', '33007', '33008', '33009', '33010']
2025-02-12 04:03:41.641 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-12 04:03:41.642 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:03:41.642 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:03:41.642 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:03:41.642 DEBUG [src.node.docker_mananger] docker run -i -t -p 33006:33006 -p 33007:33007 -p 33008:33008 -p 33009:33009 -p 33010:33010 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33008 --rest-port=33006 --tcp-port=33007 --discv5-udp-port=33009 --rest-address=0.0.0.0 --nat=extip:172.18.12.224 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=7523df4cebc247c91aa2df2ccefca61cedcc078c74d40551acbf4dde364636e9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33010 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QNDVedsEayo2bG3yNVa2ieWd91bTiC6VQdXLcvn8NI_8a1brGsAui8BmaTCrthdAxBr1V-1tgvo_8po-epEZ6sICgmlkgnY0gmlwhKwSCxGKbXVsdGlhZGRyc5YACASsEgsRBsHTAAoErBILEQbB1N0DgnJzhQAFAQPniXNlY3AyNTZrMaECIOmXLUS-d3Kz04E9cAb5-PknrVOILhjLnCYJXq3AVUGDdGNwgsHTg3VkcILB1YV3YWt1MgU --pubsub-topic=/waku/2/rs/5/999
2025-02-12 04:03:41.866 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.12.224 waku 7e3448dd18227966f5961dba69fa438526ceedcc1100631a003d86c752ce6798
2025-02-12 04:03:41.915 DEBUG [src.node.docker_mananger] Container started with ID 7e3448dd1822. Setting up logs at ./log/docker/node2_2025-02-12_04-03-40__55ff6a59-a6c3-45fb-af1c-76a582b5879e__wakuorg_nwaku:latest.log
2025-02-12 04:03:41.915 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33006
2025-02-12 04:03:41.915 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:03:42.916 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33006/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:42.927 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:03:42.928 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:03:42.928 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33006/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:42.932 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.12.224/tcp/33007/p2p/16Uiu2HAmSRSpLENBQ7QyZHotwYefKTLfuxkLj2Qh6rBZoo3dhg75","/ip4/172.18.12.224/tcp/33008/ws/p2p/16Uiu2HAmSRSpLENBQ7QyZHotwYefKTLfuxkLj2Qh6rBZoo3dhg75"],"enrUri":"enr:-L24QEknSZ8SeG8Cike9TxXyso_JF_V1K6ixbRDoyVz44KWeLgmgNLKgibAu8PTJ4g4Y-KpP2Ahsdi-pWdYFZo_P4JcCgmlkgnY0gmlwhKwSDOCKbXVsdGlhZGRyc5YACASsEgzgBoDvAAoErBIM4AaA8N0DgnJzhQAFAQPniXNlY3AyNTZrMaEDzItpP5BGU7MYiwApJK1351fJKGif71B0CHfcTEu4jByDdGNwgoDvg3VkcIKA8YV3YWt1MgE"}'
2025-02-12 04:03:42.933 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:03:42.933 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33006/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.11.17/tcp/49619/p2p/16Uiu2HAkwe9cd46tra29yB5wbNxxAVHMQgNMQ3EktrFhHy1ALtoa"]'
2025-02-12 04:03:42.939 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:42.939 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:49618/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/999"]'
2025-02-12 04:03:42.942 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:42.942 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33006/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/999"]'
2025-02-12 04:03:42.944 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:42.945 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:49618/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:03:42.950 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:42.950 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 04:03:43.051 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 04:03:43.051 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49618/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:43.054 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739333022945263616,"ephemeral":false}]'
2025-02-12 04:03:43.055 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-12 04:03:43.056 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33006/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F999" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:43.058 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739333022945263616,"ephemeral":false}]'
2025-02-12 04:03:43.060 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:03:43.061 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:03:43.062 DEBUG [src.node.waku_node] Stopping container with id 8917e85c0ba7
2025-02-12 04:03:44.127 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:03:44.128 DEBUG [src.node.waku_node] Stopping container with id 7e3448dd1822
2025-02-12 04:03:44.953 ERROR [src.node.docker_mananger] Max retries reached for container 8917e85c0ba7. Exiting log stream.
2025-02-12 04:03:45.642 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:03:45.643 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:03:45.652 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:03:45.656 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
