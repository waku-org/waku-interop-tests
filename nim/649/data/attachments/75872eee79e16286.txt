2025-02-12 04:05:53.965 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:05:53.965 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/5/1] with id: 2025-02-12_04-05-53__a59d723d-60aa-4672-821a-d06821b433c7
2025-02-12 04:05:53.965 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:05:53.966 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-12 04:05:53.966 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-12 04:05:53.973 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:05:53.973 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-12_04-05-53__a59d723d-60aa-4672-821a-d06821b433c7__wakuorg_nwaku:latest.log
2025-02-12 04:05:53.973 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:05:53.973 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:05:53.975 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:05:53.975 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.232.216
2025-02-12 04:05:53.975 DEBUG [src.node.docker_mananger] Generated ports ['56002', '56003', '56004', '56005', '56006']
2025-02-12 04:05:53.975 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-12 04:05:53.975 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:05:53.976 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:05:53.976 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:05:53.976 DEBUG [src.node.docker_mananger] docker run -i -t -p 56002:56002 -p 56003:56003 -p 56004:56004 -p 56005:56005 -p 56006:56006 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56004 --rest-port=56002 --tcp-port=56003 --discv5-udp-port=56005 --rest-address=0.0.0.0 --nat=extip:172.18.232.216 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=b157fbae2b0a37d8aa1e2570b3a0edc665eb6d0af4bbb4e6bc7686c0d10ce90c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56006 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/5/1
2025-02-12 04:05:54.216 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.232.216 waku 109df84b46601c13bd9f00e210c42082ce347d52a24103a6ff3b398f6cf64145
2025-02-12 04:05:54.270 DEBUG [src.node.docker_mananger] Container started with ID 109df84b4660. Setting up logs at ./log/docker/node1_2025-02-12_04-05-53__a59d723d-60aa-4672-821a-d06821b433c7__wakuorg_nwaku:latest.log
2025-02-12 04:05:54.271 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 56002
2025-02-12 04:05:54.272 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:05:54.771 ERROR [src.node.docker_mananger] Max retries reached for container 12fa57aa8534. Exiting log stream.
2025-02-12 04:05:55.272 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56002/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:55.275 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:05:55.275 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:05:55.276 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56002/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:55.278 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.232.216/tcp/56003/p2p/16Uiu2HAm9Z66Sxo68PrK9pTPavfmp1RGZ3GZM98uPa549tqGFgsW","/ip4/172.18.232.216/tcp/56004/ws/p2p/16Uiu2HAm9Z66Sxo68PrK9pTPavfmp1RGZ3GZM98uPa549tqGFgsW"],"enrUri":"enr:-L24QH6nSvPcjpS7nUE1n-eI0S9e51E7mZlw_D2v5lcvn_zrChj5WOVDP3oI_rS8B-cLZe-OWPcTBmajnRAjaNwwu_QCgmlkgnY0gmlwhKwS6NiKbXVsdGlhZGRyc5YACASsEujYBtrDAAoErBLo2AbaxN0DgnJzhQAFAQABiXNlY3AyNTZrMaEC0enzAm86HAe8DZcrjvTKkt1FUKm4HzPkwu9iuQDe3c2DdGNwgtrDg3VkcILaxYV3YWt1MgU"}'
2025-02-12 04:05:55.278 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:05:55.284 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:05:55.285 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-12_04-05-53__a59d723d-60aa-4672-821a-d06821b433c7__wakuorg_nwaku:latest.log
2025-02-12 04:05:55.285 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:05:55.285 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:05:55.286 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:05:55.287 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.218.9
2025-02-12 04:05:55.287 DEBUG [src.node.docker_mananger] Generated ports ['42723', '42724', '42725', '42726', '42727']
2025-02-12 04:05:55.287 DEBUG [src.node.waku_node] Cluster id was resolved to: 5
2025-02-12 04:05:55.287 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:05:55.287 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:05:55.287 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:05:55.287 DEBUG [src.node.docker_mananger] docker run -i -t -p 42723:42723 -p 42724:42724 -p 42725:42725 -p 42726:42726 -p 42727:42727 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42725 --rest-port=42723 --tcp-port=42724 --discv5-udp-port=42726 --rest-address=0.0.0.0 --nat=extip:172.18.218.9 --peer-exchange=true --discv5-discovery=true --cluster-id=5 --nodekey=4f7ff57dce3e514df332fcfb32657cdadc29d7367eebab124abdaceb58e59c47 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42727 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QH6nSvPcjpS7nUE1n-eI0S9e51E7mZlw_D2v5lcvn_zrChj5WOVDP3oI_rS8B-cLZe-OWPcTBmajnRAjaNwwu_QCgmlkgnY0gmlwhKwS6NiKbXVsdGlhZGRyc5YACASsEujYBtrDAAoErBLo2AbaxN0DgnJzhQAFAQABiXNlY3AyNTZrMaEC0enzAm86HAe8DZcrjvTKkt1FUKm4HzPkwu9iuQDe3c2DdGNwgtrDg3VkcILaxYV3YWt1MgU --pubsub-topic=/waku/2/rs/5/1
2025-02-12 04:05:55.529 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.218.9 waku 6e669fb6ed576097edc47f5b6f144637b1698394b163020a12aa81f4e984dd63
2025-02-12 04:05:55.580 DEBUG [src.node.docker_mananger] Container started with ID 6e669fb6ed57. Setting up logs at ./log/docker/node2_2025-02-12_04-05-53__a59d723d-60aa-4672-821a-d06821b433c7__wakuorg_nwaku:latest.log
2025-02-12 04:05:55.580 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42723
2025-02-12 04:05:55.580 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:05:56.581 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42723/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:56.591 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:05:56.592 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:05:56.592 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42723/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:56.599 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.218.9/tcp/42724/p2p/16Uiu2HAm83xztbALGTJeuPUaW6PCuDh8BTZSX2ryDGhmEgBzuQVV","/ip4/172.18.218.9/tcp/42725/ws/p2p/16Uiu2HAm83xztbALGTJeuPUaW6PCuDh8BTZSX2ryDGhmEgBzuQVV"],"enrUri":"enr:-L24QBzG0Wz6neXogNGBJG_CzfQQ6Y__jaQZWGSHc0n2Fw1_CaakLHGl8FI6w0nEGlIhibxym_aaKr9ouB2gXdVpzOsCgmlkgnY0gmlwhKwS2gmKbXVsdGlhZGRyc5YACASsEtoJBqbkAAoErBLaCQam5d0DgnJzhQAFAQABiXNlY3AyNTZrMaECu5hlRReg5diJQNqUwP-OMJUizYQYLyqlT-Vj_bW3ueCDdGNwgqbkg3VkcIKm5oV3YWt1MgE"}'
2025-02-12 04:05:56.599 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:05:56.600 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42723/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.232.216/tcp/56003/p2p/16Uiu2HAm9Z66Sxo68PrK9pTPavfmp1RGZ3GZM98uPa549tqGFgsW"]'
2025-02-12 04:05:56.604 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:56.604 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56002/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/1"]'
2025-02-12 04:05:56.606 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:56.607 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42723/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/5/1"]'
2025-02-12 04:05:56.609 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:56.610 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:05:56.615 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:56.615 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 04:05:56.716 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 04:05:56.716 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:56.719 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739333156609920256,"ephemeral":false}]'
2025-02-12 04:05:56.721 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-12 04:05:56.721 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42723/relay/v1/messages/%2Fwaku%2F2%2Frs%2F5%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:56.723 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739333156609920256,"ephemeral":false}]'
2025-02-12 04:05:56.726 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:05:56.727 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:05:56.727 DEBUG [src.node.waku_node] Stopping container with id 109df84b4660
2025-02-12 04:05:57.794 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:05:57.795 DEBUG [src.node.waku_node] Stopping container with id 6e669fb6ed57
2025-02-12 04:05:58.607 ERROR [src.node.docker_mananger] Max retries reached for container 109df84b4660. Exiting log stream.
2025-02-12 04:05:59.324 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:05:59.325 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:05:59.330 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:05:59.335 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
