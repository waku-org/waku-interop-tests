2025-02-12 04:03:07.203 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:03:07.203 DEBUG [tests.conftest] Running test: test_filter_get_message_with_version with id: 2025-02-12_04-03-07__c0f19853-f8f5-4894-a1d8-546faa01a15f
2025-02-12 04:03:07.204 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:03:07.204 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-12 04:03:07.204 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-12 04:03:07.210 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:03:07.210 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-12_04-03-07__c0f19853-f8f5-4894-a1d8-546faa01a15f__wakuorg_nwaku:latest.log
2025-02-12 04:03:07.210 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:03:07.210 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:03:07.211 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:03:07.212 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.221.49
2025-02-12 04:03:07.212 DEBUG [src.node.docker_mananger] Generated ports ['13920', '13921', '13922', '13923', '13924']
2025-02-12 04:03:07.212 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:03:07.212 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:03:07.212 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:03:07.212 DEBUG [src.node.docker_mananger] docker run -i -t -p 13920:13920 -p 13921:13921 -p 13922:13922 -p 13923:13923 -p 13924:13924 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13922 --rest-port=13920 --tcp-port=13921 --discv5-udp-port=13923 --rest-address=0.0.0.0 --nat=extip:172.18.221.49 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7ee4b32abe4bdaab99b45b8de3d5aed507f3b48a8ac3dded7c4cab9aec2fa0bf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13924 --metrics-logging=true --relay=true --filter=true
2025-02-12 04:03:07.437 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.221.49 waku b42059ba1d976a89e9f0f13ed6d3d6ecbd66f293e05e77a5c4e83d709533aef3
2025-02-12 04:03:07.482 DEBUG [src.node.docker_mananger] Container started with ID b42059ba1d97. Setting up logs at ./log/docker/node1_2025-02-12_04-03-07__c0f19853-f8f5-4894-a1d8-546faa01a15f__wakuorg_nwaku:latest.log
2025-02-12 04:03:07.483 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 13920
2025-02-12 04:03:07.484 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:03:07.976 ERROR [src.node.docker_mananger] Max retries reached for container c22fade78f0f. Exiting log stream.
2025-02-12 04:03:08.484 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13920/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:08.487 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:03:08.487 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:03:08.488 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13920/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:08.490 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.221.49/tcp/13921/p2p/16Uiu2HAm8rPK6MGV48Lfs4ZWv4gQqbmfjfaYCkvXjJ36kDynVsuN","/ip4/172.18.221.49/tcp/13922/ws/p2p/16Uiu2HAm8rPK6MGV48Lfs4ZWv4gQqbmfjfaYCkvXjJ36kDynVsuN"],"enrUri":"enr:-L24QIOjHSinatjCm0d5BM07dnsT_O3Sao_COnIhJZauGIrbQn7oq1Ju7L-obRQGIPszAtfzc-Qy0S415VHaasGeghYCgmlkgnY0gmlwhKwS3TGKbXVsdGlhZGRyc5YACASsEt0xBjZhAAoErBLdMQY2Yt0DgnJzhQADAQAAiXNlY3AyNTZrMaECx3yaw9C05TpnUOimz8pg5YRtS_GX9Vo_A_bNzRxuW5WDdGNwgjZhg3VkcII2Y4V3YWt1MgU"}'
2025-02-12 04:03:08.490 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:03:08.490 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-12 04:03:08.496 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:03:08.496 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-12_04-03-07__c0f19853-f8f5-4894-a1d8-546faa01a15f__wakuorg_nwaku:latest.log
2025-02-12 04:03:08.496 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:03:08.496 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:03:08.498 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:03:08.498 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.133.93
2025-02-12 04:03:08.498 DEBUG [src.node.docker_mananger] Generated ports ['38498', '38499', '38500', '38501', '38502']
2025-02-12 04:03:08.498 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:03:08.498 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:03:08.498 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:03:08.499 DEBUG [src.node.docker_mananger] docker run -i -t -p 38498:38498 -p 38499:38499 -p 38500:38500 -p 38501:38501 -p 38502:38502 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38500 --rest-port=38498 --tcp-port=38499 --discv5-udp-port=38501 --rest-address=0.0.0.0 --nat=extip:172.18.133.93 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a9307c48ed600dcf6ffd599bd2dc081cf3c9afe8b331f44a8ba369db7014435e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38502 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QIOjHSinatjCm0d5BM07dnsT_O3Sao_COnIhJZauGIrbQn7oq1Ju7L-obRQGIPszAtfzc-Qy0S415VHaasGeghYCgmlkgnY0gmlwhKwS3TGKbXVsdGlhZGRyc5YACASsEt0xBjZhAAoErBLdMQY2Yt0DgnJzhQADAQAAiXNlY3AyNTZrMaECx3yaw9C05TpnUOimz8pg5YRtS_GX9Vo_A_bNzRxuW5WDdGNwgjZhg3VkcII2Y4V3YWt1MgU --filternode=/ip4/172.18.221.49/tcp/13921/p2p/16Uiu2HAm8rPK6MGV48Lfs4ZWv4gQqbmfjfaYCkvXjJ36kDynVsuN
2025-02-12 04:03:08.725 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.133.93 waku ce621dc994ecff6ff6fc25739fe6f1ed6abd36f6375b4494be60c519324d8200
2025-02-12 04:03:08.771 DEBUG [src.node.docker_mananger] Container started with ID ce621dc994ec. Setting up logs at ./log/docker/node2_2025-02-12_04-03-07__c0f19853-f8f5-4894-a1d8-546faa01a15f__wakuorg_nwaku:latest.log
2025-02-12 04:03:08.772 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 38498
2025-02-12 04:03:08.772 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:03:09.772 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38498/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:09.775 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:03:09.775 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:03:09.776 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38498/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:09.778 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.133.93/tcp/38499/p2p/16Uiu2HAm1MSRBMQ6opZXniqvLp2wsGp91C2GTdbSo5qF8muatMMg","/ip4/172.18.133.93/tcp/38500/ws/p2p/16Uiu2HAm1MSRBMQ6opZXniqvLp2wsGp91C2GTdbSo5qF8muatMMg"],"enrUri":"enr:-L24QNqlHRGXtXQaOao3WlVWonsEaQwWaoSH-h3UoKWkRbjRZuwSRok4ahw115rsJ4JXghfsV4VNMzw-Z6gg0OQ5XHACgmlkgnY0gmlwhKwShV2KbXVsdGlhZGRyc5YACASsEoVdBpZjAAoErBKFXQaWZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECWBB2nwpreA9nZjKTr4d0xrnoxuUwJERQjOHjWyBLj4eDdGNwgpZjg3VkcIKWZYV3YWt1MgA"}'
2025-02-12 04:03:09.778 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:03:09.778 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38498/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.221.49/tcp/13921/p2p/16Uiu2HAm8rPK6MGV48Lfs4ZWv4gQqbmfjfaYCkvXjJ36kDynVsuN"]'
2025-02-12 04:03:09.814 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:09.817 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-12 04:03:09.817 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13920/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 04:03:09.837 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:09.839 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38498/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "0d3809f7-2c16-4ee8-8f57-28c115b72ca2", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-12 04:03:09.851 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"0d3809f7-2c16-4ee8-8f57-28c115b72ca2","statusDesc":"OK"}'
2025-02-12 04:03:09.853 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13920/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "version": 10}'
2025-02-12 04:03:09.860 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:09.860 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 04:03:09.960 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-12 04:03:09.961 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38498/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:09.963 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":10,"timestamp":1739332989852979712,"ephemeral":false}]'
2025-02-12 04:03:09.966 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:03:09.967 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:03:09.967 DEBUG [src.node.waku_node] Stopping container with id b42059ba1d97
2025-02-12 04:03:11.036 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:03:11.037 DEBUG [src.node.waku_node] Stopping container with id ce621dc994ec
2025-02-12 04:03:11.847 ERROR [src.node.docker_mananger] Max retries reached for container b42059ba1d97. Exiting log stream.
2025-02-12 04:03:12.525 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:03:12.526 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:03:12.532 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:03:12.537 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
