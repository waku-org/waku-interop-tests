2025-02-12 04:05:22.468 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:05:22.468 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-12_04-05-22__0736ca9b-c74a-44bc-a1af-047fd513e8bd
2025-02-12 04:05:22.469 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:05:22.469 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-12 04:05:22.469 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-12 04:05:22.469 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-12 04:05:22.470 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-12 04:05:22.478 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:05:22.478 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-12_04-05-22__0736ca9b-c74a-44bc-a1af-047fd513e8bd__wakuorg_nwaku:latest.log
2025-02-12 04:05:22.478 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:05:22.478 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:05:22.480 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:05:22.480 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.7.236
2025-02-12 04:05:22.480 DEBUG [src.node.docker_mananger] Generated ports ['63948', '63949', '63950', '63951', '63952']
2025-02-12 04:05:22.480 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:05:22.480 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:05:22.480 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:05:22.481 DEBUG [src.node.docker_mananger] docker run -i -t -p 63948:63948 -p 63949:63949 -p 63950:63950 -p 63951:63951 -p 63952:63952 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63950 --rest-port=63948 --tcp-port=63949 --discv5-udp-port=63951 --rest-address=0.0.0.0 --nat=extip:172.18.7.236 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=42e57eb6229e78f1bf8a1f33e78fe3dded276ceecab27dfe450e4ae741e902e3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63952 --metrics-logging=true --lightpush=true --relay=true
2025-02-12 04:05:22.713 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.7.236 waku f3a135649edf07bd699bdf4140f49ba1779a832f6aafd680087e6e53a9b00d4a
2025-02-12 04:05:22.765 DEBUG [src.node.docker_mananger] Container started with ID f3a135649edf. Setting up logs at ./log/docker/receiving_node1_2025-02-12_04-05-22__0736ca9b-c74a-44bc-a1af-047fd513e8bd__wakuorg_nwaku:latest.log
2025-02-12 04:05:22.765 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 63948
2025-02-12 04:05:22.766 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:05:23.246 ERROR [src.node.docker_mananger] Max retries reached for container 1c5514e6bdac. Exiting log stream.
2025-02-12 04:05:23.766 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63948/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:23.769 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:05:23.769 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:05:23.769 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63948/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:23.771 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.7.236/tcp/63949/p2p/16Uiu2HAmS2H1FTYMJNpySzEEZLwSL3cX7hgnwSfKDxgasgpa48hc","/ip4/172.18.7.236/tcp/63950/ws/p2p/16Uiu2HAmS2H1FTYMJNpySzEEZLwSL3cX7hgnwSfKDxgasgpa48hc"],"enrUri":"enr:-L24QHakSpDCWg-_8fOxBRQ1k2xL2mQDLuC-JB-YlCuhp1mORniO3kWlfio-wvcL2-kt8uzanG_97P0uaHiPT3QoM9ECgmlkgnY0gmlwhKwSB-yKbXVsdGlhZGRyc5YACASsEgfsBvnNAAoErBIH7Ab5zt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDxpv1VIUs3XxAZyvk4mrNZzlC-KVBE7pu_qPR4I4KLteDdGNwgvnNg3VkcIL5z4V3YWt1Mgk"}'
2025-02-12 04:05:23.771 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:05:23.778 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:05:23.778 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-12_04-05-22__0736ca9b-c74a-44bc-a1af-047fd513e8bd__wakuorg_nwaku:latest.log
2025-02-12 04:05:23.778 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:05:23.778 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:05:23.779 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:05:23.780 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.84.228
2025-02-12 04:05:23.780 DEBUG [src.node.docker_mananger] Generated ports ['62037', '62038', '62039', '62040', '62041']
2025-02-12 04:05:23.780 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:05:23.780 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:05:23.780 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:05:23.780 DEBUG [src.node.docker_mananger] docker run -i -t -p 62037:62037 -p 62038:62038 -p 62039:62039 -p 62040:62040 -p 62041:62041 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62039 --rest-port=62037 --tcp-port=62038 --discv5-udp-port=62040 --rest-address=0.0.0.0 --nat=extip:172.18.84.228 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2f1abac8d449b11a3408dacfbae99cfdc92cc00ea1caadf1f26fe9e3a76afcbe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62041 --metrics-logging=true --lightpush=false --relay=true
2025-02-12 04:05:24.004 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.84.228 waku 5843c09fe26a51e20a0e545f2d228fdb0263a1e38d080c77b0fbe4f106d23c24
2025-02-12 04:05:24.055 DEBUG [src.node.docker_mananger] Container started with ID 5843c09fe26a. Setting up logs at ./log/docker/receiving_node2_2025-02-12_04-05-22__0736ca9b-c74a-44bc-a1af-047fd513e8bd__wakuorg_nwaku:latest.log
2025-02-12 04:05:24.055 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62037
2025-02-12 04:05:24.055 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:05:25.056 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62037/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:25.059 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:05:25.059 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:05:25.059 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62037/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:25.061 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.84.228/tcp/62038/p2p/16Uiu2HAmAU7GBaqByxZPUFgLFQX19fFssrj6g6sHxPBQha19hV7e","/ip4/172.18.84.228/tcp/62039/ws/p2p/16Uiu2HAmAU7GBaqByxZPUFgLFQX19fFssrj6g6sHxPBQha19hV7e"],"enrUri":"enr:-L24QLeCqwnnN-MX2YIEbbqNSxT4pbMr4lFqdjA-TunSsOlpH3o6afxo9Bmljlf53MdPOlTG88UPY7kVhD_6jRGhwUICgmlkgnY0gmlwhKwSVOSKbXVsdGlhZGRyc5YACASsElTkBvJWAAoErBJU5AbyV90DgnJzhQADAQAAiXNlY3AyNTZrMaEC338NeIZT-fyXM9KavCGNbw26QHAZ8mTdL4YYJS4CbXGDdGNwgvJWg3VkcILyWIV3YWt1MgE"}'
2025-02-12 04:05:25.061 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:05:25.061 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62037/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.7.236/tcp/63949/p2p/16Uiu2HAmS2H1FTYMJNpySzEEZLwSL3cX7hgnwSfKDxgasgpa48hc"]'
2025-02-12 04:05:25.100 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:25.110 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:05:25.110 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-12_04-05-22__0736ca9b-c74a-44bc-a1af-047fd513e8bd__wakuorg_nwaku:latest.log
2025-02-12 04:05:25.110 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:05:25.110 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:05:25.112 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:05:25.112 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.81.236
2025-02-12 04:05:25.112 DEBUG [src.node.docker_mananger] Generated ports ['59874', '59875', '59876', '59877', '59878']
2025-02-12 04:05:25.112 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:05:25.112 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:05:25.112 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:05:25.112 DEBUG [src.node.docker_mananger] docker run -i -t -p 59874:59874 -p 59875:59875 -p 59876:59876 -p 59877:59877 -p 59878:59878 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59876 --rest-port=59874 --tcp-port=59875 --discv5-udp-port=59877 --rest-address=0.0.0.0 --nat=extip:172.18.81.236 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0baf416f92aa5b25febbf4dcda6e8e7c4c7bcb2b6ece54dabc2ffcdc791f8b66 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59878 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHakSpDCWg-_8fOxBRQ1k2xL2mQDLuC-JB-YlCuhp1mORniO3kWlfio-wvcL2-kt8uzanG_97P0uaHiPT3QoM9ECgmlkgnY0gmlwhKwSB-yKbXVsdGlhZGRyc5YACASsEgfsBvnNAAoErBIH7Ab5zt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDxpv1VIUs3XxAZyvk4mrNZzlC-KVBE7pu_qPR4I4KLteDdGNwgvnNg3VkcIL5z4V3YWt1Mgk --lightpushnode=/ip4/172.18.7.236/tcp/63949/p2p/16Uiu2HAmS2H1FTYMJNpySzEEZLwSL3cX7hgnwSfKDxgasgpa48hc --lightpush=true --relay=false
2025-02-12 04:05:25.354 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.81.236 waku c590f111f75e0767ecf7532b56ff4bc9866b5d26da040f3ad6402fb657f08a2d
2025-02-12 04:05:25.401 DEBUG [src.node.docker_mananger] Container started with ID c590f111f75e. Setting up logs at ./log/docker/lightpush_node1_2025-02-12_04-05-22__0736ca9b-c74a-44bc-a1af-047fd513e8bd__wakuorg_nwaku:latest.log
2025-02-12 04:05:25.402 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59874
2025-02-12 04:05:25.402 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:05:26.402 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59874/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:26.405 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:05:26.405 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:05:26.406 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59874/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:26.408 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.236/tcp/59875/p2p/16Uiu2HAmRo777vHF1wKWJUDVmQxTmmwj8T1XN5RQEXw96V4isPmH","/ip4/172.18.81.236/tcp/59876/ws/p2p/16Uiu2HAmRo777vHF1wKWJUDVmQxTmmwj8T1XN5RQEXw96V4isPmH"],"enrUri":"enr:-L24QDLs-fHqh3Oi0wlA1J3PdKk1JrSs20yXHZlzDsi-FmD-Csu7JGidPD4WfIJ8F2KzjDmHVwXkfA6zPOcabIIG4iQCgmlkgnY0gmlwhKwSUeyKbXVsdGlhZGRyc5YACASsElHsBunjAAoErBJR7Abp5N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwzw3F36lUgQa6v2vXiov-MVsrM7mCHLmiGtq98iY1uCDdGNwgunjg3VkcILp5YV3YWt1Mgg"}'
2025-02-12 04:05:26.408 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:05:26.408 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59874/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.7.236/tcp/63949/p2p/16Uiu2HAmS2H1FTYMJNpySzEEZLwSL3cX7hgnwSfKDxgasgpa48hc"]'
2025-02-12 04:05:26.444 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:26.452 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59874/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.84.228/tcp/62038/p2p/16Uiu2HAmAU7GBaqByxZPUFgLFQX19fFssrj6g6sHxPBQha19hV7e"]'
2025-02-12 04:05:26.478 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:26.479 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63948/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 04:05:26.489 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:26.490 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62037/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 04:05:26.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:26.500 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59874/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1739333126500391168}}'
2025-02-12 04:05:26.511 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:05:26.511 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-12 04:05:27.012 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63948/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:05:27.014 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739333126500391168,"ephemeral":false}]'
2025-02-12 04:05:27.014 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-12 04:05:32.015 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.7.236/tcp/63949"} has 1
2025-02-12 04:05:32.019 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.7.236/tcp/63949"} with value 1.0
2025-02-12 04:05:32.020 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-12 04:05:32.023 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-12 04:05:32.023 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-12 04:05:32.026 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-12 04:05:32.026 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-12 04:05:32.029 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-12 04:05:32.030 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-12 04:05:32.032 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-12 04:05:32.033 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-12 04:05:32.035 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-12 04:05:32.036 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-12 04:05:32.039 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-12 04:05:32.039 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-12 04:05:32.042 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-12 04:05:32.042 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-12 04:05:32.045 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-12 04:05:32.045 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-12 04:05:32.048 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-12 04:05:32.050 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:05:32.051 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:05:32.051 DEBUG [src.node.waku_node] Stopping container with id f3a135649edf
2025-02-12 04:05:33.574 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:05:33.574 DEBUG [src.node.waku_node] Stopping container with id 5843c09fe26a
2025-02-12 04:05:34.385 ERROR [src.node.docker_mananger] Max retries reached for container f3a135649edf. Exiting log stream.
2025-02-12 04:05:34.632 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:05:34.632 DEBUG [src.node.waku_node] Stopping container with id c590f111f75e
2025-02-12 04:05:35.444 ERROR [src.node.docker_mananger] Max retries reached for container 5843c09fe26a. Exiting log stream.
2025-02-12 04:05:36.134 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:05:36.136 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:05:36.145 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:05:36.153 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:05:36.158 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
