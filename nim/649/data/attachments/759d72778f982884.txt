2025-02-12 04:09:57.157 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:09:57.158 DEBUG [tests.conftest] Running test: test_main_node_relay_and_store__peer_only_store with id: 2025-02-12_04-09-57__4a579fba-8421-4a74-bf5a-f0f4d6b16cb6
2025-02-12 04:09:57.158 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:09:57.158 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-12 04:09:57.166 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:09:57.166 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-12_04-09-57__4a579fba-8421-4a74-bf5a-f0f4d6b16cb6__wakuorg_nwaku:latest.log
2025-02-12 04:09:57.166 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:09:57.166 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:09:57.168 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:09:57.168 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.107
2025-02-12 04:09:57.168 DEBUG [src.node.docker_mananger] Generated ports ['38720', '38721', '38722', '38723', '38724']
2025-02-12 04:09:57.168 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:09:57.168 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:09:57.168 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:09:57.168 DEBUG [src.node.docker_mananger] docker run -i -t -p 38720:38720 -p 38721:38721 -p 38722:38722 -p 38723:38723 -p 38724:38724 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38722 --rest-port=38720 --tcp-port=38721 --discv5-udp-port=38723 --rest-address=0.0.0.0 --nat=extip:172.18.254.107 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f51161fcd8bb75a7efdcfb04af340aefe7f35b33d017ac23d5bec4b16cee65ef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38724 --metrics-logging=true --store=true --relay=true
2025-02-12 04:09:57.404 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.107 waku 50602e0b9c8a98e0a44b0ecc350ffc112ff04858d0c993c3a68988e2c9a2ec0d
2025-02-12 04:09:57.458 DEBUG [src.node.docker_mananger] Container started with ID 50602e0b9c8a. Setting up logs at ./log/docker/publishing_node1_2025-02-12_04-09-57__4a579fba-8421-4a74-bf5a-f0f4d6b16cb6__wakuorg_nwaku:latest.log
2025-02-12 04:09:57.460 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 38720
2025-02-12 04:09:57.460 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:09:57.962 ERROR [src.node.docker_mananger] Max retries reached for container e1582c5153c0. Exiting log stream.
2025-02-12 04:09:58.460 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38720/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:09:58.463 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:09:58.464 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:09:58.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38720/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:09:58.466 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.107/tcp/38721/p2p/16Uiu2HAmJBR4Sx2wgcV4Pqxu7K8L6tXHpxAzNECHAoj5t4dK4zPW","/ip4/172.18.254.107/tcp/38722/ws/p2p/16Uiu2HAmJBR4Sx2wgcV4Pqxu7K8L6tXHpxAzNECHAoj5t4dK4zPW"],"enrUri":"enr:-L24QFuEd_N-wDC1Y5HvKZEst5BhNjByZWdwRdrwIY7Id5idN2aoKD5fYTtQ9pCurrJ-uHAa789fFIuX3CsDY4n8a30CgmlkgnY0gmlwhKwS_muKbXVsdGlhZGRyc5YACASsEv5rBpdBAAoErBL-awaXQt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDUhXMVLgzOQ3Cd_jrlu-KTNbMej3fTOWs-gd8G6yKCHWDdGNwgpdBg3VkcIKXQ4V3YWt1MgM"}'
2025-02-12 04:09:58.466 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:09:58.476 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:09:58.476 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-12_04-09-57__4a579fba-8421-4a74-bf5a-f0f4d6b16cb6__wakuorg_nwaku:latest.log
2025-02-12 04:09:58.476 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:09:58.476 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:09:58.478 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:09:58.478 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.82.200
2025-02-12 04:09:58.478 DEBUG [src.node.docker_mananger] Generated ports ['48837', '48838', '48839', '48840', '48841']
2025-02-12 04:09:58.478 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:09:58.478 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:09:58.478 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:09:58.478 DEBUG [src.node.docker_mananger] docker run -i -t -p 48837:48837 -p 48838:48838 -p 48839:48839 -p 48840:48840 -p 48841:48841 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48839 --rest-port=48837 --tcp-port=48838 --discv5-udp-port=48840 --rest-address=0.0.0.0 --nat=extip:172.18.82.200 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7f0e2fcce5b18cbbe3ff067fceb18996fc4afafacacc32baa7db765341d0b2dc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48841 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QFuEd_N-wDC1Y5HvKZEst5BhNjByZWdwRdrwIY7Id5idN2aoKD5fYTtQ9pCurrJ-uHAa789fFIuX3CsDY4n8a30CgmlkgnY0gmlwhKwS_muKbXVsdGlhZGRyc5YACASsEv5rBpdBAAoErBL-awaXQt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDUhXMVLgzOQ3Cd_jrlu-KTNbMej3fTOWs-gd8G6yKCHWDdGNwgpdBg3VkcIKXQ4V3YWt1MgM --storenode=/ip4/172.18.254.107/tcp/38721/p2p/16Uiu2HAmJBR4Sx2wgcV4Pqxu7K8L6tXHpxAzNECHAoj5t4dK4zPW --store=true --relay=false
2025-02-12 04:09:58.726 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.82.200 waku 78c1460d1afe21ff8441c8d1091afbc6044ac01ad4df2ddd099186842db3ef04
2025-02-12 04:09:58.777 DEBUG [src.node.docker_mananger] Container started with ID 78c1460d1afe. Setting up logs at ./log/docker/store_node1_2025-02-12_04-09-57__4a579fba-8421-4a74-bf5a-f0f4d6b16cb6__wakuorg_nwaku:latest.log
2025-02-12 04:09:58.778 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48837
2025-02-12 04:09:58.778 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:09:59.778 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48837/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:09:59.781 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:09:59.782 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:09:59.782 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48837/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:09:59.784 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.82.200/tcp/48838/p2p/16Uiu2HAm5kovxghUv33ApJHZv2AkdGWbaoK4kXKwasto8fD77Ytz","/ip4/172.18.82.200/tcp/48839/ws/p2p/16Uiu2HAm5kovxghUv33ApJHZv2AkdGWbaoK4kXKwasto8fD77Ytz"],"enrUri":"enr:-L24QOhKsO0TYCH8fDEKi9Y4ldXlKqnM31kTYWVh0EGqxrXOEwhQK1DSuMnwJh90T6Ur9pdKnpcsYEAQm09SdCvx_B4CgmlkgnY0gmlwhKwSUsiKbXVsdGlhZGRyc5YACASsElLIBr7GAAoErBJSyAa-x90DgnJzhQADAQAAiXNlY3AyNTZrMaECmXvlIYtZpgYapl2aBYrTloBfh5MzBDPcA8kxiumodPODdGNwgr7Gg3VkcIK-yIV3YWt1MgI"}'
2025-02-12 04:09:59.784 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:09:59.784 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48837/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.254.107/tcp/38721/p2p/16Uiu2HAmJBR4Sx2wgcV4Pqxu7K8L6tXHpxAzNECHAoj5t4dK4zPW"]'
2025-02-12 04:09:59.822 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:09:59.823 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38720/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 04:09:59.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:09:59.846 DEBUG [src.steps.store] Relaying message
2025-02-12 04:09:59.848 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38720/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:09:59.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:09:59.855 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 04:10:00.056 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-12 04:10:00.056 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38720/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:10:00.060 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-12 04:10:00.061 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:10:00.063 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:10:00.063 DEBUG [src.node.waku_node] Stopping container with id 50602e0b9c8a
2025-02-12 04:10:01.032 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:10:01.032 DEBUG [src.node.waku_node] Stopping container with id 78c1460d1afe
2025-02-12 04:10:01.845 ERROR [src.node.docker_mananger] Max retries reached for container 50602e0b9c8a. Exiting log stream.
2025-02-12 04:10:02.073 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:10:02.076 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:10:02.082 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:10:02.088 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
