2025-02-12 04:04:26.315 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:04:26.316 DEBUG [tests.conftest] Running test: test_message_relayed_while_store_node_is_stopped_without_removing with id: 2025-02-12_04-04-26__81bb5945-26f2-4b84-a06e-915a97653a18
2025-02-12 04:04:26.316 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:04:26.316 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-12 04:04:26.323 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:04:26.323 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-12_04-04-26__81bb5945-26f2-4b84-a06e-915a97653a18__wakuorg_nwaku:latest.log
2025-02-12 04:04:26.323 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:04:26.323 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:04:26.325 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:04:26.325 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.208.49
2025-02-12 04:04:26.325 DEBUG [src.node.docker_mananger] Generated ports ['22376', '22377', '22378', '22379', '22380']
2025-02-12 04:04:26.325 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:04:26.325 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:04:26.325 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:04:26.325 DEBUG [src.node.docker_mananger] docker run -i -t -p 22376:22376 -p 22377:22377 -p 22378:22378 -p 22379:22379 -p 22380:22380 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22378 --rest-port=22376 --tcp-port=22377 --discv5-udp-port=22379 --rest-address=0.0.0.0 --nat=extip:172.18.208.49 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c43cfbf3b8ad95bdcc96e50e2bd7d46d6a7d3e7fb06a86ea01bcc7ebc04f2bfa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22380 --metrics-logging=true --store=true --relay=true
2025-02-12 04:04:26.555 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.208.49 waku 0951d286394633ac8df8baa9344bca7f300acb0e08b1ecdd199fbb087e245c33
2025-02-12 04:04:26.607 DEBUG [src.node.docker_mananger] Container started with ID 0951d2863946. Setting up logs at ./log/docker/publishing_node1_2025-02-12_04-04-26__81bb5945-26f2-4b84-a06e-915a97653a18__wakuorg_nwaku:latest.log
2025-02-12 04:04:26.607 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22376
2025-02-12 04:04:26.609 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:04:27.121 ERROR [src.node.docker_mananger] Max retries reached for container a0df014022ee. Exiting log stream.
2025-02-12 04:04:27.611 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22376/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:27.614 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:04:27.614 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:04:27.614 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22376/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:27.616 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.208.49/tcp/22377/p2p/16Uiu2HAmVEJfY7ZYvFgfXKpzxhTsuHZDmBE5TFa2UZf8bPVzE2A1","/ip4/172.18.208.49/tcp/22378/ws/p2p/16Uiu2HAmVEJfY7ZYvFgfXKpzxhTsuHZDmBE5TFa2UZf8bPVzE2A1"],"enrUri":"enr:-L24QM3ZQQcvPGnjkrwgNokYJONmId-YV-eLflNvaogySJDrTVKzCNXQeYuMtKVtWpGfD8OqdZUX61t9YtWboCdBPQkCgmlkgnY0gmlwhKwS0DGKbXVsdGlhZGRyc5YACASsEtAxBldpAAoErBLQMQZXat0DgnJzhQADAQAAiXNlY3AyNTZrMaED9kPdrLS-GnCitsOVzhBbjtZ-q10pVAJgde_UYqhugsaDdGNwgldpg3VkcIJXa4V3YWt1MgM"}'
2025-02-12 04:04:27.616 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:04:27.623 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:04:27.623 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-12_04-04-26__81bb5945-26f2-4b84-a06e-915a97653a18__wakuorg_nwaku:latest.log
2025-02-12 04:04:27.623 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:04:27.623 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:04:27.625 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:04:27.625 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.243.61
2025-02-12 04:04:27.625 DEBUG [src.node.docker_mananger] Generated ports ['58286', '58287', '58288', '58289', '58290']
2025-02-12 04:04:27.625 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:04:27.625 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:04:27.625 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:04:27.626 DEBUG [src.node.docker_mananger] docker run -i -t -p 58286:58286 -p 58287:58287 -p 58288:58288 -p 58289:58289 -p 58290:58290 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58288 --rest-port=58286 --tcp-port=58287 --discv5-udp-port=58289 --rest-address=0.0.0.0 --nat=extip:172.18.243.61 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=adbd8d5dfafae5e42812ddeec74d68ecdaf4ea6b4ae3e2dfcf3aebe4aacbd6d3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58290 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QM3ZQQcvPGnjkrwgNokYJONmId-YV-eLflNvaogySJDrTVKzCNXQeYuMtKVtWpGfD8OqdZUX61t9YtWboCdBPQkCgmlkgnY0gmlwhKwS0DGKbXVsdGlhZGRyc5YACASsEtAxBldpAAoErBLQMQZXat0DgnJzhQADAQAAiXNlY3AyNTZrMaED9kPdrLS-GnCitsOVzhBbjtZ-q10pVAJgde_UYqhugsaDdGNwgldpg3VkcIJXa4V3YWt1MgM --storenode=/ip4/172.18.208.49/tcp/22377/p2p/16Uiu2HAmVEJfY7ZYvFgfXKpzxhTsuHZDmBE5TFa2UZf8bPVzE2A1 --store=false --relay=false
2025-02-12 04:04:27.852 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.243.61 waku 9a0a28511615bb2cf8f39fb6902c2724a306b47b096cd3eacc7c91a18899a83c
2025-02-12 04:04:27.902 DEBUG [src.node.docker_mananger] Container started with ID 9a0a28511615. Setting up logs at ./log/docker/store_node1_2025-02-12_04-04-26__81bb5945-26f2-4b84-a06e-915a97653a18__wakuorg_nwaku:latest.log
2025-02-12 04:04:27.903 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58286
2025-02-12 04:04:27.903 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:04:28.904 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58286/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:28.907 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:04:28.907 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:04:28.907 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58286/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:28.909 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.243.61/tcp/58287/p2p/16Uiu2HAm9QpwCJWb9WaauRSzC2k338c4rd6n1SYHiL8BLuNqQSJJ","/ip4/172.18.243.61/tcp/58288/ws/p2p/16Uiu2HAm9QpwCJWb9WaauRSzC2k338c4rd6n1SYHiL8BLuNqQSJJ"],"enrUri":"enr:-L24QGMSao5cMIi2kFn4GsA9OUW4N5hliuHhLo54oMt_SMY6SpcZiFMp-u9XIlKt4vLO2jUg7FsT01jCud8jR8ykh1QCgmlkgnY0gmlwhKwS8z2KbXVsdGlhZGRyc5YACASsEvM9BuOvAAoErBLzPQbjsN0DgnJzhQADAQAAiXNlY3AyNTZrMaECz8wpbtmqsGsCWsk-zJg2JmVYIORaUrQ45aOCX7ig36eDdGNwguOvg3VkcILjsYV3YWt1MgA"}'
2025-02-12 04:04:28.909 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:04:28.910 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58286/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.208.49/tcp/22377/p2p/16Uiu2HAmVEJfY7ZYvFgfXKpzxhTsuHZDmBE5TFa2UZf8bPVzE2A1"]'
2025-02-12 04:04:28.947 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:28.949 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22376/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 04:04:28.966 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:28.967 DEBUG [src.steps.store] Relaying message
2025-02-12 04:04:28.968 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:04:28.974 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:28.974 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 04:04:29.175 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-12 04:04:29.176 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22376/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:29.179 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb53211549867c4ddd9c3de2e4f8b5c6cde52ea72c0a6ad8ef831b7e91667948f"}]}'
2025-02-12 04:04:29.179 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-12 04:04:29.179 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58286/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:29.187 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"4768a8a17e862df30870","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb53211549867c4ddd9c3de2e4f8b5c6cde52ea72c0a6ad8ef831b7e91667948f"}]}'
2025-02-12 04:04:30.382 DEBUG [src.steps.store] Relaying message
2025-02-12 04:04:30.382 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:04:30.387 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:04:30.388 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 04:04:30.853 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58286/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:30.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:04:30.863 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:04:30.863 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58286/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:30.866 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.243.61/tcp/58287/p2p/16Uiu2HAm9QpwCJWb9WaauRSzC2k338c4rd6n1SYHiL8BLuNqQSJJ","/ip4/172.18.243.61/tcp/58288/ws/p2p/16Uiu2HAm9QpwCJWb9WaauRSzC2k338c4rd6n1SYHiL8BLuNqQSJJ"],"enrUri":"enr:-L24QGMSao5cMIi2kFn4GsA9OUW4N5hliuHhLo54oMt_SMY6SpcZiFMp-u9XIlKt4vLO2jUg7FsT01jCud8jR8ykh1QCgmlkgnY0gmlwhKwS8z2KbXVsdGlhZGRyc5YACASsEvM9BuOvAAoErBLzPQbjsN0DgnJzhQADAQAAiXNlY3AyNTZrMaECz8wpbtmqsGsCWsk-zJg2JmVYIORaUrQ45aOCX7ig36eDdGNwguOvg3VkcILjsYV3YWt1MgA"}'
2025-02-12 04:04:30.866 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:04:30.866 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22376/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:30.870 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb53211549867c4ddd9c3de2e4f8b5c6cde52ea72c0a6ad8ef831b7e91667948f"},{"messageHash":"0x6d091a286cd963839b92b346ff8adfaf27e87573603242398c18407d65f0cba2"}]}'
2025-02-12 04:04:30.871 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58286/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:04:30.917 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"0c34fd146dfb9360b606","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb53211549867c4ddd9c3de2e4f8b5c6cde52ea72c0a6ad8ef831b7e91667948f"},{"messageHash":"0x6d091a286cd963839b92b346ff8adfaf27e87573603242398c18407d65f0cba2"}]}'
2025-02-12 04:04:30.924 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:04:30.925 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:04:30.925 DEBUG [src.node.waku_node] Stopping container with id 0951d2863946
2025-02-12 04:04:32.118 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:04:32.119 DEBUG [src.node.waku_node] Stopping container with id 9a0a28511615
2025-02-12 04:04:32.931 ERROR [src.node.docker_mananger] Max retries reached for container 0951d2863946. Exiting log stream.
2025-02-12 04:04:33.626 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:04:33.628 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:04:33.636 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:04:33.702 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
