2025-02-12 04:03:26.097 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 04:03:26.098 DEBUG [tests.conftest] Running test: test_publish_with_valid_meta with id: 2025-02-12_04-03-26__88292170-1964-4281-92b4-4448922e1e42
2025-02-12 04:03:26.098 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 04:03:26.098 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-12 04:03:26.099 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-12 04:03:26.104 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:03:26.105 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-12_04-03-26__88292170-1964-4281-92b4-4448922e1e42__wakuorg_nwaku:latest.log
2025-02-12 04:03:26.105 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:03:26.105 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:03:26.106 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:03:26.106 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.155.187
2025-02-12 04:03:26.106 DEBUG [src.node.docker_mananger] Generated ports ['39492', '39493', '39494', '39495', '39496']
2025-02-12 04:03:26.107 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:03:26.107 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:03:26.107 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:03:26.107 DEBUG [src.node.docker_mananger] docker run -i -t -p 39492:39492 -p 39493:39493 -p 39494:39494 -p 39495:39495 -p 39496:39496 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39494 --rest-port=39492 --tcp-port=39493 --discv5-udp-port=39495 --rest-address=0.0.0.0 --nat=extip:172.18.155.187 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c6bc5cc50bfcb8aeccaae1d06b7dede3ac54dbbbdcd1de984ba071e1df7009ef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39496 --metrics-logging=true --relay=true
2025-02-12 04:03:26.330 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.155.187 waku 9317e8d99afe9b67df96e076d9fa55e91a103d2d7e83d53783b7dd2820fc705b
2025-02-12 04:03:26.383 DEBUG [src.node.docker_mananger] Container started with ID 9317e8d99afe. Setting up logs at ./log/docker/node1_2025-02-12_04-03-26__88292170-1964-4281-92b4-4448922e1e42__wakuorg_nwaku:latest.log
2025-02-12 04:03:26.383 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39492
2025-02-12 04:03:26.384 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:03:26.899 ERROR [src.node.docker_mananger] Max retries reached for container 47b4fe04eeab. Exiting log stream.
2025-02-12 04:03:27.384 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39492/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:27.387 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:03:27.387 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:03:27.387 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39492/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:27.389 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.155.187/tcp/39493/p2p/16Uiu2HAmAEsqPyMvfEdCvfKfh3mfgTf9ZhCah4Jed6ZjRC74FSWY","/ip4/172.18.155.187/tcp/39494/ws/p2p/16Uiu2HAmAEsqPyMvfEdCvfKfh3mfgTf9ZhCah4Jed6ZjRC74FSWY"],"enrUri":"enr:-L24QMxnK-VtkIYXtBcTvLzPXx7ZTkGohPOOSUmhC1PRvPgdU1X76sfP_f-8YvsF35YGJl0JlQBT88Ia6aP84HKdeZQCgmlkgnY0gmlwhKwSm7uKbXVsdGlhZGRyc5YACASsEpu7BppFAAoErBKbuwaaRt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC3BtR2vQu5UKrXxkHFJHPwDTaY1zKcq_ZTSO1A54sFRWDdGNwgppFg3VkcIKaR4V3YWt1MgE"}'
2025-02-12 04:03:27.389 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:03:27.395 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 04:03:27.396 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-12_04-03-26__88292170-1964-4281-92b4-4448922e1e42__wakuorg_nwaku:latest.log
2025-02-12 04:03:27.396 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 04:03:27.396 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 04:03:27.397 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 04:03:27.397 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.24.129
2025-02-12 04:03:27.397 DEBUG [src.node.docker_mananger] Generated ports ['17155', '17156', '17157', '17158', '17159']
2025-02-12 04:03:27.398 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 04:03:27.398 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 04:03:27.398 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 04:03:27.398 DEBUG [src.node.docker_mananger] docker run -i -t -p 17155:17155 -p 17156:17156 -p 17157:17157 -p 17158:17158 -p 17159:17159 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17157 --rest-port=17155 --tcp-port=17156 --discv5-udp-port=17158 --rest-address=0.0.0.0 --nat=extip:172.18.24.129 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4af55d9bb2ede7643bf7fca3d7aee870ed3a1dfc3fd2eeedf83f6afd89fe5efe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17159 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMxnK-VtkIYXtBcTvLzPXx7ZTkGohPOOSUmhC1PRvPgdU1X76sfP_f-8YvsF35YGJl0JlQBT88Ia6aP84HKdeZQCgmlkgnY0gmlwhKwSm7uKbXVsdGlhZGRyc5YACASsEpu7BppFAAoErBKbuwaaRt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC3BtR2vQu5UKrXxkHFJHPwDTaY1zKcq_ZTSO1A54sFRWDdGNwgppFg3VkcIKaR4V3YWt1MgE
2025-02-12 04:03:27.622 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.24.129 waku 78df590b75c027716b0e4589fe1ef436b2d8ec326e852668bb52b4412640138b
2025-02-12 04:03:27.670 DEBUG [src.node.docker_mananger] Container started with ID 78df590b75c0. Setting up logs at ./log/docker/node2_2025-02-12_04-03-26__88292170-1964-4281-92b4-4448922e1e42__wakuorg_nwaku:latest.log
2025-02-12 04:03:27.671 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17155
2025-02-12 04:03:27.671 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 04:03:28.671 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17155/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:28.680 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 04:03:28.680 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 04:03:28.681 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17155/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:28.686 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.24.129/tcp/17156/p2p/16Uiu2HAkuxBfhfeanbffK5qMDBrDvWx7qhAw43cDVgNmpbrevAME","/ip4/172.18.24.129/tcp/17157/ws/p2p/16Uiu2HAkuxBfhfeanbffK5qMDBrDvWx7qhAw43cDVgNmpbrevAME"],"enrUri":"enr:-L24QJ3IM5X5b-QptCS4lmtovJyqWtETxIMlNZbR3DS8WT1lRBj0FJTHFTH5txdeyP-rQNrYq3UTDUg3Y5IeQfvawxUCgmlkgnY0gmlwhKwSGIGKbXVsdGlhZGRyc5YACASsEhiBBkMEAAoErBIYgQZDBd0DgnJzhQADAQAAiXNlY3AyNTZrMaECB9D-IMRtuI3c-cmjbZCTV3be3w4KiXj1qGekWj8GmBGDdGNwgkMEg3VkcIJDBoV3YWt1MgE"}'
2025-02-12 04:03:28.687 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 04:03:28.687 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17155/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.155.187/tcp/39493/p2p/16Uiu2HAmAEsqPyMvfEdCvfKfh3mfgTf9ZhCah4Jed6ZjRC74FSWY"]'
2025-02-12 04:03:28.691 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:28.691 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-12 04:03:28.692 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39492/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 04:03:28.695 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:28.696 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17155/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 04:03:28.702 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:28.702 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39492/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 04:03:28.709 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:28.709 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 04:03:28.810 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 04:03:28.810 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39492/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:28.812 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739333008702691072,"ephemeral":false}]'
2025-02-12 04:03:28.814 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-12 04:03:28.814 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17155/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:28.816 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739333008702691072,"ephemeral":false}]'
2025-02-12 04:03:28.817 INFO [src.steps.relay] WARM UP successful!!
2025-02-12 04:03:28.818 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39492/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "meta": "UmVsYXkgd29ya3MhIQ=="}'
2025-02-12 04:03:28.824 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 04:03:28.824 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 04:03:28.924 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 04:03:28.925 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39492/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:28.927 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739333008818652160,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false}]'
2025-02-12 04:03:28.929 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-12 04:03:28.929 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17155/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 04:03:28.932 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739333008818652160,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false}]'
2025-02-12 04:03:28.935 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 04:03:28.935 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 04:03:28.936 DEBUG [src.node.waku_node] Stopping container with id 9317e8d99afe
2025-02-12 04:03:29.875 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:03:29.876 DEBUG [src.node.waku_node] Stopping container with id 78df590b75c0
2025-02-12 04:03:30.686 ERROR [src.node.docker_mananger] Max retries reached for container 9317e8d99afe. Exiting log stream.
2025-02-12 04:03:31.398 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 04:03:31.399 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 04:03:31.405 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 04:03:31.410 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
