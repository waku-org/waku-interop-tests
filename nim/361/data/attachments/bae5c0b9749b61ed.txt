[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_missing_payload with id: 2024-09-15_04-24-02__b7d4a97c-e548-4602-9f4b-f068111a1384
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-15_04-24-02__b7d4a97c-e548-4602-9f4b-f068111a1384__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.88.5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['3145', '3146', '3147', '3148', '3149']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 3145:3145 -p 3146:3146 -p 3147:3147 -p 3148:3148 -p 3149:3149 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3147 --rest-port=3145 --tcp-port=3146 --discv5-udp-port=3148 --rest-address=0.0.0.0 --nat=extip:172.18.88.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a1b04d04b0acbb4c96f9ad121b9aae00acd4fea9d58f2a2fde4ffc1ffacbc3ae --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3149 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.88.5 waku fc5746642d60c1717eb4c443c3cd83bd3bf4d19f711283bcae9c273306b91f1d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID fc5746642d60. Setting up logs at ./log/docker/node1_2024-09-15_04-24-02__b7d4a97c-e548-4602-9f4b-f068111a1384__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3145
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3145/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3145/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.88.5/tcp/3146/p2p/16Uiu2HAmHxauDkAtkd7c6Yj2fQLX4x7cV4fDqiDDPmn1eeidaMSR","/ip4/172.18.88.5/tcp/3147/ws/p2p/16Uiu2HAmHxauDkAtkd7c6Yj2fQLX4x7cV4fDqiDDPmn1eeidaMSR"],"enrUri":"enr:-LO4QFVHFxn1SwPDfBkrS72rRvbZs_UUCvWXYo3fL3AI2B8BPfmy5OfeQpsKxmezQNMFw8mfzijfwgnj3paHL1qhN6wBgmlkgnY0gmlwhKwSWAWKbXVsdGlhZGRyc4wACgSsElgFBgxL3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNOzF_yd1YBfh41nTskJuIfWN9XprhfXrFLQEgNl6b2WoN0Y3CCDEqDdWRwggxMhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-15_04-24-02__b7d4a97c-e548-4602-9f4b-f068111a1384__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.19.150
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['57094', '57095', '57096', '57097', '57098']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 57094:57094 -p 57095:57095 -p 57096:57096 -p 57097:57097 -p 57098:57098 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57096 --rest-port=57094 --tcp-port=57095 --discv5-udp-port=57097 --rest-address=0.0.0.0 --nat=extip:172.18.19.150 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dd8477b8c368e5b8aa825b56917fd44abe4c8ed9ee4803258bcdb35bd4c5ba80 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57098 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QFVHFxn1SwPDfBkrS72rRvbZs_UUCvWXYo3fL3AI2B8BPfmy5OfeQpsKxmezQNMFw8mfzijfwgnj3paHL1qhN6wBgmlkgnY0gmlwhKwSWAWKbXVsdGlhZGRyc4wACgSsElgFBgxL3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNOzF_yd1YBfh41nTskJuIfWN9XprhfXrFLQEgNl6b2WoN0Y3CCDEqDdWRwggxMhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.19.150 waku 3557256347d105411bf7b484e024eeb66e68e75bab072de2f055d098ed239913
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 3557256347d1. Setting up logs at ./log/docker/node2_2024-09-15_04-24-02__b7d4a97c-e548-4602-9f4b-f068111a1384__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 57094
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57094/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57094/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.150/tcp/57095/p2p/16Uiu2HAmJFcgZoF2Rj8fN9axmDk6zyKPUBnxdykzzwdUPZTYv36p","/ip4/172.18.19.150/tcp/57096/ws/p2p/16Uiu2HAmJFcgZoF2Rj8fN9axmDk6zyKPUBnxdykzzwdUPZTYv36p"],"enrUri":"enr:-LO4QIR3MM0QbTABTM_VVij-auk7xDx1BhnU4cNBiJeL4QabECH879U8QOQZ_9aS4kr0tIN_ZRA-F6xjNt_fsHxhHFkBgmlkgnY0gmlwhKwSE5aKbXVsdGlhZGRyc4wACgSsEhOWBt8I3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNTKUNlHG--qUMo_GPD-il30nOcO-DOVJ8AUrXfS1PPEYN0Y3CC3weDdWRwgt8JhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57094/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.88.5/tcp/3146/p2p/16Uiu2HAmHxauDkAtkd7c6Yj2fQLX4x7cV4fDqiDDPmn1eeidaMSR"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3145/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57094/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3145/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3145/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1726374246996461568,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57094/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1726374246996461568,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3145/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:3145/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id fc5746642d60
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3557256347d1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.