[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-09-15_04-21-04__97d76d4f-81a7-48f6-b358-78118dfc110f
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-15_04-21-04__97d76d4f-81a7-48f6-b358-78118dfc110f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.230.46
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['33701', '33702', '33703', '33704', '33705']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 33701:33701 -p 33702:33702 -p 33703:33703 -p 33704:33704 -p 33705:33705 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33703 --rest-port=33701 --tcp-port=33702 --discv5-udp-port=33704 --rest-address=0.0.0.0 --nat=extip:172.18.230.46 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5ccffa9364c04fb9f11da2bdece1f1fbbece8f99f3caf4b9bec016ce3ea7ee22 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33705 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.230.46 waku 730ef96f6a44bfae4c732f6f35f28a5fb2845dea3731f5f52f2f704b854b42e8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 730ef96f6a44. Setting up logs at ./log/docker/receiving_node1_2024-09-15_04-21-04__97d76d4f-81a7-48f6-b358-78118dfc110f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 33701
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33701/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33701/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.230.46/tcp/33702/p2p/16Uiu2HAmEVVhS93wQkn3gDkNUqrNnSteKiMuccu3grcWj5GMV5ZZ","/ip4/172.18.230.46/tcp/33703/ws/p2p/16Uiu2HAmEVVhS93wQkn3gDkNUqrNnSteKiMuccu3grcWj5GMV5ZZ"],"enrUri":"enr:-LO4QNVGDNeqCEa4oT73GYAl27CxsTPuQTyyosqS-3_D0Vo9A1HJUBeeMWXfHQfkb6dPsrvMDxlU5Zqo5FcUfzHIoW8BgmlkgnY0gmlwhKwS5i6KbXVsdGlhZGRyc4wACgSsEuYuBoOn3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMbSL-2hCGjH5OvApVOFuLKplQd5ObZa7iH6KtaZZUa8IN0Y3CCg6aDdWRwgoOohXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-15_04-21-04__97d76d4f-81a7-48f6-b358-78118dfc110f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.206.106
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['41185', '41186', '41187', '41188', '41189']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 41185:41185 -p 41186:41186 -p 41187:41187 -p 41188:41188 -p 41189:41189 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=41187 --rest-port=41185 --tcp-port=41186 --discv5-udp-port=41188 --rest-address=0.0.0.0 --nat=extip:172.18.206.106 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e6c050becafc9699d1dc8b5a21bbd6dbdaf3c7e13cfcf2ae9e7467b1ac29b0cb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=41189 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.206.106 waku 4c0b0d643b41634014be778d983c52524f6151537bd7f5e7586ee68ba8287035
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 4c0b0d643b41. Setting up logs at ./log/docker/receiving_node2_2024-09-15_04-21-04__97d76d4f-81a7-48f6-b358-78118dfc110f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 41185
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41185/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41185/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.206.106/tcp/41186/p2p/16Uiu2HAmLCc5jqyYwL7GRN6koDrjhB5FvJT6Zj2VA5s9vFWoZohb","/ip4/172.18.206.106/tcp/41187/ws/p2p/16Uiu2HAmLCc5jqyYwL7GRN6koDrjhB5FvJT6Zj2VA5s9vFWoZohb"],"enrUri":"enr:-LO4QLIbEfU1GKTgsmR2uqiiMTIpxAb-qt9t4lpNc84dqXgvOZefN_lgAMnIHu45UzsuiqG8M1pFSiaEyp7IDI1G5gMBgmlkgnY0gmlwhKwSzmqKbXVsdGlhZGRyc4wACgSsEs5qBqDj3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNwGzc67g0VSgZP_ig1LamzZdoqGBMKajxChtbX3jHuqoN0Y3CCoOKDdWRwgqDkhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41185/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.230.46/tcp/33702/p2p/16Uiu2HAmEVVhS93wQkn3gDkNUqrNnSteKiMuccu3grcWj5GMV5ZZ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-15_04-21-04__97d76d4f-81a7-48f6-b358-78118dfc110f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.90.196
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['18647', '18648', '18649', '18650', '18651']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 18647:18647 -p 18648:18648 -p 18649:18649 -p 18650:18650 -p 18651:18651 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18649 --rest-port=18647 --tcp-port=18648 --discv5-udp-port=18650 --rest-address=0.0.0.0 --nat=extip:172.18.90.196 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dfdebdfc9cab3cb446e9c5c7b1caff2578a37f1439aa063ed1e4d5a4c7cade1b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18651 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QNVGDNeqCEa4oT73GYAl27CxsTPuQTyyosqS-3_D0Vo9A1HJUBeeMWXfHQfkb6dPsrvMDxlU5Zqo5FcUfzHIoW8BgmlkgnY0gmlwhKwS5i6KbXVsdGlhZGRyc4wACgSsEuYuBoOn3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMbSL-2hCGjH5OvApVOFuLKplQd5ObZa7iH6KtaZZUa8IN0Y3CCg6aDdWRwgoOohXdha3UyCQ --lightpushnode=/ip4/172.18.230.46/tcp/33702/p2p/16Uiu2HAmEVVhS93wQkn3gDkNUqrNnSteKiMuccu3grcWj5GMV5ZZ --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.90.196 waku b27c1d168b6832a21f78abb54f839dbc637e852fbe9666b86ffced7a8ba5d386
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID b27c1d168b68. Setting up logs at ./log/docker/lightpush_node1_2024-09-15_04-21-04__97d76d4f-81a7-48f6-b358-78118dfc110f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 18647
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18647/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18647/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.90.196/tcp/18648/p2p/16Uiu2HAm8nk9iZNaZDXW2ZD61SVZFBDz7ehuxe97GJAGVHYc7Au2","/ip4/172.18.90.196/tcp/18649/ws/p2p/16Uiu2HAm8nk9iZNaZDXW2ZD61SVZFBDz7ehuxe97GJAGVHYc7Au2"],"enrUri":"enr:-LO4QEZ2RXy_fUN7n8FbAzi4qQKoMGRY611W6WcbXiLbULo3frCWdPKODmr8mv05MeDOKKPy2lUl3K1Aac-0ws5ggGgBgmlkgnY0gmlwhKwSWsSKbXVsdGlhZGRyc4wACgSsElrEBkjZ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLGjdfjQGOD2ILPKTKuMYYC8ul69IWFPJYIvzKrJW-ljYN0Y3CCSNiDdWRwgkjahXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18647/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.230.46/tcp/33702/p2p/16Uiu2HAmEVVhS93wQkn3gDkNUqrNnSteKiMuccu3grcWj5GMV5ZZ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18647/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.206.106/tcp/41186/p2p/16Uiu2HAmLCc5jqyYwL7GRN6koDrjhB5FvJT6Zj2VA5s9vFWoZohb"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33701/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41185/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18647/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726374070335241472}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33701/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726374070335241472,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41185/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726374070335241472,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18647/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726374070335241472}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:18647/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 730ef96f6a44
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 4c0b0d643b41
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b27c1d168b68
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.