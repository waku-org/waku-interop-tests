[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_subscribe_refresh with id: 2024-09-15_04-16-25__63d97a0d-e5ad-4288-8b2a-1671d6553f7f
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-15_04-16-25__63d97a0d-e5ad-4288-8b2a-1671d6553f7f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.65.232
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['18248', '18249', '18250', '18251', '18252']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 18248:18248 -p 18249:18249 -p 18250:18250 -p 18251:18251 -p 18252:18252 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18250 --rest-port=18248 --tcp-port=18249 --discv5-udp-port=18251 --rest-address=0.0.0.0 --nat=extip:172.18.65.232 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=daacb18d0a2e3e0ccfddfeb46649a35ecdfdf5b7ff46cf56cfb7ddcf9501e181 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18252 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.65.232 waku 9168b692d4b532ff214b3fc1bbeb52f44402c6a76229a052869b11dd7370a05f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9168b692d4b5. Setting up logs at ./log/docker/node1_2024-09-15_04-16-25__63d97a0d-e5ad-4288-8b2a-1671d6553f7f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 18248
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18248/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18248/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.65.232/tcp/18249/p2p/16Uiu2HAmBhtn3qe9fbFD2s4xv9ua6tqYwgAzLNr2jYeb7YnGYHhD","/ip4/172.18.65.232/tcp/18250/ws/p2p/16Uiu2HAmBhtn3qe9fbFD2s4xv9ua6tqYwgAzLNr2jYeb7YnGYHhD"],"enrUri":"enr:-LO4QH3eoEpwbqGRoPfFmoSG82aLhGDffqvcJvWYNTlcyJlxCKLHuDTOQ2UNvXlJxIGcAVXgDjrpVm-FviaSAAtVXroBgmlkgnY0gmlwhKwSQeiKbXVsdGlhZGRyc4wACgSsEkHoBkdK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLx4sEENJHj3uUwV5i6ADbLSsV6eIgclb4sRpPAcEc4BIN0Y3CCR0mDdWRwgkdLhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-15_04-16-25__63d97a0d-e5ad-4288-8b2a-1671d6553f7f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.158.23
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['48497', '48498', '48499', '48500', '48501']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 48497:48497 -p 48498:48498 -p 48499:48499 -p 48500:48500 -p 48501:48501 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48499 --rest-port=48497 --tcp-port=48498 --discv5-udp-port=48500 --rest-address=0.0.0.0 --nat=extip:172.18.158.23 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f209b686e2d3be35fdcccaef7265bc3dd6abfb7a879cbffe5eaf8d6000dbcea5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48501 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QH3eoEpwbqGRoPfFmoSG82aLhGDffqvcJvWYNTlcyJlxCKLHuDTOQ2UNvXlJxIGcAVXgDjrpVm-FviaSAAtVXroBgmlkgnY0gmlwhKwSQeiKbXVsdGlhZGRyc4wACgSsEkHoBkdK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLx4sEENJHj3uUwV5i6ADbLSsV6eIgclb4sRpPAcEc4BIN0Y3CCR0mDdWRwgkdLhXdha3UyBQ --filternode=/ip4/172.18.65.232/tcp/18249/p2p/16Uiu2HAmBhtn3qe9fbFD2s4xv9ua6tqYwgAzLNr2jYeb7YnGYHhD
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.158.23 waku 1a3f843a0121d416d3c65449c170cff197cc56274aecd4809f059611fb398d7e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 1a3f843a0121. Setting up logs at ./log/docker/node2_2024-09-15_04-16-25__63d97a0d-e5ad-4288-8b2a-1671d6553f7f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 48497
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48497/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48497/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.23/tcp/48498/p2p/16Uiu2HAmUcDFdQRggiziJzgsbhUp7XfKhN4Eqwo2wXKXb9dBUaVZ","/ip4/172.18.158.23/tcp/48499/ws/p2p/16Uiu2HAmUcDFdQRggiziJzgsbhUp7XfKhN4Eqwo2wXKXb9dBUaVZ"],"enrUri":"enr:-LO4QJJkMJBev2xewPfsqh7D2pSvWT3Alw3UqDv-2UYfcdTsMlMv6r_PawmlVI4EyX9_IiyY7cWFrGulacwIsTDsd7UBgmlkgnY0gmlwhKwSnheKbXVsdGlhZGRyc4wACgSsEp4XBr1z3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPtBNZQ9JWygWWXaEruVgRqGWcEgrsGSjXHRB-3YNWodIN0Y3CCvXKDdWRwgr10hXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48497/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.65.232/tcp/18249/p2p/16Uiu2HAmBhtn3qe9fbFD2s4xv9ua6tqYwgAzLNr2jYeb7YnGYHhD"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18248/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48497/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "b0c31acd-8aa7-4b4c-ad04-8245f08f3204", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"b0c31acd-8aa7-4b4c-ad04-8245f08f3204","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18248/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48497/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1726373789915243776,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18248/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48497/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "b3d68ebd-3efe-4951-806a-ed2282619aec", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"b3d68ebd-3efe-4951-806a-ed2282619aec","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18248/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48497/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1726373790041035776,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9168b692d4b5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1a3f843a0121
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.