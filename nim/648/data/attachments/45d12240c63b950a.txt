2025-02-11 15:05:12.811 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:05:12.812 DEBUG [tests.conftest] Running test: test_store_with_peerAddr with id: 2025-02-11_15-05-12__54af2dbb-f223-4bbe-9764-13cff1b5ad32
2025-02-11 15:05:12.812 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:05:12.812 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 15:05:12.812 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-11 15:05:12.819 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:05:12.819 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-11_15-05-12__54af2dbb-f223-4bbe-9764-13cff1b5ad32__wakuorg_nwaku:latest.log
2025-02-11 15:05:12.819 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:05:12.819 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:05:12.820 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:05:12.821 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.250.47
2025-02-11 15:05:12.821 DEBUG [src.node.docker_mananger] Generated ports ['44692', '44693', '44694', '44695', '44696']
2025-02-11 15:05:12.821 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:05:12.821 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:05:12.821 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:05:12.821 DEBUG [src.node.docker_mananger] docker run -i -t -p 44692:44692 -p 44693:44693 -p 44694:44694 -p 44695:44695 -p 44696:44696 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44694 --rest-port=44692 --tcp-port=44693 --discv5-udp-port=44695 --rest-address=0.0.0.0 --nat=extip:172.18.250.47 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=09a834cbba26b4cf9cb5ada79b3ec17a1b2dd5cc6220ec814e0d36045de8b706 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44696 --metrics-logging=true --store=true --relay=true
2025-02-11 15:05:13.045 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.250.47 waku 12d821d1c0e0fc781c2888a5b0e1b2d988f9ce1938402f368811c6e120be525f
2025-02-11 15:05:13.096 DEBUG [src.node.docker_mananger] Container started with ID 12d821d1c0e0. Setting up logs at ./log/docker/publishing_node1_2025-02-11_15-05-12__54af2dbb-f223-4bbe-9764-13cff1b5ad32__wakuorg_nwaku:latest.log
2025-02-11 15:05:13.097 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44692
2025-02-11 15:05:13.097 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:05:13.618 ERROR [src.node.docker_mananger] Max retries reached for container e9a0e43c6222. Exiting log stream.
2025-02-11 15:05:14.098 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44692/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:14.101 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:05:14.101 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:05:14.101 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44692/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:14.104 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.250.47/tcp/44693/p2p/16Uiu2HAmTo9MNCVvRaPUNQhXgDYjLW94DU3TWgU3gQjEuKMFcBLK","/ip4/172.18.250.47/tcp/44694/ws/p2p/16Uiu2HAmTo9MNCVvRaPUNQhXgDYjLW94DU3TWgU3gQjEuKMFcBLK"],"enrUri":"enr:-L24QJ9JhqPmZtO167faCbxjOSirY6hEV9627NA4NN32Pwz0HMn0Wf1B6IIcT5U_ku1Q0uQfsdKZZxD4thGWzkyM-LsCgmlkgnY0gmlwhKwS-i-KbXVsdGlhZGRyc5YACASsEvovBq6VAAoErBL6Lwault0DgnJzhQADAQAAiXNlY3AyNTZrMaED4PYg0RPpUpazalv7jTwzaXV1ToHf-sSVyE05G80U-iCDdGNwgq6Vg3VkcIKul4V3YWt1MgM"}'
2025-02-11 15:05:14.104 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:05:14.110 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:05:14.111 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-11_15-05-12__54af2dbb-f223-4bbe-9764-13cff1b5ad32__wakuorg_nwaku:latest.log
2025-02-11 15:05:14.111 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:05:14.111 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:05:14.112 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:05:14.112 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.116.101
2025-02-11 15:05:14.112 DEBUG [src.node.docker_mananger] Generated ports ['42226', '42227', '42228', '42229', '42230']
2025-02-11 15:05:14.112 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:05:14.113 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:05:14.113 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:05:14.113 DEBUG [src.node.docker_mananger] docker run -i -t -p 42226:42226 -p 42227:42227 -p 42228:42228 -p 42229:42229 -p 42230:42230 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42228 --rest-port=42226 --tcp-port=42227 --discv5-udp-port=42229 --rest-address=0.0.0.0 --nat=extip:172.18.116.101 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6eaf0ab461aadac8468fe4fb4c32bf47aa8c50a51c1ea1a9f15badf40eecd3aa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42230 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QJ9JhqPmZtO167faCbxjOSirY6hEV9627NA4NN32Pwz0HMn0Wf1B6IIcT5U_ku1Q0uQfsdKZZxD4thGWzkyM-LsCgmlkgnY0gmlwhKwS-i-KbXVsdGlhZGRyc5YACASsEvovBq6VAAoErBL6Lwault0DgnJzhQADAQAAiXNlY3AyNTZrMaED4PYg0RPpUpazalv7jTwzaXV1ToHf-sSVyE05G80U-iCDdGNwgq6Vg3VkcIKul4V3YWt1MgM --storenode=/ip4/172.18.250.47/tcp/44693/p2p/16Uiu2HAmTo9MNCVvRaPUNQhXgDYjLW94DU3TWgU3gQjEuKMFcBLK --store=true --relay=true
2025-02-11 15:05:14.347 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.116.101 waku 7fd91ac211579af9cb3efba1a8253dc96fc4a2574a1817cf26593495f3359bf3
2025-02-11 15:05:14.396 DEBUG [src.node.docker_mananger] Container started with ID 7fd91ac21157. Setting up logs at ./log/docker/store_node1_2025-02-11_15-05-12__54af2dbb-f223-4bbe-9764-13cff1b5ad32__wakuorg_nwaku:latest.log
2025-02-11 15:05:14.397 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42226
2025-02-11 15:05:14.397 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:05:15.398 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42226/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:15.401 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:05:15.401 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:05:15.401 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42226/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:15.403 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.116.101/tcp/42227/p2p/16Uiu2HAm6Ni3xhu6ZjwZr375zKYHNcsfVfNz2SoYreFersZQvG2U","/ip4/172.18.116.101/tcp/42228/ws/p2p/16Uiu2HAm6Ni3xhu6ZjwZr375zKYHNcsfVfNz2SoYreFersZQvG2U"],"enrUri":"enr:-L24QHttak74iz9OxDNL6CSi-nMBvLYNeYTBc4hPErG5JpZZF2qa1GD_m4IFXubxoCeT4Rn96K99B-hAhfRE4lpfjzICgmlkgnY0gmlwhKwSdGWKbXVsdGlhZGRyc5YACASsEnRlBqTzAAoErBJ0ZQak9N0DgnJzhQADAQAAiXNlY3AyNTZrMaECoq4oCxlEq-QL544ERvjJQ4WI-PpK9c2Lfdv_fZ51qCmDdGNwgqTzg3VkcIKk9YV3YWt1MgM"}'
2025-02-11 15:05:15.404 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:05:15.404 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42226/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.250.47/tcp/44693/p2p/16Uiu2HAmTo9MNCVvRaPUNQhXgDYjLW94DU3TWgU3gQjEuKMFcBLK"]'
2025-02-11 15:05:15.407 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:15.407 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44692/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:05:15.409 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:15.410 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42226/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:05:15.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:15.413 DEBUG [src.steps.store] Relaying message
2025-02-11 15:05:15.413 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44692/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:05:15.419 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:15.419 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:05:15.621 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:05:15.621 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42226/store/v3/messages?peerAddr=%2Fip4%2F172.18.250.47%2Ftcp%2F44693%2Fp2p%2F16Uiu2HAmTo9MNCVvRaPUNQhXgDYjLW94DU3TWgU3gQjEuKMFcBLK&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:15.629 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"721db5c807946d0199fb","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xfbaf4e7c84131056175f5aca1ea38b0f90eee7ddecc6190a198a335e6062d7c5"}]}'
2025-02-11 15:05:15.631 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:05:15.632 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:05:15.632 DEBUG [src.node.waku_node] Stopping container with id 12d821d1c0e0
2025-02-11 15:05:16.620 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:05:16.621 DEBUG [src.node.waku_node] Stopping container with id 7fd91ac21157
2025-02-11 15:05:17.432 ERROR [src.node.docker_mananger] Max retries reached for container 12d821d1c0e0. Exiting log stream.
2025-02-11 15:05:18.146 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:05:18.148 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:05:18.153 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:05:18.158 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
