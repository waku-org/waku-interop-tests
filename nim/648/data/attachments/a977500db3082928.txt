2025-02-11 15:02:47.982 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:02:47.983 DEBUG [tests.conftest] Running test: test_filter_resubscribe_to_unsubscribed_topics with id: 2025-02-11_15-02-47__26c152d0-7744-4e77-8bab-b27134e2bb48
2025-02-11 15:02:47.983 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:02:47.983 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 15:02:47.983 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-11 15:02:47.990 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:02:47.990 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-02-47__26c152d0-7744-4e77-8bab-b27134e2bb48__wakuorg_nwaku:latest.log
2025-02-11 15:02:47.990 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:02:47.990 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:02:47.992 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:02:47.992 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.234.138
2025-02-11 15:02:47.992 DEBUG [src.node.docker_mananger] Generated ports ['26632', '26633', '26634', '26635', '26636']
2025-02-11 15:02:47.992 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:02:47.992 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:02:47.992 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:02:47.992 DEBUG [src.node.docker_mananger] docker run -i -t -p 26632:26632 -p 26633:26633 -p 26634:26634 -p 26635:26635 -p 26636:26636 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26634 --rest-port=26632 --tcp-port=26633 --discv5-udp-port=26635 --rest-address=0.0.0.0 --nat=extip:172.18.234.138 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6f31771a47a2fd4eb7ba34d7858e67cc892fced2b3bb0d388a0a7925ce1bd9cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26636 --metrics-logging=true --relay=true --filter=true
2025-02-11 15:02:48.226 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.234.138 waku 020058739f177eb39c2c7b6b47f3bc71291b9a713e74824ee5e5a39ea8f7369f
2025-02-11 15:02:48.276 DEBUG [src.node.docker_mananger] Container started with ID 020058739f17. Setting up logs at ./log/docker/node1_2025-02-11_15-02-47__26c152d0-7744-4e77-8bab-b27134e2bb48__wakuorg_nwaku:latest.log
2025-02-11 15:02:48.277 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 26632
2025-02-11 15:02:48.277 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:02:48.786 ERROR [src.node.docker_mananger] Max retries reached for container 0d0623c78265. Exiting log stream.
2025-02-11 15:02:49.278 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26632/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:02:49.281 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:02:49.281 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:02:49.281 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26632/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:02:49.284 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.234.138/tcp/26633/p2p/16Uiu2HAm4aKgF4m7RVFfsHKNJf6VkdRX5rit7n4KAz4rJyqoaTso","/ip4/172.18.234.138/tcp/26634/ws/p2p/16Uiu2HAm4aKgF4m7RVFfsHKNJf6VkdRX5rit7n4KAz4rJyqoaTso"],"enrUri":"enr:-L24QKD4bARKkHffr5XDOx8l6xhCTu67eXF4elyYR_GTgJrkAqaLSwwfoMtRhgme9q544GBGvfNIvNe_1rP9KK0NOEcCgmlkgnY0gmlwhKwS6oqKbXVsdGlhZGRyc5YACASsEuqKBmgJAAoErBLqigZoCt0DgnJzhQADAQAAiXNlY3AyNTZrMaECh_B0EoMTaZQFZpBGd3dq0r9J2QjI1YGeI9A2Hjzj4rKDdGNwgmgJg3VkcIJoC4V3YWt1MgU"}'
2025-02-11 15:02:49.284 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:02:49.284 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-11 15:02:49.290 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:02:49.290 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-02-47__26c152d0-7744-4e77-8bab-b27134e2bb48__wakuorg_nwaku:latest.log
2025-02-11 15:02:49.291 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:02:49.291 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:02:49.292 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:02:49.292 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.154.216
2025-02-11 15:02:49.293 DEBUG [src.node.docker_mananger] Generated ports ['16973', '16974', '16975', '16976', '16977']
2025-02-11 15:02:49.293 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:02:49.293 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:02:49.293 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:02:49.293 DEBUG [src.node.docker_mananger] docker run -i -t -p 16973:16973 -p 16974:16974 -p 16975:16975 -p 16976:16976 -p 16977:16977 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16975 --rest-port=16973 --tcp-port=16974 --discv5-udp-port=16976 --rest-address=0.0.0.0 --nat=extip:172.18.154.216 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ffc7cdce7a1b7cb7adea3fc590f4f40acb5c519795f42d2f3dcb7bb81dfd1a3a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16977 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QKD4bARKkHffr5XDOx8l6xhCTu67eXF4elyYR_GTgJrkAqaLSwwfoMtRhgme9q544GBGvfNIvNe_1rP9KK0NOEcCgmlkgnY0gmlwhKwS6oqKbXVsdGlhZGRyc5YACASsEuqKBmgJAAoErBLqigZoCt0DgnJzhQADAQAAiXNlY3AyNTZrMaECh_B0EoMTaZQFZpBGd3dq0r9J2QjI1YGeI9A2Hjzj4rKDdGNwgmgJg3VkcIJoC4V3YWt1MgU --filternode=/ip4/172.18.234.138/tcp/26633/p2p/16Uiu2HAm4aKgF4m7RVFfsHKNJf6VkdRX5rit7n4KAz4rJyqoaTso
2025-02-11 15:02:49.531 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.154.216 waku 9d5139f3a8a90943b0ab99a7070aaf1376f79b45547011efd21e8b0ff4a9f261
2025-02-11 15:02:49.586 DEBUG [src.node.docker_mananger] Container started with ID 9d5139f3a8a9. Setting up logs at ./log/docker/node2_2025-02-11_15-02-47__26c152d0-7744-4e77-8bab-b27134e2bb48__wakuorg_nwaku:latest.log
2025-02-11 15:02:49.586 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16973
2025-02-11 15:02:49.587 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:02:50.587 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16973/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:02:50.590 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:02:50.591 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:02:50.591 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16973/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:02:50.593 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.154.216/tcp/16974/p2p/16Uiu2HAmGZ9Pbfrzs2w6rMfhMmKk9WUnhmF5zY9KifcCrrorhmxh","/ip4/172.18.154.216/tcp/16975/ws/p2p/16Uiu2HAmGZ9Pbfrzs2w6rMfhMmKk9WUnhmF5zY9KifcCrrorhmxh"],"enrUri":"enr:-L24QOWdZWWbRgdF3Y7CqM5x8K-PT-SH20El1LNaA8aFwP5IGlehXreyuw3T9jdmSK4NQULXDq6r6liM57bgxBH6Mq0CgmlkgnY0gmlwhKwSmtiKbXVsdGlhZGRyc5YACASsEprYBkJOAAoErBKa2AZCT90DgnJzhQADAQAAiXNlY3AyNTZrMaEDOe978_UdZyyd4QgFTj6h_30vUcjO2xz99i3zUXMB1Z6DdGNwgkJOg3VkcIJCUIV3YWt1MgA"}'
2025-02-11 15:02:50.593 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:02:50.594 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16973/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.234.138/tcp/26633/p2p/16Uiu2HAm4aKgF4m7RVFfsHKNJf6VkdRX5rit7n4KAz4rJyqoaTso"]'
2025-02-11 15:02:50.631 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:02:50.632 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-11 15:02:50.633 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26632/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:02:50.656 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:02:50.656 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16973/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "acb55447-3023-41f5-beff-e1e2f0735873", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 15:02:50.669 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"acb55447-3023-41f5-beff-e1e2f0735873","statusDesc":"OK"}'
2025-02-11 15:02:50.670 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26632/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:02:50.678 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:02:50.678 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:02:50.778 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:02:50.779 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16973/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:02:50.782 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739286170670532864,"ephemeral":false}]'
2025-02-11 15:02:50.783 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:16973/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 15:02:50.793 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-11 15:02:50.793 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26632/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:02:50.797 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:02:50.797 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:02:50.897 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:02:50.898 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16973/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:02:50.901 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:16973/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
2025-02-11 15:02:50.903 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26632/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:02:50.905 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:02:50.906 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16973/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "be0c1bc9-3cf6-4d27-bf6a-366c609c1db5", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 15:02:50.914 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"be0c1bc9-3cf6-4d27-bf6a-366c609c1db5","statusDesc":"OK"}'
2025-02-11 15:02:50.915 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26632/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:02:50.919 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:02:50.919 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:02:51.019 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:02:51.020 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16973/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:02:51.023 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739286170915288576,"ephemeral":false}]'
2025-02-11 15:02:51.027 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:02:51.028 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:02:51.028 DEBUG [src.node.waku_node] Stopping container with id 020058739f17
2025-02-11 15:02:51.894 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:02:51.894 DEBUG [src.node.waku_node] Stopping container with id 9d5139f3a8a9
2025-02-11 15:02:52.707 ERROR [src.node.docker_mananger] Max retries reached for container 020058739f17. Exiting log stream.
2025-02-11 15:02:53.403 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:02:53.404 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:02:53.410 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:02:53.416 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
