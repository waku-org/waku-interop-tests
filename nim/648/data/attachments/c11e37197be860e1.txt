2025-02-11 15:03:36.664 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:03:36.664 DEBUG [tests.conftest] Running test: test_filter_get_message_with_valid_timestamps with id: 2025-02-11_15-03-36__b5b49fbb-9638-44eb-aed2-58b8a220a78d
2025-02-11 15:03:36.665 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:03:36.665 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 15:03:36.665 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-11 15:03:36.672 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:36.672 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-03-36__b5b49fbb-9638-44eb-aed2-58b8a220a78d__wakuorg_nwaku:latest.log
2025-02-11 15:03:36.672 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:36.673 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:36.674 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:36.674 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.142.175
2025-02-11 15:03:36.674 DEBUG [src.node.docker_mananger] Generated ports ['25288', '25289', '25290', '25291', '25292']
2025-02-11 15:03:36.675 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:36.675 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:36.675 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:36.675 DEBUG [src.node.docker_mananger] docker run -i -t -p 25288:25288 -p 25289:25289 -p 25290:25290 -p 25291:25291 -p 25292:25292 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25290 --rest-port=25288 --tcp-port=25289 --discv5-udp-port=25291 --rest-address=0.0.0.0 --nat=extip:172.18.142.175 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5a4a8f21adedbedc2e1dda0c1110da7dad691a9f03b9715d0ea1b7a41dbc673b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25292 --metrics-logging=true --relay=true --filter=true
2025-02-11 15:03:36.918 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.142.175 waku 994f2159f183a581b5e7c778d95b057b14af24db9461a0655ec02b4f502c5aca
2025-02-11 15:03:36.969 DEBUG [src.node.docker_mananger] Container started with ID 994f2159f183. Setting up logs at ./log/docker/node1_2025-02-11_15-03-36__b5b49fbb-9638-44eb-aed2-58b8a220a78d__wakuorg_nwaku:latest.log
2025-02-11 15:03:36.970 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25288
2025-02-11 15:03:36.970 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:37.328 ERROR [src.node.docker_mananger] Max retries reached for container 0bb3e4efc9e7. Exiting log stream.
2025-02-11 15:03:37.970 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25288/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:37.973 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:37.974 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:37.974 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25288/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:37.976 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.142.175/tcp/25289/p2p/16Uiu2HAmM8j2CRkZtxzKkQ6zdDDZ6eCqE9ziPezc47BEzRxbSvTN","/ip4/172.18.142.175/tcp/25290/ws/p2p/16Uiu2HAmM8j2CRkZtxzKkQ6zdDDZ6eCqE9ziPezc47BEzRxbSvTN"],"enrUri":"enr:-L24QH65aqmi-E0uabKSDQAv1rCVDAt_TiY4EIncAXhSnnNhQKYqInnmmJCqZwE_Ji4RsCTy-B5xIWkzQSvKloPVdyUCgmlkgnY0gmlwhKwSjq-KbXVsdGlhZGRyc5YACASsEo6vBmLJAAoErBKOrwZiyt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDffhs4Vh7ymzeHEduzP91pf3qLVm-TqZBYSakc9OVi1WDdGNwgmLJg3VkcIJiy4V3YWt1MgU"}'
2025-02-11 15:03:37.976 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:37.977 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-11 15:03:37.983 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:37.983 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-03-36__b5b49fbb-9638-44eb-aed2-58b8a220a78d__wakuorg_nwaku:latest.log
2025-02-11 15:03:37.983 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:37.983 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:37.984 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:37.985 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.103.230
2025-02-11 15:03:37.985 DEBUG [src.node.docker_mananger] Generated ports ['32841', '32842', '32843', '32844', '32845']
2025-02-11 15:03:37.985 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:37.985 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:37.985 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:37.985 DEBUG [src.node.docker_mananger] docker run -i -t -p 32841:32841 -p 32842:32842 -p 32843:32843 -p 32844:32844 -p 32845:32845 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32843 --rest-port=32841 --tcp-port=32842 --discv5-udp-port=32844 --rest-address=0.0.0.0 --nat=extip:172.18.103.230 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d1fb4ae39a7a5f9ae18a37d91fd847ece5e5f7d15e2e982ee7a399abf9dfdbca --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32845 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QH65aqmi-E0uabKSDQAv1rCVDAt_TiY4EIncAXhSnnNhQKYqInnmmJCqZwE_Ji4RsCTy-B5xIWkzQSvKloPVdyUCgmlkgnY0gmlwhKwSjq-KbXVsdGlhZGRyc5YACASsEo6vBmLJAAoErBKOrwZiyt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDffhs4Vh7ymzeHEduzP91pf3qLVm-TqZBYSakc9OVi1WDdGNwgmLJg3VkcIJiy4V3YWt1MgU --filternode=/ip4/172.18.142.175/tcp/25289/p2p/16Uiu2HAmM8j2CRkZtxzKkQ6zdDDZ6eCqE9ziPezc47BEzRxbSvTN
2025-02-11 15:03:38.218 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.103.230 waku 419c07d4f08e639c60974dbf6bf3d1c08f5f870dfea2d30c646134859e36ea4c
2025-02-11 15:03:38.268 DEBUG [src.node.docker_mananger] Container started with ID 419c07d4f08e. Setting up logs at ./log/docker/node2_2025-02-11_15-03-36__b5b49fbb-9638-44eb-aed2-58b8a220a78d__wakuorg_nwaku:latest.log
2025-02-11 15:03:38.268 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 32841
2025-02-11 15:03:38.268 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:39.269 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:39.272 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:39.272 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:39.272 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:39.274 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.103.230/tcp/32842/p2p/16Uiu2HAmDAY1Wjdu2ZKSCFjniBcMjvCj9xFzXLh7GgUF29Yz3LoR","/ip4/172.18.103.230/tcp/32843/ws/p2p/16Uiu2HAmDAY1Wjdu2ZKSCFjniBcMjvCj9xFzXLh7GgUF29Yz3LoR"],"enrUri":"enr:-L24QHxsNEk6AzhkxRl4sFs6UPmz123DWufXcTddUawyxHjdHq6SHBDZZz0RRikcDxWNFBVpcuY3KtmFJX3OsrpoMO8CgmlkgnY0gmlwhKwSZ-aKbXVsdGlhZGRyc5YACASsEmfmBoBKAAoErBJn5gaAS90DgnJzhQADAQAAiXNlY3AyNTZrMaEDB5Gj8-F6ETEkFb2LPzTxjsaoG7vA9tAb0LDo3YET-_CDdGNwgoBKg3VkcIKATIV3YWt1MgA"}'
2025-02-11 15:03:39.275 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:39.275 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32841/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.142.175/tcp/25289/p2p/16Uiu2HAmM8j2CRkZtxzKkQ6zdDDZ6eCqE9ziPezc47BEzRxbSvTN"]'
2025-02-11 15:03:39.312 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.314 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-11 15:03:39.314 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:03:39.334 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.336 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32841/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d9f6c84a-1a8d-402c-ba90-4e2937d1d9a1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 15:03:39.348 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"d9f6c84a-1a8d-402c-ba90-4e2937d1d9a1","statusDesc":"OK"}'
2025-02-11 15:03:39.349 DEBUG [tests.filter.test_get_messages] Running test with timestamp Now
2025-02-11 15:03:39.349 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:39.357 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.357 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:39.457 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:39.458 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:39.461 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739286142283513088,"ephemeral":false}]'
2025-02-11 15:03:39.463 DEBUG [tests.filter.test_get_messages] Running test with timestamp Far future
2025-02-11 15:03:39.463 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:39.468 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.468 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:39.568 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:39.569 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:39.571 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":2054646142283499008,"ephemeral":false}]'
2025-02-11 15:03:39.573 DEBUG [tests.filter.test_get_messages] Running test with timestamp Recent past
2025-02-11 15:03:39.573 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:39.578 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.578 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:39.678 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:39.679 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:39.682 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739282542283499008,"ephemeral":false}]'
2025-02-11 15:03:39.683 DEBUG [tests.filter.test_get_messages] Running test with timestamp Near future
2025-02-11 15:03:39.684 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:39.688 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.688 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:39.789 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:39.789 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:39.792 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739289742283499008,"ephemeral":false}]'
2025-02-11 15:03:39.794 DEBUG [tests.filter.test_get_messages] Running test with timestamp Positive number
2025-02-11 15:03:39.794 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:39.798 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.799 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:39.899 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:39.899 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:39.902 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1,"ephemeral":false}]'
2025-02-11 15:03:39.903 DEBUG [tests.filter.test_get_messages] Running test with timestamp Negative number
2025-02-11 15:03:39.904 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:39.908 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:39.908 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:40.009 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:40.009 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:40.012 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":-1,"ephemeral":false}]'
2025-02-11 15:03:40.014 DEBUG [tests.filter.test_get_messages] Running test with timestamp DST change
2025-02-11 15:03:40.014 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25288/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:40.019 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:40.019 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:40.119 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:40.120 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32841/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:40.122 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1583632800000000000,"ephemeral":false}]'
2025-02-11 15:03:40.125 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:03:40.126 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:03:40.126 DEBUG [src.node.waku_node] Stopping container with id 994f2159f183
2025-02-11 15:03:41.552 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:41.553 DEBUG [src.node.waku_node] Stopping container with id 419c07d4f08e
2025-02-11 15:03:42.365 ERROR [src.node.docker_mananger] Max retries reached for container 994f2159f183. Exiting log stream.
2025-02-11 15:03:43.061 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:43.063 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:03:43.068 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:03:43.072 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
