2025-02-11 15:04:17.434 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:04:17.434 DEBUG [tests.conftest] Running test: test_light_push_with_no_timestamp with id: 2025-02-11_15-04-17__e4adee05-adeb-49b1-b0eb-bbdf657aeab0
2025-02-11 15:04:17.434 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:04:17.435 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 15:04:17.441 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:17.441 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_15-04-17__e4adee05-adeb-49b1-b0eb-bbdf657aeab0__wakuorg_nwaku:latest.log
2025-02-11 15:04:17.441 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:17.441 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:17.442 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:17.443 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.3.45
2025-02-11 15:04:17.443 DEBUG [src.node.docker_mananger] Generated ports ['10693', '10694', '10695', '10696', '10697']
2025-02-11 15:04:17.443 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:17.443 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:17.443 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:17.443 DEBUG [src.node.docker_mananger] docker run -i -t -p 10693:10693 -p 10694:10694 -p 10695:10695 -p 10696:10696 -p 10697:10697 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10695 --rest-port=10693 --tcp-port=10694 --discv5-udp-port=10696 --rest-address=0.0.0.0 --nat=extip:172.18.3.45 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f86adf00ed9a0dc8cd22eeed4283eb5c1fdf5d953926b8c2d91f7c4d5a9aecb6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10697 --metrics-logging=true --lightpush=true --relay=true
2025-02-11 15:04:17.663 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.3.45 waku 4fbea4171dc6123b2da981bd2c9736b9edab7ae8118c3a1014f983316c075c4b
2025-02-11 15:04:17.709 DEBUG [src.node.docker_mananger] Container started with ID 4fbea4171dc6. Setting up logs at ./log/docker/receiving_node1_2025-02-11_15-04-17__e4adee05-adeb-49b1-b0eb-bbdf657aeab0__wakuorg_nwaku:latest.log
2025-02-11 15:04:17.710 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10693
2025-02-11 15:04:17.710 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:18.237 ERROR [src.node.docker_mananger] Max retries reached for container 540f60aa2540. Exiting log stream.
2025-02-11 15:04:18.711 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10693/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:18.714 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:18.714 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:18.714 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10693/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:18.716 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.3.45/tcp/10694/p2p/16Uiu2HAmSGN2YTC2Uo7LwDxoyngzKMXfyryFE7AYoqN4UpxZSmdG","/ip4/172.18.3.45/tcp/10695/ws/p2p/16Uiu2HAmSGN2YTC2Uo7LwDxoyngzKMXfyryFE7AYoqN4UpxZSmdG"],"enrUri":"enr:-L24QPbnigCWJi-MDIQhBZSGlXbSo9HVZSJgr8D2L1Pv3F2gJtzof-Bf7HIW-cnUwzmavmMI8dewZoSPDIqUJIhEA8ACgmlkgnY0gmlwhKwSAy2KbXVsdGlhZGRyc5YACASsEgMtBinGAAoErBIDLQYpx90DgnJzhQADAQAAiXNlY3AyNTZrMaEDyjfEtBXBrBSO2ihHA5lmoP3DHR4cmXxXuZ5s08JpRe-DdGNwginGg3VkcIIpyIV3YWt1Mgk"}'
2025-02-11 15:04:18.716 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:18.723 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:18.723 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-11_15-04-17__e4adee05-adeb-49b1-b0eb-bbdf657aeab0__wakuorg_nwaku:latest.log
2025-02-11 15:04:18.723 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:18.723 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:18.725 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:18.725 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.59.109
2025-02-11 15:04:18.725 DEBUG [src.node.docker_mananger] Generated ports ['16137', '16138', '16139', '16140', '16141']
2025-02-11 15:04:18.725 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:18.725 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:18.726 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:18.726 DEBUG [src.node.docker_mananger] docker run -i -t -p 16137:16137 -p 16138:16138 -p 16139:16139 -p 16140:16140 -p 16141:16141 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16139 --rest-port=16137 --tcp-port=16138 --discv5-udp-port=16140 --rest-address=0.0.0.0 --nat=extip:172.18.59.109 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=95bebdbbd16a1f4a60deade1f2ce522e2083fcd6aebbdbfac4df904c5b23fdde --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16141 --metrics-logging=true --lightpush=false --relay=true
2025-02-11 15:04:18.961 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.59.109 waku 014ee322a4bfacb0e2abc87c7cc2e45dd997a5ebfab2c5b17ddb4307b67c5774
2025-02-11 15:04:19.008 DEBUG [src.node.docker_mananger] Container started with ID 014ee322a4bf. Setting up logs at ./log/docker/receiving_node2_2025-02-11_15-04-17__e4adee05-adeb-49b1-b0eb-bbdf657aeab0__wakuorg_nwaku:latest.log
2025-02-11 15:04:19.008 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16137
2025-02-11 15:04:19.008 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:20.010 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16137/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:20.012 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:20.013 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:20.013 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16137/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:20.015 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.59.109/tcp/16138/p2p/16Uiu2HAmLpiLk7mGMUX8ak3uupJYZr6uDFDbxyKhJGb8HTNSxonT","/ip4/172.18.59.109/tcp/16139/ws/p2p/16Uiu2HAmLpiLk7mGMUX8ak3uupJYZr6uDFDbxyKhJGb8HTNSxonT"],"enrUri":"enr:-L24QPeiorJdNgtN1jB9z9LTY--5_qsRiS5XgdXiW3K7r8cIaEPNRF-fQLvE3Pv6JpX0I_KfbU06TbGm6pM_X6zxZdwCgmlkgnY0gmlwhKwSO22KbXVsdGlhZGRyc5YACASsEjttBj8KAAoErBI7bQY_C90DgnJzhQADAQAAiXNlY3AyNTZrMaEDeVsznHVqLBW4TaYCafIbOM9M9yUsBltujV6iuJM5G4yDdGNwgj8Kg3VkcII_DIV3YWt1MgE"}'
2025-02-11 15:04:20.015 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:20.015 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16137/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.3.45/tcp/10694/p2p/16Uiu2HAmSGN2YTC2Uo7LwDxoyngzKMXfyryFE7AYoqN4UpxZSmdG"]'
2025-02-11 15:04:20.054 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:20.066 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:20.066 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_15-04-17__e4adee05-adeb-49b1-b0eb-bbdf657aeab0__wakuorg_nwaku:latest.log
2025-02-11 15:04:20.066 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:20.066 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:20.067 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:20.068 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.240.112
2025-02-11 15:04:20.068 DEBUG [src.node.docker_mananger] Generated ports ['24950', '24951', '24952', '24953', '24954']
2025-02-11 15:04:20.068 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:20.068 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:20.068 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:20.068 DEBUG [src.node.docker_mananger] docker run -i -t -p 24950:24950 -p 24951:24951 -p 24952:24952 -p 24953:24953 -p 24954:24954 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24952 --rest-port=24950 --tcp-port=24951 --discv5-udp-port=24953 --rest-address=0.0.0.0 --nat=extip:172.18.240.112 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bbd0a3b8beaf185f8ec0fe1e4d56ab1f5cacf0e1b6f8f2eeda5f8939b4ce6268 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24954 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QPbnigCWJi-MDIQhBZSGlXbSo9HVZSJgr8D2L1Pv3F2gJtzof-Bf7HIW-cnUwzmavmMI8dewZoSPDIqUJIhEA8ACgmlkgnY0gmlwhKwSAy2KbXVsdGlhZGRyc5YACASsEgMtBinGAAoErBIDLQYpx90DgnJzhQADAQAAiXNlY3AyNTZrMaEDyjfEtBXBrBSO2ihHA5lmoP3DHR4cmXxXuZ5s08JpRe-DdGNwginGg3VkcIIpyIV3YWt1Mgk --lightpushnode=/ip4/172.18.3.45/tcp/10694/p2p/16Uiu2HAmSGN2YTC2Uo7LwDxoyngzKMXfyryFE7AYoqN4UpxZSmdG --lightpush=true --relay=false
2025-02-11 15:04:20.305 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.240.112 waku 7a6493a0ed11505c115cc4f080612dc13f45f8b438b5fd12c0553e8eed419c05
2025-02-11 15:04:20.355 DEBUG [src.node.docker_mananger] Container started with ID 7a6493a0ed11. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_15-04-17__e4adee05-adeb-49b1-b0eb-bbdf657aeab0__wakuorg_nwaku:latest.log
2025-02-11 15:04:20.355 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24950
2025-02-11 15:04:20.356 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:21.357 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24950/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:21.360 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:21.360 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:21.360 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24950/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:21.362 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.240.112/tcp/24951/p2p/16Uiu2HAkyAWGhGs6vWnDpwvNXQP2q1QEeWMatDnkvajEqtMfmydC","/ip4/172.18.240.112/tcp/24952/ws/p2p/16Uiu2HAkyAWGhGs6vWnDpwvNXQP2q1QEeWMatDnkvajEqtMfmydC"],"enrUri":"enr:-L24QE_3vRJXgsshVyg8N3bZONM5jnp5k06Zm9Rnit0h3DhVRT71CbMoNrotHbYhlY00IYftbmCNBcIhETVzQI8SjD0CgmlkgnY0gmlwhKwS8HCKbXVsdGlhZGRyc5YACASsEvBwBmF3AAoErBLwcAZheN0DgnJzhQADAQAAiXNlY3AyNTZrMaECN4wO2wRfsgSEPZbd-lUCElCK0QaacSpfcSEu1yx3S5ODdGNwgmF3g3VkcIJheYV3YWt1Mgg"}'
2025-02-11 15:04:21.362 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:21.363 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24950/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.3.45/tcp/10694/p2p/16Uiu2HAmSGN2YTC2Uo7LwDxoyngzKMXfyryFE7AYoqN4UpxZSmdG"]'
2025-02-11 15:04:21.399 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:21.399 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24950/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.59.109/tcp/16138/p2p/16Uiu2HAmLpiLk7mGMUX8ak3uupJYZr6uDFDbxyKhJGb8HTNSxonT"]'
2025-02-11 15:04:21.430 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:21.430 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10693/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:04:21.436 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:21.436 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16137/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:04:21.444 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:21.449 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 15:04:21.450 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24950/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto"}}'
2025-02-11 15:04:21.461 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:21.461 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:04:21.561 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-11 15:04:21.561 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10693/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:21.564 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286261452385024,"ephemeral":false}]'
2025-02-11 15:04:21.565 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-11 15:04:21.566 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16137/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:21.568 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286261452385024,"ephemeral":false}]'
2025-02-11 15:04:21.570 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:04:21.571 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:04:21.571 DEBUG [src.node.waku_node] Stopping container with id 4fbea4171dc6
2025-02-11 15:04:22.202 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:22.202 DEBUG [src.node.waku_node] Stopping container with id 014ee322a4bf
2025-02-11 15:04:23.014 ERROR [src.node.docker_mananger] Max retries reached for container 4fbea4171dc6. Exiting log stream.
2025-02-11 15:04:23.704 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:23.704 DEBUG [src.node.waku_node] Stopping container with id 7a6493a0ed11
2025-02-11 15:04:24.516 ERROR [src.node.docker_mananger] Max retries reached for container 014ee322a4bf. Exiting log stream.
2025-02-11 15:04:25.190 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:25.191 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:04:25.199 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:25.205 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:25.210 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
