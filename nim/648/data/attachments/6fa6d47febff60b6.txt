2025-02-11 15:04:07.075 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:04:07.075 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-11_15-04-07__4a80eb3f-902d-41fe-bf42-a904c85ae320
2025-02-11 15:04:07.075 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:04:07.076 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:04:07.076 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 15:04:07.082 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:07.082 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-04-07__4a80eb3f-902d-41fe-bf42-a904c85ae320__wakuorg_nwaku:latest.log
2025-02-11 15:04:07.082 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:07.082 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:07.084 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:07.084 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.183.160
2025-02-11 15:04:07.084 DEBUG [src.node.docker_mananger] Generated ports ['65099', '65100', '65101', '65102', '65103']
2025-02-11 15:04:07.084 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:07.084 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:07.084 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:07.084 DEBUG [src.node.docker_mananger] docker run -i -t -p 65099:65099 -p 65100:65100 -p 65101:65101 -p 65102:65102 -p 65103:65103 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65101 --rest-port=65099 --tcp-port=65100 --discv5-udp-port=65102 --rest-address=0.0.0.0 --nat=extip:172.18.183.160 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b8fee9f93dba5a4cb6db9b4e5a9bfeebecfec7ee55d9d3cbbe95eda6a6accfc6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65103 --metrics-logging=true --relay=true
2025-02-11 15:04:07.304 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.183.160 waku 6a5c98aa7ee8b47a10e64f6cb62e2ac5fd4be8c3d510bf8e617f8eb719e4349f
2025-02-11 15:04:07.354 DEBUG [src.node.docker_mananger] Container started with ID 6a5c98aa7ee8. Setting up logs at ./log/docker/node1_2025-02-11_15-04-07__4a80eb3f-902d-41fe-bf42-a904c85ae320__wakuorg_nwaku:latest.log
2025-02-11 15:04:07.354 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 65099
2025-02-11 15:04:07.355 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:07.863 ERROR [src.node.docker_mananger] Max retries reached for container fe3b8f44d8b5. Exiting log stream.
2025-02-11 15:04:08.356 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65099/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:08.359 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:08.359 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:08.360 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65099/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:08.362 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.183.160/tcp/65100/p2p/16Uiu2HAmKHq81nqLJmJhrc1xHw91pRuSYpqkiZ6DftFZgXnjoLm1","/ip4/172.18.183.160/tcp/65101/ws/p2p/16Uiu2HAmKHq81nqLJmJhrc1xHw91pRuSYpqkiZ6DftFZgXnjoLm1"],"enrUri":"enr:-L24QGVGEMrvpysrLBIBshAkhpnYViEaswltaaXmKijOGQR7dIovppVO599RxOQhDsCBVuGexfBDq0Y0og-Nst_8sVkCgmlkgnY0gmlwhKwSt6CKbXVsdGlhZGRyc5YACASsEregBv5MAAoErBK3oAb-Td0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYpYtJdFn03Ul6zyrsxSxhuwMysiNGj8dA880K3DYBZSDdGNwgv5Mg3VkcIL-ToV3YWt1MgE"}'
2025-02-11 15:04:08.362 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:08.368 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:08.369 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-04-07__4a80eb3f-902d-41fe-bf42-a904c85ae320__wakuorg_nwaku:latest.log
2025-02-11 15:04:08.369 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:08.369 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:08.370 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:08.370 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.210.178
2025-02-11 15:04:08.370 DEBUG [src.node.docker_mananger] Generated ports ['15621', '15622', '15623', '15624', '15625']
2025-02-11 15:04:08.371 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:08.371 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:08.371 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:08.371 DEBUG [src.node.docker_mananger] docker run -i -t -p 15621:15621 -p 15622:15622 -p 15623:15623 -p 15624:15624 -p 15625:15625 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15623 --rest-port=15621 --tcp-port=15622 --discv5-udp-port=15624 --rest-address=0.0.0.0 --nat=extip:172.18.210.178 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3e03cbfda1ebbfcbe5d9e4aed8beacd60bff3f81b6b2bd3b0712b5eec4ce845c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15625 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QGVGEMrvpysrLBIBshAkhpnYViEaswltaaXmKijOGQR7dIovppVO599RxOQhDsCBVuGexfBDq0Y0og-Nst_8sVkCgmlkgnY0gmlwhKwSt6CKbXVsdGlhZGRyc5YACASsEregBv5MAAoErBK3oAb-Td0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYpYtJdFn03Ul6zyrsxSxhuwMysiNGj8dA880K3DYBZSDdGNwgv5Mg3VkcIL-ToV3YWt1MgE
2025-02-11 15:04:08.603 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.210.178 waku ba1e158d66f68218ea2a5a8836420fd89b2775ccc802fcf8ff604bf6c51bcb9e
2025-02-11 15:04:08.650 DEBUG [src.node.docker_mananger] Container started with ID ba1e158d66f6. Setting up logs at ./log/docker/node2_2025-02-11_15-04-07__4a80eb3f-902d-41fe-bf42-a904c85ae320__wakuorg_nwaku:latest.log
2025-02-11 15:04:08.650 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15621
2025-02-11 15:04:08.650 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:09.651 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15621/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:09.658 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:09.659 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:09.659 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15621/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:09.665 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.210.178/tcp/15622/p2p/16Uiu2HAm8wm9cPjjGdqJAGk325Zxjy943xeZReqxCEPB86iNUCQ6","/ip4/172.18.210.178/tcp/15623/ws/p2p/16Uiu2HAm8wm9cPjjGdqJAGk325Zxjy943xeZReqxCEPB86iNUCQ6"],"enrUri":"enr:-L24QMcNLyzmT4d07M4cR1M5yWiu8NXyOXElxg4YEZnNVCPgcgz0M3xS1wtckCV8BAq3hKz6-GLglrK2v5MFxwaa5hICgmlkgnY0gmlwhKwS0rKKbXVsdGlhZGRyc5YACASsEtKyBj0GAAoErBLSsgY9B90DgnJzhQADAQAAiXNlY3AyNTZrMaECyN0zAFkfUTXjZO3uYgMXI-wKM5S4BcEJ1KJ_cx4Qq6-DdGNwgj0Gg3VkcII9CIV3YWt1MgE"}'
2025-02-11 15:04:09.666 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:09.667 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15621/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.183.160/tcp/65100/p2p/16Uiu2HAmKHq81nqLJmJhrc1xHw91pRuSYpqkiZ6DftFZgXnjoLm1"]'
2025-02-11 15:04:09.670 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:09.670 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 15:04:09.670 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65099/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:04:09.674 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:09.674 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15621/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:04:09.680 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:09.683 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:09.689 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:09.689 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:04:09.790 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:09.790 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:09.792 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286249683326464,"ephemeral":false}]'
2025-02-11 15:04:09.794 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:09.794 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15621/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:09.796 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286249683326464,"ephemeral":false}]'
2025-02-11 15:04:09.798 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 15:04:09.799 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-11 15:04:09.799 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:09.801 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 15:04:09.802 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-11 15:04:09.802 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:09.804 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 15:04:09.804 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-11 15:04:09.804 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:09.807 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 15:04:09.807 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-11 15:04:09.807 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:09.809 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 15:04:09.809 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-11 15:04:09.809 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:09.812 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:65099/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 15:04:09.814 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:04:09.815 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:04:09.815 DEBUG [src.node.waku_node] Stopping container with id 6a5c98aa7ee8
2025-02-11 15:04:10.827 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:10.827 DEBUG [src.node.waku_node] Stopping container with id ba1e158d66f6
2025-02-11 15:04:11.639 ERROR [src.node.docker_mananger] Max retries reached for container 6a5c98aa7ee8. Exiting log stream.
2025-02-11 15:04:12.314 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:12.315 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:04:12.323 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:12.328 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
