2025-02-11 15:12:36.441 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:12:36.441 DEBUG [tests.conftest] Running test: test_main_node_relay_and_store__peer_only_store with id: 2025-02-11_15-12-36__20187c10-5eed-4a91-9797-85b088f0c189
2025-02-11 15:12:36.442 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:12:36.442 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 15:12:36.448 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:12:36.448 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-11_15-12-36__20187c10-5eed-4a91-9797-85b088f0c189__wakuorg_nwaku:latest.log
2025-02-11 15:12:36.449 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:12:36.449 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:12:36.450 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:12:36.450 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.32.193
2025-02-11 15:12:36.450 DEBUG [src.node.docker_mananger] Generated ports ['39262', '39263', '39264', '39265', '39266']
2025-02-11 15:12:36.450 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:12:36.451 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:12:36.451 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:12:36.451 DEBUG [src.node.docker_mananger] docker run -i -t -p 39262:39262 -p 39263:39263 -p 39264:39264 -p 39265:39265 -p 39266:39266 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39264 --rest-port=39262 --tcp-port=39263 --discv5-udp-port=39265 --rest-address=0.0.0.0 --nat=extip:172.18.32.193 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ed3e19bb35ca9606e3df72429800ad9c2eccfaf7a3382c21de658c1465fb2be8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39266 --metrics-logging=true --store=true --relay=true
2025-02-11 15:12:36.684 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.32.193 waku 931a1daa72319eaefd062ec4744216e28dde8c2f1ba94388ea293f51317e2bb8
2025-02-11 15:12:36.735 DEBUG [src.node.docker_mananger] Container started with ID 931a1daa7231. Setting up logs at ./log/docker/publishing_node1_2025-02-11_15-12-36__20187c10-5eed-4a91-9797-85b088f0c189__wakuorg_nwaku:latest.log
2025-02-11 15:12:36.737 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39262
2025-02-11 15:12:36.737 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:12:37.231 ERROR [src.node.docker_mananger] Max retries reached for container 1bc675428473. Exiting log stream.
2025-02-11 15:12:37.737 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39262/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:12:37.740 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:12:37.740 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:12:37.740 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39262/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:12:37.742 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.32.193/tcp/39263/p2p/16Uiu2HAmQ5THRVJNJZU5ah8Nuh2mtZ6DWJEVdUeUQuZvQiztqYy2","/ip4/172.18.32.193/tcp/39264/ws/p2p/16Uiu2HAmQ5THRVJNJZU5ah8Nuh2mtZ6DWJEVdUeUQuZvQiztqYy2"],"enrUri":"enr:-L24QHoDLAPUSu2TJpVBYnMfOt50zRlVMf0elMcSqM1NfLETBQkoDAFfEKVzPS8jWEP98zLgfWcV2GmMa06N1tKT0k0CgmlkgnY0gmlwhKwSIMGKbXVsdGlhZGRyc5YACASsEiDBBplfAAoErBIgwQaZYN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDqbTzACebn4fbI0mSKvvWLwbQPsgpSsC_pFvEkSYJdR2DdGNwgplfg3VkcIKZYYV3YWt1MgM"}'
2025-02-11 15:12:37.743 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:12:37.750 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:12:37.750 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-11_15-12-36__20187c10-5eed-4a91-9797-85b088f0c189__wakuorg_nwaku:latest.log
2025-02-11 15:12:37.750 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:12:37.750 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:12:37.751 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:12:37.752 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.208.164
2025-02-11 15:12:37.752 DEBUG [src.node.docker_mananger] Generated ports ['42724', '42725', '42726', '42727', '42728']
2025-02-11 15:12:37.752 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:12:37.752 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:12:37.752 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:12:37.752 DEBUG [src.node.docker_mananger] docker run -i -t -p 42724:42724 -p 42725:42725 -p 42726:42726 -p 42727:42727 -p 42728:42728 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42726 --rest-port=42724 --tcp-port=42725 --discv5-udp-port=42727 --rest-address=0.0.0.0 --nat=extip:172.18.208.164 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8cf4dfe18cbc7bfd6ddabdfc4e8dde1a74bfc88bfd90aabc6c89ae82a36e10bd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42728 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHoDLAPUSu2TJpVBYnMfOt50zRlVMf0elMcSqM1NfLETBQkoDAFfEKVzPS8jWEP98zLgfWcV2GmMa06N1tKT0k0CgmlkgnY0gmlwhKwSIMGKbXVsdGlhZGRyc5YACASsEiDBBplfAAoErBIgwQaZYN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDqbTzACebn4fbI0mSKvvWLwbQPsgpSsC_pFvEkSYJdR2DdGNwgplfg3VkcIKZYYV3YWt1MgM --storenode=/ip4/172.18.32.193/tcp/39263/p2p/16Uiu2HAmQ5THRVJNJZU5ah8Nuh2mtZ6DWJEVdUeUQuZvQiztqYy2 --store=true --relay=false
2025-02-11 15:12:37.986 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.208.164 waku 11e1978248c4e80a537365d987e327375607a39139f92881e77fa55add03a063
2025-02-11 15:12:38.035 DEBUG [src.node.docker_mananger] Container started with ID 11e1978248c4. Setting up logs at ./log/docker/store_node1_2025-02-11_15-12-36__20187c10-5eed-4a91-9797-85b088f0c189__wakuorg_nwaku:latest.log
2025-02-11 15:12:38.037 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42724
2025-02-11 15:12:38.039 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:12:39.039 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42724/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:12:39.042 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:12:39.042 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:12:39.042 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42724/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:12:39.044 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.208.164/tcp/42725/p2p/16Uiu2HAm7eu1egjHFJjtek2TwvZVQxMxrZmRFzgpyS6ran3LqmJF","/ip4/172.18.208.164/tcp/42726/ws/p2p/16Uiu2HAm7eu1egjHFJjtek2TwvZVQxMxrZmRFzgpyS6ran3LqmJF"],"enrUri":"enr:-L24QA8FV2bkr2by9jhnKoUVkmdlaMolmp0e26n5FUbsJXrfd9-FImDWLYfY18CSFUK7y3Tr4twAXW5hnJH3gQdDovUCgmlkgnY0gmlwhKwS0KSKbXVsdGlhZGRyc5YACASsEtCkBqblAAoErBLQpAam5t0DgnJzhQADAQAAiXNlY3AyNTZrMaECta-Ha3yNstClfBItfa3cpZPZDO3zuvfaQo95j07gq8iDdGNwgqblg3VkcIKm54V3YWt1MgI"}'
2025-02-11 15:12:39.045 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:12:39.045 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42724/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.32.193/tcp/39263/p2p/16Uiu2HAmQ5THRVJNJZU5ah8Nuh2mtZ6DWJEVdUeUQuZvQiztqYy2"]'
2025-02-11 15:12:39.080 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:12:39.082 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39262/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:12:39.101 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:12:39.104 DEBUG [src.steps.store] Relaying message
2025-02-11 15:12:39.104 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39262/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:12:39.120 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:12:39.120 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:12:39.320 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:12:39.321 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39262/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:12:39.324 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-11 15:12:39.325 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:12:39.327 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:12:39.327 DEBUG [src.node.waku_node] Stopping container with id 931a1daa7231
2025-02-11 15:12:40.271 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:12:40.272 DEBUG [src.node.waku_node] Stopping container with id 11e1978248c4
2025-02-11 15:12:41.083 ERROR [src.node.docker_mananger] Max retries reached for container 931a1daa7231. Exiting log stream.
2025-02-11 15:12:41.767 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:12:41.767 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:12:41.773 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:12:41.778 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
