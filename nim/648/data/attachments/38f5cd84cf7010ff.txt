2025-02-11 15:03:38.922 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:03:38.923 DEBUG [tests.conftest] Running test: test_pubsub_topic_also_in_docker_flags[/waku/2/rs/2/0] with id: 2025-02-11_15-03-38__8d5a46ee-7788-4e4a-943c-91f476802871
2025-02-11 15:03:38.923 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:03:38.924 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:03:38.924 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-11 15:03:38.934 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:38.935 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-03-38__8d5a46ee-7788-4e4a-943c-91f476802871__wakuorg_nwaku:latest.log
2025-02-11 15:03:38.935 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:38.935 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:38.937 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:38.937 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.190.253
2025-02-11 15:03:38.937 DEBUG [src.node.docker_mananger] Generated ports ['33604', '33605', '33606', '33607', '33608']
2025-02-11 15:03:38.938 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:38.938 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:38.938 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:38.938 DEBUG [src.node.docker_mananger] docker run -i -t -p 33604:33604 -p 33605:33605 -p 33606:33606 -p 33607:33607 -p 33608:33608 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33606 --rest-port=33604 --tcp-port=33605 --discv5-udp-port=33607 --rest-address=0.0.0.0 --nat=extip:172.18.190.253 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=fab7a7284b950cb8a62d6eac0b9e9dda2c41c0461b10aa4b8e2b698fd65d6a96 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33608 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0 --content-topic=/myapp/1/latest/proto
2025-02-11 15:03:39.183 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.190.253 waku 31440368192dd385a713e4331d8d0edd04e59424620ad7436de165b2ea3e9ed5
2025-02-11 15:03:39.235 DEBUG [src.node.docker_mananger] Container started with ID 31440368192d. Setting up logs at ./log/docker/node1_2025-02-11_15-03-38__8d5a46ee-7788-4e4a-943c-91f476802871__wakuorg_nwaku:latest.log
2025-02-11 15:03:39.236 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33604
2025-02-11 15:03:39.236 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:39.811 ERROR [src.node.docker_mananger] Max retries reached for container 17992f28e4d8. Exiting log stream.
2025-02-11 15:03:40.237 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33604/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:40.240 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:40.240 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:40.240 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33604/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:40.242 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.190.253/tcp/33605/p2p/16Uiu2HAm5fkxQiBgCHFMbbM5M6A6cKqKuhDoPN3pwyuDm4pZzKMN","/ip4/172.18.190.253/tcp/33606/ws/p2p/16Uiu2HAm5fkxQiBgCHFMbbM5M6A6cKqKuhDoPN3pwyuDm4pZzKMN"],"enrUri":"enr:-L24QCBpXBOaLEHuLuHTBfZftB5VPGWpewXcEs45ydF9l21UP9MXSb_k-fL2CytSLlOOTGGI2RWxyYCsmm2JZXVht3MCgmlkgnY0gmlwhKwSvv2KbXVsdGlhZGRyc5YACASsEr79BoNFAAoErBK-_QaDRt0DgnJzhQACAQAAiXNlY3AyNTZrMaECmDCgi48IAwRdhQOev9Oko5kZoyI6e5tQXVCsQC0k8y2DdGNwgoNFg3VkcIKDR4V3YWt1MgU"}'
2025-02-11 15:03:40.242 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:40.249 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:40.249 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-03-38__8d5a46ee-7788-4e4a-943c-91f476802871__wakuorg_nwaku:latest.log
2025-02-11 15:03:40.249 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:40.249 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:40.251 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:40.251 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.65
2025-02-11 15:03:40.251 DEBUG [src.node.docker_mananger] Generated ports ['61310', '61311', '61312', '61313', '61314']
2025-02-11 15:03:40.251 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:40.251 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:40.251 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:40.251 DEBUG [src.node.docker_mananger] docker run -i -t -p 61310:61310 -p 61311:61311 -p 61312:61312 -p 61313:61313 -p 61314:61314 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61312 --rest-port=61310 --tcp-port=61311 --discv5-udp-port=61313 --rest-address=0.0.0.0 --nat=extip:172.18.254.65 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bb1e05e82bfadec2c3b8a0badb415d3697787eca065697ccd7fca3e93ee2670e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61314 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QCBpXBOaLEHuLuHTBfZftB5VPGWpewXcEs45ydF9l21UP9MXSb_k-fL2CytSLlOOTGGI2RWxyYCsmm2JZXVht3MCgmlkgnY0gmlwhKwSvv2KbXVsdGlhZGRyc5YACASsEr79BoNFAAoErBK-_QaDRt0DgnJzhQACAQAAiXNlY3AyNTZrMaECmDCgi48IAwRdhQOev9Oko5kZoyI6e5tQXVCsQC0k8y2DdGNwgoNFg3VkcIKDR4V3YWt1MgU --pubsub-topic=/waku/2/rs/2/0 --content-topic=/myapp/1/latest/proto
2025-02-11 15:03:40.475 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.65 waku a10b2057f1a1c386524b5ae8455a4d9e2e594bb2e61d71f1002dd71549637be7
2025-02-11 15:03:40.524 DEBUG [src.node.docker_mananger] Container started with ID a10b2057f1a1. Setting up logs at ./log/docker/node2_2025-02-11_15-03-38__8d5a46ee-7788-4e4a-943c-91f476802871__wakuorg_nwaku:latest.log
2025-02-11 15:03:40.525 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61310
2025-02-11 15:03:40.525 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:41.526 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61310/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:41.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:41.533 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:41.533 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61310/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:41.541 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.65/tcp/61311/p2p/16Uiu2HAmTuPBshihhiYHniJ3M9nvbTxBpp2rRgqMv8EgQBMtbTc9","/ip4/172.18.254.65/tcp/61312/ws/p2p/16Uiu2HAmTuPBshihhiYHniJ3M9nvbTxBpp2rRgqMv8EgQBMtbTc9"],"enrUri":"enr:-L24QGE_6nfefSyYkbfCWuJ1X18zS5ITA4lvr1VVdoPyieOMGVjrwTyrRDi-yy3XIaBDv5Jac2C6DgFQRHfQgl9mP30CgmlkgnY0gmlwhKwS_kGKbXVsdGlhZGRyc5YACASsEv5BBu9_AAoErBL-QQbvgN0DgnJzhQACAQAAiXNlY3AyNTZrMaED4o9CA1B-wzv7zyiynTJtrdrRghLSztiDfFVMFyYxjp6DdGNwgu9_g3VkcILvgYV3YWt1MgE"}'
2025-02-11 15:03:41.542 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:41.543 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61310/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.190.253/tcp/33605/p2p/16Uiu2HAm5fkxQiBgCHFMbbM5M6A6cKqKuhDoPN3pwyuDm4pZzKMN"]'
2025-02-11 15:03:41.547 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:41.547 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33604/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-11 15:03:41.549 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:41.550 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61310/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-11 15:03:41.552 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:41.552 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33604/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:03:41.557 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:41.557 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:41.657 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:41.658 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33604/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:41.661 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286221552673792,"ephemeral":false}]'
2025-02-11 15:03:41.663 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:41.663 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61310/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:41.665 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286221552673792,"ephemeral":false}]'
2025-02-11 15:03:41.668 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:03:41.669 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:03:41.669 DEBUG [src.node.waku_node] Stopping container with id 31440368192d
2025-02-11 15:03:42.724 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:42.724 DEBUG [src.node.waku_node] Stopping container with id a10b2057f1a1
2025-02-11 15:03:43.540 ERROR [src.node.docker_mananger] Max retries reached for container 31440368192d. Exiting log stream.
2025-02-11 15:03:44.238 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:44.239 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:03:44.244 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:03:44.249 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
