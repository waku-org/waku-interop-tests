2025-02-11 15:07:51.704 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:07:51.704 DEBUG [tests.conftest] Running test: test_sender_uses_auto_api_receiver_uses_regular_api with id: 2025-02-11_15-07-51__d18f6767-c7b3-4fd2-891a-563129b9513a
2025-02-11 15:07:51.704 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:07:51.704 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:07:51.705 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-11 15:07:51.711 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:07:51.711 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-07-51__d18f6767-c7b3-4fd2-891a-563129b9513a__wakuorg_nwaku:latest.log
2025-02-11 15:07:51.711 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:07:51.712 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:07:51.713 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:07:51.713 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.25.20
2025-02-11 15:07:51.713 DEBUG [src.node.docker_mananger] Generated ports ['33146', '33147', '33148', '33149', '33150']
2025-02-11 15:07:51.713 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:07:51.713 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:07:51.713 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:07:51.713 DEBUG [src.node.docker_mananger] docker run -i -t -p 33146:33146 -p 33147:33147 -p 33148:33148 -p 33149:33149 -p 33150:33150 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33148 --rest-port=33146 --tcp-port=33147 --discv5-udp-port=33149 --rest-address=0.0.0.0 --nat=extip:172.18.25.20 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=6022ebbcd8d59dcd99bf7fcd7d2f50ca8ce07da6f6adcdec5cea97029ebeb69b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33150 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0 --num-shards-in-network=1
2025-02-11 15:07:51.949 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.25.20 waku 510c5401f66e0beb9d26a22a780be82478fe97b0738aaee9d2c50484103d0bc5
2025-02-11 15:07:52.002 DEBUG [src.node.docker_mananger] Container started with ID 510c5401f66e. Setting up logs at ./log/docker/node1_2025-02-11_15-07-51__d18f6767-c7b3-4fd2-891a-563129b9513a__wakuorg_nwaku:latest.log
2025-02-11 15:07:52.002 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33146
2025-02-11 15:07:52.002 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:07:52.515 ERROR [src.node.docker_mananger] Max retries reached for container b82119d23e2f. Exiting log stream.
2025-02-11 15:07:53.003 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33146/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:53.006 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:07:53.006 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:07:53.006 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33146/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:53.008 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.25.20/tcp/33147/p2p/16Uiu2HAm6KFjsZ6L6obNeKpG8roCpZNLXgLW1fttiALrxHGwaL4L","/ip4/172.18.25.20/tcp/33148/ws/p2p/16Uiu2HAm6KFjsZ6L6obNeKpG8roCpZNLXgLW1fttiALrxHGwaL4L"],"enrUri":"enr:-L24QGzXDl6YkDAJl699J73aEELPIAT6McEofUXzEWcVpxrpMETv99E5t91P8vboN0MQSadVhWNZDusnI_kuTzN1LWMCgmlkgnY0gmlwhKwSGRSKbXVsdGlhZGRyc5YACASsEhkUBoF7AAoErBIZFAaBfN0DgnJzhQACAQAAiXNlY3AyNTZrMaECocupvjgOp9v0pVZSg1Ioo6Z5E3-tIGIGe5YazcWWf9WDdGNwgoF7g3VkcIKBfYV3YWt1MgU"}'
2025-02-11 15:07:53.008 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:07:53.015 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:07:53.015 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-07-51__d18f6767-c7b3-4fd2-891a-563129b9513a__wakuorg_nwaku:latest.log
2025-02-11 15:07:53.015 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:07:53.015 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:07:53.016 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:07:53.017 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.185.138
2025-02-11 15:07:53.017 DEBUG [src.node.docker_mananger] Generated ports ['13070', '13071', '13072', '13073', '13074']
2025-02-11 15:07:53.017 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:07:53.017 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:07:53.017 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:07:53.017 DEBUG [src.node.docker_mananger] docker run -i -t -p 13070:13070 -p 13071:13071 -p 13072:13072 -p 13073:13073 -p 13074:13074 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13072 --rest-port=13070 --tcp-port=13071 --discv5-udp-port=13073 --rest-address=0.0.0.0 --nat=extip:172.18.185.138 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=daecacddb49e2733a7ea9e264416ee9cbabcb77be9bec2e9b519cbffc5a8a4b3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13074 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QGzXDl6YkDAJl699J73aEELPIAT6McEofUXzEWcVpxrpMETv99E5t91P8vboN0MQSadVhWNZDusnI_kuTzN1LWMCgmlkgnY0gmlwhKwSGRSKbXVsdGlhZGRyc5YACASsEhkUBoF7AAoErBIZFAaBfN0DgnJzhQACAQAAiXNlY3AyNTZrMaECocupvjgOp9v0pVZSg1Ioo6Z5E3-tIGIGe5YazcWWf9WDdGNwgoF7g3VkcIKBfYV3YWt1MgU --pubsub-topic=/waku/2/rs/2/0 --num-shards-in-network=1
2025-02-11 15:07:53.236 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.185.138 waku 21a83e188d6c5044343276d25a3f7c9466c7fadced8f6606ad2151ad463c2863
2025-02-11 15:07:53.283 DEBUG [src.node.docker_mananger] Container started with ID 21a83e188d6c. Setting up logs at ./log/docker/node2_2025-02-11_15-07-51__d18f6767-c7b3-4fd2-891a-563129b9513a__wakuorg_nwaku:latest.log
2025-02-11 15:07:53.284 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 13070
2025-02-11 15:07:53.284 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:07:54.284 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13070/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:54.300 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:07:54.303 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:07:54.303 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13070/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:54.307 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.185.138/tcp/13071/p2p/16Uiu2HAmGwLxzEk4dH3RYR8BaxXz2HRxDHbwY2fVjsygtbv8GxPc","/ip4/172.18.185.138/tcp/13072/ws/p2p/16Uiu2HAmGwLxzEk4dH3RYR8BaxXz2HRxDHbwY2fVjsygtbv8GxPc"],"enrUri":"enr:-L24QK2IwLOY8JfqEV7sg4NCSAu76g9c0URc2dZ4ZkAIMyS5N4RHxn5J1f208pX1NV8LpuoE5_fULHqFQ3Xp3uNQsvECgmlkgnY0gmlwhKwSuYqKbXVsdGlhZGRyc5YACASsErmKBjMPAAoErBK5igYzEN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDP59ZxAGkWBmbWH-2yiZJD0rKVFfkJXHk9edgjWg-cMODdGNwgjMPg3VkcIIzEYV3YWt1MgE"}'
2025-02-11 15:07:54.307 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:07:54.309 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13070/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.25.20/tcp/33147/p2p/16Uiu2HAm6KFjsZ6L6obNeKpG8roCpZNLXgLW1fttiALrxHGwaL4L"]'
2025-02-11 15:07:54.313 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:54.313 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33146/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-11 15:07:54.317 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:54.317 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13070/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-11 15:07:54.319 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:54.319 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33146/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:07:54.324 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:54.325 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:07:54.425 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13070/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:54.428 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286474319867392,"ephemeral":false}]'
2025-02-11 15:07:54.429 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:07:54.430 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:07:54.431 DEBUG [src.node.waku_node] Stopping container with id 510c5401f66e
2025-02-11 15:07:55.602 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:07:55.603 DEBUG [src.node.waku_node] Stopping container with id 21a83e188d6c
2025-02-11 15:07:56.418 ERROR [src.node.docker_mananger] Max retries reached for container 510c5401f66e. Exiting log stream.
2025-02-11 15:07:57.084 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:07:57.085 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:07:57.091 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:07:57.096 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
