2025-02-11 15:03:17.212 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:03:17.213 DEBUG [tests.conftest] Running test: test_msg_stored_when_ephemeral_false with id: 2025-02-11_15-03-17__67a9b9c0-9b87-4098-aff2-197cf93ca910
2025-02-11 15:03:17.214 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:03:17.215 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 15:03:17.215 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 15:03:17.223 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:17.224 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-03-17__67a9b9c0-9b87-4098-aff2-197cf93ca910__wakuorg_nwaku:latest.log
2025-02-11 15:03:17.230 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:17.230 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-03-17__67a9b9c0-9b87-4098-aff2-197cf93ca910__wakuorg_nwaku:latest.log
2025-02-11 15:03:17.236 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:17.237 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-11_15-03-17__67a9b9c0-9b87-4098-aff2-197cf93ca910__wakuorg_nwaku:latest.log
2025-02-11 15:03:17.237 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:03:17.237 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 15:03:17.238 DEBUG [tests.e2e.test_e2e] Start 3 nodes
2025-02-11 15:03:17.238 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:17.238 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:17.240 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:17.240 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.233.232
2025-02-11 15:03:17.240 DEBUG [src.node.docker_mananger] Generated ports ['11966', '11967', '11968', '11969', '11970']
2025-02-11 15:03:17.241 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:17.241 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:17.241 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:17.241 DEBUG [src.node.docker_mananger] docker run -i -t -p 11966:11966 -p 11967:11967 -p 11968:11968 -p 11969:11969 -p 11970:11970 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11968 --rest-port=11966 --tcp-port=11967 --discv5-udp-port=11969 --rest-address=0.0.0.0 --nat=extip:172.18.233.232 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9fe8fc66dc7ed19dc9bc1e0f9f4dba4ed83215edbaf4b259ffdc6bfd42c7d895 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11970 --metrics-logging=true --relay=true --store=true
2025-02-11 15:03:17.468 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.233.232 waku 3354a059c6baa44a64e7ab86929ae23a9df9fa6af00c49f3bd47976c51cdd582
2025-02-11 15:03:17.517 DEBUG [src.node.docker_mananger] Container started with ID 3354a059c6ba. Setting up logs at ./log/docker/node1_2025-02-11_15-03-17__67a9b9c0-9b87-4098-aff2-197cf93ca910__wakuorg_nwaku:latest.log
2025-02-11 15:03:17.519 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 11966
2025-02-11 15:03:17.519 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:18.033 ERROR [src.node.docker_mananger] Max retries reached for container a743887a66a1. Exiting log stream.
2025-02-11 15:03:18.520 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11966/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:18.522 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:18.523 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:18.523 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11966/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:18.525 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.233.232/tcp/11967/p2p/16Uiu2HAkzEDpJq1A4g9YvEFMK8yToZxnf1u6kYuk1vLDBP1d8QwA","/ip4/172.18.233.232/tcp/11968/ws/p2p/16Uiu2HAkzEDpJq1A4g9YvEFMK8yToZxnf1u6kYuk1vLDBP1d8QwA"],"enrUri":"enr:-L24QAFqJDx1so5cV1oDzShI-y7WY9RJUEWYJe7oLU5euA-tHiHfAYkq0B5NxGqhDdMaOTiqRLHmwZSLhJWt5d7YmFkCgmlkgnY0gmlwhKwS6eiKbXVsdGlhZGRyc5YACASsEunoBi6_AAoErBLp6AYuwN0DgnJzhQADAQAAiXNlY3AyNTZrMaECR1t2Z-Tcd2-XiABd-kZwizCzvCQ-qIwH15gCm6DcWFmDdGNwgi6_g3VkcIIuwYV3YWt1MgM"}'
2025-02-11 15:03:18.525 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:18.525 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:18.526 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:18.527 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:18.527 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.244.91
2025-02-11 15:03:18.527 DEBUG [src.node.docker_mananger] Generated ports ['49037', '49038', '49039', '49040', '49041']
2025-02-11 15:03:18.527 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:18.527 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:18.528 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:18.528 DEBUG [src.node.docker_mananger] docker run -i -t -p 49037:49037 -p 49038:49038 -p 49039:49039 -p 49040:49040 -p 49041:49041 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49039 --rest-port=49037 --tcp-port=49038 --discv5-udp-port=49040 --rest-address=0.0.0.0 --nat=extip:172.18.244.91 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ac6e135caae4b307d4f26c5cf2c4a0b442ef7aca5dcdcabfdeb462c29ac289f4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49041 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QAFqJDx1so5cV1oDzShI-y7WY9RJUEWYJe7oLU5euA-tHiHfAYkq0B5NxGqhDdMaOTiqRLHmwZSLhJWt5d7YmFkCgmlkgnY0gmlwhKwS6eiKbXVsdGlhZGRyc5YACASsEunoBi6_AAoErBLp6AYuwN0DgnJzhQADAQAAiXNlY3AyNTZrMaECR1t2Z-Tcd2-XiABd-kZwizCzvCQ-qIwH15gCm6DcWFmDdGNwgi6_g3VkcIIuwYV3YWt1MgM
2025-02-11 15:03:18.757 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.244.91 waku f24fef1b434418cbe4a815a391a49400d80a548fd1ec78d3015c730ef765b992
2025-02-11 15:03:18.805 DEBUG [src.node.docker_mananger] Container started with ID f24fef1b4344. Setting up logs at ./log/docker/node2_2025-02-11_15-03-17__67a9b9c0-9b87-4098-aff2-197cf93ca910__wakuorg_nwaku:latest.log
2025-02-11 15:03:18.805 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 49037
2025-02-11 15:03:18.807 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:19.807 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49037/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:19.811 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:19.811 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:19.811 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49037/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:19.815 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.244.91/tcp/49038/p2p/16Uiu2HAmVakWPrM76h6DkU9zGn8VxB3jEcFySx2AjnrYjiXs4j7E","/ip4/172.18.244.91/tcp/49039/ws/p2p/16Uiu2HAmVakWPrM76h6DkU9zGn8VxB3jEcFySx2AjnrYjiXs4j7E"],"enrUri":"enr:-L24QERswLR36HmIcGNuRgcxS5NVdSaYKbmi-X1CZI5UejStAVIZpn-HTZqZHAfQWsHDd62XI5oqYZWJBg1Cg_x7MnwCgmlkgnY0gmlwhKwS9FuKbXVsdGlhZGRyc5YACASsEvRbBr-OAAoErBL0Wwa_j90DgnJzhQADAQAAiXNlY3AyNTZrMaED-4CzwMyPar5PhBlNol8ucjozOgjKsh08_q7Io4dN8-mDdGNwgr-Og3VkcIK_kIV3YWt1MgM"}'
2025-02-11 15:03:19.816 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:19.816 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:19.816 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:19.820 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:19.820 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.78.181
2025-02-11 15:03:19.820 DEBUG [src.node.docker_mananger] Generated ports ['54956', '54957', '54958', '54959', '54960']
2025-02-11 15:03:19.820 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:19.820 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:19.821 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:19.821 DEBUG [src.node.docker_mananger] docker run -i -t -p 54956:54956 -p 54957:54957 -p 54958:54958 -p 54959:54959 -p 54960:54960 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54958 --rest-port=54956 --tcp-port=54957 --discv5-udp-port=54959 --rest-address=0.0.0.0 --nat=extip:172.18.78.181 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d9faceee151bc9f9abbe79e4d6ee6dadab1e2edf862c8ec09cbd41aa53d30cb0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54960 --metrics-logging=true --relay=false --storenode=/ip4/172.18.244.91/tcp/49038/p2p/16Uiu2HAmVakWPrM76h6DkU9zGn8VxB3jEcFySx2AjnrYjiXs4j7E --discv5-bootstrap-node=enr:-L24QERswLR36HmIcGNuRgcxS5NVdSaYKbmi-X1CZI5UejStAVIZpn-HTZqZHAfQWsHDd62XI5oqYZWJBg1Cg_x7MnwCgmlkgnY0gmlwhKwS9FuKbXVsdGlhZGRyc5YACASsEvRbBr-OAAoErBL0Wwa_j90DgnJzhQADAQAAiXNlY3AyNTZrMaED-4CzwMyPar5PhBlNol8ucjozOgjKsh08_q7Io4dN8-mDdGNwgr-Og3VkcIK_kIV3YWt1MgM
2025-02-11 15:03:20.080 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.78.181 waku 7c3bd66bd197dbde57271b8cc29254c04fab40796a8b7748c831ede2c3844cf4
2025-02-11 15:03:20.129 DEBUG [src.node.docker_mananger] Container started with ID 7c3bd66bd197. Setting up logs at ./log/docker/node3_2025-02-11_15-03-17__67a9b9c0-9b87-4098-aff2-197cf93ca910__wakuorg_nwaku:latest.log
2025-02-11 15:03:20.129 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54956
2025-02-11 15:03:20.130 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:21.130 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54956/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:21.133 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:21.133 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:21.133 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54956/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:21.136 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.78.181/tcp/54957/p2p/16Uiu2HAmN7ZW1YTvosX8WSxtjfzm8i12EMaXxYHZXRvZK5rPCy3w","/ip4/172.18.78.181/tcp/54958/ws/p2p/16Uiu2HAmN7ZW1YTvosX8WSxtjfzm8i12EMaXxYHZXRvZK5rPCy3w"],"enrUri":"enr:-L24QIc-vx7TRmIo7tocj4hzV1Vz3RrOXv7NTx3s0Frv1bVoNCcLPtpceg1C0uGW-ijju9eDHipt2Hz4LLZMG7wR-rMCgmlkgnY0gmlwhKwSTrWKbXVsdGlhZGRyc5YACASsEk61BtatAAoErBJOtQbWrt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDjIfEP3RjOE0wmHS6ki6TZft16obRCcqhEEsFAVkbC0KDdGNwgtatg3VkcILWr4V3YWt1MgA"}'
2025-02-11 15:03:21.136 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:21.136 DEBUG [tests.e2e.test_e2e] Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
2025-02-11 15:03:21.136 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11966/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:03:21.141 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:21.141 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:49037/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:03:21.146 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:21.147 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11966/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:21.151 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.244.91/tcp/49038/p2p/16Uiu2HAmVakWPrM76h6DkU9zGn8VxB3jEcFySx2AjnrYjiXs4j7E","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
2025-02-11 15:03:21.151 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49037/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:21.154 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.233.232/tcp/11967/p2p/16Uiu2HAkzEDpJq1A4g9YvEFMK8yToZxnf1u6kYuk1vLDBP1d8QwA","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
2025-02-11 15:03:21.154 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-11 15:03:51.155 DEBUG [tests.e2e.test_e2e] Node1 publish message with ephemeral = false
2025-02-11 15:03:51.155 DEBUG [src.steps.store] Relaying message
2025-02-11 15:03:51.156 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2025-02-11 15:03:51.161 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:51.163 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:03:51.363 DEBUG [src.libs.common] Sleeping for 3 seconds
2025-02-11 15:03:54.364 DEBUG [tests.e2e.test_e2e] Check if message is stored 
2025-02-11 15:03:54.364 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:03:54.365 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54956/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:54.409 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"19578b63de240307e323","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x55014a3aa31f0a3f531ec22eae05e1167698eb6a4b0d8953baae5f8df05a3369"}]}'
2025-02-11 15:03:54.417 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:03:54.418 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:03:54.418 DEBUG [src.node.waku_node] Stopping container with id 3354a059c6ba
2025-02-11 15:03:55.337 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:55.337 DEBUG [src.node.waku_node] Stopping container with id f24fef1b4344
2025-02-11 15:03:56.150 ERROR [src.node.docker_mananger] Max retries reached for container 3354a059c6ba. Exiting log stream.
2025-02-11 15:03:56.790 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:56.790 DEBUG [src.node.waku_node] Stopping container with id 7c3bd66bd197
2025-02-11 15:03:57.605 ERROR [src.node.docker_mananger] Max retries reached for container f24fef1b4344. Exiting log stream.
2025-02-11 15:03:57.863 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:57.867 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:03:57.876 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:03:57.889 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:03:57.894 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
