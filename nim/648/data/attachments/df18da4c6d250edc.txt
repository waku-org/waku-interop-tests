2025-02-11 15:04:18.922 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:04:18.923 DEBUG [tests.conftest] Running test: test_light_push_with_with_large_meta with id: 2025-02-11_15-04-18__8a2a1962-8fef-41df-85c0-344e3fee569c
2025-02-11 15:04:18.923 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:04:18.923 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 15:04:18.930 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:18.930 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_15-04-18__8a2a1962-8fef-41df-85c0-344e3fee569c__wakuorg_nwaku:latest.log
2025-02-11 15:04:18.930 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:18.930 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:18.932 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:18.932 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.129.142
2025-02-11 15:04:18.932 DEBUG [src.node.docker_mananger] Generated ports ['2831', '2832', '2833', '2834', '2835']
2025-02-11 15:04:18.932 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:18.932 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:18.933 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:18.933 DEBUG [src.node.docker_mananger] docker run -i -t -p 2831:2831 -p 2832:2832 -p 2833:2833 -p 2834:2834 -p 2835:2835 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2833 --rest-port=2831 --tcp-port=2832 --discv5-udp-port=2834 --rest-address=0.0.0.0 --nat=extip:172.18.129.142 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=555cd9ab88461bf4eedaaec07caf4630d9eacde61a25ae6b4506cc1f76aaca8b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2835 --metrics-logging=true --lightpush=true --relay=true
2025-02-11 15:04:19.164 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.129.142 waku 1550afe74406bed52a79e14cb2a5f6b0c05313f382bfb135dcbc44d203bdd062
2025-02-11 15:04:19.216 DEBUG [src.node.docker_mananger] Container started with ID 1550afe74406. Setting up logs at ./log/docker/receiving_node1_2025-02-11_15-04-18__8a2a1962-8fef-41df-85c0-344e3fee569c__wakuorg_nwaku:latest.log
2025-02-11 15:04:19.216 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 2831
2025-02-11 15:04:19.217 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:19.689 ERROR [src.node.docker_mananger] Max retries reached for container 543a166df896. Exiting log stream.
2025-02-11 15:04:20.217 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2831/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:20.220 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:20.220 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:20.220 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2831/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:20.222 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.129.142/tcp/2832/p2p/16Uiu2HAm47moD2SwwDXCZiors4pKg7aogQu2WYzvVmHTFarsYFTm","/ip4/172.18.129.142/tcp/2833/ws/p2p/16Uiu2HAm47moD2SwwDXCZiors4pKg7aogQu2WYzvVmHTFarsYFTm"],"enrUri":"enr:-L24QKjlUr8uACPUwPvSKvOw_DLmw6o4KiNAbApgeVmimozvKP9fycB-11KwWxPYAjy4zA7kAvHHAXbZXOUR4ZR-VeMCgmlkgnY0gmlwhKwSgY6KbXVsdGlhZGRyc5YACASsEoGOBgsQAAoErBKBjgYLEd0DgnJzhQADAQAAiXNlY3AyNTZrMaECgSNOPhRHDi6-bi3RgTutX5KyF-ktF1wtK0U6jOQnFOCDdGNwggsQg3VkcIILEoV3YWt1Mgk"}'
2025-02-11 15:04:20.223 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:20.229 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:20.229 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-11_15-04-18__8a2a1962-8fef-41df-85c0-344e3fee569c__wakuorg_nwaku:latest.log
2025-02-11 15:04:20.229 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:20.230 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:20.231 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:20.231 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.94.79
2025-02-11 15:04:20.231 DEBUG [src.node.docker_mananger] Generated ports ['15782', '15783', '15784', '15785', '15786']
2025-02-11 15:04:20.231 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:20.231 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:20.232 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:20.232 DEBUG [src.node.docker_mananger] docker run -i -t -p 15782:15782 -p 15783:15783 -p 15784:15784 -p 15785:15785 -p 15786:15786 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15784 --rest-port=15782 --tcp-port=15783 --discv5-udp-port=15785 --rest-address=0.0.0.0 --nat=extip:172.18.94.79 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c2eaca7aafce1e8ceb8f4cb4bdffbeea6649f96bc2f1829b2af354650a7de94c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15786 --metrics-logging=true --lightpush=false --relay=true
2025-02-11 15:04:20.463 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.94.79 waku 0cd4a6d6a0a324a82245f0df72448c264936e49bb7d56c7a72bd1b578ede60b3
2025-02-11 15:04:20.510 DEBUG [src.node.docker_mananger] Container started with ID 0cd4a6d6a0a3. Setting up logs at ./log/docker/receiving_node2_2025-02-11_15-04-18__8a2a1962-8fef-41df-85c0-344e3fee569c__wakuorg_nwaku:latest.log
2025-02-11 15:04:20.511 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15782
2025-02-11 15:04:20.511 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:21.511 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15782/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:21.514 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:21.515 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:21.515 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15782/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:21.517 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.94.79/tcp/15783/p2p/16Uiu2HAm6VHu1ZHjxd4izQyjFGqzduG3s4FN3v6zHgmFyMGWS4er","/ip4/172.18.94.79/tcp/15784/ws/p2p/16Uiu2HAm6VHu1ZHjxd4izQyjFGqzduG3s4FN3v6zHgmFyMGWS4er"],"enrUri":"enr:-L24QC1e6Dj-1lxrqdZ0B0GcN8fTKPN9HuCg5_fG3aHRKzrBZaN2b4X5jWUs9WTLf8HqxM6-JGlORqqskRxigsevcgACgmlkgnY0gmlwhKwSXk-KbXVsdGlhZGRyc5YACASsEl5PBj2nAAoErBJeTwY9qN0DgnJzhQADAQAAiXNlY3AyNTZrMaECpF3pI7Ba89lsaJy7z4-JlQESmfwCFxqbL0cMdgVw2BeDdGNwgj2ng3VkcII9qYV3YWt1MgE"}'
2025-02-11 15:04:21.517 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:21.517 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15782/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.129.142/tcp/2832/p2p/16Uiu2HAm47moD2SwwDXCZiors4pKg7aogQu2WYzvVmHTFarsYFTm"]'
2025-02-11 15:04:21.557 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:21.566 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:21.566 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_15-04-18__8a2a1962-8fef-41df-85c0-344e3fee569c__wakuorg_nwaku:latest.log
2025-02-11 15:04:21.566 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:21.567 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:21.568 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:21.568 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.80.223
2025-02-11 15:04:21.568 DEBUG [src.node.docker_mananger] Generated ports ['44505', '44506', '44507', '44508', '44509']
2025-02-11 15:04:21.569 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:21.569 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:21.569 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:21.569 DEBUG [src.node.docker_mananger] docker run -i -t -p 44505:44505 -p 44506:44506 -p 44507:44507 -p 44508:44508 -p 44509:44509 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44507 --rest-port=44505 --tcp-port=44506 --discv5-udp-port=44508 --rest-address=0.0.0.0 --nat=extip:172.18.80.223 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1b1fcfb33b8bc2d08ec4076ecbf18b63e72d7b7b9f3cc1a2598e397dcea9eaf1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44509 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QKjlUr8uACPUwPvSKvOw_DLmw6o4KiNAbApgeVmimozvKP9fycB-11KwWxPYAjy4zA7kAvHHAXbZXOUR4ZR-VeMCgmlkgnY0gmlwhKwSgY6KbXVsdGlhZGRyc5YACASsEoGOBgsQAAoErBKBjgYLEd0DgnJzhQADAQAAiXNlY3AyNTZrMaECgSNOPhRHDi6-bi3RgTutX5KyF-ktF1wtK0U6jOQnFOCDdGNwggsQg3VkcIILEoV3YWt1Mgk --lightpushnode=/ip4/172.18.129.142/tcp/2832/p2p/16Uiu2HAm47moD2SwwDXCZiors4pKg7aogQu2WYzvVmHTFarsYFTm --lightpush=true --relay=false
2025-02-11 15:04:21.806 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.80.223 waku fdd53e375eeb7552382631c085ac209dcce216a6452fffd519bcb9ddb4c379db
2025-02-11 15:04:21.855 DEBUG [src.node.docker_mananger] Container started with ID fdd53e375eeb. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_15-04-18__8a2a1962-8fef-41df-85c0-344e3fee569c__wakuorg_nwaku:latest.log
2025-02-11 15:04:21.856 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44505
2025-02-11 15:04:21.856 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:22.856 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44505/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:22.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:22.860 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:22.860 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44505/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:22.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.80.223/tcp/44506/p2p/16Uiu2HAmPrZBccr99J3hkpRTdkJ1dYo5Yw6gxYY9J9748vV8sfUo","/ip4/172.18.80.223/tcp/44507/ws/p2p/16Uiu2HAmPrZBccr99J3hkpRTdkJ1dYo5Yw6gxYY9J9748vV8sfUo"],"enrUri":"enr:-L24QJy5Mnpsy-jMUgxtbMrqzv19SlPOBqW9hukAK0Q9JyWbca30XehDcMZ-gMRYWvPr97nmW2dj-ejn1G1KNCnBZosCgmlkgnY0gmlwhKwSUN-KbXVsdGlhZGRyc5YACASsElDfBq3aAAoErBJQ3wat290DgnJzhQADAQAAiXNlY3AyNTZrMaEDpmcR16DG5_CAg72NQmDdH9HUMonZ1w74QCE_1FbsqiSDdGNwgq3ag3VkcIKt3IV3YWt1Mgg"}'
2025-02-11 15:04:22.862 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:22.862 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44505/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.129.142/tcp/2832/p2p/16Uiu2HAm47moD2SwwDXCZiors4pKg7aogQu2WYzvVmHTFarsYFTm"]'
2025-02-11 15:04:22.899 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:22.903 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44505/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.94.79/tcp/15783/p2p/16Uiu2HAm6VHu1ZHjxd4izQyjFGqzduG3s4FN3v6zHgmFyMGWS4er"]'
2025-02-11 15:04:22.929 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:22.929 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2831/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:04:22.935 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:22.936 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15782/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:04:22.941 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:22.944 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 15:04:22.945 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44505/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739286262944449792, "meta": "YWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYQ=="}}'
2025-02-11 15:04:22.956 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:44505/lightpush/v1/message. Response content: b'Failed to request a message push: decode_rpc_failure: (kind: InvalidLengthField, field: "meta")'
2025-02-11 15:04:22.958 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:04:22.959 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:04:22.959 DEBUG [src.node.waku_node] Stopping container with id 1550afe74406
2025-02-11 15:04:23.720 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:23.720 DEBUG [src.node.waku_node] Stopping container with id 0cd4a6d6a0a3
2025-02-11 15:04:24.554 ERROR [src.node.docker_mananger] Max retries reached for container 1550afe74406. Exiting log stream.
2025-02-11 15:04:25.175 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:25.175 DEBUG [src.node.waku_node] Stopping container with id fdd53e375eeb
2025-02-11 15:04:26.006 ERROR [src.node.docker_mananger] Max retries reached for container 0cd4a6d6a0a3. Exiting log stream.
2025-02-11 15:04:26.674 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:26.676 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:04:26.690 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:26.703 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:26.709 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
