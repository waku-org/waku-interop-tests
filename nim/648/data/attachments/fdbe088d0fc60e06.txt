2025-02-11 15:09:02.315 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:09:02.315 DEBUG [tests.conftest] Running test: test_store_with_wrong_url_pubsub_topic with id: 2025-02-11_15-09-02__effb89ca-986a-4fd9-a2f0-95bd82bbdc2b
2025-02-11 15:09:02.315 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:09:02.315 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 15:09:02.316 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-11 15:09:02.325 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:09:02.325 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-11_15-09-02__effb89ca-986a-4fd9-a2f0-95bd82bbdc2b__wakuorg_nwaku:latest.log
2025-02-11 15:09:02.325 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:09:02.325 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:09:02.327 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:09:02.327 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.119.1
2025-02-11 15:09:02.327 DEBUG [src.node.docker_mananger] Generated ports ['18583', '18584', '18585', '18586', '18587']
2025-02-11 15:09:02.327 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:09:02.327 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:09:02.328 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:09:02.328 DEBUG [src.node.docker_mananger] docker run -i -t -p 18583:18583 -p 18584:18584 -p 18585:18585 -p 18586:18586 -p 18587:18587 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18585 --rest-port=18583 --tcp-port=18584 --discv5-udp-port=18586 --rest-address=0.0.0.0 --nat=extip:172.18.119.1 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c9a617c1ad6bdfe2ecffd54e2dc2f90cf0cdaaed64c9ebbae9bd0ba7af174903 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18587 --metrics-logging=true --store=true --relay=true
2025-02-11 15:09:02.562 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.119.1 waku 27d13cb59dd2cf3891d024ee4b0a0be471529ef78c24a9a2e32f8016a70833a6
2025-02-11 15:09:02.614 DEBUG [src.node.docker_mananger] Container started with ID 27d13cb59dd2. Setting up logs at ./log/docker/publishing_node1_2025-02-11_15-09-02__effb89ca-986a-4fd9-a2f0-95bd82bbdc2b__wakuorg_nwaku:latest.log
2025-02-11 15:09:02.615 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 18583
2025-02-11 15:09:02.615 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:09:03.122 ERROR [src.node.docker_mananger] Max retries reached for container 328f40b40d2f. Exiting log stream.
2025-02-11 15:09:03.615 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18583/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:09:03.618 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:09:03.619 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:09:03.619 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18583/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:09:03.621 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.119.1/tcp/18584/p2p/16Uiu2HAmLoJBGdDpWNDuFEPMZ9Jj5zVf3jv6Wpd6D9wkTBmcrHVA","/ip4/172.18.119.1/tcp/18585/ws/p2p/16Uiu2HAmLoJBGdDpWNDuFEPMZ9Jj5zVf3jv6Wpd6D9wkTBmcrHVA"],"enrUri":"enr:-L24QLa1fKvotfOtnYKnYbV6B-Y5GtyUig04dx3uj-GH0XGST6NP4b2SLBXyhtucb9Wns2UNQFpobP83T_8zN1SJREUCgmlkgnY0gmlwhKwSdwGKbXVsdGlhZGRyc5YACASsEncBBkiYAAoErBJ3AQZImd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeP5MmWnyMod54TjTeNu11d6tTVm6g3QfZQKfAHs3QXmDdGNwgkiYg3VkcIJImoV3YWt1MgM"}'
2025-02-11 15:09:03.621 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:09:03.628 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:09:03.629 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-11_15-09-02__effb89ca-986a-4fd9-a2f0-95bd82bbdc2b__wakuorg_nwaku:latest.log
2025-02-11 15:09:03.629 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:09:03.629 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:09:03.630 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:09:03.631 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.77.188
2025-02-11 15:09:03.631 DEBUG [src.node.docker_mananger] Generated ports ['30388', '30389', '30390', '30391', '30392']
2025-02-11 15:09:03.631 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:09:03.631 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:09:03.631 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:09:03.631 DEBUG [src.node.docker_mananger] docker run -i -t -p 30388:30388 -p 30389:30389 -p 30390:30390 -p 30391:30391 -p 30392:30392 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30390 --rest-port=30388 --tcp-port=30389 --discv5-udp-port=30391 --rest-address=0.0.0.0 --nat=extip:172.18.77.188 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9d17fcf191b4a1abf03c4b76a73a2a7d357a5bf5f5fc9f43eddb0ad5ccf12bd7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30392 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QLa1fKvotfOtnYKnYbV6B-Y5GtyUig04dx3uj-GH0XGST6NP4b2SLBXyhtucb9Wns2UNQFpobP83T_8zN1SJREUCgmlkgnY0gmlwhKwSdwGKbXVsdGlhZGRyc5YACASsEncBBkiYAAoErBJ3AQZImd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeP5MmWnyMod54TjTeNu11d6tTVm6g3QfZQKfAHs3QXmDdGNwgkiYg3VkcIJImoV3YWt1MgM --storenode=/ip4/172.18.119.1/tcp/18584/p2p/16Uiu2HAmLoJBGdDpWNDuFEPMZ9Jj5zVf3jv6Wpd6D9wkTBmcrHVA --store=true --relay=true
2025-02-11 15:09:03.866 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.77.188 waku 63fc5734294465bad972a7013d0ac2fbd189c310ee7a825338af7666c4383046
2025-02-11 15:09:03.921 DEBUG [src.node.docker_mananger] Container started with ID 63fc57342944. Setting up logs at ./log/docker/store_node1_2025-02-11_15-09-02__effb89ca-986a-4fd9-a2f0-95bd82bbdc2b__wakuorg_nwaku:latest.log
2025-02-11 15:09:03.922 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30388
2025-02-11 15:09:03.922 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:09:04.923 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30388/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:09:04.926 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:09:04.926 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:09:04.926 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30388/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:09:04.929 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.77.188/tcp/30389/p2p/16Uiu2HAmMMRehzfhHRxyB6DZVMMT4kPBpYGPycT6GPJySC2DEbKB","/ip4/172.18.77.188/tcp/30390/ws/p2p/16Uiu2HAmMMRehzfhHRxyB6DZVMMT4kPBpYGPycT6GPJySC2DEbKB"],"enrUri":"enr:-L24QKU1OCLpGp33fY6lHAReD4SDESeb7m-Rw0-YFtCFMPuJPTpIF7DKWnfyCJaqUF_oO5sCQ_iBtwsqYadvuROhrDICgmlkgnY0gmlwhKwSTbyKbXVsdGlhZGRyc5YACASsEk28Bna1AAoErBJNvAZ2tt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDgTlVvV7x4n5-1vQkxkUjkbIY4E0FxCMWa06uHXArJo6DdGNwgna1g3VkcIJ2t4V3YWt1MgM"}'
2025-02-11 15:09:04.929 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:09:04.929 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30388/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.119.1/tcp/18584/p2p/16Uiu2HAmLoJBGdDpWNDuFEPMZ9Jj5zVf3jv6Wpd6D9wkTBmcrHVA"]'
2025-02-11 15:09:04.932 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:04.932 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:09:04.934 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:04.935 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30388/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:09:04.937 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:04.937 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:04.938 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:04.944 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:04.945 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:05.146 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:05.146 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/waku/2/content/test.js", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:05.152 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:05.153 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:05.354 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:05.354 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/22/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:05.360 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:05.361 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:05.562 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:05.562 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:05.568 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:05.569 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:05.770 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:05.771 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/statusim/1/community/cbor", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:05.777 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:05.778 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:05.979 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:05.979 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/27/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:05.985 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:05.986 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:06.187 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:06.187 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/29/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:06.193 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:06.193 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:06.394 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:06.394 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/20/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:06.401 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:06.401 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:06.603 DEBUG [tests.store.test_topics] Trying to get stored msg with wrong url topic waku/2/rs/3/0
2025-02-11 15:09:06.603 DEBUG [src.steps.store] Relaying message
2025-02-11 15:09:06.603 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18583/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:09:06.610 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:09:06.610 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:09:06.811 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:09:06.812 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18583/store/v3/messages?pubsubTopic=waku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:09:06.815 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-11 15:09:06.815 ERROR [tests.store.test_topics] Topic waku/2/rs/3/0 is wrong ''n: Peer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
2025-02-11 15:09:06.818 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:09:06.819 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:09:06.819 DEBUG [src.node.waku_node] Stopping container with id 27d13cb59dd2
2025-02-11 15:09:08.168 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:09:08.168 DEBUG [src.node.waku_node] Stopping container with id 63fc57342944
2025-02-11 15:09:08.981 ERROR [src.node.docker_mananger] Max retries reached for container 27d13cb59dd2. Exiting log stream.
2025-02-11 15:09:09.677 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:09:09.678 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:09:09.686 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:09:09.693 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
