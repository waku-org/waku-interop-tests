2025-02-11 15:03:08.733 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:03:08.733 DEBUG [tests.conftest] Running test: test_relay_receiving_node_not_connected_directly_to_lightpushing_node with id: 2025-02-11_15-03-08__0073f5d7-fb4e-46fb-ac1f-23d200c0b68b
2025-02-11 15:03:08.733 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:03:08.734 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 15:03:08.734 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 15:03:08.740 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:08.741 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-03-08__0073f5d7-fb4e-46fb-ac1f-23d200c0b68b__wakuorg_nwaku:latest.log
2025-02-11 15:03:08.747 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:08.747 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-03-08__0073f5d7-fb4e-46fb-ac1f-23d200c0b68b__wakuorg_nwaku:latest.log
2025-02-11 15:03:08.753 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:08.754 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-11_15-03-08__0073f5d7-fb4e-46fb-ac1f-23d200c0b68b__wakuorg_nwaku:latest.log
2025-02-11 15:03:08.754 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:03:08.754 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 15:03:08.755 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:08.755 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:08.756 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:08.757 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.146.44
2025-02-11 15:03:08.757 DEBUG [src.node.docker_mananger] Generated ports ['41943', '41944', '41945', '41946', '41947']
2025-02-11 15:03:08.757 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:08.757 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:08.757 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:08.757 DEBUG [src.node.docker_mananger] docker run -i -t -p 41943:41943 -p 41944:41944 -p 41945:41945 -p 41946:41946 -p 41947:41947 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=41945 --rest-port=41943 --tcp-port=41944 --discv5-udp-port=41946 --rest-address=0.0.0.0 --nat=extip:172.18.146.44 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1d34ef74ac3e1f0e7cd770c12bafb40e93a8c80cfde5aefb04cefb51b8ef95cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=41947 --metrics-logging=true --lightpush=true --relay=true
2025-02-11 15:03:08.986 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.146.44 waku 360291cc931e20bb82fb1158d76a79c42244884b2acb5a3744321f7c9555eb01
2025-02-11 15:03:09.034 DEBUG [src.node.docker_mananger] Container started with ID 360291cc931e. Setting up logs at ./log/docker/node1_2025-02-11_15-03-08__0073f5d7-fb4e-46fb-ac1f-23d200c0b68b__wakuorg_nwaku:latest.log
2025-02-11 15:03:09.034 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 41943
2025-02-11 15:03:09.034 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:09.526 ERROR [src.node.docker_mananger] Max retries reached for container 20282327a1c5. Exiting log stream.
2025-02-11 15:03:10.035 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41943/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:10.038 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:10.038 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:10.039 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41943/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:10.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.146.44/tcp/41944/p2p/16Uiu2HAmQ4eL1xEienBa5Fp6qyA6AdiY5L2ppKkPpJE6Th7GsAtV","/ip4/172.18.146.44/tcp/41945/ws/p2p/16Uiu2HAmQ4eL1xEienBa5Fp6qyA6AdiY5L2ppKkPpJE6Th7GsAtV"],"enrUri":"enr:-L24QC50wLZGhOEzisOw7zMhOqtb6R_e9vEWleuylZ95hkVBG_UmC82obYAFfJkv9t1942iXA-OIbDDizBAdim2_1gQCgmlkgnY0gmlwhKwSkiyKbXVsdGlhZGRyc5YACASsEpIsBqPYAAoErBKSLAaj2d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDqX_bUl6fnJYkmOgTLv3SIE28Lth1IpQGQrj29FzT4W6DdGNwgqPYg3VkcIKj2oV3YWt1Mgk"}'
2025-02-11 15:03:10.041 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:10.041 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:10.041 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:10.043 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:10.043 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.189.231
2025-02-11 15:03:10.043 DEBUG [src.node.docker_mananger] Generated ports ['17658', '17659', '17660', '17661', '17662']
2025-02-11 15:03:10.043 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:10.043 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:10.043 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:10.044 DEBUG [src.node.docker_mananger] docker run -i -t -p 17658:17658 -p 17659:17659 -p 17660:17660 -p 17661:17661 -p 17662:17662 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17660 --rest-port=17658 --tcp-port=17659 --discv5-udp-port=17661 --rest-address=0.0.0.0 --nat=extip:172.18.189.231 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b6cdbdb5deafd5bcdd1e1747c2f9c650756af8c5dc78638cbba5cefa5b7abebc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17662 --metrics-logging=true --lightpush=true --relay=true --discv5-bootstrap-node=enr:-L24QC50wLZGhOEzisOw7zMhOqtb6R_e9vEWleuylZ95hkVBG_UmC82obYAFfJkv9t1942iXA-OIbDDizBAdim2_1gQCgmlkgnY0gmlwhKwSkiyKbXVsdGlhZGRyc5YACASsEpIsBqPYAAoErBKSLAaj2d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDqX_bUl6fnJYkmOgTLv3SIE28Lth1IpQGQrj29FzT4W6DdGNwgqPYg3VkcIKj2oV3YWt1Mgk --lightpushnode=/ip4/172.18.146.44/tcp/41944/p2p/16Uiu2HAmQ4eL1xEienBa5Fp6qyA6AdiY5L2ppKkPpJE6Th7GsAtV
2025-02-11 15:03:10.276 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.189.231 waku 827cb6195735bca2dcf65aec760d5f2df3a70d199d624edbd0512c138e875e52
2025-02-11 15:03:10.326 DEBUG [src.node.docker_mananger] Container started with ID 827cb6195735. Setting up logs at ./log/docker/node2_2025-02-11_15-03-08__0073f5d7-fb4e-46fb-ac1f-23d200c0b68b__wakuorg_nwaku:latest.log
2025-02-11 15:03:10.326 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17658
2025-02-11 15:03:10.326 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:11.327 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17658/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:11.330 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:11.330 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:11.331 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17658/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:11.333 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.189.231/tcp/17659/p2p/16Uiu2HAkvSmn9zADSHcKq3bihctkXmhUtMMLuyYfKTnzhaHcwj6B","/ip4/172.18.189.231/tcp/17660/ws/p2p/16Uiu2HAkvSmn9zADSHcKq3bihctkXmhUtMMLuyYfKTnzhaHcwj6B"],"enrUri":"enr:-L24QP_9QXwJjtpzzjDhp-aqLPu9ZwT7UqYMw2cvVO6MEw8qKPO0NnJaCcFVlbh5WmT1S6UqVgAZlW1v9xYVkZUsIXkCgmlkgnY0gmlwhKwSveeKbXVsdGlhZGRyc5YACASsEr3nBkT7AAoErBK95wZE_N0DgnJzhQADAQAAiXNlY3AyNTZrMaECDyPTOG7lI1cfsN_TlccgQ-9Nl3a2ZR0m2aINdUq8BfSDdGNwgkT7g3VkcIJE_YV3YWt1Mgk"}'
2025-02-11 15:03:11.333 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:11.333 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:11.333 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:11.335 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:11.335 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.212.177
2025-02-11 15:03:11.335 DEBUG [src.node.docker_mananger] Generated ports ['31252', '31253', '31254', '31255', '31256']
2025-02-11 15:03:11.335 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:11.336 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:11.336 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:11.336 DEBUG [src.node.docker_mananger] docker run -i -t -p 31252:31252 -p 31253:31253 -p 31254:31254 -p 31255:31255 -p 31256:31256 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31254 --rest-port=31252 --tcp-port=31253 --discv5-udp-port=31255 --rest-address=0.0.0.0 --nat=extip:172.18.212.177 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=64abd1ffd6efdadc69d9c2634deeaded335f1c2efefeeecab5e37eb1a9b2d0db --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31256 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QP_9QXwJjtpzzjDhp-aqLPu9ZwT7UqYMw2cvVO6MEw8qKPO0NnJaCcFVlbh5WmT1S6UqVgAZlW1v9xYVkZUsIXkCgmlkgnY0gmlwhKwSveeKbXVsdGlhZGRyc5YACASsEr3nBkT7AAoErBK95wZE_N0DgnJzhQADAQAAiXNlY3AyNTZrMaECDyPTOG7lI1cfsN_TlccgQ-9Nl3a2ZR0m2aINdUq8BfSDdGNwgkT7g3VkcIJE_YV3YWt1Mgk
2025-02-11 15:03:11.568 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.212.177 waku 504d13d1f9757f65ea196bab865d785128c61c9bc16534703f6d16d9ffea4f1c
2025-02-11 15:03:11.625 DEBUG [src.node.docker_mananger] Container started with ID 504d13d1f975. Setting up logs at ./log/docker/node3_2025-02-11_15-03-08__0073f5d7-fb4e-46fb-ac1f-23d200c0b68b__wakuorg_nwaku:latest.log
2025-02-11 15:03:11.625 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31252
2025-02-11 15:03:11.626 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:12.626 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31252/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:12.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:12.633 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:12.634 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31252/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:12.638 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.212.177/tcp/31253/p2p/16Uiu2HAmRVtGS6fty3i3V6w5KSSzu9MfCbyUYvhoM1UVR5WcV3eR","/ip4/172.18.212.177/tcp/31254/ws/p2p/16Uiu2HAmRVtGS6fty3i3V6w5KSSzu9MfCbyUYvhoM1UVR5WcV3eR"],"enrUri":"enr:-L24QMCWbIjMV7NfvS5JmEtJGpoXu4hGVSEhyEa2L9o_HrjYCi1Fr5gkbH-ew1qKzAe25AWUXrcOsUn4kxBNtqnzPbkCgmlkgnY0gmlwhKwS1LGKbXVsdGlhZGRyc5YACASsEtSxBnoVAAoErBLUsQZ6Ft0DgnJzhQADAQAAiXNlY3AyNTZrMaEDvtLS6NkEr2dHuqLsctU4FGoM8NwLi3OSFxQbg1KACnKDdGNwgnoVg3VkcIJ6F4V3YWt1MgE"}'
2025-02-11 15:03:12.639 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:12.639 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41943/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:03:12.660 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:12.660 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17658/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:03:12.664 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:12.665 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31252/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:03:12.671 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:12.672 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41943/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:12.676 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-11 15:03:13.677 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41943/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:13.680 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-11 15:03:14.680 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41943/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:14.684 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.189.231/tcp/17659/p2p/16Uiu2HAkvSmn9zADSHcKq3bihctkXmhUtMMLuyYfKTnzhaHcwj6B","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":false},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":false}],"origin":"Discv5"}]'
2025-02-11 15:03:14.684 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17658/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:14.687 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.212.177/tcp/31253/p2p/16Uiu2HAmRVtGS6fty3i3V6w5KSSzu9MfCbyUYvhoM1UVR5WcV3eR","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"},{"multiaddr":"/ip4/172.18.146.44/tcp/41944/p2p/16Uiu2HAmQ4eL1xEienBa5Fp6qyA6AdiY5L2ppKkPpJE6Th7GsAtV","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":false},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":false}],"origin":"Discv5"}]'
2025-02-11 15:03:14.687 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31252/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:14.689 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.189.231/tcp/17659/p2p/16Uiu2HAkvSmn9zADSHcKq3bihctkXmhUtMMLuyYfKTnzhaHcwj6B","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
2025-02-11 15:03:14.689 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-11 15:03:44.690 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 15:03:44.691 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41943/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": 1739286224690687488}}'
2025-02-11 15:03:44.706 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:44.706 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:44.807 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-11 15:03:44.807 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31252/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:44.810 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739286224690687488,"ephemeral":false}]'
2025-02-11 15:03:44.813 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:03:44.814 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:03:44.814 DEBUG [src.node.waku_node] Stopping container with id 360291cc931e
2025-02-11 15:03:45.629 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:45.629 DEBUG [src.node.waku_node] Stopping container with id 827cb6195735
2025-02-11 15:03:46.491 ERROR [src.node.docker_mananger] Max retries reached for container 360291cc931e. Exiting log stream.
2025-02-11 15:03:46.834 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:46.835 DEBUG [src.node.waku_node] Stopping container with id 504d13d1f975
2025-02-11 15:03:47.647 ERROR [src.node.docker_mananger] Max retries reached for container 827cb6195735. Exiting log stream.
2025-02-11 15:03:48.099 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:48.101 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:03:48.132 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:03:48.147 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:03:48.162 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
