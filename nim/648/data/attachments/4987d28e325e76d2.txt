2025-02-11 15:04:59.178 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:04:59.178 DEBUG [tests.conftest] Running test: test_relay_subscribe_to_already_existing_pubsub_topic with id: 2025-02-11_15-04-59__47fa644c-b733-46f7-861b-247bfd1bca76
2025-02-11 15:04:59.178 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:04:59.178 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:04:59.179 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 15:04:59.185 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:59.185 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-04-59__47fa644c-b733-46f7-861b-247bfd1bca76__wakuorg_nwaku:latest.log
2025-02-11 15:04:59.186 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:59.186 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:59.187 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:59.187 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.31
2025-02-11 15:04:59.188 DEBUG [src.node.docker_mananger] Generated ports ['16953', '16954', '16955', '16956', '16957']
2025-02-11 15:04:59.188 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:59.188 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:59.188 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:59.188 DEBUG [src.node.docker_mananger] docker run -i -t -p 16953:16953 -p 16954:16954 -p 16955:16955 -p 16956:16956 -p 16957:16957 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16955 --rest-port=16953 --tcp-port=16954 --discv5-udp-port=16956 --rest-address=0.0.0.0 --nat=extip:172.18.254.31 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fc9472ebf52ec78d350bfc05aed4a0faa74bfc4af8ec61eacd0ad42d42b0cfb0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16957 --metrics-logging=true --relay=true
2025-02-11 15:04:59.433 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.31 waku 6ff7b947e87916631f6bbbc1edeb47f8e8a1c1764bd02f5e84919be2a1fd3908
2025-02-11 15:04:59.482 DEBUG [src.node.docker_mananger] Container started with ID 6ff7b947e879. Setting up logs at ./log/docker/node1_2025-02-11_15-04-59__47fa644c-b733-46f7-861b-247bfd1bca76__wakuorg_nwaku:latest.log
2025-02-11 15:04:59.483 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16953
2025-02-11 15:04:59.484 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:59.966 ERROR [src.node.docker_mananger] Max retries reached for container 9432c0d66a70. Exiting log stream.
2025-02-11 15:05:00.485 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16953/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:00.488 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:05:00.488 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:05:00.489 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16953/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:00.491 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.31/tcp/16954/p2p/16Uiu2HAmVUfjmvUqj3FSFbXpGdQ4jwfxPuuMya3xqN1gjjdLiDAT","/ip4/172.18.254.31/tcp/16955/ws/p2p/16Uiu2HAmVUfjmvUqj3FSFbXpGdQ4jwfxPuuMya3xqN1gjjdLiDAT"],"enrUri":"enr:-L24QI_kVUtjoIHJK249wnL7wQYm2wRDJh3r2SN40CpavxC0NwtQPi2jufhRwCtISEpG8eN4fBrZxQfxUM146gWmfpsCgmlkgnY0gmlwhKwS_h-KbXVsdGlhZGRyc5YACASsEv4fBkI6AAoErBL-HwZCO90DgnJzhQADAQAAiXNlY3AyNTZrMaED-fHTG6BDE-I0qG_xGmaYC7sN8cCRCByb99VGt8qZvWyDdGNwgkI6g3VkcIJCPIV3YWt1MgE"}'
2025-02-11 15:05:00.491 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:05:00.498 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:05:00.498 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-04-59__47fa644c-b733-46f7-861b-247bfd1bca76__wakuorg_nwaku:latest.log
2025-02-11 15:05:00.499 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:05:00.499 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:05:00.500 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:05:00.500 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.31.214
2025-02-11 15:05:00.500 DEBUG [src.node.docker_mananger] Generated ports ['54237', '54238', '54239', '54240', '54241']
2025-02-11 15:05:00.501 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:05:00.501 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:05:00.501 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:05:00.501 DEBUG [src.node.docker_mananger] docker run -i -t -p 54237:54237 -p 54238:54238 -p 54239:54239 -p 54240:54240 -p 54241:54241 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54239 --rest-port=54237 --tcp-port=54238 --discv5-udp-port=54240 --rest-address=0.0.0.0 --nat=extip:172.18.31.214 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1b9ca3c57e9cd44cbfb9d2faca7abf3d86ddaef64ccb5b3d3aa1acef672ac768 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54241 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QI_kVUtjoIHJK249wnL7wQYm2wRDJh3r2SN40CpavxC0NwtQPi2jufhRwCtISEpG8eN4fBrZxQfxUM146gWmfpsCgmlkgnY0gmlwhKwS_h-KbXVsdGlhZGRyc5YACASsEv4fBkI6AAoErBL-HwZCO90DgnJzhQADAQAAiXNlY3AyNTZrMaED-fHTG6BDE-I0qG_xGmaYC7sN8cCRCByb99VGt8qZvWyDdGNwgkI6g3VkcIJCPIV3YWt1MgE
2025-02-11 15:05:00.747 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.31.214 waku c7f1e1ffe1562a7e126429f3af6418172f52d4c214d0d0da46ede141242769f8
2025-02-11 15:05:00.798 DEBUG [src.node.docker_mananger] Container started with ID c7f1e1ffe156. Setting up logs at ./log/docker/node2_2025-02-11_15-04-59__47fa644c-b733-46f7-861b-247bfd1bca76__wakuorg_nwaku:latest.log
2025-02-11 15:05:00.799 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54237
2025-02-11 15:05:00.799 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:05:01.799 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54237/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:01.813 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:05:01.816 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:05:01.817 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54237/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:01.821 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.31.214/tcp/54238/p2p/16Uiu2HAmRj7XogJq5Tp1HffxVJz3LQJMj1q7JutzTawJumFjSc9b","/ip4/172.18.31.214/tcp/54239/ws/p2p/16Uiu2HAmRj7XogJq5Tp1HffxVJz3LQJMj1q7JutzTawJumFjSc9b"],"enrUri":"enr:-L24QELOBMkBQuQ8Hi3XA2KG6UK4dWlq2Y31rqnACS-P_priJ5yrQt47PpuAr_OTAQRWZH16-mBybKFbabJ-pv_S084CgmlkgnY0gmlwhKwSH9aKbXVsdGlhZGRyc5YACASsEh_WBtPeAAoErBIf1gbT390DgnJzhQADAQAAiXNlY3AyNTZrMaEDwjZfin_VYV61CO8Cio_M0gawQR2SUjnxFfPxeeSGVSaDdGNwgtPeg3VkcILT4IV3YWt1MgE"}'
2025-02-11 15:05:01.821 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:05:01.822 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54237/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.254.31/tcp/16954/p2p/16Uiu2HAmVUfjmvUqj3FSFbXpGdQ4jwfxPuuMya3xqN1gjjdLiDAT"]'
2025-02-11 15:05:01.825 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:01.826 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16953/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:05:01.830 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:01.831 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54237/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:05:01.837 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:01.838 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16953/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:05:01.843 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:01.844 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:05:01.944 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:05:01.945 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16953/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:01.948 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286301837995264,"ephemeral":false}]'
2025-02-11 15:05:01.950 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:05:01.950 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54237/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:01.953 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286301837995264,"ephemeral":false}]'
2025-02-11 15:05:01.954 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16953/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:05:01.957 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:01.957 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54237/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:05:01.959 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:01.960 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16953/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:05:01.964 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:01.964 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:05:02.065 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:05:02.066 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16953/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:02.069 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286301960076800,"ephemeral":false}]'
2025-02-11 15:05:02.071 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:05:02.071 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54237/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:02.074 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286301960076800,"ephemeral":false}]'
2025-02-11 15:05:02.077 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:05:02.078 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:05:02.078 DEBUG [src.node.waku_node] Stopping container with id 6ff7b947e879
2025-02-11 15:05:03.013 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:05:03.013 DEBUG [src.node.waku_node] Stopping container with id c7f1e1ffe156
2025-02-11 15:05:03.847 ERROR [src.node.docker_mananger] Max retries reached for container 6ff7b947e879. Exiting log stream.
2025-02-11 15:05:04.567 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:05:04.568 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:05:04.578 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:05:04.585 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
