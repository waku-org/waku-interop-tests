2025-02-11 15:04:25.213 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:04:25.214 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_full with id: 2025-02-11_15-04-25__5024ffab-40b2-4b43-bb16-d1f3cb4f4bc8
2025-02-11 15:04:25.214 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:04:25.214 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 15:04:25.221 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:25.221 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_15-04-25__5024ffab-40b2-4b43-bb16-d1f3cb4f4bc8__wakuorg_nwaku:latest.log
2025-02-11 15:04:25.221 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:25.221 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:25.222 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:25.223 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.219.190
2025-02-11 15:04:25.223 DEBUG [src.node.docker_mananger] Generated ports ['54727', '54728', '54729', '54730', '54731']
2025-02-11 15:04:25.223 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:25.223 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:25.223 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:25.223 DEBUG [src.node.docker_mananger] docker run -i -t -p 54727:54727 -p 54728:54728 -p 54729:54729 -p 54730:54730 -p 54731:54731 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54729 --rest-port=54727 --tcp-port=54728 --discv5-udp-port=54730 --rest-address=0.0.0.0 --nat=extip:172.18.219.190 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0afddfba64bf94bd5f96ea82fe1786f4ddf76ffb2926c7457a432071cddae324 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54731 --metrics-logging=true --lightpush=true --relay=true --filter=true
2025-02-11 15:04:25.455 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.219.190 waku fbbc95da42ac0effefb76485febb60a3182aa2fc97a6917852621d3cbb6c7a98
2025-02-11 15:04:25.500 DEBUG [src.node.docker_mananger] Container started with ID fbbc95da42ac. Setting up logs at ./log/docker/receiving_node1_2025-02-11_15-04-25__5024ffab-40b2-4b43-bb16-d1f3cb4f4bc8__wakuorg_nwaku:latest.log
2025-02-11 15:04:25.500 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54727
2025-02-11 15:04:25.501 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:26.009 ERROR [src.node.docker_mananger] Max retries reached for container 7a6493a0ed11. Exiting log stream.
2025-02-11 15:04:26.501 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54727/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:26.504 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:26.504 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:26.505 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54727/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:26.507 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.219.190/tcp/54728/p2p/16Uiu2HAmJ3uSabNjovP2AdAPqCdhHPfWwqaHududo4jdqiVPUEvN","/ip4/172.18.219.190/tcp/54729/ws/p2p/16Uiu2HAmJ3uSabNjovP2AdAPqCdhHPfWwqaHududo4jdqiVPUEvN"],"enrUri":"enr:-L24QIoOyeqldPm_XpzMbMP2me_HQsaSvNXUuNZrLkNppYG7BJsx1mGlPskLeF8XLXoqBGn7f3JnGF9cc1fXgO8fj4gCgmlkgnY0gmlwhKwS276KbXVsdGlhZGRyc5YACASsEtu-BtXIAAoErBLbvgbVyd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDUCk-K5rKNKHsdWDTQedPR87BBKQT7iUWRKeGaczAckODdGNwgtXIg3VkcILVyoV3YWt1Mg0"}'
2025-02-11 15:04:26.507 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:26.513 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:26.514 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-11_15-04-25__5024ffab-40b2-4b43-bb16-d1f3cb4f4bc8__wakuorg_nwaku:latest.log
2025-02-11 15:04:26.514 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:26.514 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:26.515 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:26.515 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.189.37
2025-02-11 15:04:26.515 DEBUG [src.node.docker_mananger] Generated ports ['16263', '16264', '16265', '16266', '16267']
2025-02-11 15:04:26.516 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:26.516 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:26.516 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:26.516 DEBUG [src.node.docker_mananger] docker run -i -t -p 16263:16263 -p 16264:16264 -p 16265:16265 -p 16266:16266 -p 16267:16267 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16265 --rest-port=16263 --tcp-port=16264 --discv5-udp-port=16266 --rest-address=0.0.0.0 --nat=extip:172.18.189.37 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1f5ecaac987a6d009ab5e50e7b3b85ad54ccbdeb8e58d575bd530104e400cd99 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16267 --metrics-logging=true --lightpush=false --relay=true
2025-02-11 15:04:26.744 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.189.37 waku 50d17e8e6412a0d088072971b88162712550a899a25f9d3aa5d3d2aa515f4e13
2025-02-11 15:04:26.800 DEBUG [src.node.docker_mananger] Container started with ID 50d17e8e6412. Setting up logs at ./log/docker/receiving_node2_2025-02-11_15-04-25__5024ffab-40b2-4b43-bb16-d1f3cb4f4bc8__wakuorg_nwaku:latest.log
2025-02-11 15:04:26.800 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16263
2025-02-11 15:04:26.801 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:27.801 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16263/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:27.804 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:27.804 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:27.804 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16263/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:27.807 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.189.37/tcp/16264/p2p/16Uiu2HAmGeWU4mwnxiXMgoZpPMiQv8xQeTUwW6xuPhibFa1Gq6PL","/ip4/172.18.189.37/tcp/16265/ws/p2p/16Uiu2HAmGeWU4mwnxiXMgoZpPMiQv8xQeTUwW6xuPhibFa1Gq6PL"],"enrUri":"enr:-L24QBkU3xX95u_MRYAir8Q2lFRPIieecre58iZH7v-JoMiiTqzK8B62MyaRtA5qV4AHzLNCTC1lV7oTgCxpKxWaGwQCgmlkgnY0gmlwhKwSvSWKbXVsdGlhZGRyc5YACASsEr0lBj-IAAoErBK9JQY_id0DgnJzhQADAQAAiXNlY3AyNTZrMaEDO084WKByE8_I74uh9TpS-In_A8-x3zI4fUKKPGDN73ODdGNwgj-Ig3VkcII_ioV3YWt1MgE"}'
2025-02-11 15:04:27.807 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:27.807 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16263/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.219.190/tcp/54728/p2p/16Uiu2HAmJ3uSabNjovP2AdAPqCdhHPfWwqaHududo4jdqiVPUEvN"]'
2025-02-11 15:04:27.849 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:27.856 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:27.856 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_15-04-25__5024ffab-40b2-4b43-bb16-d1f3cb4f4bc8__wakuorg_nwaku:latest.log
2025-02-11 15:04:27.856 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:27.856 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:27.858 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:27.858 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.116.241
2025-02-11 15:04:27.858 DEBUG [src.node.docker_mananger] Generated ports ['44161', '44162', '44163', '44164', '44165']
2025-02-11 15:04:27.858 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:27.858 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:27.858 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:27.859 DEBUG [src.node.docker_mananger] docker run -i -t -p 44161:44161 -p 44162:44162 -p 44163:44163 -p 44164:44164 -p 44165:44165 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44163 --rest-port=44161 --tcp-port=44162 --discv5-udp-port=44164 --rest-address=0.0.0.0 --nat=extip:172.18.116.241 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fef0b3d6cab5b3bf640cff5cec1b0b09f8ce50686fba16facbb99f1230dee701 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44165 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QIoOyeqldPm_XpzMbMP2me_HQsaSvNXUuNZrLkNppYG7BJsx1mGlPskLeF8XLXoqBGn7f3JnGF9cc1fXgO8fj4gCgmlkgnY0gmlwhKwS276KbXVsdGlhZGRyc5YACASsEtu-BtXIAAoErBLbvgbVyd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDUCk-K5rKNKHsdWDTQedPR87BBKQT7iUWRKeGaczAckODdGNwgtXIg3VkcILVyoV3YWt1Mg0 --lightpushnode=/ip4/172.18.219.190/tcp/54728/p2p/16Uiu2HAmJ3uSabNjovP2AdAPqCdhHPfWwqaHududo4jdqiVPUEvN --lightpush=true --relay=false
2025-02-11 15:04:28.094 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.116.241 waku fa45316ae3321b49a1ef50a4f18df9a24f5679f1ed834b0ba5b88f0786fba972
2025-02-11 15:04:28.142 DEBUG [src.node.docker_mananger] Container started with ID fa45316ae332. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_15-04-25__5024ffab-40b2-4b43-bb16-d1f3cb4f4bc8__wakuorg_nwaku:latest.log
2025-02-11 15:04:28.142 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44161
2025-02-11 15:04:28.143 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:29.143 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44161/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:29.146 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:29.146 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:29.146 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44161/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:29.148 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.116.241/tcp/44162/p2p/16Uiu2HAmSbvSwozuqXArtE2HxJgLEvSBv8fJ5xf1UbQ9w4RzfRer","/ip4/172.18.116.241/tcp/44163/ws/p2p/16Uiu2HAmSbvSwozuqXArtE2HxJgLEvSBv8fJ5xf1UbQ9w4RzfRer"],"enrUri":"enr:-L24QNA4O8Lm-exaZjrtin687uQ9n_RAi2fw87BWZH4Y832mLrJ0hxqoBvylrqbqj5Sj4YoTcF_C4uKldsq1WJjDmeoCgmlkgnY0gmlwhKwSdPGKbXVsdGlhZGRyc5YACASsEnTxBqyCAAoErBJ08Qasg90DgnJzhQADAQAAiXNlY3AyNTZrMaEDzzp2RO7GtsikDfWLyzk0IwfIGm7lDm5lGdo_h5Jd3TODdGNwgqyCg3VkcIKshIV3YWt1Mgg"}'
2025-02-11 15:04:29.149 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:29.149 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44161/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.219.190/tcp/54728/p2p/16Uiu2HAmJ3uSabNjovP2AdAPqCdhHPfWwqaHududo4jdqiVPUEvN"]'
2025-02-11 15:04:29.194 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:29.196 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44161/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.189.37/tcp/16264/p2p/16Uiu2HAmGeWU4mwnxiXMgoZpPMiQv8xQeTUwW6xuPhibFa1Gq6PL"]'
2025-02-11 15:04:29.221 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:29.222 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54727/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:04:29.229 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:29.231 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16263/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:04:29.238 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:29.238 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 15:04:29.238 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44161/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739286269238571776}}'
2025-02-11 15:04:29.252 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:29.253 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:04:29.353 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-11 15:04:29.353 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54727/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:29.356 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286269238571776,"ephemeral":false}]'
2025-02-11 15:04:29.358 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-11 15:04:29.358 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16263/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:29.360 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286269238571776,"ephemeral":false}]'
2025-02-11 15:04:29.363 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:04:29.364 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:04:29.364 DEBUG [src.node.waku_node] Stopping container with id fbbc95da42ac
2025-02-11 15:04:30.020 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:30.020 DEBUG [src.node.waku_node] Stopping container with id 50d17e8e6412
2025-02-11 15:04:30.833 ERROR [src.node.docker_mananger] Max retries reached for container fbbc95da42ac. Exiting log stream.
2025-02-11 15:04:31.536 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:31.536 DEBUG [src.node.waku_node] Stopping container with id fa45316ae332
2025-02-11 15:04:32.348 ERROR [src.node.docker_mananger] Max retries reached for container 50d17e8e6412. Exiting log stream.
2025-02-11 15:04:33.054 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:33.055 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:04:33.063 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:33.069 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:33.074 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
