2025-02-11 15:04:27.929 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:04:27.930 DEBUG [tests.conftest] Running test: test_lightpush_with_a_single_receiving_node with id: 2025-02-11_15-04-27__ffb761f3-04b9-48b2-9e99-2ca3a6cba438
2025-02-11 15:04:27.930 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:04:27.930 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 15:04:27.937 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:27.937 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_15-04-27__ffb761f3-04b9-48b2-9e99-2ca3a6cba438__wakuorg_nwaku:latest.log
2025-02-11 15:04:27.937 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:27.937 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:27.938 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:27.938 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.240.239
2025-02-11 15:04:27.939 DEBUG [src.node.docker_mananger] Generated ports ['48367', '48368', '48369', '48370', '48371']
2025-02-11 15:04:27.939 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:27.939 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:27.939 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:27.939 DEBUG [src.node.docker_mananger] docker run -i -t -p 48367:48367 -p 48368:48368 -p 48369:48369 -p 48370:48370 -p 48371:48371 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48369 --rest-port=48367 --tcp-port=48368 --discv5-udp-port=48370 --rest-address=0.0.0.0 --nat=extip:172.18.240.239 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ba717f2b45b80b5aada4e7338bd7d892dae2e6a5ea5b8aeda8de8f776e374a25 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48371 --metrics-logging=true --lightpush=true --relay=true
2025-02-11 15:04:28.164 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.240.239 waku b85385765e177be0b63bf090721883e6a0aaf54d887e61730ab086982451189c
2025-02-11 15:04:28.214 DEBUG [src.node.docker_mananger] Container started with ID b85385765e17. Setting up logs at ./log/docker/receiving_node1_2025-02-11_15-04-27__ffb761f3-04b9-48b2-9e99-2ca3a6cba438__wakuorg_nwaku:latest.log
2025-02-11 15:04:28.215 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48367
2025-02-11 15:04:28.215 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:28.731 ERROR [src.node.docker_mananger] Max retries reached for container 40a6fa12845f. Exiting log stream.
2025-02-11 15:04:29.216 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:29.219 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:29.219 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:29.219 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:29.221 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.240.239/tcp/48368/p2p/16Uiu2HAmEXxSphDtWD8aAMCgBFxqicUuoBE9FCL9PhPSDrUDmeib","/ip4/172.18.240.239/tcp/48369/ws/p2p/16Uiu2HAmEXxSphDtWD8aAMCgBFxqicUuoBE9FCL9PhPSDrUDmeib"],"enrUri":"enr:-L24QOn33YWqveKSENC7AAbpD5-rWcFpREv26JBJ7xEPjmmgPwvxn566diFGvKdHv1yrhX9ghugXHQG-78HXuheRztcCgmlkgnY0gmlwhKwS8O-KbXVsdGlhZGRyc5YACASsEvDvBrzwAAoErBLw7wa88d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDG-onl0R-UCVnoMIQUi1-sFLqUkQ35cSfaodQbjpZaGCDdGNwgrzwg3VkcIK88oV3YWt1Mgk"}'
2025-02-11 15:04:29.222 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:29.228 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:29.228 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_15-04-27__ffb761f3-04b9-48b2-9e99-2ca3a6cba438__wakuorg_nwaku:latest.log
2025-02-11 15:04:29.228 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:29.228 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:29.230 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:29.230 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.240.174
2025-02-11 15:04:29.230 DEBUG [src.node.docker_mananger] Generated ports ['44794', '44795', '44796', '44797', '44798']
2025-02-11 15:04:29.230 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:29.230 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:29.230 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:29.230 DEBUG [src.node.docker_mananger] docker run -i -t -p 44794:44794 -p 44795:44795 -p 44796:44796 -p 44797:44797 -p 44798:44798 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44796 --rest-port=44794 --tcp-port=44795 --discv5-udp-port=44797 --rest-address=0.0.0.0 --nat=extip:172.18.240.174 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1ebad2cfe92239a6e7d05cc4adf7064a2df3af99bc720cc4fccae1fbdce01a8e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44798 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QOn33YWqveKSENC7AAbpD5-rWcFpREv26JBJ7xEPjmmgPwvxn566diFGvKdHv1yrhX9ghugXHQG-78HXuheRztcCgmlkgnY0gmlwhKwS8O-KbXVsdGlhZGRyc5YACASsEvDvBrzwAAoErBLw7wa88d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDG-onl0R-UCVnoMIQUi1-sFLqUkQ35cSfaodQbjpZaGCDdGNwgrzwg3VkcIK88oV3YWt1Mgk --lightpushnode=/ip4/172.18.240.239/tcp/48368/p2p/16Uiu2HAmEXxSphDtWD8aAMCgBFxqicUuoBE9FCL9PhPSDrUDmeib --lightpush=true --relay=false
2025-02-11 15:04:29.462 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.240.174 waku 968a3a58623233bb46773136587d6f62da7b9d82ece69332b3fd4b8750c3a81c
2025-02-11 15:04:29.508 DEBUG [src.node.docker_mananger] Container started with ID 968a3a586232. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_15-04-27__ffb761f3-04b9-48b2-9e99-2ca3a6cba438__wakuorg_nwaku:latest.log
2025-02-11 15:04:29.509 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44794
2025-02-11 15:04:29.509 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:30.509 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44794/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:30.512 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:30.512 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:30.512 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44794/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:30.514 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.240.174/tcp/44795/p2p/16Uiu2HAmMjLgJjK4NtBpzksfahnuXhEueaV63VMRrv9hornERhKT","/ip4/172.18.240.174/tcp/44796/ws/p2p/16Uiu2HAmMjLgJjK4NtBpzksfahnuXhEueaV63VMRrv9hornERhKT"],"enrUri":"enr:-L24QAzBB-miGPobz0CjC1QpdNuGj23XImdF-ANmSdtRB3tZU0-wato1ld9a6U3hjI3rNMPrCdSEsfD21SgA9T2FmQUCgmlkgnY0gmlwhKwS8K6KbXVsdGlhZGRyc5YACASsEvCuBq77AAoErBLwrgau_N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDhtZ9iQ1ykM53FA5nEZp-C86YOChapkbIwX2vHahCRb6DdGNwgq77g3VkcIKu_YV3YWt1Mgg"}'
2025-02-11 15:04:30.515 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:30.515 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44794/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.240.239/tcp/48368/p2p/16Uiu2HAmEXxSphDtWD8aAMCgBFxqicUuoBE9FCL9PhPSDrUDmeib"]'
2025-02-11 15:04:30.552 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:30.553 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48367/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:04:30.571 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:30.573 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 15:04:30.573 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44794/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739286270573074176}}'
2025-02-11 15:04:30.585 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:44794/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
2025-02-11 15:04:30.587 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:04:30.588 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:04:30.588 DEBUG [src.node.waku_node] Stopping container with id b85385765e17
2025-02-11 15:04:31.683 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:31.683 DEBUG [src.node.waku_node] Stopping container with id 968a3a586232
2025-02-11 15:04:32.496 ERROR [src.node.docker_mananger] Max retries reached for container b85385765e17. Exiting log stream.
2025-02-11 15:04:33.187 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:33.188 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:04:33.192 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:33.196 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
