2025-02-11 15:07:40.886 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:07:40.886 DEBUG [tests.conftest] Running test: test_cant_retrieve_messages_on_not_subscribed_content_topic with id: 2025-02-11_15-07-40__79d4043a-d471-4f07-8d0c-0091d6c9a088
2025-02-11 15:07:40.886 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:07:40.887 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:07:40.887 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-11 15:07:40.893 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:07:40.893 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-07-40__79d4043a-d471-4f07-8d0c-0091d6c9a088__wakuorg_nwaku:latest.log
2025-02-11 15:07:40.893 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:07:40.894 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:07:40.898 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:07:40.898 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.241.82
2025-02-11 15:07:40.898 DEBUG [src.node.docker_mananger] Generated ports ['23682', '23683', '23684', '23685', '23686']
2025-02-11 15:07:40.898 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:07:40.898 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:07:40.898 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:07:40.899 DEBUG [src.node.docker_mananger] docker run -i -t -p 23682:23682 -p 23683:23683 -p 23684:23684 -p 23685:23685 -p 23686:23686 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23684 --rest-port=23682 --tcp-port=23683 --discv5-udp-port=23685 --rest-address=0.0.0.0 --nat=extip:172.18.241.82 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=c5bcae6bce782b583dd9c68265433f8f2b058623cf099dbacdbaceae2b8a44cc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23686 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-11 15:07:41.129 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.241.82 waku 9067e535a3179d64257d45fe8ab3ec65cb39f06c7ff6cfaa42ca14c4d22f4aab
2025-02-11 15:07:41.178 DEBUG [src.node.docker_mananger] Container started with ID 9067e535a317. Setting up logs at ./log/docker/node1_2025-02-11_15-07-40__79d4043a-d471-4f07-8d0c-0091d6c9a088__wakuorg_nwaku:latest.log
2025-02-11 15:07:41.179 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23682
2025-02-11 15:07:41.180 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:07:41.685 ERROR [src.node.docker_mananger] Max retries reached for container 1d6fa49bee92. Exiting log stream.
2025-02-11 15:07:42.180 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23682/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:42.183 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:07:42.183 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:07:42.184 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23682/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:42.186 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.82/tcp/23683/p2p/16Uiu2HAm4wvkeAWd4WTRp6U6jrLxzXY14faQPRxCaGCYZeHTcgkd","/ip4/172.18.241.82/tcp/23684/ws/p2p/16Uiu2HAm4wvkeAWd4WTRp6U6jrLxzXY14faQPRxCaGCYZeHTcgkd"],"enrUri":"enr:-L24QHTogBvFMAxT1NUU5arr8PN16dqDNSvC37hlomG3PoY9VDDhdAxSPC_nny3A3WJQTOCTashplqU5KuqKcvp8u8kCgmlkgnY0gmlwhKwS8VKKbXVsdGlhZGRyc5YACASsEvFSBlyDAAoErBLxUgZchN0DgnJzhQACAQAAiXNlY3AyNTZrMaECjXlPjnr16neFYmLG5Myxz4nhp_L2f6sp6AfMtciKk7aDdGNwglyDg3VkcIJchYV3YWt1MgU"}'
2025-02-11 15:07:42.186 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:07:42.192 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:07:42.192 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-07-40__79d4043a-d471-4f07-8d0c-0091d6c9a088__wakuorg_nwaku:latest.log
2025-02-11 15:07:42.193 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:07:42.193 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:07:42.194 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:07:42.194 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.59
2025-02-11 15:07:42.194 DEBUG [src.node.docker_mananger] Generated ports ['20443', '20444', '20445', '20446', '20447']
2025-02-11 15:07:42.195 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:07:42.195 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:07:42.195 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:07:42.195 DEBUG [src.node.docker_mananger] docker run -i -t -p 20443:20443 -p 20444:20444 -p 20445:20445 -p 20446:20446 -p 20447:20447 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20445 --rest-port=20443 --tcp-port=20444 --discv5-udp-port=20446 --rest-address=0.0.0.0 --nat=extip:172.18.254.59 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e51a159ed119bc6bed7b6abdb1eafd5cd0b3faf1bdfa6cdec9eb592d9d9bc459 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20447 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QHTogBvFMAxT1NUU5arr8PN16dqDNSvC37hlomG3PoY9VDDhdAxSPC_nny3A3WJQTOCTashplqU5KuqKcvp8u8kCgmlkgnY0gmlwhKwS8VKKbXVsdGlhZGRyc5YACASsEvFSBlyDAAoErBLxUgZchN0DgnJzhQACAQAAiXNlY3AyNTZrMaECjXlPjnr16neFYmLG5Myxz4nhp_L2f6sp6AfMtciKk7aDdGNwglyDg3VkcIJchYV3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-11 15:07:42.425 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.59 waku 18ff5cdfb635263a02b939d9678cb3bd05abfd7e9150394a4cce6670622366ce
2025-02-11 15:07:42.470 DEBUG [src.node.docker_mananger] Container started with ID 18ff5cdfb635. Setting up logs at ./log/docker/node2_2025-02-11_15-07-40__79d4043a-d471-4f07-8d0c-0091d6c9a088__wakuorg_nwaku:latest.log
2025-02-11 15:07:42.470 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20443
2025-02-11 15:07:42.470 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:07:43.471 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20443/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:43.476 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:07:43.477 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:07:43.477 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20443/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:43.480 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.59/tcp/20444/p2p/16Uiu2HAkzjKvK1Smsn5jTvWhv1B9RbxQiYUPirA23gAampVQF785","/ip4/172.18.254.59/tcp/20445/ws/p2p/16Uiu2HAkzjKvK1Smsn5jTvWhv1B9RbxQiYUPirA23gAampVQF785"],"enrUri":"enr:-L24QJbOaA6TMCiEYELgQNjCih7HQDxcLcIF9TLgdjz7VskicIgQjGQerZklc8rt1YEpzB5KVhkjm4jSoQrI637WeHcCgmlkgnY0gmlwhKwS_juKbXVsdGlhZGRyc5YACASsEv47Bk_cAAoErBL-OwZP3d0DgnJzhQACAQAAiXNlY3AyNTZrMaECTtA1DYN5BoFEQhsgR8kBMpRKhp74GpG8SJfMysIbg1KDdGNwgk_cg3VkcIJP3oV3YWt1MgE"}'
2025-02-11 15:07:43.481 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:07:43.482 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20443/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.82/tcp/23683/p2p/16Uiu2HAm4wvkeAWd4WTRp6U6jrLxzXY14faQPRxCaGCYZeHTcgkd"]'
2025-02-11 15:07:43.491 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:43.492 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23682/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-11 15:07:43.496 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:43.496 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20443/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-11 15:07:43.498 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:43.499 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23682/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:07:43.502 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:43.502 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:07:43.602 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:07:43.603 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23682/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:43.605 ERROR [src.node.api_clients.base_client] HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:23682/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto. Response content: b'/toychat/2/huilong/proto'
2025-02-11 15:07:43.608 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:07:43.609 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:07:43.610 DEBUG [src.node.waku_node] Stopping container with id 9067e535a317
2025-02-11 15:07:44.651 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:07:44.651 DEBUG [src.node.waku_node] Stopping container with id 18ff5cdfb635
2025-02-11 15:07:45.463 ERROR [src.node.docker_mananger] Max retries reached for container 9067e535a317. Exiting log stream.
2025-02-11 15:07:46.153 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:07:46.153 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:07:46.158 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:07:46.164 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
