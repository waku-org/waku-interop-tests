2025-02-11 15:05:33.351 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:05:33.352 DEBUG [tests.conftest] Running test: test_retrieve_messages_without_subscribing_via_api with id: 2025-02-11_15-05-33__f6344ea7-f5cd-4e8c-a7b2-b9ae4d26ed18
2025-02-11 15:05:33.352 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:05:33.352 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:05:33.352 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-11 15:05:33.359 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:05:33.359 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-05-33__f6344ea7-f5cd-4e8c-a7b2-b9ae4d26ed18__wakuorg_nwaku:latest.log
2025-02-11 15:05:33.359 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:05:33.359 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:05:33.360 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:05:33.361 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.118.241
2025-02-11 15:05:33.361 DEBUG [src.node.docker_mananger] Generated ports ['32833', '32834', '32835', '32836', '32837']
2025-02-11 15:05:33.361 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:05:33.361 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:05:33.361 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:05:33.361 DEBUG [src.node.docker_mananger] docker run -i -t -p 32833:32833 -p 32834:32834 -p 32835:32835 -p 32836:32836 -p 32837:32837 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32835 --rest-port=32833 --tcp-port=32834 --discv5-udp-port=32836 --rest-address=0.0.0.0 --nat=extip:172.18.118.241 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=d2a4b94893caa4bcb420dac039a74aef6e5ecfa6f35ceb15bb0c2ee8cf3233b0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32837 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-11 15:05:33.585 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.118.241 waku d2feb4cdf2fced4eb9d9829c2bd0077e0da729633bbbc82a339d80afb7290225
2025-02-11 15:05:33.635 DEBUG [src.node.docker_mananger] Container started with ID d2feb4cdf2fc. Setting up logs at ./log/docker/node1_2025-02-11_15-05-33__f6344ea7-f5cd-4e8c-a7b2-b9ae4d26ed18__wakuorg_nwaku:latest.log
2025-02-11 15:05:33.635 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 32833
2025-02-11 15:05:33.636 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:05:34.067 ERROR [src.node.docker_mananger] Max retries reached for container bbd4dff83925. Exiting log stream.
2025-02-11 15:05:34.638 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32833/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:34.641 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:05:34.641 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:05:34.641 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32833/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:34.643 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.118.241/tcp/32834/p2p/16Uiu2HAmEcX7Q8bNBc9yTVqKXxcycgAnud7AWrJyYmvsexSBa1HK","/ip4/172.18.118.241/tcp/32835/ws/p2p/16Uiu2HAmEcX7Q8bNBc9yTVqKXxcycgAnud7AWrJyYmvsexSBa1HK"],"enrUri":"enr:-L24QPuKr8wpI850g-AgjvdOmzxDV7o-RikV0k7um7nFmtYXD416S-EoLzkqm589w5uaYc0XSBJWgGkHw6X3RZJdL2wCgmlkgnY0gmlwhKwSdvGKbXVsdGlhZGRyc5YACASsEnbxBoBCAAoErBJ28QaAQ90DgnJzhQACAQAAiXNlY3AyNTZrMaEDHRVpljZ96VydUkQOAA-pgJhAGfT9LdHbNnPF7P6dulqDdGNwgoBCg3VkcIKARIV3YWt1MgU"}'
2025-02-11 15:05:34.643 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:05:34.650 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:05:34.650 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-05-33__f6344ea7-f5cd-4e8c-a7b2-b9ae4d26ed18__wakuorg_nwaku:latest.log
2025-02-11 15:05:34.650 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:05:34.650 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:05:34.651 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:05:34.652 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.217.56
2025-02-11 15:05:34.652 DEBUG [src.node.docker_mananger] Generated ports ['14047', '14048', '14049', '14050', '14051']
2025-02-11 15:05:34.652 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:05:34.652 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:05:34.652 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:05:34.652 DEBUG [src.node.docker_mananger] docker run -i -t -p 14047:14047 -p 14048:14048 -p 14049:14049 -p 14050:14050 -p 14051:14051 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14049 --rest-port=14047 --tcp-port=14048 --discv5-udp-port=14050 --rest-address=0.0.0.0 --nat=extip:172.18.217.56 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=9f070ef58e7f3dbeb3189e2f4bd648d45a6efe5ccdc7b89d7bce5b1ba7161b26 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14051 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QPuKr8wpI850g-AgjvdOmzxDV7o-RikV0k7um7nFmtYXD416S-EoLzkqm589w5uaYc0XSBJWgGkHw6X3RZJdL2wCgmlkgnY0gmlwhKwSdvGKbXVsdGlhZGRyc5YACASsEnbxBoBCAAoErBJ28QaAQ90DgnJzhQACAQAAiXNlY3AyNTZrMaEDHRVpljZ96VydUkQOAA-pgJhAGfT9LdHbNnPF7P6dulqDdGNwgoBCg3VkcIKARIV3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-11 15:05:34.879 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.217.56 waku f215c3de79c5166158d0dbabe0a381d7c8d48b16e4b6ef95d9e40d15174913e0
2025-02-11 15:05:34.926 DEBUG [src.node.docker_mananger] Container started with ID f215c3de79c5. Setting up logs at ./log/docker/node2_2025-02-11_15-05-33__f6344ea7-f5cd-4e8c-a7b2-b9ae4d26ed18__wakuorg_nwaku:latest.log
2025-02-11 15:05:34.927 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 14047
2025-02-11 15:05:34.927 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:05:35.927 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14047/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:35.937 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:05:35.938 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:05:35.939 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14047/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:35.946 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.217.56/tcp/14048/p2p/16Uiu2HAm3FAmUTLiYxBqNxr1EguNWbGQRwr8vXPJvZ6Ff9xVY2zU","/ip4/172.18.217.56/tcp/14049/ws/p2p/16Uiu2HAm3FAmUTLiYxBqNxr1EguNWbGQRwr8vXPJvZ6Ff9xVY2zU"],"enrUri":"enr:-L24QLg2ojxiWr8WSNzV-dZ62uq20eLrlxDE9fhTE5jglYajLwNGtG3apvXZnD7xtWwIxfoV4GtzShsngZepJ6oxhUkCgmlkgnY0gmlwhKwS2TiKbXVsdGlhZGRyc5YACASsEtk4BjbgAAoErBLZOAY24d0DgnJzhQACAQAAiXNlY3AyNTZrMaECdCyoINb24ZJzsFfji9jmiNOOaiN46Yqd4fVsE9suISGDdGNwgjbgg3VkcII24oV3YWt1MgE"}'
2025-02-11 15:05:35.948 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:05:35.949 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14047/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.118.241/tcp/32834/p2p/16Uiu2HAmEcX7Q8bNBc9yTVqKXxcycgAnud7AWrJyYmvsexSBa1HK"]'
2025-02-11 15:05:35.954 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:35.954 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32833/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:05:35.959 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:05:35.960 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:05:36.060 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:05:36.061 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32833/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:36.063 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286335954666240,"ephemeral":false}]'
2025-02-11 15:05:36.065 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:05:36.065 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14047/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:05:36.067 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739286335954666240,"ephemeral":false}]'
2025-02-11 15:05:36.070 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:05:36.071 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:05:36.071 DEBUG [src.node.waku_node] Stopping container with id d2feb4cdf2fc
2025-02-11 15:05:37.130 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:05:37.131 DEBUG [src.node.waku_node] Stopping container with id f215c3de79c5
2025-02-11 15:05:37.942 ERROR [src.node.docker_mananger] Max retries reached for container d2feb4cdf2fc. Exiting log stream.
2025-02-11 15:05:38.639 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:05:38.640 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:05:38.647 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:05:38.652 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
