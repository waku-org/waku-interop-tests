2025-02-11 15:07:28.596 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:07:28.597 DEBUG [tests.conftest] Running test: test_store_node_paused_and_unpaused with id: 2025-02-11_15-07-28__842fbe09-94ca-4d77-afcf-abfa9846c084
2025-02-11 15:07:28.597 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:07:28.597 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 15:07:28.598 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-11 15:07:28.606 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:07:28.606 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-11_15-07-28__842fbe09-94ca-4d77-afcf-abfa9846c084__wakuorg_nwaku:latest.log
2025-02-11 15:07:28.606 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:07:28.607 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:07:28.609 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:07:28.610 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.54
2025-02-11 15:07:28.611 DEBUG [src.node.docker_mananger] Generated ports ['17171', '17172', '17173', '17174', '17175']
2025-02-11 15:07:28.611 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:07:28.611 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:07:28.611 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:07:28.611 DEBUG [src.node.docker_mananger] docker run -i -t -p 17171:17171 -p 17172:17172 -p 17173:17173 -p 17174:17174 -p 17175:17175 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17173 --rest-port=17171 --tcp-port=17172 --discv5-udp-port=17174 --rest-address=0.0.0.0 --nat=extip:172.18.254.54 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bfbd962fa3bdeabfb2bae0796ab16c7e44bca92fa0aab5e715da74cd3b5d30ae --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17175 --metrics-logging=true --store=true --relay=true
2025-02-11 15:07:28.854 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.54 waku d36642e2853c3710eac2f899d8f160bfdbde7281328292a538df078c4e88d91b
2025-02-11 15:07:28.904 DEBUG [src.node.docker_mananger] Container started with ID d36642e2853c. Setting up logs at ./log/docker/publishing_node1_2025-02-11_15-07-28__842fbe09-94ca-4d77-afcf-abfa9846c084__wakuorg_nwaku:latest.log
2025-02-11 15:07:28.904 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17171
2025-02-11 15:07:28.904 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:07:29.458 ERROR [src.node.docker_mananger] Max retries reached for container 784f70fdbe03. Exiting log stream.
2025-02-11 15:07:29.906 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17171/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:29.909 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:07:29.909 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:07:29.910 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17171/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:29.912 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.54/tcp/17172/p2p/16Uiu2HAkwNZyT3ou72y4nUuPovnCM1EuyWC1QeDWoy4mMkxWEpa5","/ip4/172.18.254.54/tcp/17173/ws/p2p/16Uiu2HAkwNZyT3ou72y4nUuPovnCM1EuyWC1QeDWoy4mMkxWEpa5"],"enrUri":"enr:-L24QKpAPs0r8bF8SvkrBROo6y4G1_dhejAyJ5X73MlBLvGlWBDkdh9OFeooBGcZVIA8VBO_1hahAuv-y05drnh8WCUCgmlkgnY0gmlwhKwS_jaKbXVsdGlhZGRyc5YACASsEv42BkMUAAoErBL-NgZDFd0DgnJzhQADAQAAiXNlY3AyNTZrMaECHOvXK2ATtoXqGeyXaVV77p0wtYsidmda3jqYJWCcPhKDdGNwgkMUg3VkcIJDFoV3YWt1MgM"}'
2025-02-11 15:07:29.912 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:07:29.919 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:07:29.919 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-11_15-07-28__842fbe09-94ca-4d77-afcf-abfa9846c084__wakuorg_nwaku:latest.log
2025-02-11 15:07:29.919 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:07:29.919 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:07:29.921 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:07:29.921 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.136.80
2025-02-11 15:07:29.921 DEBUG [src.node.docker_mananger] Generated ports ['2389', '2390', '2391', '2392', '2393']
2025-02-11 15:07:29.921 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:07:29.921 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:07:29.921 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:07:29.921 DEBUG [src.node.docker_mananger] docker run -i -t -p 2389:2389 -p 2390:2390 -p 2391:2391 -p 2392:2392 -p 2393:2393 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2391 --rest-port=2389 --tcp-port=2390 --discv5-udp-port=2392 --rest-address=0.0.0.0 --nat=extip:172.18.136.80 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=df00c395f7cf46bd6ebbcfd99f0aaaa2f2f7fbbe571c7b0ddefbc5f2a4254f56 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2393 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QKpAPs0r8bF8SvkrBROo6y4G1_dhejAyJ5X73MlBLvGlWBDkdh9OFeooBGcZVIA8VBO_1hahAuv-y05drnh8WCUCgmlkgnY0gmlwhKwS_jaKbXVsdGlhZGRyc5YACASsEv42BkMUAAoErBL-NgZDFd0DgnJzhQADAQAAiXNlY3AyNTZrMaECHOvXK2ATtoXqGeyXaVV77p0wtYsidmda3jqYJWCcPhKDdGNwgkMUg3VkcIJDFoV3YWt1MgM --storenode=/ip4/172.18.254.54/tcp/17172/p2p/16Uiu2HAkwNZyT3ou72y4nUuPovnCM1EuyWC1QeDWoy4mMkxWEpa5 --store=true --relay=true
2025-02-11 15:07:30.153 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.136.80 waku 48196e891ad380f0727c92ba58b7ce1071a50259fd45c5b745f46840afe20b6f
2025-02-11 15:07:30.208 DEBUG [src.node.docker_mananger] Container started with ID 48196e891ad3. Setting up logs at ./log/docker/store_node1_2025-02-11_15-07-28__842fbe09-94ca-4d77-afcf-abfa9846c084__wakuorg_nwaku:latest.log
2025-02-11 15:07:30.208 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 2389
2025-02-11 15:07:30.209 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:07:31.210 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2389/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:31.213 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:07:31.213 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:07:31.213 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2389/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:31.215 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.136.80/tcp/2390/p2p/16Uiu2HAmV7wNCuVRNdhvRc1mS3qS4T5cLPjD7sNcX5ucZGkgFjXF","/ip4/172.18.136.80/tcp/2391/ws/p2p/16Uiu2HAmV7wNCuVRNdhvRc1mS3qS4T5cLPjD7sNcX5ucZGkgFjXF"],"enrUri":"enr:-L24QF3SroQsd_zVPy4_vlPG3yNTqM6FHRWOb8G-p8nRDVjdFuI_GdNwyf4avqDARrFgyF3-CT3CP_wLM1TN3rxlgr8CgmlkgnY0gmlwhKwSiFCKbXVsdGlhZGRyc5YACASsEohQBglWAAoErBKIUAYJV90DgnJzhQADAQAAiXNlY3AyNTZrMaED9KJMZQ9FtH3IHoL-lIkig3aefoZ4Eu1H1vFnLb1MpQKDdGNwgglWg3VkcIIJWIV3YWt1MgM"}'
2025-02-11 15:07:31.216 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:07:31.216 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2389/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.254.54/tcp/17172/p2p/16Uiu2HAkwNZyT3ou72y4nUuPovnCM1EuyWC1QeDWoy4mMkxWEpa5"]'
2025-02-11 15:07:31.219 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:31.219 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17171/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:07:31.222 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:31.222 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2389/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 15:07:31.224 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:31.225 DEBUG [src.steps.store] Relaying message
2025-02-11 15:07:31.226 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17171/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:07:31.231 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:31.232 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:07:31.433 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:07:31.433 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17171/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:31.437 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb32cba1cea244c20fa615ae5f884d84f9abe882db89e77134b3ddf1ce7f5f7b5"}]}'
2025-02-11 15:07:31.437 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:07:31.437 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2389/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:31.440 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb32cba1cea244c20fa615ae5f884d84f9abe882db89e77134b3ddf1ce7f5f7b5"}]}'
2025-02-11 15:07:31.441 DEBUG [src.node.waku_node] Pausing container with id 48196e891ad3
2025-02-11 15:07:31.450 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:07:32.450 DEBUG [src.node.waku_node] Unpause container with id 48196e891ad3
2025-02-11 15:07:32.460 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2389/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:32.464 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:07:32.464 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:07:32.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2389/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:32.466 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.136.80/tcp/2390/p2p/16Uiu2HAmV7wNCuVRNdhvRc1mS3qS4T5cLPjD7sNcX5ucZGkgFjXF","/ip4/172.18.136.80/tcp/2391/ws/p2p/16Uiu2HAmV7wNCuVRNdhvRc1mS3qS4T5cLPjD7sNcX5ucZGkgFjXF"],"enrUri":"enr:-L24QF3SroQsd_zVPy4_vlPG3yNTqM6FHRWOb8G-p8nRDVjdFuI_GdNwyf4avqDARrFgyF3-CT3CP_wLM1TN3rxlgr8CgmlkgnY0gmlwhKwSiFCKbXVsdGlhZGRyc5YACASsEohQBglWAAoErBKIUAYJV90DgnJzhQADAQAAiXNlY3AyNTZrMaED9KJMZQ9FtH3IHoL-lIkig3aefoZ4Eu1H1vFnLb1MpQKDdGNwgglWg3VkcIIJWIV3YWt1MgM"}'
2025-02-11 15:07:32.467 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:07:32.467 DEBUG [src.steps.store] Relaying message
2025-02-11 15:07:32.467 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17171/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:07:32.473 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:07:32.474 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 15:07:32.674 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:07:32.675 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17171/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:32.678 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb32cba1cea244c20fa615ae5f884d84f9abe882db89e77134b3ddf1ce7f5f7b5"},{"messageHash":"0x38b1156deaa8a315e741c9e7a7f699e7cfd4478a868f4c9176a27bf6ad4b4fbc"}]}'
2025-02-11 15:07:32.679 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 15:07:32.679 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2389/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:32.682 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb32cba1cea244c20fa615ae5f884d84f9abe882db89e77134b3ddf1ce7f5f7b5"},{"messageHash":"0x38b1156deaa8a315e741c9e7a7f699e7cfd4478a868f4c9176a27bf6ad4b4fbc"}]}'
2025-02-11 15:07:32.682 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17171/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:32.685 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb32cba1cea244c20fa615ae5f884d84f9abe882db89e77134b3ddf1ce7f5f7b5"},{"messageHash":"0x38b1156deaa8a315e741c9e7a7f699e7cfd4478a868f4c9176a27bf6ad4b4fbc"}]}'
2025-02-11 15:07:32.685 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2389/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:07:32.688 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb32cba1cea244c20fa615ae5f884d84f9abe882db89e77134b3ddf1ce7f5f7b5"},{"messageHash":"0x38b1156deaa8a315e741c9e7a7f699e7cfd4478a868f4c9176a27bf6ad4b4fbc"}]}'
2025-02-11 15:07:32.690 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:07:32.691 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:07:32.691 DEBUG [src.node.waku_node] Stopping container with id d36642e2853c
2025-02-11 15:07:33.471 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:07:33.472 DEBUG [src.node.waku_node] Stopping container with id 48196e891ad3
2025-02-11 15:07:34.284 ERROR [src.node.docker_mananger] Max retries reached for container d36642e2853c. Exiting log stream.
2025-02-11 15:07:34.723 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:07:34.725 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:07:34.730 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:07:34.736 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
