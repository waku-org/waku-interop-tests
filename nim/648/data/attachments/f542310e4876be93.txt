2025-02-11 15:04:43.655 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:04:43.656 DEBUG [tests.conftest] Running test: test_publish_after_node_pauses_and_pauses with id: 2025-02-11_15-04-43__099564bc-0cf0-45af-b973-60757e0c6860
2025-02-11 15:04:43.656 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:04:43.656 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 15:04:43.656 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 15:04:43.663 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:43.663 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-04-43__099564bc-0cf0-45af-b973-60757e0c6860__wakuorg_nwaku:latest.log
2025-02-11 15:04:43.663 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:43.663 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:43.664 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:43.665 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.57.191
2025-02-11 15:04:43.665 DEBUG [src.node.docker_mananger] Generated ports ['3388', '3389', '3390', '3391', '3392']
2025-02-11 15:04:43.665 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:43.665 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:43.665 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:43.665 DEBUG [src.node.docker_mananger] docker run -i -t -p 3388:3388 -p 3389:3389 -p 3390:3390 -p 3391:3391 -p 3392:3392 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3390 --rest-port=3388 --tcp-port=3389 --discv5-udp-port=3391 --rest-address=0.0.0.0 --nat=extip:172.18.57.191 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e463a0f1a88d82e07baaf7f80cb656ecfe1391935e05c7beac3cfda03f31b83d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3392 --metrics-logging=true --relay=true
2025-02-11 15:04:43.891 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.57.191 waku 72a2c3135b302e3421de0b66411c3e7f20e502c2514845a1b7ae16ff3640a5ee
2025-02-11 15:04:43.939 DEBUG [src.node.docker_mananger] Container started with ID 72a2c3135b30. Setting up logs at ./log/docker/node1_2025-02-11_15-04-43__099564bc-0cf0-45af-b973-60757e0c6860__wakuorg_nwaku:latest.log
2025-02-11 15:04:43.939 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3388
2025-02-11 15:04:43.940 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:44.459 ERROR [src.node.docker_mananger] Max retries reached for container fb6477d20ef9. Exiting log stream.
2025-02-11 15:04:44.941 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3388/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:44.944 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:44.944 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:44.944 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3388/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:44.946 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.57.191/tcp/3389/p2p/16Uiu2HAmGxCMGSGGpT87snJJHNxKSor8RE8DzSECN1eVbPniSC1S","/ip4/172.18.57.191/tcp/3390/ws/p2p/16Uiu2HAmGxCMGSGGpT87snJJHNxKSor8RE8DzSECN1eVbPniSC1S"],"enrUri":"enr:-L24QK7RMQGFi_Z4qgVKEHkE1vijnVhRy3USvZqswtU4TH_1XnBbIpZPxKEgZshPVtVOzfoKUAHf8hTPmMKSzgkUAWwCgmlkgnY0gmlwhKwSOb-KbXVsdGlhZGRyc5YACASsEjm_Bg09AAoErBI5vwYNPt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDP9cwgC9GtBkvhvlpXji98q8UA5JeP4YUeLYENmImJ72DdGNwgg09g3VkcIINP4V3YWt1MgE"}'
2025-02-11 15:04:44.947 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:44.953 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:04:44.953 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-04-43__099564bc-0cf0-45af-b973-60757e0c6860__wakuorg_nwaku:latest.log
2025-02-11 15:04:44.953 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:04:44.953 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:04:44.955 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:04:44.955 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.22.144
2025-02-11 15:04:44.955 DEBUG [src.node.docker_mananger] Generated ports ['57538', '57539', '57540', '57541', '57542']
2025-02-11 15:04:44.955 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:04:44.955 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:04:44.955 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:04:44.955 DEBUG [src.node.docker_mananger] docker run -i -t -p 57538:57538 -p 57539:57539 -p 57540:57540 -p 57541:57541 -p 57542:57542 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57540 --rest-port=57538 --tcp-port=57539 --discv5-udp-port=57541 --rest-address=0.0.0.0 --nat=extip:172.18.22.144 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=62ef83bbee8ab0e35e9077f98106c98eb3afff6c21c7d921e39e53087de1243a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57542 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QK7RMQGFi_Z4qgVKEHkE1vijnVhRy3USvZqswtU4TH_1XnBbIpZPxKEgZshPVtVOzfoKUAHf8hTPmMKSzgkUAWwCgmlkgnY0gmlwhKwSOb-KbXVsdGlhZGRyc5YACASsEjm_Bg09AAoErBI5vwYNPt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDP9cwgC9GtBkvhvlpXji98q8UA5JeP4YUeLYENmImJ72DdGNwgg09g3VkcIINP4V3YWt1MgE
2025-02-11 15:04:45.195 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.22.144 waku c6f022602013d569fb2f3947b32328e8775fd551942b7c2fcf7ed124ca50ce92
2025-02-11 15:04:45.245 DEBUG [src.node.docker_mananger] Container started with ID c6f022602013. Setting up logs at ./log/docker/node2_2025-02-11_15-04-43__099564bc-0cf0-45af-b973-60757e0c6860__wakuorg_nwaku:latest.log
2025-02-11 15:04:45.245 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57538
2025-02-11 15:04:45.245 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:04:46.247 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57538/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.252 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:04:46.253 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:04:46.253 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57538/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.259 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.22.144/tcp/57539/p2p/16Uiu2HAmRiMSPkjpfdhmprM7goEap14rHjLBL4w8PCgJpuYzFzAx","/ip4/172.18.22.144/tcp/57540/ws/p2p/16Uiu2HAmRiMSPkjpfdhmprM7goEap14rHjLBL4w8PCgJpuYzFzAx"],"enrUri":"enr:-L24QExufUqtA9_nDssRonKjeRhS_O7pb9IxxNiry2EiBntFS6OcpWvIwCFob-mNiDkjONIOykdOsnpMABGWHn_VMvECgmlkgnY0gmlwhKwSFpCKbXVsdGlhZGRyc5YACASsEhaQBuDDAAoErBIWkAbgxN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwgSESJqrtygDl0cIeMENrQ7gup7PdpIU7pcHYdeV6eWDdGNwguDDg3VkcILgxYV3YWt1MgE"}'
2025-02-11 15:04:46.260 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:04:46.262 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57538/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.57.191/tcp/3389/p2p/16Uiu2HAmGxCMGSGGpT87snJJHNxKSor8RE8DzSECN1eVbPniSC1S"]'
2025-02-11 15:04:46.264 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:46.265 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 15:04:46.265 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3388/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:04:46.269 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:46.269 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57538/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:04:46.274 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:46.275 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:46.279 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:46.280 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:04:46.380 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.380 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.383 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286275008768,"ephemeral":false}]'
2025-02-11 15:04:46.384 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.384 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57538/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.387 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286275008768,"ephemeral":false}]'
2025-02-11 15:04:46.388 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 15:04:46.389 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:46.394 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:46.394 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:04:46.494 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.494 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.497 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286389206272,"ephemeral":false}]'
2025-02-11 15:04:46.498 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.499 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57538/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.501 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286389206272,"ephemeral":false}]'
2025-02-11 15:04:46.502 DEBUG [src.node.waku_node] Pausing container with id 72a2c3135b30
2025-02-11 15:04:46.511 DEBUG [src.node.waku_node] Unpause container with id 72a2c3135b30
2025-02-11 15:04:46.520 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTE=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:46.524 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:46.525 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:04:46.625 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.625 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.628 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286520140800,"ephemeral":false}]'
2025-02-11 15:04:46.630 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.630 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57538/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.632 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286520140800,"ephemeral":false}]'
2025-02-11 15:04:46.633 DEBUG [src.node.waku_node] Pausing container with id c6f022602013
2025-02-11 15:04:46.642 DEBUG [src.node.waku_node] Unpause container with id c6f022602013
2025-02-11 15:04:46.650 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTI=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 15:04:46.654 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:04:46.655 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:04:46.755 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.755 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3388/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.758 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286649982976,"ephemeral":false}]'
2025-02-11 15:04:46.759 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:04:46.759 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57538/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:04:46.762 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739286286649982976,"ephemeral":false}]'
2025-02-11 15:04:46.765 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:04:46.766 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:04:46.766 DEBUG [src.node.waku_node] Stopping container with id 72a2c3135b30
2025-02-11 15:04:47.433 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:47.435 DEBUG [src.node.waku_node] Stopping container with id c6f022602013
2025-02-11 15:04:48.262 ERROR [src.node.docker_mananger] Max retries reached for container 72a2c3135b30. Exiting log stream.
2025-02-11 15:04:48.956 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:04:48.957 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:04:48.966 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:04:48.972 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
