2025-02-11 15:03:38.843 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 15:03:38.844 DEBUG [tests.conftest] Running test: test_filter_get_message_with_meta with id: 2025-02-11_15-03-38__6c6e499c-5e3c-4084-88f2-97db57bac7c0
2025-02-11 15:03:38.844 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 15:03:38.844 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 15:03:38.844 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-11 15:03:38.850 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:38.850 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_15-03-38__6c6e499c-5e3c-4084-88f2-97db57bac7c0__wakuorg_nwaku:latest.log
2025-02-11 15:03:38.851 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:38.851 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:38.852 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:38.852 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.183.182
2025-02-11 15:03:38.852 DEBUG [src.node.docker_mananger] Generated ports ['58768', '58769', '58770', '58771', '58772']
2025-02-11 15:03:38.853 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:38.853 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:38.853 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:38.853 DEBUG [src.node.docker_mananger] docker run -i -t -p 58768:58768 -p 58769:58769 -p 58770:58770 -p 58771:58771 -p 58772:58772 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58770 --rest-port=58768 --tcp-port=58769 --discv5-udp-port=58771 --rest-address=0.0.0.0 --nat=extip:172.18.183.182 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b4bbf4f19dc55becefc4ca1be0eaadd46cf0c49cbe83b9fd6941bc70bedaaf08 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58772 --metrics-logging=true --relay=true --filter=true
2025-02-11 15:03:39.079 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.183.182 waku e921ca93c8a90750eb9b0ffa64f5560bbd0f907aaa5f8b0cc71ad8fb9ceb465b
2025-02-11 15:03:39.127 DEBUG [src.node.docker_mananger] Container started with ID e921ca93c8a9. Setting up logs at ./log/docker/node1_2025-02-11_15-03-38__6c6e499c-5e3c-4084-88f2-97db57bac7c0__wakuorg_nwaku:latest.log
2025-02-11 15:03:39.128 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58768
2025-02-11 15:03:39.128 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:39.643 ERROR [src.node.docker_mananger] Max retries reached for container 0b607a9e76d6. Exiting log stream.
2025-02-11 15:03:40.129 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58768/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:40.132 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:40.132 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:40.132 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58768/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:40.135 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.183.182/tcp/58769/p2p/16Uiu2HAmCngvdQemC1uW7RtJVtxPqHByjUjLaVwDgP67bFVkQ4Xn","/ip4/172.18.183.182/tcp/58770/ws/p2p/16Uiu2HAmCngvdQemC1uW7RtJVtxPqHByjUjLaVwDgP67bFVkQ4Xn"],"enrUri":"enr:-L24QGSocIztzV8-_jdykVNGG4jTeyN2A0x5-Dwu83sxi_AFSvaqvFyNUe-t3q5QJD6_cZtuy4EK49VE4jRSyrllob0CgmlkgnY0gmlwhKwSt7aKbXVsdGlhZGRyc5YACASsEre2BuWRAAoErBK3tgblkt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAfjxmQZvrw_0E0vIDA73eq_X7k25n5YDVKfnLsLKq62DdGNwguWRg3VkcILlk4V3YWt1MgU"}'
2025-02-11 15:03:40.135 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:40.135 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-11 15:03:40.141 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 15:03:40.141 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_15-03-38__6c6e499c-5e3c-4084-88f2-97db57bac7c0__wakuorg_nwaku:latest.log
2025-02-11 15:03:40.141 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 15:03:40.141 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 15:03:40.143 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 15:03:40.143 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.32.121
2025-02-11 15:03:40.143 DEBUG [src.node.docker_mananger] Generated ports ['29891', '29892', '29893', '29894', '29895']
2025-02-11 15:03:40.144 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 15:03:40.144 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 15:03:40.144 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 15:03:40.144 DEBUG [src.node.docker_mananger] docker run -i -t -p 29891:29891 -p 29892:29892 -p 29893:29893 -p 29894:29894 -p 29895:29895 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29893 --rest-port=29891 --tcp-port=29892 --discv5-udp-port=29894 --rest-address=0.0.0.0 --nat=extip:172.18.32.121 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b0cc53383a3c61a560b9e8a46ab063ca681297ac38fbfad4e81bf46ddda7e285 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29895 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QGSocIztzV8-_jdykVNGG4jTeyN2A0x5-Dwu83sxi_AFSvaqvFyNUe-t3q5QJD6_cZtuy4EK49VE4jRSyrllob0CgmlkgnY0gmlwhKwSt7aKbXVsdGlhZGRyc5YACASsEre2BuWRAAoErBK3tgblkt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAfjxmQZvrw_0E0vIDA73eq_X7k25n5YDVKfnLsLKq62DdGNwguWRg3VkcILlk4V3YWt1MgU --filternode=/ip4/172.18.183.182/tcp/58769/p2p/16Uiu2HAmCngvdQemC1uW7RtJVtxPqHByjUjLaVwDgP67bFVkQ4Xn
2025-02-11 15:03:40.373 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.32.121 waku 77f081759baa2b518649beac954564887c35122b9dc39ec4a11c8c062dd479d5
2025-02-11 15:03:40.420 DEBUG [src.node.docker_mananger] Container started with ID 77f081759baa. Setting up logs at ./log/docker/node2_2025-02-11_15-03-38__6c6e499c-5e3c-4084-88f2-97db57bac7c0__wakuorg_nwaku:latest.log
2025-02-11 15:03:40.420 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29891
2025-02-11 15:03:40.421 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 15:03:41.421 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29891/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:41.424 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 15:03:41.424 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 15:03:41.424 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29891/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:41.427 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.32.121/tcp/29892/p2p/16Uiu2HAmSfcfbd6QDnoJ6Xb1N6X4Cs97ax2T69osh5adTK4KTzjQ","/ip4/172.18.32.121/tcp/29893/ws/p2p/16Uiu2HAmSfcfbd6QDnoJ6Xb1N6X4Cs97ax2T69osh5adTK4KTzjQ"],"enrUri":"enr:-L24QMPWUun0XnSTNQQ76GjSxlUHfKcJ9wJZhQp4T-zhTTgvcuZrlL4ka5Hvr9Rl1K8UMEZeLj-mzjqlPtiQxSTfPrQCgmlkgnY0gmlwhKwSIHmKbXVsdGlhZGRyc5YACASsEiB5BnTEAAoErBIgeQZ0xd0DgnJzhQADAQAAiXNlY3AyNTZrMaED0Cyt4J-xq6tEScP8HfyCYgjXBsedF5H0Pfna4DrHui-DdGNwgnTEg3VkcIJ0xoV3YWt1MgA"}'
2025-02-11 15:03:41.427 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 15:03:41.427 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29891/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.183.182/tcp/58769/p2p/16Uiu2HAmCngvdQemC1uW7RtJVtxPqHByjUjLaVwDgP67bFVkQ4Xn"]'
2025-02-11 15:03:41.463 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:41.463 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-11 15:03:41.464 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58768/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 15:03:41.485 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:41.486 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29891/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "66f6be1d-cefb-4138-bf8e-1a70318d462b", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 15:03:41.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"66f6be1d-cefb-4138-bf8e-1a70318d462b","statusDesc":"OK"}'
2025-02-11 15:03:41.501 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58768/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "meta": "RmlsdGVyIHdvcmtzISE="}'
2025-02-11 15:03:41.510 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 15:03:41.510 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 15:03:41.610 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 15:03:41.610 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29891/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 15:03:41.613 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739286221501402368,"meta":"RmlsdGVyIHdvcmtzISE=","ephemeral":false}]'
2025-02-11 15:03:41.616 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 15:03:41.617 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 15:03:41.617 DEBUG [src.node.waku_node] Stopping container with id e921ca93c8a9
2025-02-11 15:03:42.692 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:42.692 DEBUG [src.node.waku_node] Stopping container with id 77f081759baa
2025-02-11 15:03:43.504 ERROR [src.node.docker_mananger] Max retries reached for container e921ca93c8a9. Exiting log stream.
2025-02-11 15:03:44.204 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 15:03:44.207 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 15:03:44.212 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 15:03:44.216 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
