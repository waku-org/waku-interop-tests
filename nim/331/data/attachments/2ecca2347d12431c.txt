[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-08-26_04-21-31__42ea38ad-0c83-41f5-888e-50c7c907a768
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-26_04-21-31__42ea38ad-0c83-41f5-888e-50c7c907a768__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.49.210
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['64925', '64926', '64927', '64928', '64929']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 64925:64925 -p 64926:64926 -p 64927:64927 -p 64928:64928 -p 64929:64929 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=64927 --rest-port=64925 --tcp-port=64926 --discv5-udp-port=64928 --rest-address=0.0.0.0 --nat=extip:172.18.49.210 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d4217aa8bb12b701ffbd2a0ebf398acebc0bf34ad9dbcfc97ddabdfb5c6f414f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=64929 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.49.210 waku f0f846e79be71a7d18b5c8097d23b4ee47159b05d13e8436947430c7845aeac8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID f0f846e79be7. Setting up logs at ./log/docker/receiving_node1_2024-08-26_04-21-31__42ea38ad-0c83-41f5-888e-50c7c907a768__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 64925
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64925/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64925/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.49.210/tcp/64926/p2p/16Uiu2HAm891Uagmyc8QtacGfvNQWxn6ybWsFuC7NUe2HWms2ZcjB","/ip4/172.18.49.210/tcp/64927/ws/p2p/16Uiu2HAm891Uagmyc8QtacGfvNQWxn6ybWsFuC7NUe2HWms2ZcjB"],"enrUri":"enr:-LO4QG-k7Rwp1Z2GeCJ4ocWpxK-heb88sGC5axNc0roWyg9lATYdPlDyKnsF7upZkCmg5Qc8fQvFBYZwoxE0uvkMGk0BgmlkgnY0gmlwhKwSMdKKbXVsdGlhZGRyc4wACgSsEjHSBv2f3QOCcnOFAAMBAACJc2VjcDI1NmsxoQK84xnTGh2TOSV-ZJ4P-4dOxsJpCFzE3vgHzoNcJFVqSoN0Y3CC_Z6DdWRwgv2ghXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-08-26_04-21-31__42ea38ad-0c83-41f5-888e-50c7c907a768__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.160.144
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['54812', '54813', '54814', '54815', '54816']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 54812:54812 -p 54813:54813 -p 54814:54814 -p 54815:54815 -p 54816:54816 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54814 --rest-port=54812 --tcp-port=54813 --discv5-udp-port=54815 --rest-address=0.0.0.0 --nat=extip:172.18.160.144 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a84ac5fe674dafedbd8187cd908c4a1fb0deb04f6e29e984ed6a15aa8ae25aa4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54816 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.160.144 waku 6f8883bc32471b4f24db440c3d8b8a0be23f831159db416bc6342b518aa8d2db
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 6f8883bc3247. Setting up logs at ./log/docker/receiving_node2_2024-08-26_04-21-31__42ea38ad-0c83-41f5-888e-50c7c907a768__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 54812
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54812/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54812/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.160.144/tcp/54813/p2p/16Uiu2HAmD12Vvc8bsapBnQwoQfHBt7kuN3FsLdoGmq5Bn1riU2kv","/ip4/172.18.160.144/tcp/54814/ws/p2p/16Uiu2HAmD12Vvc8bsapBnQwoQfHBt7kuN3FsLdoGmq5Bn1riU2kv"],"enrUri":"enr:-LO4QF8Hy45REgnmQwuadddZy8o76HMUHIoRfK0kYFEm6UE0UonbwdCJfoxdXqkYXtuiKzz8LmI1CRmOcz1HfuXcR5wBgmlkgnY0gmlwhKwSoJCKbXVsdGlhZGRyc4wACgSsEqCQBtYe3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMFIgvCGmNslh25afN7Jw_s52mWht8PSVGxymBZAuRu_4N0Y3CC1h2DdWRwgtYfhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54812/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.49.210/tcp/64926/p2p/16Uiu2HAm891Uagmyc8QtacGfvNQWxn6ybWsFuC7NUe2HWms2ZcjB"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-26_04-21-31__42ea38ad-0c83-41f5-888e-50c7c907a768__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.225.139
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['38410', '38411', '38412', '38413', '38414']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 38410:38410 -p 38411:38411 -p 38412:38412 -p 38413:38413 -p 38414:38414 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38412 --rest-port=38410 --tcp-port=38411 --discv5-udp-port=38413 --rest-address=0.0.0.0 --nat=extip:172.18.225.139 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=188828280c621adfdebbb99bc4fac36a23403ae5bafeb9d851e77cef77d5bf25 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38414 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QG-k7Rwp1Z2GeCJ4ocWpxK-heb88sGC5axNc0roWyg9lATYdPlDyKnsF7upZkCmg5Qc8fQvFBYZwoxE0uvkMGk0BgmlkgnY0gmlwhKwSMdKKbXVsdGlhZGRyc4wACgSsEjHSBv2f3QOCcnOFAAMBAACJc2VjcDI1NmsxoQK84xnTGh2TOSV-ZJ4P-4dOxsJpCFzE3vgHzoNcJFVqSoN0Y3CC_Z6DdWRwgv2ghXdha3UyCQ --lightpushnode=/ip4/172.18.49.210/tcp/64926/p2p/16Uiu2HAm891Uagmyc8QtacGfvNQWxn6ybWsFuC7NUe2HWms2ZcjB --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.225.139 waku a6730fdc4e2d364830875074b6cac0a3ee40c7e3bf507555c4d2cf0663c87b4c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a6730fdc4e2d. Setting up logs at ./log/docker/lightpush_node1_2024-08-26_04-21-31__42ea38ad-0c83-41f5-888e-50c7c907a768__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 38410
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38410/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38410/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.225.139/tcp/38411/p2p/16Uiu2HAm4e1JgWNzpkQAxwufAq8hMvht8b1fobe5W4u3dwAgY14L","/ip4/172.18.225.139/tcp/38412/ws/p2p/16Uiu2HAm4e1JgWNzpkQAxwufAq8hMvht8b1fobe5W4u3dwAgY14L"],"enrUri":"enr:-LO4QLtYS-lbkBMo3j3Uljf_i5C06xPVnhtJsEih0_6SQbdJIU_EvMDXI1DCISnSe2Lb0vnuJMRJKRI_cYjRp2v5lH8BgmlkgnY0gmlwhKwS4YuKbXVsdGlhZGRyc4wACgSsEuGLBpYM3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKI4gDuuyFvafAaCnn1jVMfH2RRbUdzWnOPq2LxTZH1KYN0Y3CClguDdWRwgpYNhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38410/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.49.210/tcp/64926/p2p/16Uiu2HAm891Uagmyc8QtacGfvNQWxn6ybWsFuC7NUe2HWms2ZcjB"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38410/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.160.144/tcp/54813/p2p/16Uiu2HAmD12Vvc8bsapBnQwoQfHBt7kuN3FsLdoGmq5Bn1riU2kv"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64925/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54812/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38410/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724646096509486080, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64925/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724646096509486080,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54812/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724646096509486080,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38410/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724646096632523264, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64925/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724646096632523264,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54812/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724646096632523264,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id f0f846e79be7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 6f8883bc3247
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id a6730fdc4e2d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.