[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_refresh_existing with id: 2024-08-26_04-17-48__4fbb1488-3674-4493-94d2-770379b11bbe
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-26_04-17-48__4fbb1488-3674-4493-94d2-770379b11bbe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.154.110
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['21376', '21377', '21378', '21379', '21380']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 21376:21376 -p 21377:21377 -p 21378:21378 -p 21379:21379 -p 21380:21380 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21378 --rest-port=21376 --tcp-port=21377 --discv5-udp-port=21379 --rest-address=0.0.0.0 --nat=extip:172.18.154.110 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5e21e5e6fd1a7efb5f2f2bdbe0efbb3dabc99dfabdfad3d8d6d5c71abc42747a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21380 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.154.110 waku fab75fd6abc6a9b11d71da146add0222df70504c4c1872d036347aef2c27117b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID fab75fd6abc6. Setting up logs at ./log/docker/node1_2024-08-26_04-17-48__4fbb1488-3674-4493-94d2-770379b11bbe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 21376
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21376/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21376/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.154.110/tcp/21377/p2p/16Uiu2HAkzyC8pgLcXr4LFd8Vfgq8jqTNX1pXhUAbiFrwiNf6mH9t","/ip4/172.18.154.110/tcp/21378/ws/p2p/16Uiu2HAkzyC8pgLcXr4LFd8Vfgq8jqTNX1pXhUAbiFrwiNf6mH9t"],"enrUri":"enr:-LO4QAj2srwJWcZVhs7t1CBXw0h96b1iUPYLaMjQ6iEbeqQ0MP46F_xB_siwM0VkUkPh2pwsXzWUen2zx1xcAyAiG6kBgmlkgnY0gmlwhKwSmm6KbXVsdGlhZGRyc4wACgSsEppuBlOC3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJSXYlu0Rpfb8fs772fTv17O2yE5fYRmWAL4ZY7ORrL84N0Y3CCU4GDdWRwglODhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-26_04-17-48__4fbb1488-3674-4493-94d2-770379b11bbe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.235.126
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['31478', '31479', '31480', '31481', '31482']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 31478:31478 -p 31479:31479 -p 31480:31480 -p 31481:31481 -p 31482:31482 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31480 --rest-port=31478 --tcp-port=31479 --discv5-udp-port=31481 --rest-address=0.0.0.0 --nat=extip:172.18.235.126 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b62acd3c45efdddd2dab3c29be92a2e1f432de8c1972bfdb2efe0ddb0591672f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31482 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QAj2srwJWcZVhs7t1CBXw0h96b1iUPYLaMjQ6iEbeqQ0MP46F_xB_siwM0VkUkPh2pwsXzWUen2zx1xcAyAiG6kBgmlkgnY0gmlwhKwSmm6KbXVsdGlhZGRyc4wACgSsEppuBlOC3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJSXYlu0Rpfb8fs772fTv17O2yE5fYRmWAL4ZY7ORrL84N0Y3CCU4GDdWRwglODhXdha3UyBQ --filternode=/ip4/172.18.154.110/tcp/21377/p2p/16Uiu2HAkzyC8pgLcXr4LFd8Vfgq8jqTNX1pXhUAbiFrwiNf6mH9t
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.235.126 waku d671a6e0687401cfbc3ede0fdc11830479e1271551694d89f9570d13dbd5fe77
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID d671a6e06874. Setting up logs at ./log/docker/node2_2024-08-26_04-17-48__4fbb1488-3674-4493-94d2-770379b11bbe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 31478
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31478/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31478/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.126/tcp/31479/p2p/16Uiu2HAmPzcTk8AkfdQNHZtdSk4qtctg5S1ogWhCHZSKAQNQRhP3","/ip4/172.18.235.126/tcp/31480/ws/p2p/16Uiu2HAmPzcTk8AkfdQNHZtdSk4qtctg5S1ogWhCHZSKAQNQRhP3"],"enrUri":"enr:-LO4QAzJSxwMYjoxOW2hhouYKKYgiIXD5jMwIabgyz1HkPpkOXi1eqwgAb8hL8eTxL0_eewLCfD2XSLiSrQ0kQa4a2YBgmlkgnY0gmlwhKwS636KbXVsdGlhZGRyc4wACgSsEut-Bnr43QOCcnOFAAMBAACJc2VjcDI1NmsxoQOod2w3b2es5fyzjkQKQj552WmwIvwfokdraTGRCBGTLoN0Y3CCeveDdWRwgnr5hXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31478/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.154.110/tcp/21377/p2p/16Uiu2HAkzyC8pgLcXr4LFd8Vfgq8jqTNX1pXhUAbiFrwiNf6mH9t"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21376/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31478/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "0d15487e-557d-43e4-b821-9f043ccca397", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"0d15487e-557d-43e4-b821-9f043ccca397","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:31478/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31478/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1724645871561505792,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id fab75fd6abc6
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id d671a6e06874
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.