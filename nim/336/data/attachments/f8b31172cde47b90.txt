[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_get_message_with_ephemeral with id: 2024-08-28_04-15-31__155d8c41-bbd7-480a-a9ab-ac567ca53cc1
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-28_04-15-31__155d8c41-bbd7-480a-a9ab-ac567ca53cc1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.14.181
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['25918', '25919', '25920', '25921', '25922']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 25918:25918 -p 25919:25919 -p 25920:25920 -p 25921:25921 -p 25922:25922 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25920 --rest-port=25918 --tcp-port=25919 --discv5-udp-port=25921 --rest-address=0.0.0.0 --nat=extip:172.18.14.181 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b3c370baab51a493db2df11d3e0a435fe3499223b1a9baff766f4e722ee78dcf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25922 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.14.181 waku 82230b29f7aeda49749b69f19c6083a630a1dfce29d548860ca2c5c3fb46a49c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 82230b29f7ae. Setting up logs at ./log/docker/node1_2024-08-28_04-15-31__155d8c41-bbd7-480a-a9ab-ac567ca53cc1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 25918
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25918/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25918/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.14.181/tcp/25919/p2p/16Uiu2HAky9zNsnrA5qD435fy2SWFhemPZcsEboPuFmR7m7buMJKu","/ip4/172.18.14.181/tcp/25920/ws/p2p/16Uiu2HAky9zNsnrA5qD435fy2SWFhemPZcsEboPuFmR7m7buMJKu"],"enrUri":"enr:-LO4QDxUVnV2gs_E3aKA92WmC6K-95C-GAfeOnHwvypUwhdJLATrUzTCYaNnKdKpxsGe4qV-iQbRTb_Ds1410vSqBQ4BgmlkgnY0gmlwhKwSDrWKbXVsdGlhZGRyc4wACgSsEg61BmVA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI3akHmpI2igUhz0vaH3ML3Lyk6KBJHeJsGO5C0hWL-zIN0Y3CCZT-DdWRwgmVBhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-28_04-15-31__155d8c41-bbd7-480a-a9ab-ac567ca53cc1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.40.217
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['60932', '60933', '60934', '60935', '60936']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 60932:60932 -p 60933:60933 -p 60934:60934 -p 60935:60935 -p 60936:60936 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60934 --rest-port=60932 --tcp-port=60933 --discv5-udp-port=60935 --rest-address=0.0.0.0 --nat=extip:172.18.40.217 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e005af1e1debb224da8caa0881fdcef85ac8febfd6afa8cdba5bcd799a2be2ea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60936 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QDxUVnV2gs_E3aKA92WmC6K-95C-GAfeOnHwvypUwhdJLATrUzTCYaNnKdKpxsGe4qV-iQbRTb_Ds1410vSqBQ4BgmlkgnY0gmlwhKwSDrWKbXVsdGlhZGRyc4wACgSsEg61BmVA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI3akHmpI2igUhz0vaH3ML3Lyk6KBJHeJsGO5C0hWL-zIN0Y3CCZT-DdWRwgmVBhXdha3UyBQ --filternode=/ip4/172.18.14.181/tcp/25919/p2p/16Uiu2HAky9zNsnrA5qD435fy2SWFhemPZcsEboPuFmR7m7buMJKu
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.40.217 waku ac6f9a034f442fbfd5f58da90ff40acfbab6322d47ed8aa425ed43c9e90d8482
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ac6f9a034f44. Setting up logs at ./log/docker/node2_2024-08-28_04-15-31__155d8c41-bbd7-480a-a9ab-ac567ca53cc1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 60932
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60932/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60932/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.40.217/tcp/60933/p2p/16Uiu2HAmNHCBFkZg5ekzSgZq6DzpWw3huND2idRveWeAjumMYyH1","/ip4/172.18.40.217/tcp/60934/ws/p2p/16Uiu2HAmNHCBFkZg5ekzSgZq6DzpWw3huND2idRveWeAjumMYyH1"],"enrUri":"enr:-LO4QBNlbjImY9ZrHSqtIKmjsVxBA69NtOErkMLxDkbKipr_O6sP1DjR1CHqxaFahqsSbgXvxAKEcDpgbsRYJV8qysoBgmlkgnY0gmlwhKwSKNmKbXVsdGlhZGRyc4wACgSsEijZBu4G3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOO_3bbIWcWynoBm0Tc5QJkj7IML3wYfdGcjm-lHQMgGIN0Y3CC7gWDdWRwgu4HhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60932/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.14.181/tcp/25919/p2p/16Uiu2HAky9zNsnrA5qD435fy2SWFhemPZcsEboPuFmR7m7buMJKu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25918/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60932/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "66171abb-699c-48fd-b472-de7f155e44d1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"66171abb-699c-48fd-b472-de7f155e44d1","statusDesc":"OK"}'
[35mDEBUG   [0m tests.filter.test_get_messages:test_get_messages.py:48 Running test with Ephemeral True
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25918/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60932/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1724818533944145408,"ephemeral":true}]'
[35mDEBUG   [0m tests.filter.test_get_messages:test_get_messages.py:48 Running test with Ephemeral False
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25918/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60932/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1724818534053938688,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 82230b29f7ae
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ac6f9a034f44
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.