[35mDEBUG   [0m src.postgres_setup:postgres_setup.py:36 Postgres container started
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_on_empty_postgress_db with id: 2024-08-28_04-32-07__feefcc0c-4c12-4e20-894f-a339fdb1fb0b
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-08-28_04-32-07__feefcc0c-4c12-4e20-894f-a339fdb1fb0b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.47.168
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['65267', '65268', '65269', '65270', '65271']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 65267:65267 -p 65268:65268 -p 65269:65269 -p 65270:65270 -p 65271:65271 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65269 --rest-port=65267 --tcp-port=65268 --discv5-udp-port=65270 --rest-address=0.0.0.0 --nat=extip:172.18.47.168 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0cf18eb00a8e8676792baa2fe3bdf7eecd8bc0ce13e7d7dbf4a9e9c7baeca4b8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65271 --metrics-logging=true --store=true --relay=true --store-message-db-url=postgres://postgres:test123@postgres:5432/postgres
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.47.168 waku ad16dda48b3e247e7e1b43703ea02c85c3196033d3c70636e7f39850e75b880e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ad16dda48b3e. Setting up logs at ./log/docker/publishing_node1_2024-08-28_04-32-07__feefcc0c-4c12-4e20-894f-a339fdb1fb0b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 65267
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65267/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Initializing","protocolsHealth":[]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65267/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Initializing","protocolsHealth":[]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65267/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65267/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.47.168/tcp/65268/p2p/16Uiu2HAkzGEotS1fb2pm8963DBdC9vtVZR7VfsrQ6zpVdAXHLrEG","/ip4/172.18.47.168/tcp/65269/ws/p2p/16Uiu2HAkzGEotS1fb2pm8963DBdC9vtVZR7VfsrQ6zpVdAXHLrEG"],"enrUri":"enr:-LO4QFWeOYJ_ShGP7vDP3P8ufD7fPCeUrOIOlXa7Lm-JIzLxHXHMGQDxSOdqXZZC9KObnStOcDhfmr_43bykw-OLqvsBgmlkgnY0gmlwhKwSL6iKbXVsdGlhZGRyc4wACgSsEi-oBv713QOCcnOFAAMBAACJc2VjcDI1NmsxoQJH378kF20xzwCIRFiOGFiEqDmyZn1c9PI4pVFVypph3YN0Y3CC_vSDdWRwgv72hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-08-28_04-32-07__feefcc0c-4c12-4e20-894f-a339fdb1fb0b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.221.180
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['49243', '49244', '49245', '49246', '49247']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 49243:49243 -p 49244:49244 -p 49245:49245 -p 49246:49246 -p 49247:49247 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49245 --rest-port=49243 --tcp-port=49244 --discv5-udp-port=49246 --rest-address=0.0.0.0 --nat=extip:172.18.221.180 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=35df1a1a87bf6cfaa2a8ea5fcaeefffffdc463ba6d4f57cd37bee9a39d106c58 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49247 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QFWeOYJ_ShGP7vDP3P8ufD7fPCeUrOIOlXa7Lm-JIzLxHXHMGQDxSOdqXZZC9KObnStOcDhfmr_43bykw-OLqvsBgmlkgnY0gmlwhKwSL6iKbXVsdGlhZGRyc4wACgSsEi-oBv713QOCcnOFAAMBAACJc2VjcDI1NmsxoQJH378kF20xzwCIRFiOGFiEqDmyZn1c9PI4pVFVypph3YN0Y3CC_vSDdWRwgv72hXdha3UyAw --storenode=/ip4/172.18.47.168/tcp/65268/p2p/16Uiu2HAkzGEotS1fb2pm8963DBdC9vtVZR7VfsrQ6zpVdAXHLrEG --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.221.180 waku 2d06f01409be7882848c7bd13832722744cc9e13827863ef83596c05ff4de258
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 2d06f01409be. Setting up logs at ./log/docker/store_node1_2024-08-28_04-32-07__feefcc0c-4c12-4e20-894f-a339fdb1fb0b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 49243
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49243/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49243/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.221.180/tcp/49244/p2p/16Uiu2HAm4kLjunGZmbtcxobBBqyzBm1YmSU9vYHNEK5ATi78A7yb","/ip4/172.18.221.180/tcp/49245/ws/p2p/16Uiu2HAm4kLjunGZmbtcxobBBqyzBm1YmSU9vYHNEK5ATi78A7yb"],"enrUri":"enr:-LO4QDh9wL4ho748yaryW8lbPILoARiqakahNFZJOauaFFL7I8iHmnbtAre8OJD3N3MiSZdqD21tS0fJJ310ygygSBsBgmlkgnY0gmlwhKwS3bSKbXVsdGlhZGRyc4wACgSsEt20BsBd3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKKgXa1A5Esx17pNHLZrFLKSUnMenZfECMM2mz2sV9GgoN0Y3CCwFyDdWRwgsBehXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49243/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.47.168/tcp/65268/p2p/16Uiu2HAkzGEotS1fb2pm8963DBdC9vtVZR7VfsrQ6zpVdAXHLrEG"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65267/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49243/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:128 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65267/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65267/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0r8MLo+abD22S5J4uTT8v2gvdyoq/n4TSnFN8wVpJJk="}]}'
[35mDEBUG   [0m src.steps.store:store.py:216 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49243/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"76e3d3698b8323954f19","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0r8MLo+abD22S5J4uTT8v2gvdyoq/n4TSnFN8wVpJJk="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ad16dda48b3e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 2d06f01409be
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.postgres_setup:postgres_setup.py:44 Postgres container stopped and removed.