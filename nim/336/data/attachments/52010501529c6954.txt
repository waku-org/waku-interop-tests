[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_missing_content_topic with id: 2024-08-28_04-24-32__59f68af7-150b-4db1-8bdd-096e091f5647
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-28_04-24-32__59f68af7-150b-4db1-8bdd-096e091f5647__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.16.53
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['1223', '1224', '1225', '1226', '1227']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 1223:1223 -p 1224:1224 -p 1225:1225 -p 1226:1226 -p 1227:1227 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1225 --rest-port=1223 --tcp-port=1224 --discv5-udp-port=1226 --rest-address=0.0.0.0 --nat=extip:172.18.16.53 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=21820e6b74b1cfc778cafbf1dc334eeb15f8d9a935efb7ca187bd5d172acd3fb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1227 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.16.53 waku 688ea5ce709e34b4b9b812c404c8bd3345c7c551c6c37a23d924bb4c7e625b1e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 688ea5ce709e. Setting up logs at ./log/docker/node1_2024-08-28_04-24-32__59f68af7-150b-4db1-8bdd-096e091f5647__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 1223
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1223/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1223/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.16.53/tcp/1224/p2p/16Uiu2HAm5zMbNoB3TeSbqC9q9P8mzWT9QbnTHJKhqW7zLbcz2f2A","/ip4/172.18.16.53/tcp/1225/ws/p2p/16Uiu2HAm5zMbNoB3TeSbqC9q9P8mzWT9QbnTHJKhqW7zLbcz2f2A"],"enrUri":"enr:-LO4QPFdxMyJQ1D3bud-VRPKUVTrmUl6t0zv4m6Dr9yqDRPCBVt1VcQrH5C6CMHCGjH2r4gl6T6dRAP_-rj9UCdUU5oBgmlkgnY0gmlwhKwSEDWKbXVsdGlhZGRyc4wACgSsEhA1BgTJ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKc9D8MZyhYzberLd14ppMEq71kTC6vm-m3Bfq3jiFQM4N0Y3CCBMiDdWRwggTKhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-28_04-24-32__59f68af7-150b-4db1-8bdd-096e091f5647__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.46.9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['21139', '21140', '21141', '21142', '21143']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 21139:21139 -p 21140:21140 -p 21141:21141 -p 21142:21142 -p 21143:21143 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21141 --rest-port=21139 --tcp-port=21140 --discv5-udp-port=21142 --rest-address=0.0.0.0 --nat=extip:172.18.46.9 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fcbe5a6dcbeadf2dbf9cedf1d79cbc57f7cabbcbd3cafe14e2ef7a00c64cfafe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21143 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QPFdxMyJQ1D3bud-VRPKUVTrmUl6t0zv4m6Dr9yqDRPCBVt1VcQrH5C6CMHCGjH2r4gl6T6dRAP_-rj9UCdUU5oBgmlkgnY0gmlwhKwSEDWKbXVsdGlhZGRyc4wACgSsEhA1BgTJ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKc9D8MZyhYzberLd14ppMEq71kTC6vm-m3Bfq3jiFQM4N0Y3CCBMiDdWRwggTKhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.46.9 waku bfa7e1c19756225584968a0585ddd3b82f3c0b4a0fbb010ae80147c5b2c50baf
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID bfa7e1c19756. Setting up logs at ./log/docker/node2_2024-08-28_04-24-32__59f68af7-150b-4db1-8bdd-096e091f5647__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 21139
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21139/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21139/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.46.9/tcp/21140/p2p/16Uiu2HAkw6baj9VU7ZAVjLpGM5kzjDNEYyY5Xq99Vybgkm4PpP3z","/ip4/172.18.46.9/tcp/21141/ws/p2p/16Uiu2HAkw6baj9VU7ZAVjLpGM5kzjDNEYyY5Xq99Vybgkm4PpP3z"],"enrUri":"enr:-LO4QO5sJHIlVNIFEoBhp99L-2zneziCZPilkT4S911x7R1OYeF0a_J2OTFifXe3yixg_p-boXijMNfXtp_H-IRYxnsBgmlkgnY0gmlwhKwSLgmKbXVsdGlhZGRyc4wACgSsEi4JBlKV3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIY1F2x6ZoXk9QFBwJUdN7BmtuycyNoQteo5UR9YQ5A3YN0Y3CCUpSDdWRwglKWhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21139/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.16.53/tcp/1224/p2p/16Uiu2HAm5zMbNoB3TeSbqC9q9P8mzWT9QbnTHJKhqW7zLbcz2f2A"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1223/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21139/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1223/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1223/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724819076029386496,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21139/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724819076029386496,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1223/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "timestamp": '$(date +%s%N)'}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:1223/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 688ea5ce709e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id bfa7e1c19756
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.