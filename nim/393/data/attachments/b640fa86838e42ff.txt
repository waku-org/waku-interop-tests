[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-10-16_04-09-30__44685822-9555-4b94-b820-c392aa2fa02d
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-16_04-09-30__44685822-9555-4b94-b820-c392aa2fa02d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.189.202
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['49051', '49052', '49053', '49054', '49055']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 49051:49051 -p 49052:49052 -p 49053:49053 -p 49054:49054 -p 49055:49055 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49053 --rest-port=49051 --tcp-port=49052 --discv5-udp-port=49054 --rest-address=0.0.0.0 --nat=extip:172.18.189.202 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=af9ce3eeb3e73aab8e9c5c3ab57b782f70c73c6a7af0bfcbcaf4daabf8ae0efc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49055 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.189.202 waku e6041045f18450d10b4c789bbbcf1bdb4aa2c417c91b30d4bc29981674010f7d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e6041045f184. Setting up logs at ./log/docker/receiving_node1_2024-10-16_04-09-30__44685822-9555-4b94-b820-c392aa2fa02d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 49051
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49051/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49051/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.189.202/tcp/49052/p2p/16Uiu2HAmBSDHNVPpmHUG9R29Edz9BUeH7WYgXjnwEgp7j5CrmYZ1","/ip4/172.18.189.202/tcp/49053/ws/p2p/16Uiu2HAmBSDHNVPpmHUG9R29Edz9BUeH7WYgXjnwEgp7j5CrmYZ1"],"enrUri":"enr:-LO4QE-O_h7ZmnDYlLWoBB1TDyqcmuVtXAAo1H9bh1fpJHHCPfXrRa9e842eMqyIHWhxuDydVWleGi-LcWSHrZQ7wjgBgmlkgnY0gmlwhKwSvcqKbXVsdGlhZGRyc4wACgSsEr3KBr-d3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLt3mKjuv3o3mUHoR7KeOTnHnaSrQG4BagtpYfq30PNbIN0Y3CCv5yDdWRwgr-ehXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-16_04-09-30__44685822-9555-4b94-b820-c392aa2fa02d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.12.138
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['10025', '10026', '10027', '10028', '10029']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 10025:10025 -p 10026:10026 -p 10027:10027 -p 10028:10028 -p 10029:10029 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10027 --rest-port=10025 --tcp-port=10026 --discv5-udp-port=10028 --rest-address=0.0.0.0 --nat=extip:172.18.12.138 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=99cf65e7c0f605ae565d432eaad73a00966bdbd7e48f7990ddca79484d9acdfe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10029 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.12.138 waku ab3ea4d209f472e66b7b67c32c611eec171e7047c9a040902bcf4b113b4d9ca5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ab3ea4d209f4. Setting up logs at ./log/docker/receiving_node2_2024-10-16_04-09-30__44685822-9555-4b94-b820-c392aa2fa02d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 10025
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10025/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10025/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.12.138/tcp/10026/p2p/16Uiu2HAmVJPzaeSpeWv1syiNcwopQpEWdQdWwwvV4PT6Zj3dPaqL","/ip4/172.18.12.138/tcp/10027/ws/p2p/16Uiu2HAmVJPzaeSpeWv1syiNcwopQpEWdQdWwwvV4PT6Zj3dPaqL"],"enrUri":"enr:-LO4QObv_SaFedZCtze2v_ytSjKrsj0tk-s3AEfah9c8BWjZB1F6SZJmlGr9Tr5d2uhBO0fRUd0SCu08TRGufsTK5I8BgmlkgnY0gmlwhKwSDIqKbXVsdGlhZGRyc4wACgSsEgyKBicr3QOCcnOFAAMBAACJc2VjcDI1NmsxoQP3UDbDyZMXP1f8QQAlYODF7t9O2cD3TTyJbjUnTIYNB4N0Y3CCJyqDdWRwgicshXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10025/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.189.202/tcp/49052/p2p/16Uiu2HAmBSDHNVPpmHUG9R29Edz9BUeH7WYgXjnwEgp7j5CrmYZ1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-16_04-09-30__44685822-9555-4b94-b820-c392aa2fa02d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.191.28
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['1654', '1655', '1656', '1657', '1658']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 1654:1654 -p 1655:1655 -p 1656:1656 -p 1657:1657 -p 1658:1658 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1656 --rest-port=1654 --tcp-port=1655 --discv5-udp-port=1657 --rest-address=0.0.0.0 --nat=extip:172.18.191.28 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=baa0ffc7a04b4853854ac72332865a358e0ee2a2b96cea0d36ca5fdea97cda1d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1658 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QE-O_h7ZmnDYlLWoBB1TDyqcmuVtXAAo1H9bh1fpJHHCPfXrRa9e842eMqyIHWhxuDydVWleGi-LcWSHrZQ7wjgBgmlkgnY0gmlwhKwSvcqKbXVsdGlhZGRyc4wACgSsEr3KBr-d3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLt3mKjuv3o3mUHoR7KeOTnHnaSrQG4BagtpYfq30PNbIN0Y3CCv5yDdWRwgr-ehXdha3UyCQ --lightpushnode=/ip4/172.18.189.202/tcp/49052/p2p/16Uiu2HAmBSDHNVPpmHUG9R29Edz9BUeH7WYgXjnwEgp7j5CrmYZ1 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.191.28 waku 8656d5da85a645e591b7894836ef860005dc78f6f0a41020a1473daf974857fe
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 8656d5da85a6. Setting up logs at ./log/docker/lightpush_node1_2024-10-16_04-09-30__44685822-9555-4b94-b820-c392aa2fa02d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 1654
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1654/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1654/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.191.28/tcp/1655/p2p/16Uiu2HAmVmFUYvKvAR9sD4qJWM5oGS7Nu1GUfAUxyrtFGaRGj5RT","/ip4/172.18.191.28/tcp/1656/ws/p2p/16Uiu2HAmVmFUYvKvAR9sD4qJWM5oGS7Nu1GUfAUxyrtFGaRGj5RT"],"enrUri":"enr:-LO4QJbqsaSpKTcnFlkRcEvLbqon-vhEQGPZr1axmrSDpx7Oe5MjcmGXl3roOPRW6PQBTrnoifQRo9q_tYDvscXssd8BgmlkgnY0gmlwhKwSvxyKbXVsdGlhZGRyc4wACgSsEr8cBgZ43QOCcnOFAAMBAACJc2VjcDI1NmsxoQP-MUPEUHrnNdBM0wcNTqhZrCTkCmgcv85D2nyptwYrWoN0Y3CCBneDdWRwggZ5hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1654/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.189.202/tcp/49052/p2p/16Uiu2HAmBSDHNVPpmHUG9R29Edz9BUeH7WYgXjnwEgp7j5CrmYZ1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1654/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.12.138/tcp/10026/p2p/16Uiu2HAmVJPzaeSpeWv1syiNcwopQpEWdQdWwwvV4PT6Zj3dPaqL"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49051/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10025/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1654/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1729051776103865088}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49051/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729051776103865088,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10025/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729051776103865088,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1654/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1729051776103865088}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:1654/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e6041045f184
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ab3ea4d209f4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 8656d5da85a6
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.