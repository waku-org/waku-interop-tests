[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-09-07_04-23-21__15a6f90d-788f-4002-8d6b-ee2014ae60ef
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-07_04-23-21__15a6f90d-788f-4002-8d6b-ee2014ae60ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.127.24
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['44477', '44478', '44479', '44480', '44481']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 44477:44477 -p 44478:44478 -p 44479:44479 -p 44480:44480 -p 44481:44481 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44479 --rest-port=44477 --tcp-port=44478 --discv5-udp-port=44480 --rest-address=0.0.0.0 --nat=extip:172.18.127.24 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8073fcdedbe5197271be9f3e629d2bef2cc9a516cdbedc5acaf8db01c949ebb3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44481 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.127.24 waku 732aec7af389b2cc11a0744e851e81d360e987fa999182ada32031a6e0554779
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 732aec7af389. Setting up logs at ./log/docker/receiving_node1_2024-09-07_04-23-21__15a6f90d-788f-4002-8d6b-ee2014ae60ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 44477
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44477/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44477/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.127.24/tcp/44478/p2p/16Uiu2HAmPptMxuFHM95ZpdDt4PPtiny7vrriGKVgiMkGNcyDgaga","/ip4/172.18.127.24/tcp/44479/ws/p2p/16Uiu2HAmPptMxuFHM95ZpdDt4PPtiny7vrriGKVgiMkGNcyDgaga"],"enrUri":"enr:-LO4QBa08ODFovdDCTGSWJQvOqtYAmCItqBw5lxyI5ywRnjGAdkClKI0l3I5DM_c0w5MRwqfMpyEOd04uSLzHO6SY-ABgmlkgnY0gmlwhKwSfxiKbXVsdGlhZGRyc4wACgSsEn8YBq2_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOl-Zfc0KgXQEz5aEWfoO-67_W82_xWy9-E50PqLF76s4N0Y3CCrb6DdWRwgq3AhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-07_04-23-21__15a6f90d-788f-4002-8d6b-ee2014ae60ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.166.49
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['40393', '40394', '40395', '40396', '40397']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 40393:40393 -p 40394:40394 -p 40395:40395 -p 40396:40396 -p 40397:40397 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40395 --rest-port=40393 --tcp-port=40394 --discv5-udp-port=40396 --rest-address=0.0.0.0 --nat=extip:172.18.166.49 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2a7a8cd9d1a92f10affdfac013269a33bbd3badc7361fe4abbcfd0fb7a2f8ace --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40397 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.166.49 waku 024b1d556217f413b393820a22aa9c1d3b2adf8c0e1dc8150d5e286890b33817
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 024b1d556217. Setting up logs at ./log/docker/receiving_node2_2024-09-07_04-23-21__15a6f90d-788f-4002-8d6b-ee2014ae60ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 40393
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40393/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40393/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.166.49/tcp/40394/p2p/16Uiu2HAkxopUiMcEVnaF2uDVpMAQubwsU3eXLC7dg2MJPDDK1oHk","/ip4/172.18.166.49/tcp/40395/ws/p2p/16Uiu2HAkxopUiMcEVnaF2uDVpMAQubwsU3eXLC7dg2MJPDDK1oHk"],"enrUri":"enr:-LO4QLqF4f_r452lLJQwUIxg7Tarkv0KGnqsg-iTiW9oNUdkO8xnG4O4daptvsCC41OpbkkZlqrYHXEgORTbeFwaHi8BgmlkgnY0gmlwhKwSpjGKbXVsdGlhZGRyc4wACgSsEqYxBp3L3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIyP3KwhfI7Z7f9C47zteltXxUAcgi4J_bwhcifWgK144N0Y3CCncqDdWRwgp3MhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40393/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.127.24/tcp/44478/p2p/16Uiu2HAmPptMxuFHM95ZpdDt4PPtiny7vrriGKVgiMkGNcyDgaga"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-07_04-23-21__15a6f90d-788f-4002-8d6b-ee2014ae60ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.232.194
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['11612', '11613', '11614', '11615', '11616']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 11612:11612 -p 11613:11613 -p 11614:11614 -p 11615:11615 -p 11616:11616 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11614 --rest-port=11612 --tcp-port=11613 --discv5-udp-port=11615 --rest-address=0.0.0.0 --nat=extip:172.18.232.194 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dcf1bc377bfc65f1835c9e1b17d2b38ed9e8bba9af41fca26ffbca0facbafdfe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11616 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QBa08ODFovdDCTGSWJQvOqtYAmCItqBw5lxyI5ywRnjGAdkClKI0l3I5DM_c0w5MRwqfMpyEOd04uSLzHO6SY-ABgmlkgnY0gmlwhKwSfxiKbXVsdGlhZGRyc4wACgSsEn8YBq2_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOl-Zfc0KgXQEz5aEWfoO-67_W82_xWy9-E50PqLF76s4N0Y3CCrb6DdWRwgq3AhXdha3UyCQ --lightpushnode=/ip4/172.18.127.24/tcp/44478/p2p/16Uiu2HAmPptMxuFHM95ZpdDt4PPtiny7vrriGKVgiMkGNcyDgaga --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.232.194 waku f0353572117b53c6c1ae0bd627cfaa36fb7e9157097244d6ec87811f4b6fff36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID f0353572117b. Setting up logs at ./log/docker/lightpush_node1_2024-09-07_04-23-21__15a6f90d-788f-4002-8d6b-ee2014ae60ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 11612
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11612/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11612/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.232.194/tcp/11613/p2p/16Uiu2HAmDvm8TJmm1dFSqbnRbMwEDnaiRos5D8evJKfAaSAf8Egf","/ip4/172.18.232.194/tcp/11614/ws/p2p/16Uiu2HAmDvm8TJmm1dFSqbnRbMwEDnaiRos5D8evJKfAaSAf8Egf"],"enrUri":"enr:-LO4QP2S2yakPrffBPkAiV0aVjVQQ_SEUC_BAAoibVJl_RRBLl3qg7baY8kIuXJUKLwwTfJgh7e3pX18BJqc3KXZ-V8BgmlkgnY0gmlwhKwS6MKKbXVsdGlhZGRyc4wACgSsEujCBi1e3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMS5gfOt9JmYIagada0lLJvNylHZHlmyrKAyJN7vvD5qIN0Y3CCLV2DdWRwgi1fhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11612/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.127.24/tcp/44478/p2p/16Uiu2HAmPptMxuFHM95ZpdDt4PPtiny7vrriGKVgiMkGNcyDgaga"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11612/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.166.49/tcp/40394/p2p/16Uiu2HAkxopUiMcEVnaF2uDVpMAQubwsU3eXLC7dg2MJPDDK1oHk"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44477/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40393/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11612/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1725683006025643008}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44477/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1725683006025643008,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.127.24/tcp/44478"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.127.24/tcp/44478"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 732aec7af389
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 024b1d556217
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id f0353572117b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.