[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_get_message_after_node2_restarts with id: 2024-11-24_04-09-56__796fec2c-527c-4547-84d4-c1af6b85c801
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-24_04-09-56__796fec2c-527c-4547-84d4-c1af6b85c801__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.185.126
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['51020', '51021', '51022', '51023', '51024']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 51020:51020 -p 51021:51021 -p 51022:51022 -p 51023:51023 -p 51024:51024 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51022 --rest-port=51020 --tcp-port=51021 --discv5-udp-port=51023 --rest-address=0.0.0.0 --nat=extip:172.18.185.126 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2b458466d23a6ea7b8fcfc82ec59fcd6dfec1fcce9efeac4f9bdcbff76fb939a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51024 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.216.118
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['47023', '47024', '47025', '47026', '47027']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 47023:47023 -p 47024:47024 -p 47025:47025 -p 47026:47026 -p 47027:47027 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47025 --rest-port=47023 --tcp-port=47024 --discv5-udp-port=47026 --rest-address=0.0.0.0 --nat=extip:172.18.216.118 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=83f00efbaaadcc45fc3acd2c3fb6b8608c0dcece05f3afcd41edbfbadb4e86da --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47027 --metrics-logging=true --relay=true --filter=true
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 4b8338005dd5. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.216.118 waku f5e47a1568a8304f529f1b2b19f902540d388e6b5db3a1cab35c1d15fb2c421f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f5e47a1568a8. Setting up logs at ./log/docker/node1_2024-11-24_04-09-56__796fec2c-527c-4547-84d4-c1af6b85c801__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 47023
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47023/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47023/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.216.118/tcp/47024/p2p/16Uiu2HAm1ijatQL3zaTLqNxQJ7FsMWtq1HSiWjFB7G4ikTgNVudV","/ip4/172.18.216.118/tcp/47025/ws/p2p/16Uiu2HAm1ijatQL3zaTLqNxQJ7FsMWtq1HSiWjFB7G4ikTgNVudV"],"enrUri":"enr:-L24QHO9qy1JSI3cW73XOxwoSAN8IfZ30jxJNDryeIScI2LqCMW0luK7D3Y09yHONd37CO4NpNna2de7dOU3LR4QLuECgmlkgnY0gmlwhKwS2HaKbXVsdGlhZGRyc5YACASsEth2BrewAAoErBLYdga3sd0DgnJzhQADAQAAiXNlY3AyNTZrMaECXYUSUkeGVKcXlHEWzF5Kz1I-MG09tUAJsNqyBCHMFqSDdGNwgrewg3VkcIK3soV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-24_04-09-56__796fec2c-527c-4547-84d4-c1af6b85c801__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.199.129
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['58113', '58114', '58115', '58116', '58117']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 58113:58113 -p 58114:58114 -p 58115:58115 -p 58116:58116 -p 58117:58117 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58115 --rest-port=58113 --tcp-port=58114 --discv5-udp-port=58116 --rest-address=0.0.0.0 --nat=extip:172.18.199.129 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ebad3dcbc96a9fcf5aea2a16969dbcaedbccdebbe762dcf54d3adccf2f2c5d8b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58117 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QHO9qy1JSI3cW73XOxwoSAN8IfZ30jxJNDryeIScI2LqCMW0luK7D3Y09yHONd37CO4NpNna2de7dOU3LR4QLuECgmlkgnY0gmlwhKwS2HaKbXVsdGlhZGRyc5YACASsEth2BrewAAoErBLYdga3sd0DgnJzhQADAQAAiXNlY3AyNTZrMaECXYUSUkeGVKcXlHEWzF5Kz1I-MG09tUAJsNqyBCHMFqSDdGNwgrewg3VkcIK3soV3YWt1MgU --filternode=/ip4/172.18.216.118/tcp/47024/p2p/16Uiu2HAm1ijatQL3zaTLqNxQJ7FsMWtq1HSiWjFB7G4ikTgNVudV
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.199.129 waku 163c1115f58ac871d57e8447bc0237b4e6af125f6cb6abd72fe90167dc7f2847
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 163c1115f58a. Setting up logs at ./log/docker/node2_2024-11-24_04-09-56__796fec2c-527c-4547-84d4-c1af6b85c801__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 58113
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58113/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58113/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.199.129/tcp/58114/p2p/16Uiu2HAmKZuT1g58j3zJo3nAAUKE8VLFQ29rCHsADaGGnrDa5Ujy","/ip4/172.18.199.129/tcp/58115/ws/p2p/16Uiu2HAmKZuT1g58j3zJo3nAAUKE8VLFQ29rCHsADaGGnrDa5Ujy"],"enrUri":"enr:-L24QMWlCrUle9ILUCefwWNTFlHaIb_cMtzH8s3T4bNJKbLHaCXqBF1u9MRbgmEthB1XOuGVwdNTcyYKwSNn_AWqEgACgmlkgnY0gmlwhKwSx4GKbXVsdGlhZGRyc5YACASsEseBBuMCAAoErBLHgQbjA90DgnJzhQADAQAAiXNlY3AyNTZrMaEDZrRcy5jXKxD7tz1QhCXc-JscITGLL3fb6sBANf53W3iDdGNwguMCg3VkcILjBIV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58113/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.216.118/tcp/47024/p2p/16Uiu2HAm1ijatQL3zaTLqNxQJ7FsMWtq1HSiWjFB7G4ikTgNVudV"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47023/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58113/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d043780d-e297-49a5-b0ef-eeac78470145", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"d043780d-e297-49a5-b0ef-eeac78470145","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47023/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58113/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1732421399856199424,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:246 Restarting container with id 163c1115f58a
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58113/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58113/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.199.129/tcp/58114/p2p/16Uiu2HAmKZuT1g58j3zJo3nAAUKE8VLFQ29rCHsADaGGnrDa5Ujy","/ip4/172.18.199.129/tcp/58115/ws/p2p/16Uiu2HAmKZuT1g58j3zJo3nAAUKE8VLFQ29rCHsADaGGnrDa5Ujy"],"enrUri":"enr:-L24QMWlCrUle9ILUCefwWNTFlHaIb_cMtzH8s3T4bNJKbLHaCXqBF1u9MRbgmEthB1XOuGVwdNTcyYKwSNn_AWqEgACgmlkgnY0gmlwhKwSx4GKbXVsdGlhZGRyc5YACASsEseBBuMCAAoErBLHgQbjA90DgnJzhQADAQAAiXNlY3AyNTZrMaEDZrRcy5jXKxD7tz1QhCXc-JscITGLL3fb6sBANf53W3iDdGNwguMCg3VkcILjBIV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47023/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58113/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d096c816-731b-49a3-be4b-fdfe6accafa7", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"d096c816-731b-49a3-be4b-fdfe6accafa7","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47023/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58113/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1732421404891251968,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id f5e47a1568a8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 163c1115f58a
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f5e47a1568a8. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.