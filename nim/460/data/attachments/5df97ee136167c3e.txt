[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-11-24_04-15-48__fba78e94-e47c-404e-978a-1bd71554d6cc
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-24_04-15-48__fba78e94-e47c-404e-978a-1bd71554d6cc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.200.89
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['34645', '34646', '34647', '34648', '34649']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 34645:34645 -p 34646:34646 -p 34647:34647 -p 34648:34648 -p 34649:34649 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34647 --rest-port=34645 --tcp-port=34646 --discv5-udp-port=34648 --rest-address=0.0.0.0 --nat=extip:172.18.200.89 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4af9bfc4f2cce70f4fc49eebae51607f3031c1a63a799a4e2c229bdade8332ea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34649 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.200.89 waku 899bb7172158b5315d37be3c5a0e68e5fef3c684cc0a7d93ba7b2fb7ebf14df2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 899bb7172158. Setting up logs at ./log/docker/receiving_node1_2024-11-24_04-15-48__fba78e94-e47c-404e-978a-1bd71554d6cc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 34645
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 954a2ce201fe. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34645/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34645/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.200.89/tcp/34646/p2p/16Uiu2HAmLCVr33z7YwMaMb7SP9wJyfxJdrAbQY4Feq8KU4Zvdr6F","/ip4/172.18.200.89/tcp/34647/ws/p2p/16Uiu2HAmLCVr33z7YwMaMb7SP9wJyfxJdrAbQY4Feq8KU4Zvdr6F"],"enrUri":"enr:-L24QDmTmzsyykPJ5bBT8AUHu1Q5zDtkl2NKUl0QDLZ4GO4gMsbCnj6C8nO0as_BfWw21bMZDo0JQaur0UoyqNWLBUcCgmlkgnY0gmlwhKwSyFmKbXVsdGlhZGRyc5YACASsEshZBodWAAoErBLIWQaHV90DgnJzhQADAQAAiXNlY3AyNTZrMaEDcBQqFJO7p1VrwMm91XwrUy-0HZ7kWIcw6_q7daw52USDdGNwgodWg3VkcIKHWIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-24_04-15-48__fba78e94-e47c-404e-978a-1bd71554d6cc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.82.178
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['55838', '55839', '55840', '55841', '55842']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 55838:55838 -p 55839:55839 -p 55840:55840 -p 55841:55841 -p 55842:55842 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55840 --rest-port=55838 --tcp-port=55839 --discv5-udp-port=55841 --rest-address=0.0.0.0 --nat=extip:172.18.82.178 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1f3f08bcdbf4b66b09f67eb6af6ecc5ec152c82ab4f7fcc63ed3d55ded80dfeb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55842 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.82.178 waku 03956271ee1b0c53f5e7e14f6bfd63730c91d411bb69054b8f2487e7cc7a97b3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 03956271ee1b. Setting up logs at ./log/docker/receiving_node2_2024-11-24_04-15-48__fba78e94-e47c-404e-978a-1bd71554d6cc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 55838
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55838/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55838/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.82.178/tcp/55839/p2p/16Uiu2HAm6UrcndoG1e9bt26LHqgdddSPVUsED8pmvESfikJvriRP","/ip4/172.18.82.178/tcp/55840/ws/p2p/16Uiu2HAm6UrcndoG1e9bt26LHqgdddSPVUsED8pmvESfikJvriRP"],"enrUri":"enr:-L24QJ3Xql-VcKhvs63jGT5QuJHHWJSTJaocZ5EBBmC8u1FbNtChVgCnCbW-wWDBacXpJ4vV6GeF6mzZH4P05BNZ4RQCgmlkgnY0gmlwhKwSUrKKbXVsdGlhZGRyc5YACASsElKyBtofAAoErBJSsgbaIN0DgnJzhQADAQAAiXNlY3AyNTZrMaECpEFTrGEe7GBMwvuWBBLUmhdbAsnzgdWspuMjgPu6bSKDdGNwgtofg3VkcILaIYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55838/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.200.89/tcp/34646/p2p/16Uiu2HAmLCVr33z7YwMaMb7SP9wJyfxJdrAbQY4Feq8KU4Zvdr6F"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-24_04-15-48__fba78e94-e47c-404e-978a-1bd71554d6cc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.251.7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3937', '3938', '3939', '3940', '3941']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3937:3937 -p 3938:3938 -p 3939:3939 -p 3940:3940 -p 3941:3941 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3939 --rest-port=3937 --tcp-port=3938 --discv5-udp-port=3940 --rest-address=0.0.0.0 --nat=extip:172.18.251.7 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=70e32cbcdcf60eb2fdfcae24994b78f7cc9c98ed3cffacec6aabebe4cd98b3e0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3941 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QDmTmzsyykPJ5bBT8AUHu1Q5zDtkl2NKUl0QDLZ4GO4gMsbCnj6C8nO0as_BfWw21bMZDo0JQaur0UoyqNWLBUcCgmlkgnY0gmlwhKwSyFmKbXVsdGlhZGRyc5YACASsEshZBodWAAoErBLIWQaHV90DgnJzhQADAQAAiXNlY3AyNTZrMaEDcBQqFJO7p1VrwMm91XwrUy-0HZ7kWIcw6_q7daw52USDdGNwgodWg3VkcIKHWIV3YWt1Mgk --lightpushnode=/ip4/172.18.200.89/tcp/34646/p2p/16Uiu2HAmLCVr33z7YwMaMb7SP9wJyfxJdrAbQY4Feq8KU4Zvdr6F --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.251.7 waku c9e1c3e3c6b8bfe75b83e80a4ca13a2899df6fa1678ef0eeb300da2c73f4f2ea
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c9e1c3e3c6b8. Setting up logs at ./log/docker/lightpush_node1_2024-11-24_04-15-48__fba78e94-e47c-404e-978a-1bd71554d6cc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 3937
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3937/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3937/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.251.7/tcp/3938/p2p/16Uiu2HAm8Wh75dFiJvBrCA4BL6AYMrqVxQHoQArKmhJmSRW5gf13","/ip4/172.18.251.7/tcp/3939/ws/p2p/16Uiu2HAm8Wh75dFiJvBrCA4BL6AYMrqVxQHoQArKmhJmSRW5gf13"],"enrUri":"enr:-L24QAif6poMdZNQEALlu-IjSuvOoWGl8abZG5zQIqO2S3TBYu6nlqpTmHOLSODLbi21QxiQ6wD0qi_0VROaYoSBA_ECgmlkgnY0gmlwhKwS-weKbXVsdGlhZGRyc5YACASsEvsHBg9iAAoErBL7BwYPY90DgnJzhQADAQAAiXNlY3AyNTZrMaECwnEbWqECvBuNkLHsjDDm-Vocztpe9aUNyfZNvLQU2VKDdGNwgg9ig3VkcIIPZIV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3937/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.200.89/tcp/34646/p2p/16Uiu2HAmLCVr33z7YwMaMb7SP9wJyfxJdrAbQY4Feq8KU4Zvdr6F"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3937/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.82.178/tcp/55839/p2p/16Uiu2HAm6UrcndoG1e9bt26LHqgdddSPVUsED8pmvESfikJvriRP"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34645/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55838/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3937/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732421753726362880}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34645/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1732421753726362880,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55838/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1732421753726362880,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3937/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732421753726362880}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:3937/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 899bb7172158
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 03956271ee1b
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 899bb7172158. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id c9e1c3e3c6b8
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 03956271ee1b. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.