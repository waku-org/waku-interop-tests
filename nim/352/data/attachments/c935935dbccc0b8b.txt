[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-09-10_04-20-09__22289ce9-c674-4802-938e-c64c106bd265
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-10_04-20-09__22289ce9-c674-4802-938e-c64c106bd265__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.163.97
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['51227', '51228', '51229', '51230', '51231']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 51227:51227 -p 51228:51228 -p 51229:51229 -p 51230:51230 -p 51231:51231 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51229 --rest-port=51227 --tcp-port=51228 --discv5-udp-port=51230 --rest-address=0.0.0.0 --nat=extip:172.18.163.97 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6d98beed7ffadeaff8ce24b21be83f2eb4d073b7b5e69522bf3f2cd2acc41bc5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51231 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.163.97 waku 74df7bc81add8ae97823cc24e99a42e252f086235a63f045989443762551131d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 74df7bc81add. Setting up logs at ./log/docker/receiving_node1_2024-09-10_04-20-09__22289ce9-c674-4802-938e-c64c106bd265__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 51227
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51227/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51227/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.163.97/tcp/51228/p2p/16Uiu2HAmC9ix1UacWeQoa2yDnXGKMDhPo1BA4hYo9pJUZkfsFjLi","/ip4/172.18.163.97/tcp/51229/ws/p2p/16Uiu2HAmC9ix1UacWeQoa2yDnXGKMDhPo1BA4hYo9pJUZkfsFjLi"],"enrUri":"enr:-LO4QHdZmc_ji1HN0cajc5iZ9ZF56jivpN4wjlMd3p9_57hbJyVSeUjwiLaDRCHrI3XBD8TClXOTONmyiWUIpIZ9YqkBgmlkgnY0gmlwhKwSo2GKbXVsdGlhZGRyc4wACgSsEqNhBsgd3QOCcnOFAAMBAACJc2VjcDI1NmsxoQL4gL375kGer9yHd8LpUsOBqI9532EefkZFKEpYty6LL4N0Y3CCyByDdWRwgsgehXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-10_04-20-09__22289ce9-c674-4802-938e-c64c106bd265__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.100.159
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['48003', '48004', '48005', '48006', '48007']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 48003:48003 -p 48004:48004 -p 48005:48005 -p 48006:48006 -p 48007:48007 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48005 --rest-port=48003 --tcp-port=48004 --discv5-udp-port=48006 --rest-address=0.0.0.0 --nat=extip:172.18.100.159 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cdaf6db4f54ab6a16d3f6ba70aabaebee7bcb1263d0b6ef9adfcd4c0c3b7c4b3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48007 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.100.159 waku d06f4a91867f276863a05072940c1d0d65a64590e6ca775a90a6e58f12d2294c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID d06f4a91867f. Setting up logs at ./log/docker/receiving_node2_2024-09-10_04-20-09__22289ce9-c674-4802-938e-c64c106bd265__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 48003
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48003/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48003/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.100.159/tcp/48004/p2p/16Uiu2HAmAVsDZvjvCnApyyD5tb715PhKXd2KuH44xR37zndxBX3A","/ip4/172.18.100.159/tcp/48005/ws/p2p/16Uiu2HAmAVsDZvjvCnApyyD5tb715PhKXd2KuH44xR37zndxBX3A"],"enrUri":"enr:-LO4QCZpB8_kaQE0JrfjC2LJXIrdXHo2FqHoOlAiQ24Qmj_mQOR1g_u7hXdN3tt3vo_j9wRL1mV4-y7KKUGgJdyC2QgBgmlkgnY0gmlwhKwSZJ-KbXVsdGlhZGRyc4wACgSsEmSfBruF3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLf8lVakzWEWAKkfwmRtIu1orvoq6f9AeMCKx-yhdB69YN0Y3CCu4SDdWRwgruGhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48003/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.163.97/tcp/51228/p2p/16Uiu2HAmC9ix1UacWeQoa2yDnXGKMDhPo1BA4hYo9pJUZkfsFjLi"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-10_04-20-09__22289ce9-c674-4802-938e-c64c106bd265__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.138.4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['60134', '60135', '60136', '60137', '60138']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 60134:60134 -p 60135:60135 -p 60136:60136 -p 60137:60137 -p 60138:60138 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60136 --rest-port=60134 --tcp-port=60135 --discv5-udp-port=60137 --rest-address=0.0.0.0 --nat=extip:172.18.138.4 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3acbcbf9d98fba3a77252e8ba72d9419e03d4a0deed0bf75dcbee4de3a307c50 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60138 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QHdZmc_ji1HN0cajc5iZ9ZF56jivpN4wjlMd3p9_57hbJyVSeUjwiLaDRCHrI3XBD8TClXOTONmyiWUIpIZ9YqkBgmlkgnY0gmlwhKwSo2GKbXVsdGlhZGRyc4wACgSsEqNhBsgd3QOCcnOFAAMBAACJc2VjcDI1NmsxoQL4gL375kGer9yHd8LpUsOBqI9532EefkZFKEpYty6LL4N0Y3CCyByDdWRwgsgehXdha3UyCQ --lightpushnode=/ip4/172.18.163.97/tcp/51228/p2p/16Uiu2HAmC9ix1UacWeQoa2yDnXGKMDhPo1BA4hYo9pJUZkfsFjLi --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.138.4 waku 35a4c026dfebe21c5ac3f78eb6fa39550c6ca867031318349913a68f206d549f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 35a4c026dfeb. Setting up logs at ./log/docker/lightpush_node1_2024-09-10_04-20-09__22289ce9-c674-4802-938e-c64c106bd265__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 60134
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60134/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60134/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.138.4/tcp/60135/p2p/16Uiu2HAmH6mrqPziAbs5hpNFfP8wfQFprc83i2DT7zZC6RbSZWSY","/ip4/172.18.138.4/tcp/60136/ws/p2p/16Uiu2HAmH6mrqPziAbs5hpNFfP8wfQFprc83i2DT7zZC6RbSZWSY"],"enrUri":"enr:-LO4QA85lNrNNmWUW1lvHH5DYkjEPjjK-yAF4oU65O5EVc6SFE-1AF7cgrm1XDbQJrJ29WlvUInKN5rCsBAMx68fxJQBgmlkgnY0gmlwhKwSigSKbXVsdGlhZGRyc4wACgSsEooEBuro3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNCCbm_fB6C_xwk4mt1cnydmrXtCpqYSy2GqmZpMRQ3LYN0Y3CC6ueDdWRwgurphXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.163.97/tcp/51228/p2p/16Uiu2HAmC9ix1UacWeQoa2yDnXGKMDhPo1BA4hYo9pJUZkfsFjLi"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.100.159/tcp/48004/p2p/16Uiu2HAmAVsDZvjvCnApyyD5tb715PhKXd2KuH44xR37zndxBX3A"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51227/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48003/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725942014706049792}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60134/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725942014710737152}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60134/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725942014714041344}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60134/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725942014717541120}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60134/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725942014720908800}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60134/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60134/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725942014724444160}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60134/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 74df7bc81add
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d06f4a91867f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 35a4c026dfeb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.