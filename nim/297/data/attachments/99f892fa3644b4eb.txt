[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-08-03_04-16-32__543d3cf4-dd07-4896-9b79-92c45ad7ae6e
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-03_04-16-32__543d3cf4-dd07-4896-9b79-92c45ad7ae6e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.194.31
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['58439', '58440', '58441', '58442', '58443']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 58439:58439 -p 58440:58440 -p 58441:58441 -p 58442:58442 -p 58443:58443 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58441 --rest-port=58439 --tcp-port=58440 --discv5-udp-port=58442 --rest-address=0.0.0.0 --nat=extip:172.18.194.31 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58443 --metrics-logging=true --lightpush=true --relay=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.194.31 waku 45662c73492130522ecafa7322d9d42ac8352e1fee319beac191a0003d295b3e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 45662c734921. Setting up logs at ./log/docker/receiving_node1_2024-08-03_04-16-32__543d3cf4-dd07-4896-9b79-92c45ad7ae6e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 58439
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58439/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58439/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.194.31/tcp/58440/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.194.31/tcp/58441/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QPBLsdEuEAEwDzCqImY3OhGdJR04hU6EGTgRyi9xy1lGWiHK-92nEFhsjXTeITRK-x3bcb0EtZGgMwTEP03cV1oBgmlkgnY0gmlwhKwSwh-KbXVsdGlhZGRyc4wACgSsEsIfBuRJ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC5EiDdWRwguRKhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-03_04-16-32__543d3cf4-dd07-4896-9b79-92c45ad7ae6e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.1.73
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['2634', '2635', '2636', '2637', '2638']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 2634:2634 -p 2635:2635 -p 2636:2636 -p 2637:2637 -p 2638:2638 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2636 --rest-port=2634 --tcp-port=2635 --discv5-udp-port=2637 --rest-address=0.0.0.0 --nat=extip:172.18.1.73 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2638 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QPBLsdEuEAEwDzCqImY3OhGdJR04hU6EGTgRyi9xy1lGWiHK-92nEFhsjXTeITRK-x3bcb0EtZGgMwTEP03cV1oBgmlkgnY0gmlwhKwSwh-KbXVsdGlhZGRyc4wACgSsEsIfBuRJ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC5EiDdWRwguRKhXdha3UyCQ --lightpushnode=/ip4/172.18.194.31/tcp/58440/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.1.73 waku a6654e0e184881a34a6e1a63d89e45d665fa3cc547637ef3c2a2e2bb326cf18c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a6654e0e1848. Setting up logs at ./log/docker/lightpush_node1_2024-08-03_04-16-32__543d3cf4-dd07-4896-9b79-92c45ad7ae6e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 2634
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2634/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2634/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.1.73/tcp/2635/p2p/16Uiu2HAmB2KMdfZMS1Km4aXXyzG8SKgWNW5XedavqBCXWkTod2PT","/ip4/172.18.1.73/tcp/2636/ws/p2p/16Uiu2HAmB2KMdfZMS1Km4aXXyzG8SKgWNW5XedavqBCXWkTod2PT"],"enrUri":"enr:-LO4QFBcRiYm1vq1oIgP_rDXNDhsixro_a9y77402sKcgtakcfNq8YHA5rMLSIqgfqv9MIU4ySRa9r_6jYEkFpnWKU8BgmlkgnY0gmlwhKwSAUmKbXVsdGlhZGRyc4wACgSsEgFJBgpM3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLnv1AtinzwkyurXvf5smGRhE6V7CsYPSwpQXO4Sdz8OoN0Y3CCCkuDdWRwggpNhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2634/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.194.31/tcp/58440/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58439/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2634/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1722658596515048704}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:2634/lightpush/v1/message. Response content: b'Failed to request a message push: Lightpush request has not been published to any peers. msg_hash: 0xf8c093ac200b124db10a616a5267880ef7d2aaf82377c35c260ef02a1cb2157f'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 45662c734921
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id a6654e0e1848
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-08-03_04-16-32__543d3cf4-dd07-4896-9b79-92c45ad7ae6e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-08-03_04-16-32__543d3cf4-dd07-4896-9b79-92c45ad7ae6e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-08-03_04-16-41__ffeb6264-1507-4652-98b3-12471c53bdf5
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-03_04-16-41__ffeb6264-1507-4652-98b3-12471c53bdf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.112.241
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['50365', '50366', '50367', '50368', '50369']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 50365:50365 -p 50366:50366 -p 50367:50367 -p 50368:50368 -p 50369:50369 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50367 --rest-port=50365 --tcp-port=50366 --discv5-udp-port=50368 --rest-address=0.0.0.0 --nat=extip:172.18.112.241 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50369 --metrics-logging=true --lightpush=true --relay=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.112.241 waku f40ccf0ddc569de543e9a792e17e8e9227dcaf68381d3b6b4bc75ebc5d044a51
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID f40ccf0ddc56. Setting up logs at ./log/docker/receiving_node1_2024-08-03_04-16-41__ffeb6264-1507-4652-98b3-12471c53bdf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 50365
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50365/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50365/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.112.241/tcp/50366/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.112.241/tcp/50367/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QN3eW8IKB8mqSt7G1zTufJH-IJny9oJJGjSUGfloD0B5RKgdPHiS9Ohz_7l240V7LKsN-wrSAmGhEsSLRowhj9cBgmlkgnY0gmlwhKwScPGKbXVsdGlhZGRyc4wACgSsEnDxBsS_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCxL6DdWRwgsTAhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-03_04-16-41__ffeb6264-1507-4652-98b3-12471c53bdf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.228.3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['27534', '27535', '27536', '27537', '27538']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 27534:27534 -p 27535:27535 -p 27536:27536 -p 27537:27537 -p 27538:27538 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27536 --rest-port=27534 --tcp-port=27535 --discv5-udp-port=27537 --rest-address=0.0.0.0 --nat=extip:172.18.228.3 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27538 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QN3eW8IKB8mqSt7G1zTufJH-IJny9oJJGjSUGfloD0B5RKgdPHiS9Ohz_7l240V7LKsN-wrSAmGhEsSLRowhj9cBgmlkgnY0gmlwhKwScPGKbXVsdGlhZGRyc4wACgSsEnDxBsS_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCxL6DdWRwgsTAhXdha3UyCQ --lightpushnode=/ip4/172.18.112.241/tcp/50366/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.228.3 waku f4ef9e6262f51bf7dab18b3e94051d832b273d9ff4e38388cedc95d1ef5a15b1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID f4ef9e6262f5. Setting up logs at ./log/docker/lightpush_node1_2024-08-03_04-16-41__ffeb6264-1507-4652-98b3-12471c53bdf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 27534
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27534/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27534/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.228.3/tcp/27535/p2p/16Uiu2HAmSeybwxxz2HfR8nPUbhAjkwZgCi59X6G8FoTPRVwRmgpV","/ip4/172.18.228.3/tcp/27536/ws/p2p/16Uiu2HAmSeybwxxz2HfR8nPUbhAjkwZgCi59X6G8FoTPRVwRmgpV"],"enrUri":"enr:-LO4QM4YcOrrz1w8XN0mZI4kDGE86aqK7ihr0w8C3H24kEUqMEbHjjSfgt5yNOqVTzB0ARv2Rmzy5f0vCgxwnW_I15oBgmlkgnY0gmlwhKwS5AOKbXVsdGlhZGRyc4wACgSsEuQDBmuQ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPQAsWj-h0XGPyFnpbfIKKz9d_Qs6sOLmtLgh6XfMiwXoN0Y3CCa4-DdWRwgmuRhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27534/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.112.241/tcp/50366/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50365/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27534/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1722658605261734912}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:27534/lightpush/v1/message. Response content: b'Failed to request a message push: Lightpush request has not been published to any peers. msg_hash: 0x12da977cbf008eca40254385568b35bd6ab3fd6c5286c8db13a7d7d8121eebf5'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id f40ccf0ddc56
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id f4ef9e6262f5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-08-03_04-16-41__ffeb6264-1507-4652-98b3-12471c53bdf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-08-03_04-16-41__ffeb6264-1507-4652-98b3-12471c53bdf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-08-03_04-16-48__7a137cdf-b5fe-4ca5-b1c3-5f7412a95357
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-03_04-16-48__7a137cdf-b5fe-4ca5-b1c3-5f7412a95357__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.108.154
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['55248', '55249', '55250', '55251', '55252']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 55248:55248 -p 55249:55249 -p 55250:55250 -p 55251:55251 -p 55252:55252 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55250 --rest-port=55248 --tcp-port=55249 --discv5-udp-port=55251 --rest-address=0.0.0.0 --nat=extip:172.18.108.154 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55252 --metrics-logging=true --lightpush=true --relay=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.108.154 waku e1272b29cc2356af7067a83b9ecea9ef8e437d20763f1fc1f579e20fd2f3f84a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID e1272b29cc23. Setting up logs at ./log/docker/receiving_node1_2024-08-03_04-16-48__7a137cdf-b5fe-4ca5-b1c3-5f7412a95357__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 55248
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55248/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55248/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.108.154/tcp/55249/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.108.154/tcp/55250/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QIXMKXkNoxCzKvPBVbgGrblJLALt4K3572xIkIp1f5_Sf67YxJMK7JyZx_XTR6Tk9B_544lREvty1tUFo1GpnrQBgmlkgnY0gmlwhKwSbJqKbXVsdGlhZGRyc4wACgSsEmyaBtfS3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC19GDdWRwgtfThXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-03_04-16-48__7a137cdf-b5fe-4ca5-b1c3-5f7412a95357__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.38.215
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['55652', '55653', '55654', '55655', '55656']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 55652:55652 -p 55653:55653 -p 55654:55654 -p 55655:55655 -p 55656:55656 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55654 --rest-port=55652 --tcp-port=55653 --discv5-udp-port=55655 --rest-address=0.0.0.0 --nat=extip:172.18.38.215 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55656 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QIXMKXkNoxCzKvPBVbgGrblJLALt4K3572xIkIp1f5_Sf67YxJMK7JyZx_XTR6Tk9B_544lREvty1tUFo1GpnrQBgmlkgnY0gmlwhKwSbJqKbXVsdGlhZGRyc4wACgSsEmyaBtfS3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC19GDdWRwgtfThXdha3UyCQ --lightpushnode=/ip4/172.18.108.154/tcp/55249/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.38.215 waku 809be725b18be1deac09de963002cecefd54d0db940bb8729c1559493b03876c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 809be725b18b. Setting up logs at ./log/docker/lightpush_node1_2024-08-03_04-16-48__7a137cdf-b5fe-4ca5-b1c3-5f7412a95357__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 55652
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55652/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55652/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.215/tcp/55653/p2p/16Uiu2HAm2GDQ4XeZ98Yk63ZBCLjRmrWobVv5qnSZu4n9eMWBM6qN","/ip4/172.18.38.215/tcp/55654/ws/p2p/16Uiu2HAm2GDQ4XeZ98Yk63ZBCLjRmrWobVv5qnSZu4n9eMWBM6qN"],"enrUri":"enr:-LO4QAKlN1Lwqkw0Di8OwV9jgf2LgG_PhegPiVdnvEU5ENdjNS6nvrsxgaFqz_QO_G_vZJqs76z3fAvV83RUKLnBXn8BgmlkgnY0gmlwhKwSJteKbXVsdGlhZGRyc4wACgSsEibXBtlm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJllYZ6uFGKHHUXS8siKa9ph45BkuG6Avx6eAzgema1CYN0Y3CC2WWDdWRwgtlnhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55652/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.108.154/tcp/55249/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55248/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55652/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1722658612609183488}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:55652/lightpush/v1/message. Response content: b'Failed to request a message push: Lightpush request has not been published to any peers. msg_hash: 0x1574bd1891f9e994aa709617110f8f0f33e5cf8b5e9a48ee6ae4d7ad22d897c8'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id e1272b29cc23
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 809be725b18b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-08-03_04-16-48__7a137cdf-b5fe-4ca5-b1c3-5f7412a95357__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-08-03_04-16-48__7a137cdf-b5fe-4ca5-b1c3-5f7412a95357__wakuorg_nwaku:latest.log