[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_valid_version with id: 2024-11-20_04-15-25__ad925488-3805-4122-b4ad-c7555d008764
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-20_04-15-25__ad925488-3805-4122-b4ad-c7555d008764__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.195.15
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['48750', '48751', '48752', '48753', '48754']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 48750:48750 -p 48751:48751 -p 48752:48752 -p 48753:48753 -p 48754:48754 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48752 --rest-port=48750 --tcp-port=48751 --discv5-udp-port=48753 --rest-address=0.0.0.0 --nat=extip:172.18.195.15 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eec54ec1d26decd8f9a14f8cfbfb3e17015fcf2cdfd6d5bf0f1e7efb5dfbec2a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48754 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.236.253
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['54242', '54243', '54244', '54245', '54246']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 54242:54242 -p 54243:54243 -p 54244:54244 -p 54245:54245 -p 54246:54246 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54244 --rest-port=54242 --tcp-port=54243 --discv5-udp-port=54245 --rest-address=0.0.0.0 --nat=extip:172.18.236.253 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e48e364cbf8eeedfccbb41d2c68edce00a244bb584cdfdedbde1e1d52fbcaf8c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54246 --metrics-logging=true --lightpush=true --relay=true
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 88a523e2fcb8. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.236.253 waku 0ca39c159792f28a7aa02fc6f9251742861cda08244e04068e50097ddd8cdcf3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0ca39c159792. Setting up logs at ./log/docker/receiving_node1_2024-11-20_04-15-25__ad925488-3805-4122-b4ad-c7555d008764__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 54242
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54242/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54242/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.236.253/tcp/54243/p2p/16Uiu2HAkzoB4Ysjt1f2FpNxoBbWKgnGNCW7XFyJboqh68PKsTWeN","/ip4/172.18.236.253/tcp/54244/ws/p2p/16Uiu2HAkzoB4Ysjt1f2FpNxoBbWKgnGNCW7XFyJboqh68PKsTWeN"],"enrUri":"enr:-L24QENEtlE3fGjq1VfwCUJNbfzcglTF8U0BsBR54PPYXvIaHg5S2BSZDB5RRV4NxOsoP6sL7_ESAu5Pwxo-FCfHET8CgmlkgnY0gmlwhKwS7P2KbXVsdGlhZGRyc5YACASsEuz9BtPjAAoErBLs_QbT5N0DgnJzhQADAQAAiXNlY3AyNTZrMaECT8yDx2fRKnGaifp337uapx5kODd1Vz8Ol5taYnVJV_uDdGNwgtPjg3VkcILT5YV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-20_04-15-25__ad925488-3805-4122-b4ad-c7555d008764__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.51.249
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['46490', '46491', '46492', '46493', '46494']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 46490:46490 -p 46491:46491 -p 46492:46492 -p 46493:46493 -p 46494:46494 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46492 --rest-port=46490 --tcp-port=46491 --discv5-udp-port=46493 --rest-address=0.0.0.0 --nat=extip:172.18.51.249 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8c48a18b8d6a38c992c1fe29cbcebb6fac16e9a130a86206e5ba6bb647a609b2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46494 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.51.249 waku 425ed1180189897267f3a39b00e5774b0e3333b29f551b4f507b740e4bb32b45
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 425ed1180189. Setting up logs at ./log/docker/receiving_node2_2024-11-20_04-15-25__ad925488-3805-4122-b4ad-c7555d008764__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 46490
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46490/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46490/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.51.249/tcp/46491/p2p/16Uiu2HAm4Me4niPuPEU9BW3bGYhpKaf5jrST123E8eanhWovdXDg","/ip4/172.18.51.249/tcp/46492/ws/p2p/16Uiu2HAm4Me4niPuPEU9BW3bGYhpKaf5jrST123E8eanhWovdXDg"],"enrUri":"enr:-L24QArKwXdms2cgmo0ia_Thk0-YhODXu5V_SLTrBuHvJMkKTZj9F6kBPVZzpDFY5ijgRBIMoaeE7T0vsywk0kv2a34CgmlkgnY0gmlwhKwSM_mKbXVsdGlhZGRyc5YACASsEjP5BrWbAAoErBIz-Qa1nN0DgnJzhQADAQAAiXNlY3AyNTZrMaEChLCx8L7Wc-qMSlyZpQY2z3OQmKnrsy3TKAAZiQUNTgeDdGNwgrWbg3VkcIK1nYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46490/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.236.253/tcp/54243/p2p/16Uiu2HAkzoB4Ysjt1f2FpNxoBbWKgnGNCW7XFyJboqh68PKsTWeN"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-20_04-15-25__ad925488-3805-4122-b4ad-c7555d008764__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.222.233
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['60356', '60357', '60358', '60359', '60360']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 60356:60356 -p 60357:60357 -p 60358:60358 -p 60359:60359 -p 60360:60360 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60358 --rest-port=60356 --tcp-port=60357 --discv5-udp-port=60359 --rest-address=0.0.0.0 --nat=extip:172.18.222.233 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ac4d8de2d47caec6db5df871fca7ee1c8afba7fe47b6e2fd16b5145d177f67d2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60360 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QENEtlE3fGjq1VfwCUJNbfzcglTF8U0BsBR54PPYXvIaHg5S2BSZDB5RRV4NxOsoP6sL7_ESAu5Pwxo-FCfHET8CgmlkgnY0gmlwhKwS7P2KbXVsdGlhZGRyc5YACASsEuz9BtPjAAoErBLs_QbT5N0DgnJzhQADAQAAiXNlY3AyNTZrMaECT8yDx2fRKnGaifp337uapx5kODd1Vz8Ol5taYnVJV_uDdGNwgtPjg3VkcILT5YV3YWt1Mgk --lightpushnode=/ip4/172.18.236.253/tcp/54243/p2p/16Uiu2HAkzoB4Ysjt1f2FpNxoBbWKgnGNCW7XFyJboqh68PKsTWeN --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.222.233 waku 1c5ecdc3ae90cb92cbebc722ecf5e2a8fbaf9ee73421500edf5073639cf9ce48
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 1c5ecdc3ae90. Setting up logs at ./log/docker/lightpush_node1_2024-11-20_04-15-25__ad925488-3805-4122-b4ad-c7555d008764__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 60356
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60356/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60356/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.222.233/tcp/60357/p2p/16Uiu2HAm3hrMaBZLjinAuzrRsxMGnwdT7YwNso2RSpEAcNRysU72","/ip4/172.18.222.233/tcp/60358/ws/p2p/16Uiu2HAm3hrMaBZLjinAuzrRsxMGnwdT7YwNso2RSpEAcNRysU72"],"enrUri":"enr:-L24QGrYqE0bCX3ECB9AVAc4sB4PIeSLxhuaXfoxbbZCZFW2BDrNMm6EF9z4R8y-x0ltU4Dy7ryetl7iHKeXnszUp2wCgmlkgnY0gmlwhKwS3umKbXVsdGlhZGRyc5YACASsEt7pBuvFAAoErBLe6Qbrxt0DgnJzhQADAQAAiXNlY3AyNTZrMaECewKFHVo6Gawxv-rAL8iXrOQIIDJwaODiZEeYVDU6FDmDdGNwguvFg3VkcILrx4V3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60356/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.236.253/tcp/54243/p2p/16Uiu2HAkzoB4Ysjt1f2FpNxoBbWKgnGNCW7XFyJboqh68PKsTWeN"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60356/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.51.249/tcp/46491/p2p/16Uiu2HAm4Me4niPuPEU9BW3bGYhpKaf5jrST123E8eanhWovdXDg"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54242/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46490/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60356/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732076132801163264, "version": 10}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54242/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":10,"timestamp":1732076132801163264,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46490/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":10,"timestamp":1732076132801163264,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 0ca39c159792
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 425ed1180189
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 0ca39c159792. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 1c5ecdc3ae90
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 425ed1180189. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.