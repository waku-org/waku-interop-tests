[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_relay_unsubscribe_from_single_pubsub_topic with id: 2024-10-01_04-23-40__18edd8b8-a4c9-48f6-a370-8dafa6b4dedb
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-01_04-23-40__18edd8b8-a4c9-48f6-a370-8dafa6b4dedb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.41.200
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['21039', '21040', '21041', '21042', '21043']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 21039:21039 -p 21040:21040 -p 21041:21041 -p 21042:21042 -p 21043:21043 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21041 --rest-port=21039 --tcp-port=21040 --discv5-udp-port=21042 --rest-address=0.0.0.0 --nat=extip:172.18.41.200 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c2aed32aa5ce0e31c4d1d26adddcb8b3aae4a976af4db0cc5bec2eebda78f839 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21043 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.41.200 waku 4b58f6daf1cb62c3de7607ab9aaae02b5da5f81d55ce386e18ce7469c021f829
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 4b58f6daf1cb. Setting up logs at ./log/docker/node1_2024-10-01_04-23-40__18edd8b8-a4c9-48f6-a370-8dafa6b4dedb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 21039
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21039/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21039/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.41.200/tcp/21040/p2p/16Uiu2HAm9TJHWx89gzLjoNfLKhdJDzk3XQwgzj676KSm5nmNaPL1","/ip4/172.18.41.200/tcp/21041/ws/p2p/16Uiu2HAm9TJHWx89gzLjoNfLKhdJDzk3XQwgzj676KSm5nmNaPL1"],"enrUri":"enr:-LO4QNbxhJkzRCJ5k0u6DkPLAO6pqI4oLT9Fq60OZ02R0jyQZ3xOZAhPrhZPTTtm-vcdVN2Kwm9u5ShiX2ZINmB31eMBgmlkgnY0gmlwhKwSKciKbXVsdGlhZGRyc4wACgSsEinIBlIx3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLQbj-mJ7RG5o3kzm4hJwILfblaftz_eQGxlWmyJ6WXnoN0Y3CCUjCDdWRwglIyhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-01_04-23-40__18edd8b8-a4c9-48f6-a370-8dafa6b4dedb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.101.177
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['63439', '63440', '63441', '63442', '63443']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 63439:63439 -p 63440:63440 -p 63441:63441 -p 63442:63442 -p 63443:63443 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63441 --rest-port=63439 --tcp-port=63440 --discv5-udp-port=63442 --rest-address=0.0.0.0 --nat=extip:172.18.101.177 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8d26eccff660ce936a1bd0e4c094afb828aa5fc6fbd1af2c849aa5ca03ac5d74 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63443 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QNbxhJkzRCJ5k0u6DkPLAO6pqI4oLT9Fq60OZ02R0jyQZ3xOZAhPrhZPTTtm-vcdVN2Kwm9u5ShiX2ZINmB31eMBgmlkgnY0gmlwhKwSKciKbXVsdGlhZGRyc4wACgSsEinIBlIx3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLQbj-mJ7RG5o3kzm4hJwILfblaftz_eQGxlWmyJ6WXnoN0Y3CCUjCDdWRwglIyhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.101.177 waku 95b7d0e85abd5e53778166ba3179084856758ab35072a132d3a54724c221ddc3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 95b7d0e85abd. Setting up logs at ./log/docker/node2_2024-10-01_04-23-40__18edd8b8-a4c9-48f6-a370-8dafa6b4dedb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 63439
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63439/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63439/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.101.177/tcp/63440/p2p/16Uiu2HAm5UAkwkY4ipUpY19g9vHpvrw4TozTRKHkHxzkgE1sCQZH","/ip4/172.18.101.177/tcp/63441/ws/p2p/16Uiu2HAm5UAkwkY4ipUpY19g9vHpvrw4TozTRKHkHxzkgE1sCQZH"],"enrUri":"enr:-LO4QNr1zCSb9PO8k4Rd18EFkz-rltmcIuCOlajOw8JQXbW0BOwOlM76E_oQADBB188W2eNIM3XfCma5iE4Xd9TrsqgBgmlkgnY0gmlwhKwSZbGKbXVsdGlhZGRyc4wACgSsEmWxBvfR3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKVOJIgECRDm95oopSJZxZjW2s5mcrNQVKneuxVywrOJIN0Y3CC99CDdWRwgvfShXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63439/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.41.200/tcp/21040/p2p/16Uiu2HAm9TJHWx89gzLjoNfLKhdJDzk3XQwgzj676KSm5nmNaPL1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21039/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63439/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21039/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21039/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1727756623868849408,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63439/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1727756623868849408,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X DELETE "http://127.0.0.1:21039/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X DELETE "http://127.0.0.1:63439/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21039/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:21039/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/3/1'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 4b58f6daf1cb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 95b7d0e85abd
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.