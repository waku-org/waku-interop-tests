[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-10-01_04-20-04__6c0b9928-ce3f-4acb-a5d9-3628b7aef0af
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-01_04-20-04__6c0b9928-ce3f-4acb-a5d9-3628b7aef0af__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.98.119
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['26580', '26581', '26582', '26583', '26584']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 26580:26580 -p 26581:26581 -p 26582:26582 -p 26583:26583 -p 26584:26584 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26582 --rest-port=26580 --tcp-port=26581 --discv5-udp-port=26583 --rest-address=0.0.0.0 --nat=extip:172.18.98.119 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0fae1aabadd58efb2bab684b094b1cc0a0fcdde7fce4cf5c300ad936cd7a4595 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26584 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.98.119 waku 707cdb351cdb79248c49225e01a60b4c2a6971544cb8b7d5d5edb142a271e240
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 707cdb351cdb. Setting up logs at ./log/docker/receiving_node1_2024-10-01_04-20-04__6c0b9928-ce3f-4acb-a5d9-3628b7aef0af__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 26580
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26580/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26580/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.98.119/tcp/26581/p2p/16Uiu2HAmSbseimmi6CbZoEGWNKXs56DC16qcm3tNQXzRxMoGNT9A","/ip4/172.18.98.119/tcp/26582/ws/p2p/16Uiu2HAmSbseimmi6CbZoEGWNKXs56DC16qcm3tNQXzRxMoGNT9A"],"enrUri":"enr:-LO4QAMOC7rlOUaOeoMTX9ZB64DVe02eHPT9ah_dRpreF0vjAo-6HNJ0qygtwD6EFRnXieKxeQlvSOWzmTfH-ZayNa0BgmlkgnY0gmlwhKwSYneKbXVsdGlhZGRyc4wACgSsEmJ3BmfW3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPPN0ynwUouHsb6vo02_BHAWnFaTb5IXV4sz_-ZrM4D-YN0Y3CCZ9WDdWRwgmfXhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-01_04-20-04__6c0b9928-ce3f-4acb-a5d9-3628b7aef0af__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.29.154
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['50932', '50933', '50934', '50935', '50936']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 50932:50932 -p 50933:50933 -p 50934:50934 -p 50935:50935 -p 50936:50936 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50934 --rest-port=50932 --tcp-port=50933 --discv5-udp-port=50935 --rest-address=0.0.0.0 --nat=extip:172.18.29.154 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=afbfab0ffaf30e9d5ed1c7be72eeb2c4b0e52abb3deaea73710fa0af28ab1466 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50936 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.29.154 waku c52bc36209a03c192dc2ab65cb17559ac1c52a7861b9b22cfd79c7745acb12a5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c52bc36209a0. Setting up logs at ./log/docker/receiving_node2_2024-10-01_04-20-04__6c0b9928-ce3f-4acb-a5d9-3628b7aef0af__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 50932
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50932/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50932/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.29.154/tcp/50933/p2p/16Uiu2HAmVQCsz4Ab2tzxJttTPmuF62wEDDQJD57vj8FnD7aUGneo","/ip4/172.18.29.154/tcp/50934/ws/p2p/16Uiu2HAmVQCsz4Ab2tzxJttTPmuF62wEDDQJD57vj8FnD7aUGneo"],"enrUri":"enr:-LO4QMwqOklZQTbgfGmvMojOI0J6-v5yuYmobKzUTdUjwm6PZ1HOgpjMDdHjBk92HEouhcmJGuZVII4zma_gbHNDWX4BgmlkgnY0gmlwhKwSHZqKbXVsdGlhZGRyc4wACgSsEh2aBsb23QOCcnOFAAMBAACJc2VjcDI1NmsxoQP4zSHn1UVwrCidl4XG6yACvvXJFSG8Xhd0u38syx0jDIN0Y3CCxvWDdWRwgsb3hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50932/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.98.119/tcp/26581/p2p/16Uiu2HAmSbseimmi6CbZoEGWNKXs56DC16qcm3tNQXzRxMoGNT9A"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-01_04-20-04__6c0b9928-ce3f-4acb-a5d9-3628b7aef0af__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.67.184
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['43960', '43961', '43962', '43963', '43964']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 43960:43960 -p 43961:43961 -p 43962:43962 -p 43963:43963 -p 43964:43964 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43962 --rest-port=43960 --tcp-port=43961 --discv5-udp-port=43963 --rest-address=0.0.0.0 --nat=extip:172.18.67.184 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c47cc4ae898bab2ad49ecaa9eef7ae27961c5cfda6ae6dec4e53b33e40f4e4e5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43964 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QAMOC7rlOUaOeoMTX9ZB64DVe02eHPT9ah_dRpreF0vjAo-6HNJ0qygtwD6EFRnXieKxeQlvSOWzmTfH-ZayNa0BgmlkgnY0gmlwhKwSYneKbXVsdGlhZGRyc4wACgSsEmJ3BmfW3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPPN0ynwUouHsb6vo02_BHAWnFaTb5IXV4sz_-ZrM4D-YN0Y3CCZ9WDdWRwgmfXhXdha3UyCQ --lightpushnode=/ip4/172.18.98.119/tcp/26581/p2p/16Uiu2HAmSbseimmi6CbZoEGWNKXs56DC16qcm3tNQXzRxMoGNT9A --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.67.184 waku 70b431eb2153b4f6ca690c89f72169fe9dfab60aac9ebb0d3fd0ffe7edbb8cf7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 70b431eb2153. Setting up logs at ./log/docker/lightpush_node1_2024-10-01_04-20-04__6c0b9928-ce3f-4acb-a5d9-3628b7aef0af__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 43960
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43960/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43960/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.67.184/tcp/43961/p2p/16Uiu2HAm4o2NLedTva2bNgWnZSs58oaN75T5f3MbQvb74cnZ3VUp","/ip4/172.18.67.184/tcp/43962/ws/p2p/16Uiu2HAm4o2NLedTva2bNgWnZSs58oaN75T5f3MbQvb74cnZ3VUp"],"enrUri":"enr:-LO4QCkARKCdW-Et04cwm60AbvXKHG-75TXdhwTTPe0_n_vvfKbg7hkds7Siuk70fwq6VjXVGVJ3ka-C59hwiGz8KNEBgmlkgnY0gmlwhKwSQ7iKbXVsdGlhZGRyc4wACgSsEkO4Bqu63QOCcnOFAAMBAACJc2VjcDI1NmsxoQKLMW7UsrejuNQmgVoTWLzgZiY8h8ulCUYlkD1acKhZ7YN0Y3CCq7mDdWRwgqu7hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43960/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.98.119/tcp/26581/p2p/16Uiu2HAmSbseimmi6CbZoEGWNKXs56DC16qcm3tNQXzRxMoGNT9A"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43960/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.29.154/tcp/50933/p2p/16Uiu2HAmVQCsz4Ab2tzxJttTPmuF62wEDDQJD57vj8FnD7aUGneo"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26580/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50932/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43960/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1727756409767888128, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727756409767888128,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50932/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727756409767888128,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43960/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1727756409893149440, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727756409893149440,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50932/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727756409893149440,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 707cdb351cdb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c52bc36209a0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 70b431eb2153
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.