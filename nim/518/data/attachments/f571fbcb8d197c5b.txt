[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-12-13_04-13-56__669a325c-1536-4fb4-8b2a-e808214c7443
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-12-13_04-13-56__669a325c-1536-4fb4-8b2a-e808214c7443__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.202.11
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['33241', '33242', '33243', '33244', '33245']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 33241:33241 -p 33242:33242 -p 33243:33243 -p 33244:33244 -p 33245:33245 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33243 --rest-port=33241 --tcp-port=33242 --discv5-udp-port=33244 --rest-address=0.0.0.0 --nat=extip:172.18.202.11 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ff7edc999eddf8ea4ec9efcf8b978bf42c8d2f1cf89b449b94d2efcb4b4399bc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33245 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.202.11 waku 08149a6f0778ba7f4f8f2b39024ef66bf17658d517a3441e683fa7f81808f35a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 08149a6f0778. Setting up logs at ./log/docker/receiving_node1_2024-12-13_04-13-56__669a325c-1536-4fb4-8b2a-e808214c7443__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 33241
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container abf3a4d8c5b1. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33241/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33241/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.202.11/tcp/33242/p2p/16Uiu2HAmGL4uWuSZAjxjh2Bo2ou4W5Dpcnrk6H8MmNjXr1CXFDoF","/ip4/172.18.202.11/tcp/33243/ws/p2p/16Uiu2HAmGL4uWuSZAjxjh2Bo2ou4W5Dpcnrk6H8MmNjXr1CXFDoF"],"enrUri":"enr:-L24QMaW92n7dxSHhhRKKIDJiVW1M_7zVQhofDWNK-P9UG7AJ5V9QpJzlAagSaiY7mDCv8Crm2Dg1zSF3uZjOYHh-EACgmlkgnY0gmlwhKwSyguKbXVsdGlhZGRyc5YACASsEsoLBoHaAAoErBLKCwaB290DgnJzhQADAQAAiXNlY3AyNTZrMaEDNpXdB8jfl9as2RAdlVGnhvs0RrbetZv0_n8x19Ae5JqDdGNwgoHag3VkcIKB3IV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-12-13_04-13-56__669a325c-1536-4fb4-8b2a-e808214c7443__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.132.132
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59319', '59320', '59321', '59322', '59323']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59319:59319 -p 59320:59320 -p 59321:59321 -p 59322:59322 -p 59323:59323 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59321 --rest-port=59319 --tcp-port=59320 --discv5-udp-port=59322 --rest-address=0.0.0.0 --nat=extip:172.18.132.132 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3167ec2ec94c4d9efda9f84c417bc1d7aeed3abbec2efba154d6d60ec727ff99 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59323 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.132.132 waku 2174789c324c380928338df6f8559454ed5848eae268e1fac2fc1c722cfc2929
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2174789c324c. Setting up logs at ./log/docker/receiving_node2_2024-12-13_04-13-56__669a325c-1536-4fb4-8b2a-e808214c7443__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 59319
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59319/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59319/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.132.132/tcp/59320/p2p/16Uiu2HAkyoF8p7ar1esq447QfSmodtjY1oC3jCaJe43WgzaEdb4p","/ip4/172.18.132.132/tcp/59321/ws/p2p/16Uiu2HAkyoF8p7ar1esq447QfSmodtjY1oC3jCaJe43WgzaEdb4p"],"enrUri":"enr:-L24QOMzYuhWcu1LA5Uc1NzwevDDyGoh7UlYTm8FTgEk-FLWb_EhVk34cDOIqfDCkuDqxEIcPCYTGYmJwp-33Hvy_ngCgmlkgnY0gmlwhKwShISKbXVsdGlhZGRyc5YACASsEoSEBue4AAoErBKEhAbnud0DgnJzhQADAQAAiXNlY3AyNTZrMaECQPVvCk90kkrwgOVdluScBUw5w1x_HB8koUleWKc0c3WDdGNwgue4g3VkcILnuoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59319/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.202.11/tcp/33242/p2p/16Uiu2HAmGL4uWuSZAjxjh2Bo2ou4W5Dpcnrk6H8MmNjXr1CXFDoF"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-12-13_04-13-56__669a325c-1536-4fb4-8b2a-e808214c7443__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.150.177
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['16472', '16473', '16474', '16475', '16476']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 16472:16472 -p 16473:16473 -p 16474:16474 -p 16475:16475 -p 16476:16476 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16474 --rest-port=16472 --tcp-port=16473 --discv5-udp-port=16475 --rest-address=0.0.0.0 --nat=extip:172.18.150.177 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3c886c08e8e36bcbae2c7a4b2d92192ff55ae442fceafcc70725da438b299ce7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16476 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QMaW92n7dxSHhhRKKIDJiVW1M_7zVQhofDWNK-P9UG7AJ5V9QpJzlAagSaiY7mDCv8Crm2Dg1zSF3uZjOYHh-EACgmlkgnY0gmlwhKwSyguKbXVsdGlhZGRyc5YACASsEsoLBoHaAAoErBLKCwaB290DgnJzhQADAQAAiXNlY3AyNTZrMaEDNpXdB8jfl9as2RAdlVGnhvs0RrbetZv0_n8x19Ae5JqDdGNwgoHag3VkcIKB3IV3YWt1Mgk --lightpushnode=/ip4/172.18.202.11/tcp/33242/p2p/16Uiu2HAmGL4uWuSZAjxjh2Bo2ou4W5Dpcnrk6H8MmNjXr1CXFDoF --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.150.177 waku b148ff337dbdbde52b7a2a60f30dbd50e9d584206cb501e0f26306ef1da8b9bf
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b148ff337dbd. Setting up logs at ./log/docker/lightpush_node1_2024-12-13_04-13-56__669a325c-1536-4fb4-8b2a-e808214c7443__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 16472
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16472/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16472/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.150.177/tcp/16473/p2p/16Uiu2HAkyTMczJZKbeYe7txvaZ4fnt3otx7FbtYHYHXJKARfCAwC","/ip4/172.18.150.177/tcp/16474/ws/p2p/16Uiu2HAkyTMczJZKbeYe7txvaZ4fnt3otx7FbtYHYHXJKARfCAwC"],"enrUri":"enr:-L24QBeO5S8Ms7YHMwU7k8yrnVU8NIfKajeSZB71EbnIaT-0cqt2k02UI3Fqo8gFas4mX2nxTyrUsmWmQXHw2xFr7b8CgmlkgnY0gmlwhKwSlrGKbXVsdGlhZGRyc5YACASsEpaxBkBZAAoErBKWsQZAWt0DgnJzhQADAQAAiXNlY3AyNTZrMaECO90mrLac9PS6gdducyES9PNTBu97RTfWKhykQlvPg-ODdGNwgkBZg3VkcIJAW4V3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16472/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.202.11/tcp/33242/p2p/16Uiu2HAmGL4uWuSZAjxjh2Bo2ou4W5Dpcnrk6H8MmNjXr1CXFDoF"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16472/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.132.132/tcp/59320/p2p/16Uiu2HAkyoF8p7ar1esq447QfSmodtjY1oC3jCaJe43WgzaEdb4p"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33241/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59319/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16472/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734063240838771712, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734063240838771712,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59319/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734063240838771712,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16472/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734063240957186560, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734063240957186560,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59319/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734063240957186560,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 08149a6f0778
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 2174789c324c
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 08149a6f0778. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id b148ff337dbd
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 2174789c324c. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.