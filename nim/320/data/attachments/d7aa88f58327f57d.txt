[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_cant_publish_on_not_subscribed_shard with id: 2024-08-16_08-15-01__b3eca7a4-480c-4448-8ea0-31396f96dc1c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-16_08-15-01__b3eca7a4-480c-4448-8ea0-31396f96dc1c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.127.50
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['9581', '9582', '9583', '9584', '9585']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:71 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 9581:9581 -p 9582:9582 -p 9583:9583 -p 9584:9584 -p 9585:9585 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9583 --rest-port=9581 --tcp-port=9582 --discv5-udp-port=9584 --rest-address=0.0.0.0 --nat=extip:172.18.127.50 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bbb44abfae3d41f79bdab14f97ac21ebeea8d9a0e2f10cbbe37a66fe9cb2edb6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9585 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.127.50 waku 9131ee526d99b2674467a853116cec72fc016a7ef7d0ca42b7636748222052c0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 9131ee526d99. Setting up logs at ./log/docker/node1_2024-08-16_08-15-01__b3eca7a4-480c-4448-8ea0-31396f96dc1c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 9581
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9581/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9581/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.127.50/tcp/9582/p2p/16Uiu2HAmMgbvMvNrdUt93eWpkAH84HDxTe9hrdpUoFXhCPXFZTaV","/ip4/172.18.127.50/tcp/9583/ws/p2p/16Uiu2HAmMgbvMvNrdUt93eWpkAH84HDxTe9hrdpUoFXhCPXFZTaV"],"enrUri":"enr:-LO4QHmT34hUscoG8rlmq8UJwRcJ4I9yTx1s6OlVC1aMkEYGPv635Hd1eCRH6aYxBeb7DYSsT9uy7RRQb5z7qMhpVgwBgmlkgnY0gmlwhKwSfzKKbXVsdGlhZGRyc4wACgSsEn8yBiVv3QOCcnOFAAIBAACJc2VjcDI1NmsxoQOGIvuFI5erVrykEAbhlrj3nFC4T2Dz04e6SSWguJMq3oN0Y3CCJW6DdWRwgiVwhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-16_08-15-01__b3eca7a4-480c-4448-8ea0-31396f96dc1c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.38.157
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['53426', '53427', '53428', '53429', '53430']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:71 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 53426:53426 -p 53427:53427 -p 53428:53428 -p 53429:53429 -p 53430:53430 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53428 --rest-port=53426 --tcp-port=53427 --discv5-udp-port=53429 --rest-address=0.0.0.0 --nat=extip:172.18.38.157 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=8ce72eb7382e3ae1ac5c49f15ff3f73acadf1f2dc65eef867d39a8f1d602eeff --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53430 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QHmT34hUscoG8rlmq8UJwRcJ4I9yTx1s6OlVC1aMkEYGPv635Hd1eCRH6aYxBeb7DYSsT9uy7RRQb5z7qMhpVgwBgmlkgnY0gmlwhKwSfzKKbXVsdGlhZGRyc4wACgSsEn8yBiVv3QOCcnOFAAIBAACJc2VjcDI1NmsxoQOGIvuFI5erVrykEAbhlrj3nFC4T2Dz04e6SSWguJMq3oN0Y3CCJW6DdWRwgiVwhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.38.157 waku 74abeed8ad9c6e6da8d7e04f5728dc9399fe547443d814b39f9e0f5c70411d9c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 74abeed8ad9c. Setting up logs at ./log/docker/node2_2024-08-16_08-15-01__b3eca7a4-480c-4448-8ea0-31396f96dc1c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 53426
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53426/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53426/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.157/tcp/53427/p2p/16Uiu2HAmMeZai998WMUZLpSPHj2T3yai8TDevv8can5NdqxGpUQK","/ip4/172.18.38.157/tcp/53428/ws/p2p/16Uiu2HAmMeZai998WMUZLpSPHj2T3yai8TDevv8can5NdqxGpUQK"],"enrUri":"enr:-LO4QOmsDwoD8yYCsxU6BSwcJXVAUe1eadt3U2KiBVIZkWzxbbwYx5Gb20Zs_mk48wbgqFfqWiZ_kAyZqCvEtVE9g48BgmlkgnY0gmlwhKwSJp2KbXVsdGlhZGRyc4wACgSsEiadBtC03QOCcnOFAAIBAACJc2VjcDI1NmsxoQOFnS0mz-055GWyNO-LO04c3u1H4_jLkPXDECpZxY-NvIN0Y3CC0LODdWRwgtC1hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53426/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.127.50/tcp/9582/p2p/16Uiu2HAmMgbvMvNrdUt93eWpkAH84HDxTe9hrdpUoFXhCPXFZTaV"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9581/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53426/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9581/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9581/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/2/1'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 9131ee526d99
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 74abeed8ad9c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.