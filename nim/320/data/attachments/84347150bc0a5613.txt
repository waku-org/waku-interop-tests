[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_retrieve_messages_without_subscribing_via_api with id: 2024-08-16_08-14-06__cc4f0b3e-ffc8-4924-944a-b7c917b0704c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-16_08-14-06__cc4f0b3e-ffc8-4924-944a-b7c917b0704c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.45.127
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['38260', '38261', '38262', '38263', '38264']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 38260:38260 -p 38261:38261 -p 38262:38262 -p 38263:38263 -p 38264:38264 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38262 --rest-port=38260 --tcp-port=38261 --discv5-udp-port=38263 --rest-address=0.0.0.0 --nat=extip:172.18.45.127 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=cbdd205f4e7fd4f2aa523380f496c305b48f28dcdee7b8ef189f5d0982c0ebc7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38264 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.45.127 waku 237e50e803462d3094cc251052bff03e300c8ba38c404e286a314f79d37713ec
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 237e50e80346. Setting up logs at ./log/docker/node1_2024-08-16_08-14-06__cc4f0b3e-ffc8-4924-944a-b7c917b0704c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 38260
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38260/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38260/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.45.127/tcp/38261/p2p/16Uiu2HAmFTpK2GjknUTKLGnuKf5tJyzsdS4ti1xCg2y4h2B4hcTC","/ip4/172.18.45.127/tcp/38262/ws/p2p/16Uiu2HAmFTpK2GjknUTKLGnuKf5tJyzsdS4ti1xCg2y4h2B4hcTC"],"enrUri":"enr:-LO4QHxUpZHIppirHON7_TQ7Xo4R_b_WwSS3P6aElnIn5ZmPSUxebtBP4FVm_x-gk8dTFKzwdamwB7wDF4fVyCS-ZvIBgmlkgnY0gmlwhKwSLX-KbXVsdGlhZGRyc4wACgSsEi1_BpV23QOCcnOFAAIBAACJc2VjcDI1NmsxoQMptlIV026wTWvl1qyxiD_iTZ21YzzwgJXnjxVfW7Owy4N0Y3CClXWDdWRwgpV3hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-16_08-14-06__cc4f0b3e-ffc8-4924-944a-b7c917b0704c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.20.180
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['13079', '13080', '13081', '13082', '13083']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 13079:13079 -p 13080:13080 -p 13081:13081 -p 13082:13082 -p 13083:13083 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13081 --rest-port=13079 --tcp-port=13080 --discv5-udp-port=13082 --rest-address=0.0.0.0 --nat=extip:172.18.20.180 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=2a24bdb64f9d60a85dbf83cc51d1d52fe0dd22744e0aeaa3e6af5dec3bb6dcab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13083 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QHxUpZHIppirHON7_TQ7Xo4R_b_WwSS3P6aElnIn5ZmPSUxebtBP4FVm_x-gk8dTFKzwdamwB7wDF4fVyCS-ZvIBgmlkgnY0gmlwhKwSLX-KbXVsdGlhZGRyc4wACgSsEi1_BpV23QOCcnOFAAIBAACJc2VjcDI1NmsxoQMptlIV026wTWvl1qyxiD_iTZ21YzzwgJXnjxVfW7Owy4N0Y3CClXWDdWRwgpV3hXdha3UyBQ --content-topic=/myapp/1/latest/proto
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.20.180 waku 45aca529245bd30148ace4ae9a86b7fc95bdea4c294efd3a86f541ae0a0eb3eb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 45aca529245b. Setting up logs at ./log/docker/node2_2024-08-16_08-14-06__cc4f0b3e-ffc8-4924-944a-b7c917b0704c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 13079
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13079/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13079/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.20.180/tcp/13080/p2p/16Uiu2HAmCp5MqyCwHiX2h4m7ExDnWQFX2dvSaJ6ijLAov4eWpVJQ","/ip4/172.18.20.180/tcp/13081/ws/p2p/16Uiu2HAmCp5MqyCwHiX2h4m7ExDnWQFX2dvSaJ6ijLAov4eWpVJQ"],"enrUri":"enr:-LO4QPIU8cuwLgn3mHNsQxZSgMyXWLb19ur3cmC-vaT54mraBebWbMyFX_3IP9I5jl9y0xIMow6FjEduX5ZCrwjGMwoBgmlkgnY0gmlwhKwSFLSKbXVsdGlhZGRyc4wACgSsEhS0BjMZ3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMCU-RBd146Wjtdi4Chb4qPhNv_BZrcVwR8Dbcvu43faYN0Y3CCMxiDdWRwgjMahXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13079/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.45.127/tcp/38261/p2p/16Uiu2HAmFTpK2GjknUTKLGnuKf5tJyzsdS4ti1xCg2y4h2B4hcTC"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38260/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38260/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723796050073005312,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13079/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723796050073005312,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 237e50e80346
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 45aca529245b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.