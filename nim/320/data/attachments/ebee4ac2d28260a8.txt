[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-08-16_08-09-05__83a47030-3106-4739-8cc7-4be09a972fe6
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-16_08-09-05__83a47030-3106-4739-8cc7-4be09a972fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.253.142
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['49850', '49851', '49852', '49853', '49854']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 49850:49850 -p 49851:49851 -p 49852:49852 -p 49853:49853 -p 49854:49854 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49852 --rest-port=49850 --tcp-port=49851 --discv5-udp-port=49853 --rest-address=0.0.0.0 --nat=extip:172.18.253.142 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=94c13e5ca1eb9fdfb640a2eecf5abbd0239045ba68b0ac45012b89bfa3eaa999 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49854 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.253.142 waku 7200e27b8e5caed9b360b36a3cbaeca2d91d24a6ba899073f1fd63dac7ffbb49
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 7200e27b8e5c. Setting up logs at ./log/docker/receiving_node1_2024-08-16_08-09-05__83a47030-3106-4739-8cc7-4be09a972fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 49850
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49850/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49850/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.253.142/tcp/49851/p2p/16Uiu2HAmNuunexREY3c3XfznPGLbSJPZDUU3cCyiXVxgfjZPA9r6","/ip4/172.18.253.142/tcp/49852/ws/p2p/16Uiu2HAmNuunexREY3c3XfznPGLbSJPZDUU3cCyiXVxgfjZPA9r6"],"enrUri":"enr:-LO4QKUFRg62Tiv-a9MegW2Io3dhhYb8eZ_N5Bo18W1Il3UwGiyPiN76sCBgllNfQHP9A-oaHXabDDEVADHeBGx4DdwBgmlkgnY0gmlwhKwS_Y6KbXVsdGlhZGRyc4wACgSsEv2OBsK83QOCcnOFAAMBAACJc2VjcDI1NmsxoQOYZ2wg2Uul4hClvbpF6L0cLDK6rKAcjZI6TCf-noKVh4N0Y3CCwruDdWRwgsK9hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-08-16_08-09-05__83a47030-3106-4739-8cc7-4be09a972fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.34.28
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['40141', '40142', '40143', '40144', '40145']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 40141:40141 -p 40142:40142 -p 40143:40143 -p 40144:40144 -p 40145:40145 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40143 --rest-port=40141 --tcp-port=40142 --discv5-udp-port=40144 --rest-address=0.0.0.0 --nat=extip:172.18.34.28 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dc6edceb7b3c5079bca51a3a24a0dd7ccb29f07dbced06c9529bb0ca0fdc4ebc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40145 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.34.28 waku 021ab3de2c7941255789379962bc9e588f7f8185b663dff531be5dedd92d9337
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 021ab3de2c79. Setting up logs at ./log/docker/receiving_node2_2024-08-16_08-09-05__83a47030-3106-4739-8cc7-4be09a972fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 40141
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40141/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40141/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.34.28/tcp/40142/p2p/16Uiu2HAmVp8CnNfZxDtiDribqnmRR7binUuuPDMBtixKHxAEDrJ7","/ip4/172.18.34.28/tcp/40143/ws/p2p/16Uiu2HAmVp8CnNfZxDtiDribqnmRR7binUuuPDMBtixKHxAEDrJ7"],"enrUri":"enr:-LO4QFi8jPMDiZrmWfcdBCzSmDIPvWjAuUyI7xZAEL4hqruPA7CyH5J_umiLLfADXLCHeiQjviNUOu6lZyRGUJljJL0BgmlkgnY0gmlwhKwSIhyKbXVsdGlhZGRyc4wACgSsEiIcBpzP3QOCcnOFAAMBAACJc2VjcDI1NmsxoQP-7cjp-iRiIK4RyYQgqvjspSyL1BdOpRAlv_2WIe2x1IN0Y3CCnM6DdWRwgpzQhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40141/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.253.142/tcp/49851/p2p/16Uiu2HAmNuunexREY3c3XfznPGLbSJPZDUU3cCyiXVxgfjZPA9r6"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-16_08-09-05__83a47030-3106-4739-8cc7-4be09a972fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.135.198
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['3723', '3724', '3725', '3726', '3727']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 3723:3723 -p 3724:3724 -p 3725:3725 -p 3726:3726 -p 3727:3727 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3725 --rest-port=3723 --tcp-port=3724 --discv5-udp-port=3726 --rest-address=0.0.0.0 --nat=extip:172.18.135.198 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8eacbed8d9b4bed98ddad6ac72dcf31adcbfb16b0582fc7b0dda3c2fae1df4f3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3727 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QKUFRg62Tiv-a9MegW2Io3dhhYb8eZ_N5Bo18W1Il3UwGiyPiN76sCBgllNfQHP9A-oaHXabDDEVADHeBGx4DdwBgmlkgnY0gmlwhKwS_Y6KbXVsdGlhZGRyc4wACgSsEv2OBsK83QOCcnOFAAMBAACJc2VjcDI1NmsxoQOYZ2wg2Uul4hClvbpF6L0cLDK6rKAcjZI6TCf-noKVh4N0Y3CCwruDdWRwgsK9hXdha3UyCQ --lightpushnode=/ip4/172.18.253.142/tcp/49851/p2p/16Uiu2HAmNuunexREY3c3XfznPGLbSJPZDUU3cCyiXVxgfjZPA9r6 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.135.198 waku 71931a52c9c768db5c0f3ad36b7a769075fc4896cd17394a5e5b38aae8b6a5eb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 71931a52c9c7. Setting up logs at ./log/docker/lightpush_node1_2024-08-16_08-09-05__83a47030-3106-4739-8cc7-4be09a972fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 3723
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3723/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3723/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.135.198/tcp/3724/p2p/16Uiu2HAmH1DcMuVWAsmZYfMsGr8LSr6oXCzVEEbstD2rbaS2vW5d","/ip4/172.18.135.198/tcp/3725/ws/p2p/16Uiu2HAmH1DcMuVWAsmZYfMsGr8LSr6oXCzVEEbstD2rbaS2vW5d"],"enrUri":"enr:-LO4QDLXwhKqZ5_62c7cpQTo02hoaBmOkXc6HEUWYpba4AIIHvxJaxU10aTTDmA2bsyBsOApECF7FGa1mh2Y-2IALXwBgmlkgnY0gmlwhKwSh8aKbXVsdGlhZGRyc4wACgSsEofGBg6N3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNAnVtabG05r__lrIE7cnlfHTwxd4JsnnwHDiPOVXPYWIN0Y3CCDoyDdWRwgg6OhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3723/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.253.142/tcp/49851/p2p/16Uiu2HAmNuunexREY3c3XfznPGLbSJPZDUU3cCyiXVxgfjZPA9r6"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3723/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.34.28/tcp/40142/p2p/16Uiu2HAmVp8CnNfZxDtiDribqnmRR7binUuuPDMBtixKHxAEDrJ7"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49850/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40141/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3723/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1723795751051866880, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49850/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723795751051866880,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40141/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723795751051866880,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3723/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1723795751171089152, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49850/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723795751171089152,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40141/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723795751171089152,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 7200e27b8e5c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 021ab3de2c79
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 71931a52c9c7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.