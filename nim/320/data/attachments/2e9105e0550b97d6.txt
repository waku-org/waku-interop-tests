[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_valid_version with id: 2024-08-16_08-11-54__6468fc18-332e-4b25-ab60-eb1e3332f399
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-16_08-11-54__6468fc18-332e-4b25-ab60-eb1e3332f399__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.50.86
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['37854', '37855', '37856', '37857', '37858']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 37854:37854 -p 37855:37855 -p 37856:37856 -p 37857:37857 -p 37858:37858 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37856 --rest-port=37854 --tcp-port=37855 --discv5-udp-port=37857 --rest-address=0.0.0.0 --nat=extip:172.18.50.86 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7da944ddbc4de9abbba304b94bcb93abc2c607302e43e640ba5b762667eefa2a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37858 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.50.86 waku 6a913a8e1efe2b31c6d68ce1485a384ddf18748abddd1d067aa856e6ccb768c7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 6a913a8e1efe. Setting up logs at ./log/docker/node1_2024-08-16_08-11-54__6468fc18-332e-4b25-ab60-eb1e3332f399__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 37854
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37854/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37854/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.50.86/tcp/37855/p2p/16Uiu2HAmKi7Dy8F6s1cBn5ApCCNYmUip5k8Z7JuRtMorTRKLA5cS","/ip4/172.18.50.86/tcp/37856/ws/p2p/16Uiu2HAmKi7Dy8F6s1cBn5ApCCNYmUip5k8Z7JuRtMorTRKLA5cS"],"enrUri":"enr:-LO4QJOVIsbm2vJjZQL-Qjwgy2f6-vd1NCWMk1bUKinenIvBX2HEcfmHpvr2LZGCLhIjCAYN8-GfgO5PzMF57qdIn5sBgmlkgnY0gmlwhKwSMlaKbXVsdGlhZGRyc4wACgSsEjJWBpPg3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNozlK3KBjUKiCxBqmAD4wcz_RO30IXwbd6FMjVJNhRb4N0Y3CCk9-DdWRwgpPhhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-16_08-11-54__6468fc18-332e-4b25-ab60-eb1e3332f399__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.192.206
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['30572', '30573', '30574', '30575', '30576']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 30572:30572 -p 30573:30573 -p 30574:30574 -p 30575:30575 -p 30576:30576 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30574 --rest-port=30572 --tcp-port=30573 --discv5-udp-port=30575 --rest-address=0.0.0.0 --nat=extip:172.18.192.206 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bd6c04198eeeefd9bd7c886f8da8aca4d9ecfa3ecfefd30b97cfef33bbb4cbb6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30576 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QJOVIsbm2vJjZQL-Qjwgy2f6-vd1NCWMk1bUKinenIvBX2HEcfmHpvr2LZGCLhIjCAYN8-GfgO5PzMF57qdIn5sBgmlkgnY0gmlwhKwSMlaKbXVsdGlhZGRyc4wACgSsEjJWBpPg3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNozlK3KBjUKiCxBqmAD4wcz_RO30IXwbd6FMjVJNhRb4N0Y3CCk9-DdWRwgpPhhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.192.206 waku 4ad722d275ddebb4edba939d9452603c39bae931e9bd59c55a333944a6ca6001
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 4ad722d275dd. Setting up logs at ./log/docker/node2_2024-08-16_08-11-54__6468fc18-332e-4b25-ab60-eb1e3332f399__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 30572
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30572/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30572/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.192.206/tcp/30573/p2p/16Uiu2HAmD1WdgXBJ2YD5nsFmRWjfYWpx643CmzSQZQVmvd3uTkUT","/ip4/172.18.192.206/tcp/30574/ws/p2p/16Uiu2HAmD1WdgXBJ2YD5nsFmRWjfYWpx643CmzSQZQVmvd3uTkUT"],"enrUri":"enr:-LO4QGBkZOjio4sgNvzy-jQ2ROQs31rUiczGp1soGb_mwbt9Lrl0ccNIkvrA98DsV18UN-XM-bNwxc-XKogt3_frlF8BgmlkgnY0gmlwhKwSwM6KbXVsdGlhZGRyc4wACgSsEsDOBndu3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMFQdta7bJNidB6uWEGUuC7hZhbNyiHl5CviklazT_zVIN0Y3CCd22DdWRwgndvhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30572/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.50.86/tcp/37855/p2p/16Uiu2HAmKi7Dy8F6s1cBn5ApCCNYmUip5k8Z7JuRtMorTRKLA5cS"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37854/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30572/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37854/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37854/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1723795917499454464,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30572/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1723795917499454464,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37854/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37854/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1723795917616237056,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30572/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1723795917616237056,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 6a913a8e1efe
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 4ad722d275dd
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.