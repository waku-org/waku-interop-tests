[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_works_with_auto_sharding with id: 2024-08-16_08-13-20__bd4e646d-295a-442f-9416-9fd269db7132
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-16_08-13-20__bd4e646d-295a-442f-9416-9fd269db7132__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.100.145
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['37482', '37483', '37484', '37485', '37486']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 37482:37482 -p 37483:37483 -p 37484:37484 -p 37485:37485 -p 37486:37486 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37484 --rest-port=37482 --tcp-port=37483 --discv5-udp-port=37485 --rest-address=0.0.0.0 --nat=extip:172.18.100.145 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=fb83c8ea38a63df4fecdf7f1fdab0fd4a80f394b6fefdd3b1e3aef260cad1b35 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37486 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.100.145 waku 1bb387e88ebe7b6918b5b3f47e3fe60d420bc0b7fba80dd16b959d12700825f4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 1bb387e88ebe. Setting up logs at ./log/docker/node1_2024-08-16_08-13-20__bd4e646d-295a-442f-9416-9fd269db7132__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 37482
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37482/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37482/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.100.145/tcp/37483/p2p/16Uiu2HAkyvxhgduSzETcUX9hGVvh2UYfc5eBkKVSr6qhnV67xo2m","/ip4/172.18.100.145/tcp/37484/ws/p2p/16Uiu2HAkyvxhgduSzETcUX9hGVvh2UYfc5eBkKVSr6qhnV67xo2m"],"enrUri":"enr:-LO4QOHhVlo_wKPB-n7ziKjb8Bway2C06DVw6ob1zvlZu3xQXGqBgywwjO4-ZC0Qnu3l2lZbIx58YLhD9XcGd7JXzzsBgmlkgnY0gmlwhKwSZJGKbXVsdGlhZGRyc4wACgSsEmSRBpJs3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJC73_DvaYVyLgPWdyQwAuUAt6A3Lwrp_poLhWgIC9RdoN0Y3CCkmuDdWRwgpJthXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-16_08-13-20__bd4e646d-295a-442f-9416-9fd269db7132__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.191.208
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['64295', '64296', '64297', '64298', '64299']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 64295:64295 -p 64296:64296 -p 64297:64297 -p 64298:64298 -p 64299:64299 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=64297 --rest-port=64295 --tcp-port=64296 --discv5-udp-port=64298 --rest-address=0.0.0.0 --nat=extip:172.18.191.208 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=4d222e9ca506c9ad10eac321efefbe3bcf5b9db5ce58ff84ecf5fa7b9b507c10 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=64299 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QOHhVlo_wKPB-n7ziKjb8Bway2C06DVw6ob1zvlZu3xQXGqBgywwjO4-ZC0Qnu3l2lZbIx58YLhD9XcGd7JXzzsBgmlkgnY0gmlwhKwSZJGKbXVsdGlhZGRyc4wACgSsEmSRBpJs3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJC73_DvaYVyLgPWdyQwAuUAt6A3Lwrp_poLhWgIC9RdoN0Y3CCkmuDdWRwgpJthXdha3UyBQ --filternode=/ip4/172.18.100.145/tcp/37483/p2p/16Uiu2HAkyvxhgduSzETcUX9hGVvh2UYfc5eBkKVSr6qhnV67xo2m --content-topic=/myapp/1/latest/proto --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.191.208 waku bf7ee5e5bc74299b517118adbae75207113fc71ff0a285ada5a1751f9892a576
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID bf7ee5e5bc74. Setting up logs at ./log/docker/node2_2024-08-16_08-13-20__bd4e646d-295a-442f-9416-9fd269db7132__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 64295
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64295/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64295/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.191.208/tcp/64296/p2p/16Uiu2HAm5bYSPXQsUKoXyqxgiXxF2raXuHSxMBKx7tJ6Uux6UbDp","/ip4/172.18.191.208/tcp/64297/ws/p2p/16Uiu2HAm5bYSPXQsUKoXyqxgiXxF2raXuHSxMBKx7tJ6Uux6UbDp"],"enrUri":"enr:-LO4QH4q9fr2DFvEvl9d2fhSoiQ7EWof-qviuQg4LHdL8ulbUnwDmC7g97bMFGH9ESs8SSOMVMljnb48Hff0IeguWlcBgmlkgnY0gmlwhKwSv9CKbXVsdGlhZGRyc4wACgSsEr_QBvsp3QOCcnOFAAIBAACJc2VjcDI1NmsxoQKXHCZz0LVIbx9We-M2c-ZsXD8fGBwBL8yTHqleFUTWF4N0Y3CC-yiDdWRwgvsqhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64295/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.100.145/tcp/37483/p2p/16Uiu2HAkyvxhgduSzETcUX9hGVvh2UYfc5eBkKVSr6qhnV67xo2m"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37482/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64295/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "72c8aa1a-8f4b-4d1c-bf87-c11d9172e06b", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"72c8aa1a-8f4b-4d1c-bf87-c11d9172e06b","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37482/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:186 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64295/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723796003099698688,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 1bb387e88ebe
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id bf7ee5e5bc74
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.