[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_main_node_relay_and_store__peer_relay_and_store with id: 2024-09-17_04-38-36__588dc4c3-f925-4fef-94cd-263fff0ef887
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-09-17_04-38-36__588dc4c3-f925-4fef-94cd-263fff0ef887__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.151.45
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['11571', '11572', '11573', '11574', '11575']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 11571:11571 -p 11572:11572 -p 11573:11573 -p 11574:11574 -p 11575:11575 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11573 --rest-port=11571 --tcp-port=11572 --discv5-udp-port=11574 --rest-address=0.0.0.0 --nat=extip:172.18.151.45 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aca14dc89efc112a1bbc3ab1d9dfd6ba7cc6fa1685bf67f12a81bfd6d6b76b8e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11575 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.151.45 waku b453e8d0075c7cc3dabe937872b7560b319900775d6ac0e61fbd3906cbe6e889
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID b453e8d0075c. Setting up logs at ./log/docker/publishing_node1_2024-09-17_04-38-36__588dc4c3-f925-4fef-94cd-263fff0ef887__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 11571
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11571/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11571/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.151.45/tcp/11572/p2p/16Uiu2HAmS4NQoRiYCU3Rxf3fE7iQuzxTbpfi31bB1AVv7ncFrhKe","/ip4/172.18.151.45/tcp/11573/ws/p2p/16Uiu2HAmS4NQoRiYCU3Rxf3fE7iQuzxTbpfi31bB1AVv7ncFrhKe"],"enrUri":"enr:-LO4QIUTveSuiv3eE8lMsWrIZ_jyU-QrpPm-UrcL_9awQ_koEOoGNBVH5M-vKo-joMbnDAiqcKH0N5u2k2RTpAD19R0BgmlkgnY0gmlwhKwSly2KbXVsdGlhZGRyc4wACgSsEpctBi013QOCcnOFAAMBAACJc2VjcDI1NmsxoQPHJTuKrU5vMiCPaCRJLGbrj5-AnC7RXh96zuNLfnfIgYN0Y3CCLTSDdWRwgi02hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-09-17_04-38-36__588dc4c3-f925-4fef-94cd-263fff0ef887__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.160.105
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['56950', '56951', '56952', '56953', '56954']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 56950:56950 -p 56951:56951 -p 56952:56952 -p 56953:56953 -p 56954:56954 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56952 --rest-port=56950 --tcp-port=56951 --discv5-udp-port=56953 --rest-address=0.0.0.0 --nat=extip:172.18.160.105 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cf5ef3b4292aaefbbdef1dafddeb7d2ac99c16a342fcf8f94fb8e4ecdeb9b9ee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56954 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QIUTveSuiv3eE8lMsWrIZ_jyU-QrpPm-UrcL_9awQ_koEOoGNBVH5M-vKo-joMbnDAiqcKH0N5u2k2RTpAD19R0BgmlkgnY0gmlwhKwSly2KbXVsdGlhZGRyc4wACgSsEpctBi013QOCcnOFAAMBAACJc2VjcDI1NmsxoQPHJTuKrU5vMiCPaCRJLGbrj5-AnC7RXh96zuNLfnfIgYN0Y3CCLTSDdWRwgi02hXdha3UyAw --storenode=/ip4/172.18.151.45/tcp/11572/p2p/16Uiu2HAmS4NQoRiYCU3Rxf3fE7iQuzxTbpfi31bB1AVv7ncFrhKe --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.160.105 waku db7ae6c861b76015b34f1ab51b4e894b2b20ef1085aa54d1d0141da0b6baaeae
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID db7ae6c861b7. Setting up logs at ./log/docker/store_node1_2024-09-17_04-38-36__588dc4c3-f925-4fef-94cd-263fff0ef887__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 56950
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56950/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56950/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.160.105/tcp/56951/p2p/16Uiu2HAm8NtJZKxhr27ETd5N9zfTzqgD2xRj4VsZk181XdPrq1jW","/ip4/172.18.160.105/tcp/56952/ws/p2p/16Uiu2HAm8NtJZKxhr27ETd5N9zfTzqgD2xRj4VsZk181XdPrq1jW"],"enrUri":"enr:-LO4QHI13vs8_DmT2EQhbbGJgfbM3KM9WSl8sc1nE3ev0xpAcDRIwFOuBdWW1KU6TVo78S20v7VDc4UQGbi_jfz8Id4BgmlkgnY0gmlwhKwSoGmKbXVsdGlhZGRyc4wACgSsEqBpBt543QOCcnOFAAMBAACJc2VjcDI1NmsxoQLAcR8zG3poS81HdW-E_zbCBf4UyA5rS2wsw71xzg7W8YN0Y3CC3neDdWRwgt55hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:56950/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.151.45/tcp/11572/p2p/16Uiu2HAmS4NQoRiYCU3Rxf3fE7iQuzxTbpfi31bB1AVv7ncFrhKe"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11571/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:56950/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:129 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11571/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:215 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11571/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"TkUq4vbVmIHe9XGOxLPCzRnhZgOw8qYQ6uPUt7itUTk="}]}'
[35mDEBUG   [0m src.steps.store:store.py:215 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56950/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"TkUq4vbVmIHe9XGOxLPCzRnhZgOw8qYQ6uPUt7itUTk="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b453e8d0075c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id db7ae6c861b7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.