[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_same_shard with id: 2024-12-27_10-44-57__71970a37-179c-4b76-bb97-1c0fab618fff
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-27_10-44-57__71970a37-179c-4b76-bb97-1c0fab618fff__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.225.23
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['32393', '32394', '32395', '32396', '32397']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 32393:32393 -p 32394:32394 -p 32395:32395 -p 32396:32396 -p 32397:32397 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32395 --rest-port=32393 --tcp-port=32394 --discv5-udp-port=32396 --rest-address=0.0.0.0 --nat=extip:172.18.225.23 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a2afbcabe6fedcd45e4f5b0af0da32ff5303adaa45a9c31332ebadcb30ea234c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32397 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.225.23 waku 622252be22958a3ceb4241d14b414a5971494de2c614da11820b115a764a10a5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 622252be2295. Setting up logs at ./log/docker/node1_2024-12-27_10-44-57__71970a37-179c-4b76-bb97-1c0fab618fff__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 32393
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 00a392af427f. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32393/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32393/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.225.23/tcp/32394/p2p/16Uiu2HAkxC4dU2T9dcE7D1622YMzSE5Z2UsS5bp7y2X5gLPZ5Vqa","/ip4/172.18.225.23/tcp/32395/ws/p2p/16Uiu2HAkxC4dU2T9dcE7D1622YMzSE5Z2UsS5bp7y2X5gLPZ5Vqa"],"enrUri":"enr:-L24QA69u2DWW1TRV-jxOYB2BVIc14vJX6jZ5rN1fb_lBcbZZTGe8GtcoiigI5rZtzyARjYjF0ryHTC8dZhhhfWYCQUCgmlkgnY0gmlwhKwS4ReKbXVsdGlhZGRyc5YACASsEuEXBn6KAAoErBLhFwZ-i90DgnJzhQACAQAAiXNlY3AyNTZrMaECKRaKE_bBFb2C8lUpXLdTqJdRLSH8ZFzGFPpNdV6r5ZGDdGNwgn6Kg3VkcIJ-jIV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-27_10-44-57__71970a37-179c-4b76-bb97-1c0fab618fff__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.176.243
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['13875', '13876', '13877', '13878', '13879']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 13875:13875 -p 13876:13876 -p 13877:13877 -p 13878:13878 -p 13879:13879 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13877 --rest-port=13875 --tcp-port=13876 --discv5-udp-port=13878 --rest-address=0.0.0.0 --nat=extip:172.18.176.243 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=db3a2fbbeaeecd0ad0b28be763c3a9df52fedfb2cc0230e9f8fedfeba3fa2ebe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13879 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QA69u2DWW1TRV-jxOYB2BVIc14vJX6jZ5rN1fb_lBcbZZTGe8GtcoiigI5rZtzyARjYjF0ryHTC8dZhhhfWYCQUCgmlkgnY0gmlwhKwS4ReKbXVsdGlhZGRyc5YACASsEuEXBn6KAAoErBLhFwZ-i90DgnJzhQACAQAAiXNlY3AyNTZrMaECKRaKE_bBFb2C8lUpXLdTqJdRLSH8ZFzGFPpNdV6r5ZGDdGNwgn6Kg3VkcIJ-jIV3YWt1MgU --pubsub-topic=/waku/2/rs/4/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.176.243 waku 0fc9991fda47fceedbde3169be40c4ccc771f235a1e4dfbf2ecf7f67108ac85b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0fc9991fda47. Setting up logs at ./log/docker/node2_2024-12-27_10-44-57__71970a37-179c-4b76-bb97-1c0fab618fff__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 13875
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13875/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13875/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.176.243/tcp/13876/p2p/16Uiu2HAmCujXD2Cvnp6k1coNX4bcbmzgLg6EYwn97XFN6twSE1aj","/ip4/172.18.176.243/tcp/13877/ws/p2p/16Uiu2HAmCujXD2Cvnp6k1coNX4bcbmzgLg6EYwn97XFN6twSE1aj"],"enrUri":"enr:-L24QKxmQO4WDsopBg2WFB9nMV2zHuwYekGqQ5l-2L482jucUOUPPhCvh4sULFK9li3cKw7nYD3VTrZHfxj7YncuQBwCgmlkgnY0gmlwhKwSsPOKbXVsdGlhZGRyc5YACASsErDzBjY0AAoErBKw8wY2Nd0DgnJzhQAEAQAAiXNlY3AyNTZrMaEDA8bx51Ze68vz4i1F-oeWKQ9DLjxl3V8UeJApYusDjjyDdGNwgjY0g3VkcII2NoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13875/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.225.23/tcp/32394/p2p/16Uiu2HAkxC4dU2T9dcE7D1622YMzSE5Z2UsS5bp7y2X5gLPZ5Vqa"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32393/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13875/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32393/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32393/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1735296299890593792,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13875/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:13875/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 622252be2295
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 0fc9991fda47
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 622252be2295. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.