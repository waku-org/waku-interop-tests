[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2024-12-25_20-00-23__6a7a2c19-2a33-4707-8e92-2c327367496a
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-25_20-00-23__6a7a2c19-2a33-4707-8e92-2c327367496a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-25_20-00-23__6a7a2c19-2a33-4707-8e92-2c327367496a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-12-25_20-00-23__6a7a2c19-2a33-4707-8e92-2c327367496a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:389 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.136.92
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['38267', '38268', '38269', '38270', '38271']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 38267:38267 -p 38268:38268 -p 38269:38269 -p 38270:38270 -p 38271:38271 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38269 --rest-port=38267 --tcp-port=38268 --discv5-udp-port=38270 --rest-address=0.0.0.0 --nat=extip:172.18.136.92 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bae3f6493cba98f5badfacafcbb473e99be87f81a61ed00049b403c5b67f2c6f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38271 --metrics-logging=true --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.136.92 waku 657dd6df631c25e250cdb0074193e78f091c1c987323f1ca3a8f33657edd3d25
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 657dd6df631c. Setting up logs at ./log/docker/node1_2024-12-25_20-00-23__6a7a2c19-2a33-4707-8e92-2c327367496a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 38267
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38267/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38267/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.136.92/tcp/38268/p2p/16Uiu2HAmKKeohDCUtgixfJJ1aJZqJ2NzwhqKPZepLYeWvKMLMHM1","/ip4/172.18.136.92/tcp/38269/ws/p2p/16Uiu2HAmKKeohDCUtgixfJJ1aJZqJ2NzwhqKPZepLYeWvKMLMHM1"],"enrUri":"enr:-L24QKud8DxnVNu13LZr8A3CrFVqxiAPaxpSj5oIO33vOgsPcQXb4DMFcF2vY9NJLUYiP0-7gvL5y5WDf9ZIXl_idGACgmlkgnY0gmlwhKwSiFyKbXVsdGlhZGRyc5YACASsEohcBpV8AAoErBKIXAaVfd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYw2sfVOjO1f-udRCz6jWPdn_DL21TEsaetRxKlkzKpiDdGNwgpV8g3VkcIKVfoV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.153.115
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['11101', '11102', '11103', '11104', '11105']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 11101:11101 -p 11102:11102 -p 11103:11103 -p 11104:11104 -p 11105:11105 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11103 --rest-port=11101 --tcp-port=11102 --discv5-udp-port=11104 --rest-address=0.0.0.0 --nat=extip:172.18.153.115 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c6647ba6da169e42ee4fdad8bae04774310f65ff6a98438f851efa52bc58e6ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11105 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QKud8DxnVNu13LZr8A3CrFVqxiAPaxpSj5oIO33vOgsPcQXb4DMFcF2vY9NJLUYiP0-7gvL5y5WDf9ZIXl_idGACgmlkgnY0gmlwhKwSiFyKbXVsdGlhZGRyc5YACASsEohcBpV8AAoErBKIXAaVfd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYw2sfVOjO1f-udRCz6jWPdn_DL21TEsaetRxKlkzKpiDdGNwgpV8g3VkcIKVfoV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.153.115 waku 33c6ec75ab0aba18490c23ec4e893a62ddbb032fd91f5b553b8572999f121739
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 33c6ec75ab0a. Setting up logs at ./log/docker/node2_2024-12-25_20-00-23__6a7a2c19-2a33-4707-8e92-2c327367496a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 11101
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11101/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11101/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.153.115/tcp/11102/p2p/16Uiu2HAmG1JF7tnv7Q7mB4us7byJFDmPmddgrHMwAqwSET53BJxR","/ip4/172.18.153.115/tcp/11103/ws/p2p/16Uiu2HAmG1JF7tnv7Q7mB4us7byJFDmPmddgrHMwAqwSET53BJxR"],"enrUri":"enr:-L24QIKhTF9n8a1U5UupqnAB4JhO8FKZCHuXYq-MeyCObOnPYbibtWQ5mj5TBBLUaoqhied805TwsllOxWqq5BpHFQoCgmlkgnY0gmlwhKwSmXOKbXVsdGlhZGRyc5YACASsEplzBiteAAoErBKZcwYrX90DgnJzhQADAQAAiXNlY3AyNTZrMaEDMcboylw4xXYDf9LYQSCANHKOaYxzorFwDmDwL943aiKDdGNwgiteg3VkcIIrYIV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.143.164
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['23133', '23134', '23135', '23136', '23137']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 23133:23133 -p 23134:23134 -p 23135:23135 -p 23136:23136 -p 23137:23137 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23135 --rest-port=23133 --tcp-port=23134 --discv5-udp-port=23136 --rest-address=0.0.0.0 --nat=extip:172.18.143.164 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=946e5acfeddafcf7e47efae2caeba9252c6fbfda542e88ad65ecb7b91da0dbe5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23137 --metrics-logging=true --relay=false --storenode=/ip4/172.18.153.115/tcp/11102/p2p/16Uiu2HAmG1JF7tnv7Q7mB4us7byJFDmPmddgrHMwAqwSET53BJxR --discv5-bootstrap-node=enr:-L24QIKhTF9n8a1U5UupqnAB4JhO8FKZCHuXYq-MeyCObOnPYbibtWQ5mj5TBBLUaoqhied805TwsllOxWqq5BpHFQoCgmlkgnY0gmlwhKwSmXOKbXVsdGlhZGRyc5YACASsEplzBiteAAoErBKZcwYrX90DgnJzhQADAQAAiXNlY3AyNTZrMaEDMcboylw4xXYDf9LYQSCANHKOaYxzorFwDmDwL943aiKDdGNwgiteg3VkcIIrYIV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.143.164 waku 0313bff18ac4b3eb0de73bc5c29904b3946c1dfbe5ca8a97548420fcf09acb3c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0313bff18ac4. Setting up logs at ./log/docker/node3_2024-12-25_20-00-23__6a7a2c19-2a33-4707-8e92-2c327367496a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 23133
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23133/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23133/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.143.164/tcp/23134/p2p/16Uiu2HAmFAt4qQptNqM7e3RUvWJUWHa8XdC46jYPj7aZETcRXipZ","/ip4/172.18.143.164/tcp/23135/ws/p2p/16Uiu2HAmFAt4qQptNqM7e3RUvWJUWHa8XdC46jYPj7aZETcRXipZ"],"enrUri":"enr:-L24QAMdzQUSJpjFPwpqW-D34b2b6-9qjW2084FMG2HrDCPjK2y2pLboI3l_F4MXYpg8AnAX9h5C7BHghQx9Gfn0J2wCgmlkgnY0gmlwhKwSj6SKbXVsdGlhZGRyc5YACASsEo-kBlpeAAoErBKPpAZaX90DgnJzhQADAQAAiXNlY3AyNTZrMaEDJV-xcMHjp5F87AacJJUpc3jSScCneASgobd4pzgckZqDdGNwglpeg3VkcIJaYIV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:394 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38267/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11101/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38267/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.153.115/tcp/11102/p2p/16Uiu2HAmG1JF7tnv7Q7mB4us7byJFDmPmddgrHMwAqwSET53BJxR","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11101/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.136.92/tcp/38268/p2p/16Uiu2HAmKKeohDCUtgixfJJ1aJZqJ2NzwhqKPZepLYeWvKMLMHM1","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:399 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38267/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:404 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23133/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"339ec2bbe958baf7e0ae","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:408 Response for store when ephemeral = true is strPeer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '339ec2bbe958baf7e0ae', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:410 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 657dd6df631c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 33c6ec75ab0a
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 657dd6df631c. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 0313bff18ac4
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 33c6ec75ab0a. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.