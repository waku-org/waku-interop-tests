[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2024-08-29_12-52-36__ba214dad-29e9-4e95-8916-dd467769dd87
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-08-29_12-52-36__ba214dad-29e9-4e95-8916-dd467769dd87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.145.145
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['39063', '39064', '39065', '39066', '39067']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 39063:39063 -p 39064:39064 -p 39065:39065 -p 39066:39066 -p 39067:39067 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39065 --rest-port=39063 --tcp-port=39064 --discv5-udp-port=39066 --rest-address=0.0.0.0 --nat=extip:172.18.145.145 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9dadbd013a3d82f9dd23dd2ba3d133a7f71c1d6f8deacf5fcb167383aea9ede7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39067 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.145.145 waku ae06f8d0f48543fa91cd87a2f951c5e26fe8a67067e496a8f375d061d08afd6b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ae06f8d0f485. Setting up logs at ./log/docker/publishing_node1_2024-08-29_12-52-36__ba214dad-29e9-4e95-8916-dd467769dd87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 39063
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39063/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39063/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.145.145/tcp/39064/p2p/16Uiu2HAm74yi2o6mghesAGydyGRA8Pytjx1bEvpjYZW5TELHkYj4","/ip4/172.18.145.145/tcp/39065/ws/p2p/16Uiu2HAm74yi2o6mghesAGydyGRA8Pytjx1bEvpjYZW5TELHkYj4"],"enrUri":"enr:-LO4QHykog0WA-WOBN6jY2dFeB_KXlex7yULPc5P1OyhAphGZg5auTSeL9YFB4K2oDt4yPGG8hqDDmd_ZjClV6rCT8kBgmlkgnY0gmlwhKwSkZGKbXVsdGlhZGRyc4wACgSsEpGRBpiZ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKs_xdtpgJracQQTiBlQSyxtN88Yj153bnalGyrESghu4N0Y3CCmJiDdWRwgpiahXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-08-29_12-52-36__ba214dad-29e9-4e95-8916-dd467769dd87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.200.178
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['31546', '31547', '31548', '31549', '31550']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 31546:31546 -p 31547:31547 -p 31548:31548 -p 31549:31549 -p 31550:31550 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31548 --rest-port=31546 --tcp-port=31547 --discv5-udp-port=31549 --rest-address=0.0.0.0 --nat=extip:172.18.200.178 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fdcaedfaba6c9ffaefcc41afd8b1d3fbd3c5cdf6d61fd4bf956b85efe0f30e4d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31550 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QHykog0WA-WOBN6jY2dFeB_KXlex7yULPc5P1OyhAphGZg5auTSeL9YFB4K2oDt4yPGG8hqDDmd_ZjClV6rCT8kBgmlkgnY0gmlwhKwSkZGKbXVsdGlhZGRyc4wACgSsEpGRBpiZ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKs_xdtpgJracQQTiBlQSyxtN88Yj153bnalGyrESghu4N0Y3CCmJiDdWRwgpiahXdha3UyAw --storenode=/ip4/172.18.145.145/tcp/39064/p2p/16Uiu2HAm74yi2o6mghesAGydyGRA8Pytjx1bEvpjYZW5TELHkYj4 --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.200.178 waku 734314800beda43c10424fe8fe35b2850731c7d9ba2d00ac667fdf0b50d5f5e7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 734314800bed. Setting up logs at ./log/docker/store_node1_2024-08-29_12-52-36__ba214dad-29e9-4e95-8916-dd467769dd87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 31546
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31546/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31546/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.200.178/tcp/31547/p2p/16Uiu2HAmMLTZ9UfpKGCUwxQfxuJMVxrPYv68BrEnfMMyUovMCBMJ","/ip4/172.18.200.178/tcp/31548/ws/p2p/16Uiu2HAmMLTZ9UfpKGCUwxQfxuJMVxrPYv68BrEnfMMyUovMCBMJ"],"enrUri":"enr:-LO4QIpMqjd5Nfd12zOZIuzZg4pcEz4Ph43aKDsAyY4J67m_N98FM-w4PBpD4LfFmEQQejlDuYZ14um5H7c0N57iKPgBgmlkgnY0gmlwhKwSyLKKbXVsdGlhZGRyc4wACgSsEsiyBns83QOCcnOFAAMBAACJc2VjcDI1NmsxoQOA-eg4rfuin8uAVQiyH3RPXzUjFBN9oPRQcD6euk5yGYN0Y3CCezuDdWRwgns9hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31546/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.145.145/tcp/39064/p2p/16Uiu2HAm74yi2o6mghesAGydyGRA8Pytjx1bEvpjYZW5TELHkYj4"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39063/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31546/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:129 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:217 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39063/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"yYit1IFSTFesur1sxl2fO535n+x7kIDkZrEbrwzUt6o="}]}'
[35mDEBUG   [0m src.steps.store:store.py:217 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31546/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"99f0b3b0be9398d897c1","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"yYit1IFSTFesur1sxl2fO535n+x7kIDkZrEbrwzUt6o="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ae06f8d0f485
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 734314800bed
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.