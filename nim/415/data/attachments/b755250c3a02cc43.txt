[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_add_a_new_content_topic with id: 2024-10-31_04-06-58__351d3479-ac86-4283-9f3a-b21e348e80f6
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-31_04-06-58__351d3479-ac86-4283-9f3a-b21e348e80f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.39.173
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['49389', '49390', '49391', '49392', '49393']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 49389:49389 -p 49390:49390 -p 49391:49391 -p 49392:49392 -p 49393:49393 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49391 --rest-port=49389 --tcp-port=49390 --discv5-udp-port=49392 --rest-address=0.0.0.0 --nat=extip:172.18.39.173 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b3a0a88938bea5b54cf3cf19ab6e9b62a08d6cf07bb9baaa0af37c23ea642c4d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49393 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.39.173 waku 2542b8c45d66ca12e53718550075797b17f2c85d8cc9ee8a88d2e19829013e74
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2542b8c45d66. Setting up logs at ./log/docker/node1_2024-10-31_04-06-58__351d3479-ac86-4283-9f3a-b21e348e80f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 49389
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ccda75a554eb. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49389/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49389/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.173/tcp/49390/p2p/16Uiu2HAm92KfLFNW9eWT3qDYi6wdcs4dcQWx99yvKWx8REEptgqm","/ip4/172.18.39.173/tcp/49391/ws/p2p/16Uiu2HAm92KfLFNW9eWT3qDYi6wdcs4dcQWx99yvKWx8REEptgqm"],"enrUri":"enr:-L24QBn4R-UWOBuDLiMKj_pHoLXORXz3SW0tu-ixtD5Hg4oqCjOnmwZMxxlOIbV3L9RUyBwZrufntXh9tBLl7Aq_C_UCgmlkgnY0gmlwhKwSJ62KbXVsdGlhZGRyc5YACASsEietBsDuAAoErBInrQbA790DgnJzhQADAQAAiXNlY3AyNTZrMaECyghIzi2D0V7YjalbbvsttKkYxyXlMKXDARI2QrM-ntCDdGNwgsDug3VkcILA8IV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-31_04-06-58__351d3479-ac86-4283-9f3a-b21e348e80f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.36.56
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['58504', '58505', '58506', '58507', '58508']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 58504:58504 -p 58505:58505 -p 58506:58506 -p 58507:58507 -p 58508:58508 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58506 --rest-port=58504 --tcp-port=58505 --discv5-udp-port=58507 --rest-address=0.0.0.0 --nat=extip:172.18.36.56 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f2ab93caa639c6ba56d7f0b95acdbddfa8ceedf24219c40ae0bd23c24babe3d0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58508 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QBn4R-UWOBuDLiMKj_pHoLXORXz3SW0tu-ixtD5Hg4oqCjOnmwZMxxlOIbV3L9RUyBwZrufntXh9tBLl7Aq_C_UCgmlkgnY0gmlwhKwSJ62KbXVsdGlhZGRyc5YACASsEietBsDuAAoErBInrQbA790DgnJzhQADAQAAiXNlY3AyNTZrMaECyghIzi2D0V7YjalbbvsttKkYxyXlMKXDARI2QrM-ntCDdGNwgsDug3VkcILA8IV3YWt1MgU --filternode=/ip4/172.18.39.173/tcp/49390/p2p/16Uiu2HAm92KfLFNW9eWT3qDYi6wdcs4dcQWx99yvKWx8REEptgqm
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.36.56 waku 00df09b8a0711a49de5def0a4a04d5ed99ad30a092965b80683a7a551734d942
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 00df09b8a071. Setting up logs at ./log/docker/node2_2024-10-31_04-06-58__351d3479-ac86-4283-9f3a-b21e348e80f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 58504
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58504/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58504/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.36.56/tcp/58505/p2p/16Uiu2HAmAitJqWNejwW7SWf1AygHx6s8EGChuDhNpEeLAPoVcyiC","/ip4/172.18.36.56/tcp/58506/ws/p2p/16Uiu2HAmAitJqWNejwW7SWf1AygHx6s8EGChuDhNpEeLAPoVcyiC"],"enrUri":"enr:-L24QPpd4RKmdJsZM6JUHwIcswmh4mk3kIcQWuevCYdzVzc0Hqkty0O289rOJXVoDh5L9jns1rsjtKTq1v_9H_gCDgQCgmlkgnY0gmlwhKwSJDiKbXVsdGlhZGRyc5YACASsEiQ4BuSJAAoErBIkOAbkit0DgnJzhQADAQAAiXNlY3AyNTZrMaEC40geCmPMuT2wz1GeOGmD6ff4wb-ArnJlLG7CEcoKhi2DdGNwguSJg3VkcILki4V3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58504/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.173/tcp/49390/p2p/16Uiu2HAm92KfLFNW9eWT3qDYi6wdcs4dcQWx99yvKWx8REEptgqm"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49389/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58504/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ddf1ea37-9c64-426f-97f2-9d8e7fa183eb", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"ddf1ea37-9c64-426f-97f2-9d8e7fa183eb","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:58504/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49389/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58504/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1730347621445986816,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49389/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58504/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1730347621560100096,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 2542b8c45d66
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 00df09b8a071
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 2542b8c45d66. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.