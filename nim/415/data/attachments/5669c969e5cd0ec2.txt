[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_valid_payloads_n1_with_rln_n2_without_rln_at_spam_rate with id: 2024-10-31_04-54-59__0be6dbb3-1e97-4860-be97-d8d2a6fc5773
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-31_04-54-59__0be6dbb3-1e97-4860-be97-d8d2a6fc5773__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.243.5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20841', '20842', '20843', '20844', '20845']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes ['/home/runner/work/waku-interop-tests/waku-interop-tests/rln_tree_ehyf_1:/etc/rln_tree', '/home/runner/work/waku-interop-tests/waku-interop-tests/keystore_ehyf_1:/keystore']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20841:20841 -p 20842:20842 -p 20843:20843 -p 20844:20844 -p 20845:20845 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20843 --rest-port=20841 --tcp-port=20842 --discv5-udp-port=20844 --rest-address=0.0.0.0 --nat=extip:172.18.243.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=52db5f32586abdc1bfef2acfcabaad6bb9fb9deb4031926b48bb0ea66eae75a3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20845 --metrics-logging=true --relay=true --rln-relay-membership-index=1 --rln-relay-user-message-limit=1 --rln-relay-epoch-sec=1 --rln-relay=true --rln-relay-cred-path=/keystore/keystore.json --rln-relay-cred-password=password
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.243.5 waku 527f1dba998289ae4c342ee5e57736df67951851039b3e5fd29bf9a95ace15c9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 527f1dba9982. Setting up logs at ./log/docker/node1_2024-10-31_04-54-59__0be6dbb3-1e97-4860-be97-d8d2a6fc5773__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 20841
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 02757725bd4c. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20841/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Initializing","protocolsHealth":[{"Rln Relay":"Ready"}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20841/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[{"Rln Relay":"Ready"}]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20841/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.243.5/tcp/20842/p2p/16Uiu2HAkvNkEubDxea2UVHNsbseuh5RLh2hvv3RfLL6Jj9orLB7g","/ip4/172.18.243.5/tcp/20843/ws/p2p/16Uiu2HAkvNkEubDxea2UVHNsbseuh5RLh2hvv3RfLL6Jj9orLB7g"],"enrUri":"enr:-L24QPvo_CUkcgLOKDy_8xxiHku08J8shMVAaxahLBAtrIKcVBSyyJ679Vqi9VN-TmVb72knaAdtWc5ch3y24RItr4ICgmlkgnY0gmlwhKwS8wWKbXVsdGlhZGRyc5YACASsEvMFBlFqAAoErBLzBQZRa90DgnJzhQADAQAAiXNlY3AyNTZrMaECDhvDD8vyKub-dtuXc7kWHdzcI4BbxqY9rtaAom7QmrODdGNwglFqg3VkcIJRbIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-31_04-54-59__0be6dbb3-1e97-4860-be97-d8d2a6fc5773__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.232.23
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['54595', '54596', '54597', '54598', '54599']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 54595:54595 -p 54596:54596 -p 54597:54597 -p 54598:54598 -p 54599:54599 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54597 --rest-port=54595 --tcp-port=54596 --discv5-udp-port=54598 --rest-address=0.0.0.0 --nat=extip:172.18.232.23 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=635828aaf2fd93d043180bedef6af8ed9b8fbbb1d9a5e287efb3eefbebb32c57 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54599 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QPvo_CUkcgLOKDy_8xxiHku08J8shMVAaxahLBAtrIKcVBSyyJ679Vqi9VN-TmVb72knaAdtWc5ch3y24RItr4ICgmlkgnY0gmlwhKwS8wWKbXVsdGlhZGRyc5YACASsEvMFBlFqAAoErBLzBQZRa90DgnJzhQADAQAAiXNlY3AyNTZrMaECDhvDD8vyKub-dtuXc7kWHdzcI4BbxqY9rtaAom7QmrODdGNwglFqg3VkcIJRbIV3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.232.23 waku 8534298fe9d8248cfe0abd52c6d8934828b1499c8a4878d8ef4d6f6d55066f8a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 8534298fe9d8. Setting up logs at ./log/docker/node2_2024-10-31_04-54-59__0be6dbb3-1e97-4860-be97-d8d2a6fc5773__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 54595
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54595/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54595/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.232.23/tcp/54596/p2p/16Uiu2HAm54XR3BMcMw8MMPqPQ3xvzm6NM9h1zUu1PPL1TESUiJ74","/ip4/172.18.232.23/tcp/54597/ws/p2p/16Uiu2HAm54XR3BMcMw8MMPqPQ3xvzm6NM9h1zUu1PPL1TESUiJ74"],"enrUri":"enr:-L24QOnBBc1Nwbbe8-GwuPXqs7Vh4Ix6Fq7eY7VMqQ1C-4QcJsbvvWkeZhjToR24nD_lH2hh5-MKTcjcU-wU3y4-O1QCgmlkgnY0gmlwhKwS6BeKbXVsdGlhZGRyc5YACASsEugXBtVEAAoErBLoFwbVRd0DgnJzhQADAQAAiXNlY3AyNTZrMaECjyn88zjeaQiPtjE9PDPiDDhLJCefo2CCSDOzlH6NBruDdGNwgtVEg3VkcILVRoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54595/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.243.5/tcp/20842/p2p/16Uiu2HAkvNkEubDxea2UVHNsbseuh5RLh2hvv3RfLL6Jj9orLB7g"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20841/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/1/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54595/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/1/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:197 Running test with payload A simple string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0" -H "Content-Type: application/json" -d '{"payload": "SGVsbG8gV29ybGQh", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:197 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0" -H "Content-Type: application/json" -d '{"payload": "MTIzNDU2Nzg5MA==", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0. Response content: b'Failed to publish: error appending RLN proof to message: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 1 & nonceLimit: 1'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:197 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0" -H "Content-Type: application/json" -d '{"payload": "eyJrZXkiOiAidmFsdWUifQ==", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0. Response content: b'Failed to publish: error appending RLN proof to message: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 2 & nonceLimit: 1'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:197 Running test with payload Chinese characters
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0" -H "Content-Type: application/json" -d '{"payload": "6L+Z5piv5LiA5Lqb5Lit5paH", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0. Response content: b'Failed to publish: error appending RLN proof to message: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 3 & nonceLimit: 1'
[35mDEBUG   [0m tests.relay.test_rln:test_rln.py:197 Running test with payload Emojis
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0" -H "Content-Type: application/json" -d '{"payload": "8J+agPCfjJ/inKg=", "contentTopic": "/test/1/waku-rln-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:20841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F1%2F0. Response content: b'Failed to publish: error appending RLN proof to message: could not get new message id to generate an rln proof: NonceLimitReached: Nonce limit reached. Please wait for the next epoch. requested nonce: 4 & nonceLimit: 1'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 527f1dba9982
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 8534298fe9d8
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 527f1dba9982. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.