[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-12-16_04-11-35__51da4b83-6c5e-4885-b092-7b9d800b4e14
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-12-16_04-11-35__51da4b83-6c5e-4885-b092-7b9d800b4e14__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.21.33
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['39907', '39908', '39909', '39910', '39911']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 39907:39907 -p 39908:39908 -p 39909:39909 -p 39910:39910 -p 39911:39911 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39909 --rest-port=39907 --tcp-port=39908 --discv5-udp-port=39910 --rest-address=0.0.0.0 --nat=extip:172.18.21.33 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=00ba9a29fbcdd8bc4d7dcdd81b7016774fee6bbe5bdeed91f7fdda1e09f6b5e2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39911 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.21.33 waku d4b5d8036913b9eaeebbd08a1d8df9b8cb43011a7d1e5207a4c03072790c0dbb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d4b5d8036913. Setting up logs at ./log/docker/receiving_node1_2024-12-16_04-11-35__51da4b83-6c5e-4885-b092-7b9d800b4e14__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 39907
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b95c2107c5b8. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39907/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39907/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.21.33/tcp/39908/p2p/16Uiu2HAmG6e21DLE4JXptXD22JvmigKytq9aEFcYWk2mY5fCbKZ8","/ip4/172.18.21.33/tcp/39909/ws/p2p/16Uiu2HAmG6e21DLE4JXptXD22JvmigKytq9aEFcYWk2mY5fCbKZ8"],"enrUri":"enr:-L24QGGc3Go2pYLDzAcnl35DRiuX3meDpoG9fmagNHJ9DYWpc21HYWNubtyf3GTmJMhkRh1BvqGPzWHd2GXFT_cfji8CgmlkgnY0gmlwhKwSFSGKbXVsdGlhZGRyc5YACASsEhUhBpvkAAoErBIVIQab5d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDMyUr-YfXUC8s1b4CPZtdkmcCfpUKyp2yt-oq7aq92w-DdGNwgpvkg3VkcIKb5oV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-12-16_04-11-35__51da4b83-6c5e-4885-b092-7b9d800b4e14__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.177.234
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['16384', '16385', '16386', '16387', '16388']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 16384:16384 -p 16385:16385 -p 16386:16386 -p 16387:16387 -p 16388:16388 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16386 --rest-port=16384 --tcp-port=16385 --discv5-udp-port=16387 --rest-address=0.0.0.0 --nat=extip:172.18.177.234 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0fb1b7c01e3bae1140d70dd8a47ca539f52ea9d277f801232beb2d291afad7ca --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16388 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.177.234 waku e1429409ae4dd0673bf9bf1c9714d4e8862fc426f29d18cb3f74b9a4055a4646
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID e1429409ae4d. Setting up logs at ./log/docker/receiving_node2_2024-12-16_04-11-35__51da4b83-6c5e-4885-b092-7b9d800b4e14__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 16384
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16384/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16384/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.234/tcp/16385/p2p/16Uiu2HAmTSDLGhtVioxS8fadXVUeDHJTcrDiAzVv9aggJwjKL5sV","/ip4/172.18.177.234/tcp/16386/ws/p2p/16Uiu2HAmTSDLGhtVioxS8fadXVUeDHJTcrDiAzVv9aggJwjKL5sV"],"enrUri":"enr:-L24QLRn7TlAlPecYunEcP4s741x5dFB4Ka9zmk7moNTp4f_OPZ1qnEOCQF6vEUxKsbbsb5ZqQW34I231R9PkC7L7iUCgmlkgnY0gmlwhKwSseqKbXVsdGlhZGRyc5YACASsErHqBkABAAoErBKx6gZAAt0DgnJzhQADAQAAiXNlY3AyNTZrMaED25luw6WDoytZWShD9XJkKsLMHFmcXQTNC7T2iLGZPViDdGNwgkABg3VkcIJAA4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16384/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.21.33/tcp/39908/p2p/16Uiu2HAmG6e21DLE4JXptXD22JvmigKytq9aEFcYWk2mY5fCbKZ8"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-12-16_04-11-35__51da4b83-6c5e-4885-b092-7b9d800b4e14__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.84.91
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['13632', '13633', '13634', '13635', '13636']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 13632:13632 -p 13633:13633 -p 13634:13634 -p 13635:13635 -p 13636:13636 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13634 --rest-port=13632 --tcp-port=13633 --discv5-udp-port=13635 --rest-address=0.0.0.0 --nat=extip:172.18.84.91 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6598dc1ae2d18201650df9ddcceeee5e0c673cbe2c9d1ccffc92fd5a6dda7b76 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13636 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QGGc3Go2pYLDzAcnl35DRiuX3meDpoG9fmagNHJ9DYWpc21HYWNubtyf3GTmJMhkRh1BvqGPzWHd2GXFT_cfji8CgmlkgnY0gmlwhKwSFSGKbXVsdGlhZGRyc5YACASsEhUhBpvkAAoErBIVIQab5d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDMyUr-YfXUC8s1b4CPZtdkmcCfpUKyp2yt-oq7aq92w-DdGNwgpvkg3VkcIKb5oV3YWt1Mgk --lightpushnode=/ip4/172.18.21.33/tcp/39908/p2p/16Uiu2HAmG6e21DLE4JXptXD22JvmigKytq9aEFcYWk2mY5fCbKZ8 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.84.91 waku b05439fcc0b29728b552d95eca5163082c33e8665a0e5e09bb90948dd58201fa
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b05439fcc0b2. Setting up logs at ./log/docker/lightpush_node1_2024-12-16_04-11-35__51da4b83-6c5e-4885-b092-7b9d800b4e14__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 13632
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13632/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13632/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.84.91/tcp/13633/p2p/16Uiu2HAm4wB2oLdcgfzU5oe3mepxspi5UFCp8z8w4mJKyzQauQWh","/ip4/172.18.84.91/tcp/13634/ws/p2p/16Uiu2HAm4wB2oLdcgfzU5oe3mepxspi5UFCp8z8w4mJKyzQauQWh"],"enrUri":"enr:-L24QEoNwcsz6iqEbXRh9WasowaLYFwGWgBPnBsTFKjbxwrgGQSXhDMMVIAxRgp9FOgnp3LBsuxtyNXdH33Qy3kDKpkCgmlkgnY0gmlwhKwSVFuKbXVsdGlhZGRyc5YACASsElRbBjVBAAoErBJUWwY1Qt0DgnJzhQADAQAAiXNlY3AyNTZrMaECjUff86AEvH933N2naL5yVzCLG9Xjd1rsUJ7T4OvYicaDdGNwgjVBg3VkcII1Q4V3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.21.33/tcp/39908/p2p/16Uiu2HAmG6e21DLE4JXptXD22JvmigKytq9aEFcYWk2mY5fCbKZ8"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.177.234/tcp/16385/p2p/16Uiu2HAmTSDLGhtVioxS8fadXVUeDHJTcrDiAzVv9aggJwjKL5sV"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39907/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16384/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734322300105226752}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:13632/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734322300113345280}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:13632/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734322300117454592}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:13632/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734322300122554368}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:13632/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734322300126426368}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:13632/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13632/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734322300133310464}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:13632/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d4b5d8036913
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id e1429409ae4d
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d4b5d8036913. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id b05439fcc0b2
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container e1429409ae4d. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.