[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-10-12_04-22-36__b5efeaa8-6902-42dc-a47f-ca0358e1cb76
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-12_04-22-36__b5efeaa8-6902-42dc-a47f-ca0358e1cb76__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.241.186
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['40564', '40565', '40566', '40567', '40568']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 40564:40564 -p 40565:40565 -p 40566:40566 -p 40567:40567 -p 40568:40568 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40566 --rest-port=40564 --tcp-port=40565 --discv5-udp-port=40567 --rest-address=0.0.0.0 --nat=extip:172.18.241.186 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b5f03a1eaadf7d7c448ee6fb9ede52d2a1d5671b9a57f433cfbc40bd85d8c7b6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40568 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.241.186 waku 7d562d0d2dee5da404e0c7af1f7f7cfbe29a72a7c9ea63e440b772581e5ba8ad
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7d562d0d2dee. Setting up logs at ./log/docker/receiving_node1_2024-10-12_04-22-36__b5efeaa8-6902-42dc-a47f-ca0358e1cb76__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 40564
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40564/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40564/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.186/tcp/40565/p2p/16Uiu2HAm6Z9VWWJeZpefpt1jBjnBME5z59EH1FS1378FN39eZEQr","/ip4/172.18.241.186/tcp/40566/ws/p2p/16Uiu2HAm6Z9VWWJeZpefpt1jBjnBME5z59EH1FS1378FN39eZEQr"],"enrUri":"enr:-LO4QGiRY_-_IuJW56dqacUd_MqnSGI4Fu2S9J9ibMRTRo_Cf9rc7xq5excES9sm1hQcnKeEvhmxxUElynrH1fKgba0BgmlkgnY0gmlwhKwS8bqKbXVsdGlhZGRyc4wACgSsEvG6Bp523QOCcnOFAAMBAACJc2VjcDI1NmsxoQKlWrrr1h3tUipkx1r2ILQSfKw8iBrQ9mxl2nobCrNai4N0Y3CCnnWDdWRwgp53hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-12_04-22-36__b5efeaa8-6902-42dc-a47f-ca0358e1cb76__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.84.211
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['44466', '44467', '44468', '44469', '44470']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 44466:44466 -p 44467:44467 -p 44468:44468 -p 44469:44469 -p 44470:44470 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44468 --rest-port=44466 --tcp-port=44467 --discv5-udp-port=44469 --rest-address=0.0.0.0 --nat=extip:172.18.84.211 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4842f5ecfe40f5d603372a5f3ff7be4a3ecb2c7cf9fed18f9e6ce2ea69b25ee3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44470 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.84.211 waku 63e77064b5dd894b10e9dc4ec0b7fbcd12f80076d84b633bc14dde1c91d16f78
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 63e77064b5dd. Setting up logs at ./log/docker/receiving_node2_2024-10-12_04-22-36__b5efeaa8-6902-42dc-a47f-ca0358e1cb76__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 44466
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44466/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44466/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.84.211/tcp/44467/p2p/16Uiu2HAkygNMC26ZN5MBmfWpeY1S8uUvThzLhQZupXEFJ3Z3oNRU","/ip4/172.18.84.211/tcp/44468/ws/p2p/16Uiu2HAkygNMC26ZN5MBmfWpeY1S8uUvThzLhQZupXEFJ3Z3oNRU"],"enrUri":"enr:-LO4QMjVE-qdyCx70bE74UnqaXRlmQOBRDs3YAOfAWRGIA7qPKjoRgI9yViJDt2tM1QsenfET1A5z3zx9BT4WlgSIM8BgmlkgnY0gmlwhKwSVNOKbXVsdGlhZGRyc4wACgSsElTTBq203QOCcnOFAAMBAACJc2VjcDI1NmsxoQI_MoY5dcGgbuEZnqlOxRRI6U9yPk3GoSZ6IkKQoLZJz4N0Y3CCrbODdWRwgq21hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44466/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.186/tcp/40565/p2p/16Uiu2HAm6Z9VWWJeZpefpt1jBjnBME5z59EH1FS1378FN39eZEQr"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-12_04-22-36__b5efeaa8-6902-42dc-a47f-ca0358e1cb76__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.195.200
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['25254', '25255', '25256', '25257', '25258']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 25254:25254 -p 25255:25255 -p 25256:25256 -p 25257:25257 -p 25258:25258 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25256 --rest-port=25254 --tcp-port=25255 --discv5-udp-port=25257 --rest-address=0.0.0.0 --nat=extip:172.18.195.200 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=341018923f78c7d76e4ab9f28df803ea7c95ec1fcb1e5e8ddf0cb3d35e87ccb2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25258 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QGiRY_-_IuJW56dqacUd_MqnSGI4Fu2S9J9ibMRTRo_Cf9rc7xq5excES9sm1hQcnKeEvhmxxUElynrH1fKgba0BgmlkgnY0gmlwhKwS8bqKbXVsdGlhZGRyc4wACgSsEvG6Bp523QOCcnOFAAMBAACJc2VjcDI1NmsxoQKlWrrr1h3tUipkx1r2ILQSfKw8iBrQ9mxl2nobCrNai4N0Y3CCnnWDdWRwgp53hXdha3UyCQ --lightpushnode=/ip4/172.18.241.186/tcp/40565/p2p/16Uiu2HAm6Z9VWWJeZpefpt1jBjnBME5z59EH1FS1378FN39eZEQr --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.195.200 waku 3aa1e907afe9cdaf0798a14a1b3ef2cd954b107509e651246a86273b3d7b7352
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 3aa1e907afe9. Setting up logs at ./log/docker/lightpush_node1_2024-10-12_04-22-36__b5efeaa8-6902-42dc-a47f-ca0358e1cb76__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 25254
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25254/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25254/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.195.200/tcp/25255/p2p/16Uiu2HAkv9taD48HoWs35KQpY3G4RTQWfD45knijhUAV547Cx4jY","/ip4/172.18.195.200/tcp/25256/ws/p2p/16Uiu2HAkv9taD48HoWs35KQpY3G4RTQWfD45knijhUAV547Cx4jY"],"enrUri":"enr:-LO4QPQF-nJVLf4PE17QAOzrC5EhaEJ6NdBMsYrXn5UFEw7gWg8kmEXDUzfLfyT_JMbkJhl3ZUP8sZWZUayXtDRhiTgBgmlkgnY0gmlwhKwSw8iKbXVsdGlhZGRyc4wACgSsEsPIBmKo3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIK0KIizFJp7Aav6Gacz8xJ6AbaMvi5fjFVtlBScWQv14N0Y3CCYqeDdWRwgmKphXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25254/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.186/tcp/40565/p2p/16Uiu2HAm6Z9VWWJeZpefpt1jBjnBME5z59EH1FS1378FN39eZEQr"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25254/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.84.211/tcp/44467/p2p/16Uiu2HAkygNMC26ZN5MBmfWpeY1S8uUvThzLhQZupXEFJ3Z3oNRU"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40564/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44466/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25254/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1728706961724905472}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40564/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1728706961724905472,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.241.186/tcp/40565"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.241.186/tcp/40565"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7d562d0d2dee
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 63e77064b5dd
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3aa1e907afe9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'stacktrace': ['FAT 2024-10-12 04:22:47.292+00:00 Shutting down after receiving SIGSEGV      topics="wakunode main" tid=1 file=wakunode2.nim:124 stacktrace="/app/vendor/nim-chronicles/chronicles.nim(170) _ZN9wakunode213handleSigsegvE5int32\\n"', '/app/vendor/nimbus-build-system/vendor/Nim/lib/system/excpt.nim(526) _ZN6system15writeStackTraceE', '/app/vendor/nimbus-build-system/vendor/Nim/lib/system/excpt.nim(330) _ZN6system18rawWriteStackTraceE3varI6stringE', '/app/vendor/nimbus-build-system/vendor/Nim/lib/system/stacktraces.nim(59) _ZN11stacktraces30auxWriteStackTraceWithOverrideE3varI6stringE']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:114 Found matches for keyword 'SIGSEGV': ['FAT 2024-10-12 04:22:47.292+00:00 Shutting down after receiving SIGSEGV      topics="wakunode main" tid=1 file=wakunode2.nim:124 stacktrace="/app/vendor/nim-chronicles/chronicles.nim(170) _ZN9wakunode213handleSigsegvE5int32\\n"', '/app/apps/wakunode2/wakunode2.nim(127) _ZN9wakunode213handleSigsegvE5int32']
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-10-12_04-22-55__9c06f67e-65d0-496c-8d09-2904055837aa
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-12_04-22-55__9c06f67e-65d0-496c-8d09-2904055837aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.102.84
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['39951', '39952', '39953', '39954', '39955']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 39951:39951 -p 39952:39952 -p 39953:39953 -p 39954:39954 -p 39955:39955 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39953 --rest-port=39951 --tcp-port=39952 --discv5-udp-port=39954 --rest-address=0.0.0.0 --nat=extip:172.18.102.84 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f8e5ea1ce9daffdefadeceb44852814d76d4ecab66aae1bfb7ede4f4d92fd5f9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39955 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.102.84 waku 0d5a0e390e20b7a7aa1683003359c2ae2742111efd196f60cc65439298a075a1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 0d5a0e390e20. Setting up logs at ./log/docker/receiving_node1_2024-10-12_04-22-55__9c06f67e-65d0-496c-8d09-2904055837aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 39951
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39951/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39951/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.102.84/tcp/39952/p2p/16Uiu2HAkwBkFe4KtEEsuWSDs9dN3AHC58Ya5RSyx4KmGC97gZeay","/ip4/172.18.102.84/tcp/39953/ws/p2p/16Uiu2HAkwBkFe4KtEEsuWSDs9dN3AHC58Ya5RSyx4KmGC97gZeay"],"enrUri":"enr:-LO4QJA2yIUSMR39b3vNKP83IN8aI8KG8GDN4y--rW_Gfwn3egC5xLjqK3EF6Ymo86FzzMGhX9hFR0SJ_ObIAHxmGs8BgmlkgnY0gmlwhKwSZlSKbXVsdGlhZGRyc4wACgSsEmZUBpwR3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIaJhMCui7_F_I5a-7ohljZKs5EEps39dBf50kKoxRuloN0Y3CCnBCDdWRwgpwShXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-12_04-22-55__9c06f67e-65d0-496c-8d09-2904055837aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.194.62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['15265', '15266', '15267', '15268', '15269']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 15265:15265 -p 15266:15266 -p 15267:15267 -p 15268:15268 -p 15269:15269 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15267 --rest-port=15265 --tcp-port=15266 --discv5-udp-port=15268 --rest-address=0.0.0.0 --nat=extip:172.18.194.62 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bda2cd5239521ca5acb55ee6f8cfea1e22e6feaa2f3ce7d328ab46bb2386cf5e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15269 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.194.62 waku 750abb99eafb8e63fa63aa5101ac8178757b2bcc307e04dc1497a4caab017795
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 750abb99eafb. Setting up logs at ./log/docker/receiving_node2_2024-10-12_04-22-55__9c06f67e-65d0-496c-8d09-2904055837aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 15265
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15265/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15265/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.194.62/tcp/15266/p2p/16Uiu2HAkwiYJ4iKvG6MNP5rqApNk4vUNyPJT5zqfQXcFRewdPzHM","/ip4/172.18.194.62/tcp/15267/ws/p2p/16Uiu2HAkwiYJ4iKvG6MNP5rqApNk4vUNyPJT5zqfQXcFRewdPzHM"],"enrUri":"enr:-LO4QFn_rqmwpmhJj73J08KtrY83gQTqmDS_rBBROtv2PSKiNNIPmV_HA2x6TRB9tqTVVy6Q1YqpBPLstJxES5zmVeEBgmlkgnY0gmlwhKwSwj6KbXVsdGlhZGRyc4wACgSsEsI-Bjuj3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIiCY7kk04-9xBg2zHXt9e9scoIAN5KQzsPbMdSFZGFaIN0Y3CCO6KDdWRwgjukhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15265/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.102.84/tcp/39952/p2p/16Uiu2HAkwBkFe4KtEEsuWSDs9dN3AHC58Ya5RSyx4KmGC97gZeay"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-12_04-22-55__9c06f67e-65d0-496c-8d09-2904055837aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.10.101
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['19004', '19005', '19006', '19007', '19008']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 19004:19004 -p 19005:19005 -p 19006:19006 -p 19007:19007 -p 19008:19008 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19006 --rest-port=19004 --tcp-port=19005 --discv5-udp-port=19007 --rest-address=0.0.0.0 --nat=extip:172.18.10.101 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4bf8dbce737f8556ebb86df4fa7b65092fad016f3daa2eccfdeea84b8e7d422f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19008 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QJA2yIUSMR39b3vNKP83IN8aI8KG8GDN4y--rW_Gfwn3egC5xLjqK3EF6Ymo86FzzMGhX9hFR0SJ_ObIAHxmGs8BgmlkgnY0gmlwhKwSZlSKbXVsdGlhZGRyc4wACgSsEmZUBpwR3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIaJhMCui7_F_I5a-7ohljZKs5EEps39dBf50kKoxRuloN0Y3CCnBCDdWRwgpwShXdha3UyCQ --lightpushnode=/ip4/172.18.102.84/tcp/39952/p2p/16Uiu2HAkwBkFe4KtEEsuWSDs9dN3AHC58Ya5RSyx4KmGC97gZeay --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.10.101 waku 09ced5e73aa183aac4f5da32d1faf3a46b573c2fca63b09b2f0ede57f0b8310c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 09ced5e73aa1. Setting up logs at ./log/docker/lightpush_node1_2024-10-12_04-22-55__9c06f67e-65d0-496c-8d09-2904055837aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 19004
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19004/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19004/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.10.101/tcp/19005/p2p/16Uiu2HAmCpNwBBJ1ue4eupsww5G9zokh2ff4FsAHXACpsbduVgvA","/ip4/172.18.10.101/tcp/19006/ws/p2p/16Uiu2HAmCpNwBBJ1ue4eupsww5G9zokh2ff4FsAHXACpsbduVgvA"],"enrUri":"enr:-LO4QI96zzqDdxpSzGHddhuTNnKwzSB13bojKM76h89N1bEqX4Bd5ytRBJX4wpKMsvNVV5yjhcQ86o3YUWZbRG5V8CsBgmlkgnY0gmlwhKwSCmWKbXVsdGlhZGRyc4wACgSsEgplBko-3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMCZ8NsZ8VkXHL4VQnI-e4c8nvuat41iADjgrcTD8zdJ4N0Y3CCSj2DdWRwgko_hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19004/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.102.84/tcp/39952/p2p/16Uiu2HAkwBkFe4KtEEsuWSDs9dN3AHC58Ya5RSyx4KmGC97gZeay"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19004/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.194.62/tcp/15266/p2p/16Uiu2HAkwiYJ4iKvG6MNP5rqApNk4vUNyPJT5zqfQXcFRewdPzHM"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39951/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15265/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19004/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1728706981591002368}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39951/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1728706981591002368,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.102.84/tcp/39952"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.102.84/tcp/39952"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 0d5a0e390e20
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 750abb99eafb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 09ced5e73aa1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.