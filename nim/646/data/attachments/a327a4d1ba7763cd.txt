2025-02-10 04:05:57.900 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:05:57.900 DEBUG [tests.conftest] Running test: test_publish_with_payload_less_than_150_kb with id: 2025-02-10_04-05-57__cf5b8189-86b3-47fd-954d-eacb9ee5f2a6
2025-02-10 04:05:57.900 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:05:57.901 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 04:05:57.901 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-10 04:05:57.907 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:05:57.907 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-05-57__cf5b8189-86b3-47fd-954d-eacb9ee5f2a6__wakuorg_nwaku:latest.log
2025-02-10 04:05:57.908 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:05:57.908 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:05:57.909 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:05:57.909 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.139.205
2025-02-10 04:05:57.909 DEBUG [src.node.docker_mananger] Generated ports ['44257', '44258', '44259', '44260', '44261']
2025-02-10 04:05:57.910 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:05:57.910 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:05:57.910 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:05:57.910 DEBUG [src.node.docker_mananger] docker run -i -t -p 44257:44257 -p 44258:44258 -p 44259:44259 -p 44260:44260 -p 44261:44261 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44259 --rest-port=44257 --tcp-port=44258 --discv5-udp-port=44260 --rest-address=0.0.0.0 --nat=extip:172.18.139.205 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e6a1b11bfa0c7f29b42dc6d7aa64ad28eb5e11ad0cd5fe4eebe594ed6c8fccbf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44261 --metrics-logging=true --relay=true
2025-02-10 04:05:58.136 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.139.205 waku 79b3820856a9b62288fdc35ff5596f08284578fa645f6a1a85c4cb97857d41a4
2025-02-10 04:05:58.187 DEBUG [src.node.docker_mananger] Container started with ID 79b3820856a9. Setting up logs at ./log/docker/node1_2025-02-10_04-05-57__cf5b8189-86b3-47fd-954d-eacb9ee5f2a6__wakuorg_nwaku:latest.log
2025-02-10 04:05:58.188 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44257
2025-02-10 04:05:58.189 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:05:58.683 ERROR [src.node.docker_mananger] Max retries reached for container 677eeaf37551. Exiting log stream.
2025-02-10 04:05:59.189 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44257/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:05:59.192 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:05:59.192 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:05:59.193 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44257/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:05:59.195 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.139.205/tcp/44258/p2p/16Uiu2HAkyKxGHqnnkaRHJkX2PFQRvQSz542Rgq7jmgVuuhNYcFh6","/ip4/172.18.139.205/tcp/44259/ws/p2p/16Uiu2HAkyKxGHqnnkaRHJkX2PFQRvQSz542Rgq7jmgVuuhNYcFh6"],"enrUri":"enr:-L24QOopHJYlubXMPx3gyKjGk9psnVuVnrqMWEtjwHpPQWiAQIaIgIlu1nir2CoOW8dVW4N2xj8NQEpBECZfiJZeHtYCgmlkgnY0gmlwhKwSi82KbXVsdGlhZGRyc5YACASsEovNBqziAAoErBKLzQas490DgnJzhQADAQAAiXNlY3AyNTZrMaECOfes_I_nxpRQ7vNsPH9ySOFdvD8S0Q_JGUxZE7o2s5WDdGNwgqzig3VkcIKs5IV3YWt1MgE"}'
2025-02-10 04:05:59.195 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:05:59.201 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:05:59.201 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-05-57__cf5b8189-86b3-47fd-954d-eacb9ee5f2a6__wakuorg_nwaku:latest.log
2025-02-10 04:05:59.202 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:05:59.202 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:05:59.203 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:05:59.203 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.67.25
2025-02-10 04:05:59.203 DEBUG [src.node.docker_mananger] Generated ports ['33819', '33820', '33821', '33822', '33823']
2025-02-10 04:05:59.203 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:05:59.204 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:05:59.204 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:05:59.204 DEBUG [src.node.docker_mananger] docker run -i -t -p 33819:33819 -p 33820:33820 -p 33821:33821 -p 33822:33822 -p 33823:33823 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33821 --rest-port=33819 --tcp-port=33820 --discv5-udp-port=33822 --rest-address=0.0.0.0 --nat=extip:172.18.67.25 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e68cf05cff08c25adceedc4af50b133eee0254de9b6acd5caad231299cada1d5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33823 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOopHJYlubXMPx3gyKjGk9psnVuVnrqMWEtjwHpPQWiAQIaIgIlu1nir2CoOW8dVW4N2xj8NQEpBECZfiJZeHtYCgmlkgnY0gmlwhKwSi82KbXVsdGlhZGRyc5YACASsEovNBqziAAoErBKLzQas490DgnJzhQADAQAAiXNlY3AyNTZrMaECOfes_I_nxpRQ7vNsPH9ySOFdvD8S0Q_JGUxZE7o2s5WDdGNwgqzig3VkcIKs5IV3YWt1MgE
2025-02-10 04:05:59.429 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.67.25 waku 3c575af35a2ef23695098bfe3778cc8ca983795d377335b89b0ba8bfb624a9f8
2025-02-10 04:05:59.478 DEBUG [src.node.docker_mananger] Container started with ID 3c575af35a2e. Setting up logs at ./log/docker/node2_2025-02-10_04-05-57__cf5b8189-86b3-47fd-954d-eacb9ee5f2a6__wakuorg_nwaku:latest.log
2025-02-10 04:05:59.478 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33819
2025-02-10 04:05:59.478 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:06:00.479 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33819/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:00.493 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:06:00.495 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:06:00.495 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33819/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:00.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.67.25/tcp/33820/p2p/16Uiu2HAmHyLADdretMUowvciArDJrSgtQc1uRrYZVstpXLYV6aL5","/ip4/172.18.67.25/tcp/33821/ws/p2p/16Uiu2HAmHyLADdretMUowvciArDJrSgtQc1uRrYZVstpXLYV6aL5"],"enrUri":"enr:-L24QEKZ__M2lqdaRvyKI73RX0b1kJ-z2JBESliQSDv4IMblGfbfFuXtKDv97ARik-862REKskXSbkOKHaV2Tmw5XCACgmlkgnY0gmlwhKwSQxmKbXVsdGlhZGRyc5YACASsEkMZBoQcAAoErBJDGQaEHd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDTv1JlVs33zx1onUzgacIiCxt23bxMFzGnDXpqwKwu56DdGNwgoQcg3VkcIKEHoV3YWt1MgE"}'
2025-02-10 04:06:00.499 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:06:00.500 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33819/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.139.205/tcp/44258/p2p/16Uiu2HAkyKxGHqnnkaRHJkX2PFQRvQSz542Rgq7jmgVuuhNYcFh6"]'
2025-02-10 04:06:00.503 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:00.503 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-10 04:06:00.504 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44257/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:00.507 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:00.508 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33819/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:00.513 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:00.514 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44257/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:00.521 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:00.521 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:06:00.621 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:00.621 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44257/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:00.624 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160360514828288,"ephemeral":false}]'
2025-02-10 04:06:00.625 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:00.625 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33819/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:00.628 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160360514828288,"ephemeral":false}]'
2025-02-10 04:06:00.629 INFO [src.steps.relay] WARM UP successful!!
2025-02-10 04:06:00.630 DEBUG [tests.relay.test_publish] Running test with payload length of 102400 bytes
2025-02-10 04:06:00.632 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-10 04:06:00.650 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:00.650 DEBUG [src.libs.common] Sleeping for 2 seconds
2025-02-10 04:06:02.651 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:02.651 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44257/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:02.655 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-10 04:06:02.657 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:02.657 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33819/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:02.662 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-10 04:06:02.665 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:06:02.666 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:06:02.667 DEBUG [src.node.waku_node] Stopping container with id 79b3820856a9
2025-02-10 04:06:03.694 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:03.694 DEBUG [src.node.waku_node] Stopping container with id 3c575af35a2e
2025-02-10 04:06:04.507 ERROR [src.node.docker_mananger] Max retries reached for container 79b3820856a9. Exiting log stream.
2025-02-10 04:06:05.181 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:05.181 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:06:05.187 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:06:05.193 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
