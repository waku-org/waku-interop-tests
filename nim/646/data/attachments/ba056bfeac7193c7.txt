2025-02-10 04:04:13.252 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:04:13.253 DEBUG [tests.conftest] Running test: test_publish_and_retrieve_duplicate_message with id: 2025-02-10_04-04-13__c1ee6acf-2d9f-48b7-be2f-19780c500179
2025-02-10 04:04:13.253 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:04:13.253 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 04:04:13.253 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-10 04:04:13.259 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:13.259 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-04-13__c1ee6acf-2d9f-48b7-be2f-19780c500179__wakuorg_nwaku:latest.log
2025-02-10 04:04:13.259 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:13.260 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:13.261 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:13.261 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.136.29
2025-02-10 04:04:13.261 DEBUG [src.node.docker_mananger] Generated ports ['50820', '50821', '50822', '50823', '50824']
2025-02-10 04:04:13.261 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:13.261 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:13.261 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:13.262 DEBUG [src.node.docker_mananger] docker run -i -t -p 50820:50820 -p 50821:50821 -p 50822:50822 -p 50823:50823 -p 50824:50824 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50822 --rest-port=50820 --tcp-port=50821 --discv5-udp-port=50823 --rest-address=0.0.0.0 --nat=extip:172.18.136.29 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cbefaea2fedf0eee1fcc394deac0ba9c1e7aac6d9b3b4e0bfecb879dff1994c1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50824 --metrics-logging=true --relay=true
2025-02-10 04:04:13.480 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.136.29 waku 66ff0135f3bb57b88ea65338a1ab5cf50fef5138d84e229be7980c1cf48fca52
2025-02-10 04:04:13.527 DEBUG [src.node.docker_mananger] Container started with ID 66ff0135f3bb. Setting up logs at ./log/docker/node1_2025-02-10_04-04-13__c1ee6acf-2d9f-48b7-be2f-19780c500179__wakuorg_nwaku:latest.log
2025-02-10 04:04:13.528 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50820
2025-02-10 04:04:13.528 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:14.055 ERROR [src.node.docker_mananger] Max retries reached for container 781ae6544911. Exiting log stream.
2025-02-10 04:04:14.528 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50820/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.531 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:14.531 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:14.531 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50820/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.533 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.136.29/tcp/50821/p2p/16Uiu2HAkv2tVyUDt2uZr1VBDowP2nFxSvhbWE1qpB1t2rVZG6Tmx","/ip4/172.18.136.29/tcp/50822/ws/p2p/16Uiu2HAkv2tVyUDt2uZr1VBDowP2nFxSvhbWE1qpB1t2rVZG6Tmx"],"enrUri":"enr:-L24QBuANU2W6iOlcoz_bJu45vHnvAFHbdjXCYPHC9FOQ5IdYAc5hAIBd_bHKLqc3UsNtcMFHv8bdxHT0el3WX78ZHACgmlkgnY0gmlwhKwSiB2KbXVsdGlhZGRyc5YACASsEogdBsaFAAoErBKIHQbGht0DgnJzhQADAQAAiXNlY3AyNTZrMaECCQV8McQnGT0yjmeKFmMp5hkfJUYJXTFPrmRXhOaf2w-DdGNwgsaFg3VkcILGh4V3YWt1MgE"}'
2025-02-10 04:04:14.534 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:14.539 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:14.540 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-04-13__c1ee6acf-2d9f-48b7-be2f-19780c500179__wakuorg_nwaku:latest.log
2025-02-10 04:04:14.540 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:14.540 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:14.541 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:14.541 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.202.154
2025-02-10 04:04:14.541 DEBUG [src.node.docker_mananger] Generated ports ['20277', '20278', '20279', '20280', '20281']
2025-02-10 04:04:14.541 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:14.542 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:14.542 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:14.542 DEBUG [src.node.docker_mananger] docker run -i -t -p 20277:20277 -p 20278:20278 -p 20279:20279 -p 20280:20280 -p 20281:20281 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20279 --rest-port=20277 --tcp-port=20278 --discv5-udp-port=20280 --rest-address=0.0.0.0 --nat=extip:172.18.202.154 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4dca2ecca4b9fd5dcb0dae3aee3398b2bdbffae8ad9168c912fb04e5ebeee1d9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20281 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QBuANU2W6iOlcoz_bJu45vHnvAFHbdjXCYPHC9FOQ5IdYAc5hAIBd_bHKLqc3UsNtcMFHv8bdxHT0el3WX78ZHACgmlkgnY0gmlwhKwSiB2KbXVsdGlhZGRyc5YACASsEogdBsaFAAoErBKIHQbGht0DgnJzhQADAQAAiXNlY3AyNTZrMaECCQV8McQnGT0yjmeKFmMp5hkfJUYJXTFPrmRXhOaf2w-DdGNwgsaFg3VkcILGh4V3YWt1MgE
2025-02-10 04:04:14.758 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.202.154 waku f657b1896dd08072e0e514bee4d46dd1a5cd44c847b4bd88317f58ce66c5c3c1
2025-02-10 04:04:14.805 DEBUG [src.node.docker_mananger] Container started with ID f657b1896dd0. Setting up logs at ./log/docker/node2_2025-02-10_04-04-13__c1ee6acf-2d9f-48b7-be2f-19780c500179__wakuorg_nwaku:latest.log
2025-02-10 04:04:14.806 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20277
2025-02-10 04:04:14.806 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:15.806 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20277/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:15.811 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:15.811 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:15.811 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20277/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:15.817 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.202.154/tcp/20278/p2p/16Uiu2HAm2mnFjYbLGJ3GHs2HoMoLdZSZwmRwsKrtFHBYmgfKkcDZ","/ip4/172.18.202.154/tcp/20279/ws/p2p/16Uiu2HAm2mnFjYbLGJ3GHs2HoMoLdZSZwmRwsKrtFHBYmgfKkcDZ"],"enrUri":"enr:-L24QMGos81UQ3F0O4F8lXlSulH7YUOMchUt4__53VwYgJDIQlvxAj_sh1xC1y4qD-U-nOzPb_TX6DNnD1eRAQRp4BACgmlkgnY0gmlwhKwSypqKbXVsdGlhZGRyc5YACASsEsqaBk82AAoErBLKmgZPN90DgnJzhQADAQAAiXNlY3AyNTZrMaECbSiFB-60y8JOcmk1QcWUTe7n2FQoAH0ePqgMYc2tGRyDdGNwgk82g3VkcIJPOIV3YWt1MgE"}'
2025-02-10 04:04:15.817 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:15.818 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20277/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.136.29/tcp/50821/p2p/16Uiu2HAkv2tVyUDt2uZr1VBDowP2nFxSvhbWE1qpB1t2rVZG6Tmx"]'
2025-02-10 04:04:15.822 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:15.823 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-10 04:04:15.823 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50820/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:04:15.828 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:15.828 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20277/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:04:15.834 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:15.835 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50820/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:15.841 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:15.841 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:15.941 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:15.942 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50820/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:15.944 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160255835546368,"ephemeral":false}]'
2025-02-10 04:04:15.945 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:15.945 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20277/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:15.948 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160255835546368,"ephemeral":false}]'
2025-02-10 04:04:15.949 INFO [src.steps.relay] WARM UP successful!!
2025-02-10 04:04:15.950 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50820/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:15.955 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:15.955 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:16.055 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:16.055 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50820/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:16.058 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160255950287360,"ephemeral":false}]'
2025-02-10 04:04:16.059 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:16.059 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20277/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:16.061 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160255950287360,"ephemeral":false}]'
2025-02-10 04:04:16.063 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50820/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:16.066 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:16.066 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:16.166 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:16.166 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50820/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:16.168 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160255950287360,"ephemeral":false}]'
2025-02-10 04:04:16.170 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:16.170 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20277/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:16.173 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-10 04:04:16.175 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:04:16.176 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:04:16.176 DEBUG [src.node.waku_node] Stopping container with id 66ff0135f3bb
2025-02-10 04:04:16.920 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:16.920 DEBUG [src.node.waku_node] Stopping container with id f657b1896dd0
2025-02-10 04:04:17.731 ERROR [src.node.docker_mananger] Max retries reached for container 66ff0135f3bb. Exiting log stream.
2025-02-10 04:04:18.428 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:18.429 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:04:18.435 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:04:18.440 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
