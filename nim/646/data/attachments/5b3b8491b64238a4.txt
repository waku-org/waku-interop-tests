2025-02-10 04:08:33.924 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:08:33.924 DEBUG [tests.conftest] Running test: test_cant_publish_on_not_subscribed_shard with id: 2025-02-10_04-08-33__0dedfe39-192a-410c-ad7a-5012bbddfeff
2025-02-10 04:08:33.924 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:08:33.924 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 04:08:33.925 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-10 04:08:33.931 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:08:33.932 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-08-33__0dedfe39-192a-410c-ad7a-5012bbddfeff__wakuorg_nwaku:latest.log
2025-02-10 04:08:33.932 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:08:33.932 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:08:33.933 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:08:33.933 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.56.157
2025-02-10 04:08:33.934 DEBUG [src.node.docker_mananger] Generated ports ['11766', '11767', '11768', '11769', '11770']
2025-02-10 04:08:33.934 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2025-02-10 04:08:33.934 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:08:33.934 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:08:33.934 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:08:33.934 DEBUG [src.node.docker_mananger] docker run -i -t -p 11766:11766 -p 11767:11767 -p 11768:11768 -p 11769:11769 -p 11770:11770 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11768 --rest-port=11766 --tcp-port=11767 --discv5-udp-port=11769 --rest-address=0.0.0.0 --nat=extip:172.18.56.157 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ecfce613a73bf0bab728fdddbbfe17b380f4d97d7f8fa3ea0c0302bcff1768d0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11770 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
2025-02-10 04:08:34.156 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.56.157 waku 9879a07fcb8c9fbe0d4574a662a33338fb078ce8ef2909c4a684a2985379e7b6
2025-02-10 04:08:34.206 DEBUG [src.node.docker_mananger] Container started with ID 9879a07fcb8c. Setting up logs at ./log/docker/node1_2025-02-10_04-08-33__0dedfe39-192a-410c-ad7a-5012bbddfeff__wakuorg_nwaku:latest.log
2025-02-10 04:08:34.207 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 11766
2025-02-10 04:08:34.207 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:08:34.716 ERROR [src.node.docker_mananger] Max retries reached for container 110fc4938f17. Exiting log stream.
2025-02-10 04:08:35.209 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11766/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:08:35.212 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:08:35.212 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:08:35.212 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11766/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:08:35.214 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.56.157/tcp/11767/p2p/16Uiu2HAmG7WaAzbEXroV75oicKt4M1trHdGehh97s12cNbYhr3Du","/ip4/172.18.56.157/tcp/11768/ws/p2p/16Uiu2HAmG7WaAzbEXroV75oicKt4M1trHdGehh97s12cNbYhr3Du"],"enrUri":"enr:-L24QC_R46e8nNapfF-e0h3dzpSAfr8nQZjivW1EHqyR-DhCHvHNEjeBjSbpY1-Uu8bAZ6s6OxnA2kClwEqy4C1hhOUCgmlkgnY0gmlwhKwSOJ2KbXVsdGlhZGRyc5YACASsEjidBi33AAoErBI4nQYt-N0DgnJzhQACAQAAiXNlY3AyNTZrMaEDM15VhkoZcP8jC_aMptNheECFzsg8fJWHvk4EX3X2RbyDdGNwgi33g3VkcIIt-YV3YWt1MgU"}'
2025-02-10 04:08:35.215 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:08:35.221 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:08:35.221 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-08-33__0dedfe39-192a-410c-ad7a-5012bbddfeff__wakuorg_nwaku:latest.log
2025-02-10 04:08:35.221 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:08:35.221 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:08:35.223 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:08:35.223 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.110.199
2025-02-10 04:08:35.223 DEBUG [src.node.docker_mananger] Generated ports ['55738', '55739', '55740', '55741', '55742']
2025-02-10 04:08:35.223 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2025-02-10 04:08:35.223 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:08:35.223 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:08:35.224 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:08:35.224 DEBUG [src.node.docker_mananger] docker run -i -t -p 55738:55738 -p 55739:55739 -p 55740:55740 -p 55741:55741 -p 55742:55742 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55740 --rest-port=55738 --tcp-port=55739 --discv5-udp-port=55741 --rest-address=0.0.0.0 --nat=extip:172.18.110.199 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=1c01cd6cedcc02fba77f6bba325164aab8e5aac35f3e5ea076cca8876f2def9e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55742 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QC_R46e8nNapfF-e0h3dzpSAfr8nQZjivW1EHqyR-DhCHvHNEjeBjSbpY1-Uu8bAZ6s6OxnA2kClwEqy4C1hhOUCgmlkgnY0gmlwhKwSOJ2KbXVsdGlhZGRyc5YACASsEjidBi33AAoErBI4nQYt-N0DgnJzhQACAQAAiXNlY3AyNTZrMaEDM15VhkoZcP8jC_aMptNheECFzsg8fJWHvk4EX3X2RbyDdGNwgi33g3VkcIIt-YV3YWt1MgU --pubsub-topic=/waku/2/rs/2/0
2025-02-10 04:08:35.444 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.110.199 waku b6498704102c98e6d2b4e85cce83727f48fc58b3c88786a669778be3b2290619
2025-02-10 04:08:35.492 DEBUG [src.node.docker_mananger] Container started with ID b6498704102c. Setting up logs at ./log/docker/node2_2025-02-10_04-08-33__0dedfe39-192a-410c-ad7a-5012bbddfeff__wakuorg_nwaku:latest.log
2025-02-10 04:08:35.492 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55738
2025-02-10 04:08:35.492 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:08:36.493 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55738/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:08:36.500 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:08:36.500 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:08:36.503 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55738/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:08:36.506 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.110.199/tcp/55739/p2p/16Uiu2HAmTXAMofj1qDHA98Yb135unRS7fNQk62g7rYB493ULT7CX","/ip4/172.18.110.199/tcp/55740/ws/p2p/16Uiu2HAmTXAMofj1qDHA98Yb135unRS7fNQk62g7rYB493ULT7CX"],"enrUri":"enr:-L24QKQtiQScBeM1ej6ShKcN_6L5CJw_Q016nLrMzyE2r8XeA8AB-Kbcd_peukm1riHfcZgvZN0rS9sM-a8Kd7HXI-ICgmlkgnY0gmlwhKwSbseKbXVsdGlhZGRyc5YACASsEm7HBtm7AAoErBJuxwbZvN0DgnJzhQACAQAAiXNlY3AyNTZrMaED3N35eXMdXX7BxWvGgQiLwI_NRZxw96WXjKCjWqNwhRSDdGNwgtm7g3VkcILZvYV3YWt1MgE"}'
2025-02-10 04:08:36.507 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:08:36.508 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55738/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.56.157/tcp/11767/p2p/16Uiu2HAmG7WaAzbEXroV75oicKt4M1trHdGehh97s12cNbYhr3Du"]'
2025-02-10 04:08:36.513 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:08:36.513 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11766/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-10 04:08:36.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:08:36.516 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55738/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-10 04:08:36.518 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:08:36.518 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11766/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:08:36.520 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:11766/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/2/1'
2025-02-10 04:08:36.523 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:08:36.524 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:08:36.524 DEBUG [src.node.waku_node] Stopping container with id 9879a07fcb8c
2025-02-10 04:08:37.682 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:08:37.682 DEBUG [src.node.waku_node] Stopping container with id b6498704102c
2025-02-10 04:08:38.508 ERROR [src.node.docker_mananger] Max retries reached for container 9879a07fcb8c. Exiting log stream.
2025-02-10 04:08:39.179 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:08:39.180 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:08:39.188 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:08:39.193 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
