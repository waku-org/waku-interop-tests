2025-02-10 04:04:11.955 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:04:11.955 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_content_topic_from_same_shard with id: 2025-02-10_04-04-11__b20eb633-c00c-4fab-9b05-9102f4ca7006
2025-02-10 04:04:11.955 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:04:11.955 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 04:04:11.956 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-10 04:04:11.962 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:11.962 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-04-11__b20eb633-c00c-4fab-9b05-9102f4ca7006__wakuorg_nwaku:latest.log
2025-02-10 04:04:11.962 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:11.963 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:11.970 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:11.971 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.25.62
2025-02-10 04:04:11.971 DEBUG [src.node.docker_mananger] Generated ports ['48914', '48915', '48916', '48917', '48918']
2025-02-10 04:04:11.971 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:11.971 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:11.971 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:11.971 DEBUG [src.node.docker_mananger] docker run -i -t -p 48914:48914 -p 48915:48915 -p 48916:48916 -p 48917:48917 -p 48918:48918 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48916 --rest-port=48914 --tcp-port=48915 --discv5-udp-port=48917 --rest-address=0.0.0.0 --nat=extip:172.18.25.62 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=f1eccccbba6c42ce0bdddeaa04dcd15e8e65619e6cf27c66dddcccb734afcc4a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48918 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-10 04:04:12.194 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.25.62 waku b5d3c85061036597cfd5455302485b6d31f9b09c1814a68901258fe0b234761e
2025-02-10 04:04:12.242 DEBUG [src.node.docker_mananger] Container started with ID b5d3c8506103. Setting up logs at ./log/docker/node1_2025-02-10_04-04-11__b20eb633-c00c-4fab-9b05-9102f4ca7006__wakuorg_nwaku:latest.log
2025-02-10 04:04:12.243 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48914
2025-02-10 04:04:12.243 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:12.747 ERROR [src.node.docker_mananger] Max retries reached for container 9af3cb59a973. Exiting log stream.
2025-02-10 04:04:13.244 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48914/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:13.247 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:13.247 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:13.247 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48914/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:13.249 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.25.62/tcp/48915/p2p/16Uiu2HAmCxS65p7yHzwZBV1GA4cwfVmBpNzBJi2vRWEmjL2j2mjB","/ip4/172.18.25.62/tcp/48916/ws/p2p/16Uiu2HAmCxS65p7yHzwZBV1GA4cwfVmBpNzBJi2vRWEmjL2j2mjB"],"enrUri":"enr:-L24QIeAM2lI6cZidosN_7h7cF0zml5dJR5P5Vw05T-pb6YXC9L5T_YojFnxu2dYB02I0ZhFj8GTjGENHxkkwTRttL8CgmlkgnY0gmlwhKwSGT6KbXVsdGlhZGRyc5YACASsEhk-Br8TAAoErBIZPga_FN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDBHf5wWGNWNRUUdWkWPRuFmrGUcmQT4Cq6jnIXwR3keaDdGNwgr8Tg3VkcIK_FYV3YWt1MgU"}'
2025-02-10 04:04:13.249 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:13.256 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:13.256 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-04-11__b20eb633-c00c-4fab-9b05-9102f4ca7006__wakuorg_nwaku:latest.log
2025-02-10 04:04:13.256 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:13.256 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:13.257 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:13.258 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.132.90
2025-02-10 04:04:13.258 DEBUG [src.node.docker_mananger] Generated ports ['29248', '29249', '29250', '29251', '29252']
2025-02-10 04:04:13.258 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:13.258 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:13.258 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:13.258 DEBUG [src.node.docker_mananger] docker run -i -t -p 29248:29248 -p 29249:29249 -p 29250:29250 -p 29251:29251 -p 29252:29252 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29250 --rest-port=29248 --tcp-port=29249 --discv5-udp-port=29251 --rest-address=0.0.0.0 --nat=extip:172.18.132.90 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=9f85d4a30ebf4721a04ef7e4b4cec0ac741eb350e53db1bbdc23acaec746bbc8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29252 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QIeAM2lI6cZidosN_7h7cF0zml5dJR5P5Vw05T-pb6YXC9L5T_YojFnxu2dYB02I0ZhFj8GTjGENHxkkwTRttL8CgmlkgnY0gmlwhKwSGT6KbXVsdGlhZGRyc5YACASsEhk-Br8TAAoErBIZPga_FN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDBHf5wWGNWNRUUdWkWPRuFmrGUcmQT4Cq6jnIXwR3keaDdGNwgr8Tg3VkcIK_FYV3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-10 04:04:13.486 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.132.90 waku cac487b3401445de2cbdc01644d50a4312d19d6478934b76cbadbab7eba75bda
2025-02-10 04:04:13.534 DEBUG [src.node.docker_mananger] Container started with ID cac487b34014. Setting up logs at ./log/docker/node2_2025-02-10_04-04-11__b20eb633-c00c-4fab-9b05-9102f4ca7006__wakuorg_nwaku:latest.log
2025-02-10 04:04:13.535 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29248
2025-02-10 04:04:13.535 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:14.535 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29248/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.545 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:14.546 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:14.546 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29248/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.554 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.132.90/tcp/29249/p2p/16Uiu2HAmTerfAZinjYnd2M8VHVuSTfrNRFF9BFyRUbL49cy2pcRE","/ip4/172.18.132.90/tcp/29250/ws/p2p/16Uiu2HAmTerfAZinjYnd2M8VHVuSTfrNRFF9BFyRUbL49cy2pcRE"],"enrUri":"enr:-L24QDdxxdk1PvZcylX48b01iKSJFM5HvOv1Rx0NVjxu8ZilJCSu8Cw0Hxb-Z2mD-CW5tVGnoc6GKqXFg2DrezGZhhoCgmlkgnY0gmlwhKwShFqKbXVsdGlhZGRyc5YACASsEoRaBnJBAAoErBKEWgZyQt0DgnJzhQACAQAAiXNlY3AyNTZrMaED3tabVDpajKxIxYUShyt1IJl8nWpHSesz1AthofL1ppGDdGNwgnJBg3VkcIJyQ4V3YWt1MgE"}'
2025-02-10 04:04:14.554 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:14.555 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29248/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.25.62/tcp/48915/p2p/16Uiu2HAmCxS65p7yHzwZBV1GA4cwfVmBpNzBJi2vRWEmjL2j2mjB"]'
2025-02-10 04:04:14.559 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:14.560 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48914/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2025-02-10 04:04:14.565 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:14.566 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29248/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2025-02-10 04:04:14.571 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:14.572 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48914/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/newsService/1.0/weekly/protobuf", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:14.579 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:14.579 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:14.680 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:14.680 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48914/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.682 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1739160254572702464,"ephemeral":false}]'
2025-02-10 04:04:14.684 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:14.684 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29248/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.686 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1739160254572702464,"ephemeral":false}]'
2025-02-10 04:04:14.688 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48914/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:14.692 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:14.693 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:14.794 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:14.794 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48914/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.796 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739160254688343296,"ephemeral":false}]'
2025-02-10 04:04:14.798 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:14.798 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29248/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:14.800 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739160254688343296,"ephemeral":false}]'
2025-02-10 04:04:14.803 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:04:14.804 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:04:14.804 DEBUG [src.node.waku_node] Stopping container with id b5d3c8506103
2025-02-10 04:04:15.702 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:15.702 DEBUG [src.node.waku_node] Stopping container with id cac487b34014
2025-02-10 04:04:16.516 ERROR [src.node.docker_mananger] Max retries reached for container b5d3c8506103. Exiting log stream.
2025-02-10 04:04:17.194 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:17.195 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:04:17.200 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:04:17.206 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
