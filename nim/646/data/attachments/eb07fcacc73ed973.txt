2025-02-10 04:04:44.710 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:04:44.710 DEBUG [tests.conftest] Running test: test_filter_subscribe_refresh with id: 2025-02-10_04-04-44__8cf35804-2183-42e3-bdda-5311b0f4aa52
2025-02-10 04:04:44.710 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:04:44.711 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-10 04:04:44.711 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-10 04:04:44.717 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:44.717 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-04-44__8cf35804-2183-42e3-bdda-5311b0f4aa52__wakuorg_nwaku:latest.log
2025-02-10 04:04:44.718 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:44.718 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:44.719 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:44.719 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.147.44
2025-02-10 04:04:44.719 DEBUG [src.node.docker_mananger] Generated ports ['31533', '31534', '31535', '31536', '31537']
2025-02-10 04:04:44.720 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:44.720 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:44.720 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:44.720 DEBUG [src.node.docker_mananger] docker run -i -t -p 31533:31533 -p 31534:31534 -p 31535:31535 -p 31536:31536 -p 31537:31537 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31535 --rest-port=31533 --tcp-port=31534 --discv5-udp-port=31536 --rest-address=0.0.0.0 --nat=extip:172.18.147.44 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=45f79e84eceb1e6993f0ced8bf6fd580dc727ca5ab8eaa4eaf80a1adc2d4c24e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31537 --metrics-logging=true --relay=true --filter=true
2025-02-10 04:04:44.949 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.147.44 waku d2a75aa242862f25fa32b3bb82d0bac8b6e0e7b8cec9831eae0a53ba43f74776
2025-02-10 04:04:44.999 DEBUG [src.node.docker_mananger] Container started with ID d2a75aa24286. Setting up logs at ./log/docker/node1_2025-02-10_04-04-44__8cf35804-2183-42e3-bdda-5311b0f4aa52__wakuorg_nwaku:latest.log
2025-02-10 04:04:45.000 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31533
2025-02-10 04:04:45.000 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:45.513 ERROR [src.node.docker_mananger] Max retries reached for container 28c3f4613135. Exiting log stream.
2025-02-10 04:04:46.001 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31533/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:46.004 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:46.004 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:46.004 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31533/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:46.006 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.147.44/tcp/31534/p2p/16Uiu2HAmQrXmPLMGytL6TLVBrWQu3Apcgw6oGaX8igCcFzDghTod","/ip4/172.18.147.44/tcp/31535/ws/p2p/16Uiu2HAmQrXmPLMGytL6TLVBrWQu3Apcgw6oGaX8igCcFzDghTod"],"enrUri":"enr:-L24QK0T4wQhbk20Gokuw8UrV7ze-8pXOBQ9MPUkdQTvZJHncTRsYuDlydV196VStBAb-hW235fNXSuMnm2BhOvZv7ACgmlkgnY0gmlwhKwSkyyKbXVsdGlhZGRyc5YACASsEpMsBnsuAAoErBKTLAZ7L90DgnJzhQADAQAAiXNlY3AyNTZrMaEDtUEnUM28ONNK3kiwzOPEk5BlkHry94ml_fn8_bxrw6iDdGNwgnsug3VkcIJ7MIV3YWt1MgU"}'
2025-02-10 04:04:46.007 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:46.007 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-10 04:04:46.013 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:46.013 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-04-44__8cf35804-2183-42e3-bdda-5311b0f4aa52__wakuorg_nwaku:latest.log
2025-02-10 04:04:46.013 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:46.014 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:46.015 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:46.015 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.119.143
2025-02-10 04:04:46.015 DEBUG [src.node.docker_mananger] Generated ports ['53538', '53539', '53540', '53541', '53542']
2025-02-10 04:04:46.016 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:46.016 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:46.016 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:46.016 DEBUG [src.node.docker_mananger] docker run -i -t -p 53538:53538 -p 53539:53539 -p 53540:53540 -p 53541:53541 -p 53542:53542 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53540 --rest-port=53538 --tcp-port=53539 --discv5-udp-port=53541 --rest-address=0.0.0.0 --nat=extip:172.18.119.143 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d2034d025dfda5b2739e01dcbfbac4c5f1a1ca47e77eadd8ec86abb75cee5da0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53542 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QK0T4wQhbk20Gokuw8UrV7ze-8pXOBQ9MPUkdQTvZJHncTRsYuDlydV196VStBAb-hW235fNXSuMnm2BhOvZv7ACgmlkgnY0gmlwhKwSkyyKbXVsdGlhZGRyc5YACASsEpMsBnsuAAoErBKTLAZ7L90DgnJzhQADAQAAiXNlY3AyNTZrMaEDtUEnUM28ONNK3kiwzOPEk5BlkHry94ml_fn8_bxrw6iDdGNwgnsug3VkcIJ7MIV3YWt1MgU --filternode=/ip4/172.18.147.44/tcp/31534/p2p/16Uiu2HAmQrXmPLMGytL6TLVBrWQu3Apcgw6oGaX8igCcFzDghTod
2025-02-10 04:04:46.256 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.119.143 waku 993a03dff28e6a83da05ef37740e0e4c0358b48b0b46663a2ec0c47510498477
2025-02-10 04:04:46.308 DEBUG [src.node.docker_mananger] Container started with ID 993a03dff28e. Setting up logs at ./log/docker/node2_2025-02-10_04-04-44__8cf35804-2183-42e3-bdda-5311b0f4aa52__wakuorg_nwaku:latest.log
2025-02-10 04:04:46.309 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53538
2025-02-10 04:04:46.309 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:47.309 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53538/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:47.312 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:47.312 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:47.313 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53538/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:47.315 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.119.143/tcp/53539/p2p/16Uiu2HAm7MwbC6dGcPcUFNjVN38jtBYWWzrWhwySGEhSRP3sahuk","/ip4/172.18.119.143/tcp/53540/ws/p2p/16Uiu2HAm7MwbC6dGcPcUFNjVN38jtBYWWzrWhwySGEhSRP3sahuk"],"enrUri":"enr:-L24QGqhkt59Xf04nrTZ8T8MY-x5KIf615TaBhOdyglXR5W3WhdjQreRzDx29cs3X3w1rrAuVrNJYyOZVr7sAeMwmWQCgmlkgnY0gmlwhKwSd4-KbXVsdGlhZGRyc5YACASsEnePBtEjAAoErBJ3jwbRJN0DgnJzhQADAQAAiXNlY3AyNTZrMaECsVeSDgNjWDu1PQrbAtASEwxi6bP5MupLWEQgTDLXW5uDdGNwgtEjg3VkcILRJYV3YWt1MgA"}'
2025-02-10 04:04:47.315 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:47.316 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53538/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.147.44/tcp/31534/p2p/16Uiu2HAmQrXmPLMGytL6TLVBrWQu3Apcgw6oGaX8igCcFzDghTod"]'
2025-02-10 04:04:47.352 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:47.355 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31533/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:04:47.373 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:47.375 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53538/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ffb3309f-4c01-4830-bd5a-40db60147510", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-10 04:04:47.386 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"ffb3309f-4c01-4830-bd5a-40db60147510","statusDesc":"OK"}'
2025-02-10 04:04:47.387 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31533/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:47.394 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:47.394 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:47.494 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:47.495 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53538/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:47.498 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739160287387308032,"ephemeral":false}]'
2025-02-10 04:04:47.500 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31533/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:04:47.502 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:47.503 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53538/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "9322ee5a-1401-44ae-8f1a-76098b3e3c60", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-10 04:04:47.514 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"9322ee5a-1401-44ae-8f1a-76098b3e3c60","statusDesc":"OK"}'
2025-02-10 04:04:47.515 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31533/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:47.519 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:47.519 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:47.619 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:47.620 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53538/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:47.623 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739160287515313408,"ephemeral":false}]'
2025-02-10 04:04:47.626 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:04:47.626 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:04:47.627 DEBUG [src.node.waku_node] Stopping container with id d2a75aa24286
2025-02-10 04:04:48.447 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:48.448 DEBUG [src.node.waku_node] Stopping container with id 993a03dff28e
2025-02-10 04:04:49.261 ERROR [src.node.docker_mananger] Max retries reached for container d2a75aa24286. Exiting log stream.
2025-02-10 04:04:49.945 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:49.946 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:04:49.952 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:04:49.956 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
