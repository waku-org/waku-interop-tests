2025-02-10 04:04:44.111 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:04:44.111 DEBUG [tests.conftest] Running test: test_filter_update_subscription_add_a_new_pubsub_topic with id: 2025-02-10_04-04-44__4a37efe3-c7b2-4358-aa21-5aa867c8e2fd
2025-02-10 04:04:44.112 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:04:44.112 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-10 04:04:44.112 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-10 04:04:44.118 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:44.118 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-04-44__4a37efe3-c7b2-4358-aa21-5aa867c8e2fd__wakuorg_nwaku:latest.log
2025-02-10 04:04:44.119 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:44.119 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:44.120 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:44.120 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.250.77
2025-02-10 04:04:44.120 DEBUG [src.node.docker_mananger] Generated ports ['40062', '40063', '40064', '40065', '40066']
2025-02-10 04:04:44.121 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:44.121 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:44.121 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:44.121 DEBUG [src.node.docker_mananger] docker run -i -t -p 40062:40062 -p 40063:40063 -p 40064:40064 -p 40065:40065 -p 40066:40066 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40064 --rest-port=40062 --tcp-port=40063 --discv5-udp-port=40065 --rest-address=0.0.0.0 --nat=extip:172.18.250.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1468f8abd4c3078f92cecac788ed55ecee65ece4e93a6bfd9ed4204bd310c021 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40066 --metrics-logging=true --relay=true --filter=true
2025-02-10 04:04:44.352 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.250.77 waku 5d4fb4fc677b7a082b39dc7a53da60778b40583213e31960fb1581e1c1dcc357
2025-02-10 04:04:44.403 DEBUG [src.node.docker_mananger] Container started with ID 5d4fb4fc677b. Setting up logs at ./log/docker/node1_2025-02-10_04-04-44__4a37efe3-c7b2-4358-aa21-5aa867c8e2fd__wakuorg_nwaku:latest.log
2025-02-10 04:04:44.403 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40062
2025-02-10 04:04:44.403 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:44.913 ERROR [src.node.docker_mananger] Max retries reached for container a73af189feb0. Exiting log stream.
2025-02-10 04:04:45.404 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40062/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:45.407 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:45.407 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:45.408 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40062/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:45.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.250.77/tcp/40063/p2p/16Uiu2HAmA34ED6xPY8HeAHKgj6FetxLnQuUpGQ8PFx9FmEueK5mq","/ip4/172.18.250.77/tcp/40064/ws/p2p/16Uiu2HAmA34ED6xPY8HeAHKgj6FetxLnQuUpGQ8PFx9FmEueK5mq"],"enrUri":"enr:-L24QNo17jUlSG5kpW2stkmFkgh5DzxzjYisQZ-edkbh-6j_SCLeFoiyNyboV5jC8lgHnEgEatgCDCrJas85WiRQeVECgmlkgnY0gmlwhKwS-k2KbXVsdGlhZGRyc5YACASsEvpNBpx_AAoErBL6TQacgN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC2RQaD8vh-R0UVDWdKzIKPoc4Z-Z_DOtJeM2nSKuxBpiDdGNwgpx_g3VkcIKcgYV3YWt1MgU"}'
2025-02-10 04:04:45.410 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:45.411 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-10 04:04:45.417 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:45.418 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-04-44__4a37efe3-c7b2-4358-aa21-5aa867c8e2fd__wakuorg_nwaku:latest.log
2025-02-10 04:04:45.418 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:45.418 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:45.419 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:45.420 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.168.188
2025-02-10 04:04:45.420 DEBUG [src.node.docker_mananger] Generated ports ['57560', '57561', '57562', '57563', '57564']
2025-02-10 04:04:45.420 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:45.420 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:45.420 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:45.420 DEBUG [src.node.docker_mananger] docker run -i -t -p 57560:57560 -p 57561:57561 -p 57562:57562 -p 57563:57563 -p 57564:57564 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57562 --rest-port=57560 --tcp-port=57561 --discv5-udp-port=57563 --rest-address=0.0.0.0 --nat=extip:172.18.168.188 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7784f5a2590dd52c64ebe9afcbbae34869fffe163599c2bdc41b9ddd2fd303d9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57564 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QNo17jUlSG5kpW2stkmFkgh5DzxzjYisQZ-edkbh-6j_SCLeFoiyNyboV5jC8lgHnEgEatgCDCrJas85WiRQeVECgmlkgnY0gmlwhKwS-k2KbXVsdGlhZGRyc5YACASsEvpNBpx_AAoErBL6TQacgN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC2RQaD8vh-R0UVDWdKzIKPoc4Z-Z_DOtJeM2nSKuxBpiDdGNwgpx_g3VkcIKcgYV3YWt1MgU --filternode=/ip4/172.18.250.77/tcp/40063/p2p/16Uiu2HAmA34ED6xPY8HeAHKgj6FetxLnQuUpGQ8PFx9FmEueK5mq
2025-02-10 04:04:45.648 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.168.188 waku 262d7e1fa6cd425b328be674e0aef8a342a761a34e04d1e316562ac9b255d83a
2025-02-10 04:04:45.697 DEBUG [src.node.docker_mananger] Container started with ID 262d7e1fa6cd. Setting up logs at ./log/docker/node2_2025-02-10_04-04-44__4a37efe3-c7b2-4358-aa21-5aa867c8e2fd__wakuorg_nwaku:latest.log
2025-02-10 04:04:45.698 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57560
2025-02-10 04:04:45.698 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:46.698 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57560/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:46.701 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:46.701 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:46.702 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57560/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:46.704 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.168.188/tcp/57561/p2p/16Uiu2HAmJPZqNHg7PybwRvzDnkZyQ6ta4E5uEfwEzyHLCz4bawcZ","/ip4/172.18.168.188/tcp/57562/ws/p2p/16Uiu2HAmJPZqNHg7PybwRvzDnkZyQ6ta4E5uEfwEzyHLCz4bawcZ"],"enrUri":"enr:-L24QJepvx9TJpETVIp2WKyMifTz8Y0-_5-JFqdqRGIi8oDjJTeCAh9_jXJstZhtXkfZwGOCWuokYsycuZ5zKLBWuhsCgmlkgnY0gmlwhKwSqLyKbXVsdGlhZGRyc5YACASsEqi8BuDZAAoErBKovAbg2t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDVTKwb_uXgw501qP4NuG0U90YjGCgNktWmT9KV8xGbI6DdGNwguDZg3VkcILg24V3YWt1MgA"}'
2025-02-10 04:04:46.704 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:46.704 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57560/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.250.77/tcp/40063/p2p/16Uiu2HAmA34ED6xPY8HeAHKgj6FetxLnQuUpGQ8PFx9FmEueK5mq"]'
2025-02-10 04:04:46.740 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:46.744 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40062/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:04:46.760 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:46.762 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57560/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "bc3846f8-151f-4233-8db8-998b0380dbc8", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-10 04:04:46.774 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"bc3846f8-151f-4233-8db8-998b0380dbc8","statusDesc":"OK"}'
2025-02-10 04:04:46.774 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:57560/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto", "/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1000"}'
2025-02-10 04:04:46.782 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-10 04:04:46.782 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40062/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1000"]'
2025-02-10 04:04:46.785 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:46.786 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40062/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:46.793 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:46.794 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:46.894 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:46.895 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57560/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:46.897 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739160286785946880,"ephemeral":false}]'
2025-02-10 04:04:46.899 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40062/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:46.904 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:46.904 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:47.004 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:47.005 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57560/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:47.007 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739160286899408896,"ephemeral":false}]'
2025-02-10 04:04:47.009 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40062/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:47.014 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:47.014 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:47.114 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:47.115 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57560/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:47.117 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1739160287009276928,"ephemeral":false}]'
2025-02-10 04:04:47.120 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:04:47.121 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:04:47.121 DEBUG [src.node.waku_node] Stopping container with id 5d4fb4fc677b
2025-02-10 04:04:47.983 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:47.984 DEBUG [src.node.waku_node] Stopping container with id 262d7e1fa6cd
2025-02-10 04:04:48.796 ERROR [src.node.docker_mananger] Max retries reached for container 5d4fb4fc677b. Exiting log stream.
2025-02-10 04:04:49.484 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:49.486 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:04:49.491 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:04:49.495 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
