2025-02-10 04:06:48.707 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:06:48.707 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-10_04-06-48__1c344ae6-e506-41b2-b531-38efbee59e05
2025-02-10 04:06:48.708 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:06:48.708 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 04:06:48.708 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-10 04:06:48.714 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:06:48.714 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-06-48__1c344ae6-e506-41b2-b531-38efbee59e05__wakuorg_nwaku:latest.log
2025-02-10 04:06:48.715 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:06:48.715 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:06:48.716 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:06:48.716 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.119.237
2025-02-10 04:06:48.716 DEBUG [src.node.docker_mananger] Generated ports ['50333', '50334', '50335', '50336', '50337']
2025-02-10 04:06:48.717 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:06:48.717 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:06:48.717 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:06:48.717 DEBUG [src.node.docker_mananger] docker run -i -t -p 50333:50333 -p 50334:50334 -p 50335:50335 -p 50336:50336 -p 50337:50337 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50335 --rest-port=50333 --tcp-port=50334 --discv5-udp-port=50336 --rest-address=0.0.0.0 --nat=extip:172.18.119.237 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c5e6e37432eccffa27bbeaa1cbfefd24fddd3b95a7bab0c148cb6fa5de338f3a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50337 --metrics-logging=true --relay=true
2025-02-10 04:06:48.956 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.119.237 waku e0576c4209718831f634f7d393c9bb9ef30a2026e6534c8824bfdff090bca676
2025-02-10 04:06:49.005 DEBUG [src.node.docker_mananger] Container started with ID e0576c420971. Setting up logs at ./log/docker/node1_2025-02-10_04-06-48__1c344ae6-e506-41b2-b531-38efbee59e05__wakuorg_nwaku:latest.log
2025-02-10 04:06:49.006 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50333
2025-02-10 04:06:49.006 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:06:49.499 ERROR [src.node.docker_mananger] Max retries reached for container f58f5bd9f781. Exiting log stream.
2025-02-10 04:06:50.007 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50333/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:50.010 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:06:50.010 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:06:50.010 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50333/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:50.012 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.119.237/tcp/50334/p2p/16Uiu2HAmVPrmT5yn17YncvwLdDu66XgwF6qWYXojsiMT6eXpofqc","/ip4/172.18.119.237/tcp/50335/ws/p2p/16Uiu2HAmVPrmT5yn17YncvwLdDu66XgwF6qWYXojsiMT6eXpofqc"],"enrUri":"enr:-L24QHYeS-FuAFiFgWAEz-M0j6cNTkSeFCRT5k9VqfAjR2jvPrujYr7KOBdZhe89q7c60A8Gyii9Du4G9nMMq892jRcCgmlkgnY0gmlwhKwSd-2KbXVsdGlhZGRyc5YACASsEnftBsSeAAoErBJ37QbEn90DgnJzhQADAQAAiXNlY3AyNTZrMaED-LZkGCBO1VERKj_-qcXk1X7ixBU6ey_ll7w9NwwsMfuDdGNwgsSeg3VkcILEoIV3YWt1MgE"}'
2025-02-10 04:06:50.012 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:06:50.019 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:06:50.019 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-06-48__1c344ae6-e506-41b2-b531-38efbee59e05__wakuorg_nwaku:latest.log
2025-02-10 04:06:50.019 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:06:50.019 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:06:50.021 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:06:50.021 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.223.113
2025-02-10 04:06:50.021 DEBUG [src.node.docker_mananger] Generated ports ['34854', '34855', '34856', '34857', '34858']
2025-02-10 04:06:50.021 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:06:50.021 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:06:50.021 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:06:50.022 DEBUG [src.node.docker_mananger] docker run -i -t -p 34854:34854 -p 34855:34855 -p 34856:34856 -p 34857:34857 -p 34858:34858 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34856 --rest-port=34854 --tcp-port=34855 --discv5-udp-port=34857 --rest-address=0.0.0.0 --nat=extip:172.18.223.113 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=870f4e53f26bcada37eedab2a91dafac59dfd07da2d747dbf64ffc329dffcd56 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34858 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QHYeS-FuAFiFgWAEz-M0j6cNTkSeFCRT5k9VqfAjR2jvPrujYr7KOBdZhe89q7c60A8Gyii9Du4G9nMMq892jRcCgmlkgnY0gmlwhKwSd-2KbXVsdGlhZGRyc5YACASsEnftBsSeAAoErBJ37QbEn90DgnJzhQADAQAAiXNlY3AyNTZrMaED-LZkGCBO1VERKj_-qcXk1X7ixBU6ey_ll7w9NwwsMfuDdGNwgsSeg3VkcILEoIV3YWt1MgE
2025-02-10 04:06:50.246 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.223.113 waku 5fac671624e4c1e30d1659cc09cb25d1fdd97b770aba7a5769e3d3c509430c04
2025-02-10 04:06:50.297 DEBUG [src.node.docker_mananger] Container started with ID 5fac671624e4. Setting up logs at ./log/docker/node2_2025-02-10_04-06-48__1c344ae6-e506-41b2-b531-38efbee59e05__wakuorg_nwaku:latest.log
2025-02-10 04:06:50.298 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 34854
2025-02-10 04:06:50.298 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:06:51.298 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34854/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:51.306 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:06:51.307 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:06:51.308 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34854/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:51.310 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.223.113/tcp/34855/p2p/16Uiu2HAm3CT8NacoTQjhcVXTdHi7zYzxjd3S9jNPuAsZABCdf4e6","/ip4/172.18.223.113/tcp/34856/ws/p2p/16Uiu2HAm3CT8NacoTQjhcVXTdHi7zYzxjd3S9jNPuAsZABCdf4e6"],"enrUri":"enr:-L24QJbu5tMe1gzjl-gUtB2tN1D5brj_PK-Jpvn1sgMI2nwfU2qexObC_cTOxisYhbIE71I2iJ7InTp6rJQ9ufzxdBcCgmlkgnY0gmlwhKwS33GKbXVsdGlhZGRyc5YACASsEt9xBognAAoErBLfcQaIKN0DgnJzhQADAQAAiXNlY3AyNTZrMaECc3ppulkA6mFXcn7bA-KxhRIO_6i9jFz2FGK63nEuSuODdGNwgogng3VkcIKIKYV3YWt1MgE"}'
2025-02-10 04:06:51.311 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:06:51.311 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34854/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.119.237/tcp/50334/p2p/16Uiu2HAmVPrmT5yn17YncvwLdDu66XgwF6qWYXojsiMT6eXpofqc"]'
2025-02-10 04:06:51.314 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:51.314 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-10 04:06:51.314 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:51.318 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:51.318 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34854/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:51.323 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:51.324 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.330 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:51.331 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:06:51.432 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:51.432 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:51.435 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160411324775168,"ephemeral":false}]'
2025-02-10 04:06:51.436 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:51.436 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34854/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:51.439 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160411324775168,"ephemeral":false}]'
2025-02-10 04:06:51.440 INFO [src.steps.relay] WARM UP successful!!
2025-02-10 04:06:51.441 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-10 04:06:51.441 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.443 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-10 04:06:51.444 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-10 04:06:51.445 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.447 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-10 04:06:51.447 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-10 04:06:51.448 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.450 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-10 04:06:51.451 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-10 04:06:51.451 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.453 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-10 04:06:51.454 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-10 04:06:51.454 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.457 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-10 04:06:51.457 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-10 04:06:51.458 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.460 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-10 04:06:51.460 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-10 04:06:51.461 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:51.463 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:50333/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-10 04:06:51.465 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:06:51.466 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:06:51.466 DEBUG [src.node.waku_node] Stopping container with id e0576c420971
2025-02-10 04:06:52.503 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:52.503 DEBUG [src.node.waku_node] Stopping container with id 5fac671624e4
2025-02-10 04:06:53.317 ERROR [src.node.docker_mananger] Max retries reached for container e0576c420971. Exiting log stream.
2025-02-10 04:06:54.007 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:54.008 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:06:54.013 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:06:54.018 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
