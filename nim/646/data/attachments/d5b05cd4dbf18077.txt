2025-02-10 04:06:02.041 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:06:02.042 DEBUG [tests.conftest] Running test: test_publish_while_peer_is_paused with id: 2025-02-10_04-06-02__2e94d107-15a7-41aa-bf7f-ea53933ed963
2025-02-10 04:06:02.043 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:06:02.044 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 04:06:02.044 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-10 04:06:02.051 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:06:02.051 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-06-02__2e94d107-15a7-41aa-bf7f-ea53933ed963__wakuorg_nwaku:latest.log
2025-02-10 04:06:02.052 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:06:02.052 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:06:02.054 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:06:02.055 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.241.169
2025-02-10 04:06:02.055 DEBUG [src.node.docker_mananger] Generated ports ['37974', '37975', '37976', '37977', '37978']
2025-02-10 04:06:02.055 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:06:02.055 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:06:02.056 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:06:02.058 DEBUG [src.node.docker_mananger] docker run -i -t -p 37974:37974 -p 37975:37975 -p 37976:37976 -p 37977:37977 -p 37978:37978 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37976 --rest-port=37974 --tcp-port=37975 --discv5-udp-port=37977 --rest-address=0.0.0.0 --nat=extip:172.18.241.169 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eebf13b57adecaf8eca423b0a641dacfff1acbaf3d6c3ebdba2fddbc6c9c5dcb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37978 --metrics-logging=true --relay=true
2025-02-10 04:06:02.292 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.241.169 waku a61c68df266cc6a1335081cb989df7dbb4b257a91d415d5f36b47a97c4bbd2a6
2025-02-10 04:06:02.342 DEBUG [src.node.docker_mananger] Container started with ID a61c68df266c. Setting up logs at ./log/docker/node1_2025-02-10_04-06-02__2e94d107-15a7-41aa-bf7f-ea53933ed963__wakuorg_nwaku:latest.log
2025-02-10 04:06:02.343 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 37974
2025-02-10 04:06:02.343 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:06:02.869 ERROR [src.node.docker_mananger] Max retries reached for container 83f674b11d74. Exiting log stream.
2025-02-10 04:06:03.345 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37974/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:03.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:06:03.348 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:06:03.348 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37974/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:03.350 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.169/tcp/37975/p2p/16Uiu2HAmNVBTadcyLzVuRjLSZYkQaHbowXue2XYVMK97gN78K7ca","/ip4/172.18.241.169/tcp/37976/ws/p2p/16Uiu2HAmNVBTadcyLzVuRjLSZYkQaHbowXue2XYVMK97gN78K7ca"],"enrUri":"enr:-L24QLNFNneKdPGFRBbKyZf03n-nYY3Xgp_al-4RCLZaxpssHPeYdi-lKBitfmrtOBpupFxr4QRkhGUARmuw3P0bOZUCgmlkgnY0gmlwhKwS8amKbXVsdGlhZGRyc5YACASsEvGpBpRXAAoErBLxqQaUWN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDkhGfHfKlYnTWrTX3Ee403lcE_TZdaOVZM4C_RuQMZaeDdGNwgpRXg3VkcIKUWYV3YWt1MgE"}'
2025-02-10 04:06:03.350 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:06:03.356 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:06:03.357 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-06-02__2e94d107-15a7-41aa-bf7f-ea53933ed963__wakuorg_nwaku:latest.log
2025-02-10 04:06:03.357 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:06:03.357 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:06:03.358 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:06:03.358 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.246.156
2025-02-10 04:06:03.358 DEBUG [src.node.docker_mananger] Generated ports ['7822', '7823', '7824', '7825', '7826']
2025-02-10 04:06:03.358 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:06:03.359 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:06:03.359 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:06:03.359 DEBUG [src.node.docker_mananger] docker run -i -t -p 7822:7822 -p 7823:7823 -p 7824:7824 -p 7825:7825 -p 7826:7826 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7824 --rest-port=7822 --tcp-port=7823 --discv5-udp-port=7825 --rest-address=0.0.0.0 --nat=extip:172.18.246.156 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3971d7fbcdf52ddc8b2b9c45d40cecca1babb6e0bfebea04be74df5f7eafeaba --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7826 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QLNFNneKdPGFRBbKyZf03n-nYY3Xgp_al-4RCLZaxpssHPeYdi-lKBitfmrtOBpupFxr4QRkhGUARmuw3P0bOZUCgmlkgnY0gmlwhKwS8amKbXVsdGlhZGRyc5YACASsEvGpBpRXAAoErBLxqQaUWN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDkhGfHfKlYnTWrTX3Ee403lcE_TZdaOVZM4C_RuQMZaeDdGNwgpRXg3VkcIKUWYV3YWt1MgE
2025-02-10 04:06:03.579 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.246.156 waku d83305fdcaf4541d32a391a1f071583b76c3f6e61aaa177035dbd54a16974900
2025-02-10 04:06:03.630 DEBUG [src.node.docker_mananger] Container started with ID d83305fdcaf4. Setting up logs at ./log/docker/node2_2025-02-10_04-06-02__2e94d107-15a7-41aa-bf7f-ea53933ed963__wakuorg_nwaku:latest.log
2025-02-10 04:06:03.631 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 7822
2025-02-10 04:06:03.631 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:06:04.632 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7822/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:04.641 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:06:04.642 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:06:04.642 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7822/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:04.644 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.246.156/tcp/7823/p2p/16Uiu2HAmQ2wnT1jPommcpycNrAehd1XDjvUfHaoxARxTUKMXCV1Q","/ip4/172.18.246.156/tcp/7824/ws/p2p/16Uiu2HAmQ2wnT1jPommcpycNrAehd1XDjvUfHaoxARxTUKMXCV1Q"],"enrUri":"enr:-L24QAR5PbRxirueX2-E5XHYporCaTnQT00C1aHusCaxYKBvNtA6YJbR6BnLCyo9eCyyy85aqEKuqghpEER4LK1snUECgmlkgnY0gmlwhKwS9pyKbXVsdGlhZGRyc5YACASsEvacBh6PAAoErBL2nAYekN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDqRBurxXrw2fFBoVsa0Uw1X-5cPbf9XlUf2WXCgmLHB-DdGNwgh6Pg3VkcIIekYV3YWt1MgE"}'
2025-02-10 04:06:04.644 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:06:04.644 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7822/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.169/tcp/37975/p2p/16Uiu2HAmNVBTadcyLzVuRjLSZYkQaHbowXue2XYVMK97gN78K7ca"]'
2025-02-10 04:06:04.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:04.648 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-10 04:06:04.648 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37974/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:04.651 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:04.652 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7822/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:04.658 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:04.659 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37974/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:04.664 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:04.665 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:06:04.765 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:04.765 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37974/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:04.768 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160364659867648,"ephemeral":false}]'
2025-02-10 04:06:04.769 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:04.770 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7822/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:04.772 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160364659867648,"ephemeral":false}]'
2025-02-10 04:06:04.773 INFO [src.steps.relay] WARM UP successful!!
2025-02-10 04:06:04.774 DEBUG [src.node.waku_node] Pausing container with id d83305fdcaf4
2025-02-10 04:06:04.784 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37974/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:04.788 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:04.788 DEBUG [src.node.waku_node] Unpause container with id d83305fdcaf4
2025-02-10 04:06:04.797 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7822/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:04.799 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160364774541056,"ephemeral":false}]'
2025-02-10 04:06:04.802 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:06:04.803 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:06:04.803 DEBUG [src.node.waku_node] Stopping container with id a61c68df266c
2025-02-10 04:06:05.831 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:05.831 DEBUG [src.node.waku_node] Stopping container with id d83305fdcaf4
2025-02-10 04:06:06.645 ERROR [src.node.docker_mananger] Max retries reached for container a61c68df266c. Exiting log stream.
2025-02-10 04:06:06.666 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:06.667 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:06:06.673 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:06:06.677 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
