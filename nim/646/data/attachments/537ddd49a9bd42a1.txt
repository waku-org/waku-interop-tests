2025-02-10 04:04:33.025 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:04:33.025 DEBUG [tests.conftest] Running test: test_filter_get_message_with_valid_timestamps with id: 2025-02-10_04-04-33__5b484179-b4aa-4735-942e-01933c68cd91
2025-02-10 04:04:33.025 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:04:33.026 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-10 04:04:33.026 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-10 04:04:33.032 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:33.032 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-04-33__5b484179-b4aa-4735-942e-01933c68cd91__wakuorg_nwaku:latest.log
2025-02-10 04:04:33.032 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:33.032 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:33.034 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:33.034 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.87.152
2025-02-10 04:04:33.034 DEBUG [src.node.docker_mananger] Generated ports ['15374', '15375', '15376', '15377', '15378']
2025-02-10 04:04:33.034 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:33.034 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:33.035 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:33.035 DEBUG [src.node.docker_mananger] docker run -i -t -p 15374:15374 -p 15375:15375 -p 15376:15376 -p 15377:15377 -p 15378:15378 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15376 --rest-port=15374 --tcp-port=15375 --discv5-udp-port=15377 --rest-address=0.0.0.0 --nat=extip:172.18.87.152 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=44cb8bfa2fae2d27babd8788bfd68d4b5af926b8c577ba14c6e996bcecfa34ee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15378 --metrics-logging=true --relay=true --filter=true
2025-02-10 04:04:33.266 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.87.152 waku 36b0f87968085050b8f5965039b368622551b8c3b094cbd9781d5fca41b286ad
2025-02-10 04:04:33.314 DEBUG [src.node.docker_mananger] Container started with ID 36b0f8796808. Setting up logs at ./log/docker/node1_2025-02-10_04-04-33__5b484179-b4aa-4735-942e-01933c68cd91__wakuorg_nwaku:latest.log
2025-02-10 04:04:33.315 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15374
2025-02-10 04:04:33.316 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:33.733 ERROR [src.node.docker_mananger] Max retries reached for container 866c14ad2be3. Exiting log stream.
2025-02-10 04:04:34.316 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15374/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:34.319 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:34.319 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:34.320 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15374/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:34.322 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.87.152/tcp/15375/p2p/16Uiu2HAkwVnJzFNi8kpGir4niTSYtiEKfd21NJPR2kq35gVKu5uX","/ip4/172.18.87.152/tcp/15376/ws/p2p/16Uiu2HAkwVnJzFNi8kpGir4niTSYtiEKfd21NJPR2kq35gVKu5uX"],"enrUri":"enr:-L24QDa81pBz7KRtlffNaiYGTMCzxKiMDkHpYtPzeYqU8yckBEprO8C5V701RaXvwlrj00iH0UJ4QcMpUc4EGZFrl7QCgmlkgnY0gmlwhKwSV5iKbXVsdGlhZGRyc5YACASsEleYBjwPAAoErBJXmAY8EN0DgnJzhQADAQAAiXNlY3AyNTZrMaECHsTbAi3USYqg3jQlr-OgkgE-wwzo7bHnvtdRwV5RbPaDdGNwgjwPg3VkcII8EYV3YWt1MgU"}'
2025-02-10 04:04:34.322 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:34.323 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-10 04:04:34.329 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:04:34.329 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-04-33__5b484179-b4aa-4735-942e-01933c68cd91__wakuorg_nwaku:latest.log
2025-02-10 04:04:34.329 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:04:34.329 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:04:34.331 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:04:34.331 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.235.118
2025-02-10 04:04:34.331 DEBUG [src.node.docker_mananger] Generated ports ['8253', '8254', '8255', '8256', '8257']
2025-02-10 04:04:34.331 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:04:34.331 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:04:34.332 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:04:34.332 DEBUG [src.node.docker_mananger] docker run -i -t -p 8253:8253 -p 8254:8254 -p 8255:8255 -p 8256:8256 -p 8257:8257 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8255 --rest-port=8253 --tcp-port=8254 --discv5-udp-port=8256 --rest-address=0.0.0.0 --nat=extip:172.18.235.118 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e5e6ce0afed9e744167d8fc36eeb19eb0a4ff5cc9eb6aacafa2c5cd98686adce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8257 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QDa81pBz7KRtlffNaiYGTMCzxKiMDkHpYtPzeYqU8yckBEprO8C5V701RaXvwlrj00iH0UJ4QcMpUc4EGZFrl7QCgmlkgnY0gmlwhKwSV5iKbXVsdGlhZGRyc5YACASsEleYBjwPAAoErBJXmAY8EN0DgnJzhQADAQAAiXNlY3AyNTZrMaECHsTbAi3USYqg3jQlr-OgkgE-wwzo7bHnvtdRwV5RbPaDdGNwgjwPg3VkcII8EYV3YWt1MgU --filternode=/ip4/172.18.87.152/tcp/15375/p2p/16Uiu2HAkwVnJzFNi8kpGir4niTSYtiEKfd21NJPR2kq35gVKu5uX
2025-02-10 04:04:34.572 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.235.118 waku 3ce124cc259db11f021b5902672470ce875e2cfa351ecbc65e8696a4f9964b50
2025-02-10 04:04:34.617 DEBUG [src.node.docker_mananger] Container started with ID 3ce124cc259d. Setting up logs at ./log/docker/node2_2025-02-10_04-04-33__5b484179-b4aa-4735-942e-01933c68cd91__wakuorg_nwaku:latest.log
2025-02-10 04:04:34.617 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8253
2025-02-10 04:04:34.618 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:04:35.618 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:35.621 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:04:35.621 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:04:35.621 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:35.623 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.118/tcp/8254/p2p/16Uiu2HAmQDKSEQcvPi6vK2V5CBmpJovo47CuFonvnp8ezJYr1Zg5","/ip4/172.18.235.118/tcp/8255/ws/p2p/16Uiu2HAmQDKSEQcvPi6vK2V5CBmpJovo47CuFonvnp8ezJYr1Zg5"],"enrUri":"enr:-L24QJCjz2rau8KjwhmrYGvMWtrlyDex5ar3qsM-bRijMYMDJT-RspDp0t3-yKD9vUmI6Ff2MjULv16PIeLIIPEqh6sCgmlkgnY0gmlwhKwS63aKbXVsdGlhZGRyc5YACASsEut2BiA-AAoErBLrdgYgP90DgnJzhQADAQAAiXNlY3AyNTZrMaEDq7i4x4VujUc29Z2NAvdIkeTdwiCW1mKG9T-_gLvae4qDdGNwgiA-g3VkcIIgQIV3YWt1MgA"}'
2025-02-10 04:04:35.624 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:04:35.624 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8253/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.87.152/tcp/15375/p2p/16Uiu2HAkwVnJzFNi8kpGir4niTSYtiEKfd21NJPR2kq35gVKu5uX"]'
2025-02-10 04:04:35.661 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:35.662 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-10 04:04:35.662 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:04:35.679 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:35.679 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8253/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "6db64f78-f733-4429-8ec5-0ad4f30c5adc", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-10 04:04:35.694 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"6db64f78-f733-4429-8ec5-0ad4f30c5adc","statusDesc":"OK"}'
2025-02-10 04:04:35.695 DEBUG [tests.filter.test_get_messages] Running test with timestamp Now
2025-02-10 04:04:35.695 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:35.703 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:35.703 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:35.803 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:35.804 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:35.806 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739160199504032768,"ephemeral":false}]'
2025-02-10 04:04:35.808 DEBUG [tests.filter.test_get_messages] Running test with timestamp Far future
2025-02-10 04:04:35.809 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:35.813 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:35.813 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:35.914 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:35.914 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:35.917 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":2054520199504018944,"ephemeral":false}]'
2025-02-10 04:04:35.919 DEBUG [tests.filter.test_get_messages] Running test with timestamp Recent past
2025-02-10 04:04:35.919 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:35.923 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:35.924 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:36.024 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:36.025 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:36.027 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739156599504018944,"ephemeral":false}]'
2025-02-10 04:04:36.029 DEBUG [tests.filter.test_get_messages] Running test with timestamp Near future
2025-02-10 04:04:36.029 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:36.034 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:36.034 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:36.134 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:36.135 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:36.138 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739163799504018944,"ephemeral":false}]'
2025-02-10 04:04:36.139 DEBUG [tests.filter.test_get_messages] Running test with timestamp Positive number
2025-02-10 04:04:36.140 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:36.144 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:36.144 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:36.244 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:36.245 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:36.248 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1,"ephemeral":false}]'
2025-02-10 04:04:36.249 DEBUG [tests.filter.test_get_messages] Running test with timestamp Negative number
2025-02-10 04:04:36.249 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:36.253 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:36.254 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:36.354 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:36.355 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:36.357 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":-1,"ephemeral":false}]'
2025-02-10 04:04:36.358 DEBUG [tests.filter.test_get_messages] Running test with timestamp DST change
2025-02-10 04:04:36.359 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15374/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:04:36.363 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:04:36.363 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:04:36.463 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:04:36.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8253/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:04:36.466 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1583632800000000000,"ephemeral":false}]'
2025-02-10 04:04:36.469 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:04:36.470 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:04:36.470 DEBUG [src.node.waku_node] Stopping container with id 36b0f8796808
2025-02-10 04:04:37.878 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:37.878 DEBUG [src.node.waku_node] Stopping container with id 3ce124cc259d
2025-02-10 04:04:38.708 ERROR [src.node.docker_mananger] Max retries reached for container 36b0f8796808. Exiting log stream.
2025-02-10 04:04:39.377 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:04:39.378 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:04:39.388 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:04:39.393 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
