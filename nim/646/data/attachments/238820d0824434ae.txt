2025-02-10 04:06:14.890 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 04:06:14.890 DEBUG [tests.conftest] Running test: test_relay_subscribe_to_already_existing_pubsub_topic with id: 2025-02-10_04-06-14__bcdf8105-4ee8-44b2-a882-fd2246c1c6b7
2025-02-10 04:06:14.890 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 04:06:14.891 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 04:06:14.891 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-10 04:06:14.897 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:06:14.897 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-10_04-06-14__bcdf8105-4ee8-44b2-a882-fd2246c1c6b7__wakuorg_nwaku:latest.log
2025-02-10 04:06:14.897 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:06:14.897 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:06:14.898 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:06:14.899 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.194.182
2025-02-10 04:06:14.899 DEBUG [src.node.docker_mananger] Generated ports ['23729', '23730', '23731', '23732', '23733']
2025-02-10 04:06:14.899 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:06:14.899 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:06:14.899 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:06:14.899 DEBUG [src.node.docker_mananger] docker run -i -t -p 23729:23729 -p 23730:23730 -p 23731:23731 -p 23732:23732 -p 23733:23733 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23731 --rest-port=23729 --tcp-port=23730 --discv5-udp-port=23732 --rest-address=0.0.0.0 --nat=extip:172.18.194.182 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6be86a1dfeca89b8b088dca2c2bcdc66851effdcdbde39b8cb36a7d5d0856176 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23733 --metrics-logging=true --relay=true
2025-02-10 04:06:15.124 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.194.182 waku 09e937136c0faf24cb9e6cb644932964bbb5ff93f0132152cefa348a1b088164
2025-02-10 04:06:15.174 DEBUG [src.node.docker_mananger] Container started with ID 09e937136c0f. Setting up logs at ./log/docker/node1_2025-02-10_04-06-14__bcdf8105-4ee8-44b2-a882-fd2246c1c6b7__wakuorg_nwaku:latest.log
2025-02-10 04:06:15.175 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23729
2025-02-10 04:06:15.175 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:06:15.692 ERROR [src.node.docker_mananger] Max retries reached for container bb63ce166d90. Exiting log stream.
2025-02-10 04:06:16.176 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23729/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:16.179 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:06:16.179 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:06:16.179 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23729/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:16.181 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.194.182/tcp/23730/p2p/16Uiu2HAm1SEkfYcoX1B8gHWv6uZf7DCdjQ7xALrQDBDZWaP75SfE","/ip4/172.18.194.182/tcp/23731/ws/p2p/16Uiu2HAm1SEkfYcoX1B8gHWv6uZf7DCdjQ7xALrQDBDZWaP75SfE"],"enrUri":"enr:-L24QL_ctpb3c5u6xVOSVFhZnw4_EODhhSg1evhdzZioAfCcQP1vrw5sMET2jsQy_RvFrGkwx6P9tZR3Tq4f1ZBgvJUCgmlkgnY0gmlwhKwSwraKbXVsdGlhZGRyc5YACASsEsK2BlyyAAoErBLCtgZcs90DgnJzhQADAQAAiXNlY3AyNTZrMaECWUstyNPTzEdhW-nsOEy1zRpx7iRO0HC90d8biq8Ikq2DdGNwglyyg3VkcIJctIV3YWt1MgE"}'
2025-02-10 04:06:16.182 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:06:16.188 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 04:06:16.188 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-10_04-06-14__bcdf8105-4ee8-44b2-a882-fd2246c1c6b7__wakuorg_nwaku:latest.log
2025-02-10 04:06:16.188 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 04:06:16.189 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 04:06:16.190 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 04:06:16.190 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.99.20
2025-02-10 04:06:16.190 DEBUG [src.node.docker_mananger] Generated ports ['1461', '1462', '1463', '1464', '1465']
2025-02-10 04:06:16.190 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 04:06:16.190 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 04:06:16.190 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 04:06:16.191 DEBUG [src.node.docker_mananger] docker run -i -t -p 1461:1461 -p 1462:1462 -p 1463:1463 -p 1464:1464 -p 1465:1465 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1463 --rest-port=1461 --tcp-port=1462 --discv5-udp-port=1464 --rest-address=0.0.0.0 --nat=extip:172.18.99.20 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d3e934ac4bcdb1e88be4da03b3faefacbe9edb46a8e5f6fb73d7a79dba59c0ed --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1465 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QL_ctpb3c5u6xVOSVFhZnw4_EODhhSg1evhdzZioAfCcQP1vrw5sMET2jsQy_RvFrGkwx6P9tZR3Tq4f1ZBgvJUCgmlkgnY0gmlwhKwSwraKbXVsdGlhZGRyc5YACASsEsK2BlyyAAoErBLCtgZcs90DgnJzhQADAQAAiXNlY3AyNTZrMaECWUstyNPTzEdhW-nsOEy1zRpx7iRO0HC90d8biq8Ikq2DdGNwglyyg3VkcIJctIV3YWt1MgE
2025-02-10 04:06:16.432 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.99.20 waku 381b196de6431151e74c555b0d3081000915b1894fa203a92d4f84f895689d20
2025-02-10 04:06:16.490 DEBUG [src.node.docker_mananger] Container started with ID 381b196de643. Setting up logs at ./log/docker/node2_2025-02-10_04-06-14__bcdf8105-4ee8-44b2-a882-fd2246c1c6b7__wakuorg_nwaku:latest.log
2025-02-10 04:06:16.491 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 1461
2025-02-10 04:06:16.491 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 04:06:17.494 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1461/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:17.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 04:06:17.501 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 04:06:17.502 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1461/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:17.504 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.99.20/tcp/1462/p2p/16Uiu2HAkwE6dSeeUQDjwHKG8jnC7W5tR4Hgs9wpdpDdvEKacLNWE","/ip4/172.18.99.20/tcp/1463/ws/p2p/16Uiu2HAkwE6dSeeUQDjwHKG8jnC7W5tR4Hgs9wpdpDdvEKacLNWE"],"enrUri":"enr:-L24QPgnYmWnXVXM_vOlQ50ZiNcHJMZCWe_ZFumk1RfbpOQ1WGIaMR2hkK9Nd1PDV3adljDdrOyvI41jeHU5_rCqKHACgmlkgnY0gmlwhKwSYxSKbXVsdGlhZGRyc5YACASsEmMUBgW2AAoErBJjFAYFt90DgnJzhQADAQAAiXNlY3AyNTZrMaECGsBGZqOoEYQUqSfir3eW_HZejtedY2dCgBMzLSiHPFuDdGNwggW2g3VkcIIFuIV3YWt1MgE"}'
2025-02-10 04:06:17.504 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 04:06:17.504 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1461/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.194.182/tcp/23730/p2p/16Uiu2HAm1SEkfYcoX1B8gHWv6uZf7DCdjQ7xALrQDBDZWaP75SfE"]'
2025-02-10 04:06:17.507 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:17.508 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23729/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:17.512 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:17.513 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1461/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:17.518 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:17.519 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23729/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:17.525 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:17.525 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:06:17.626 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:17.626 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23729/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:17.629 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160377519152128,"ephemeral":false}]'
2025-02-10 04:06:17.630 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:17.630 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1461/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:17.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160377519152128,"ephemeral":false}]'
2025-02-10 04:06:17.634 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23729/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:17.637 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:17.637 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1461/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 04:06:17.639 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:17.639 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23729/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-10 04:06:17.644 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 04:06:17.645 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-10 04:06:17.745 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:17.745 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23729/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:17.749 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160377639898112,"ephemeral":false}]'
2025-02-10 04:06:17.750 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-10 04:06:17.750 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1461/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 04:06:17.753 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739160377639898112,"ephemeral":false}]'
2025-02-10 04:06:17.756 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 04:06:17.757 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 04:06:17.757 DEBUG [src.node.waku_node] Stopping container with id 09e937136c0f
2025-02-10 04:06:18.672 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:18.673 DEBUG [src.node.waku_node] Stopping container with id 381b196de643
2025-02-10 04:06:19.486 ERROR [src.node.docker_mananger] Max retries reached for container 09e937136c0f. Exiting log stream.
2025-02-10 04:06:20.176 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 04:06:20.179 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 04:06:20.184 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 04:06:20.188 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
