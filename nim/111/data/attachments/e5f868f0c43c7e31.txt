[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_filter_get_message_after_node2_restarts with id: 2024-03-25_11-08-50__daaee76d-1fba-4c88-9173-ce5987d3058d
[35mDEBUG   [0m src.steps.filter:filter.py:27 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:33 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node1_2024-03-25_11-08-50__daaee76d-1fba-4c88-9173-ce5987d3058d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.175.242
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['59179', '59180', '59181', '59182', '59183']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:279 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 59179:59179 -p 59180:59180 -p 59181:59181 -p 59182:59182 -p 59183:59183 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59181 --rest-port=59179 --tcp-port=59180 --discv5-udp-port=59182 --rest-address=0.0.0.0 --nat=extip:172.18.175.242 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59183 --metrics-logging=true --relay=true --filter=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.175.242 waku f4d32303d129cb2b5abfa8a67b9e45240de123c835815502862bb1f0c4e1f00f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID f4d32303d129. Setting up logs at ./log/docker/node1_2024-03-25_11-08-50__daaee76d-1fba-4c88-9173-ce5987d3058d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 59179
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:59179/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.175.242/tcp/59180/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.175.242/tcp/59181/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QBtuPKjTKRp90G6NsC2iT7XlkicmBV5M6XU5VGbcbQH8Bsi_87jIlB89RgWe_tL45OGilIDUtFz7qNBMXRXDbf8BgmlkgnY0gmlwhKwSr_KKbXVsdGlhZGRyc4wACgSsEq_yBuct3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC5yyDdWRwgucuhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:38 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node2_2024-03-25_11-08-50__daaee76d-1fba-4c88-9173-ce5987d3058d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.153.120
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['43776', '43777', '43778', '43779', '43780']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:279 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 43776:43776 -p 43777:43777 -p 43778:43778 -p 43779:43779 -p 43780:43780 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43778 --rest-port=43776 --tcp-port=43777 --discv5-udp-port=43779 --rest-address=0.0.0.0 --nat=extip:172.18.153.120 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43780 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QBtuPKjTKRp90G6NsC2iT7XlkicmBV5M6XU5VGbcbQH8Bsi_87jIlB89RgWe_tL45OGilIDUtFz7qNBMXRXDbf8BgmlkgnY0gmlwhKwSr_KKbXVsdGlhZGRyc4wACgSsEq_yBuct3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC5yyDdWRwgucuhXdha3UyBQ --filternode=/ip4/172.18.175.242/tcp/59180/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.153.120 waku 829b27118756959f00d763402a3aa5d01113d43b22d6e8abf7e7dc9066e20f71
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 829b27118756. Setting up logs at ./log/docker/node2_2024-03-25_11-08-50__daaee76d-1fba-4c88-9173-ce5987d3058d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 43776
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:43776/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.153.120/tcp/43777/p2p/16Uiu2HAm7nzRYFsSmT5Sh5uyvEnQvo1dPxYkYs1LZupmZH7T7rmd","/ip4/172.18.153.120/tcp/43778/ws/p2p/16Uiu2HAm7nzRYFsSmT5Sh5uyvEnQvo1dPxYkYs1LZupmZH7T7rmd"],"enrUri":"enr:-LO4QAz4b6wwwXF7FM8m1dKkMvQv8G8l_U8x8o9A_qEbyNWZE1MCx3EWtWFzdq2DXwcF100Iix3Vr3jmvBeCwwkvZpUBgmlkgnY0gmlwhKwSmXiKbXVsdGlhZGRyc4wACgSsEpl4BqsC3QOCcnOFAAABAACJc2VjcDI1NmsxoQK3wktw36xTBpQ1oykxWQU64L0AJDcj4PQMmAJlDg6GUIN0Y3CCqwGDdWRwgqsDhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:45 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:59179/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:43776/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1ace1a3d-4c5a-4c9b-8a4a-e0ac59ac1404", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"1ace1a3d-4c5a-4c9b-8a4a-e0ac59ac1404","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:59179/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:43776/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1711364934431637760,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:175 Restarting container with id 829b27118756
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:43776/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:43776/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.153.120/tcp/43777/p2p/16Uiu2HAmRHbL67meG8fmUQwb8ikEt6EDSzUxLoFnm6wcdZwFAwYz","/ip4/172.18.153.120/tcp/43778/ws/p2p/16Uiu2HAmRHbL67meG8fmUQwb8ikEt6EDSzUxLoFnm6wcdZwFAwYz"],"enrUri":"enr:-LO4QBC6RxTqpvOp3TfflL0fX8MM1XMUzJMTwarSg5O99B6zBbi9rUq-3l50vOLtR6HyTmYSpBhhUwxpTo68t_9tdxMBgmlkgnY0gmlwhKwSmXiKbXVsdGlhZGRyc4wACgSsEpl4BqsC3QOCcnOFAAABAACJc2VjcDI1NmsxoQO7rLQV4QCRXLWeSpFRCZKpKVwBhHvLp8vaIwDZ1EyD34N0Y3CCqwGDdWRwgqsDhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:59179/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:43776/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "4a1cf3c9-8a32-4a57-9fd0-217f1e9ed515", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"4a1cf3c9-8a32-4a57-9fd0-217f1e9ed515","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:59179/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:43776/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1711364939337743360,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id f4d32303d129
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 829b27118756
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.