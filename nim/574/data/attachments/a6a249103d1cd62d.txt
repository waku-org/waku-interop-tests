[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2024-12-25_18-26-07__f83cddaa-84f2-4a17-8b11-67592b85af98
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-25_18-26-07__f83cddaa-84f2-4a17-8b11-67592b85af98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-25_18-26-07__f83cddaa-84f2-4a17-8b11-67592b85af98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-12-25_18-26-07__f83cddaa-84f2-4a17-8b11-67592b85af98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:389 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.102.62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20592', '20593', '20594', '20595', '20596']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20592:20592 -p 20593:20593 -p 20594:20594 -p 20595:20595 -p 20596:20596 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20594 --rest-port=20592 --tcp-port=20593 --discv5-udp-port=20595 --rest-address=0.0.0.0 --nat=extip:172.18.102.62 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e810b9cdc3cff2bbc8ba144bd6ae472e5d2ebb6c8d789bbe41de7c8e2eca0f8e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20596 --metrics-logging=true --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.102.62 waku 74a9f5597ecfbc3cf3299cbc0ab637bf4ab1174e3e5d93937c03841ae7877eef
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 74a9f5597ecf. Setting up logs at ./log/docker/node1_2024-12-25_18-26-07__f83cddaa-84f2-4a17-8b11-67592b85af98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 20592
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container cab6c285fb9e. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20592/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20592/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.102.62/tcp/20593/p2p/16Uiu2HAmHhYMMfWQ9zzDtrmpcSPUJChqfLbAK9WtvPVbW8T9xJhi","/ip4/172.18.102.62/tcp/20594/ws/p2p/16Uiu2HAmHhYMMfWQ9zzDtrmpcSPUJChqfLbAK9WtvPVbW8T9xJhi"],"enrUri":"enr:-L24QPLuqee9N3R4SDqEqkBWJ_cSPDHcr7ggpA-d7cyLfoQLFnGa0MNK-fPxGHln5FAOvdivJKdkYzRZH-QynjNLpKkCgmlkgnY0gmlwhKwSZj6KbXVsdGlhZGRyc5YACASsEmY-BlBxAAoErBJmPgZQct0DgnJzhQADAQAAiXNlY3AyNTZrMaEDSvHHswjz5NgqmmRQ-b0ekHweDIAgeKNHIJykrPoBSDWDdGNwglBxg3VkcIJQc4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.103.157
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['1388', '1389', '1390', '1391', '1392']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 1388:1388 -p 1389:1389 -p 1390:1390 -p 1391:1391 -p 1392:1392 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1390 --rest-port=1388 --tcp-port=1389 --discv5-udp-port=1391 --rest-address=0.0.0.0 --nat=extip:172.18.103.157 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8ccffd0a3bd6f7de7aee41c6bd7c4aeb1f4abe46f8fc26d586df9ddcf6ae3ffd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1392 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QPLuqee9N3R4SDqEqkBWJ_cSPDHcr7ggpA-d7cyLfoQLFnGa0MNK-fPxGHln5FAOvdivJKdkYzRZH-QynjNLpKkCgmlkgnY0gmlwhKwSZj6KbXVsdGlhZGRyc5YACASsEmY-BlBxAAoErBJmPgZQct0DgnJzhQADAQAAiXNlY3AyNTZrMaEDSvHHswjz5NgqmmRQ-b0ekHweDIAgeKNHIJykrPoBSDWDdGNwglBxg3VkcIJQc4V3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.103.157 waku aae91688aaf9acaa18bbda13a31e449ef6a0a59697d50a5e3437d1bd7e028f80
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID aae91688aaf9. Setting up logs at ./log/docker/node2_2024-12-25_18-26-07__f83cddaa-84f2-4a17-8b11-67592b85af98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 1388
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1388/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1388/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.103.157/tcp/1389/p2p/16Uiu2HAm5Ggrq9k3fnzpt97xQucfRPzDwoRPRitQHcFktyaavWUJ","/ip4/172.18.103.157/tcp/1390/ws/p2p/16Uiu2HAm5Ggrq9k3fnzpt97xQucfRPzDwoRPRitQHcFktyaavWUJ"],"enrUri":"enr:-L24QK1IkdVW4X7IhUJYAzNJcfJ4WVsnKDwLtm8UQQdg6ejheucdrZ1dkv2raouDU9lUtQ1IW0eVku9TvxfkpPv0X5cCgmlkgnY0gmlwhKwSZ52KbXVsdGlhZGRyc5YACASsEmedBgVtAAoErBJnnQYFbt0DgnJzhQADAQAAiXNlY3AyNTZrMaECkkejD0jpYssNNpiC2CoZTO5Rknmm047j80zWfKvbDruDdGNwggVtg3VkcIIFb4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.40.205
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['16656', '16657', '16658', '16659', '16660']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 16656:16656 -p 16657:16657 -p 16658:16658 -p 16659:16659 -p 16660:16660 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16658 --rest-port=16656 --tcp-port=16657 --discv5-udp-port=16659 --rest-address=0.0.0.0 --nat=extip:172.18.40.205 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d13bbe9e96adc83b7d7e3167c1beddca309afca2b3f587be7a6aa6bfaa74fb98 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16660 --metrics-logging=true --relay=false --storenode=/ip4/172.18.103.157/tcp/1389/p2p/16Uiu2HAm5Ggrq9k3fnzpt97xQucfRPzDwoRPRitQHcFktyaavWUJ --discv5-bootstrap-node=enr:-L24QK1IkdVW4X7IhUJYAzNJcfJ4WVsnKDwLtm8UQQdg6ejheucdrZ1dkv2raouDU9lUtQ1IW0eVku9TvxfkpPv0X5cCgmlkgnY0gmlwhKwSZ52KbXVsdGlhZGRyc5YACASsEmedBgVtAAoErBJnnQYFbt0DgnJzhQADAQAAiXNlY3AyNTZrMaECkkejD0jpYssNNpiC2CoZTO5Rknmm047j80zWfKvbDruDdGNwggVtg3VkcIIFb4V3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.40.205 waku fdd21eb650db60a38ed03fd41e05f435fa4a749c48e937a93c8665eacaf5d93a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID fdd21eb650db. Setting up logs at ./log/docker/node3_2024-12-25_18-26-07__f83cddaa-84f2-4a17-8b11-67592b85af98__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 16656
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16656/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16656/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.40.205/tcp/16657/p2p/16Uiu2HAmFB6d23U7kLUQmYdSKuPFcUd5pehkEHHn6ZqfR9ZUms1H","/ip4/172.18.40.205/tcp/16658/ws/p2p/16Uiu2HAmFB6d23U7kLUQmYdSKuPFcUd5pehkEHHn6ZqfR9ZUms1H"],"enrUri":"enr:-L24QDdsKwnVPD6d0rgf1lYQzRV7o-JWPoaKEY1AJVgl5PfUEKiBDUvRPlWlI0sQN4aryAhZzPzGUBIcdxTwLD8DVQcCgmlkgnY0gmlwhKwSKM2KbXVsdGlhZGRyc5YACASsEijNBkERAAoErBIozQZBEt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDJW3jlDJdw5kiQ-N5wNaCYFvPGMeDPu5k0P6XCw52EKiDdGNwgkERg3VkcIJBE4V3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:394 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20592/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1388/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20592/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.103.157/tcp/1389/p2p/16Uiu2HAm5Ggrq9k3fnzpt97xQucfRPzDwoRPRitQHcFktyaavWUJ","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1388/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.102.62/tcp/20593/p2p/16Uiu2HAmHhYMMfWQ9zzDtrmpcSPUJChqfLbAK9WtvPVbW8T9xJhi","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:399 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20592/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:404 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16656/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"678b53b965dcfda8b528","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:408 Response for store when ephemeral = true is strPeer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '678b53b965dcfda8b528', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:410 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 74a9f5597ecf
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id aae91688aaf9
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 74a9f5597ecf. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id fdd21eb650db
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container aae91688aaf9. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.