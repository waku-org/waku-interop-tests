[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-10-11_04-19-42__26dac0fb-8654-4f45-8889-66740ff14916
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-11_04-19-42__26dac0fb-8654-4f45-8889-66740ff14916__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.135.214
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['17170', '17171', '17172', '17173', '17174']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 17170:17170 -p 17171:17171 -p 17172:17172 -p 17173:17173 -p 17174:17174 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17172 --rest-port=17170 --tcp-port=17171 --discv5-udp-port=17173 --rest-address=0.0.0.0 --nat=extip:172.18.135.214 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=80f5b1419fe802ada417ecddaf222be9ea00912f0fb8dafe348bceca7ed3a21b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17174 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.135.214 waku 80468305ecc0a4a1d99e1026ca71b0a20b238b068e2aaa784b53f39e40baf99b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 80468305ecc0. Setting up logs at ./log/docker/receiving_node1_2024-10-11_04-19-42__26dac0fb-8654-4f45-8889-66740ff14916__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 17170
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17170/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17170/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.135.214/tcp/17171/p2p/16Uiu2HAm2jJqfGUnah7dnCv5M6VEY8jwSqbVQE2tTYoeF3tGhKi1","/ip4/172.18.135.214/tcp/17172/ws/p2p/16Uiu2HAm2jJqfGUnah7dnCv5M6VEY8jwSqbVQE2tTYoeF3tGhKi1"],"enrUri":"enr:-LO4QAFBD56-L5CjZkRs_jqMj_66-ft87-2RFEJTirCAlqI3dVoz1WkBkjBZlTC4aK9V4Na_lrGiiorjLusBSymkLCMBgmlkgnY0gmlwhKwSh9aKbXVsdGlhZGRyc4wACgSsEofWBkMU3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJshlwWtxWzkCR6S2u5C9egqRgmHAV1GtGd-_IW0RYrYoN0Y3CCQxODdWRwgkMVhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-11_04-19-42__26dac0fb-8654-4f45-8889-66740ff14916__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.97.91
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['45637', '45638', '45639', '45640', '45641']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 45637:45637 -p 45638:45638 -p 45639:45639 -p 45640:45640 -p 45641:45641 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45639 --rest-port=45637 --tcp-port=45638 --discv5-udp-port=45640 --rest-address=0.0.0.0 --nat=extip:172.18.97.91 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=abf9c467ffedf9f4baca5859ce377ba3d1bad6cf6d3cdecfbcd19fbc9bd348c0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45641 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.97.91 waku 606a4bdf083d1eab93b0fd3e1ca510393c5e2a4fbd6140e65254e77dc42f6aaf
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 606a4bdf083d. Setting up logs at ./log/docker/receiving_node2_2024-10-11_04-19-42__26dac0fb-8654-4f45-8889-66740ff14916__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 45637
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45637/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45637/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.91/tcp/45638/p2p/16Uiu2HAm5uTehoGTNPbTwjb52UiMwxGY4iBE9uJ74PvtPfKhtUQg","/ip4/172.18.97.91/tcp/45639/ws/p2p/16Uiu2HAm5uTehoGTNPbTwjb52UiMwxGY4iBE9uJ74PvtPfKhtUQg"],"enrUri":"enr:-LO4QH_50Zncfv7bMDz1Mwy05lgRJyBXBdK_kkQsOMauqSiSUlBj8Su-eQxrNAKPWXwpsf0dhV7zUUlkeRM8RckmWY8BgmlkgnY0gmlwhKwSYVuKbXVsdGlhZGRyc4wACgSsEmFbBrJH3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKbszD7DOPRAJt1scbk9WstanW10QrSBBBbl3GjhU9HYYN0Y3CCskaDdWRwgrJIhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45637/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.135.214/tcp/17171/p2p/16Uiu2HAm2jJqfGUnah7dnCv5M6VEY8jwSqbVQE2tTYoeF3tGhKi1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-11_04-19-42__26dac0fb-8654-4f45-8889-66740ff14916__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.35.166
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['27400', '27401', '27402', '27403', '27404']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 27400:27400 -p 27401:27401 -p 27402:27402 -p 27403:27403 -p 27404:27404 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27402 --rest-port=27400 --tcp-port=27401 --discv5-udp-port=27403 --rest-address=0.0.0.0 --nat=extip:172.18.35.166 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=189e27b51b96fdb8b8bfecdba69a3050bdb460d223a14dbae8eec563ba9f8efc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27404 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QAFBD56-L5CjZkRs_jqMj_66-ft87-2RFEJTirCAlqI3dVoz1WkBkjBZlTC4aK9V4Na_lrGiiorjLusBSymkLCMBgmlkgnY0gmlwhKwSh9aKbXVsdGlhZGRyc4wACgSsEofWBkMU3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJshlwWtxWzkCR6S2u5C9egqRgmHAV1GtGd-_IW0RYrYoN0Y3CCQxODdWRwgkMVhXdha3UyCQ --lightpushnode=/ip4/172.18.135.214/tcp/17171/p2p/16Uiu2HAm2jJqfGUnah7dnCv5M6VEY8jwSqbVQE2tTYoeF3tGhKi1 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.35.166 waku 95850a37cc9d5e96e57ad5389e04502fc6b8c71d19a9143692a686372debd6be
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 95850a37cc9d. Setting up logs at ./log/docker/lightpush_node1_2024-10-11_04-19-42__26dac0fb-8654-4f45-8889-66740ff14916__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 27400
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27400/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27400/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.35.166/tcp/27401/p2p/16Uiu2HAkzMVASQkFaTmYdmwhVsusgDj61BPE9D7vkfTLxp7v1XUE","/ip4/172.18.35.166/tcp/27402/ws/p2p/16Uiu2HAkzMVASQkFaTmYdmwhVsusgDj61BPE9D7vkfTLxp7v1XUE"],"enrUri":"enr:-LO4QD1XPKpM21wMMBTHBZajlSORO0KvwLf8lB9QAXX7zPPRItC5dDRV8W5qj3hGsQ9uttL5WUQIVRZ5HUd-dCIlNFgBgmlkgnY0gmlwhKwSI6aKbXVsdGlhZGRyc4wACgSsEiOmBmsK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJJN-GVcVaKbDG_O8CY13CB9ktFh2W5Q1I520m28i7Es4N0Y3CCawmDdWRwgmsLhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.135.214/tcp/17171/p2p/16Uiu2HAm2jJqfGUnah7dnCv5M6VEY8jwSqbVQE2tTYoeF3tGhKi1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.97.91/tcp/45638/p2p/16Uiu2HAm5uTehoGTNPbTwjb52UiMwxGY4iBE9uJ74PvtPfKhtUQg"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17170/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45637/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728620388863770368}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:27400/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728620388867115520}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:27400/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728620388870501376}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:27400/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728620388873912576}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:27400/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728620388880653568}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:27400/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27400/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728620388884342016}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:27400/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 80468305ecc0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 606a4bdf083d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 95850a37cc9d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.