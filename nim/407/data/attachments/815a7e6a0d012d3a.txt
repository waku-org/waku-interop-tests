[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-10-26_04-11-56__843fe3be-9eb8-4999-859b-ed39d24b4931
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-26_04-11-56__843fe3be-9eb8-4999-859b-ed39d24b4931__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.82.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29412', '29413', '29414', '29415', '29416']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29412:29412 -p 29413:29413 -p 29414:29414 -p 29415:29415 -p 29416:29416 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29414 --rest-port=29412 --tcp-port=29413 --discv5-udp-port=29415 --rest-address=0.0.0.0 --nat=extip:172.18.82.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=befce340e4b208e7bfddc7ee0c9eee0dcb9cbbe4bfb145a4dce0b3b9a1397c3b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29416 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.82.183 waku 683925c9075dbeeab742622018a236a16c7d27f01f9b0f552fcdd7f05cbe7660
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 683925c9075d. Setting up logs at ./log/docker/receiving_node1_2024-10-26_04-11-56__843fe3be-9eb8-4999-859b-ed39d24b4931__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 29412
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 5c4e10f7c224. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29412/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29412/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.82.183/tcp/29413/p2p/16Uiu2HAkyNi49rRVbhcarMAmbkTRfmi7B9FL3CVcEuiproLgn1CL","/ip4/172.18.82.183/tcp/29414/ws/p2p/16Uiu2HAkyNi49rRVbhcarMAmbkTRfmi7B9FL3CVcEuiproLgn1CL"],"enrUri":"enr:-LO4QA7nHFq_U5J6aFGJqmaOS8obCexrC25ahdETUto_yY5paF1U-aKgT7LoiS0bwHsF-zU6QEde4rZBopbIZu8klJ4BgmlkgnY0gmlwhKwSUreKbXVsdGlhZGRyc4wACgSsElK3BnLm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI6rFoHzgTcShuRunodXm2zgR5egK25XSHh7nxzpEO26YN0Y3CCcuWDdWRwgnLnhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-26_04-11-56__843fe3be-9eb8-4999-859b-ed39d24b4931__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.39.81
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['62561', '62562', '62563', '62564', '62565']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 62561:62561 -p 62562:62562 -p 62563:62563 -p 62564:62564 -p 62565:62565 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62563 --rest-port=62561 --tcp-port=62562 --discv5-udp-port=62564 --rest-address=0.0.0.0 --nat=extip:172.18.39.81 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dad9c170bda88cadaab4e8f29e2f8f9c293d52e7e5e11b3eebf573ae37f62b94 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62565 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.39.81 waku bb6a7439f46eb829740441fba185dd7cc6460da4881d48a5f9e65f80a4fc55f7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID bb6a7439f46e. Setting up logs at ./log/docker/receiving_node2_2024-10-26_04-11-56__843fe3be-9eb8-4999-859b-ed39d24b4931__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 62561
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62561/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62561/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.81/tcp/62562/p2p/16Uiu2HAmJ3y6HfcWbkCqBfy6EXp3ECjnnhQcY4TTuBRrobPyNPmC","/ip4/172.18.39.81/tcp/62563/ws/p2p/16Uiu2HAmJ3y6HfcWbkCqBfy6EXp3ECjnnhQcY4TTuBRrobPyNPmC"],"enrUri":"enr:-LO4QLUJKCTiOB8jPDSR_IOne5LmpSSppJkxYMzeyvHfw53VIBrSVI4yqT7Uvi0ruHxxoef1xDIW5t4lhRmzHyO-wp0BgmlkgnY0gmlwhKwSJ1GKbXVsdGlhZGRyc4wACgSsEidRBvRj3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNQLV69kFwGROgkqMBcXO1eJJOb5rVegrRcMD6rmMfII4N0Y3CC9GKDdWRwgvRkhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62561/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.82.183/tcp/29413/p2p/16Uiu2HAkyNi49rRVbhcarMAmbkTRfmi7B9FL3CVcEuiproLgn1CL"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-26_04-11-56__843fe3be-9eb8-4999-859b-ed39d24b4931__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.40.32
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['17912', '17913', '17914', '17915', '17916']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 17912:17912 -p 17913:17913 -p 17914:17914 -p 17915:17915 -p 17916:17916 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17914 --rest-port=17912 --tcp-port=17913 --discv5-udp-port=17915 --rest-address=0.0.0.0 --nat=extip:172.18.40.32 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=42ac1be646d0765de6f40dbecbf68c41b8f7ceb8f4abaecc62d1f1fdcb02dafc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17916 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QA7nHFq_U5J6aFGJqmaOS8obCexrC25ahdETUto_yY5paF1U-aKgT7LoiS0bwHsF-zU6QEde4rZBopbIZu8klJ4BgmlkgnY0gmlwhKwSUreKbXVsdGlhZGRyc4wACgSsElK3BnLm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI6rFoHzgTcShuRunodXm2zgR5egK25XSHh7nxzpEO26YN0Y3CCcuWDdWRwgnLnhXdha3UyCQ --lightpushnode=/ip4/172.18.82.183/tcp/29413/p2p/16Uiu2HAkyNi49rRVbhcarMAmbkTRfmi7B9FL3CVcEuiproLgn1CL --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.40.32 waku 97c9555e019c518253e141a15d63299a7bbed9a2396f032d9b61a20604ce95d9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 97c9555e019c. Setting up logs at ./log/docker/lightpush_node1_2024-10-26_04-11-56__843fe3be-9eb8-4999-859b-ed39d24b4931__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 17912
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17912/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17912/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.40.32/tcp/17913/p2p/16Uiu2HAmC3KSYQNvtnDiY3LNXdQyGnt2qMdPHLTBnwCtAAE1AK3V","/ip4/172.18.40.32/tcp/17914/ws/p2p/16Uiu2HAmC3KSYQNvtnDiY3LNXdQyGnt2qMdPHLTBnwCtAAE1AK3V"],"enrUri":"enr:-LO4QHLW8b6K6CQXKcjTc5TmE2fPVYqBG_x5qW7UhYQtz8d9OQxKZ404YjRICqKzzI__K1uU-Ykje3EoUY2IYMXPpdwBgmlkgnY0gmlwhKwSKCCKbXVsdGlhZGRyc4wACgSsEiggBkX63QOCcnOFAAMBAACJc2VjcDI1NmsxoQL23K04B-g4khYZEhIm608Fr0ZxdRYQlMWH3PemDj5ZYIN0Y3CCRfmDdWRwgkX7hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17912/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.82.183/tcp/29413/p2p/16Uiu2HAkyNi49rRVbhcarMAmbkTRfmi7B9FL3CVcEuiproLgn1CL"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17912/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.81/tcp/62562/p2p/16Uiu2HAmJ3y6HfcWbkCqBfy6EXp3ECjnnhQcY4TTuBRrobPyNPmC"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29412/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62561/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17912/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1729915921028015104}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29412/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1729915921028015104,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.82.183/tcp/29413"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.82.183/tcp/29413"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 683925c9075d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id bb6a7439f46e
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 683925c9075d. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 97c9555e019c
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container bb6a7439f46e. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.