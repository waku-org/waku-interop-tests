[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_get_message_after_node1_restarts with id: 2024-12-19_04-08-50__5dfbcea1-7547-4cd1-ab91-727f9ff86e8c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-19_04-08-50__5dfbcea1-7547-4cd1-ab91-727f9ff86e8c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.20.96
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['11053', '11054', '11055', '11056', '11057']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 11053:11053 -p 11054:11054 -p 11055:11055 -p 11056:11056 -p 11057:11057 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11055 --rest-port=11053 --tcp-port=11054 --discv5-udp-port=11056 --rest-address=0.0.0.0 --nat=extip:172.18.20.96 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e57355cfcffbdd0bf3f6c1a3ffaabbf1dfe1d6f3200fa0fadfaaeafdbe4b057e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11057 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.20.96 waku c6c8a491ce48724b01fb8977a0a7843099f6f702f6578577bcc8b0af414af24f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c6c8a491ce48. Setting up logs at ./log/docker/node1_2024-12-19_04-08-50__5dfbcea1-7547-4cd1-ab91-727f9ff86e8c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 11053
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d6cdb3a83d60. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11053/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11053/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.20.96/tcp/11054/p2p/16Uiu2HAm3689tgfDp5HgiGHMoXoAn6KHXM3tKw2Rm9Kzet6MRAyn","/ip4/172.18.20.96/tcp/11055/ws/p2p/16Uiu2HAm3689tgfDp5HgiGHMoXoAn6KHXM3tKw2Rm9Kzet6MRAyn"],"enrUri":"enr:-L24QFawnifgzZqxhhYgGmJnJ4KNzubqYaG1tRqa3FDiGfD8NQOTf7A20NdI31L20xNxGC5-_yqXwJDWzR7EkUgUHasCgmlkgnY0gmlwhKwSFGCKbXVsdGlhZGRyc5YACASsEhRgBisuAAoErBIUYAYrL90DgnJzhQADAQAAiXNlY3AyNTZrMaECcdt5caMdSrZO2ixuWNGpSBx80lME6CMiV9vgMrvO2IGDdGNwgisug3VkcIIrMIV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-19_04-08-50__5dfbcea1-7547-4cd1-ab91-727f9ff86e8c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.86.222
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['61285', '61286', '61287', '61288', '61289']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 61285:61285 -p 61286:61286 -p 61287:61287 -p 61288:61288 -p 61289:61289 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61287 --rest-port=61285 --tcp-port=61286 --discv5-udp-port=61288 --rest-address=0.0.0.0 --nat=extip:172.18.86.222 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=64e9d7f2acd0bd2b4d9adc1caf0190ef207ec7f0236da5ecccbab63475b65db8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61289 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QFawnifgzZqxhhYgGmJnJ4KNzubqYaG1tRqa3FDiGfD8NQOTf7A20NdI31L20xNxGC5-_yqXwJDWzR7EkUgUHasCgmlkgnY0gmlwhKwSFGCKbXVsdGlhZGRyc5YACASsEhRgBisuAAoErBIUYAYrL90DgnJzhQADAQAAiXNlY3AyNTZrMaECcdt5caMdSrZO2ixuWNGpSBx80lME6CMiV9vgMrvO2IGDdGNwgisug3VkcIIrMIV3YWt1MgU --filternode=/ip4/172.18.20.96/tcp/11054/p2p/16Uiu2HAm3689tgfDp5HgiGHMoXoAn6KHXM3tKw2Rm9Kzet6MRAyn
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.86.222 waku 675db40babeaafc5a9c169f19643872ee6293d44a82694739b09f933370a60ab
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 675db40babea. Setting up logs at ./log/docker/node2_2024-12-19_04-08-50__5dfbcea1-7547-4cd1-ab91-727f9ff86e8c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 61285
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61285/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61285/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.86.222/tcp/61286/p2p/16Uiu2HAm2tDCU33AAVZoNBhfoWBbwW2hsf4zqwLwJKMdv5no7aCe","/ip4/172.18.86.222/tcp/61287/ws/p2p/16Uiu2HAm2tDCU33AAVZoNBhfoWBbwW2hsf4zqwLwJKMdv5no7aCe"],"enrUri":"enr:-L24QOP9R01tbBcjDdwy0oOUR7zF_ok2xjhRcl8EeLmQvHXSZrgSvJx61qBby2_GlX1sVEubXCeJsAP9PrHDLwdvF0cCgmlkgnY0gmlwhKwSVt6KbXVsdGlhZGRyc5YACASsElbeBu9mAAoErBJW3gbvZ90DgnJzhQADAQAAiXNlY3AyNTZrMaECbs41WaVFdAneQYFzqAdL8cmH3Y2aVyZTEho2JAkbGLeDdGNwgu9mg3VkcILvaIV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61285/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.20.96/tcp/11054/p2p/16Uiu2HAm3689tgfDp5HgiGHMoXoAn6KHXM3tKw2Rm9Kzet6MRAyn"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11053/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61285/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d78d60a9-16ac-42bb-bc09-a53846044bce", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"d78d60a9-16ac-42bb-bc09-a53846044bce","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11053/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61285/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1734581333251689984,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:249 Restarting container with id c6c8a491ce48
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11053/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11053/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11053/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.20.96/tcp/11054/p2p/16Uiu2HAm3689tgfDp5HgiGHMoXoAn6KHXM3tKw2Rm9Kzet6MRAyn","/ip4/172.18.20.96/tcp/11055/ws/p2p/16Uiu2HAm3689tgfDp5HgiGHMoXoAn6KHXM3tKw2Rm9Kzet6MRAyn"],"enrUri":"enr:-L24QFawnifgzZqxhhYgGmJnJ4KNzubqYaG1tRqa3FDiGfD8NQOTf7A20NdI31L20xNxGC5-_yqXwJDWzR7EkUgUHasCgmlkgnY0gmlwhKwSFGCKbXVsdGlhZGRyc5YACASsEhRgBisuAAoErBIUYAYrL90DgnJzhQADAQAAiXNlY3AyNTZrMaECcdt5caMdSrZO2ixuWNGpSBx80lME6CMiV9vgMrvO2IGDdGNwgisug3VkcIIrMIV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11053/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61285/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d4b1a240-fea0-4392-960f-28c3ad01a286", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"d4b1a240-fea0-4392-960f-28c3ad01a286","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11053/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61285/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1734581337492972544,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id c6c8a491ce48
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 675db40babea
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c6c8a491ce48. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.