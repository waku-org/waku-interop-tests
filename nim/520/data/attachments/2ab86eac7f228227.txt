[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_add_a_new_content_topic with id: 2024-12-15_04-10-48__3c34c6d9-09e6-4d9e-9632-d49a12bce353
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-15_04-10-48__3c34c6d9-09e6-4d9e-9632-d49a12bce353__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.63.144
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['45792', '45793', '45794', '45795', '45796']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 45792:45792 -p 45793:45793 -p 45794:45794 -p 45795:45795 -p 45796:45796 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45794 --rest-port=45792 --tcp-port=45793 --discv5-udp-port=45795 --rest-address=0.0.0.0 --nat=extip:172.18.63.144 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c4c7c3e2deca4affc4aadc5e06f3d9bf8d49d1f25ea1a649de0a883dd7450dda --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45796 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.63.144 waku 91a22136dcd7b434e4e26bc74aa9d0b6b9511dbeaae0f20030f6d756d93c44b5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 91a22136dcd7. Setting up logs at ./log/docker/node1_2024-12-15_04-10-48__3c34c6d9-09e6-4d9e-9632-d49a12bce353__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 45792
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 5439c31bfeb3. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45792/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45792/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.63.144/tcp/45793/p2p/16Uiu2HAm3Qi3qR64r4diDGAfNoEJi9Xvs9i2LXSqFfiSPVuZhYKp","/ip4/172.18.63.144/tcp/45794/ws/p2p/16Uiu2HAm3Qi3qR64r4diDGAfNoEJi9Xvs9i2LXSqFfiSPVuZhYKp"],"enrUri":"enr:-L24QP2KAvsZMsQfQ9bAcFxt8jGy6iDaMdB08vkEeR1x4aStZVrI2XLOAkGC61O-CmAnfwE52ipnOd-gQ1dq3h_DthcCgmlkgnY0gmlwhKwSP5CKbXVsdGlhZGRyc5YACASsEj-QBrLhAAoErBI_kAay4t0DgnJzhQADAQAAiXNlY3AyNTZrMaECdp5BOxwWqycSkD9PlWiw_QbCRwfgNLbXMSFeHzHBeV-DdGNwgrLhg3VkcIKy44V3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-15_04-10-48__3c34c6d9-09e6-4d9e-9632-d49a12bce353__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.212.243
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['42077', '42078', '42079', '42080', '42081']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 42077:42077 -p 42078:42078 -p 42079:42079 -p 42080:42080 -p 42081:42081 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42079 --rest-port=42077 --tcp-port=42078 --discv5-udp-port=42080 --rest-address=0.0.0.0 --nat=extip:172.18.212.243 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8e96c88e50c2501ec6caa7766edebad151fabf3b2adb7eec74bc13dfec2c874c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42081 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QP2KAvsZMsQfQ9bAcFxt8jGy6iDaMdB08vkEeR1x4aStZVrI2XLOAkGC61O-CmAnfwE52ipnOd-gQ1dq3h_DthcCgmlkgnY0gmlwhKwSP5CKbXVsdGlhZGRyc5YACASsEj-QBrLhAAoErBI_kAay4t0DgnJzhQADAQAAiXNlY3AyNTZrMaECdp5BOxwWqycSkD9PlWiw_QbCRwfgNLbXMSFeHzHBeV-DdGNwgrLhg3VkcIKy44V3YWt1MgU --filternode=/ip4/172.18.63.144/tcp/45793/p2p/16Uiu2HAm3Qi3qR64r4diDGAfNoEJi9Xvs9i2LXSqFfiSPVuZhYKp
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.212.243 waku b0176ceb064ae314644b3bb6b499de468a6d1bb06d28880157e0e4b24308e3c7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b0176ceb064a. Setting up logs at ./log/docker/node2_2024-12-15_04-10-48__3c34c6d9-09e6-4d9e-9632-d49a12bce353__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 42077
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42077/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42077/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.212.243/tcp/42078/p2p/16Uiu2HAmAipAzCpc9aMFUWSr3fSh2v2DGg6vCjsZjSBepudm7vhx","/ip4/172.18.212.243/tcp/42079/ws/p2p/16Uiu2HAmAipAzCpc9aMFUWSr3fSh2v2DGg6vCjsZjSBepudm7vhx"],"enrUri":"enr:-L24QGG10459hkMxXw4Ed5T2a5JIp3YUQb-EogFlNycEKDguEEE7nQDaN1Rn_MtOi2V7-ZycdnVNRA14zjjzZ895GbACgmlkgnY0gmlwhKwS1POKbXVsdGlhZGRyc5YACASsEtTzBqReAAoErBLU8wakX90DgnJzhQADAQAAiXNlY3AyNTZrMaEC40NxBd85_SLrEi2iU1wP2O4j9_pMRB8xHYQkhrrq12uDdGNwgqReg3VkcIKkYIV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42077/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.63.144/tcp/45793/p2p/16Uiu2HAm3Qi3qR64r4diDGAfNoEJi9Xvs9i2LXSqFfiSPVuZhYKp"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45792/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42077/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "5ebed548-1b1f-49bd-83be-ee14bb3c8bf5", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"5ebed548-1b1f-49bd-83be-ee14bb3c8bf5","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:42077/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45792/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42077/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1734235851575047680,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45792/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42077/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1734235851688904960,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 91a22136dcd7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id b0176ceb064a
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 91a22136dcd7. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.