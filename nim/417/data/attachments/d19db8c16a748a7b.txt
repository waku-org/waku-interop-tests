[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-11-02_04-10-33__619b4379-e43c-4a78-ae18-54d24dc2cff7
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-02_04-10-33__619b4379-e43c-4a78-ae18-54d24dc2cff7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.4.245
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3793', '3794', '3795', '3796', '3797']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3793:3793 -p 3794:3794 -p 3795:3795 -p 3796:3796 -p 3797:3797 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3795 --rest-port=3793 --tcp-port=3794 --discv5-udp-port=3796 --rest-address=0.0.0.0 --nat=extip:172.18.4.245 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a9299bdc4aeed3c71450c1b0cc7fd9eb9a9cb7bda9d6f3db848af5ec50f7bfce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3797 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.4.245 waku 3273e7e3e45d8ad6c918a7476ff06f9cdedec72635396fc5790858ea79dfb6a2
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f331e18c60d2. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3273e7e3e45d. Setting up logs at ./log/docker/receiving_node1_2024-11-02_04-10-33__619b4379-e43c-4a78-ae18-54d24dc2cff7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3793
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3793/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3793/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.4.245/tcp/3794/p2p/16Uiu2HAmLKD3i3HXUAUBRvYViAKjgWVAsPQ9pq3BHG3fNeHZmV79","/ip4/172.18.4.245/tcp/3795/ws/p2p/16Uiu2HAmLKD3i3HXUAUBRvYViAKjgWVAsPQ9pq3BHG3fNeHZmV79"],"enrUri":"enr:-L24QDxp6fU_vZIXCTU1mQ0nWMZdVUE8NfpvOOD1NOPdwtnscflvvJ8jP3pZFyBm0MxWJyNinyLciQ85SzcIeNjnOggCgmlkgnY0gmlwhKwSBPWKbXVsdGlhZGRyc5YACASsEgT1Bg7SAAoErBIE9QYO090DgnJzhQADAQAAiXNlY3AyNTZrMaEDccw8Ug6X0xGPvYHJFl2lyja82c1adyua9aRzCYceRfSDdGNwgg7Sg3VkcIIO1IV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-02_04-10-33__619b4379-e43c-4a78-ae18-54d24dc2cff7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.2.122
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['7842', '7843', '7844', '7845', '7846']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 7842:7842 -p 7843:7843 -p 7844:7844 -p 7845:7845 -p 7846:7846 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7844 --rest-port=7842 --tcp-port=7843 --discv5-udp-port=7845 --rest-address=0.0.0.0 --nat=extip:172.18.2.122 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d88a25a37b04bea1d7af03d08b97e0dc5acb755ecec4a070c6044e15c2f9910f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7846 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.2.122 waku 4d922e1af95e01a6aad9b517ac1e8b13b48259af103f2d54729b21ddcf889006
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 4d922e1af95e. Setting up logs at ./log/docker/receiving_node2_2024-11-02_04-10-33__619b4379-e43c-4a78-ae18-54d24dc2cff7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 7842
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7842/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7842/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.2.122/tcp/7843/p2p/16Uiu2HAmSdHyAvCNGjeYGvqKgbPcbCXgKCQk5EYdVYKcpUeqv8ea","/ip4/172.18.2.122/tcp/7844/ws/p2p/16Uiu2HAmSdHyAvCNGjeYGvqKgbPcbCXgKCQk5EYdVYKcpUeqv8ea"],"enrUri":"enr:-L24QMgIVo3wepeOCCMfpqnmFTUcY6att-yCN1zLm_yy0OWoK024dNo60yAavR5PPmXjzweQIgMIRA6PXICbcFYBpNsCgmlkgnY0gmlwhKwSAnqKbXVsdGlhZGRyc5YACASsEgJ6Bh6jAAoErBICegYepN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDz5Rgd69_QnNzpcVExbp99WmPYE7Baa2974TuDCDBayeDdGNwgh6jg3VkcIIepYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7842/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.4.245/tcp/3794/p2p/16Uiu2HAmLKD3i3HXUAUBRvYViAKjgWVAsPQ9pq3BHG3fNeHZmV79"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-02_04-10-33__619b4379-e43c-4a78-ae18-54d24dc2cff7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.216.9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['22702', '22703', '22704', '22705', '22706']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 22702:22702 -p 22703:22703 -p 22704:22704 -p 22705:22705 -p 22706:22706 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22704 --rest-port=22702 --tcp-port=22703 --discv5-udp-port=22705 --rest-address=0.0.0.0 --nat=extip:172.18.216.9 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bd5f86bb97fba0e7efe6acaa0ed21c3ae9af1f26317664121b1e5c82c3e31caa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22706 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QDxp6fU_vZIXCTU1mQ0nWMZdVUE8NfpvOOD1NOPdwtnscflvvJ8jP3pZFyBm0MxWJyNinyLciQ85SzcIeNjnOggCgmlkgnY0gmlwhKwSBPWKbXVsdGlhZGRyc5YACASsEgT1Bg7SAAoErBIE9QYO090DgnJzhQADAQAAiXNlY3AyNTZrMaEDccw8Ug6X0xGPvYHJFl2lyja82c1adyua9aRzCYceRfSDdGNwgg7Sg3VkcIIO1IV3YWt1Mgk --lightpushnode=/ip4/172.18.4.245/tcp/3794/p2p/16Uiu2HAmLKD3i3HXUAUBRvYViAKjgWVAsPQ9pq3BHG3fNeHZmV79 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.216.9 waku 02e043b7c432814c95bef94c67be0fbc2b43b7fb253fabf80aac87f89abc220d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 02e043b7c432. Setting up logs at ./log/docker/lightpush_node1_2024-11-02_04-10-33__619b4379-e43c-4a78-ae18-54d24dc2cff7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22702
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22702/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22702/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.216.9/tcp/22703/p2p/16Uiu2HAmSZ2YJWYsoodzFhoh9coeu63SYAkWRVR5AZz4bZG8Hfbj","/ip4/172.18.216.9/tcp/22704/ws/p2p/16Uiu2HAmSZ2YJWYsoodzFhoh9coeu63SYAkWRVR5AZz4bZG8Hfbj"],"enrUri":"enr:-L24QGDDhCV5glbMB47CCoU_gnXFyq3fjnAbvsh4z8zZJV3rVTD6fjdhOO1yRt5MjDNw9GHsl3BJkc1l8481TurMfQUCgmlkgnY0gmlwhKwS2AmKbXVsdGlhZGRyc5YACASsEtgJBlivAAoErBLYCQZYsN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDznybtAPIZaM1L3QWKUiQMknOlLwq29QXcduibvo_H4aDdGNwglivg3VkcIJYsYV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22702/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.4.245/tcp/3794/p2p/16Uiu2HAmLKD3i3HXUAUBRvYViAKjgWVAsPQ9pq3BHG3fNeHZmV79"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22702/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.2.122/tcp/7843/p2p/16Uiu2HAmSdHyAvCNGjeYGvqKgbPcbCXgKCQk5EYdVYKcpUeqv8ea"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3793/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7842/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22702/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730520638830535424, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3793/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730520638830535424,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7842/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730520638830535424,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22702/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730520638996555520, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3793/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730520638996555520,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7842/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730520638996555520,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3273e7e3e45d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 4d922e1af95e
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3273e7e3e45d. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 02e043b7c432
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 4d922e1af95e. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.