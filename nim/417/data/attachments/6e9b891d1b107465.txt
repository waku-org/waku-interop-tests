[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publishing_node_is_stopped with id: 2024-11-02_04-29-16__cd1fbed0-2b99-4f6d-95c7-05723553e184
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:39 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-11-02_04-29-16__cd1fbed0-2b99-4f6d-95c7-05723553e184__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.101.102
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['31369', '31370', '31371', '31372', '31373']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 31369:31369 -p 31370:31370 -p 31371:31371 -p 31372:31372 -p 31373:31373 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31371 --rest-port=31369 --tcp-port=31370 --discv5-udp-port=31372 --rest-address=0.0.0.0 --nat=extip:172.18.101.102 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2f3ed3e9acda4d7cbcecbc868f5fd4069499795fbaa254958abbeabc983dffa5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31373 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.101.102 waku d317a943fad5747ac7d71d105d2338b2aa36203c36c63d71e0b9682e892cb022
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d317a943fad5. Setting up logs at ./log/docker/publishing_node1_2024-11-02_04-29-16__cd1fbed0-2b99-4f6d-95c7-05723553e184__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 31369
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container cc5a0b710a6d. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31369/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31369/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.101.102/tcp/31370/p2p/16Uiu2HAkyKbTgwrS4YP5U9Hy1XK2FbW2LN2hwK3ZJiGQDJNS1acm","/ip4/172.18.101.102/tcp/31371/ws/p2p/16Uiu2HAkyKbTgwrS4YP5U9Hy1XK2FbW2LN2hwK3ZJiGQDJNS1acm"],"enrUri":"enr:-L24QNpal5AYvXEpsjXO4PRz9VciJ5avFAOD0atL3hpnTw7MeglU6tZDHdsv0MzoxPpW5AS4tBEIvTYmSelxwlFNL_8CgmlkgnY0gmlwhKwSZWaKbXVsdGlhZGRyc5YACASsEmVmBnqKAAoErBJlZgZ6i90DgnJzhQADAQAAiXNlY3AyNTZrMaECOeAnNax8vr_pv2KrMkfya_s5iqWAtjo_D6eb9r3f166DdGNwgnqKg3VkcIJ6jIV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-11-02_04-29-16__cd1fbed0-2b99-4f6d-95c7-05723553e184__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.19.224
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20884', '20885', '20886', '20887', '20888']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20884:20884 -p 20885:20885 -p 20886:20886 -p 20887:20887 -p 20888:20888 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20886 --rest-port=20884 --tcp-port=20885 --discv5-udp-port=20887 --rest-address=0.0.0.0 --nat=extip:172.18.19.224 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0e7953ffd05d66c80e8a09e5776da2c963ac8884be5c5b550eab3aa30f78e6b5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20888 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QNpal5AYvXEpsjXO4PRz9VciJ5avFAOD0atL3hpnTw7MeglU6tZDHdsv0MzoxPpW5AS4tBEIvTYmSelxwlFNL_8CgmlkgnY0gmlwhKwSZWaKbXVsdGlhZGRyc5YACASsEmVmBnqKAAoErBJlZgZ6i90DgnJzhQADAQAAiXNlY3AyNTZrMaECOeAnNax8vr_pv2KrMkfya_s5iqWAtjo_D6eb9r3f166DdGNwgnqKg3VkcIJ6jIV3YWt1MgM --storenode=/ip4/172.18.101.102/tcp/31370/p2p/16Uiu2HAkyKbTgwrS4YP5U9Hy1XK2FbW2LN2hwK3ZJiGQDJNS1acm --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.19.224 waku 3c29d0d8e062a818ca1062b15d59bc1840b2d9ae6a650e1cb34b43e7d1ad1e6f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3c29d0d8e062. Setting up logs at ./log/docker/store_node1_2024-11-02_04-29-16__cd1fbed0-2b99-4f6d-95c7-05723553e184__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 20884
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20884/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20884/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.224/tcp/20885/p2p/16Uiu2HAmN9RUdQnUEKZ6cN1PMRo2AoVgpbFn7CkCyDa8SUZaTKSc","/ip4/172.18.19.224/tcp/20886/ws/p2p/16Uiu2HAmN9RUdQnUEKZ6cN1PMRo2AoVgpbFn7CkCyDa8SUZaTKSc"],"enrUri":"enr:-L24QGjL609tV5l5ZoWHp6gmI3j11tApXzi4O_OV5TktY8qgNfCA6OIvq0oMvHBMRsvr1ZNfaXpVN-uwh6Syr0MNrUUCgmlkgnY0gmlwhKwSE-CKbXVsdGlhZGRyc5YACASsEhPgBlGVAAoErBIT4AZRlt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDjQHbC8hmSRdaCADbO154Dt77hSraxj18Xv_2d9VQ7bWDdGNwglGVg3VkcIJRl4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20884/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.101.102/tcp/31370/p2p/16Uiu2HAkyKbTgwrS4YP5U9Hy1XK2FbW2LN2hwK3ZJiGQDJNS1acm"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31369/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20884/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31369/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31369/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"VNeg3yvPA36hoiC/Md44IHap5ookXLExY/k1XITbHrc="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20884/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"VNeg3yvPA36hoiC/Md44IHap5ookXLExY/k1XITbHrc="}]}'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d317a943fad5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20884/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"VNeg3yvPA36hoiC/Md44IHap5ookXLExY/k1XITbHrc="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3c29d0d8e062
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d317a943fad5. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.