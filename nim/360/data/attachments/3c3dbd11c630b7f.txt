[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-14_04-30-35__4a58c707-0d8a-46a6-9e47-d6ce62ebfdb4
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-14_04-30-35__4a58c707-0d8a-46a6-9e47-d6ce62ebfdb4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.216.207
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['34815', '34816', '34817', '34818', '34819']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 34815:34815 -p 34816:34816 -p 34817:34817 -p 34818:34818 -p 34819:34819 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34817 --rest-port=34815 --tcp-port=34816 --discv5-udp-port=34818 --rest-address=0.0.0.0 --nat=extip:172.18.216.207 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bc3d7c5ddacbf66882e82f6959beb2aed26c3ddcfe3cfe4b0143d041e66187d6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34819 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.216.207 waku 0029fa67efe9c3bb43785689677f028bfe83c2245bd902cfb868e2306366579f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 0029fa67efe9. Setting up logs at ./log/docker/node1_2024-09-14_04-30-35__4a58c707-0d8a-46a6-9e47-d6ce62ebfdb4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 34815
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34815/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34815/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.216.207/tcp/34816/p2p/16Uiu2HAmNCfi9Yu7QvnqgKE1BVBgQ2kCyy1tRmn1Qjv4EPuv3cGW","/ip4/172.18.216.207/tcp/34817/ws/p2p/16Uiu2HAmNCfi9Yu7QvnqgKE1BVBgQ2kCyy1tRmn1Qjv4EPuv3cGW"],"enrUri":"enr:-LO4QLjNX7jdWySLwgFXStswGFmPnAjaFoeTejj249IH5909Oxaxpo6EdtPAQmTa-Ag3Ln9BziCWEYZ7pgJeG6JEXhcBgmlkgnY0gmlwhKwS2M-KbXVsdGlhZGRyc4wACgSsEtjPBogB3QOCcnOFAAIBAACJc2VjcDI1NmsxoQON1rEFg5mxzk7lled9viSp2C5DYLF0MdrrxTGhEuwzj4N0Y3CCiACDdWRwgogChXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-14_04-30-35__4a58c707-0d8a-46a6-9e47-d6ce62ebfdb4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.38.169
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['4813', '4814', '4815', '4816', '4817']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 4813:4813 -p 4814:4814 -p 4815:4815 -p 4816:4816 -p 4817:4817 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4815 --rest-port=4813 --tcp-port=4814 --discv5-udp-port=4816 --rest-address=0.0.0.0 --nat=extip:172.18.38.169 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=2dae0ffb44504b9ed73e1f6660b77e449f05e07d60e2a16da0ccf00de3ed8f6f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4817 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QLjNX7jdWySLwgFXStswGFmPnAjaFoeTejj249IH5909Oxaxpo6EdtPAQmTa-Ag3Ln9BziCWEYZ7pgJeG6JEXhcBgmlkgnY0gmlwhKwS2M-KbXVsdGlhZGRyc4wACgSsEtjPBogB3QOCcnOFAAIBAACJc2VjcDI1NmsxoQON1rEFg5mxzk7lled9viSp2C5DYLF0MdrrxTGhEuwzj4N0Y3CCiACDdWRwgogChXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.38.169 waku d980ef137cf82e721115628cd479b999dd3352887ff85a7902656974caf5ca74
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID d980ef137cf8. Setting up logs at ./log/docker/node2_2024-09-14_04-30-35__4a58c707-0d8a-46a6-9e47-d6ce62ebfdb4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 4813
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4813/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4813/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.169/tcp/4814/p2p/16Uiu2HAm6KHWR45Vfh8ezNmMJMZaszsxX913RHc3rq98swKPDzp1","/ip4/172.18.38.169/tcp/4815/ws/p2p/16Uiu2HAm6KHWR45Vfh8ezNmMJMZaszsxX913RHc3rq98swKPDzp1"],"enrUri":"enr:-LO4QCWZxyvqW0th4gkQ-eZcDbAtBG8B3nGlnweaKp1ChAt7Shyba4j7Umc53_0ZF_gGby-DNDRdHatwI4gg5Jcx7K0BgmlkgnY0gmlwhKwSJqmKbXVsdGlhZGRyc4wACgSsEiapBhLP3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQKhzamBCQrjZmVKwF_zD5cFKgn45_bUARGfqNyechFTqoN0Y3CCEs6DdWRwghLQhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4813/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.216.207/tcp/34816/p2p/16Uiu2HAmNCfi9Yu7QvnqgKE1BVBgQ2kCyy1tRmn1Qjv4EPuv3cGW"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34815/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4813/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34815/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34815/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726288238966510336,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4813/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726288238966510336,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 0029fa67efe9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d980ef137cf8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-14_04-30-35__4a58c707-0d8a-46a6-9e47-d6ce62ebfdb4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-14_04-30-35__4a58c707-0d8a-46a6-9e47-d6ce62ebfdb4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-14_04-30-44__ec5e3772-1f9a-4da3-9594-1ac5348128d9
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-14_04-30-44__ec5e3772-1f9a-4da3-9594-1ac5348128d9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.202.45
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['22774', '22775', '22776', '22777', '22778']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 22774:22774 -p 22775:22775 -p 22776:22776 -p 22777:22777 -p 22778:22778 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22776 --rest-port=22774 --tcp-port=22775 --discv5-udp-port=22777 --rest-address=0.0.0.0 --nat=extip:172.18.202.45 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=fdafa0ae0704fc8eaaac856fcfe5cfa3a881dfcd280deb069aa8dfbb23aa2949 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22778 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.202.45 waku a81067723fc1e413f15c5305aab8ac3c6f769fa978836ad7b7d3efee53c1ab76
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID a81067723fc1. Setting up logs at ./log/docker/node1_2024-09-14_04-30-44__ec5e3772-1f9a-4da3-9594-1ac5348128d9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22774
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22774/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22774/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.202.45/tcp/22775/p2p/16Uiu2HAmT7C61SdfTzj8MUPGgjdFp2mWhFwdmuVuk8nx668kphch","/ip4/172.18.202.45/tcp/22776/ws/p2p/16Uiu2HAmT7C61SdfTzj8MUPGgjdFp2mWhFwdmuVuk8nx668kphch"],"enrUri":"enr:-LO4QN7oP7JVy6z5AytK7e5lyDCvrstYZrBwsKUyGQYvg65AToIxXxs1rlDHMhL4fqbgMNEgVMeERMHJ_ih1qILCpZQBgmlkgnY0gmlwhKwSyi2KbXVsdGlhZGRyc4wACgSsEsotBlj43QOCcnOFAAIBAACJc2VjcDI1NmsxoQPWuf0Q1hcLwPWvE3PSfGtmCRNORgi69XLD-ldGFw6c3oN0Y3CCWPeDdWRwglj5hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-14_04-30-44__ec5e3772-1f9a-4da3-9594-1ac5348128d9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.126.93
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['13422', '13423', '13424', '13425', '13426']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 13422:13422 -p 13423:13423 -p 13424:13424 -p 13425:13425 -p 13426:13426 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13424 --rest-port=13422 --tcp-port=13423 --discv5-udp-port=13425 --rest-address=0.0.0.0 --nat=extip:172.18.126.93 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=511ecbb7a5ee4fc7d37cdfdc8bdc4fe83d7ad4f7810a8dc8c1f9fd97dac6e53c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13426 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QN7oP7JVy6z5AytK7e5lyDCvrstYZrBwsKUyGQYvg65AToIxXxs1rlDHMhL4fqbgMNEgVMeERMHJ_ih1qILCpZQBgmlkgnY0gmlwhKwSyi2KbXVsdGlhZGRyc4wACgSsEsotBlj43QOCcnOFAAIBAACJc2VjcDI1NmsxoQPWuf0Q1hcLwPWvE3PSfGtmCRNORgi69XLD-ldGFw6c3oN0Y3CCWPeDdWRwglj5hXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.126.93 waku a14c614a23f8337152d9853345cad956211fa45b5be74edac69ebfeb97745540
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID a14c614a23f8. Setting up logs at ./log/docker/node2_2024-09-14_04-30-44__ec5e3772-1f9a-4da3-9594-1ac5348128d9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 13422
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13422/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13422/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.126.93/tcp/13423/p2p/16Uiu2HAmUKiUHY1JBynjezN54EzVnxBR93kDGhxshUPMU9amNRMT","/ip4/172.18.126.93/tcp/13424/ws/p2p/16Uiu2HAmUKiUHY1JBynjezN54EzVnxBR93kDGhxshUPMU9amNRMT"],"enrUri":"enr:-LO4QErX4sG_vSHX_itBPBSg8pdECWbYcRzEp-_rkT460QQwZWzuvzW0sypvA7I-rPKiFL_r7GB1wGzOJxjLAEVotlQBgmlkgnY0gmlwhKwSfl2KbXVsdGlhZGRyc4wACgSsEn5dBjRw3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQPoywAl4-RTI0ICSlKxOvMhtvi7a_JpmaYhyyBC0_43KoN0Y3CCNG-DdWRwgjRxhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13422/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.202.45/tcp/22775/p2p/16Uiu2HAmT7C61SdfTzj8MUPGgjdFp2mWhFwdmuVuk8nx668kphch"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22774/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13422/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22774/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22774/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726288249175218432,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13422/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726288249175218432,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a81067723fc1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a14c614a23f8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-14_04-30-44__ec5e3772-1f9a-4da3-9594-1ac5348128d9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-14_04-30-44__ec5e3772-1f9a-4da3-9594-1ac5348128d9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-14_04-30-54__8376d9d9-e406-42f2-8364-a1b43e566311
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-14_04-30-54__8376d9d9-e406-42f2-8364-a1b43e566311__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.54.41
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['32524', '32525', '32526', '32527', '32528']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 32524:32524 -p 32525:32525 -p 32526:32526 -p 32527:32527 -p 32528:32528 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32526 --rest-port=32524 --tcp-port=32525 --discv5-udp-port=32527 --rest-address=0.0.0.0 --nat=extip:172.18.54.41 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bc3b4f96bff8cfe619a676d7faeaa450fbe63ea792adf296c219b690faabfcaa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32528 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.54.41 waku 53927ac3ddff5812af73318f3f2f06e49a2eb871158be6137878f17fadd87453
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 53927ac3ddff. Setting up logs at ./log/docker/node1_2024-09-14_04-30-54__8376d9d9-e406-42f2-8364-a1b43e566311__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 32524
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32524/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32524/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.54.41/tcp/32525/p2p/16Uiu2HAmL698B6AEbs3fXkudDzZHRnTNzZviPDYGwUnk2ux1XQNQ","/ip4/172.18.54.41/tcp/32526/ws/p2p/16Uiu2HAmL698B6AEbs3fXkudDzZHRnTNzZviPDYGwUnk2ux1XQNQ"],"enrUri":"enr:-LO4QDUGcEb6sImyMdBiCsmBJCSjm572eSRTiDDfjbkeSfifXua1b38vumtLp8hNltKX1kIZZODPUYXksNgM6i2et5oBgmlkgnY0gmlwhKwSNimKbXVsdGlhZGRyc4wACgSsEjYpBn8O3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNucz_WdT7b54WNhmBpKInaUSSECn3sbHyO1hA78aQBpYN0Y3CCfw2DdWRwgn8PhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-14_04-30-54__8376d9d9-e406-42f2-8364-a1b43e566311__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.210.114
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['57783', '57784', '57785', '57786', '57787']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 57783:57783 -p 57784:57784 -p 57785:57785 -p 57786:57786 -p 57787:57787 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57785 --rest-port=57783 --tcp-port=57784 --discv5-udp-port=57786 --rest-address=0.0.0.0 --nat=extip:172.18.210.114 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=db0fceb5ea69c02af910226ad332499c7955c5fce1e9f483c37bc16cd7c1f3fc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57787 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QDUGcEb6sImyMdBiCsmBJCSjm572eSRTiDDfjbkeSfifXua1b38vumtLp8hNltKX1kIZZODPUYXksNgM6i2et5oBgmlkgnY0gmlwhKwSNimKbXVsdGlhZGRyc4wACgSsEjYpBn8O3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNucz_WdT7b54WNhmBpKInaUSSECn3sbHyO1hA78aQBpYN0Y3CCfw2DdWRwgn8PhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.210.114 waku 697345671c640a75536e299851e95e9052632d1b65ff577d4f654e1c2b22829f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 697345671c64. Setting up logs at ./log/docker/node2_2024-09-14_04-30-54__8376d9d9-e406-42f2-8364-a1b43e566311__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 57783
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57783/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57783/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.210.114/tcp/57784/p2p/16Uiu2HAm7FwsJQqGSTKFHDYedpU3kRYjZzbq4vCrVxatvYJ5uJBE","/ip4/172.18.210.114/tcp/57785/ws/p2p/16Uiu2HAm7FwsJQqGSTKFHDYedpU3kRYjZzbq4vCrVxatvYJ5uJBE"],"enrUri":"enr:-LO4QJQkcUpRV7bngMjr7nkXhrq6807ljHTHR9oF5P8kvXCYOe_gRu1sWWIVp46kjExFIoB5DW8ik13802qR9TfCzbQBgmlkgnY0gmlwhKwS0nKKbXVsdGlhZGRyc4wACgSsEtJyBuG53QOCcnOFAAIBAAGJc2VjcDI1NmsxoQKvzmZTjC1U6lG4eR0u-kA_I8YRock6nY11ntec1bP89YN0Y3CC4biDdWRwguG6hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57783/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.54.41/tcp/32525/p2p/16Uiu2HAmL698B6AEbs3fXkudDzZHRnTNzZviPDYGwUnk2ux1XQNQ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32524/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57783/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32524/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32524/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726288258906558976,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57783/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726288258906558976,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 53927ac3ddff
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 697345671c64
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-14_04-30-54__8376d9d9-e406-42f2-8364-a1b43e566311__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-14_04-30-54__8376d9d9-e406-42f2-8364-a1b43e566311__wakuorg_nwaku:latest.log