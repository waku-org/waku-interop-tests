[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_filter_works_with_static_sharding with id: 2024-04-29_07-55-28__b6c38ac3-79f8-4d68-81c2-25716a5ba0ca
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:30 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/node1_2024-04-29_07-55-28__b6c38ac3-79f8-4d68-81c2-25716a5ba0ca__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.sharding:sharding.py:235 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.158.98
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['29180', '29181', '29182', '29183', '29184']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 29180:29180 -p 29181:29181 -p 29182:29182 -p 29183:29183 -p 29184:29184 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29182 --rest-port=29180 --tcp-port=29181 --discv5-udp-port=29183 --rest-address=0.0.0.0 --nat=extip:172.18.158.98 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29184 --metrics-logging=true --relay=true --filter=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68 --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.158.98 waku 643d003b7cd483a7c07d58ef8436a2a7242719c06c129831f0662f4d4964e2e1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 643d003b7cd4. Setting up logs at ./log/docker/node1_2024-04-29_07-55-28__b6c38ac3-79f8-4d68-81c2-25716a5ba0ca__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 29180
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29180/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.98/tcp/29181/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.158.98/tcp/29182/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QLpPjT0ON9oRhwNHEujdVJfqtj7u3N5d6CAfOXFjVUD9YqZrJOxVvfLJrFkwbLkfzzfqtKTFXLV6wpVHfk4MmnEBgmlkgnY0gmlwhKwSnmKKbXVsdGlhZGRyc4wACgSsEp5iBnH-3QOCcnOFAAIBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCcf2DdWRwgnH_hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/node2_2024-04-29_07-55-28__b6c38ac3-79f8-4d68-81c2-25716a5ba0ca__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.sharding:sharding.py:235 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.91.219
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['51797', '51798', '51799', '51800', '51801']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 51797:51797 -p 51798:51798 -p 51799:51799 -p 51800:51800 -p 51801:51801 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51799 --rest-port=51797 --tcp-port=51798 --discv5-udp-port=51800 --rest-address=0.0.0.0 --nat=extip:172.18.91.219 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51801 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QLpPjT0ON9oRhwNHEujdVJfqtj7u3N5d6CAfOXFjVUD9YqZrJOxVvfLJrFkwbLkfzzfqtKTFXLV6wpVHfk4MmnEBgmlkgnY0gmlwhKwSnmKKbXVsdGlhZGRyc4wACgSsEp5iBnH-3QOCcnOFAAIBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCcf2DdWRwgnH_hXdha3UyBQ --filternode=/ip4/172.18.158.98/tcp/29181/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.91.219 waku 250302f8166039c24144f97d0405cb6b3714917a6637f72589d4938da1b20ed1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 250302f81660. Setting up logs at ./log/docker/node2_2024-04-29_07-55-28__b6c38ac3-79f8-4d68-81c2-25716a5ba0ca__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 51797
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51797/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.91.219/tcp/51798/p2p/16Uiu2HAmBwNnQgk9StyGQLz2UyGKyt1ZRqLRtXdsZFDtyyCFFDM5","/ip4/172.18.91.219/tcp/51799/ws/p2p/16Uiu2HAmBwNnQgk9StyGQLz2UyGKyt1ZRqLRtXdsZFDtyyCFFDM5"],"enrUri":"enr:-LO4QBmb40I8PfLDCljPJyEV6QP3kPaSEa4WAnqU6EZMla7oBBVVvTiCMICO8FWuKVZAF_hLpivYPYdVBOZUIAeS-9UBgmlkgnY0gmlwhKwSW9uKbXVsdGlhZGRyc4wACgSsElvbBspX3QOCcnOFAAIBAACJc2VjcDI1NmsxoQL1VvigUYC14o6dOCfI-Au4MBf5-tRoo5GwzA_MGi0iLIN0Y3CCylaDdWRwgspYhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51797/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.158.98/tcp/29181/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29180/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51797/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "6113ad3f-7863-442c-b47d-1d7cd3bd3b90", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"6113ad3f-7863-442c-b47d-1d7cd3bd3b90","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29180/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:203 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51797/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1714377331627598592,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 643d003b7cd4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 250302f81660
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.