[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_same_shard with id: 2024-10-03_04-27-39__4e61592a-4f05-49c7-b6aa-95de0e72b67c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-03_04-27-39__4e61592a-4f05-49c7-b6aa-95de0e72b67c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.92.185
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['39068', '39069', '39070', '39071', '39072']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 39068:39068 -p 39069:39069 -p 39070:39070 -p 39071:39071 -p 39072:39072 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39070 --rest-port=39068 --tcp-port=39069 --discv5-udp-port=39071 --rest-address=0.0.0.0 --nat=extip:172.18.92.185 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=4bbd5da8cba62e56cb00e299d8a74c3a54be6dd7e0d314f5c8eafaecccff2fc9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39072 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.92.185 waku 5fe55e4ea91d32111061175d174624ca7afc0bbed0ee14d7ad6e97938030e486
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 5fe55e4ea91d. Setting up logs at ./log/docker/node1_2024-10-03_04-27-39__4e61592a-4f05-49c7-b6aa-95de0e72b67c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 39068
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39068/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39068/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.92.185/tcp/39069/p2p/16Uiu2HAm1DRyTc7QxXe3FEFa6AVtbbDxURPRUyjK3vTbAVdRMFpd","/ip4/172.18.92.185/tcp/39070/ws/p2p/16Uiu2HAm1DRyTc7QxXe3FEFa6AVtbbDxURPRUyjK3vTbAVdRMFpd"],"enrUri":"enr:-LO4QCidPtpVHwRUVCGoQizz26RvgQlMOM4XUMg3meGv7d_OAzYp2kcp66nLM2TkW2aXY4g1Svgq3VtbEoBvYqsY65IBgmlkgnY0gmlwhKwSXLmKbXVsdGlhZGRyc4wACgSsEly5Bpie3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJWA1DDzTb6NFhwgUlrxXKJG6RXxHGWajum1IWKK-QpYoN0Y3CCmJ2DdWRwgpifhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-03_04-27-39__4e61592a-4f05-49c7-b6aa-95de0e72b67c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.84.171
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['15001', '15002', '15003', '15004', '15005']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 15001:15001 -p 15002:15002 -p 15003:15003 -p 15004:15004 -p 15005:15005 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15003 --rest-port=15001 --tcp-port=15002 --discv5-udp-port=15004 --rest-address=0.0.0.0 --nat=extip:172.18.84.171 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=22efe2aab8cec730738bfe4dba5fec0b0dac2cd6fbb1fcbb8dd2eb4ef5eea9fd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15005 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QCidPtpVHwRUVCGoQizz26RvgQlMOM4XUMg3meGv7d_OAzYp2kcp66nLM2TkW2aXY4g1Svgq3VtbEoBvYqsY65IBgmlkgnY0gmlwhKwSXLmKbXVsdGlhZGRyc4wACgSsEly5Bpie3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJWA1DDzTb6NFhwgUlrxXKJG6RXxHGWajum1IWKK-QpYoN0Y3CCmJ2DdWRwgpifhXdha3UyBQ --pubsub-topic=/waku/2/rs/4/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.84.171 waku feaef66996da9ebefcd375308a125bff8f019c52916ff0ea754e17e4a9237b8e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID feaef66996da. Setting up logs at ./log/docker/node2_2024-10-03_04-27-39__4e61592a-4f05-49c7-b6aa-95de0e72b67c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 15001
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15001/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15001/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.84.171/tcp/15002/p2p/16Uiu2HAm4SFGQ5iACpEYdJJRsYj8qEqAQhgjbCHF7efAHPdb4ktW","/ip4/172.18.84.171/tcp/15003/ws/p2p/16Uiu2HAm4SFGQ5iACpEYdJJRsYj8qEqAQhgjbCHF7efAHPdb4ktW"],"enrUri":"enr:-LO4QOIcTaj8trS6PuaHJH-XWaLeAUz9B1bkhknRwinCGR0tE4_KmrkGOdbLvibbQBqi5PnJhdJaExpohOhVRAryJGQBgmlkgnY0gmlwhKwSVKuKbXVsdGlhZGRyc4wACgSsElSrBjqb3QOCcnOFAAQBAACJc2VjcDI1NmsxoQKF3tG760dFI12ZdEonINS1C2lxE8iP831VI2MPr1WwT4N0Y3CCOpqDdWRwgjqchXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15001/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.92.185/tcp/39069/p2p/16Uiu2HAm1DRyTc7QxXe3FEFa6AVtbbDxURPRUyjK3vTbAVdRMFpd"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39068/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15001/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39068/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39068/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727929663173313792,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15001/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:15001/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 5fe55e4ea91d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id feaef66996da
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.