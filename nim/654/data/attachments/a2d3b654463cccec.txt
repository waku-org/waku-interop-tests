2025-02-17 04:04:17.533 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:04:17.534 DEBUG [tests.conftest] Running test: test_publish_and_retrieve_duplicate_message with id: 2025-02-17_04-04-17__8aa8ba8f-4745-430b-b6fe-3910b2ab4e1f
2025-02-17 04:04:17.534 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:04:17.534 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-17 04:04:17.535 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-17 04:04:17.540 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:04:17.541 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_04-04-17__8aa8ba8f-4745-430b-b6fe-3910b2ab4e1f__wakuorg_nwaku:latest.log
2025-02-17 04:04:17.541 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:04:17.541 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:04:17.542 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:04:17.542 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.5.185
2025-02-17 04:04:17.542 DEBUG [src.node.docker_mananger] Generated ports ['42857', '42858', '42859', '42860', '42861']
2025-02-17 04:04:17.543 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:04:17.543 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:04:17.543 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:04:17.543 DEBUG [src.node.docker_mananger] docker run -i -t -p 42857:42857 -p 42858:42858 -p 42859:42859 -p 42860:42860 -p 42861:42861 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42859 --rest-port=42857 --tcp-port=42858 --discv5-udp-port=42860 --rest-address=0.0.0.0 --nat=extip:172.18.5.185 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a8bfde2b0b9e9ade8c06bcb49cbe4edef2b882a7ebd65db6cd1f1f0761be5b4d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42861 --metrics-logging=true --relay=true
2025-02-17 04:04:17.763 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.5.185 waku 7c5bfcb80456a914f6c36ecc7a0b5d7c3757c3a4c7dff9f0fa164fb3d414f4b9
2025-02-17 04:04:17.816 DEBUG [src.node.docker_mananger] Container started with ID 7c5bfcb80456. Setting up logs at ./log/docker/node1_2025-02-17_04-04-17__8aa8ba8f-4745-430b-b6fe-3910b2ab4e1f__wakuorg_nwaku:latest.log
2025-02-17 04:04:17.816 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42857
2025-02-17 04:04:17.817 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:04:18.335 ERROR [src.node.docker_mananger] Max retries reached for container c3cf1c2e130f. Exiting log stream.
2025-02-17 04:04:18.817 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42857/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:18.820 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:04:18.820 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:04:18.820 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42857/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:18.823 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.5.185/tcp/42858/p2p/16Uiu2HAmG3oocEusBsejxBdURrrKCzHqy2v1LJ8wecSWfyVNTUcC","/ip4/172.18.5.185/tcp/42859/ws/p2p/16Uiu2HAmG3oocEusBsejxBdURrrKCzHqy2v1LJ8wecSWfyVNTUcC"],"enrUri":"enr:-L24QISVtHNzclOduy3qad05GdPGnuRas0t27onlzKTNfBw2Plsah8dCC7ThB8RfprFs_RIjUs8KqNA5LeGZHFbAtBsCgmlkgnY0gmlwhKwSBbmKbXVsdGlhZGRyc5YACASsEgW5BqdqAAoErBIFuQana90DgnJzhQADAQAAiXNlY3AyNTZrMaEDMmt-pknAW8ajBJbeWnJ1I20zilkL9-GOmNGtVU5taqWDdGNwgqdqg3VkcIKnbIV3YWt1MgE"}'
2025-02-17 04:04:18.823 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:04:18.829 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:04:18.829 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_04-04-17__8aa8ba8f-4745-430b-b6fe-3910b2ab4e1f__wakuorg_nwaku:latest.log
2025-02-17 04:04:18.829 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:04:18.829 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:04:18.831 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:04:18.831 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.17.3
2025-02-17 04:04:18.831 DEBUG [src.node.docker_mananger] Generated ports ['33548', '33549', '33550', '33551', '33552']
2025-02-17 04:04:18.831 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:04:18.831 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:04:18.831 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:04:18.831 DEBUG [src.node.docker_mananger] docker run -i -t -p 33548:33548 -p 33549:33549 -p 33550:33550 -p 33551:33551 -p 33552:33552 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33550 --rest-port=33548 --tcp-port=33549 --discv5-udp-port=33551 --rest-address=0.0.0.0 --nat=extip:172.18.17.3 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6c7678f9f546e799ed325a64200f91e1fdd4add3b83ccef9c19dc4ba1ec04e89 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33552 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QISVtHNzclOduy3qad05GdPGnuRas0t27onlzKTNfBw2Plsah8dCC7ThB8RfprFs_RIjUs8KqNA5LeGZHFbAtBsCgmlkgnY0gmlwhKwSBbmKbXVsdGlhZGRyc5YACASsEgW5BqdqAAoErBIFuQana90DgnJzhQADAQAAiXNlY3AyNTZrMaEDMmt-pknAW8ajBJbeWnJ1I20zilkL9-GOmNGtVU5taqWDdGNwgqdqg3VkcIKnbIV3YWt1MgE
2025-02-17 04:04:19.053 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.17.3 waku c1ae279863f353220377439e042461bcb440ceef207999cc90bb8d71c5767e3e
2025-02-17 04:04:19.103 DEBUG [src.node.docker_mananger] Container started with ID c1ae279863f3. Setting up logs at ./log/docker/node2_2025-02-17_04-04-17__8aa8ba8f-4745-430b-b6fe-3910b2ab4e1f__wakuorg_nwaku:latest.log
2025-02-17 04:04:19.104 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33548
2025-02-17 04:04:19.104 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:04:20.108 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33548/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.114 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:04:20.114 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:04:20.114 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33548/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.116 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.17.3/tcp/33549/p2p/16Uiu2HAmC83AEXvdUuFpAYiyYGc7ZkfwEBnY2aSZBr8CLnKWhzRx","/ip4/172.18.17.3/tcp/33550/ws/p2p/16Uiu2HAmC83AEXvdUuFpAYiyYGc7ZkfwEBnY2aSZBr8CLnKWhzRx"],"enrUri":"enr:-L24QOUREkobJZAf5RudByxuuO4tYgooP29ndukJEXKHQFvCaaRxvmbGieXVqRPqRB3w3LAgTAbQ-6L62sP8vbKeLYECgmlkgnY0gmlwhKwSEQOKbXVsdGlhZGRyc5YACASsEhEDBoMNAAoErBIRAwaDDt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-BIr52BVfpeFIaYnHBKvUlxubMEab_mCuzh-oWpPXruDdGNwgoMNg3VkcIKDD4V3YWt1MgE"}'
2025-02-17 04:04:20.116 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:04:20.117 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33548/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.5.185/tcp/42858/p2p/16Uiu2HAmG3oocEusBsejxBdURrrKCzHqy2v1LJ8wecSWfyVNTUcC"]'
2025-02-17 04:04:20.119 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:20.120 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-17 04:04:20.120 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42857/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:04:20.124 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:20.124 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33548/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:04:20.129 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:20.130 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:20.135 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:20.135 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:04:20.236 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:20.236 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.239 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739765060129985536,"ephemeral":false,"proof":""}]'
2025-02-17 04:04:20.240 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:20.240 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33548/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.243 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739765060129985536,"ephemeral":false,"proof":""}]'
2025-02-17 04:04:20.244 INFO [src.steps.relay] WARM UP successful!!
2025-02-17 04:04:20.245 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:20.251 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:20.251 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:04:20.351 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:20.351 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.353 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739765060245453056,"ephemeral":false,"proof":""}]'
2025-02-17 04:04:20.355 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:20.355 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33548/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.357 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739765060245453056,"ephemeral":false,"proof":""}]'
2025-02-17 04:04:20.359 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:20.362 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:20.362 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:04:20.462 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:20.462 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.465 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739765060245453056,"ephemeral":false,"proof":""}]'
2025-02-17 04:04:20.466 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:20.466 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33548/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:20.468 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-17 04:04:20.471 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:04:20.472 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:04:20.472 DEBUG [src.node.waku_node] Stopping container with id 7c5bfcb80456
2025-02-17 04:04:21.300 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:04:21.300 DEBUG [src.node.waku_node] Stopping container with id c1ae279863f3
2025-02-17 04:04:22.112 ERROR [src.node.docker_mananger] Max retries reached for container 7c5bfcb80456. Exiting log stream.
2025-02-17 04:04:22.819 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:04:22.820 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:04:22.826 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:04:22.831 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
