2025-02-17 04:08:03.047 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:08:03.048 DEBUG [tests.conftest] Running test: test_main_node_relay_and_store__peer_only_store with id: 2025-02-17_04-08-03__c868c7b3-bfbf-4efb-9dca-7f3bbbb078bc
2025-02-17 04:08:03.048 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:08:03.048 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-17 04:08:03.056 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:08:03.056 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-17_04-08-03__c868c7b3-bfbf-4efb-9dca-7f3bbbb078bc__wakuorg_nwaku:latest.log
2025-02-17 04:08:03.056 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:08:03.056 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:08:03.058 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:08:03.058 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.85.134
2025-02-17 04:08:03.058 DEBUG [src.node.docker_mananger] Generated ports ['32028', '32029', '32030', '32031', '32032']
2025-02-17 04:08:03.058 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:08:03.058 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:08:03.059 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:08:03.059 DEBUG [src.node.docker_mananger] docker run -i -t -p 32028:32028 -p 32029:32029 -p 32030:32030 -p 32031:32031 -p 32032:32032 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32030 --rest-port=32028 --tcp-port=32029 --discv5-udp-port=32031 --rest-address=0.0.0.0 --nat=extip:172.18.85.134 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a5a4faea2cc5e4af14cfdb63c874e89b9fe18feeeec3d7faedfaa70432a2e9f9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32032 --metrics-logging=true --store=true --relay=true
2025-02-17 04:08:03.299 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.85.134 waku 8268c493229d7978bd6ac9b8e748ad0e39f0ca9722f9ba24e5d45f1b6d05e489
2025-02-17 04:08:03.349 DEBUG [src.node.docker_mananger] Container started with ID 8268c493229d. Setting up logs at ./log/docker/publishing_node1_2025-02-17_04-08-03__c868c7b3-bfbf-4efb-9dca-7f3bbbb078bc__wakuorg_nwaku:latest.log
2025-02-17 04:08:03.349 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 32028
2025-02-17 04:08:03.350 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:08:03.844 ERROR [src.node.docker_mananger] Max retries reached for container 8143245f3aa9. Exiting log stream.
2025-02-17 04:08:04.350 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32028/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:04.353 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:08:04.354 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:08:04.354 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32028/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:04.356 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.85.134/tcp/32029/p2p/16Uiu2HAkyGzSs3tHq9VxiyFqu8CwjyQvtQZjxEb5WH6RDrFrU1zi","/ip4/172.18.85.134/tcp/32030/ws/p2p/16Uiu2HAkyGzSs3tHq9VxiyFqu8CwjyQvtQZjxEb5WH6RDrFrU1zi"],"enrUri":"enr:-L24QJbPkaoWNxFGRFPIpIU-u74fSexi03PFMZxoeIZODFGlBS5hh_Oar6NnhxojXCkXVG4KzMc8A1GwrKuNhhld0xkCgmlkgnY0gmlwhKwSVYaKbXVsdGlhZGRyc5YACASsElWGBn0dAAoErBJVhgZ9Ht0DgnJzhQADAQAAiXNlY3AyNTZrMaECOTVmnB5w5tlo2hWmLS4y_57blKqtiDvIcOOdulrnUFuDdGNwgn0dg3VkcIJ9H4V3YWt1MgM"}'
2025-02-17 04:08:04.356 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:08:04.363 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:08:04.364 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-17_04-08-03__c868c7b3-bfbf-4efb-9dca-7f3bbbb078bc__wakuorg_nwaku:latest.log
2025-02-17 04:08:04.364 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:08:04.364 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:08:04.365 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:08:04.365 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.173.115
2025-02-17 04:08:04.366 DEBUG [src.node.docker_mananger] Generated ports ['29713', '29714', '29715', '29716', '29717']
2025-02-17 04:08:04.366 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:08:04.366 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:08:04.366 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:08:04.366 DEBUG [src.node.docker_mananger] docker run -i -t -p 29713:29713 -p 29714:29714 -p 29715:29715 -p 29716:29716 -p 29717:29717 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29715 --rest-port=29713 --tcp-port=29714 --discv5-udp-port=29716 --rest-address=0.0.0.0 --nat=extip:172.18.173.115 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fc28f82aeb9dfda2b96380eedd0be6eebf333eec0deaaccdb32171febee5a02d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29717 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QJbPkaoWNxFGRFPIpIU-u74fSexi03PFMZxoeIZODFGlBS5hh_Oar6NnhxojXCkXVG4KzMc8A1GwrKuNhhld0xkCgmlkgnY0gmlwhKwSVYaKbXVsdGlhZGRyc5YACASsElWGBn0dAAoErBJVhgZ9Ht0DgnJzhQADAQAAiXNlY3AyNTZrMaECOTVmnB5w5tlo2hWmLS4y_57blKqtiDvIcOOdulrnUFuDdGNwgn0dg3VkcIJ9H4V3YWt1MgM --storenode=/ip4/172.18.85.134/tcp/32029/p2p/16Uiu2HAkyGzSs3tHq9VxiyFqu8CwjyQvtQZjxEb5WH6RDrFrU1zi --store=true --relay=false
2025-02-17 04:08:04.601 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.173.115 waku a98bcb4fcd7b73da960c73ce2bfb2acb52bcbe387d183d4f556e690749c1f646
2025-02-17 04:08:04.659 DEBUG [src.node.docker_mananger] Container started with ID a98bcb4fcd7b. Setting up logs at ./log/docker/store_node1_2025-02-17_04-08-03__c868c7b3-bfbf-4efb-9dca-7f3bbbb078bc__wakuorg_nwaku:latest.log
2025-02-17 04:08:04.660 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29713
2025-02-17 04:08:04.661 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:08:05.661 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:05.665 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:08:05.665 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:08:05.665 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29713/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:05.667 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.173.115/tcp/29714/p2p/16Uiu2HAm7EVnskwMJLyKG5QpVbVTpv6zUq32du6Ngzz4CFjiN35J","/ip4/172.18.173.115/tcp/29715/ws/p2p/16Uiu2HAm7EVnskwMJLyKG5QpVbVTpv6zUq32du6Ngzz4CFjiN35J"],"enrUri":"enr:-L24QPWpv6r3eMqOoUw2tiy_QHPG7rHzqW49KF3OD4smQXl2dJU9MZckNig5JhPZY6X7VyXAxRS3hsHf0oT-iDcXlAsCgmlkgnY0gmlwhKwSrXOKbXVsdGlhZGRyc5YACASsEq1zBnQSAAoErBKtcwZ0E90DgnJzhQADAQAAiXNlY3AyNTZrMaECr29Vl4luBfDqR8S2sZrYdn9gbycAxua0c4Y7bv8oqFmDdGNwgnQSg3VkcIJ0FIV3YWt1MgI"}'
2025-02-17 04:08:05.667 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:08:05.668 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29713/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.85.134/tcp/32029/p2p/16Uiu2HAkyGzSs3tHq9VxiyFqu8CwjyQvtQZjxEb5WH6RDrFrU1zi"]'
2025-02-17 04:08:05.707 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:08:05.708 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32028/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:08:05.725 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:08:05.729 DEBUG [src.steps.store] Relaying message
2025-02-17 04:08:05.730 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32028/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:08:05.735 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:08:05.735 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:08:05.935 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-17 04:08:05.936 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32028/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:05.939 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-17 04:08:05.941 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:08:05.942 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:08:05.942 DEBUG [src.node.waku_node] Stopping container with id 8268c493229d
2025-02-17 04:08:06.555 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:08:06.555 DEBUG [src.node.waku_node] Stopping container with id a98bcb4fcd7b
2025-02-17 04:08:07.368 ERROR [src.node.docker_mananger] Max retries reached for container 8268c493229d. Exiting log stream.
2025-02-17 04:08:07.778 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:08:07.779 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:08:07.784 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:08:07.789 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
