2025-02-17 04:03:40.371 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:03:40.371 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_full with id: 2025-02-17_04-03-40__c5023faa-6523-4177-903e-402491de3cb1
2025-02-17 04:03:40.372 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:03:40.373 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-17 04:03:40.382 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:40.382 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-17_04-03-40__c5023faa-6523-4177-903e-402491de3cb1__wakuorg_nwaku:latest.log
2025-02-17 04:03:40.383 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:40.383 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:40.386 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:40.386 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.222.54
2025-02-17 04:03:40.387 DEBUG [src.node.docker_mananger] Generated ports ['8824', '8825', '8826', '8827', '8828']
2025-02-17 04:03:40.387 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:40.387 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:40.387 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:40.387 DEBUG [src.node.docker_mananger] docker run -i -t -p 8824:8824 -p 8825:8825 -p 8826:8826 -p 8827:8827 -p 8828:8828 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8826 --rest-port=8824 --tcp-port=8825 --discv5-udp-port=8827 --rest-address=0.0.0.0 --nat=extip:172.18.222.54 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3086e22a53acd1ea968cb9d1f8d0f43be1ef173bdaabdba8e5889d3f8acb8ecb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8828 --metrics-logging=true --lightpush=true --relay=true --filter=true
2025-02-17 04:03:40.617 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.222.54 waku f8872d14b8766b295c30ba3c83cf1391d4333313677b9fb2873c1772327240c1
2025-02-17 04:03:40.665 DEBUG [src.node.docker_mananger] Container started with ID f8872d14b876. Setting up logs at ./log/docker/receiving_node1_2025-02-17_04-03-40__c5023faa-6523-4177-903e-402491de3cb1__wakuorg_nwaku:latest.log
2025-02-17 04:03:40.665 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8824
2025-02-17 04:03:40.666 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:41.204 ERROR [src.node.docker_mananger] Max retries reached for container 1b2768866646. Exiting log stream.
2025-02-17 04:03:41.667 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8824/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:41.670 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:41.670 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:41.671 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8824/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:41.673 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.222.54/tcp/8825/p2p/16Uiu2HAmHP6nW9cdyBfvTTVYFjbdj7C3iLajnykMjW1EqX1jfoxb","/ip4/172.18.222.54/tcp/8826/ws/p2p/16Uiu2HAmHP6nW9cdyBfvTTVYFjbdj7C3iLajnykMjW1EqX1jfoxb"],"enrUri":"enr:-L24QAOIOwAsY5-WbEo9jZG-iWsRConzucvrjjnoGrJa-h04dekWzK-Wy88etVwzqDVlzjYHtUx_OjFt7AMR4DEZRlUCgmlkgnY0gmlwhKwS3jaKbXVsdGlhZGRyc5YACASsEt42BiJ5AAoErBLeNgYiet0DgnJzhQADAQAAiXNlY3AyNTZrMaEDRjhq3YTnh8d7m2BclqttUeOHEyqZKWIqPjAsrWQWVCCDdGNwgiJ5g3VkcIIie4V3YWt1Mg0"}'
2025-02-17 04:03:41.673 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:41.679 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:41.679 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-17_04-03-40__c5023faa-6523-4177-903e-402491de3cb1__wakuorg_nwaku:latest.log
2025-02-17 04:03:41.679 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:41.680 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:41.681 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:41.681 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.103.159
2025-02-17 04:03:41.681 DEBUG [src.node.docker_mananger] Generated ports ['60056', '60057', '60058', '60059', '60060']
2025-02-17 04:03:41.681 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:41.681 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:41.681 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:41.682 DEBUG [src.node.docker_mananger] docker run -i -t -p 60056:60056 -p 60057:60057 -p 60058:60058 -p 60059:60059 -p 60060:60060 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60058 --rest-port=60056 --tcp-port=60057 --discv5-udp-port=60059 --rest-address=0.0.0.0 --nat=extip:172.18.103.159 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6f5cf8cdf85e2c650ca2e2ed629f1233d1dadcfefdada6fbfeaf39c4c6dd0d2b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60060 --metrics-logging=true --lightpush=false --relay=true
2025-02-17 04:03:41.917 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.103.159 waku cf08873cb8609cf92a848a928f42453d860915ae7bb9aef2e0d48f816926008f
2025-02-17 04:03:41.969 DEBUG [src.node.docker_mananger] Container started with ID cf08873cb860. Setting up logs at ./log/docker/receiving_node2_2025-02-17_04-03-40__c5023faa-6523-4177-903e-402491de3cb1__wakuorg_nwaku:latest.log
2025-02-17 04:03:41.969 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60056
2025-02-17 04:03:41.970 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:42.971 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60056/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:42.974 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:42.974 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:42.974 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60056/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:42.976 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.103.159/tcp/60057/p2p/16Uiu2HAm9jo3pexSXJ9qC1yh75jFNbQTQKaeQBYsGp8rpS5mbo8h","/ip4/172.18.103.159/tcp/60058/ws/p2p/16Uiu2HAm9jo3pexSXJ9qC1yh75jFNbQTQKaeQBYsGp8rpS5mbo8h"],"enrUri":"enr:-L24QGF2LTx3UXTZF5AzsfliXrITFbBKo0X69LgY9PpWtgaKDDCJ_tcRT2lJyg3fvCPLo1vMc-6HvDsbbzSOalT_VF4CgmlkgnY0gmlwhKwSZ5-KbXVsdGlhZGRyc5YACASsEmefBuqZAAoErBJnnwbqmt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC1KgQo-fy7NFdRaxgvWLxw3VndMbfDn27yK0MhFDYUYaDdGNwguqZg3VkcILqm4V3YWt1MgE"}'
2025-02-17 04:03:42.977 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:42.977 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60056/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.222.54/tcp/8825/p2p/16Uiu2HAmHP6nW9cdyBfvTTVYFjbdj7C3iLajnykMjW1EqX1jfoxb"]'
2025-02-17 04:03:43.021 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:43.034 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:43.034 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-17_04-03-40__c5023faa-6523-4177-903e-402491de3cb1__wakuorg_nwaku:latest.log
2025-02-17 04:03:43.034 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:43.034 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:43.036 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:43.036 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.70.180
2025-02-17 04:03:43.036 DEBUG [src.node.docker_mananger] Generated ports ['57630', '57631', '57632', '57633', '57634']
2025-02-17 04:03:43.036 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:43.036 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:43.037 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:43.037 DEBUG [src.node.docker_mananger] docker run -i -t -p 57630:57630 -p 57631:57631 -p 57632:57632 -p 57633:57633 -p 57634:57634 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57632 --rest-port=57630 --tcp-port=57631 --discv5-udp-port=57633 --rest-address=0.0.0.0 --nat=extip:172.18.70.180 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=de069b02a2b8b7af1b0efbd98be7dc8c7bfbddfefbeaebc043fbbe6e0df0518c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57634 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QAOIOwAsY5-WbEo9jZG-iWsRConzucvrjjnoGrJa-h04dekWzK-Wy88etVwzqDVlzjYHtUx_OjFt7AMR4DEZRlUCgmlkgnY0gmlwhKwS3jaKbXVsdGlhZGRyc5YACASsEt42BiJ5AAoErBLeNgYiet0DgnJzhQADAQAAiXNlY3AyNTZrMaEDRjhq3YTnh8d7m2BclqttUeOHEyqZKWIqPjAsrWQWVCCDdGNwgiJ5g3VkcIIie4V3YWt1Mg0 --lightpushnode=/ip4/172.18.222.54/tcp/8825/p2p/16Uiu2HAmHP6nW9cdyBfvTTVYFjbdj7C3iLajnykMjW1EqX1jfoxb --lightpush=true --relay=false
2025-02-17 04:03:43.290 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.70.180 waku e912ae83f120e44402ecfaa8561dfbf63d1e3f4d27f2d4f9fb5f339d244312f9
2025-02-17 04:03:43.342 DEBUG [src.node.docker_mananger] Container started with ID e912ae83f120. Setting up logs at ./log/docker/lightpush_node1_2025-02-17_04-03-40__c5023faa-6523-4177-903e-402491de3cb1__wakuorg_nwaku:latest.log
2025-02-17 04:03:43.343 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57630
2025-02-17 04:03:43.344 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:44.344 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57630/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:44.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:44.347 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:44.347 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57630/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:44.349 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.70.180/tcp/57631/p2p/16Uiu2HAm3bnHGuXWbAcTCyZ6dfHpLY8NS4uWGzpJMCvhjKEFWHcJ","/ip4/172.18.70.180/tcp/57632/ws/p2p/16Uiu2HAm3bnHGuXWbAcTCyZ6dfHpLY8NS4uWGzpJMCvhjKEFWHcJ"],"enrUri":"enr:-L24QES4iDnSRJPhnkjKT9r8yX5Q8KBDgY6HQdKrj5g9-ZvsNftEWOeEUBV5iLVlBUIl_8A4lVq5aZA8z9X5s2a7QBYCgmlkgnY0gmlwhKwSRrSKbXVsdGlhZGRyc5YACASsEka0BuEfAAoErBJGtAbhIN0DgnJzhQADAQAAiXNlY3AyNTZrMaECeXRts7wEjq3RtICzDM_6oK7nDe_MXDbO-CRBCya50EeDdGNwguEfg3VkcILhIYV3YWt1Mgg"}'
2025-02-17 04:03:44.349 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:44.350 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57630/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.222.54/tcp/8825/p2p/16Uiu2HAmHP6nW9cdyBfvTTVYFjbdj7C3iLajnykMjW1EqX1jfoxb"]'
2025-02-17 04:03:44.389 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:44.391 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57630/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.103.159/tcp/60057/p2p/16Uiu2HAm9jo3pexSXJ9qC1yh75jFNbQTQKaeQBYsGp8rpS5mbo8h"]'
2025-02-17 04:03:44.418 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:44.419 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8824/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:03:44.427 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:44.427 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60056/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:03:44.433 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:44.434 DEBUG [src.steps.light_push] Lightpushing message
2025-02-17 04:03:44.435 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57630/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739765024434515200}}'
2025-02-17 04:03:44.445 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:44.446 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:03:44.546 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 04:03:44.546 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8824/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:44.549 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765024434515200,"ephemeral":false,"proof":""}]'
2025-02-17 04:03:44.550 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 04:03:44.551 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60056/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:44.553 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765024434515200,"ephemeral":false,"proof":""}]'
2025-02-17 04:03:44.555 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:03:44.556 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:03:44.556 DEBUG [src.node.waku_node] Stopping container with id f8872d14b876
2025-02-17 04:03:45.172 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:45.174 DEBUG [src.node.waku_node] Stopping container with id cf08873cb860
2025-02-17 04:03:46.006 ERROR [src.node.docker_mananger] Max retries reached for container f8872d14b876. Exiting log stream.
2025-02-17 04:03:46.697 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:46.698 DEBUG [src.node.waku_node] Stopping container with id e912ae83f120
2025-02-17 04:03:47.509 ERROR [src.node.docker_mananger] Max retries reached for container cf08873cb860. Exiting log stream.
2025-02-17 04:03:48.179 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:48.180 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:03:48.194 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:03:48.202 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:03:48.208 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
