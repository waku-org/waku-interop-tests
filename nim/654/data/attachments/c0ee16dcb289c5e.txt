2025-02-17 04:04:12.229 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:04:12.229 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-17_04-04-12__e420c688-2b23-4fab-b5ac-d925b2a5c64d
2025-02-17 04:04:12.230 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:04:12.230 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-17 04:04:12.230 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-17 04:04:12.236 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:04:12.236 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_04-04-12__e420c688-2b23-4fab-b5ac-d925b2a5c64d__wakuorg_nwaku:latest.log
2025-02-17 04:04:12.236 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:04:12.236 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:04:12.238 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:04:12.238 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.74.145
2025-02-17 04:04:12.238 DEBUG [src.node.docker_mananger] Generated ports ['43931', '43932', '43933', '43934', '43935']
2025-02-17 04:04:12.238 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:04:12.238 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:04:12.238 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:04:12.238 DEBUG [src.node.docker_mananger] docker run -i -t -p 43931:43931 -p 43932:43932 -p 43933:43933 -p 43934:43934 -p 43935:43935 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43933 --rest-port=43931 --tcp-port=43932 --discv5-udp-port=43934 --rest-address=0.0.0.0 --nat=extip:172.18.74.145 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2ccd6dafdb0949bafcebc87009f2bd8c8cef8f6f65f9c1624c5ffeac732b6d87 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43935 --metrics-logging=true --relay=true
2025-02-17 04:04:12.467 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.74.145 waku d29b140e9353890cf265dcf11aa3696742fa5d7264758489c314b17f57848334
2025-02-17 04:04:12.515 DEBUG [src.node.docker_mananger] Container started with ID d29b140e9353. Setting up logs at ./log/docker/node1_2025-02-17_04-04-12__e420c688-2b23-4fab-b5ac-d925b2a5c64d__wakuorg_nwaku:latest.log
2025-02-17 04:04:12.516 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 43931
2025-02-17 04:04:12.517 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:04:13.014 ERROR [src.node.docker_mananger] Max retries reached for container 3c22f6c0c2f0. Exiting log stream.
2025-02-17 04:04:13.517 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43931/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:13.520 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:04:13.520 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:04:13.520 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43931/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:13.523 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.74.145/tcp/43932/p2p/16Uiu2HAmRzpWjLFsanMu2eFb6RhT7e35TWL1abNzrSUrzcMrCnSm","/ip4/172.18.74.145/tcp/43933/ws/p2p/16Uiu2HAmRzpWjLFsanMu2eFb6RhT7e35TWL1abNzrSUrzcMrCnSm"],"enrUri":"enr:-L24QPiFiQjIK9xs2pdK3JVOV2AXZtNUgcddYftsiiMZx-p5Iq94hpc5CA9DTrVinSSKKFLZtS54K1epp26is3WU_BYCgmlkgnY0gmlwhKwSSpGKbXVsdGlhZGRyc5YACASsEkqRBqucAAoErBJKkQarnd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDxjxsWShhN1VXna0Pcit5sBbiRkIRTQs8afG5ezFiobKDdGNwgqucg3VkcIKrnoV3YWt1MgE"}'
2025-02-17 04:04:13.523 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:04:13.529 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:04:13.529 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_04-04-12__e420c688-2b23-4fab-b5ac-d925b2a5c64d__wakuorg_nwaku:latest.log
2025-02-17 04:04:13.529 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:04:13.529 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:04:13.531 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:04:13.531 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.120.10
2025-02-17 04:04:13.531 DEBUG [src.node.docker_mananger] Generated ports ['51677', '51678', '51679', '51680', '51681']
2025-02-17 04:04:13.531 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:04:13.531 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:04:13.531 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:04:13.531 DEBUG [src.node.docker_mananger] docker run -i -t -p 51677:51677 -p 51678:51678 -p 51679:51679 -p 51680:51680 -p 51681:51681 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51679 --rest-port=51677 --tcp-port=51678 --discv5-udp-port=51680 --rest-address=0.0.0.0 --nat=extip:172.18.120.10 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d9bd3de7d763da9f3af52cbfbcb5de930fe24e746cfcff62dc632cec05be0ccc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51681 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QPiFiQjIK9xs2pdK3JVOV2AXZtNUgcddYftsiiMZx-p5Iq94hpc5CA9DTrVinSSKKFLZtS54K1epp26is3WU_BYCgmlkgnY0gmlwhKwSSpGKbXVsdGlhZGRyc5YACASsEkqRBqucAAoErBJKkQarnd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDxjxsWShhN1VXna0Pcit5sBbiRkIRTQs8afG5ezFiobKDdGNwgqucg3VkcIKrnoV3YWt1MgE
2025-02-17 04:04:13.759 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.120.10 waku c3cf1c2e130ffc1efec6070795b9565c551f24b2660116fc087da1ebe5d71efd
2025-02-17 04:04:13.806 DEBUG [src.node.docker_mananger] Container started with ID c3cf1c2e130f. Setting up logs at ./log/docker/node2_2025-02-17_04-04-12__e420c688-2b23-4fab-b5ac-d925b2a5c64d__wakuorg_nwaku:latest.log
2025-02-17 04:04:13.806 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 51677
2025-02-17 04:04:13.807 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:04:14.807 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51677/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:14.820 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:04:14.824 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:04:14.824 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51677/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:14.829 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.120.10/tcp/51678/p2p/16Uiu2HAkycNxpCQKLdYE43Nypo1u7hnGzEsKasTzUjBsqYT1NAQU","/ip4/172.18.120.10/tcp/51679/ws/p2p/16Uiu2HAkycNxpCQKLdYE43Nypo1u7hnGzEsKasTzUjBsqYT1NAQU"],"enrUri":"enr:-L24QMhK29ViN7CQK1ygnc-xRVFjD3g3o3BiKaQtihNsl-56BAz3MPd-pYxMhqCXCf1-8fGlJ0G6FG0mC-3h6eq2QnsCgmlkgnY0gmlwhKwSeAqKbXVsdGlhZGRyc5YACASsEngKBsneAAoErBJ4CgbJ390DgnJzhQADAQAAiXNlY3AyNTZrMaECPizlQ1ysjLTq6pCG-FtVb7QjLQpTtIsE7waXd65dMt2DdGNwgsneg3VkcILJ4IV3YWt1MgE"}'
2025-02-17 04:04:14.829 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:04:14.829 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:51677/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.74.145/tcp/43932/p2p/16Uiu2HAmRzpWjLFsanMu2eFb6RhT7e35TWL1abNzrSUrzcMrCnSm"]'
2025-02-17 04:04:14.832 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:14.832 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-17 04:04:14.832 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43931/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:04:14.836 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:14.836 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:51677/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:04:14.841 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:14.842 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:14.849 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:14.850 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:04:14.950 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:14.950 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:14.953 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739765054842606848,"ephemeral":false,"proof":""}]'
2025-02-17 04:04:14.954 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:04:14.954 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51677/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:14.956 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739765054842606848,"ephemeral":false,"proof":""}]'
2025-02-17 04:04:14.958 INFO [src.steps.relay] WARM UP successful!!
2025-02-17 04:04:14.959 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-17 04:04:14.959 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:14.961 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 04:04:14.961 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-17 04:04:14.962 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:14.964 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 04:04:14.964 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-17 04:04:14.965 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:14.967 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 04:04:14.967 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-17 04:04:14.967 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:14.970 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 04:04:14.970 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-17 04:04:14.970 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:14.972 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:43931/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 04:04:14.974 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:04:14.975 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:04:14.975 DEBUG [src.node.waku_node] Stopping container with id d29b140e9353
2025-02-17 04:04:16.012 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:04:16.012 DEBUG [src.node.waku_node] Stopping container with id c3cf1c2e130f
2025-02-17 04:04:16.826 ERROR [src.node.docker_mananger] Max retries reached for container d29b140e9353. Exiting log stream.
2025-02-17 04:04:17.519 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:04:17.519 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:04:17.525 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:04:17.531 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
