2025-02-17 04:03:32.558 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:03:32.558 DEBUG [tests.conftest] Running test: test_light_push_with_no_timestamp with id: 2025-02-17_04-03-32__e4b18d05-8601-4874-a13c-56bb0cbe5426
2025-02-17 04:03:32.559 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:03:32.559 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-17 04:03:32.565 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:32.565 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-17_04-03-32__e4b18d05-8601-4874-a13c-56bb0cbe5426__wakuorg_nwaku:latest.log
2025-02-17 04:03:32.565 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:32.565 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:32.567 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:32.567 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.214.43
2025-02-17 04:03:32.567 DEBUG [src.node.docker_mananger] Generated ports ['37687', '37688', '37689', '37690', '37691']
2025-02-17 04:03:32.567 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:32.567 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:32.567 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:32.568 DEBUG [src.node.docker_mananger] docker run -i -t -p 37687:37687 -p 37688:37688 -p 37689:37689 -p 37690:37690 -p 37691:37691 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37689 --rest-port=37687 --tcp-port=37688 --discv5-udp-port=37690 --rest-address=0.0.0.0 --nat=extip:172.18.214.43 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=beffebe6426db1e39b98defbc0fdde8c32aee18a23c15ec5397ecdd9f72b7f1f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37691 --metrics-logging=true --lightpush=true --relay=true
2025-02-17 04:03:32.790 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.214.43 waku 93bf63708159928639e60d9d67fb830e25ca9857e4f6aea6668c201b4bdb6d91
2025-02-17 04:03:32.841 DEBUG [src.node.docker_mananger] Container started with ID 93bf63708159. Setting up logs at ./log/docker/receiving_node1_2025-02-17_04-03-32__e4b18d05-8601-4874-a13c-56bb0cbe5426__wakuorg_nwaku:latest.log
2025-02-17 04:03:32.842 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 37687
2025-02-17 04:03:32.842 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:33.364 ERROR [src.node.docker_mananger] Max retries reached for container 29ac80c96dcc. Exiting log stream.
2025-02-17 04:03:33.842 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37687/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:33.845 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:33.846 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:33.846 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37687/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:33.848 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.43/tcp/37688/p2p/16Uiu2HAmBoHDfrH2KmmDWQgxpXjUJXWmszeq8Nptn8cuBi9nKdoa","/ip4/172.18.214.43/tcp/37689/ws/p2p/16Uiu2HAmBoHDfrH2KmmDWQgxpXjUJXWmszeq8Nptn8cuBi9nKdoa"],"enrUri":"enr:-L24QFARthzNqPACRSH9Q4ileBdiezEAaQsIE_Er9PlIEK3YLyOSBvH5Cd2tk-fyCSmEPs74ZfnvuL-t9e-7GS5ozu8CgmlkgnY0gmlwhKwS1iuKbXVsdGlhZGRyc5YACASsEtYrBpM4AAoErBLWKwaTOd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC80QIcM6og_xgDOBvKl0GSfXGr8uxPM-lQ0dRy82ykn2DdGNwgpM4g3VkcIKTOoV3YWt1Mgk"}'
2025-02-17 04:03:33.848 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:33.854 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:33.855 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-17_04-03-32__e4b18d05-8601-4874-a13c-56bb0cbe5426__wakuorg_nwaku:latest.log
2025-02-17 04:03:33.855 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:33.855 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:33.856 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:33.856 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.123.94
2025-02-17 04:03:33.856 DEBUG [src.node.docker_mananger] Generated ports ['58052', '58053', '58054', '58055', '58056']
2025-02-17 04:03:33.857 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:33.857 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:33.857 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:33.857 DEBUG [src.node.docker_mananger] docker run -i -t -p 58052:58052 -p 58053:58053 -p 58054:58054 -p 58055:58055 -p 58056:58056 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58054 --rest-port=58052 --tcp-port=58053 --discv5-udp-port=58055 --rest-address=0.0.0.0 --nat=extip:172.18.123.94 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=abf31d2bfc3bcb055e0ccaf3d1cbc20ecf3f82def2bb681c6217e4d2a7caf77c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58056 --metrics-logging=true --lightpush=false --relay=true
2025-02-17 04:03:34.101 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.123.94 waku a339a299c629f1f3e9ef4211ea99c524dd6c2ecd14afc337fed0755f8c268fa5
2025-02-17 04:03:34.147 DEBUG [src.node.docker_mananger] Container started with ID a339a299c629. Setting up logs at ./log/docker/receiving_node2_2025-02-17_04-03-32__e4b18d05-8601-4874-a13c-56bb0cbe5426__wakuorg_nwaku:latest.log
2025-02-17 04:03:34.147 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58052
2025-02-17 04:03:34.148 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:35.148 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58052/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:35.151 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:35.151 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:35.151 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58052/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:35.153 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.123.94/tcp/58053/p2p/16Uiu2HAmJYc2RcvrKmrhyNzgHbF4qFCxrwhzHg2RTKMWBoW7etZy","/ip4/172.18.123.94/tcp/58054/ws/p2p/16Uiu2HAmJYc2RcvrKmrhyNzgHbF4qFCxrwhzHg2RTKMWBoW7etZy"],"enrUri":"enr:-L24QNyC85gpses2gFburfccnRenNHmwBVH5NS_yI1R8yUPeVIecjOrCnPx3j2c1Pky40KU4l7M4A4Pif7LrOwDHt10CgmlkgnY0gmlwhKwSe16KbXVsdGlhZGRyc5YACASsEnteBuLFAAoErBJ7Xgbixt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDV4NkueG7OUBvZdJ16eOnVnWrU0T9dKdlC1nCoBMctGyDdGNwguLFg3VkcILix4V3YWt1MgE"}'
2025-02-17 04:03:35.153 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:35.154 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58052/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.214.43/tcp/37688/p2p/16Uiu2HAmBoHDfrH2KmmDWQgxpXjUJXWmszeq8Nptn8cuBi9nKdoa"]'
2025-02-17 04:03:35.194 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:35.201 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:35.201 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-17_04-03-32__e4b18d05-8601-4874-a13c-56bb0cbe5426__wakuorg_nwaku:latest.log
2025-02-17 04:03:35.201 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:35.201 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:35.203 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:35.203 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.70.92
2025-02-17 04:03:35.203 DEBUG [src.node.docker_mananger] Generated ports ['13135', '13136', '13137', '13138', '13139']
2025-02-17 04:03:35.203 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:35.203 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:35.203 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:35.203 DEBUG [src.node.docker_mananger] docker run -i -t -p 13135:13135 -p 13136:13136 -p 13137:13137 -p 13138:13138 -p 13139:13139 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13137 --rest-port=13135 --tcp-port=13136 --discv5-udp-port=13138 --rest-address=0.0.0.0 --nat=extip:172.18.70.92 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7b0fb136ceb53fdfe3c69b57abcd2da54be83ceaf123fac0ca0bcbc0d69ee7fd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13139 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QFARthzNqPACRSH9Q4ileBdiezEAaQsIE_Er9PlIEK3YLyOSBvH5Cd2tk-fyCSmEPs74ZfnvuL-t9e-7GS5ozu8CgmlkgnY0gmlwhKwS1iuKbXVsdGlhZGRyc5YACASsEtYrBpM4AAoErBLWKwaTOd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC80QIcM6og_xgDOBvKl0GSfXGr8uxPM-lQ0dRy82ykn2DdGNwgpM4g3VkcIKTOoV3YWt1Mgk --lightpushnode=/ip4/172.18.214.43/tcp/37688/p2p/16Uiu2HAmBoHDfrH2KmmDWQgxpXjUJXWmszeq8Nptn8cuBi9nKdoa --lightpush=true --relay=false
2025-02-17 04:03:35.438 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.70.92 waku 1b2768866646b196cb72d79883f369c90746e1e87d0e6457af902239a83d0b6b
2025-02-17 04:03:35.482 DEBUG [src.node.docker_mananger] Container started with ID 1b2768866646. Setting up logs at ./log/docker/lightpush_node1_2025-02-17_04-03-32__e4b18d05-8601-4874-a13c-56bb0cbe5426__wakuorg_nwaku:latest.log
2025-02-17 04:03:35.483 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 13135
2025-02-17 04:03:35.484 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:36.484 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13135/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:36.487 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:36.488 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:36.488 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13135/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:36.490 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.70.92/tcp/13136/p2p/16Uiu2HAmJZSvhVbZv5nzYqZY7TFafjkCkceBBKsLVzByxcAQAjhb","/ip4/172.18.70.92/tcp/13137/ws/p2p/16Uiu2HAmJZSvhVbZv5nzYqZY7TFafjkCkceBBKsLVzByxcAQAjhb"],"enrUri":"enr:-L24QGF37bExtDno_6IBIZ7DE0vaVF-yRRt4-4-IdVdi4o93Yh6KgCPZ-XdeLfukTGZ3buhrKoleN8WkAZVraAHqlNACgmlkgnY0gmlwhKwSRlyKbXVsdGlhZGRyc5YACASsEkZcBjNQAAoErBJGXAYzUd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDV7qvsZ7-aARi41bJFd2ZRGXg8qzx0mvyaxXthgAWF9KDdGNwgjNQg3VkcIIzUoV3YWt1Mgg"}'
2025-02-17 04:03:36.490 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:36.490 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13135/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.214.43/tcp/37688/p2p/16Uiu2HAmBoHDfrH2KmmDWQgxpXjUJXWmszeq8Nptn8cuBi9nKdoa"]'
2025-02-17 04:03:36.522 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:36.523 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13135/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.123.94/tcp/58053/p2p/16Uiu2HAmJYc2RcvrKmrhyNzgHbF4qFCxrwhzHg2RTKMWBoW7etZy"]'
2025-02-17 04:03:36.557 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:36.558 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37687/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:03:36.563 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:36.565 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58052/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:03:36.569 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:36.570 DEBUG [src.steps.light_push] Lightpushing message
2025-02-17 04:03:36.571 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13135/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto"}}'
2025-02-17 04:03:36.580 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:36.580 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:03:36.682 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 04:03:36.682 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37687/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:36.684 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765016573817856,"ephemeral":false,"proof":""}]'
2025-02-17 04:03:36.686 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 04:03:36.686 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58052/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:36.688 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765016573817856,"ephemeral":false,"proof":""}]'
2025-02-17 04:03:36.691 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:03:36.692 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:03:36.692 DEBUG [src.node.waku_node] Stopping container with id 93bf63708159
2025-02-17 04:03:37.328 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:37.328 DEBUG [src.node.waku_node] Stopping container with id a339a299c629
2025-02-17 04:03:38.139 ERROR [src.node.docker_mananger] Max retries reached for container 93bf63708159. Exiting log stream.
2025-02-17 04:03:38.829 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:38.830 DEBUG [src.node.waku_node] Stopping container with id 1b2768866646
2025-02-17 04:03:39.641 ERROR [src.node.docker_mananger] Max retries reached for container a339a299c629. Exiting log stream.
2025-02-17 04:03:40.338 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:40.341 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:03:40.348 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:03:40.356 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:03:40.363 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
