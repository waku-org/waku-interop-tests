2025-02-17 04:03:10.703 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:03:10.703 DEBUG [tests.conftest] Running test: test_relay_receiving_node_not_connected_directly_to_lightpushing_node with id: 2025-02-17_04-03-10__00725156-454d-4d10-9a49-81476e87e3e1
2025-02-17 04:03:10.704 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:03:10.704 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-17 04:03:10.705 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-17 04:03:10.713 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:10.713 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_04-03-10__00725156-454d-4d10-9a49-81476e87e3e1__wakuorg_nwaku:latest.log
2025-02-17 04:03:10.721 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:10.722 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_04-03-10__00725156-454d-4d10-9a49-81476e87e3e1__wakuorg_nwaku:latest.log
2025-02-17 04:03:10.730 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:03:10.730 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-17_04-03-10__00725156-454d-4d10-9a49-81476e87e3e1__wakuorg_nwaku:latest.log
2025-02-17 04:03:10.730 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-17 04:03:10.731 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-17 04:03:10.732 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:10.733 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:10.736 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:10.736 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.187.31
2025-02-17 04:03:10.736 DEBUG [src.node.docker_mananger] Generated ports ['60673', '60674', '60675', '60676', '60677']
2025-02-17 04:03:10.737 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:10.737 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:10.737 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:10.738 DEBUG [src.node.docker_mananger] docker run -i -t -p 60673:60673 -p 60674:60674 -p 60675:60675 -p 60676:60676 -p 60677:60677 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60675 --rest-port=60673 --tcp-port=60674 --discv5-udp-port=60676 --rest-address=0.0.0.0 --nat=extip:172.18.187.31 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2baeb49b2afdcc05f32837c3cff30ec93300dfaa86cfb37abf6fce6e4f4734cb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60677 --metrics-logging=true --lightpush=true --relay=true
2025-02-17 04:03:10.976 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.187.31 waku bf8f3ded8dc92400a40d1a88cdbedb533e951cefa5ae843ca153e3140ed95596
2025-02-17 04:03:11.025 DEBUG [src.node.docker_mananger] Container started with ID bf8f3ded8dc9. Setting up logs at ./log/docker/node1_2025-02-17_04-03-10__00725156-454d-4d10-9a49-81476e87e3e1__wakuorg_nwaku:latest.log
2025-02-17 04:03:11.026 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60673
2025-02-17 04:03:11.027 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:11.600 ERROR [src.node.docker_mananger] Max retries reached for container 6fe231e22a09. Exiting log stream.
2025-02-17 04:03:12.027 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60673/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:12.030 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:12.030 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:12.031 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60673/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:12.033 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.187.31/tcp/60674/p2p/16Uiu2HAm8imy4JdgsXyz4z5LAqrap5NjuQeC4oVC1kgtznqtYuGA","/ip4/172.18.187.31/tcp/60675/ws/p2p/16Uiu2HAm8imy4JdgsXyz4z5LAqrap5NjuQeC4oVC1kgtznqtYuGA"],"enrUri":"enr:-L24QGgHIKCHLW0ORymhUHE9HwSJfYadRWK0x2SRQR0EoQTyLzigNkyUMRajjQ0w1N8c1zE_weXvQqwRWNBSO6iuCr0CgmlkgnY0gmlwhKwSux-KbXVsdGlhZGRyc5YACASsErsfBu0CAAoErBK7HwbtA90DgnJzhQADAQAAiXNlY3AyNTZrMaECxYmS3GRSvla2b4v6Gr85f4tKb-EEsUeW15Kb0eJGloeDdGNwgu0Cg3VkcILtBIV3YWt1Mgk"}'
2025-02-17 04:03:12.033 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:12.034 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:12.034 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:12.035 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:12.035 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.182.106
2025-02-17 04:03:12.036 DEBUG [src.node.docker_mananger] Generated ports ['45666', '45667', '45668', '45669', '45670']
2025-02-17 04:03:12.036 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:12.036 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:12.036 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:12.036 DEBUG [src.node.docker_mananger] docker run -i -t -p 45666:45666 -p 45667:45667 -p 45668:45668 -p 45669:45669 -p 45670:45670 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45668 --rest-port=45666 --tcp-port=45667 --discv5-udp-port=45669 --rest-address=0.0.0.0 --nat=extip:172.18.182.106 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=18ffa91173e89feae0cc595bfbd6b3edd89507e8b4fb70be6bd7ef0bb6a1c414 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45670 --metrics-logging=true --lightpush=true --relay=true --discv5-bootstrap-node=enr:-L24QGgHIKCHLW0ORymhUHE9HwSJfYadRWK0x2SRQR0EoQTyLzigNkyUMRajjQ0w1N8c1zE_weXvQqwRWNBSO6iuCr0CgmlkgnY0gmlwhKwSux-KbXVsdGlhZGRyc5YACASsErsfBu0CAAoErBK7HwbtA90DgnJzhQADAQAAiXNlY3AyNTZrMaECxYmS3GRSvla2b4v6Gr85f4tKb-EEsUeW15Kb0eJGloeDdGNwgu0Cg3VkcILtBIV3YWt1Mgk --lightpushnode=/ip4/172.18.187.31/tcp/60674/p2p/16Uiu2HAm8imy4JdgsXyz4z5LAqrap5NjuQeC4oVC1kgtznqtYuGA
2025-02-17 04:03:12.262 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.182.106 waku 992d28d6154c54cd4ff9387057c650464169a8811c0faf8c9abef5b78db4f9c8
2025-02-17 04:03:12.319 DEBUG [src.node.docker_mananger] Container started with ID 992d28d6154c. Setting up logs at ./log/docker/node2_2025-02-17_04-03-10__00725156-454d-4d10-9a49-81476e87e3e1__wakuorg_nwaku:latest.log
2025-02-17 04:03:12.320 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 45666
2025-02-17 04:03:12.320 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:13.321 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45666/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:13.324 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:13.324 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:13.324 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45666/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:13.326 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.182.106/tcp/45667/p2p/16Uiu2HAky9VwyDtFox18tMoxZvGCSMmnbDEWTRY4P6Bk2X3KQZB3","/ip4/172.18.182.106/tcp/45668/ws/p2p/16Uiu2HAky9VwyDtFox18tMoxZvGCSMmnbDEWTRY4P6Bk2X3KQZB3"],"enrUri":"enr:-L24QAhqGXdU1hgESYSTn07PYIXyyudZo00HjaZ6Dvq5QZNTUWlF5lf99t0azkxfBHFM7x4PdVbcsxSYauLqeFZeCHoCgmlkgnY0gmlwhKwStmqKbXVsdGlhZGRyc5YACASsErZqBrJjAAoErBK2agayZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECN0oct7P6DUYfDRBiAvfOQyS5e7_nud0PVxwUxOcE376DdGNwgrJjg3VkcIKyZYV3YWt1Mgk"}'
2025-02-17 04:03:13.327 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:13.327 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:03:13.327 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:03:13.328 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:03:13.328 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.195.138
2025-02-17 04:03:13.328 DEBUG [src.node.docker_mananger] Generated ports ['17740', '17741', '17742', '17743', '17744']
2025-02-17 04:03:13.329 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:03:13.329 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:03:13.329 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:03:13.329 DEBUG [src.node.docker_mananger] docker run -i -t -p 17740:17740 -p 17741:17741 -p 17742:17742 -p 17743:17743 -p 17744:17744 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17742 --rest-port=17740 --tcp-port=17741 --discv5-udp-port=17743 --rest-address=0.0.0.0 --nat=extip:172.18.195.138 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=54dc22a5343fab87a09fadeeb76b2e4bb8565a53c3f9e4a4ebd6bb53eeae7fa6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17744 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QAhqGXdU1hgESYSTn07PYIXyyudZo00HjaZ6Dvq5QZNTUWlF5lf99t0azkxfBHFM7x4PdVbcsxSYauLqeFZeCHoCgmlkgnY0gmlwhKwStmqKbXVsdGlhZGRyc5YACASsErZqBrJjAAoErBK2agayZN0DgnJzhQADAQAAiXNlY3AyNTZrMaECN0oct7P6DUYfDRBiAvfOQyS5e7_nud0PVxwUxOcE376DdGNwgrJjg3VkcIKyZYV3YWt1Mgk
2025-02-17 04:03:13.559 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.195.138 waku 2debf675355bbfee96ec5f1f0010a62d5f0023dcab4e6e30acfdaae8ce73d5b8
2025-02-17 04:03:13.610 DEBUG [src.node.docker_mananger] Container started with ID 2debf675355b. Setting up logs at ./log/docker/node3_2025-02-17_04-03-10__00725156-454d-4d10-9a49-81476e87e3e1__wakuorg_nwaku:latest.log
2025-02-17 04:03:13.611 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17740
2025-02-17 04:03:13.611 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:03:14.611 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17740/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:14.626 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:03:14.627 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:03:14.628 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17740/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:14.631 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.195.138/tcp/17741/p2p/16Uiu2HAkwX1kZH9u9WagTnY373r4Ut3gHn34xt4z6vjicp2ezqXA","/ip4/172.18.195.138/tcp/17742/ws/p2p/16Uiu2HAkwX1kZH9u9WagTnY373r4Ut3gHn34xt4z6vjicp2ezqXA"],"enrUri":"enr:-L24QKCqobrt2HVhJbd-YeRheWj5Wco1FvQn_4HFKiVAJbKZAfMSFNU_OSPtUGKEw1ckIiV2Hum7XCkGO77sIPGbJaICgmlkgnY0gmlwhKwSw4qKbXVsdGlhZGRyc5YACASsEsOKBkVNAAoErBLDigZFTt0DgnJzhQADAQAAiXNlY3AyNTZrMaECHxWiSWT3lFH9VUvNTloaABidbg-Ha_qxrLgZAON3962DdGNwgkVNg3VkcIJFT4V3YWt1MgE"}'
2025-02-17 04:03:14.631 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:03:14.631 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60673/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:03:14.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:14.648 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45666/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:03:14.652 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:14.652 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17740/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:03:14.657 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:14.658 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60673/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:14.662 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-17 04:03:15.662 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60673/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:15.665 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-17 04:03:16.665 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60673/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:16.669 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.182.106/tcp/45667/p2p/16Uiu2HAky9VwyDtFox18tMoxZvGCSMmnbDEWTRY4P6Bk2X3KQZB3","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":false},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":false}],"origin":"Discv5"}]'
2025-02-17 04:03:16.669 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45666/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:16.672 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.187.31/tcp/60674/p2p/16Uiu2HAm8imy4JdgsXyz4z5LAqrap5NjuQeC4oVC1kgtznqtYuGA","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":false},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":false}],"origin":"Discv5"},{"multiaddr":"/ip4/172.18.195.138/tcp/17741/p2p/16Uiu2HAkwX1kZH9u9WagTnY373r4Ut3gHn34xt4z6vjicp2ezqXA","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
2025-02-17 04:03:16.672 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17740/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:16.675 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.182.106/tcp/45667/p2p/16Uiu2HAky9VwyDtFox18tMoxZvGCSMmnbDEWTRY4P6Bk2X3KQZB3","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
2025-02-17 04:03:16.675 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-17 04:03:46.676 DEBUG [src.steps.light_push] Lightpushing message
2025-02-17 04:03:46.676 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60673/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": 1739765026676176896}}'
2025-02-17 04:03:46.691 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:03:46.692 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:03:46.792 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 04:03:46.793 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17740/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:03:46.796 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739765026676176896,"ephemeral":false,"proof":""}]'
2025-02-17 04:03:46.799 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:03:46.800 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:03:46.800 DEBUG [src.node.waku_node] Stopping container with id bf8f3ded8dc9
2025-02-17 04:03:47.625 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:47.625 DEBUG [src.node.waku_node] Stopping container with id 992d28d6154c
2025-02-17 04:03:48.438 ERROR [src.node.docker_mananger] Max retries reached for container bf8f3ded8dc9. Exiting log stream.
2025-02-17 04:03:48.847 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:48.847 DEBUG [src.node.waku_node] Stopping container with id 2debf675355b
2025-02-17 04:03:49.660 ERROR [src.node.docker_mananger] Max retries reached for container 992d28d6154c. Exiting log stream.
2025-02-17 04:03:50.320 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:03:50.321 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:03:50.338 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:03:50.355 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:03:50.370 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
