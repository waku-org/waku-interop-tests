2025-02-17 04:06:15.067 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:06:15.067 DEBUG [tests.conftest] Running test: test_single_content_topic[/app/20/sometopic/someencoding] with id: 2025-02-17_04-06-15__2d724c27-5357-4527-bd61-3bee174c6a24
2025-02-17 04:06:15.067 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:06:15.068 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-17 04:06:15.068 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-17 04:06:15.075 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:15.076 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_04-06-15__2d724c27-5357-4527-bd61-3bee174c6a24__wakuorg_nwaku:latest.log
2025-02-17 04:06:15.076 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:15.076 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:15.077 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:15.077 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.245.67
2025-02-17 04:06:15.077 DEBUG [src.node.docker_mananger] Generated ports ['29479', '29480', '29481', '29482', '29483']
2025-02-17 04:06:15.077 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:15.078 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:15.078 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:15.078 DEBUG [src.node.docker_mananger] docker run -i -t -p 29479:29479 -p 29480:29480 -p 29481:29481 -p 29482:29482 -p 29483:29483 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29481 --rest-port=29479 --tcp-port=29480 --discv5-udp-port=29482 --rest-address=0.0.0.0 --nat=extip:172.18.245.67 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ea07ed8f38fd987a2256aae3ccdf02a451b38c979da77e69c7d3e5d7955671fc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29483 --metrics-logging=true --relay=true --filter=true --content-topic=/app/20/sometopic/someencoding
2025-02-17 04:06:15.325 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.245.67 waku f45bfcd882cdf145576247198b48a8585bf717744158b4e6b951c09ab00b2e9b
2025-02-17 04:06:15.381 DEBUG [src.node.docker_mananger] Container started with ID f45bfcd882cd. Setting up logs at ./log/docker/node1_2025-02-17_04-06-15__2d724c27-5357-4527-bd61-3bee174c6a24__wakuorg_nwaku:latest.log
2025-02-17 04:06:15.381 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29479
2025-02-17 04:06:15.381 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:15.864 ERROR [src.node.docker_mananger] Max retries reached for container 0145b341299a. Exiting log stream.
2025-02-17 04:06:16.382 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29479/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:16.384 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:16.384 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:16.385 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29479/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:16.387 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.245.67/tcp/29480/p2p/16Uiu2HAmVTkYSmvwSKqkjbJ74SeqCBPdYcYs5CNsWgHkhkxFgBvM","/ip4/172.18.245.67/tcp/29481/ws/p2p/16Uiu2HAmVTkYSmvwSKqkjbJ74SeqCBPdYcYs5CNsWgHkhkxFgBvM"],"enrUri":"enr:-L24QIcWhYZw8B8ZX4DBJtx4-EszV4pLnkQ-bea_WMI53BAxRA8G-qS0kDSyFb3e-fcXDvFliFZlRYw40CzG8WLS24ACgmlkgnY0gmlwhKwS9UOKbXVsdGlhZGRyc5YACASsEvVDBnMoAAoErBL1QwZzKd0DgnJzhQACAQAAiXNlY3AyNTZrMaED-bWtLR1cXiYNACqq-pjuxOCUf0gVRAIF7V4rMsTd55aDdGNwgnMog3VkcIJzKoV3YWt1MgU"}'
2025-02-17 04:06:16.387 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:16.393 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:16.393 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_04-06-15__2d724c27-5357-4527-bd61-3bee174c6a24__wakuorg_nwaku:latest.log
2025-02-17 04:06:16.393 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:16.394 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:16.395 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:16.395 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.156.126
2025-02-17 04:06:16.395 DEBUG [src.node.docker_mananger] Generated ports ['58236', '58237', '58238', '58239', '58240']
2025-02-17 04:06:16.395 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:16.395 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:16.395 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:16.396 DEBUG [src.node.docker_mananger] docker run -i -t -p 58236:58236 -p 58237:58237 -p 58238:58238 -p 58239:58239 -p 58240:58240 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58238 --rest-port=58236 --tcp-port=58237 --discv5-udp-port=58239 --rest-address=0.0.0.0 --nat=extip:172.18.156.126 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=cbedad9fe75ec1fbffebdcecf0a89bbddd8c22fcfd9e820e4f76d8e5cad94bff --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58240 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QIcWhYZw8B8ZX4DBJtx4-EszV4pLnkQ-bea_WMI53BAxRA8G-qS0kDSyFb3e-fcXDvFliFZlRYw40CzG8WLS24ACgmlkgnY0gmlwhKwS9UOKbXVsdGlhZGRyc5YACASsEvVDBnMoAAoErBL1QwZzKd0DgnJzhQACAQAAiXNlY3AyNTZrMaED-bWtLR1cXiYNACqq-pjuxOCUf0gVRAIF7V4rMsTd55aDdGNwgnMog3VkcIJzKoV3YWt1MgU --content-topic=/app/20/sometopic/someencoding
2025-02-17 04:06:16.629 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.156.126 waku 818c85b5d94c9e8a2260d0787c4ad871fca8a3001d303ab20bf04708fb885931
2025-02-17 04:06:16.682 DEBUG [src.node.docker_mananger] Container started with ID 818c85b5d94c. Setting up logs at ./log/docker/node2_2025-02-17_04-06-15__2d724c27-5357-4527-bd61-3bee174c6a24__wakuorg_nwaku:latest.log
2025-02-17 04:06:16.683 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58236
2025-02-17 04:06:16.683 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:17.687 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58236/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:17.695 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:17.696 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:17.696 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58236/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:17.699 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.156.126/tcp/58237/p2p/16Uiu2HAm33udNq7uW6Qbhki2uKkzFDFHTz1jJqu4EELWfum24262","/ip4/172.18.156.126/tcp/58238/ws/p2p/16Uiu2HAm33udNq7uW6Qbhki2uKkzFDFHTz1jJqu4EELWfum24262"],"enrUri":"enr:-L24QIHLoJCsFc0tt33fO3mGMR5gxGu0-IiB-ds2NFAEeK3wMwyIISMzuRPZKGv0PCcVFUrfDFqu4AmIbIv3iEsq580CgmlkgnY0gmlwhKwSnH6KbXVsdGlhZGRyc5YACASsEpx-BuN9AAoErBKcfgbjft0DgnJzhQACAQAAiXNlY3AyNTZrMaECcUomQjJVbt9flxEdqg_39G4bMoYgCKsaiKPqs-tLzE-DdGNwguN9g3VkcILjf4V3YWt1MgE"}'
2025-02-17 04:06:17.699 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:17.699 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58236/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.245.67/tcp/29480/p2p/16Uiu2HAmVTkYSmvwSKqkjbJ74SeqCBPdYcYs5CNsWgHkhkxFgBvM"]'
2025-02-17 04:06:17.702 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:17.702 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29479/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/app/20/sometopic/someencoding"]'
2025-02-17 04:06:17.704 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:17.705 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58236/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/app/20/sometopic/someencoding"]'
2025-02-17 04:06:17.707 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:17.707 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29479/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/app/20/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:06:17.712 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:17.713 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:06:17.813 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:17.814 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29479/relay/v1/auto/messages/%2Fapp%2F20%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:17.816 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/app/20/sometopic/someencoding","version":0,"timestamp":1739765177707651072,"ephemeral":false,"proof":""}]'
2025-02-17 04:06:17.817 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:17.818 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58236/relay/v1/auto/messages/%2Fapp%2F20%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:17.820 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/app/20/sometopic/someencoding","version":0,"timestamp":1739765177707651072,"ephemeral":false,"proof":""}]'
2025-02-17 04:06:17.823 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:06:17.824 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:06:17.824 DEBUG [src.node.waku_node] Stopping container with id f45bfcd882cd
2025-02-17 04:06:18.864 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:18.864 DEBUG [src.node.waku_node] Stopping container with id 818c85b5d94c
2025-02-17 04:06:19.675 ERROR [src.node.docker_mananger] Max retries reached for container f45bfcd882cd. Exiting log stream.
2025-02-17 04:06:20.379 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:20.380 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:06:20.386 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:06:20.391 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
