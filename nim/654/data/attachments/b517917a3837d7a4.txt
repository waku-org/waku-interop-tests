2025-02-17 04:06:41.906 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:06:41.907 DEBUG [tests.conftest] Running test: test_filter_get_message_duplicate_message with id: 2025-02-17_04-06-41__597fc751-1a78-4bfa-98cf-4218972258da
2025-02-17 04:06:41.907 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:06:41.907 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-17 04:06:41.907 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-17 04:06:41.914 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:41.914 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_04-06-41__597fc751-1a78-4bfa-98cf-4218972258da__wakuorg_nwaku:latest.log
2025-02-17 04:06:41.915 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:41.915 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:41.916 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:41.916 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.59.164
2025-02-17 04:06:41.917 DEBUG [src.node.docker_mananger] Generated ports ['48371', '48372', '48373', '48374', '48375']
2025-02-17 04:06:41.917 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:41.917 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:41.917 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:41.917 DEBUG [src.node.docker_mananger] docker run -i -t -p 48371:48371 -p 48372:48372 -p 48373:48373 -p 48374:48374 -p 48375:48375 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48373 --rest-port=48371 --tcp-port=48372 --discv5-udp-port=48374 --rest-address=0.0.0.0 --nat=extip:172.18.59.164 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8ecfeaae7ddf56f6ffbce2eeebd28bc3eca7edfbbe5de96b82bfd894ecdeffdb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48375 --metrics-logging=true --relay=true --filter=true
2025-02-17 04:06:42.150 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.59.164 waku 9c209fd245d3f21aa5e3a950b7938ac167f913237dbc87eb14dabfedb58b1302
2025-02-17 04:06:42.202 DEBUG [src.node.docker_mananger] Container started with ID 9c209fd245d3. Setting up logs at ./log/docker/node1_2025-02-17_04-06-41__597fc751-1a78-4bfa-98cf-4218972258da__wakuorg_nwaku:latest.log
2025-02-17 04:06:42.203 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48371
2025-02-17 04:06:42.204 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:42.723 ERROR [src.node.docker_mananger] Max retries reached for container 0be1030d6583. Exiting log stream.
2025-02-17 04:06:43.204 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48371/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:43.207 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:43.208 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:43.208 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48371/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:43.210 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.59.164/tcp/48372/p2p/16Uiu2HAm2DZoAPQ2amCqqq9As3nyer4jZLsJhSZUwcnyEhuJQPZt","/ip4/172.18.59.164/tcp/48373/ws/p2p/16Uiu2HAm2DZoAPQ2amCqqq9As3nyer4jZLsJhSZUwcnyEhuJQPZt"],"enrUri":"enr:-L24QLaD8bmGYmP6ztKvOwZgOtpCk4HdhIzShJNQRdOyY82nLdZslcSTTKs8C-FsNbtSTfddjj-dNwoJAwp_jNaCUjECgmlkgnY0gmlwhKwSO6SKbXVsdGlhZGRyc5YACASsEjukBrz0AAoErBI7pAa89d0DgnJzhQADAQAAiXNlY3AyNTZrMaECZOfY6RCuyGB5-yYqPq3s1QZQ0T9IwiL4Z-1phONFHTODdGNwgrz0g3VkcIK89oV3YWt1MgU"}'
2025-02-17 04:06:43.210 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:43.211 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-17 04:06:43.217 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:43.217 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_04-06-41__597fc751-1a78-4bfa-98cf-4218972258da__wakuorg_nwaku:latest.log
2025-02-17 04:06:43.217 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:43.217 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:43.219 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:43.219 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.33.232
2025-02-17 04:06:43.219 DEBUG [src.node.docker_mananger] Generated ports ['31027', '31028', '31029', '31030', '31031']
2025-02-17 04:06:43.219 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:43.220 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:43.220 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:43.220 DEBUG [src.node.docker_mananger] docker run -i -t -p 31027:31027 -p 31028:31028 -p 31029:31029 -p 31030:31030 -p 31031:31031 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31029 --rest-port=31027 --tcp-port=31028 --discv5-udp-port=31030 --rest-address=0.0.0.0 --nat=extip:172.18.33.232 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=48ede7df4d25bb6fd53e2cd63b9ef7bcb9fa91cd018cf36630aa5ff2aba0df04 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31031 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QLaD8bmGYmP6ztKvOwZgOtpCk4HdhIzShJNQRdOyY82nLdZslcSTTKs8C-FsNbtSTfddjj-dNwoJAwp_jNaCUjECgmlkgnY0gmlwhKwSO6SKbXVsdGlhZGRyc5YACASsEjukBrz0AAoErBI7pAa89d0DgnJzhQADAQAAiXNlY3AyNTZrMaECZOfY6RCuyGB5-yYqPq3s1QZQ0T9IwiL4Z-1phONFHTODdGNwgrz0g3VkcIK89oV3YWt1MgU --filternode=/ip4/172.18.59.164/tcp/48372/p2p/16Uiu2HAm2DZoAPQ2amCqqq9As3nyer4jZLsJhSZUwcnyEhuJQPZt
2025-02-17 04:06:43.456 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.33.232 waku 850489ee457adeb3656183edacd028dbe71649507dc3a7287722142aee0d0a1e
2025-02-17 04:06:43.504 DEBUG [src.node.docker_mananger] Container started with ID 850489ee457a. Setting up logs at ./log/docker/node2_2025-02-17_04-06-41__597fc751-1a78-4bfa-98cf-4218972258da__wakuorg_nwaku:latest.log
2025-02-17 04:06:43.505 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31027
2025-02-17 04:06:43.505 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:44.505 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31027/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:44.508 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:44.509 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:44.509 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31027/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:44.511 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.33.232/tcp/31028/p2p/16Uiu2HAmKsWCZ4Rztt5RLDJap1CrBpdFZUSpLNTDdVUHNXcfieeZ","/ip4/172.18.33.232/tcp/31029/ws/p2p/16Uiu2HAmKsWCZ4Rztt5RLDJap1CrBpdFZUSpLNTDdVUHNXcfieeZ"],"enrUri":"enr:-L24QJ7RzmwCcLmQGfOKSB-mDE7joiqgNUl8-zeWyPVAP0a6dio7flAOmkW-1drFzRZlhYvsFmjTWJigyOW-hksXgpACgmlkgnY0gmlwhKwSIeiKbXVsdGlhZGRyc5YACASsEiHoBnk0AAoErBIh6AZ5Nd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDazaHa8HxaAmzXrzgl9mlIHGYu1DiniFWwD2Bb0NRul6DdGNwgnk0g3VkcIJ5NoV3YWt1MgA"}'
2025-02-17 04:06:44.511 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:44.512 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31027/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.59.164/tcp/48372/p2p/16Uiu2HAm2DZoAPQ2amCqqq9As3nyer4jZLsJhSZUwcnyEhuJQPZt"]'
2025-02-17 04:06:44.549 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:44.551 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-17 04:06:44.552 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48371/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 04:06:44.573 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:44.575 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31027/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "224a668e-476e-42cf-a69c-c39e5e82c89f", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-17 04:06:44.586 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"224a668e-476e-42cf-a69c-c39e5e82c89f","statusDesc":"OK"}'
2025-02-17 04:06:44.587 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48371/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:06:44.596 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:44.596 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:06:44.696 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:44.697 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31027/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:44.699 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739765204587807232,"ephemeral":false}]'
2025-02-17 04:06:44.701 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48371/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:06:44.705 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:44.705 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:06:44.805 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:44.806 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31027/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:44.809 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-17 04:06:44.811 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:06:44.812 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:06:44.812 DEBUG [src.node.waku_node] Stopping container with id 9c209fd245d3
2025-02-17 04:06:45.812 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:45.813 DEBUG [src.node.waku_node] Stopping container with id 850489ee457a
2025-02-17 04:06:46.626 ERROR [src.node.docker_mananger] Max retries reached for container 9c209fd245d3. Exiting log stream.
2025-02-17 04:06:47.338 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:47.338 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:06:47.344 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:06:47.349 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
