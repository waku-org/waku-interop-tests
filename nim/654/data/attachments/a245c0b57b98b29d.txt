2025-02-17 04:07:37.135 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:07:37.135 DEBUG [tests.conftest] Running test: test_legacy_store_v1 with id: 2025-02-17_04-07-37__1a6dcb0b-3f26-4630-9773-698eced7c09b
2025-02-17 04:07:37.135 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:07:37.136 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-17 04:07:37.136 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-17 04:07:37.143 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:07:37.143 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-17_04-07-37__1a6dcb0b-3f26-4630-9773-698eced7c09b__wakuorg_nwaku:latest.log
2025-02-17 04:07:37.143 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:07:37.143 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:07:37.145 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:07:37.145 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.179.182
2025-02-17 04:07:37.145 DEBUG [src.node.docker_mananger] Generated ports ['34667', '34668', '34669', '34670', '34671']
2025-02-17 04:07:37.145 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:07:37.145 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:07:37.145 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:07:37.145 DEBUG [src.node.docker_mananger] docker run -i -t -p 34667:34667 -p 34668:34668 -p 34669:34669 -p 34670:34670 -p 34671:34671 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34669 --rest-port=34667 --tcp-port=34668 --discv5-udp-port=34670 --rest-address=0.0.0.0 --nat=extip:172.18.179.182 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=08961c3cdfedb3ce87c5eedb6121e8ab19bcafe584abe000fafd03b493bbdb3c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34671 --metrics-logging=true --store=true --relay=true
2025-02-17 04:07:37.392 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.179.182 waku 3f9ba0b97581546a37bff733d1860bf0ded871b85e40aa5215a22774aef8fbc6
2025-02-17 04:07:37.443 DEBUG [src.node.docker_mananger] Container started with ID 3f9ba0b97581. Setting up logs at ./log/docker/publishing_node1_2025-02-17_04-07-37__1a6dcb0b-3f26-4630-9773-698eced7c09b__wakuorg_nwaku:latest.log
2025-02-17 04:07:37.444 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 34667
2025-02-17 04:07:37.445 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:07:37.914 ERROR [src.node.docker_mananger] Max retries reached for container fb2552a6bb22. Exiting log stream.
2025-02-17 04:07:38.445 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34667/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:07:38.448 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:07:38.448 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:07:38.448 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34667/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:07:38.450 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.179.182/tcp/34668/p2p/16Uiu2HAmMdv4MJpwAx8VZSJY7KeEroaJUPZoFYAHNiFMQSaveBhb","/ip4/172.18.179.182/tcp/34669/ws/p2p/16Uiu2HAmMdv4MJpwAx8VZSJY7KeEroaJUPZoFYAHNiFMQSaveBhb"],"enrUri":"enr:-L24QGjgf2-8ignk2GlWlOx2weZ2AADmq_mp0qddfyaLwpHxTNlBW0nTvxoDV7a-vVUdUTmICiSA7A8bXymY813u9voCgmlkgnY0gmlwhKwSs7aKbXVsdGlhZGRyc5YACASsErO2BodsAAoErBKztgaHbd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDhXK_nRv_uQVgRxlxq74n2kiMQswzNID0ApMvMIW6rBKDdGNwgodsg3VkcIKHboV3YWt1MgM"}'
2025-02-17 04:07:38.451 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:07:38.457 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:07:38.457 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-17_04-07-37__1a6dcb0b-3f26-4630-9773-698eced7c09b__wakuorg_nwaku:latest.log
2025-02-17 04:07:38.458 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:07:38.458 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:07:38.459 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:07:38.459 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.64.252
2025-02-17 04:07:38.460 DEBUG [src.node.docker_mananger] Generated ports ['57972', '57973', '57974', '57975', '57976']
2025-02-17 04:07:38.460 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:07:38.460 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:07:38.460 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:07:38.460 DEBUG [src.node.docker_mananger] docker run -i -t -p 57972:57972 -p 57973:57973 -p 57974:57974 -p 57975:57975 -p 57976:57976 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57974 --rest-port=57972 --tcp-port=57973 --discv5-udp-port=57975 --rest-address=0.0.0.0 --nat=extip:172.18.64.252 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ddab110ddf50f1ec89c13af57ed89acb5d506b40b96d0ba1864cb6bb0cde027a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57976 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QGjgf2-8ignk2GlWlOx2weZ2AADmq_mp0qddfyaLwpHxTNlBW0nTvxoDV7a-vVUdUTmICiSA7A8bXymY813u9voCgmlkgnY0gmlwhKwSs7aKbXVsdGlhZGRyc5YACASsErO2BodsAAoErBKztgaHbd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDhXK_nRv_uQVgRxlxq74n2kiMQswzNID0ApMvMIW6rBKDdGNwgodsg3VkcIKHboV3YWt1MgM --storenode=/ip4/172.18.179.182/tcp/34668/p2p/16Uiu2HAmMdv4MJpwAx8VZSJY7KeEroaJUPZoFYAHNiFMQSaveBhb --store=true --relay=true
2025-02-17 04:07:38.706 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.64.252 waku 143f5e029157da932602f2f9f5407b096b824b96f83398017ced9aed4c4d835d
2025-02-17 04:07:38.759 DEBUG [src.node.docker_mananger] Container started with ID 143f5e029157. Setting up logs at ./log/docker/store_node1_2025-02-17_04-07-37__1a6dcb0b-3f26-4630-9773-698eced7c09b__wakuorg_nwaku:latest.log
2025-02-17 04:07:38.759 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57972
2025-02-17 04:07:38.759 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:07:39.760 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57972/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:07:39.763 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:07:39.763 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:07:39.763 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57972/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:07:39.765 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.64.252/tcp/57973/p2p/16Uiu2HAmE8U41ReVykC9XbM9dh1NdbPpvpo235ir28wGEGm1bSMJ","/ip4/172.18.64.252/tcp/57974/ws/p2p/16Uiu2HAmE8U41ReVykC9XbM9dh1NdbPpvpo235ir28wGEGm1bSMJ"],"enrUri":"enr:-L24QITXPYpDyTO7rQcKfCjtQsbU2P7l-DhUaw9Q7aHyFbtICujA29eFdoJioE8_AMVMULU9SPwe6OFOAYeeT-jbQoQCgmlkgnY0gmlwhKwSQPyKbXVsdGlhZGRyc5YACASsEkD8BuJ1AAoErBJA_Abidt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDFeWxCoYXZJCOlYMd7mqCjvD5_7fUiYLL0rY9BEfGIy2DdGNwguJ1g3VkcILid4V3YWt1MgM"}'
2025-02-17 04:07:39.765 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:07:39.766 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57972/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.179.182/tcp/34668/p2p/16Uiu2HAmMdv4MJpwAx8VZSJY7KeEroaJUPZoFYAHNiFMQSaveBhb"]'
2025-02-17 04:07:39.768 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:07:39.769 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34667/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:07:39.771 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:07:39.771 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57972/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:07:39.773 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:07:39.774 DEBUG [src.steps.store] Relaying message
2025-02-17 04:07:39.774 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34667/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:07:39.780 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:07:39.780 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:07:39.981 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34667/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:07:39.984 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765259774692096,"ephemeral":false}]}'
2025-02-17 04:07:39.984 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57972/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:07:39.987 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765259774692096,"ephemeral":false}]}'
2025-02-17 04:07:39.989 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:07:39.990 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:07:39.990 DEBUG [src.node.waku_node] Stopping container with id 3f9ba0b97581
2025-02-17 04:07:40.995 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:07:40.996 DEBUG [src.node.waku_node] Stopping container with id 143f5e029157
2025-02-17 04:07:41.808 ERROR [src.node.docker_mananger] Max retries reached for container 3f9ba0b97581. Exiting log stream.
2025-02-17 04:07:42.543 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:07:42.545 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:07:42.550 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:07:42.556 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
