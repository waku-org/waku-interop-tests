2025-02-17 04:04:05.431 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:04:05.432 DEBUG [tests.conftest] Running test: test_cursor_pointing_to_deleted_message with id: 2025-02-17_04-04-05__f8a4b276-0e65-4285-bc2d-39fd8577b1ab
2025-02-17 04:04:05.432 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:04:05.432 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-17 04:04:05.433 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-17 04:04:05.439 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:04:05.439 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-17_04-04-05__f8a4b276-0e65-4285-bc2d-39fd8577b1ab__wakuorg_nwaku:latest.log
2025-02-17 04:04:05.439 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:04:05.439 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:04:05.441 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:04:05.441 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.28.18
2025-02-17 04:04:05.441 DEBUG [src.node.docker_mananger] Generated ports ['60517', '60518', '60519', '60520', '60521']
2025-02-17 04:04:05.441 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:04:05.441 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:04:05.441 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:04:05.441 DEBUG [src.node.docker_mananger] docker run -i -t -p 60517:60517 -p 60518:60518 -p 60519:60519 -p 60520:60520 -p 60521:60521 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60519 --rest-port=60517 --tcp-port=60518 --discv5-udp-port=60520 --rest-address=0.0.0.0 --nat=extip:172.18.28.18 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aaba82daa8add90d0f35cbfefabff4b12ecdc08deb8fff0ba30afeb8e000f5df --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60521 --metrics-logging=true --store=true --relay=true
2025-02-17 04:04:05.661 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.28.18 waku d7c9903b43182e30a228468cc7a6a52643a2553013629d04dedc6ebdc327de58
2025-02-17 04:04:05.705 DEBUG [src.node.docker_mananger] Container started with ID d7c9903b4318. Setting up logs at ./log/docker/publishing_node1_2025-02-17_04-04-05__f8a4b276-0e65-4285-bc2d-39fd8577b1ab__wakuorg_nwaku:latest.log
2025-02-17 04:04:05.705 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60517
2025-02-17 04:04:05.707 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:04:06.233 ERROR [src.node.docker_mananger] Max retries reached for container 709d367310ce. Exiting log stream.
2025-02-17 04:04:06.707 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60517/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:06.710 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:04:06.710 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:04:06.711 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60517/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:06.713 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.28.18/tcp/60518/p2p/16Uiu2HAmTT3vAxtTwQ9sqpTwMCGDYqU7t2PY1kzBvomVvgDbwb6b","/ip4/172.18.28.18/tcp/60519/ws/p2p/16Uiu2HAmTT3vAxtTwQ9sqpTwMCGDYqU7t2PY1kzBvomVvgDbwb6b"],"enrUri":"enr:-L24QKMeqeJRTBUHrTyuaeslZAb-gjSLUmSmzMSuiixrdiwyXgPlVJ6kmJ9DgljrXRdqgAQQbBRYsOeT9EfOaiMEUMkCgmlkgnY0gmlwhKwSHBKKbXVsdGlhZGRyc5YACASsEhwSBuxmAAoErBIcEgbsZ90DgnJzhQADAQAAiXNlY3AyNTZrMaED29BeCiVwYf-hO3uuoO4JWom3jjs8ZvBToCFpITKfeFyDdGNwguxmg3VkcILsaIV3YWt1MgM"}'
2025-02-17 04:04:06.713 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:04:06.720 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:04:06.720 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-17_04-04-05__f8a4b276-0e65-4285-bc2d-39fd8577b1ab__wakuorg_nwaku:latest.log
2025-02-17 04:04:06.720 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:04:06.720 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:04:06.722 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:04:06.722 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.249.75
2025-02-17 04:04:06.722 DEBUG [src.node.docker_mananger] Generated ports ['42121', '42122', '42123', '42124', '42125']
2025-02-17 04:04:06.722 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:04:06.722 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:04:06.722 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:04:06.723 DEBUG [src.node.docker_mananger] docker run -i -t -p 42121:42121 -p 42122:42122 -p 42123:42123 -p 42124:42124 -p 42125:42125 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42123 --rest-port=42121 --tcp-port=42122 --discv5-udp-port=42124 --rest-address=0.0.0.0 --nat=extip:172.18.249.75 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bebbf53d58be4e5acb694e58aaafaf5ca95efe5b1c6821cc2e872161a9f4ff39 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42125 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QKMeqeJRTBUHrTyuaeslZAb-gjSLUmSmzMSuiixrdiwyXgPlVJ6kmJ9DgljrXRdqgAQQbBRYsOeT9EfOaiMEUMkCgmlkgnY0gmlwhKwSHBKKbXVsdGlhZGRyc5YACASsEhwSBuxmAAoErBIcEgbsZ90DgnJzhQADAQAAiXNlY3AyNTZrMaED29BeCiVwYf-hO3uuoO4JWom3jjs8ZvBToCFpITKfeFyDdGNwguxmg3VkcILsaIV3YWt1MgM --storenode=/ip4/172.18.28.18/tcp/60518/p2p/16Uiu2HAmTT3vAxtTwQ9sqpTwMCGDYqU7t2PY1kzBvomVvgDbwb6b --store=true --relay=true
2025-02-17 04:04:06.945 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.249.75 waku b558121333a21563a02ad98073069d26c1f0b6724315257a4e77fcd2928c7ea8
2025-02-17 04:04:06.993 DEBUG [src.node.docker_mananger] Container started with ID b558121333a2. Setting up logs at ./log/docker/store_node1_2025-02-17_04-04-05__f8a4b276-0e65-4285-bc2d-39fd8577b1ab__wakuorg_nwaku:latest.log
2025-02-17 04:04:06.993 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42121
2025-02-17 04:04:06.993 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:04:07.994 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42121/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:07.997 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:04:07.997 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:04:07.997 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42121/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:08.000 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.249.75/tcp/42122/p2p/16Uiu2HAmNM2zG9gaFXxATW3zkDW1kU2xNomw9Fd2fUScoygcnB9Y","/ip4/172.18.249.75/tcp/42123/ws/p2p/16Uiu2HAmNM2zG9gaFXxATW3zkDW1kU2xNomw9Fd2fUScoygcnB9Y"],"enrUri":"enr:-L24QPenDme98YR4IG1SUkjVG3cNOk4D7Adn6tE8d4CNQxi7bf6T65C9jWN0GGKWdHrX-fm9flKyFXx33UkfOhhatVYCgmlkgnY0gmlwhKwS-UuKbXVsdGlhZGRyc5YACASsEvlLBqSKAAoErBL5Swaki90DgnJzhQADAQAAiXNlY3AyNTZrMaEDj_tlmZ0wtR7XxwCbHdOY_LQkGjm0yTi7rKTaWJy7jO-DdGNwgqSKg3VkcIKkjIV3YWt1MgM"}'
2025-02-17 04:04:08.000 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:04:08.000 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42121/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.28.18/tcp/60518/p2p/16Uiu2HAmTT3vAxtTwQ9sqpTwMCGDYqU7t2PY1kzBvomVvgDbwb6b"]'
2025-02-17 04:04:08.003 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.004 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:04:08.006 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.006 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42121/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:04:08.008 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.009 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:08.009 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8w", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:08.015 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.016 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:08.216 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:08.217 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8x", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:08.223 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.224 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:08.425 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:08.425 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8y", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:08.431 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.431 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:08.632 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:08.632 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8z", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:08.638 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.638 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:08.839 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:08.839 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV80", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:08.845 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:08.846 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:09.046 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:09.046 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV81", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:09.052 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:09.052 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:09.253 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:09.253 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV82", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:09.259 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:09.260 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:09.461 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:09.461 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV83", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:09.467 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:09.468 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:09.668 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:09.669 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV84", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:09.675 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:09.675 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:09.876 DEBUG [src.steps.store] Relaying message
2025-02-17 04:04:09.876 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60517/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV85", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:04:09.882 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:04:09.883 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:04:10.084 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60517/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x56ce18907e880dfec8406fcc5797d1530de954d0095cde2b2ec342bcc0894376&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:10.087 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:60517/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x56ce18907e880dfec8406fcc5797d1530de954d0095cde2b2ec342bcc0894376&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found'
2025-02-17 04:04:10.087 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42121/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x56ce18907e880dfec8406fcc5797d1530de954d0095cde2b2ec342bcc0894376&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:04:10.090 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:42121/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x56ce18907e880dfec8406fcc5797d1530de954d0095cde2b2ec342bcc0894376&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found'
2025-02-17 04:04:10.091 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:04:10.092 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:04:10.093 DEBUG [src.node.waku_node] Stopping container with id d7c9903b4318
2025-02-17 04:04:11.238 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:04:11.240 DEBUG [src.node.waku_node] Stopping container with id b558121333a2
2025-02-17 04:04:12.071 ERROR [src.node.docker_mananger] Max retries reached for container d7c9903b4318. Exiting log stream.
2025-02-17 04:04:12.739 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:04:12.741 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:04:12.756 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:04:12.764 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
