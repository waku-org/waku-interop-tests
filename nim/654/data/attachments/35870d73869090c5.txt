2025-02-17 04:06:09.752 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:06:09.753 DEBUG [tests.conftest] Running test: test_single_content_topic[/myapp/1/latest/proto] with id: 2025-02-17_04-06-09__ce6f5dbd-f3d5-4062-9a42-10408aeb5be0
2025-02-17 04:06:09.753 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:06:09.753 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-17 04:06:09.753 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-17 04:06:09.766 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:09.766 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_04-06-09__ce6f5dbd-f3d5-4062-9a42-10408aeb5be0__wakuorg_nwaku:latest.log
2025-02-17 04:06:09.767 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:09.767 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:09.769 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:09.769 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.235.202
2025-02-17 04:06:09.770 DEBUG [src.node.docker_mananger] Generated ports ['23877', '23878', '23879', '23880', '23881']
2025-02-17 04:06:09.770 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:09.770 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:09.770 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:09.771 DEBUG [src.node.docker_mananger] docker run -i -t -p 23877:23877 -p 23878:23878 -p 23879:23879 -p 23880:23880 -p 23881:23881 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23879 --rest-port=23877 --tcp-port=23878 --discv5-udp-port=23880 --rest-address=0.0.0.0 --nat=extip:172.18.235.202 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=f3dbb5edd192c9cac5e6c6ccd7fe26e6acfc56d884a2baabfa8bf9fa7cce260d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23881 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-17 04:06:10.010 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.235.202 waku 3206ba7f5d3476e851529e08fdd71d53802c6ed12bf614ebbca87e24ff140fc5
2025-02-17 04:06:10.059 DEBUG [src.node.docker_mananger] Container started with ID 3206ba7f5d34. Setting up logs at ./log/docker/node1_2025-02-17_04-06-09__ce6f5dbd-f3d5-4062-9a42-10408aeb5be0__wakuorg_nwaku:latest.log
2025-02-17 04:06:10.061 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23877
2025-02-17 04:06:10.061 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:10.595 ERROR [src.node.docker_mananger] Max retries reached for container 8917a5b8a357. Exiting log stream.
2025-02-17 04:06:11.061 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23877/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:11.064 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:11.064 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:11.065 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23877/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:11.067 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.202/tcp/23878/p2p/16Uiu2HAmVSinmCarjfR2FF8fa22iuj5YWy4DJHqhGaJxYE23rysk","/ip4/172.18.235.202/tcp/23879/ws/p2p/16Uiu2HAmVSinmCarjfR2FF8fa22iuj5YWy4DJHqhGaJxYE23rysk"],"enrUri":"enr:-L24QBfK4anA0AhJpbfRSq74Mk78Dr28mkhWhIw-KTWNU4c6Tbpc-Nqj_viDL_JF_Gy1KJ6VlcfT_NoAGCCIwWfO-aUCgmlkgnY0gmlwhKwS68qKbXVsdGlhZGRyc5YACASsEuvKBl1GAAoErBLrygZdR90DgnJzhQACAQAAiXNlY3AyNTZrMaED-XIdBiH6AQHXFAo8731oQiYWC5swTPK9OKMgoTC_IIeDdGNwgl1Gg3VkcIJdSIV3YWt1MgU"}'
2025-02-17 04:06:11.067 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:11.073 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:11.073 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_04-06-09__ce6f5dbd-f3d5-4062-9a42-10408aeb5be0__wakuorg_nwaku:latest.log
2025-02-17 04:06:11.073 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:11.074 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:11.075 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:11.075 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.113.244
2025-02-17 04:06:11.075 DEBUG [src.node.docker_mananger] Generated ports ['10015', '10016', '10017', '10018', '10019']
2025-02-17 04:06:11.075 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:11.075 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:11.076 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:11.076 DEBUG [src.node.docker_mananger] docker run -i -t -p 10015:10015 -p 10016:10016 -p 10017:10017 -p 10018:10018 -p 10019:10019 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10017 --rest-port=10015 --tcp-port=10016 --discv5-udp-port=10018 --rest-address=0.0.0.0 --nat=extip:172.18.113.244 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bafb44d681103c8e21acacb5aafcd7bbedc77e8f06f8e4f1155a0f8a3bfe3f08 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10019 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QBfK4anA0AhJpbfRSq74Mk78Dr28mkhWhIw-KTWNU4c6Tbpc-Nqj_viDL_JF_Gy1KJ6VlcfT_NoAGCCIwWfO-aUCgmlkgnY0gmlwhKwS68qKbXVsdGlhZGRyc5YACASsEuvKBl1GAAoErBLrygZdR90DgnJzhQACAQAAiXNlY3AyNTZrMaED-XIdBiH6AQHXFAo8731oQiYWC5swTPK9OKMgoTC_IIeDdGNwgl1Gg3VkcIJdSIV3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-17 04:06:11.303 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.113.244 waku 0145b341299a17a42589ad4c240f5233d783f40f4b5ed5e142d419090aec3c97
2025-02-17 04:06:11.352 DEBUG [src.node.docker_mananger] Container started with ID 0145b341299a. Setting up logs at ./log/docker/node2_2025-02-17_04-06-09__ce6f5dbd-f3d5-4062-9a42-10408aeb5be0__wakuorg_nwaku:latest.log
2025-02-17 04:06:11.352 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10015
2025-02-17 04:06:11.352 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:12.353 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10015/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:12.365 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:12.365 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:12.366 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10015/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:12.372 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.113.244/tcp/10016/p2p/16Uiu2HAmVfHi9egT31fJxr1RyFtLcHpBxET7m1E2qHPz8ePdKySy","/ip4/172.18.113.244/tcp/10017/ws/p2p/16Uiu2HAmVfHi9egT31fJxr1RyFtLcHpBxET7m1E2qHPz8ePdKySy"],"enrUri":"enr:-L24QDbNynIfh2FxFr3b5F3WIyttB8MuiiD2EuZj_DxPsOKPC5UVEgSZG9iYFdk_Rt3jhVo2iKdhHrzFN_pV25m7T9UCgmlkgnY0gmlwhKwScfSKbXVsdGlhZGRyc5YACASsEnH0BicgAAoErBJx9AYnId0DgnJzhQACAQAAiXNlY3AyNTZrMaED_KpObognLDYpCdvMqf9cQp1uD66FNtcc7HfbziON5FKDdGNwgicgg3VkcIInIoV3YWt1MgE"}'
2025-02-17 04:06:12.373 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:12.374 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10015/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.235.202/tcp/23878/p2p/16Uiu2HAmVSinmCarjfR2FF8fa22iuj5YWy4DJHqhGaJxYE23rysk"]'
2025-02-17 04:06:12.377 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:12.377 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23877/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-17 04:06:12.380 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:12.380 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10015/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-17 04:06:12.382 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:12.383 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23877/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:06:12.387 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:12.388 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:06:12.488 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:12.488 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23877/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:12.491 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765172383282688,"ephemeral":false,"proof":""}]'
2025-02-17 04:06:12.492 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:12.493 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10015/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:12.495 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765172383282688,"ephemeral":false,"proof":""}]'
2025-02-17 04:06:12.497 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:06:12.498 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:06:12.499 DEBUG [src.node.waku_node] Stopping container with id 3206ba7f5d34
2025-02-17 04:06:13.550 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:13.551 DEBUG [src.node.waku_node] Stopping container with id 0145b341299a
2025-02-17 04:06:14.362 ERROR [src.node.docker_mananger] Max retries reached for container 3206ba7f5d34. Exiting log stream.
2025-02-17 04:06:15.051 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:15.054 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:06:15.059 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:06:15.064 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
