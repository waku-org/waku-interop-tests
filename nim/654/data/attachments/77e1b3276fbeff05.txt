2025-02-17 04:06:27.814 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:06:27.814 DEBUG [tests.conftest] Running test: test_content_topic_and_pubsub_topic_not_in_docker_flags with id: 2025-02-17_04-06-27__712e7db6-9307-4a50-b4d1-b92750674a3d
2025-02-17 04:06:27.814 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:06:27.815 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-17 04:06:27.815 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-17 04:06:27.821 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:27.821 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_04-06-27__712e7db6-9307-4a50-b4d1-b92750674a3d__wakuorg_nwaku:latest.log
2025-02-17 04:06:27.822 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:27.822 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:27.823 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:27.823 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.95.54
2025-02-17 04:06:27.823 DEBUG [src.node.docker_mananger] Generated ports ['46531', '46532', '46533', '46534', '46535']
2025-02-17 04:06:27.823 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:27.824 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:27.824 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:27.824 DEBUG [src.node.docker_mananger] docker run -i -t -p 46531:46531 -p 46532:46532 -p 46533:46533 -p 46534:46534 -p 46535:46535 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46533 --rest-port=46531 --tcp-port=46532 --discv5-udp-port=46534 --rest-address=0.0.0.0 --nat=extip:172.18.95.54 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=0b8e19dd8418ddb9b126407eb9bacaebab8fb360c308c82c315c5cb11d8c8eba --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46535 --metrics-logging=true --relay=true --filter=true
2025-02-17 04:06:28.055 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.95.54 waku 0bfc915871632e575e4a17bee655c773c3653110d1cfcf45565effb098fbbc47
2025-02-17 04:06:28.101 DEBUG [src.node.docker_mananger] Container started with ID 0bfc91587163. Setting up logs at ./log/docker/node1_2025-02-17_04-06-27__712e7db6-9307-4a50-b4d1-b92750674a3d__wakuorg_nwaku:latest.log
2025-02-17 04:06:28.104 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 46531
2025-02-17 04:06:28.104 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:28.620 ERROR [src.node.docker_mananger] Max retries reached for container 8caa7a15b081. Exiting log stream.
2025-02-17 04:06:29.104 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46531/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:29.107 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:29.108 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:29.108 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46531/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:29.110 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.95.54/tcp/46532/p2p/16Uiu2HAm8pCdCeBct7fdrv6UooTdrCn5FCNeEvNvfWdwxWNiirR4","/ip4/172.18.95.54/tcp/46533/ws/p2p/16Uiu2HAm8pCdCeBct7fdrv6UooTdrCn5FCNeEvNvfWdwxWNiirR4"],"enrUri":"enr:-L24QAU5E32m3-trpvCpuPXgFXfcCEPbUgtjFE-LJwlp2MgmN5M0hIAeYG_cVfTQQySHm2ga8xjfDihyI-asgDSInBICgmlkgnY0gmlwhKwSXzaKbXVsdGlhZGRyc5YACASsEl82BrXEAAoErBJfNga1xd0DgnJzhQACAQAAiXNlY3AyNTZrMaECxu1btAB8VlOSV56fQw46qmnUPf6dMkNz3h5C8UC6gC-DdGNwgrXEg3VkcIK1xoV3YWt1MgU"}'
2025-02-17 04:06:29.110 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:29.117 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:06:29.117 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_04-06-27__712e7db6-9307-4a50-b4d1-b92750674a3d__wakuorg_nwaku:latest.log
2025-02-17 04:06:29.117 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:06:29.117 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:06:29.118 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:06:29.118 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.41.91
2025-02-17 04:06:29.119 DEBUG [src.node.docker_mananger] Generated ports ['15522', '15523', '15524', '15525', '15526']
2025-02-17 04:06:29.119 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:06:29.119 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:06:29.119 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:06:29.119 DEBUG [src.node.docker_mananger] docker run -i -t -p 15522:15522 -p 15523:15523 -p 15524:15524 -p 15525:15525 -p 15526:15526 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15524 --rest-port=15522 --tcp-port=15523 --discv5-udp-port=15525 --rest-address=0.0.0.0 --nat=extip:172.18.41.91 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=9aab4bdd6de9fb9b3d038d59ade92aa51f3d3cfeebfbbe6ecaa0b277bceed90c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15526 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QAU5E32m3-trpvCpuPXgFXfcCEPbUgtjFE-LJwlp2MgmN5M0hIAeYG_cVfTQQySHm2ga8xjfDihyI-asgDSInBICgmlkgnY0gmlwhKwSXzaKbXVsdGlhZGRyc5YACASsEl82BrXEAAoErBJfNga1xd0DgnJzhQACAQAAiXNlY3AyNTZrMaECxu1btAB8VlOSV56fQw46qmnUPf6dMkNz3h5C8UC6gC-DdGNwgrXEg3VkcIK1xoV3YWt1MgU
2025-02-17 04:06:29.353 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.41.91 waku c062eeae8696c734211069a799d480864bc58f14e4ae75a9d468ffdcf7adf325
2025-02-17 04:06:29.401 DEBUG [src.node.docker_mananger] Container started with ID c062eeae8696. Setting up logs at ./log/docker/node2_2025-02-17_04-06-27__712e7db6-9307-4a50-b4d1-b92750674a3d__wakuorg_nwaku:latest.log
2025-02-17 04:06:29.401 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15522
2025-02-17 04:06:29.401 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:06:30.402 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15522/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:30.406 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:06:30.408 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:06:30.408 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15522/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:30.414 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.41.91/tcp/15523/p2p/16Uiu2HAmHJYLBPDDfRMTbUmqsj19CJzub2BKWhqRscA3eMc9iFg5","/ip4/172.18.41.91/tcp/15524/ws/p2p/16Uiu2HAmHJYLBPDDfRMTbUmqsj19CJzub2BKWhqRscA3eMc9iFg5"],"enrUri":"enr:-L24QJIhf-M3NzMqfjpxmIGcN27VK81fKRXjsB7_g-9IVnypPb5-OlR9IZHNYc5Bt5VhmK23Yk3yjNkWt12o7ee8fNoCgmlkgnY0gmlwhKwSKVuKbXVsdGlhZGRyc5YACASsEilbBjyjAAoErBIpWwY8pN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDRQ1mBSsfQGiwqYdPLM_UIuF2y5ANJhUZzGHCqXGm-BqDdGNwgjyjg3VkcII8pYV3YWt1MgE"}'
2025-02-17 04:06:30.416 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:06:30.416 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15522/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.95.54/tcp/46532/p2p/16Uiu2HAm8pCdCeBct7fdrv6UooTdrCn5FCNeEvNvfWdwxWNiirR4"]'
2025-02-17 04:06:30.419 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:30.419 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46531/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-17 04:06:30.423 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:30.424 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15522/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-17 04:06:30.430 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:30.430 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46531/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:06:30.435 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:06:30.436 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 04:06:30.537 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:30.537 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46531/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:30.540 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765190430499584,"ephemeral":false,"proof":""}]'
2025-02-17 04:06:30.542 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-17 04:06:30.542 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15522/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:06:30.544 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739765190430499584,"ephemeral":false,"proof":""}]'
2025-02-17 04:06:30.547 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:06:30.548 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:06:30.548 DEBUG [src.node.waku_node] Stopping container with id 0bfc91587163
2025-02-17 04:06:31.596 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:31.597 DEBUG [src.node.waku_node] Stopping container with id c062eeae8696
2025-02-17 04:06:32.424 ERROR [src.node.docker_mananger] Max retries reached for container 0bfc91587163. Exiting log stream.
2025-02-17 04:06:33.108 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:06:33.109 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:06:33.120 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:06:33.126 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
