2025-02-17 04:08:05.676 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 04:08:05.676 DEBUG [tests.conftest] Running test: test_store_with_filter with id: 2025-02-17_04-08-05__b016c2f9-080f-4c7f-97dd-3ed398dbfae2
2025-02-17 04:08:05.677 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 04:08:05.677 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-17 04:08:05.684 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:08:05.684 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-17_04-08-05__b016c2f9-080f-4c7f-97dd-3ed398dbfae2__wakuorg_nwaku:latest.log
2025-02-17 04:08:05.684 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:08:05.684 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:08:05.686 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:08:05.686 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.118.227
2025-02-17 04:08:05.686 DEBUG [src.node.docker_mananger] Generated ports ['36302', '36303', '36304', '36305', '36306']
2025-02-17 04:08:05.686 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:08:05.686 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:08:05.686 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:08:05.687 DEBUG [src.node.docker_mananger] docker run -i -t -p 36302:36302 -p 36303:36303 -p 36304:36304 -p 36305:36305 -p 36306:36306 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36304 --rest-port=36302 --tcp-port=36303 --discv5-udp-port=36305 --rest-address=0.0.0.0 --nat=extip:172.18.118.227 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=342e60d1ccb3d2df39544cdced553c897d77f3ea2cc53a4e3c74cbf42de23aa0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36306 --metrics-logging=true --store=true --relay=true --filter=true
2025-02-17 04:08:05.920 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.118.227 waku 4b34fe3eb0624406d2f7ff7271153e2cf02bd892bed122b3c722675f7b3f5678
2025-02-17 04:08:05.980 DEBUG [src.node.docker_mananger] Container started with ID 4b34fe3eb062. Setting up logs at ./log/docker/publishing_node1_2025-02-17_04-08-05__b016c2f9-080f-4c7f-97dd-3ed398dbfae2__wakuorg_nwaku:latest.log
2025-02-17 04:08:05.981 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36302
2025-02-17 04:08:05.981 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:08:06.464 ERROR [src.node.docker_mananger] Max retries reached for container 130c58509dbb. Exiting log stream.
2025-02-17 04:08:06.982 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36302/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:06.985 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:08:06.985 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:08:06.985 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36302/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:06.987 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.118.227/tcp/36303/p2p/16Uiu2HAmJewc9pzKtSQUCZ9qPGL7K7H2a4Hxf9xQ3D4jraJW8Bfu","/ip4/172.18.118.227/tcp/36304/ws/p2p/16Uiu2HAmJewc9pzKtSQUCZ9qPGL7K7H2a4Hxf9xQ3D4jraJW8Bfu"],"enrUri":"enr:-L24QI5EDQAJUZm9iPnQC3_w4cL7ZXedJmGb9GnEoGsjJHyrNhf99orM1Ejjgbi7DXv5Z7EGe0LIerqF3Lw3w304xYsCgmlkgnY0gmlwhKwSduOKbXVsdGlhZGRyc5YACASsEnbjBo3PAAoErBJ24waN0N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDWSME6nSqX6SSNce6seI8BOom8L7ZmqPxkt-rg1akxoCDdGNwgo3Pg3VkcIKN0YV3YWt1Mgc"}'
2025-02-17 04:08:06.987 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:08:06.994 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 04:08:06.994 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-17_04-08-05__b016c2f9-080f-4c7f-97dd-3ed398dbfae2__wakuorg_nwaku:latest.log
2025-02-17 04:08:06.994 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 04:08:06.994 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 04:08:06.995 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 04:08:06.995 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.26.237
2025-02-17 04:08:06.996 DEBUG [src.node.docker_mananger] Generated ports ['23680', '23681', '23682', '23683', '23684']
2025-02-17 04:08:06.996 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 04:08:06.996 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 04:08:06.996 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 04:08:06.996 DEBUG [src.node.docker_mananger] docker run -i -t -p 23680:23680 -p 23681:23681 -p 23682:23682 -p 23683:23683 -p 23684:23684 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23682 --rest-port=23680 --tcp-port=23681 --discv5-udp-port=23683 --rest-address=0.0.0.0 --nat=extip:172.18.26.237 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=18dfdca75bad9532fa8db904ee4de8edfa2a6be81e33aea73be95ac0ebfe4d2e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23684 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QI5EDQAJUZm9iPnQC3_w4cL7ZXedJmGb9GnEoGsjJHyrNhf99orM1Ejjgbi7DXv5Z7EGe0LIerqF3Lw3w304xYsCgmlkgnY0gmlwhKwSduOKbXVsdGlhZGRyc5YACASsEnbjBo3PAAoErBJ24waN0N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDWSME6nSqX6SSNce6seI8BOom8L7ZmqPxkt-rg1akxoCDdGNwgo3Pg3VkcIKN0YV3YWt1Mgc --storenode=/ip4/172.18.118.227/tcp/36303/p2p/16Uiu2HAmJewc9pzKtSQUCZ9qPGL7K7H2a4Hxf9xQ3D4jraJW8Bfu --store=false --relay=false --filter=true
2025-02-17 04:08:07.227 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.26.237 waku 90839d65edc7258d8e7f4c16238d11abad80e73dfbaa93c377760e5e269572a9
2025-02-17 04:08:07.275 DEBUG [src.node.docker_mananger] Container started with ID 90839d65edc7. Setting up logs at ./log/docker/store_node1_2025-02-17_04-08-05__b016c2f9-080f-4c7f-97dd-3ed398dbfae2__wakuorg_nwaku:latest.log
2025-02-17 04:08:07.275 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23680
2025-02-17 04:08:07.275 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 04:08:08.276 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23680/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:08.279 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 04:08:08.279 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 04:08:08.279 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23680/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:08.281 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.26.237/tcp/23681/p2p/16Uiu2HAmLUNjJ3TFcFv66n19o73kdkjM1yKfLkdm44PuFP9YPPcK","/ip4/172.18.26.237/tcp/23682/ws/p2p/16Uiu2HAmLUNjJ3TFcFv66n19o73kdkjM1yKfLkdm44PuFP9YPPcK"],"enrUri":"enr:-L24QIeSXBlTdZk5bPDH6bjJQuz8ChF5cnrDIPG7c5Rtnqztcn4PYAPBJ-4m4eRpnCjiNTW7H2363Tq9ePwR936GjjQCgmlkgnY0gmlwhKwSGu2KbXVsdGlhZGRyc5YACASsEhrtBlyBAAoErBIa7QZcgt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDdCVpNWPgiBaAwZvSHVtcf-1CKi-PBe6aFLEescrM-viDdGNwglyBg3VkcIJcg4V3YWt1MgQ"}'
2025-02-17 04:08:08.282 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 04:08:08.282 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23680/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.118.227/tcp/36303/p2p/16Uiu2HAmJewc9pzKtSQUCZ9qPGL7K7H2a4Hxf9xQ3D4jraJW8Bfu"]'
2025-02-17 04:08:08.318 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:08:08.319 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36302/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 04:08:08.333 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:08:08.334 DEBUG [src.steps.store] Relaying message
2025-02-17 04:08:08.335 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36302/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 04:08:08.346 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 04:08:08.346 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 04:08:08.547 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-17 04:08:08.547 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36302/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:08.551 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x290d86d27aae418ae72582e28d2b41c3030f3a5bd36b532dec7dd4578415803b"}]}'
2025-02-17 04:08:08.551 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-17 04:08:08.551 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23680/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 04:08:08.559 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"f4c7c03cb0c6d8f316f4","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x290d86d27aae418ae72582e28d2b41c3030f3a5bd36b532dec7dd4578415803b"}]}'
2025-02-17 04:08:08.561 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 04:08:08.562 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 04:08:08.562 DEBUG [src.node.waku_node] Stopping container with id 4b34fe3eb062
2025-02-17 04:08:09.510 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:08:09.511 DEBUG [src.node.waku_node] Stopping container with id 90839d65edc7
2025-02-17 04:08:10.339 ERROR [src.node.docker_mananger] Max retries reached for container 4b34fe3eb062. Exiting log stream.
2025-02-17 04:08:10.854 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 04:08:10.855 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 04:08:10.865 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 04:08:10.869 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
