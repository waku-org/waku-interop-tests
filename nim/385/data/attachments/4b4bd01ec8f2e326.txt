[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-10-08_04-21-37__21af086e-c3b7-4ceb-800b-afea70af2795
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-08_04-21-37__21af086e-c3b7-4ceb-800b-afea70af2795__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.63.121
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['44066', '44067', '44068', '44069', '44070']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 44066:44066 -p 44067:44067 -p 44068:44068 -p 44069:44069 -p 44070:44070 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44068 --rest-port=44066 --tcp-port=44067 --discv5-udp-port=44069 --rest-address=0.0.0.0 --nat=extip:172.18.63.121 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d4b0deebcfbf80ed883bda31b0d5ef3af00f4b805c8b521c37894a846fb04a6e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44070 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.63.121 waku 2d2358bf284418d333be6ca84c9412c7fafad9032fcd77ceaa41f7b05671dd3b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 2d2358bf2844. Setting up logs at ./log/docker/receiving_node1_2024-10-08_04-21-37__21af086e-c3b7-4ceb-800b-afea70af2795__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 44066
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44066/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44066/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.63.121/tcp/44067/p2p/16Uiu2HAm8q1YFXoZivAYdZpu66X6U1jnFrMk1kWnUBJ4ysSr4iRD","/ip4/172.18.63.121/tcp/44068/ws/p2p/16Uiu2HAm8q1YFXoZivAYdZpu66X6U1jnFrMk1kWnUBJ4ysSr4iRD"],"enrUri":"enr:-LO4QPInvKq2N51T7ea58olN7pdQP1M9Gzqh43s6DBx1ehR4HPY94BhZgjWW-SB7JlqAZxML1JbzLqTiTjPdYwiuFKMBgmlkgnY0gmlwhKwSP3mKbXVsdGlhZGRyc4wACgSsEj95Bqwk3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLHImefxkyn6SkdhJrU834GtH6znrIPj5lBQNPGx0N86IN0Y3CCrCODdWRwgqwlhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-08_04-21-37__21af086e-c3b7-4ceb-800b-afea70af2795__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.169.38
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['16369', '16370', '16371', '16372', '16373']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 16369:16369 -p 16370:16370 -p 16371:16371 -p 16372:16372 -p 16373:16373 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16371 --rest-port=16369 --tcp-port=16370 --discv5-udp-port=16372 --rest-address=0.0.0.0 --nat=extip:172.18.169.38 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=932ecaaf595a3bbb0eb5f53b84b4e3c7b69b8bb34f32f31bff85bbeb7a5755db --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16373 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.169.38 waku 0079ebaac932532e7cb9bb2303a64013542a9d8fa123acd03c75d772856ec644
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 0079ebaac932. Setting up logs at ./log/docker/receiving_node2_2024-10-08_04-21-37__21af086e-c3b7-4ceb-800b-afea70af2795__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 16369
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16369/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16369/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.169.38/tcp/16370/p2p/16Uiu2HAmP7YXLN9rKQ51BHwsBzeBMCGpgnjAdC72XKQsSZFHngzM","/ip4/172.18.169.38/tcp/16371/ws/p2p/16Uiu2HAmP7YXLN9rKQ51BHwsBzeBMCGpgnjAdC72XKQsSZFHngzM"],"enrUri":"enr:-LO4QChlP3qEzKIh6OoQ2GjzjGo3r9PGLXUSGqbEfXg_6D4AaTQc7aNtWlfBJfEH6Uk-i1g4jbcBDv4jeeMpNXXeTEABgmlkgnY0gmlwhKwSqSaKbXVsdGlhZGRyc4wACgSsEqkmBj_z3QOCcnOFAAMBAACJc2VjcDI1NmsxoQObYllATJbGADdvhLy2oC28G2HgLpkqChX2hPGDJvBkwoN0Y3CCP_KDdWRwgj_0hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16369/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.63.121/tcp/44067/p2p/16Uiu2HAm8q1YFXoZivAYdZpu66X6U1jnFrMk1kWnUBJ4ysSr4iRD"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-08_04-21-37__21af086e-c3b7-4ceb-800b-afea70af2795__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.219.94
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['11679', '11680', '11681', '11682', '11683']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 11679:11679 -p 11680:11680 -p 11681:11681 -p 11682:11682 -p 11683:11683 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11681 --rest-port=11679 --tcp-port=11680 --discv5-udp-port=11682 --rest-address=0.0.0.0 --nat=extip:172.18.219.94 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7bd74c05cfb2990b863f6fcdaadf1ddf63b9bfede3eb3f5eadeb8de6e9ec5edb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11683 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QPInvKq2N51T7ea58olN7pdQP1M9Gzqh43s6DBx1ehR4HPY94BhZgjWW-SB7JlqAZxML1JbzLqTiTjPdYwiuFKMBgmlkgnY0gmlwhKwSP3mKbXVsdGlhZGRyc4wACgSsEj95Bqwk3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLHImefxkyn6SkdhJrU834GtH6znrIPj5lBQNPGx0N86IN0Y3CCrCODdWRwgqwlhXdha3UyCQ --lightpushnode=/ip4/172.18.63.121/tcp/44067/p2p/16Uiu2HAm8q1YFXoZivAYdZpu66X6U1jnFrMk1kWnUBJ4ysSr4iRD --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.219.94 waku bd947264b3d3e6666b88bac70dd8157427ee77c992d25726c881ef9a74b0a827
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID bd947264b3d3. Setting up logs at ./log/docker/lightpush_node1_2024-10-08_04-21-37__21af086e-c3b7-4ceb-800b-afea70af2795__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 11679
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11679/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11679/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.219.94/tcp/11680/p2p/16Uiu2HAm5syok4GX4D2aiMzqStnaqkNkygJPLgjCG3LthHJxnRPV","/ip4/172.18.219.94/tcp/11681/ws/p2p/16Uiu2HAm5syok4GX4D2aiMzqStnaqkNkygJPLgjCG3LthHJxnRPV"],"enrUri":"enr:-LO4QLpFcOfrV02mdLejiajqr0hi-apqg03T3g8-UJySRcdzdOFJIBpLPg5mALH_EttS_RVsC0cxS4vR4gruD4-7cvkBgmlkgnY0gmlwhKwS216KbXVsdGlhZGRyc4wACgSsEtteBi2h3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKbUiCFSxoVkfkvEyGtfgmtbsSEtcpQN22x4imZiFrwkIN0Y3CCLaCDdWRwgi2ihXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11679/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.63.121/tcp/44067/p2p/16Uiu2HAm8q1YFXoZivAYdZpu66X6U1jnFrMk1kWnUBJ4ysSr4iRD"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11679/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.169.38/tcp/16370/p2p/16Uiu2HAmP7YXLN9rKQ51BHwsBzeBMCGpgnjAdC72XKQsSZFHngzM"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44066/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16369/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11679/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728361303215493376}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44066/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728361303215493376,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16369/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728361303215493376,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11679/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728361303215493376}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:11679/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 2d2358bf2844
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 0079ebaac932
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id bd947264b3d3
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.