[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_missing_payload with id: 2024-09-04_04-24-44__d96962d9-7383-4a5c-b0a7-be101f30507c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-04_04-24-44__d96962d9-7383-4a5c-b0a7-be101f30507c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.169.49
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['60305', '60306', '60307', '60308', '60309']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 60305:60305 -p 60306:60306 -p 60307:60307 -p 60308:60308 -p 60309:60309 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60307 --rest-port=60305 --tcp-port=60306 --discv5-udp-port=60308 --rest-address=0.0.0.0 --nat=extip:172.18.169.49 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=45dd0dfc2a2fcfedd86fef8fb3beb539ccebfd6d4daadffecd0371e87dffbfd1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60309 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.169.49 waku 8cdb9fdae890a5b473c5189e918d3a69f65704dec49930e4a884c20581507e48
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 8cdb9fdae890. Setting up logs at ./log/docker/node1_2024-09-04_04-24-44__d96962d9-7383-4a5c-b0a7-be101f30507c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 60305
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60305/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60305/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.169.49/tcp/60306/p2p/16Uiu2HAmNpoqSXvCg3dJr2KxwzmFno1k4gSTHPujRjSoQW6Semgk","/ip4/172.18.169.49/tcp/60307/ws/p2p/16Uiu2HAmNpoqSXvCg3dJr2KxwzmFno1k4gSTHPujRjSoQW6Semgk"],"enrUri":"enr:-LO4QMYRBmPO2CI6UmOLFoLNm9NCuP5V6oWFgwQwea3Yb5v6LSnsK2Jy41fDQzoQJHI70CVIad0-AsyEwrlldQ1BRkwBgmlkgnY0gmlwhKwSqTGKbXVsdGlhZGRyc4wACgSsEqkxBuuT3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOXGMnVy0i06s4IZe-KccI6_zr3j3nfj_bcLHbplyMsaYN0Y3CC65KDdWRwguuUhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-04_04-24-44__d96962d9-7383-4a5c-b0a7-be101f30507c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.97.34
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['15584', '15585', '15586', '15587', '15588']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 15584:15584 -p 15585:15585 -p 15586:15586 -p 15587:15587 -p 15588:15588 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15586 --rest-port=15584 --tcp-port=15585 --discv5-udp-port=15587 --rest-address=0.0.0.0 --nat=extip:172.18.97.34 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bd31d89f7adb77c5ecfbf8e5beda4a6e9a3d0c0cf44171b5654d1bb87c10cec5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15588 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QMYRBmPO2CI6UmOLFoLNm9NCuP5V6oWFgwQwea3Yb5v6LSnsK2Jy41fDQzoQJHI70CVIad0-AsyEwrlldQ1BRkwBgmlkgnY0gmlwhKwSqTGKbXVsdGlhZGRyc4wACgSsEqkxBuuT3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOXGMnVy0i06s4IZe-KccI6_zr3j3nfj_bcLHbplyMsaYN0Y3CC65KDdWRwguuUhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.97.34 waku 755ac6fed15788bae874974a33458cd041d0af5d59120e4e09f26496f077dbf9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 755ac6fed157. Setting up logs at ./log/docker/node2_2024-09-04_04-24-44__d96962d9-7383-4a5c-b0a7-be101f30507c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 15584
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15584/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15584/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.34/tcp/15585/p2p/16Uiu2HAm9jvwCgAoWMpL361KRrjgFTVkSads1J1EinKEPmdnm9ng","/ip4/172.18.97.34/tcp/15586/ws/p2p/16Uiu2HAm9jvwCgAoWMpL361KRrjgFTVkSads1J1EinKEPmdnm9ng"],"enrUri":"enr:-LO4QN52v4GEDwKDi9P3BOw9rjdKzeW-FQO8VAVXQxn9ryWTXfflJF2UNZqV3ki15RL9qOjqN1uKaPWJO1G_T1mx6ygBgmlkgnY0gmlwhKwSYSKKbXVsdGlhZGRyc4wACgSsEmEiBjzi3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLUsPtH_fX_bByrR0odFsUIpVZC--X5pvJK_BqbBT6vqYN0Y3CCPOGDdWRwgjzjhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15584/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.169.49/tcp/60306/p2p/16Uiu2HAmNpoqSXvCg3dJr2KxwzmFno1k4gSTHPujRjSoQW6Semgk"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60305/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15584/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1725423888035767040,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15584/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1725423888035767040,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 8cdb9fdae890
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 755ac6fed157
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.