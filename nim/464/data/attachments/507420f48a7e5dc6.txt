[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-11-26_04-16-07__bdd54c54-658f-4c91-88e3-de3790cdb1bc
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-26_04-16-07__bdd54c54-658f-4c91-88e3-de3790cdb1bc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.218.144
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['46901', '46902', '46903', '46904', '46905']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 46901:46901 -p 46902:46902 -p 46903:46903 -p 46904:46904 -p 46905:46905 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46903 --rest-port=46901 --tcp-port=46902 --discv5-udp-port=46904 --rest-address=0.0.0.0 --nat=extip:172.18.218.144 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ddecffd6e844a86efdafb7f1d0e593cb195ca567afca38c2efeaff7f3dfbdcec --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46905 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.218.144 waku 46402ad403697b4ca576e9dfda07041e69b7df16629dc1acc48bfe83320c4a9b
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b638b991d883. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 46402ad40369. Setting up logs at ./log/docker/receiving_node1_2024-11-26_04-16-07__bdd54c54-658f-4c91-88e3-de3790cdb1bc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 46901
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46901/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46901/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.218.144/tcp/46902/p2p/16Uiu2HAm2pFCbLTiYS79YKNBpcqpiENCyPBASoxJpKKGqawpKA4G","/ip4/172.18.218.144/tcp/46903/ws/p2p/16Uiu2HAm2pFCbLTiYS79YKNBpcqpiENCyPBASoxJpKKGqawpKA4G"],"enrUri":"enr:-L24QFV6btTibxOds2nMcJnaO6FYnu6pi4EmZuBvBSaBXpkvRoMDRQNbtbhNx3aC64UpD4HSbKIADWCPc3aPivs6FM0CgmlkgnY0gmlwhKwS2pCKbXVsdGlhZGRyc5YACASsEtqQBrc2AAoErBLakAa3N90DgnJzhQADAQAAiXNlY3AyNTZrMaECbcomJm0-HCIBLMqKZ5au8-LZcUkqQaRPYpZA6gXUXMGDdGNwgrc2g3VkcIK3OIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-26_04-16-07__bdd54c54-658f-4c91-88e3-de3790cdb1bc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.103.3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29704', '29705', '29706', '29707', '29708']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29704:29704 -p 29705:29705 -p 29706:29706 -p 29707:29707 -p 29708:29708 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29706 --rest-port=29704 --tcp-port=29705 --discv5-udp-port=29707 --rest-address=0.0.0.0 --nat=extip:172.18.103.3 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=48e93a2c7cdd44cdd2b99daab0ed8dc96e10b8baf577a7cf105a1a9db2a7e1cb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29708 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.103.3 waku 7dd327d384e4a6a4e60697c882fadd32439c182fb9fb564803578f42b85ef758
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 7dd327d384e4. Setting up logs at ./log/docker/receiving_node2_2024-11-26_04-16-07__bdd54c54-658f-4c91-88e3-de3790cdb1bc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 29704
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29704/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29704/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.103.3/tcp/29705/p2p/16Uiu2HAmBxVh4Gk1KkNyoyYKyDoy1w9Q5QTy6psEkYv3xUJZqu9j","/ip4/172.18.103.3/tcp/29706/ws/p2p/16Uiu2HAmBxVh4Gk1KkNyoyYKyDoy1w9Q5QTy6psEkYv3xUJZqu9j"],"enrUri":"enr:-L24QB_l0Stu4fQnJM2JemCqPD6sJmef47XD-1psLGGXkqBlOuKZO2xF1oqZNegpfqvzXdPgYtFOyMfQxj_XbBGlEvQCgmlkgnY0gmlwhKwSZwOKbXVsdGlhZGRyc5YACASsEmcDBnQJAAoErBJnAwZ0Ct0DgnJzhQADAQAAiXNlY3AyNTZrMaEC9aBc0wDE7XwFFphKUBBJ7yRmyASQYmYhjzfrumYK2KqDdGNwgnQJg3VkcIJ0C4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29704/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.218.144/tcp/46902/p2p/16Uiu2HAm2pFCbLTiYS79YKNBpcqpiENCyPBASoxJpKKGqawpKA4G"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-26_04-16-07__bdd54c54-658f-4c91-88e3-de3790cdb1bc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.82.155
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['36547', '36548', '36549', '36550', '36551']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 36547:36547 -p 36548:36548 -p 36549:36549 -p 36550:36550 -p 36551:36551 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36549 --rest-port=36547 --tcp-port=36548 --discv5-udp-port=36550 --rest-address=0.0.0.0 --nat=extip:172.18.82.155 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=783ddd5ff10cb40ffcbcbb66c458191bd87dbed6a9ca4ea87fc80a95e8fd1e73 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36551 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QFV6btTibxOds2nMcJnaO6FYnu6pi4EmZuBvBSaBXpkvRoMDRQNbtbhNx3aC64UpD4HSbKIADWCPc3aPivs6FM0CgmlkgnY0gmlwhKwS2pCKbXVsdGlhZGRyc5YACASsEtqQBrc2AAoErBLakAa3N90DgnJzhQADAQAAiXNlY3AyNTZrMaECbcomJm0-HCIBLMqKZ5au8-LZcUkqQaRPYpZA6gXUXMGDdGNwgrc2g3VkcIK3OIV3YWt1Mgk --lightpushnode=/ip4/172.18.218.144/tcp/46902/p2p/16Uiu2HAm2pFCbLTiYS79YKNBpcqpiENCyPBASoxJpKKGqawpKA4G --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.82.155 waku 1a514515a6301eb456c945500f3d71528d9ffee7bc7a3e82b3857f096331c4fa
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 1a514515a630. Setting up logs at ./log/docker/lightpush_node1_2024-11-26_04-16-07__bdd54c54-658f-4c91-88e3-de3790cdb1bc__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 36547
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36547/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36547/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.82.155/tcp/36548/p2p/16Uiu2HAm7ETbrKGpbfEh4cakgLBBaZx323NuhFeAJaCBzh2eCGMM","/ip4/172.18.82.155/tcp/36549/ws/p2p/16Uiu2HAm7ETbrKGpbfEh4cakgLBBaZx323NuhFeAJaCBzh2eCGMM"],"enrUri":"enr:-L24QGWfSmGvBaqzlAKu5npB95BMYMUwmEZ_bVsX0IrDYr2dFjDtfPpXtj36YMNncWv7K81YxsWvIQrN2ZLXehj_ahwCgmlkgnY0gmlwhKwSUpuKbXVsdGlhZGRyc5YACASsElKbBo7EAAoErBJSmwaOxd0DgnJzhQADAQAAiXNlY3AyNTZrMaECr2zbpmQWpX8iMIoMNHWTvP7DrxC8QVR2nuYIvAlwNuCDdGNwgo7Eg3VkcIKOxoV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.218.144/tcp/46902/p2p/16Uiu2HAm2pFCbLTiYS79YKNBpcqpiENCyPBASoxJpKKGqawpKA4G"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.103.3/tcp/29705/p2p/16Uiu2HAmBxVh4Gk1KkNyoyYKyDoy1w9Q5QTy6psEkYv3xUJZqu9j"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46901/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29704/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732594573107479808}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36547/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732594573112238848}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36547/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732594573119095552}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36547/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732594573124889344}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36547/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732594573128118528}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36547/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36547/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732594573131470848}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36547/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 46402ad40369
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 7dd327d384e4
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 46402ad40369. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 1a514515a630
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 7dd327d384e4. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.