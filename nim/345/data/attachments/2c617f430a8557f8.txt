[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_missing_payload with id: 2024-09-05_04-24-03__5201d071-5c31-4bb4-b526-4d67a23c13a5
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-05_04-24-03__5201d071-5c31-4bb4-b526-4d67a23c13a5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.13.48
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['38283', '38284', '38285', '38286', '38287']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 38283:38283 -p 38284:38284 -p 38285:38285 -p 38286:38286 -p 38287:38287 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38285 --rest-port=38283 --tcp-port=38284 --discv5-udp-port=38286 --rest-address=0.0.0.0 --nat=extip:172.18.13.48 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fdfd9a4ec46e3cdafaf53cc883fe12dc50ede2a97bf860ce64362fefe7ca9608 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38287 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.13.48 waku 735453bc5432625c1c9b19074b4ad2c42ddb722ccf56b37c58aeb1d13e10454b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 735453bc5432. Setting up logs at ./log/docker/node1_2024-09-05_04-24-03__5201d071-5c31-4bb4-b526-4d67a23c13a5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 38283
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38283/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38283/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.13.48/tcp/38284/p2p/16Uiu2HAmJbL9JprAB1n4aicBKumtuUYMeFhgf3WsyEvEfBpnfbg3","/ip4/172.18.13.48/tcp/38285/ws/p2p/16Uiu2HAmJbL9JprAB1n4aicBKumtuUYMeFhgf3WsyEvEfBpnfbg3"],"enrUri":"enr:-LO4QMZGheVUiBuEEgNIRdjdpXLCPJOZ3KjSfGnwhVk6MjqMAyfgBAd1vJXwIA0i5w8aKrq3feILfwsbIpPVrlZ_Ce8BgmlkgnY0gmlwhKwSDTCKbXVsdGlhZGRyc4wACgSsEg0wBpWN3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNYNi3GlKIx6jhhsc3JHg5DC9oV_xFW2aE-s2lqK1k-QIN0Y3CClYyDdWRwgpWOhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-05_04-24-03__5201d071-5c31-4bb4-b526-4d67a23c13a5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.158.175
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['31320', '31321', '31322', '31323', '31324']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 31320:31320 -p 31321:31321 -p 31322:31322 -p 31323:31323 -p 31324:31324 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31322 --rest-port=31320 --tcp-port=31321 --discv5-udp-port=31323 --rest-address=0.0.0.0 --nat=extip:172.18.158.175 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fdb06fea102ada9fec7087bdda08a8f3eb2418de36acdb39f7b1ccb9dfdd9836 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31324 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QMZGheVUiBuEEgNIRdjdpXLCPJOZ3KjSfGnwhVk6MjqMAyfgBAd1vJXwIA0i5w8aKrq3feILfwsbIpPVrlZ_Ce8BgmlkgnY0gmlwhKwSDTCKbXVsdGlhZGRyc4wACgSsEg0wBpWN3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNYNi3GlKIx6jhhsc3JHg5DC9oV_xFW2aE-s2lqK1k-QIN0Y3CClYyDdWRwgpWOhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.158.175 waku 65ce03cf8e54e95037a07c3ca2a0135d6c9b81b374d1169841c883ea957117e3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 65ce03cf8e54. Setting up logs at ./log/docker/node2_2024-09-05_04-24-03__5201d071-5c31-4bb4-b526-4d67a23c13a5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 31320
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31320/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31320/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.175/tcp/31321/p2p/16Uiu2HAmLhtZZqNgiSnuEvjVnG77BPAoZcyRQUyPMxEV1ndC7As1","/ip4/172.18.158.175/tcp/31322/ws/p2p/16Uiu2HAmLhtZZqNgiSnuEvjVnG77BPAoZcyRQUyPMxEV1ndC7As1"],"enrUri":"enr:-LO4QJ3LS4WZ5aJv4fRxnlZ_xsFLtICD9gESCTgi1H1mV6zPFPxiVN1dqQNniDBznFaevgcL9Gwn0fn21ZPPnBhqOYwBgmlkgnY0gmlwhKwSnq-KbXVsdGlhZGRyc4wACgSsEp6vBnpa3QOCcnOFAAMBAACJc2VjcDI1NmsxoQN3m7FlkTFRkIDz_Ea064H1ArH7xkCTd2TP7hkMoH3b-IN0Y3CCelmDdWRwgnpbhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31320/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.13.48/tcp/38284/p2p/16Uiu2HAmJbL9JprAB1n4aicBKumtuUYMeFhgf3WsyEvEfBpnfbg3"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38283/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31320/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38283/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38283/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1725510247196197888,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31320/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1725510247196197888,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38283/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:38283/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 735453bc5432
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 65ce03cf8e54
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.