[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-09-05_04-22-47__3bc63396-d040-49bd-8656-02a9712fb602
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-05_04-22-47__3bc63396-d040-49bd-8656-02a9712fb602__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.206.142
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['3727', '3728', '3729', '3730', '3731']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 3727:3727 -p 3728:3728 -p 3729:3729 -p 3730:3730 -p 3731:3731 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3729 --rest-port=3727 --tcp-port=3728 --discv5-udp-port=3730 --rest-address=0.0.0.0 --nat=extip:172.18.206.142 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=182daabdcb9c2f857ca3dcba2a9d3d361f5c8b0baf0fff72973bedc677bcdc6b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3731 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.206.142 waku 282d06743397c4ee2a255c90c9403916eec2e554447e9db55a70930190768a0d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 282d06743397. Setting up logs at ./log/docker/receiving_node1_2024-09-05_04-22-47__3bc63396-d040-49bd-8656-02a9712fb602__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3727
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3727/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3727/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.206.142/tcp/3728/p2p/16Uiu2HAm7gHasK5NWHxRBGY7CnGUTKNx9k2y1W4BcEgTJTVDxC49","/ip4/172.18.206.142/tcp/3729/ws/p2p/16Uiu2HAm7gHasK5NWHxRBGY7CnGUTKNx9k2y1W4BcEgTJTVDxC49"],"enrUri":"enr:-LO4QBwkTydTooc4eoHmBgqhLmhzcx-ZOGQQW9Rn2Zzze7pqJdtQEoTi87oHIXvZiCcHZ6H7huncCd5Y2gAIkg7Xy1QBgmlkgnY0gmlwhKwSzo6KbXVsdGlhZGRyc4wACgSsEs6OBg6R3QOCcnOFAAMBAACJc2VjcDI1NmsxoQK2CqICTfGZcsbvCt2zn_sDSi9DnhxHNk5sVdNIFNj7GoN0Y3CCDpCDdWRwgg6ShXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-05_04-22-47__3bc63396-d040-49bd-8656-02a9712fb602__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.183.247
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['45309', '45310', '45311', '45312', '45313']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 45309:45309 -p 45310:45310 -p 45311:45311 -p 45312:45312 -p 45313:45313 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45311 --rest-port=45309 --tcp-port=45310 --discv5-udp-port=45312 --rest-address=0.0.0.0 --nat=extip:172.18.183.247 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5ec842ddaeaa3d0bdfbdfbbbc444c9959c5b5ff183a7ea4b88f02ebf2a98ab77 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45313 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.183.247 waku e2d79594ec1f40acb6f75ba1226f7ef50f4c3d328c6dd74d72463382122de2f5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e2d79594ec1f. Setting up logs at ./log/docker/receiving_node2_2024-09-05_04-22-47__3bc63396-d040-49bd-8656-02a9712fb602__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 45309
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45309/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45309/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.183.247/tcp/45310/p2p/16Uiu2HAmAjdeB7o4hVvo2exaTbJNBp7uL7Xv5NLnMCymUyb7YDJR","/ip4/172.18.183.247/tcp/45311/ws/p2p/16Uiu2HAmAjdeB7o4hVvo2exaTbJNBp7uL7Xv5NLnMCymUyb7YDJR"],"enrUri":"enr:-LO4QKV_zvKXec6dRJeSuUkheczGO28uXGsIwfKWCGuzGtB0NY3J5Pkh1yZ4I2rG3zPfG_9zpDu5q0QiUNe2qDj3SQUBgmlkgnY0gmlwhKwSt_eKbXVsdGlhZGRyc4wACgSsErf3BrD_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLjeR1WIPv-gdKs-4cRo7LSk7pa4NmLlKcaAV0d9pTrmoN0Y3CCsP6DdWRwgrEAhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45309/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.206.142/tcp/3728/p2p/16Uiu2HAm7gHasK5NWHxRBGY7CnGUTKNx9k2y1W4BcEgTJTVDxC49"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-05_04-22-47__3bc63396-d040-49bd-8656-02a9712fb602__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.177.87
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['45094', '45095', '45096', '45097', '45098']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 45094:45094 -p 45095:45095 -p 45096:45096 -p 45097:45097 -p 45098:45098 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45096 --rest-port=45094 --tcp-port=45095 --discv5-udp-port=45097 --rest-address=0.0.0.0 --nat=extip:172.18.177.87 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2686caa17912c6cecfcc5d2ecbb1ad0fe1ff86b4ae4b0117acc9c7a4fdbefffb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45098 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QBwkTydTooc4eoHmBgqhLmhzcx-ZOGQQW9Rn2Zzze7pqJdtQEoTi87oHIXvZiCcHZ6H7huncCd5Y2gAIkg7Xy1QBgmlkgnY0gmlwhKwSzo6KbXVsdGlhZGRyc4wACgSsEs6OBg6R3QOCcnOFAAMBAACJc2VjcDI1NmsxoQK2CqICTfGZcsbvCt2zn_sDSi9DnhxHNk5sVdNIFNj7GoN0Y3CCDpCDdWRwgg6ShXdha3UyCQ --lightpushnode=/ip4/172.18.206.142/tcp/3728/p2p/16Uiu2HAm7gHasK5NWHxRBGY7CnGUTKNx9k2y1W4BcEgTJTVDxC49 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.177.87 waku 9c212441a30f3ded001a31c6b3907412366cf3c91e6c09d8c00f2fab2e774d52
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9c212441a30f. Setting up logs at ./log/docker/lightpush_node1_2024-09-05_04-22-47__3bc63396-d040-49bd-8656-02a9712fb602__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 45094
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45094/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45094/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.87/tcp/45095/p2p/16Uiu2HAkxP82ZprNy6Mbp9TzqdcHehzrc9TLPvswG8CYJdHokoiv","/ip4/172.18.177.87/tcp/45096/ws/p2p/16Uiu2HAkxP82ZprNy6Mbp9TzqdcHehzrc9TLPvswG8CYJdHokoiv"],"enrUri":"enr:-LO4QKsFZRuy2jfq8OPmkanBrP1kd9gAeDQGS8PS2_pO4J9jAH5PsKq2tRUcbAIjObsBwIyaoBMLW9U7jwWDNV46QE4BgmlkgnY0gmlwhKwSsVeKbXVsdGlhZGRyc4wACgSsErFXBrAo3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIr68VNO3NRZVfZXYCRgP1fLYaz410Y4u3-k1aAyEUCD4N0Y3CCsCeDdWRwgrAphXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45094/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.206.142/tcp/3728/p2p/16Uiu2HAm7gHasK5NWHxRBGY7CnGUTKNx9k2y1W4BcEgTJTVDxC49"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45094/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.183.247/tcp/45310/p2p/16Uiu2HAmAjdeB7o4hVvo2exaTbJNBp7uL7Xv5NLnMCymUyb7YDJR"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3727/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45309/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45094/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1725510172607642112}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3727/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1725510172607642112,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.206.142/tcp/3728"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.206.142/tcp/3728"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 282d06743397
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e2d79594ec1f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9c212441a30f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.