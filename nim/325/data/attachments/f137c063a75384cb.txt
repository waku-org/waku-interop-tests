[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_get_message_after_node1_restarts with id: 2024-08-20_09-02-55__7e806682-5dfb-482b-8fc6-cb0b75f61051
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-20_09-02-55__7e806682-5dfb-482b-8fc6-cb0b75f61051__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.113.160
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['54752', '54753', '54754', '54755', '54756']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 54752:54752 -p 54753:54753 -p 54754:54754 -p 54755:54755 -p 54756:54756 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54754 --rest-port=54752 --tcp-port=54753 --discv5-udp-port=54755 --rest-address=0.0.0.0 --nat=extip:172.18.113.160 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6fc9dbde5313b7ea8b115f7b8b305cbaad656c52dff3dafbcafbbbabf498ddde --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54756 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.113.160 waku 760a66db21e10c4d2e4ad45fc46a61a59f1616a2b9e3c6d963f6ff1f34e5dd5b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 760a66db21e1. Setting up logs at ./log/docker/node1_2024-08-20_09-02-55__7e806682-5dfb-482b-8fc6-cb0b75f61051__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 54752
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54752/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54752/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.113.160/tcp/54753/p2p/16Uiu2HAmGs61QQd9Ljqx2hcgRAGQ8Ftab1BJwjcfbveAJucXd7fc","/ip4/172.18.113.160/tcp/54754/ws/p2p/16Uiu2HAmGs61QQd9Ljqx2hcgRAGQ8Ftab1BJwjcfbveAJucXd7fc"],"enrUri":"enr:-LO4QKH-g5UBq4Xx7JI9hzGIC0JLHJ8v7UiMkATO4efKV4RzMAobZHewP7S8kA4uh2VIjQYOiOWc9MNWbXTCukqCgAoBgmlkgnY0gmlwhKwScaCKbXVsdGlhZGRyc4wACgSsEnGgBtXi3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM-iB0tLTQfGktqMIzhgdCq6VTJG5Z_maZRThrMaUyId4N0Y3CC1eGDdWRwgtXjhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-20_09-02-55__7e806682-5dfb-482b-8fc6-cb0b75f61051__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.247.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['30986', '30987', '30988', '30989', '30990']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 30986:30986 -p 30987:30987 -p 30988:30988 -p 30989:30989 -p 30990:30990 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30988 --rest-port=30986 --tcp-port=30987 --discv5-udp-port=30989 --rest-address=0.0.0.0 --nat=extip:172.18.247.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1e1e5ce6b33c1dad2c1c0d8bcba6134df442a43ea762ec98ce8007c3a48f50d8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30990 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QKH-g5UBq4Xx7JI9hzGIC0JLHJ8v7UiMkATO4efKV4RzMAobZHewP7S8kA4uh2VIjQYOiOWc9MNWbXTCukqCgAoBgmlkgnY0gmlwhKwScaCKbXVsdGlhZGRyc4wACgSsEnGgBtXi3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM-iB0tLTQfGktqMIzhgdCq6VTJG5Z_maZRThrMaUyId4N0Y3CC1eGDdWRwgtXjhXdha3UyBQ --filternode=/ip4/172.18.113.160/tcp/54753/p2p/16Uiu2HAmGs61QQd9Ljqx2hcgRAGQ8Ftab1BJwjcfbveAJucXd7fc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.247.183 waku a3ac8d5c8a99ad387f9dbcfcf3b35bc33ea5b822ca9ebd80c2407507802299c2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a3ac8d5c8a99. Setting up logs at ./log/docker/node2_2024-08-20_09-02-55__7e806682-5dfb-482b-8fc6-cb0b75f61051__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 30986
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30986/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30986/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.247.183/tcp/30987/p2p/16Uiu2HAkz4KgQWf5pQYsqEAEBCLnSxGRrj5Gh9rLTymvYKQbixfs","/ip4/172.18.247.183/tcp/30988/ws/p2p/16Uiu2HAkz4KgQWf5pQYsqEAEBCLnSxGRrj5Gh9rLTymvYKQbixfs"],"enrUri":"enr:-LO4QGnpwgMfxkyDp91DEVK0KG1kVN7vc7E8gr7nSGYf3V10EcvD3y5FSGrjv-56fhUIEAojj1ZoXCjVr93UGkFG2iMBgmlkgnY0gmlwhKwS97eKbXVsdGlhZGRyc4wACgSsEve3BnkM3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJE0kjb3ry0zxknJIf1s67sglFXKk4z9OLwkLiwS74ccoN0Y3CCeQuDdWRwgnkNhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30986/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.113.160/tcp/54753/p2p/16Uiu2HAmGs61QQd9Ljqx2hcgRAGQ8Ftab1BJwjcfbveAJucXd7fc"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54752/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30986/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "2ad53df0-b7ea-4300-908f-be142750bbcc", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"2ad53df0-b7ea-4300-908f-be142750bbcc","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54752/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30986/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1724144578652421120,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:243 Restarting container with id 760a66db21e1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54752/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:54752/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.113.160/tcp/54753/p2p/16Uiu2HAmGs61QQd9Ljqx2hcgRAGQ8Ftab1BJwjcfbveAJucXd7fc","/ip4/172.18.113.160/tcp/54754/ws/p2p/16Uiu2HAmGs61QQd9Ljqx2hcgRAGQ8Ftab1BJwjcfbveAJucXd7fc"],"enrUri":"enr:-LO4QKH-g5UBq4Xx7JI9hzGIC0JLHJ8v7UiMkATO4efKV4RzMAobZHewP7S8kA4uh2VIjQYOiOWc9MNWbXTCukqCgAoBgmlkgnY0gmlwhKwScaCKbXVsdGlhZGRyc4wACgSsEnGgBtXi3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM-iB0tLTQfGktqMIzhgdCq6VTJG5Z_maZRThrMaUyId4N0Y3CC1eGDdWRwgtXjhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54752/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30986/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "37a39f33-90dd-4297-8e00-f5cac62e7cf1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"37a39f33-90dd-4297-8e00-f5cac62e7cf1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:54752/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30986/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1724144583862093824,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 760a66db21e1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id a3ac8d5c8a99
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.