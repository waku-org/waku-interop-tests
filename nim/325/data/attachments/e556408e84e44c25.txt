[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_add_a_new_content_topic with id: 2024-08-20_09-04-52__6587652d-e49a-4d9d-a885-8733883cb44f
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-20_09-04-52__6587652d-e49a-4d9d-a885-8733883cb44f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.123.21
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['52841', '52842', '52843', '52844', '52845']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 52841:52841 -p 52842:52842 -p 52843:52843 -p 52844:52844 -p 52845:52845 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52843 --rest-port=52841 --tcp-port=52842 --discv5-udp-port=52844 --rest-address=0.0.0.0 --nat=extip:172.18.123.21 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1f4ef501cfbfb6d600943dfbfcad66fe0c0cbea3cdfadf27c00eefadfb15f7a1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52845 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.123.21 waku abbb5d54c595fc31fb7340c6b20553d6210ef473778c6eb96941d248ec46629e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID abbb5d54c595. Setting up logs at ./log/docker/node1_2024-08-20_09-04-52__6587652d-e49a-4d9d-a885-8733883cb44f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 52841
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52841/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52841/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.123.21/tcp/52842/p2p/16Uiu2HAmR4MGCF5eo2iqcnC8PtbKg91TPFLMeLB4haU7AgNfVTjQ","/ip4/172.18.123.21/tcp/52843/ws/p2p/16Uiu2HAmR4MGCF5eo2iqcnC8PtbKg91TPFLMeLB4haU7AgNfVTjQ"],"enrUri":"enr:-LO4QFny0BdZCFAax72YznynR50sRRVkQemth2jxTqE5SxP7U12qhzKkiz7uIm5aIDUkWMpx8N-piII2Un8NPO_Cy2wBgmlkgnY0gmlwhKwSexWKbXVsdGlhZGRyc4wACgSsEnsVBs5r3QOCcnOFAAMBAACJc2VjcDI1NmsxoQO4SD9GhzAygxL9ravlTZaBcv-1UXeKaK5o4IQ-RiFcY4N0Y3CCzmqDdWRwgs5shXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-20_09-04-52__6587652d-e49a-4d9d-a885-8733883cb44f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.46.60
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['9598', '9599', '9600', '9601', '9602']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 9598:9598 -p 9599:9599 -p 9600:9600 -p 9601:9601 -p 9602:9602 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9600 --rest-port=9598 --tcp-port=9599 --discv5-udp-port=9601 --rest-address=0.0.0.0 --nat=extip:172.18.46.60 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7cf0facb25a0dcfec6db2e0d51d1dca789f0defe8fb67b33caa8db1d2bfcfd37 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9602 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QFny0BdZCFAax72YznynR50sRRVkQemth2jxTqE5SxP7U12qhzKkiz7uIm5aIDUkWMpx8N-piII2Un8NPO_Cy2wBgmlkgnY0gmlwhKwSexWKbXVsdGlhZGRyc4wACgSsEnsVBs5r3QOCcnOFAAMBAACJc2VjcDI1NmsxoQO4SD9GhzAygxL9ravlTZaBcv-1UXeKaK5o4IQ-RiFcY4N0Y3CCzmqDdWRwgs5shXdha3UyBQ --filternode=/ip4/172.18.123.21/tcp/52842/p2p/16Uiu2HAmR4MGCF5eo2iqcnC8PtbKg91TPFLMeLB4haU7AgNfVTjQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.46.60 waku b32c60b230e9aa63ef90c22d61da8f729ca2966fb44b3832d72d2d99b61a4369
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID b32c60b230e9. Setting up logs at ./log/docker/node2_2024-08-20_09-04-52__6587652d-e49a-4d9d-a885-8733883cb44f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 9598
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9598/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9598/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.46.60/tcp/9599/p2p/16Uiu2HAm6uS8izLc5CpnNyt6douzd5sc6AMsCrYoa5ybVQ61RijT","/ip4/172.18.46.60/tcp/9600/ws/p2p/16Uiu2HAm6uS8izLc5CpnNyt6douzd5sc6AMsCrYoa5ybVQ61RijT"],"enrUri":"enr:-LO4QI9MWikgqN5Qt0RKeqdSIP0HXX2Z7f6Zy4AijHonWGTiebMhZTESex4pESoei1Iw6Nu40Nu97KBDpuEnnBdu-w8BgmlkgnY0gmlwhKwSLjyKbXVsdGlhZGRyc4wACgSsEi48BiWA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKqjSnBYmBrfjWtVZnxGF7pXZNFHCGQdCOHxfj85X-EAoN0Y3CCJX-DdWRwgiWBhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9598/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.123.21/tcp/52842/p2p/16Uiu2HAmR4MGCF5eo2iqcnC8PtbKg91TPFLMeLB4haU7AgNfVTjQ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52841/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9598/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "9c808782-e4c4-4b7b-81fd-21c241c8b04c", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"9c808782-e4c4-4b7b-81fd-21c241c8b04c","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:9598/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9598/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1724144695633170432,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52841/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9598/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1724144695749710080,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id abbb5d54c595
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id b32c60b230e9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.