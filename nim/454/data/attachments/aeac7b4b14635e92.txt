[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_refresh_existing with id: 2024-11-18_10-09-09__232b9162-28e7-43d6-85af-9df74f99e831
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-18_10-09-09__232b9162-28e7-43d6-85af-9df74f99e831__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.79.143
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['51589', '51590', '51591', '51592', '51593']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 51589:51589 -p 51590:51590 -p 51591:51591 -p 51592:51592 -p 51593:51593 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51591 --rest-port=51589 --tcp-port=51590 --discv5-udp-port=51592 --rest-address=0.0.0.0 --nat=extip:172.18.79.143 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=103e74e1dc6390eae67ab2756d1ab67faaae7081fd0a1d5ad66efecfc302da80 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51593 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.79.143 waku adb26009a029c2b1ddcc385accbfafd0615d52ac8d581bc58d6d18f506530ec8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID adb26009a029. Setting up logs at ./log/docker/node1_2024-11-18_10-09-09__232b9162-28e7-43d6-85af-9df74f99e831__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 51589
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 1becef93e033. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51589/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51589/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.79.143/tcp/51590/p2p/16Uiu2HAmA9ByUtWWNwcXFmgp2G2Xsi7cNWVgWRV4WazqpL7Uaiqr","/ip4/172.18.79.143/tcp/51591/ws/p2p/16Uiu2HAmA9ByUtWWNwcXFmgp2G2Xsi7cNWVgWRV4WazqpL7Uaiqr"],"enrUri":"enr:-L24QOXF4Wv9LIQGXdF1m8W_xWohWJIij_pydbOFsMuYz1wAd6ygZS_k4OqDci77CWjavpFOiCfS_A8xMtIm_PTJbbUCgmlkgnY0gmlwhKwST4-KbXVsdGlhZGRyc5YACASsEk-PBsmGAAoErBJPjwbJh90DgnJzhQADAQAAiXNlY3AyNTZrMaEC2qZYXQMMYSkvw4pmdoKzk2sNn2Jrj-Nn3Vya2Rz7Qa2DdGNwgsmGg3VkcILJiIV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-18_10-09-09__232b9162-28e7-43d6-85af-9df74f99e831__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.237.242
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['11995', '11996', '11997', '11998', '11999']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 11995:11995 -p 11996:11996 -p 11997:11997 -p 11998:11998 -p 11999:11999 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11997 --rest-port=11995 --tcp-port=11996 --discv5-udp-port=11998 --rest-address=0.0.0.0 --nat=extip:172.18.237.242 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=03edf202fbbbed6b5d6c7869ff92dac636b4097319acf20bfceefdbe38bbdcb2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11999 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QOXF4Wv9LIQGXdF1m8W_xWohWJIij_pydbOFsMuYz1wAd6ygZS_k4OqDci77CWjavpFOiCfS_A8xMtIm_PTJbbUCgmlkgnY0gmlwhKwST4-KbXVsdGlhZGRyc5YACASsEk-PBsmGAAoErBJPjwbJh90DgnJzhQADAQAAiXNlY3AyNTZrMaEC2qZYXQMMYSkvw4pmdoKzk2sNn2Jrj-Nn3Vya2Rz7Qa2DdGNwgsmGg3VkcILJiIV3YWt1MgU --filternode=/ip4/172.18.79.143/tcp/51590/p2p/16Uiu2HAmA9ByUtWWNwcXFmgp2G2Xsi7cNWVgWRV4WazqpL7Uaiqr
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.237.242 waku 9c594b8221440db873cffab1cff926a7e29fb29d012ab7bdc36f5666c14738ac
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9c594b822144. Setting up logs at ./log/docker/node2_2024-11-18_10-09-09__232b9162-28e7-43d6-85af-9df74f99e831__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 11995
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11995/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11995/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.237.242/tcp/11996/p2p/16Uiu2HAm1SncxhAMov7DKZ6YPqPq1XP3i8b3b6Zfuh7DtQa8YQKt","/ip4/172.18.237.242/tcp/11997/ws/p2p/16Uiu2HAm1SncxhAMov7DKZ6YPqPq1XP3i8b3b6Zfuh7DtQa8YQKt"],"enrUri":"enr:-L24QFeUiBX1qoJO9xpX5qe82dwpPMuw5qHpp5xY_tK5CWLFaCv-kDEhMdAG-d2noxLHmNufgakr5EJCo6hXeh6UMhsCgmlkgnY0gmlwhKwS7fKKbXVsdGlhZGRyc5YACASsEu3yBi7cAAoErBLt8gYu3d0DgnJzhQADAQAAiXNlY3AyNTZrMaECWW82Du-MQIapmJyS2clR66umZgsQGK2Hz6wHolpiUauDdGNwgi7cg3VkcIIu3oV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11995/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.79.143/tcp/51590/p2p/16Uiu2HAmA9ByUtWWNwcXFmgp2G2Xsi7cNWVgWRV4WazqpL7Uaiqr"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51589/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11995/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "9f3906e4-5e45-4fea-9d7c-0e5c3fb1c652", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"9f3906e4-5e45-4fea-9d7c-0e5c3fb1c652","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:11995/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51589/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11995/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1731924552763592704,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id adb26009a029
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 9c594b822144
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container adb26009a029. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.