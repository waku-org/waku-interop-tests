[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-12-18_04-14-02__5021fa29-aba1-44a6-98d8-796d7ee393dd
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-12-18_04-14-02__5021fa29-aba1-44a6-98d8-796d7ee393dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.203.160
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['39907', '39908', '39909', '39910', '39911']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 39907:39907 -p 39908:39908 -p 39909:39909 -p 39910:39910 -p 39911:39911 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39909 --rest-port=39907 --tcp-port=39908 --discv5-udp-port=39910 --rest-address=0.0.0.0 --nat=extip:172.18.203.160 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e665cc3211a3fd1b15eee9c0bdef7db94ead283e6d7cc5dd2247329a0b1de8dc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39911 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.203.160 waku a13e8c29d1fe1b08ef26ca79bf43130fe0eb51fd914137110e76d2424d209a53
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a13e8c29d1fe. Setting up logs at ./log/docker/receiving_node1_2024-12-18_04-14-02__5021fa29-aba1-44a6-98d8-796d7ee393dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 39907
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 43c27814c18d. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39907/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39907/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.203.160/tcp/39908/p2p/16Uiu2HAkxvDGYU87k5n5vsLNHGpN1hF7FjTiTf6oJVhvAe9ibTir","/ip4/172.18.203.160/tcp/39909/ws/p2p/16Uiu2HAkxvDGYU87k5n5vsLNHGpN1hF7FjTiTf6oJVhvAe9ibTir"],"enrUri":"enr:-L24QMl0h5QGZk4GURC-r6jCZ2QRetJYrnAfYVk0UcPIu4PzY8qehO-IBi0J0sQuQkTAiWrePmobrV3Lns211GCZffwCgmlkgnY0gmlwhKwSy6CKbXVsdGlhZGRyc5YACASsEsugBpvkAAoErBLLoAab5d0DgnJzhQADAQAAiXNlY3AyNTZrMaECM-Kzp_AnUq3cLh6dcDopjWAFXQkOz0dvTSALxMwH_8ODdGNwgpvkg3VkcIKb5oV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-12-18_04-14-02__5021fa29-aba1-44a6-98d8-796d7ee393dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.22.228
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['25796', '25797', '25798', '25799', '25800']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 25796:25796 -p 25797:25797 -p 25798:25798 -p 25799:25799 -p 25800:25800 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25798 --rest-port=25796 --tcp-port=25797 --discv5-udp-port=25799 --rest-address=0.0.0.0 --nat=extip:172.18.22.228 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8ba34bec27b3a46a7a64044d89adbdd1b5edf82bda3adf7786a62d1bc379193d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25800 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.22.228 waku d4fbad6bd7a911e91efe2a75a8472947559e0ac157f71f29d13068a379c9e605
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d4fbad6bd7a9. Setting up logs at ./log/docker/receiving_node2_2024-12-18_04-14-02__5021fa29-aba1-44a6-98d8-796d7ee393dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 25796
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25796/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25796/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.22.228/tcp/25797/p2p/16Uiu2HAmEjJ3e933sv9ypuTKdyEP41X3Qwh4HpHhaDqXCQgZpxA8","/ip4/172.18.22.228/tcp/25798/ws/p2p/16Uiu2HAmEjJ3e933sv9ypuTKdyEP41X3Qwh4HpHhaDqXCQgZpxA8"],"enrUri":"enr:-L24QHYlJ6g8OoZEhgrLQjE8HKPDIDojHBC2At9KI9ExTnKWH0iV4uxI-qpFTmrxTlp3Nkzk5evybD2Fwft3njNej-oCgmlkgnY0gmlwhKwSFuSKbXVsdGlhZGRyc5YACASsEhbkBmTFAAoErBIW5AZkxt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDHtG0qFbNQE3STlw-KIWqtiVLpLYUrlbcJ5hurmpBKMWDdGNwgmTFg3VkcIJkx4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25796/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.203.160/tcp/39908/p2p/16Uiu2HAkxvDGYU87k5n5vsLNHGpN1hF7FjTiTf6oJVhvAe9ibTir"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-12-18_04-14-02__5021fa29-aba1-44a6-98d8-796d7ee393dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.201.121
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['38619', '38620', '38621', '38622', '38623']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 38619:38619 -p 38620:38620 -p 38621:38621 -p 38622:38622 -p 38623:38623 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38621 --rest-port=38619 --tcp-port=38620 --discv5-udp-port=38622 --rest-address=0.0.0.0 --nat=extip:172.18.201.121 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5f0b3efa2fa0afb6a69cf856d4fb7d5b13b9acf4c69ea71bc6a3dabdbea75e6c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38623 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QMl0h5QGZk4GURC-r6jCZ2QRetJYrnAfYVk0UcPIu4PzY8qehO-IBi0J0sQuQkTAiWrePmobrV3Lns211GCZffwCgmlkgnY0gmlwhKwSy6CKbXVsdGlhZGRyc5YACASsEsugBpvkAAoErBLLoAab5d0DgnJzhQADAQAAiXNlY3AyNTZrMaECM-Kzp_AnUq3cLh6dcDopjWAFXQkOz0dvTSALxMwH_8ODdGNwgpvkg3VkcIKb5oV3YWt1Mgk --lightpushnode=/ip4/172.18.203.160/tcp/39908/p2p/16Uiu2HAkxvDGYU87k5n5vsLNHGpN1hF7FjTiTf6oJVhvAe9ibTir --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.201.121 waku 709d4e8f6886cbc9d83a6325369240de4e84edb99e8cbc9383fa26c5545ee499
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 709d4e8f6886. Setting up logs at ./log/docker/lightpush_node1_2024-12-18_04-14-02__5021fa29-aba1-44a6-98d8-796d7ee393dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 38619
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38619/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38619/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.201.121/tcp/38620/p2p/16Uiu2HAmN3odDqr9wFQNU8v9axaSxYdWqH2Ezj9rcZ3Dx6qVtg6R","/ip4/172.18.201.121/tcp/38621/ws/p2p/16Uiu2HAmN3odDqr9wFQNU8v9axaSxYdWqH2Ezj9rcZ3Dx6qVtg6R"],"enrUri":"enr:-L24QLJWRWJeDtfBWwOZwTSvI5IxZk0Ep1fFv_rLPenxKHHRQDaABXvSbukCJ9H7_R2B8Q90VyIfGUKqHzaO-5fpY2gCgmlkgnY0gmlwhKwSyXmKbXVsdGlhZGRyc5YACASsEsl5BpbcAAoErBLJeQaW3d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDi5Fp7y1GPV4jlsTqOS_fyHp3-3XoNRN66ospUdqYvC6DdGNwgpbcg3VkcIKW3oV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38619/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.203.160/tcp/39908/p2p/16Uiu2HAkxvDGYU87k5n5vsLNHGpN1hF7FjTiTf6oJVhvAe9ibTir"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38619/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.22.228/tcp/25797/p2p/16Uiu2HAmEjJ3e933sv9ypuTKdyEP41X3Qwh4HpHhaDqXCQgZpxA8"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39907/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25796/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38619/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734495246423880960, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39907/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495246423880960,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25796/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495246423880960,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38619/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1734495246550228224, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39907/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495246550228224,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25796/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495246550228224,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id a13e8c29d1fe
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d4fbad6bd7a9
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a13e8c29d1fe. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 709d4e8f6886
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d4fbad6bd7a9. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.