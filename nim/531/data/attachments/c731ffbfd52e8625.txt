[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_subscribe_and_publish_on_another_shard with id: 2024-12-18_04-19-33__d7aec031-39e8-4b06-a068-07764c076b8e
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-18_04-19-33__d7aec031-39e8-4b06-a068-07764c076b8e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.69.71
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59190', '59191', '59192', '59193', '59194']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59190:59190 -p 59191:59191 -p 59192:59192 -p 59193:59193 -p 59194:59194 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59192 --rest-port=59190 --tcp-port=59191 --discv5-udp-port=59193 --rest-address=0.0.0.0 --nat=extip:172.18.69.71 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=54f1b24fa31b45e1eeec47da10e3c7c821b44ffd8e52be16e6fc3caabda13d2f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59194 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.30.23
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['42880', '42881', '42882', '42883', '42884']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 42880:42880 -p 42881:42881 -p 42882:42882 -p 42883:42883 -p 42884:42884 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42882 --rest-port=42880 --tcp-port=42881 --discv5-udp-port=42883 --rest-address=0.0.0.0 --nat=extip:172.18.30.23 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=cb7647140d2dcfd766a2ac9badacee20cac37f740d388eff27a3f0f9db3dc4ab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42884 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ef9dcb187ed3. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.30.23 waku ad927ed21e7b59b1aa35ca78bfa9fc5f5391cdc562ae2532e6f5e233563d7197
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ad927ed21e7b. Setting up logs at ./log/docker/node1_2024-12-18_04-19-33__d7aec031-39e8-4b06-a068-07764c076b8e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 42880
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42880/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42880/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.30.23/tcp/42881/p2p/16Uiu2HAm7sFLMvgZ4LYM5jastJ7CTVszT54CGAxuJHaVCxmC2mzG","/ip4/172.18.30.23/tcp/42882/ws/p2p/16Uiu2HAm7sFLMvgZ4LYM5jastJ7CTVszT54CGAxuJHaVCxmC2mzG"],"enrUri":"enr:-L24QA4yrnUevwaWYxAnaJJPOXrokShtkVWcbi5PSL8JJUdCJwh32gCYS3PaY1lkiL-HWqS5wE2-IwMtgv-bTYxIDzcCgmlkgnY0gmlwhKwSHheKbXVsdGlhZGRyc5YACASsEh4XBqeBAAoErBIeFwangt0DgnJzhQACAQAAiXNlY3AyNTZrMaECuNl6P7U26NRGKzChIVA4UtSUqP4JQ4z9xqnVBxmgGcGDdGNwgqeBg3VkcIKng4V3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-18_04-19-33__d7aec031-39e8-4b06-a068-07764c076b8e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.77.78
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['26422', '26423', '26424', '26425', '26426']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 26422:26422 -p 26423:26423 -p 26424:26424 -p 26425:26425 -p 26426:26426 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26424 --rest-port=26422 --tcp-port=26423 --discv5-udp-port=26425 --rest-address=0.0.0.0 --nat=extip:172.18.77.78 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=0d74ec6bebda26a916328b575e723ef19e66f64fcc81ba14a9e68beecbcea742 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26426 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QA4yrnUevwaWYxAnaJJPOXrokShtkVWcbi5PSL8JJUdCJwh32gCYS3PaY1lkiL-HWqS5wE2-IwMtgv-bTYxIDzcCgmlkgnY0gmlwhKwSHheKbXVsdGlhZGRyc5YACASsEh4XBqeBAAoErBIeFwangt0DgnJzhQACAQAAiXNlY3AyNTZrMaECuNl6P7U26NRGKzChIVA4UtSUqP4JQ4z9xqnVBxmgGcGDdGNwgqeBg3VkcIKng4V3YWt1MgU --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.77.78 waku 37173847d2b29789a8401a72175b2cd8ea9990d9772069cea9142a85e59b8a92
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 37173847d2b2. Setting up logs at ./log/docker/node2_2024-12-18_04-19-33__d7aec031-39e8-4b06-a068-07764c076b8e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 26422
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26422/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26422/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.77.78/tcp/26423/p2p/16Uiu2HAmRRdxc58YxAYesGckNTnecUMU9ozye1w5VJg7SjYXsMqL","/ip4/172.18.77.78/tcp/26424/ws/p2p/16Uiu2HAmRRdxc58YxAYesGckNTnecUMU9ozye1w5VJg7SjYXsMqL"],"enrUri":"enr:-L24QFvSfHIoyGv0rUBFPg0ADcSdnEKjdV4XpaN49IzB5uspHQRN8Gw99V02L27ay3de0HJRSCg3w9PU9p0YvO196tICgmlkgnY0gmlwhKwSTU6KbXVsdGlhZGRyc5YACASsEk1OBmc3AAoErBJNTgZnON0DgnJzhQACAQAAiXNlY3AyNTZrMaEDvbxSvr1OHyl9YKcS7PjOjUWyHRlUxtdzbjR69WILwNODdGNwgmc3g3VkcIJnOYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26422/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.30.23/tcp/42881/p2p/16Uiu2HAm7sFLMvgZ4LYM5jastJ7CTVszT54CGAxuJHaVCxmC2mzG"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42880/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26422/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42880/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42880/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495576444874496,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26422/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495576444874496,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42880/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42880/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495576560495872,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26422/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1734495576560495872,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id ad927ed21e7b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 37173847d2b2
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ad927ed21e7b. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.