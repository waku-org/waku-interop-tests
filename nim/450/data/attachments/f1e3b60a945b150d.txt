[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-11-15_04-18-05__e1faee68-63b5-415a-a95f-0e729c8d46f6
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-15_04-18-05__e1faee68-63b5-415a-a95f-0e729c8d46f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.236.148
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['14630', '14631', '14632', '14633', '14634']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 14630:14630 -p 14631:14631 -p 14632:14632 -p 14633:14633 -p 14634:14634 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14632 --rest-port=14630 --tcp-port=14631 --discv5-udp-port=14633 --rest-address=0.0.0.0 --nat=extip:172.18.236.148 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ecf920afe1647b3bd4cfca8eab4a99cb126200ab67bbdeb2184a16fc3dfdc9dd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14634 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.236.148 waku 3bebef92dd9a3404f933960311b2932560673d15ff978a70bee0bf25dc40890c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3bebef92dd9a. Setting up logs at ./log/docker/receiving_node1_2024-11-15_04-18-05__e1faee68-63b5-415a-a95f-0e729c8d46f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 14630
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 347a200420dd. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14630/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14630/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.236.148/tcp/14631/p2p/16Uiu2HAm8252hZo274fo3RzsknWqargoUqDmRxNCpunENz77t2Ea","/ip4/172.18.236.148/tcp/14632/ws/p2p/16Uiu2HAm8252hZo274fo3RzsknWqargoUqDmRxNCpunENz77t2Ea"],"enrUri":"enr:-L24QAblFhl4TET0NgpGpBjuSjUDt-2FM7ABDAbPjUPns6SLZ6OZtVVZ44GV_DC72J47ls3b4jhyi2AF1F6Sm_pHkYgCgmlkgnY0gmlwhKwS7JSKbXVsdGlhZGRyc5YACASsEuyUBjknAAoErBLslAY5KN0DgnJzhQADAQAAiXNlY3AyNTZrMaECuxwNsHEnFpdLI7wp711FrmM8oRv2yU4VZnGuhoKojg-DdGNwgjkng3VkcII5KYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-15_04-18-05__e1faee68-63b5-415a-a95f-0e729c8d46f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.155.220
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['47456', '47457', '47458', '47459', '47460']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 47456:47456 -p 47457:47457 -p 47458:47458 -p 47459:47459 -p 47460:47460 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47458 --rest-port=47456 --tcp-port=47457 --discv5-udp-port=47459 --rest-address=0.0.0.0 --nat=extip:172.18.155.220 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d8dba0cb83536badba14a59a86cbb23e6f216eaf9f8e201d80ccddc0fb2be8ab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47460 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.155.220 waku d0e8c0b197eb5acda02b39c4c6012b85115b42f025a3fdc30e9b57303310e4d8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d0e8c0b197eb. Setting up logs at ./log/docker/receiving_node2_2024-11-15_04-18-05__e1faee68-63b5-415a-a95f-0e729c8d46f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 47456
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47456/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47456/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.155.220/tcp/47457/p2p/16Uiu2HAm1mfPWnsjU5nNq4jo8CaDUKuza8iLmuFEdyFDtnuuXp1B","/ip4/172.18.155.220/tcp/47458/ws/p2p/16Uiu2HAm1mfPWnsjU5nNq4jo8CaDUKuza8iLmuFEdyFDtnuuXp1B"],"enrUri":"enr:-L24QOQtn7XJ8z2S01KhNQEB39RqMa_9usKgYo5fSDNbTMTlQJdkNJgUDr-LVUlRwbnjX4A4JiIaAQSbyEXG9d3yZ6QCgmlkgnY0gmlwhKwSm9yKbXVsdGlhZGRyc5YACASsEpvcBrlhAAoErBKb3Aa5Yt0DgnJzhQADAQAAiXNlY3AyNTZrMaECXkURyPxWoYEGQEiEXFzGUaVNc82ZRpOef76CYkB2vtaDdGNwgrlhg3VkcIK5Y4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47456/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.236.148/tcp/14631/p2p/16Uiu2HAm8252hZo274fo3RzsknWqargoUqDmRxNCpunENz77t2Ea"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-15_04-18-05__e1faee68-63b5-415a-a95f-0e729c8d46f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.246.245
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['13863', '13864', '13865', '13866', '13867']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 13863:13863 -p 13864:13864 -p 13865:13865 -p 13866:13866 -p 13867:13867 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13865 --rest-port=13863 --tcp-port=13864 --discv5-udp-port=13866 --rest-address=0.0.0.0 --nat=extip:172.18.246.245 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ab57cfccb0b3dfe53e3fa9acf1d9bbbb0ece02ccfaa4cded2fb965c2b8e4ad58 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13867 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QAblFhl4TET0NgpGpBjuSjUDt-2FM7ABDAbPjUPns6SLZ6OZtVVZ44GV_DC72J47ls3b4jhyi2AF1F6Sm_pHkYgCgmlkgnY0gmlwhKwS7JSKbXVsdGlhZGRyc5YACASsEuyUBjknAAoErBLslAY5KN0DgnJzhQADAQAAiXNlY3AyNTZrMaECuxwNsHEnFpdLI7wp711FrmM8oRv2yU4VZnGuhoKojg-DdGNwgjkng3VkcII5KYV3YWt1Mgk --lightpushnode=/ip4/172.18.236.148/tcp/14631/p2p/16Uiu2HAm8252hZo274fo3RzsknWqargoUqDmRxNCpunENz77t2Ea --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.246.245 waku babaa88d4ecd4cc2e1a8f0feb6cfa91842abce49374e92b54aa2a22e3cc38c62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID babaa88d4ecd. Setting up logs at ./log/docker/lightpush_node1_2024-11-15_04-18-05__e1faee68-63b5-415a-a95f-0e729c8d46f6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 13863
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13863/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13863/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.246.245/tcp/13864/p2p/16Uiu2HAmBGS2AQzYAEY3RXpTG1HMP53rbonyPNaQko2x72HcpvaT","/ip4/172.18.246.245/tcp/13865/ws/p2p/16Uiu2HAmBGS2AQzYAEY3RXpTG1HMP53rbonyPNaQko2x72HcpvaT"],"enrUri":"enr:-L24QMt7ksW_bG75F7bHXDzXzDAAvGlTuXBQv_96JrEJqPzZZHGnqReuc0hEdbXVfaa25ElIceNzrs0XcvU9BWkQxGQCgmlkgnY0gmlwhKwS9vWKbXVsdGlhZGRyc5YACASsEvb1BjYoAAoErBL29QY2Kd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC61z62bibRFCxunuDCrU4h7_rj2jAwYDaRaVqIuFUZtCDdGNwgjYog3VkcII2KoV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13863/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.236.148/tcp/14631/p2p/16Uiu2HAm8252hZo274fo3RzsknWqargoUqDmRxNCpunENz77t2Ea"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13863/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.155.220/tcp/47457/p2p/16Uiu2HAm1mfPWnsjU5nNq4jo8CaDUKuza8iLmuFEdyFDtnuuXp1B"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14630/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47456/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13863/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1731644290778747392, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14630/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731644290778747392,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47456/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731644290778747392,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13863/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1731644290905835520, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14630/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731644290905835520,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47456/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731644290905835520,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 3bebef92dd9a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id d0e8c0b197eb
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3bebef92dd9a. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id babaa88d4ecd
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d0e8c0b197eb. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.