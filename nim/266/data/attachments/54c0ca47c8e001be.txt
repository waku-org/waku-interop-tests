[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_add_a_new_content_topic with id: 2024-07-09_04-13-13__5bafe3dd-3604-4848-bba3-fff63819a39a
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:80 WakuNode instance initialized with log path ./log/docker/node1_2024-07-09_04-13-13__5bafe3dd-3604-4848-bba3-fff63819a39a__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.251.163
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['63704', '63705', '63706', '63707', '63708']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:427 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:156 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:158 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 63704:63704 -p 63705:63705 -p 63706:63706 -p 63707:63707 -p 63708:63708 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63706 --rest-port=63704 --tcp-port=63705 --discv5-udp-port=63707 --rest-address=0.0.0.0 --nat=extip:172.18.251.163 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63708 --metrics-logging=true --relay=true --filter=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.251.163 waku b0584968978924316794c84b87dac911ef5895706bf000182289a11b3a3d908d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID b05849689789. Setting up logs at ./log/docker/node1_2024-07-09_04-13-13__5bafe3dd-3604-4848-bba3-fff63819a39a__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 63704
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63704/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:273 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63704/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.251.163/tcp/63705/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.251.163/tcp/63706/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QOhnwEF634sFIShZg5PtqxS3G92jsHeJisxRzmJybRKCPjxTPp8q_johneBaiwuljdLNPplaRlUAQWj_szbxpmIBgmlkgnY0gmlwhKwS-6OKbXVsdGlhZGRyc4wACgSsEvujBvja3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC-NmDdWRwgvjbhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:278 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:80 WakuNode instance initialized with log path ./log/docker/node2_2024-07-09_04-13-13__5bafe3dd-3604-4848-bba3-fff63819a39a__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.54.157
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['52040', '52041', '52042', '52043', '52044']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:427 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:156 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:158 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 52040:52040 -p 52041:52041 -p 52042:52042 -p 52043:52043 -p 52044:52044 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52042 --rest-port=52040 --tcp-port=52041 --discv5-udp-port=52043 --rest-address=0.0.0.0 --nat=extip:172.18.54.157 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52044 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QOhnwEF634sFIShZg5PtqxS3G92jsHeJisxRzmJybRKCPjxTPp8q_johneBaiwuljdLNPplaRlUAQWj_szbxpmIBgmlkgnY0gmlwhKwS-6OKbXVsdGlhZGRyc4wACgSsEvujBvja3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC-NmDdWRwgvjbhXdha3UyBQ --filternode=/ip4/172.18.251.163/tcp/63705/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.54.157 waku 5d868905c7d517eefc244c8f94e6d8ef3988b824aa4234b300b708479f0287f5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 5d868905c7d5. Setting up logs at ./log/docker/node2_2024-07-09_04-13-13__5bafe3dd-3604-4848-bba3-fff63819a39a__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 52040
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52040/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:273 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52040/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.54.157/tcp/52041/p2p/16Uiu2HAkwFvxgxnn6dpxcgSdXgwK44uTnbUGnA8pbNRkKj3xxJHY","/ip4/172.18.54.157/tcp/52042/ws/p2p/16Uiu2HAkwFvxgxnn6dpxcgSdXgwK44uTnbUGnA8pbNRkKj3xxJHY"],"enrUri":"enr:-LO4QD09hYnKDy31Vb6dzQZcvAUkRspwLm8YSzfFAj8vZKIpcKdYMGShgQTz0caFPqVmjFa1_yR7si2y8GP_Yp1DrucBgmlkgnY0gmlwhKwSNp2KbXVsdGlhZGRyc4wACgSsEjadBstK3QOCcnOFAAABAACJc2VjcDI1NmsxoQIbOIE6iaa5nylTu0PaJP3Mj4kQ3HaQN60fKU97f6_N64N0Y3CCy0mDdWRwgstLhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:278 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52040/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.251.163/tcp/63705/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63704/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52040/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ab10220e-d803-4a98-89d2-19dd414decd3", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"ab10220e-d803-4a98-89d2-19dd414decd3","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:52040/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63704/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:97 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52040/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1720498397078926080,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63704/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:97 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52040/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1720498397189051392,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:217 Stopping container with id b05849689789
[35mDEBUG   [0m src.node.waku_node:waku_node.py:224 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:217 Stopping container with id 5d868905c7d5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:224 Container stopped.