[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publishing_node_is_stopped with id: 2024-10-24_11-49-08__8070ee22-da1c-4ded-accd-ea4170dcf5c6
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:39 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-10-24_11-49-08__8070ee22-da1c-4ded-accd-ea4170dcf5c6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.87.102
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['63848', '63849', '63850', '63851', '63852']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 63848:63848 -p 63849:63849 -p 63850:63850 -p 63851:63851 -p 63852:63852 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63850 --rest-port=63848 --tcp-port=63849 --discv5-udp-port=63851 --rest-address=0.0.0.0 --nat=extip:172.18.87.102 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=19886fb3a152e73ed1f8ad488eed5e4c8f6fcf1cda33be89cdb182d4cefd13b3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63852 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.87.102 waku a8d35e5eebe051c50bf860df30a6ff338a9379b118ca29d9e0f419c3b68acab2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a8d35e5eebe0. Setting up logs at ./log/docker/publishing_node1_2024-10-24_11-49-08__8070ee22-da1c-4ded-accd-ea4170dcf5c6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 63848
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container bce835090c60. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63848/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63848/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.87.102/tcp/63849/p2p/16Uiu2HAm6rBNH7TuuEtYzxE1mJaYpjXR2cvtByJFU4MCUdQrPMKx","/ip4/172.18.87.102/tcp/63850/ws/p2p/16Uiu2HAm6rBNH7TuuEtYzxE1mJaYpjXR2cvtByJFU4MCUdQrPMKx"],"enrUri":"enr:-LO4QIed3iCIaoWK9vS1WTomXcnFyXr9oRQK1EyAy7TMIQqWOUcp3Y54mVQ_ZjEHa16d7jCDSkP1h5IWaFnPvLPbhwYBgmlkgnY0gmlwhKwSV2aKbXVsdGlhZGRyc4wACgSsEldmBvlq3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKpt7lvbD_MmA2mIfrynFS3CR1ix2UxqmiTjGZRYHnve4N0Y3CC-WmDdWRwgvlrhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-10-24_11-49-08__8070ee22-da1c-4ded-accd-ea4170dcf5c6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.2.12
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['58523', '58524', '58525', '58526', '58527']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 58523:58523 -p 58524:58524 -p 58525:58525 -p 58526:58526 -p 58527:58527 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58525 --rest-port=58523 --tcp-port=58524 --discv5-udp-port=58526 --rest-address=0.0.0.0 --nat=extip:172.18.2.12 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a9fb4fad9d0b59db92ae6b7b90ae8b4bacf9fd5f1abee328ebccc07d24e5edad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58527 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QIed3iCIaoWK9vS1WTomXcnFyXr9oRQK1EyAy7TMIQqWOUcp3Y54mVQ_ZjEHa16d7jCDSkP1h5IWaFnPvLPbhwYBgmlkgnY0gmlwhKwSV2aKbXVsdGlhZGRyc4wACgSsEldmBvlq3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKpt7lvbD_MmA2mIfrynFS3CR1ix2UxqmiTjGZRYHnve4N0Y3CC-WmDdWRwgvlrhXdha3UyAw --storenode=/ip4/172.18.87.102/tcp/63849/p2p/16Uiu2HAm6rBNH7TuuEtYzxE1mJaYpjXR2cvtByJFU4MCUdQrPMKx --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.2.12 waku 3970e1b387671c31bd38226c12fc4dff8cab5ad05fe291e2cbddcec15fc44b78
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3970e1b38767. Setting up logs at ./log/docker/store_node1_2024-10-24_11-49-08__8070ee22-da1c-4ded-accd-ea4170dcf5c6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 58523
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58523/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58523/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.2.12/tcp/58524/p2p/16Uiu2HAmVHW5drQt7XNwRPVjirMH1GhQrVCdfCfTj65Z9KBLoS8S","/ip4/172.18.2.12/tcp/58525/ws/p2p/16Uiu2HAmVHW5drQt7XNwRPVjirMH1GhQrVCdfCfTj65Z9KBLoS8S"],"enrUri":"enr:-LO4QLifTWRbFXD4IzIgjJaNXM2Zy4L885mm_ac7KPDL9lBMZpSxIAfalfAYO3H-mTgcKKAYsqIHoWty4xcSJ5yLDwgBgmlkgnY0gmlwhKwSAgyKbXVsdGlhZGRyc4wACgSsEgIMBuSd3QOCcnOFAAMBAACJc2VjcDI1NmsxoQP3FYQRWK2zecPl1bi_3vqy3D2uGanhSlOcMTUroh8eU4N0Y3CC5JyDdWRwguSehXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58523/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.87.102/tcp/63849/p2p/16Uiu2HAm6rBNH7TuuEtYzxE1mJaYpjXR2cvtByJFU4MCUdQrPMKx"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63848/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58523/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63848/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63848/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"KsXx0HQw0TwpaVFVrRtlBq99AtZsi4Kl5tp2kiGWUp4="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58523/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"KsXx0HQw0TwpaVFVrRtlBq99AtZsi4Kl5tp2kiGWUp4="}]}'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a8d35e5eebe0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58523/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"KsXx0HQw0TwpaVFVrRtlBq99AtZsi4Kl5tp2kiGWUp4="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3970e1b38767
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a8d35e5eebe0. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.