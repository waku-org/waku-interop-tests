[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_missing_payload with id: 2025-01-12_04-04-30__e23e1a58-8795-42e7-82ef-196622145339
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-12_04-04-30__e23e1a58-8795-42e7-82ef-196622145339__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.241.97
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['4159', '4160', '4161', '4162', '4163']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 4159:4159 -p 4160:4160 -p 4161:4161 -p 4162:4162 -p 4163:4163 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4161 --rest-port=4159 --tcp-port=4160 --discv5-udp-port=4162 --rest-address=0.0.0.0 --nat=extip:172.18.241.97 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=88fdd61cf3cb617c099cebce1bfec1d54aa492ccde0b89d53b22469d4cccd5d8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4163 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.241.97 waku 26326c3e2324876ecdc9f1ae5afe71e23260b97b565db9d362dc0f0b27eff4d4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 26326c3e2324. Setting up logs at ./log/docker/node1_2025-01-12_04-04-30__e23e1a58-8795-42e7-82ef-196622145339__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 4159
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 171d657b8b93. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4159/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4159/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.97/tcp/4160/p2p/16Uiu2HAkzqDdnQ5umFGFLpqsBuc28vpn5Kezwgqv2xGFeS7z2sv2","/ip4/172.18.241.97/tcp/4161/ws/p2p/16Uiu2HAkzqDdnQ5umFGFLpqsBuc28vpn5Kezwgqv2xGFeS7z2sv2"],"enrUri":"enr:-L24QMo8tL5nGmqmpPbyjR-RVovF-SceN9SCPan70ydOkd0lFpyMIJS3v3oAKW9XxA9ji0qQnMYS5Tahga5b2p0HWOUCgmlkgnY0gmlwhKwS8WGKbXVsdGlhZGRyc5YACASsEvFhBhBAAAoErBLxYQYQQd0DgnJzhQADAQAAiXNlY3AyNTZrMaECUFKV7gwEMkAe_uE_jVlq3dSZPTsJSDXw02EN5IafKkODdGNwghBAg3VkcIIQQoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2025-01-12_04-04-30__e23e1a58-8795-42e7-82ef-196622145339__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.156.245
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['13619', '13620', '13621', '13622', '13623']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 13619:13619 -p 13620:13620 -p 13621:13621 -p 13622:13622 -p 13623:13623 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13621 --rest-port=13619 --tcp-port=13620 --discv5-udp-port=13622 --rest-address=0.0.0.0 --nat=extip:172.18.156.245 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bf0e2887d53e726ef71bfdde2cef6591fe899a71f1c6ecf39e983067c475de98 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13623 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMo8tL5nGmqmpPbyjR-RVovF-SceN9SCPan70ydOkd0lFpyMIJS3v3oAKW9XxA9ji0qQnMYS5Tahga5b2p0HWOUCgmlkgnY0gmlwhKwS8WGKbXVsdGlhZGRyc5YACASsEvFhBhBAAAoErBLxYQYQQd0DgnJzhQADAQAAiXNlY3AyNTZrMaECUFKV7gwEMkAe_uE_jVlq3dSZPTsJSDXw02EN5IafKkODdGNwghBAg3VkcIIQQoV3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.156.245 waku c68b4238b55654e295fe026878bba149500d6a07576371da28ecee1e557a368a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c68b4238b556. Setting up logs at ./log/docker/node2_2025-01-12_04-04-30__e23e1a58-8795-42e7-82ef-196622145339__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 13619
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13619/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13619/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.156.245/tcp/13620/p2p/16Uiu2HAm2b8tvWoffkR8givQ4KzEwfsoh1yeM8JWp2SpHDhWmXc6","/ip4/172.18.156.245/tcp/13621/ws/p2p/16Uiu2HAm2b8tvWoffkR8givQ4KzEwfsoh1yeM8JWp2SpHDhWmXc6"],"enrUri":"enr:-L24QHQbrIEB56fgu--TW8DTJm-CGr4SAI3pFurdrzkkfWAfV1Mqm7UugDkM20xVwwkp5vCupTvOqdKMtt37k0toOZICgmlkgnY0gmlwhKwSnPWKbXVsdGlhZGRyc5YACASsEpz1BjU0AAoErBKc9QY1Nd0DgnJzhQADAQAAiXNlY3AyNTZrMaECam54RkhbFvd4rno1vX6eSumHCIQFV5rZR4qCX-3fpNuDdGNwgjU0g3VkcII1NoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13619/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.241.97/tcp/4160/p2p/16Uiu2HAkzqDdnQ5umFGFLpqsBuc28vpn5Kezwgqv2xGFeS7z2sv2"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4159/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13619/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4159/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4159/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1736654672578939904,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13619/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1736654672578939904,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4159/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:4159/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 26326c3e2324
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id c68b4238b556
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 26326c3e2324. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.