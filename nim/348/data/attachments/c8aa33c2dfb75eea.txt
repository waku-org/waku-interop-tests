[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_content_topic_different_shard with id: 2024-09-06_12-02-25__d77e277b-b1e6-46c4-8e2e-38eaf2fd2072
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-06_12-02-25__d77e277b-b1e6-46c4-8e2e-38eaf2fd2072__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.187.87
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['57463', '57464', '57465', '57466', '57467']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 57463:57463 -p 57464:57464 -p 57465:57465 -p 57466:57466 -p 57467:57467 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57465 --rest-port=57463 --tcp-port=57464 --discv5-udp-port=57466 --rest-address=0.0.0.0 --nat=extip:172.18.187.87 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=426db3c9759a1ba5b3b1af5de6aeceb8d096e22bd472fff91e5f04d09bdb086b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57467 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.187.87 waku 8028b6c4b91650583f601c2c11ebf3c3007a565d24eab7a40df1a085407b92a4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 8028b6c4b916. Setting up logs at ./log/docker/node1_2024-09-06_12-02-25__d77e277b-b1e6-46c4-8e2e-38eaf2fd2072__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 57463
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57463/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57463/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.187.87/tcp/57464/p2p/16Uiu2HAmUw5nTznm89CCxz3ed3CtdX9hyf1iTFcdv2ncf6CM3Y4n","/ip4/172.18.187.87/tcp/57465/ws/p2p/16Uiu2HAmUw5nTznm89CCxz3ed3CtdX9hyf1iTFcdv2ncf6CM3Y4n"],"enrUri":"enr:-LO4QCmWNNHRMwXcxu4eUYC-mui1CkyR0LfiANdVfG7DnugBWGOUwFnvshmfYG7WVGddmdxrU4G7jH2HAUlGFt5m-FEBgmlkgnY0gmlwhKwSu1eKbXVsdGlhZGRyc4wACgSsErtXBuB53QOCcnOFAAIBAACJc2VjcDI1NmsxoQPx2m2XsXTCHmnIXI4q-syQvVQMyLskuNvtGNsKPAlu54N0Y3CC4HiDdWRwguB6hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-06_12-02-25__d77e277b-b1e6-46c4-8e2e-38eaf2fd2072__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.153.54
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['38520', '38521', '38522', '38523', '38524']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 38520:38520 -p 38521:38521 -p 38522:38522 -p 38523:38523 -p 38524:38524 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38522 --rest-port=38520 --tcp-port=38521 --discv5-udp-port=38523 --rest-address=0.0.0.0 --nat=extip:172.18.153.54 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a71a18de5d41fcdaafc0e07aaa5aeadf86dbf3de80f5d06c5cea66b671cf7bb1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38524 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QCmWNNHRMwXcxu4eUYC-mui1CkyR0LfiANdVfG7DnugBWGOUwFnvshmfYG7WVGddmdxrU4G7jH2HAUlGFt5m-FEBgmlkgnY0gmlwhKwSu1eKbXVsdGlhZGRyc4wACgSsErtXBuB53QOCcnOFAAIBAACJc2VjcDI1NmsxoQPx2m2XsXTCHmnIXI4q-syQvVQMyLskuNvtGNsKPAlu54N0Y3CC4HiDdWRwguB6hXdha3UyBQ --content-topic=/waku/2/content/test.js
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.153.54 waku ba84f198f8cbfba80fc97401dcb5ddfd2d97bb9bf5b76131938a3624b0e1f442
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ba84f198f8cb. Setting up logs at ./log/docker/node2_2024-09-06_12-02-25__d77e277b-b1e6-46c4-8e2e-38eaf2fd2072__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 38520
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38520/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38520/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.153.54/tcp/38521/p2p/16Uiu2HAm99EFAb45AV35KRn7Mkk9NYwa6CFMg7WqS9t5t6kGyw7m","/ip4/172.18.153.54/tcp/38522/ws/p2p/16Uiu2HAm99EFAb45AV35KRn7Mkk9NYwa6CFMg7WqS9t5t6kGyw7m"],"enrUri":"enr:-LO4QBWXFf11yc8Yd0xE7xhUyEVxJ1XE18Cq2o72f-ka-RWGOpS31W3wF6QqhPA51qR1WwHWAr4YdqcOAcBoQx4MqxUBgmlkgnY0gmlwhKwSmTaKbXVsdGlhZGRyc4wACgSsEpk2BpZ63QOCcnOFAAIBAACJc2VjcDI1NmsxoQLLzTm07nP-52J8QZvx943su75oYDDeEMTLi0h9lmJWcIN0Y3CClnmDdWRwgpZ7hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38520/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.187.87/tcp/57464/p2p/16Uiu2HAmUw5nTznm89CCxz3ed3CtdX9hyf1iTFcdv2ncf6CM3Y4n"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57463/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38520/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/content/test.js"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57463/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57463/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725624148619470336,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38520/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:38520/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto. Response content: b'/myapp/1/latest/proto'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 8028b6c4b916
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ba84f198f8cb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.