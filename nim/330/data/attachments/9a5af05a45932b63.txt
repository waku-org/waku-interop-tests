[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_missing_payload with id: 2024-08-25_04-22-47__65f2ee6a-6937-4304-becc-96ad9a4ca8a8
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-25_04-22-47__65f2ee6a-6937-4304-becc-96ad9a4ca8a8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.193.69
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['52300', '52301', '52302', '52303', '52304']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 52300:52300 -p 52301:52301 -p 52302:52302 -p 52303:52303 -p 52304:52304 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52302 --rest-port=52300 --tcp-port=52301 --discv5-udp-port=52303 --rest-address=0.0.0.0 --nat=extip:172.18.193.69 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ac07bde0fba7fe30dd2becb0ec5d4d000c51b3aed93ecd3c9cf1f0b27cb9dd82 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52304 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.193.69 waku f815ca837cbc57cd7091fc36e931277d959516958fa63d6fb0143d4b63baefd4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID f815ca837cbc. Setting up logs at ./log/docker/node1_2024-08-25_04-22-47__65f2ee6a-6937-4304-becc-96ad9a4ca8a8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 52300
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52300/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52300/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.193.69/tcp/52301/p2p/16Uiu2HAkz1zMY1hzfVkWtZJ32gVqKk9afXqVBgpbmNV6DSvNkkkw","/ip4/172.18.193.69/tcp/52302/ws/p2p/16Uiu2HAkz1zMY1hzfVkWtZJ32gVqKk9afXqVBgpbmNV6DSvNkkkw"],"enrUri":"enr:-LO4QIVcsGUznFkeKinw_DKkQEmD9v4QvtaBvYbaCkl2Y2iSK8h-DXmmWhFhYcdIX2QyiO4h2Wb8Dzl-tIKqnOw2RFcBgmlkgnY0gmlwhKwSwUWKbXVsdGlhZGRyc4wACgSsEsFFBsxO3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJEOUWQh2zCVdOg_k2YgVdRNd6zAsRjGspPZ8mFGsNbaIN0Y3CCzE2DdWRwgsxPhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-25_04-22-47__65f2ee6a-6937-4304-becc-96ad9a4ca8a8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.71.29
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['12025', '12026', '12027', '12028', '12029']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 12025:12025 -p 12026:12026 -p 12027:12027 -p 12028:12028 -p 12029:12029 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12027 --rest-port=12025 --tcp-port=12026 --discv5-udp-port=12028 --rest-address=0.0.0.0 --nat=extip:172.18.71.29 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bc2bd6d5d25c803f0ae13ecc3dbc3ebec1eea4ab1dcd0e97d6d315d76fb04fb2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12029 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QIVcsGUznFkeKinw_DKkQEmD9v4QvtaBvYbaCkl2Y2iSK8h-DXmmWhFhYcdIX2QyiO4h2Wb8Dzl-tIKqnOw2RFcBgmlkgnY0gmlwhKwSwUWKbXVsdGlhZGRyc4wACgSsEsFFBsxO3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJEOUWQh2zCVdOg_k2YgVdRNd6zAsRjGspPZ8mFGsNbaIN0Y3CCzE2DdWRwgsxPhXdha3UyAQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.71.29 waku 42408e6b45bebb5aa7f87d8c19741e6732cadc758a8d0cf917ceb90862e94b8e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 42408e6b45be. Setting up logs at ./log/docker/node2_2024-08-25_04-22-47__65f2ee6a-6937-4304-becc-96ad9a4ca8a8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 12025
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12025/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12025/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.71.29/tcp/12026/p2p/16Uiu2HAmMNFTE9rpVwaCcsX5jdYWjvFRD75ucSDgaqnnU9Qx9uEP","/ip4/172.18.71.29/tcp/12027/ws/p2p/16Uiu2HAmMNFTE9rpVwaCcsX5jdYWjvFRD75ucSDgaqnnU9Qx9uEP"],"enrUri":"enr:-LO4QKJ0tvDucsV9fj7zILnDN6Md1AH5ySeircfYR1InGZVfZqMuSbNe7uUmEywAezdomF9Hr9I89P9ELMQ3tONq9z0BgmlkgnY0gmlwhKwSRx2KbXVsdGlhZGRyc4wACgSsEkcdBi773QOCcnOFAAMBAACJc2VjcDI1NmsxoQOBb2KISEOkiCz3DsT6CjmnA25tgq3uFeMJukjrX0YD6IN0Y3CCLvqDdWRwgi78hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12025/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.193.69/tcp/52301/p2p/16Uiu2HAkz1zMY1hzfVkWtZJ32gVqKk9afXqVBgpbmNV6DSvNkkkw"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52300/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12025/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52300/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:52300/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724559771356389120,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12025/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1724559771356389120,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:52300/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:52300/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id f815ca837cbc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 42408e6b45be
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.