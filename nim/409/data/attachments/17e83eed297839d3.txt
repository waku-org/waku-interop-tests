[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-10-27_11-23-22__2f6c64c7-f993-4b97-b037-3e779997ac9b
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-27_11-23-22__2f6c64c7-f993-4b97-b037-3e779997ac9b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.213.95
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['55052', '55053', '55054', '55055', '55056']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 55052:55052 -p 55053:55053 -p 55054:55054 -p 55055:55055 -p 55056:55056 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55054 --rest-port=55052 --tcp-port=55053 --discv5-udp-port=55055 --rest-address=0.0.0.0 --nat=extip:172.18.213.95 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=67e7bdd3b9bc6a2df915f23ad695dd627d2a22fc8cdadf46f34a8daa18fea2de --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55056 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.213.95 waku d08f2e70dc47a9b66769b6807fe31461803804ed8bbd1847f94d07fe95da080b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d08f2e70dc47. Setting up logs at ./log/docker/receiving_node1_2024-10-27_11-23-22__2f6c64c7-f993-4b97-b037-3e779997ac9b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 55052
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 5d7804361da6. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55052/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55052/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.213.95/tcp/55053/p2p/16Uiu2HAm9JjmBrJTgfNjDcnsrNdcPZKhaV7B7dp6bQ7U3bgzFe6i","/ip4/172.18.213.95/tcp/55054/ws/p2p/16Uiu2HAm9JjmBrJTgfNjDcnsrNdcPZKhaV7B7dp6bQ7U3bgzFe6i"],"enrUri":"enr:-LO4QL0-HMgnQPC-mu2SrLoWAR7WnVZ9DHAc9liRh5O3T20hegqjcQg1_u5H1MbGe8nSLQKYE7Qr7dGBMF7rwY49-dkBgmlkgnY0gmlwhKwS1V-KbXVsdGlhZGRyc4wACgSsEtVfBtcO3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLOPNQQWM1GXw7gBdmUUi4AMy96GSru9RFSSSpQnoxGH4N0Y3CC1w2DdWRwgtcPhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-27_11-23-22__2f6c64c7-f993-4b97-b037-3e779997ac9b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.102.86
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20182', '20183', '20184', '20185', '20186']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20182:20182 -p 20183:20183 -p 20184:20184 -p 20185:20185 -p 20186:20186 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20184 --rest-port=20182 --tcp-port=20183 --discv5-udp-port=20185 --rest-address=0.0.0.0 --nat=extip:172.18.102.86 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7fc3f3d1bb11e3b5fdbe1f28ac73bddeb614bd237cffec31dcfbfe3acad7b7ef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20186 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.102.86 waku 51e6210fbafeec71e5e2d91c0e875ec0bf70f586e3bb8deb94e7ece5393cb329
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 51e6210fbafe. Setting up logs at ./log/docker/receiving_node2_2024-10-27_11-23-22__2f6c64c7-f993-4b97-b037-3e779997ac9b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 20182
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20182/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20182/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.102.86/tcp/20183/p2p/16Uiu2HAm4BBDVU5VvfUMc372Cgpe9Amb37ZT3xjfSATArQYte3Nj","/ip4/172.18.102.86/tcp/20184/ws/p2p/16Uiu2HAm4BBDVU5VvfUMc372Cgpe9Amb37ZT3xjfSATArQYte3Nj"],"enrUri":"enr:-LO4QEOYdqDYubhXbpZ8jhjhPxXH-2tZRc3k5hDunMW3NDqCfjbNMZEPDiumz2vKLxw5ydc4c3mKjsq-GHa7SAPD654BgmlkgnY0gmlwhKwSZlaKbXVsdGlhZGRyc4wACgSsEmZWBk7Y3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKCAocT-8IP5kN1s95Jf-xiOcNZyThsbjtA6rV1lklqzIN0Y3CCTteDdWRwgk7ZhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20182/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.213.95/tcp/55053/p2p/16Uiu2HAm9JjmBrJTgfNjDcnsrNdcPZKhaV7B7dp6bQ7U3bgzFe6i"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-27_11-23-22__2f6c64c7-f993-4b97-b037-3e779997ac9b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.52.118
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['53321', '53322', '53323', '53324', '53325']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 53321:53321 -p 53322:53322 -p 53323:53323 -p 53324:53324 -p 53325:53325 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53323 --rest-port=53321 --tcp-port=53322 --discv5-udp-port=53324 --rest-address=0.0.0.0 --nat=extip:172.18.52.118 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=658998fdd7edddec81fc3025e15ba5d69eb7e105110f1f530e9348bd5d22bec8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53325 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QL0-HMgnQPC-mu2SrLoWAR7WnVZ9DHAc9liRh5O3T20hegqjcQg1_u5H1MbGe8nSLQKYE7Qr7dGBMF7rwY49-dkBgmlkgnY0gmlwhKwS1V-KbXVsdGlhZGRyc4wACgSsEtVfBtcO3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLOPNQQWM1GXw7gBdmUUi4AMy96GSru9RFSSSpQnoxGH4N0Y3CC1w2DdWRwgtcPhXdha3UyCQ --lightpushnode=/ip4/172.18.213.95/tcp/55053/p2p/16Uiu2HAm9JjmBrJTgfNjDcnsrNdcPZKhaV7B7dp6bQ7U3bgzFe6i --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.52.118 waku 0cee45dfc1f5292e37b028fb928e9b5a9b5f4a632ede1348be06246bfa34ac9b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0cee45dfc1f5. Setting up logs at ./log/docker/lightpush_node1_2024-10-27_11-23-22__2f6c64c7-f993-4b97-b037-3e779997ac9b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 53321
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53321/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53321/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.52.118/tcp/53322/p2p/16Uiu2HAm5bJbrJqmgWXBTv9KzmSUcrPfmP8AXETpjbdw5AJVek3Y","/ip4/172.18.52.118/tcp/53323/ws/p2p/16Uiu2HAm5bJbrJqmgWXBTv9KzmSUcrPfmP8AXETpjbdw5AJVek3Y"],"enrUri":"enr:-LO4QJHaN0vh5djLuqbdCOu9iwz18H8doxTTlIQkDNlkiTsuGGPdXQT2utVx91VF2m_im3KNKMnGm-lHM49ni4XaDQkBgmlkgnY0gmlwhKwSNHaKbXVsdGlhZGRyc4wACgSsEjR2BtBL3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKXDIE7RHqbP8OT11p2IX2E-rVbaltAUfczTfHuvjTDB4N0Y3CC0EqDdWRwgtBMhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.213.95/tcp/55053/p2p/16Uiu2HAm9JjmBrJTgfNjDcnsrNdcPZKhaV7B7dp6bQ7U3bgzFe6i"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.102.86/tcp/20183/p2p/16Uiu2HAm4BBDVU5VvfUMc372Cgpe9Amb37ZT3xjfSATArQYte3Nj"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55052/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20182/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730028208685761280}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:53321/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730028208689981952}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:53321/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730028208695089920}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:53321/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730028208698408960}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:53321/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730028208701253888}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:53321/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53321/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730028208704341504}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:53321/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d08f2e70dc47
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 51e6210fbafe
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d08f2e70dc47. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 0cee45dfc1f5
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 51e6210fbafe. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.