[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_retrieve_messages_without_subscribing_via_api with id: 2024-08-16_07-36-31__917a61f0-d479-4918-97f0-3971f223078c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node1_2024-08-16_07-36-31__917a61f0-d479-4918-97f0-3971f223078c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.84.104
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['16114', '16115', '16116', '16117', '16118']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:71 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 16114:16114 -p 16115:16115 -p 16116:16116 -p 16117:16117 -p 16118:16118 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16116 --rest-port=16114 --tcp-port=16115 --discv5-udp-port=16117 --rest-address=0.0.0.0 --nat=extip:172.18.84.104 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=32e1e086dca9aa0dd7cd72ecc8f34b2b3b956fbeeee1c698867b5e6be6618f5a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16118 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.84.104 waku 855896bcb6c0585b602697457e471adae52a22f5fa0e3dd4e37e14ff30dc3f5b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 855896bcb6c0. Setting up logs at ./log/docker/node1_2024-08-16_07-36-31__917a61f0-d479-4918-97f0-3971f223078c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 16114
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16114/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16114/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.84.104/tcp/16115/p2p/16Uiu2HAmVZFse7KzPR3w61RRycpraZ2LdNb6wb5qjeeUif5UdSwh","/ip4/172.18.84.104/tcp/16116/ws/p2p/16Uiu2HAmVZFse7KzPR3w61RRycpraZ2LdNb6wb5qjeeUif5UdSwh"],"enrUri":"enr:-LO4QLxOHZg_ktKn2g7d5YUnEAJoScxV_994fREhD5TNzI8dJKzchYLb1Ic0ySnvbnTzUwRKF4KQxeKFZ0h77JoQ_eMBgmlkgnY0gmlwhKwSVGiKbXVsdGlhZGRyc4wACgSsElRoBj703QOCcnOFAAIBAACJc2VjcDI1NmsxoQP7Hr7A-4yKM358t9Mwld6wzeRxXQKi-wvVE0XoU3p2uIN0Y3CCPvODdWRwgj71hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/node2_2024-08-16_07-36-31__917a61f0-d479-4918-97f0-3971f223078c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.14.96
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['53955', '53956', '53957', '53958', '53959']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:71 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 53955:53955 -p 53956:53956 -p 53957:53957 -p 53958:53958 -p 53959:53959 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53957 --rest-port=53955 --tcp-port=53956 --discv5-udp-port=53958 --rest-address=0.0.0.0 --nat=extip:172.18.14.96 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=6fd9aa6f4c7bdddf16fd8e8dddcfc84fab2e37fc113f8fa0ffeec8c982afc2a8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53959 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QLxOHZg_ktKn2g7d5YUnEAJoScxV_994fREhD5TNzI8dJKzchYLb1Ic0ySnvbnTzUwRKF4KQxeKFZ0h77JoQ_eMBgmlkgnY0gmlwhKwSVGiKbXVsdGlhZGRyc4wACgSsElRoBj703QOCcnOFAAIBAACJc2VjcDI1NmsxoQP7Hr7A-4yKM358t9Mwld6wzeRxXQKi-wvVE0XoU3p2uIN0Y3CCPvODdWRwgj71hXdha3UyBQ --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.14.96 waku f66f095ab258c6ba4c8a38da5982eb6afc527f9e59ba0919d15459f902b1c93f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID f66f095ab258. Setting up logs at ./log/docker/node2_2024-08-16_07-36-31__917a61f0-d479-4918-97f0-3971f223078c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 53955
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53955/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53955/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.14.96/tcp/53956/p2p/16Uiu2HAmH9w26xt4pTAhMU1K5krmhVfBgNce1KRu1fct4VGv6TWC","/ip4/172.18.14.96/tcp/53957/ws/p2p/16Uiu2HAmH9w26xt4pTAhMU1K5krmhVfBgNce1KRu1fct4VGv6TWC"],"enrUri":"enr:-LO4QHryRTz06WFpbzOW6f4EKq6oG8wf4TXTBBb4Rb4JgnDmeGhal2WuTXwPpyPkTs4FMO1IlDyrS_KbKEI5nVBRG5gBgmlkgnY0gmlwhKwSDmCKbXVsdGlhZGRyc4wACgSsEg5gBtLF3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNC2NM0x7PLYTdYdzRUOTyFsI0PVOQ9oAap_Jj5XoE_PYN0Y3CC0sSDdWRwgtLGhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53955/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.84.104/tcp/16115/p2p/16Uiu2HAmVZFse7KzPR3w61RRycpraZ2LdNb6wb5qjeeUif5UdSwh"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16114/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16114/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723793794728078336,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1723793794728078336,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 855896bcb6c0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id f66f095ab258
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.