[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_light_push_after_light_push_node_restarts with id: 2024-04-16_14-24-29__e5b1f2c6-95ce-4aec-b648-319394d9665e
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-04-16_14-24-29__e5b1f2c6-95ce-4aec-b648-319394d9665e__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.83.46
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['34943', '34944', '34945', '34946', '34947']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:315 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 34943:34943 -p 34944:34944 -p 34945:34945 -p 34946:34946 -p 34947:34947 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34945 --rest-port=34943 --tcp-port=34944 --discv5-udp-port=34946 --rest-address=0.0.0.0 --nat=extip:172.18.83.46 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34947 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.83.46 waku 7ce67050d5b8d1a83facbc28ccbff2cc224d6d1252786c23560a3b57a5454582
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 7ce67050d5b8. Setting up logs at ./log/docker/receiving_node1_2024-04-16_14-24-29__e5b1f2c6-95ce-4aec-b648-319394d9665e__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 34943
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34943/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.83.46/tcp/34944/p2p/16Uiu2HAmESuz2eD8wb2mwUN3avP8wPctG5v5ZtkanuFrPW51fR3g","/ip4/172.18.83.46/tcp/34945/ws/p2p/16Uiu2HAmESuz2eD8wb2mwUN3avP8wPctG5v5ZtkanuFrPW51fR3g"],"enrUri":"enr:-LO4QEfXVO_D8CfKR0317_RP_2xv-UaMaBpau4E47TrXGeoCL1NJWpXyQqIevDn6KbLARupMsBXebCxUilB4oZV29lABgmlkgnY0gmlwhKwSUy6KbXVsdGlhZGRyc4wACgSsElMuBoiB3QOCcnOFAAABAACJc2VjcDI1NmsxoQMan3eDshoDykRJ2KYmbH_HN4EjsfqalJXG7dBOfa61q4N0Y3CCiICDdWRwgoiChXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-04-16_14-24-29__e5b1f2c6-95ce-4aec-b648-319394d9665e__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.43.222
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['4961', '4962', '4963', '4964', '4965']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:315 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 4961:4961 -p 4962:4962 -p 4963:4963 -p 4964:4964 -p 4965:4965 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4963 --rest-port=4961 --tcp-port=4962 --discv5-udp-port=4964 --rest-address=0.0.0.0 --nat=extip:172.18.43.222 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4965 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QEfXVO_D8CfKR0317_RP_2xv-UaMaBpau4E47TrXGeoCL1NJWpXyQqIevDn6KbLARupMsBXebCxUilB4oZV29lABgmlkgnY0gmlwhKwSUy6KbXVsdGlhZGRyc4wACgSsElMuBoiB3QOCcnOFAAABAACJc2VjcDI1NmsxoQMan3eDshoDykRJ2KYmbH_HN4EjsfqalJXG7dBOfa61q4N0Y3CCiICDdWRwgoiChXdha3UyCQ --lightpushnode=/ip4/172.18.83.46/tcp/34944/p2p/16Uiu2HAmESuz2eD8wb2mwUN3avP8wPctG5v5ZtkanuFrPW51fR3g --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.43.222 waku 34e30276efd8cce761e74e33d31d7f1ca65ac7824e279c2408b1a95c60b94045
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 34e30276efd8. Setting up logs at ./log/docker/lightpush_node1_2024-04-16_14-24-29__e5b1f2c6-95ce-4aec-b648-319394d9665e__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 4961
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4961/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.43.222/tcp/4962/p2p/16Uiu2HAmHUDFDiGTfmPdratHsjp7oUkVB4f2vy83sz7tsBbpj17c","/ip4/172.18.43.222/tcp/4963/ws/p2p/16Uiu2HAmHUDFDiGTfmPdratHsjp7oUkVB4f2vy83sz7tsBbpj17c"],"enrUri":"enr:-LO4QDE6Ut3KhLKC78eVIxU7wcrdVsHxZr-oLsW-FhnBcohCPS5tFSc5VGWYIlA7eo0uaAMXpoj5crqJnMpMLwyE_4cBgmlkgnY0gmlwhKwSK96KbXVsdGlhZGRyc4wACgSsEiveBhNj3QOCcnOFAAABAACJc2VjcDI1NmsxoQNHh6BlX8F15IR2GJLw4qJNDq5Px8lRS71rSguhnNv_v4N0Y3CCE2KDdWRwghNkhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4961/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.83.46/tcp/34944/p2p/16Uiu2HAmESuz2eD8wb2mwUN3avP8wPctG5v5ZtkanuFrPW51fR3g"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34943/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:127 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4961/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/0/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1713277472597009408}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:131 Checking that peer NODE_1:harbor.status.im/wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34943/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1713277472597009408,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:175 Restarting container with id 34e30276efd8
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4961/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4961/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.43.222/tcp/4962/p2p/16Uiu2HAkyRxxPSzyAHbbZsHU1orcmM9qMeJbAhg5ApYS3SNra6vp","/ip4/172.18.43.222/tcp/4963/ws/p2p/16Uiu2HAkyRxxPSzyAHbbZsHU1orcmM9qMeJbAhg5ApYS3SNra6vp"],"enrUri":"enr:-LO4QMt3PIf3RibJvjPKn5w21rjUkpkZ_G558OoxVAjBgkH8Tyd6GxkKQmXcqKRUGvyJJFSJznLUjTXMsia4Y0Oi2u0BgmlkgnY0gmlwhKwSK96KbXVsdGlhZGRyc4wACgSsEiveBhNj3QOCcnOFAAABAACJc2VjcDI1NmsxoQI7gfE4LdF63v9w8vNOA2gSjsPPd24_vVRxhB2_OAZHfYN0Y3CCE2KDdWRwghNkhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.light_push:light_push.py:127 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4961/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/0/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1713277475518766592}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:131 Checking that peer NODE_1:harbor.status.im/wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34943/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1713277475518766592,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 7ce67050d5b8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 34e30276efd8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.