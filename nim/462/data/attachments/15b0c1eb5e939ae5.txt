[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_store_with_wrongPeerAddr with id: 2024-11-25_06-28-54__202a22ef-bed5-4c24-8a27-5e8b9e77ba95
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:39 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-11-25_06-28-54__202a22ef-bed5-4c24-8a27-5e8b9e77ba95__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.118.142
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['39282', '39283', '39284', '39285', '39286']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 39282:39282 -p 39283:39283 -p 39284:39284 -p 39285:39285 -p 39286:39286 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39284 --rest-port=39282 --tcp-port=39283 --discv5-udp-port=39285 --rest-address=0.0.0.0 --nat=extip:172.18.118.142 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f7d21a1efd0357bb673bd5aec0bfeaaf1f3938bca57b04aab3c2adbffe8ab2f3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39286 --metrics-logging=true --store=true --relay=true
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 0418674a3165. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.118.142 waku c085f32a1fe8293347c0c5fe582e7e58fe54e8bfb3b6ae66630d797b27aa284d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c085f32a1fe8. Setting up logs at ./log/docker/publishing_node1_2024-11-25_06-28-54__202a22ef-bed5-4c24-8a27-5e8b9e77ba95__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 39282
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39282/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39282/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.118.142/tcp/39283/p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig","/ip4/172.18.118.142/tcp/39284/ws/p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig"],"enrUri":"enr:-L24QA8RwMlvXGGCl5D0kSJykd-AvpfJ5-0EKkYYwb9qsnuqaYSBCQItBBSvYUZQKviPghPbPLnrzK1XxHm1YXXZlO4CgmlkgnY0gmlwhKwSdo6KbXVsdGlhZGRyc5YACASsEnaOBplzAAoErBJ2jgaZdN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDSI6xIRstE919gEJnXEpjZV7Dmlq65v4PjNuTPAyEcoGDdGNwgplzg3VkcIKZdYV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-11-25_06-28-54__202a22ef-bed5-4c24-8a27-5e8b9e77ba95__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.184.88
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['2166', '2167', '2168', '2169', '2170']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 2166:2166 -p 2167:2167 -p 2168:2168 -p 2169:2169 -p 2170:2170 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2168 --rest-port=2166 --tcp-port=2167 --discv5-udp-port=2169 --rest-address=0.0.0.0 --nat=extip:172.18.184.88 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7061f244360aaecca2f0aca0d953bbb4a0b7cbe8f88cbeaede9667de37a15a0a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2170 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QA8RwMlvXGGCl5D0kSJykd-AvpfJ5-0EKkYYwb9qsnuqaYSBCQItBBSvYUZQKviPghPbPLnrzK1XxHm1YXXZlO4CgmlkgnY0gmlwhKwSdo6KbXVsdGlhZGRyc5YACASsEnaOBplzAAoErBJ2jgaZdN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDSI6xIRstE919gEJnXEpjZV7Dmlq65v4PjNuTPAyEcoGDdGNwgplzg3VkcIKZdYV3YWt1MgM --storenode=/ip4/172.18.118.142/tcp/39283/p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.184.88 waku d2609b887c87fd6c8e0053042022bccf5fd8077a8bf458708ab937ad96672f52
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d2609b887c87. Setting up logs at ./log/docker/store_node1_2024-11-25_06-28-54__202a22ef-bed5-4c24-8a27-5e8b9e77ba95__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 2166
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2166/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2166/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.184.88/tcp/2167/p2p/16Uiu2HAmMeeHyE1AFWxY91Dv4zV63s8mgbnSAH4hYTpU4Upaz8dr","/ip4/172.18.184.88/tcp/2168/ws/p2p/16Uiu2HAmMeeHyE1AFWxY91Dv4zV63s8mgbnSAH4hYTpU4Upaz8dr"],"enrUri":"enr:-L24QGzveXbzSPPzKJFCCFJ4FCzqPUuJnJBJ2O7GLbMmfcvwTNimniUS50syf8euct3mrlcmL8WBBuQTQmVYk90AdFUCgmlkgnY0gmlwhKwSuFiKbXVsdGlhZGRyc5YACASsErhYBgh3AAoErBK4WAYIeN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDhaKA6Is2mpOlkNFnOUZdR_bQr4Bqb0C2Ddk2g9ceB-2DdGNwggh3g3VkcIIIeYV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2166/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.118.142/tcp/39283/p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39282/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2166/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39282/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m tests.store.test_api_flags:test_api_flags.py:24 Running test with wrong_peer_addr: ip4/172.18.118.142/tcp/39283/p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2166/store/v3/messages?peerAddr=ip4%2F172.18.118.142%2Ftcp%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2166/store/v3/messages?peerAddr=ip4%2F172.18.118.142%2Ftcp%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0. Response content: b'Failed parsing remote peer info [MultiAddress.init [multiaddress: Invalid MultiAddress, must start with `/`]]'
[35mDEBUG   [0m tests.store.test_api_flags:test_api_flags.py:29  Response with wrong peer address is Error: 400 Client Error: Bad Request for url: http://127.0.0.1:2166/store/v3/messages?peerAddr=ip4%2F172.18.118.142%2Ftcp%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0 with response: b'Failed parsing remote peer info [MultiAddress.init [multiaddress: Invalid MultiAddress, must start with `/`]]'
[35mDEBUG   [0m tests.store.test_api_flags:test_api_flags.py:33 Running test with wrong_peer_addr /ip4/172.18.118.142/tcp/39283/p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFi
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2166/store/v3/messages?peerAddr=%2Fip4%2F172.18.118.142%2Ftcp%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFi&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2166/store/v3/messages?peerAddr=%2Fip4%2F172.18.118.142%2Ftcp%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFi&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0. Response content: b'Failed parsing remote peer info [MultiAddress.init [multiaddress: Error encoding `p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFi`]]'
[35mDEBUG   [0m tests.store.test_api_flags:test_api_flags.py:38  Response with wrong peer id is Error: 400 Client Error: Bad Request for url: http://127.0.0.1:2166/store/v3/messages?peerAddr=%2Fip4%2F172.18.118.142%2Ftcp%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFi&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0 with response: b'Failed parsing remote peer info [MultiAddress.init [multiaddress: Error encoding `p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFi`]]'
[35mDEBUG   [0m tests.store.test_api_flags:test_api_flags.py:43 logger is /ip4/172.18.118.142/39283/p2p/16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2166/store/v3/messages?peerAddr=%2Fip4%2F172.18.118.142%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2166/store/v3/messages?peerAddr=%2Fip4%2F172.18.118.142%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0. Response content: b"Failed parsing remote peer info [MultiAddress.init [multiaddress: Unsupported protocol '39283']]"
[35mDEBUG   [0m tests.store.test_api_flags:test_api_flags.py:48  Response with wrong peer address is Error: 400 Client Error: Bad Request for url: http://127.0.0.1:2166/store/v3/messages?peerAddr=%2Fip4%2F172.18.118.142%2F39283%2Fp2p%2F16Uiu2HAmHYDuHeU51cZk31c4UP7TDwLbngZmDBDJxnUhzneYvFig&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0 with response: b"Failed parsing remote peer info [MultiAddress.init [multiaddress: Unsupported protocol '39283']]"
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id c085f32a1fe8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id d2609b887c87
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c085f32a1fe8. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.