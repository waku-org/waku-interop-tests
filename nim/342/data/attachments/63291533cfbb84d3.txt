[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-09-02_04-19-55__c6de8cbd-0e29-4bfa-9e1a-0a97267a9517
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-02_04-19-55__c6de8cbd-0e29-4bfa-9e1a-0a97267a9517__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.252.100
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['43958', '43959', '43960', '43961', '43962']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 43958:43958 -p 43959:43959 -p 43960:43960 -p 43961:43961 -p 43962:43962 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43960 --rest-port=43958 --tcp-port=43959 --discv5-udp-port=43961 --rest-address=0.0.0.0 --nat=extip:172.18.252.100 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fc6cbfa80afcf827fe334baa8b937af0f0da0595f3a2e4f5dbdfd0d73c9c8bf4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43962 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.252.100 waku 8719e0f294d41cf6a21f4bcf716d93404df7d6e8787ec3d17f2b0e60cfd9fc49
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 8719e0f294d4. Setting up logs at ./log/docker/receiving_node1_2024-09-02_04-19-55__c6de8cbd-0e29-4bfa-9e1a-0a97267a9517__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 43958
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43958/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43958/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.252.100/tcp/43959/p2p/16Uiu2HAmPFKsSUGT9bk8FRBdtdz5yzGibX7xUpUxNvRxJ7N45tsu","/ip4/172.18.252.100/tcp/43960/ws/p2p/16Uiu2HAmPFKsSUGT9bk8FRBdtdz5yzGibX7xUpUxNvRxJ7N45tsu"],"enrUri":"enr:-LO4QJd1xG0ZDrmwDun-fnzXhbvnQBPL3jRSbHoLA1fK2oUMfZQoYM3iZ5sAnlze-ms7fmsAt1nYr8PhvPQB2qKwbIwBgmlkgnY0gmlwhKwS_GSKbXVsdGlhZGRyc4wACgSsEvxkBqu43QOCcnOFAAMBAACJc2VjcDI1NmsxoQOdYLAbEeXvDLHLX97WTa_OjO_jEmY2USTAoDtwfZAKpIN0Y3CCq7eDdWRwgqu5hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-02_04-19-55__c6de8cbd-0e29-4bfa-9e1a-0a97267a9517__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.141.103
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['37774', '37775', '37776', '37777', '37778']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 37774:37774 -p 37775:37775 -p 37776:37776 -p 37777:37777 -p 37778:37778 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37776 --rest-port=37774 --tcp-port=37775 --discv5-udp-port=37777 --rest-address=0.0.0.0 --nat=extip:172.18.141.103 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1f67cb607f545fcded3dc6619ccc5f6b6fd91f92fa25dacd6296c6e49c207d00 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37778 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.141.103 waku 501c463895734d98f14968e2d7a1cf0b7c69331574f0ca37372737a3250343c0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 501c46389573. Setting up logs at ./log/docker/receiving_node2_2024-09-02_04-19-55__c6de8cbd-0e29-4bfa-9e1a-0a97267a9517__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 37774
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37774/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37774/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.141.103/tcp/37775/p2p/16Uiu2HAmMGCDZEReoemdB3szgGWgbpdhJYnHXebVQ52HqnzjeTVJ","/ip4/172.18.141.103/tcp/37776/ws/p2p/16Uiu2HAmMGCDZEReoemdB3szgGWgbpdhJYnHXebVQ52HqnzjeTVJ"],"enrUri":"enr:-LO4QDRGNPim43BEZDTu1aDCXpqvl2720Uj068Bh9xEGghO0T9DSz8Gy_4eWFjDdyfy405Ime3SgwXKVBBH-vo9ttd8BgmlkgnY0gmlwhKwSjWeKbXVsdGlhZGRyc4wACgSsEo1nBpOQ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQN_4j3NHH2fK2qtfYpjyosVfUmd-U1HPyFCt0sx5zZ8WYN0Y3CCk4-DdWRwgpORhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37774/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.252.100/tcp/43959/p2p/16Uiu2HAmPFKsSUGT9bk8FRBdtdz5yzGibX7xUpUxNvRxJ7N45tsu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-02_04-19-55__c6de8cbd-0e29-4bfa-9e1a-0a97267a9517__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.85.16
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['9895', '9896', '9897', '9898', '9899']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 9895:9895 -p 9896:9896 -p 9897:9897 -p 9898:9898 -p 9899:9899 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9897 --rest-port=9895 --tcp-port=9896 --discv5-udp-port=9898 --rest-address=0.0.0.0 --nat=extip:172.18.85.16 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c6c97c8f4e7dfeddd35ceb5c58fe1e8fd3c7cce4f75cb7bf4817bb97dc439cb9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9899 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QJd1xG0ZDrmwDun-fnzXhbvnQBPL3jRSbHoLA1fK2oUMfZQoYM3iZ5sAnlze-ms7fmsAt1nYr8PhvPQB2qKwbIwBgmlkgnY0gmlwhKwS_GSKbXVsdGlhZGRyc4wACgSsEvxkBqu43QOCcnOFAAMBAACJc2VjcDI1NmsxoQOdYLAbEeXvDLHLX97WTa_OjO_jEmY2USTAoDtwfZAKpIN0Y3CCq7eDdWRwgqu5hXdha3UyCQ --lightpushnode=/ip4/172.18.252.100/tcp/43959/p2p/16Uiu2HAmPFKsSUGT9bk8FRBdtdz5yzGibX7xUpUxNvRxJ7N45tsu --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.85.16 waku 17986adaa3dbca52113977d9768a4f740f79ef6e33d8ac1317d60277646e6b75
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 17986adaa3db. Setting up logs at ./log/docker/lightpush_node1_2024-09-02_04-19-55__c6de8cbd-0e29-4bfa-9e1a-0a97267a9517__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 9895
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9895/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9895/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.85.16/tcp/9896/p2p/16Uiu2HAkusjffSHS1PfKSJdQHtCCxyqssutLYukwcB3arcFY75Jd","/ip4/172.18.85.16/tcp/9897/ws/p2p/16Uiu2HAkusjffSHS1PfKSJdQHtCCxyqssutLYukwcB3arcFY75Jd"],"enrUri":"enr:-LO4QG22Hy-j79Iz-Tao06TeKzG5BB6f6jmvf3RONv6EBcChDSJSgT_hHrViw7PehCwT_Yl9QqjgPpHfI5EuBz6dAtsBgmlkgnY0gmlwhKwSVRCKbXVsdGlhZGRyc4wACgSsElUQBiap3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIGrUU5cbLORkYtwWbyoyZ8GjQ-MmiUaoBbVLY_NkUrboN0Y3CCJqiDdWRwgiaqhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.252.100/tcp/43959/p2p/16Uiu2HAmPFKsSUGT9bk8FRBdtdz5yzGibX7xUpUxNvRxJ7N45tsu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.141.103/tcp/37775/p2p/16Uiu2HAmMGCDZEReoemdB3szgGWgbpdhJYnHXebVQ52HqnzjeTVJ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43958/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37774/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725250802195924736}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9895/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725250802202162176}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9895/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725250802205570048}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9895/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725250802209140224}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9895/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725250802212867840}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9895/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9895/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725250802216551424}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:9895/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 8719e0f294d4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 501c46389573
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 17986adaa3db
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.