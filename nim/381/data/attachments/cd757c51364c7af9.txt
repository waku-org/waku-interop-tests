[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-10-04_04-21-07__9a277d0e-f81c-4c08-8117-a1c0757e35f1
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-04_04-21-07__9a277d0e-f81c-4c08-8117-a1c0757e35f1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.45.115
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['49047', '49048', '49049', '49050', '49051']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 49047:49047 -p 49048:49048 -p 49049:49049 -p 49050:49050 -p 49051:49051 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49049 --rest-port=49047 --tcp-port=49048 --discv5-udp-port=49050 --rest-address=0.0.0.0 --nat=extip:172.18.45.115 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bcdaef805bd9fa30cd71cff70dbba73f93f8b5fb6acdcde9e39ceb16ca7bdfa5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49051 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.45.115 waku 859206188a6593b0f526b3184ea6ff20a55d95d2b9e67b197e703093ff0e3dfa
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 859206188a65. Setting up logs at ./log/docker/receiving_node1_2024-10-04_04-21-07__9a277d0e-f81c-4c08-8117-a1c0757e35f1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 49047
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49047/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49047/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.45.115/tcp/49048/p2p/16Uiu2HAmG5yYBLc2gAs9NnyEumAMhpLbq6vCHW2jNp6NxeBVMBpB","/ip4/172.18.45.115/tcp/49049/ws/p2p/16Uiu2HAmG5yYBLc2gAs9NnyEumAMhpLbq6vCHW2jNp6NxeBVMBpB"],"enrUri":"enr:-LO4QPWic_-pR3NUFNuz7_8e7u9fbtbDaUfX5cySNjS-0IKABtPC3ycwbKXVWk6erdNCXChiTfZRdK6ueKHixWeupvoBgmlkgnY0gmlwhKwSLXOKbXVsdGlhZGRyc4wACgSsEi1zBr-Z3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMy-amfN9VnpPxAk14nLHRXWzREGrY8V2iCHFHYufLC-IN0Y3CCv5iDdWRwgr-ahXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-04_04-21-07__9a277d0e-f81c-4c08-8117-a1c0757e35f1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.58.11
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['23541', '23542', '23543', '23544', '23545']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 23541:23541 -p 23542:23542 -p 23543:23543 -p 23544:23544 -p 23545:23545 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23543 --rest-port=23541 --tcp-port=23542 --discv5-udp-port=23544 --rest-address=0.0.0.0 --nat=extip:172.18.58.11 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=34ed251b8c37d1a69deacceb621d695d411ea2cdd3e810c27b57ac8bced55abd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23545 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.58.11 waku 32f79d34d2cc535371daf749816501180efb413c9d7da970f75b9e39579454a3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 32f79d34d2cc. Setting up logs at ./log/docker/receiving_node2_2024-10-04_04-21-07__9a277d0e-f81c-4c08-8117-a1c0757e35f1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 23541
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23541/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23541/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.58.11/tcp/23542/p2p/16Uiu2HAmDcYrzrSmJAxJdggSA2b2HZLGjscDDr3nsz9dbpnQpLES","/ip4/172.18.58.11/tcp/23543/ws/p2p/16Uiu2HAmDcYrzrSmJAxJdggSA2b2HZLGjscDDr3nsz9dbpnQpLES"],"enrUri":"enr:-LO4QG8RJIh_xB76i9iXoc5lBQRyNkdoJiuUYM5rOcgTH_rQIJe-vQP1U54TFFP1ZV8qPEVg-s-Yop3kYsYM8pe3FqwBgmlkgnY0gmlwhKwSOguKbXVsdGlhZGRyc4wACgSsEjoLBlv33QOCcnOFAAMBAACJc2VjcDI1NmsxoQMOO7TH-gyhVU5Fr9CKpWiMKqAxJKEtFCvQLw6jxaOmX4N0Y3CCW_aDdWRwglv4hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23541/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.45.115/tcp/49048/p2p/16Uiu2HAmG5yYBLc2gAs9NnyEumAMhpLbq6vCHW2jNp6NxeBVMBpB"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-04_04-21-07__9a277d0e-f81c-4c08-8117-a1c0757e35f1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.161.125
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['47056', '47057', '47058', '47059', '47060']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 47056:47056 -p 47057:47057 -p 47058:47058 -p 47059:47059 -p 47060:47060 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47058 --rest-port=47056 --tcp-port=47057 --discv5-udp-port=47059 --rest-address=0.0.0.0 --nat=extip:172.18.161.125 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=806e288f4c8309adbfc4baff2fe7fd42ee2870178b5b9991aaab16b320cfbca6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47060 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QPWic_-pR3NUFNuz7_8e7u9fbtbDaUfX5cySNjS-0IKABtPC3ycwbKXVWk6erdNCXChiTfZRdK6ueKHixWeupvoBgmlkgnY0gmlwhKwSLXOKbXVsdGlhZGRyc4wACgSsEi1zBr-Z3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMy-amfN9VnpPxAk14nLHRXWzREGrY8V2iCHFHYufLC-IN0Y3CCv5iDdWRwgr-ahXdha3UyCQ --lightpushnode=/ip4/172.18.45.115/tcp/49048/p2p/16Uiu2HAmG5yYBLc2gAs9NnyEumAMhpLbq6vCHW2jNp6NxeBVMBpB --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.161.125 waku be7bf8c4e5dcc3a12294b0df627ca008490b300aa7d0b5115d4422aae4acad58
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID be7bf8c4e5dc. Setting up logs at ./log/docker/lightpush_node1_2024-10-04_04-21-07__9a277d0e-f81c-4c08-8117-a1c0757e35f1__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 47056
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47056/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47056/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.161.125/tcp/47057/p2p/16Uiu2HAmGdyweH924ZboFkGXRvpP56wA6y1wdifC1RHMeFviySHs","/ip4/172.18.161.125/tcp/47058/ws/p2p/16Uiu2HAmGdyweH924ZboFkGXRvpP56wA6y1wdifC1RHMeFviySHs"],"enrUri":"enr:-LO4QP7WraQLUkNzEmJrqa9PYGTo9vBHlHJyT5_ESDgSE6fsAhJ0zYIvh5yrpCd8Z-5cvoqvn0yRK_T420EC7usa_ggBgmlkgnY0gmlwhKwSoX2KbXVsdGlhZGRyc4wACgSsEqF9BrfS3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM7LLS2wtojxt2bjDRyRhosQNiyvqcLlwmh8CktrEfWxoN0Y3CCt9GDdWRwgrfThXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47056/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.45.115/tcp/49048/p2p/16Uiu2HAmG5yYBLc2gAs9NnyEumAMhpLbq6vCHW2jNp6NxeBVMBpB"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47056/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.58.11/tcp/23542/p2p/16Uiu2HAmDcYrzrSmJAxJdggSA2b2HZLGjscDDr3nsz9dbpnQpLES"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49047/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23541/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47056/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1728015672079544320}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49047/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1728015672079544320,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.45.115/tcp/49048"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.45.115/tcp/49048"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 859206188a65
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 32f79d34d2cc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id be7bf8c4e5dc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.