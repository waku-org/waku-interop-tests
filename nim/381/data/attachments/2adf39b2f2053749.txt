[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_retrieve_messages_without_subscribing_via_api with id: 2024-10-04_04-25-28__7c8a4a0c-3abe-4093-ad21-02db508272aa
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-04_04-25-28__7c8a4a0c-3abe-4093-ad21-02db508272aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.79.233
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['21640', '21641', '21642', '21643', '21644']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 21640:21640 -p 21641:21641 -p 21642:21642 -p 21643:21643 -p 21644:21644 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21642 --rest-port=21640 --tcp-port=21641 --discv5-udp-port=21643 --rest-address=0.0.0.0 --nat=extip:172.18.79.233 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=feffda76fb6f843cd1bba8d2d9085fad68a736403d0d4fda8198b3bd3d77bc07 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21644 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.79.233 waku c64115b740a48ec216bdbcefeeac4d558fe18d6bcc9613ae4964ec4c8a4e7bc5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c64115b740a4. Setting up logs at ./log/docker/node1_2024-10-04_04-25-28__7c8a4a0c-3abe-4093-ad21-02db508272aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 21640
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21640/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21640/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.79.233/tcp/21641/p2p/16Uiu2HAm886TuuTYeNmXZpCtDExqdyY9tPNj1BN2B5z2gxRA3BSW","/ip4/172.18.79.233/tcp/21642/ws/p2p/16Uiu2HAm886TuuTYeNmXZpCtDExqdyY9tPNj1BN2B5z2gxRA3BSW"],"enrUri":"enr:-LO4QBj-I_aeiP0cr91Xjgf5TMOINH4lIifZryncKMtiWqZ_N-_XOPsFItgrRVG9ADqGLKHW2paVad99RQI8A1DHwGABgmlkgnY0gmlwhKwST-mKbXVsdGlhZGRyc4wACgSsEk_pBlSK3QOCcnOFAAIBAACJc2VjcDI1NmsxoQK8pykZ4onrXoNBd64vRReAXN-CW-P90AlfxoD1Nz1mT4N0Y3CCVImDdWRwglSLhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-04_04-25-28__7c8a4a0c-3abe-4093-ad21-02db508272aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.65.101
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['64804', '64805', '64806', '64807', '64808']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 64804:64804 -p 64805:64805 -p 64806:64806 -p 64807:64807 -p 64808:64808 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=64806 --rest-port=64804 --tcp-port=64805 --discv5-udp-port=64807 --rest-address=0.0.0.0 --nat=extip:172.18.65.101 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=46b589d6f804b746c4a5758dbaea2aa60bd29144b0d06b9ebe2c907ddf09dae3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=64808 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QBj-I_aeiP0cr91Xjgf5TMOINH4lIifZryncKMtiWqZ_N-_XOPsFItgrRVG9ADqGLKHW2paVad99RQI8A1DHwGABgmlkgnY0gmlwhKwST-mKbXVsdGlhZGRyc4wACgSsEk_pBlSK3QOCcnOFAAIBAACJc2VjcDI1NmsxoQK8pykZ4onrXoNBd64vRReAXN-CW-P90AlfxoD1Nz1mT4N0Y3CCVImDdWRwglSLhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.65.101 waku 3a81a4aee764309ae74ca9756addb5afede260a69055accb856cc0833b8ccb0d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 3a81a4aee764. Setting up logs at ./log/docker/node2_2024-10-04_04-25-28__7c8a4a0c-3abe-4093-ad21-02db508272aa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 64804
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64804/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64804/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.65.101/tcp/64805/p2p/16Uiu2HAmMemRAmPmw9Af2WKeFwvTvyNTQ656EFt1fGv67H3QYhU6","/ip4/172.18.65.101/tcp/64806/ws/p2p/16Uiu2HAmMemRAmPmw9Af2WKeFwvTvyNTQ656EFt1fGv67H3QYhU6"],"enrUri":"enr:-LO4QH0M7e0PdRY9o2ANQZEodMdTerOiwkL9XHTk0adwRL8ERvwBqvSn2vq8SErMI-jgz_VQiPF2XlZ3fE7Tyw0fM2sBgmlkgnY0gmlwhKwSQWWKbXVsdGlhZGRyc4wACgSsEkFlBv0m3QOCcnOFAAIBAACJc2VjcDI1NmsxoQOFqo8OocBYUM7bIObokXDCMT7FwMJdpqCCANIFNNuMS4N0Y3CC_SWDdWRwgv0nhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64804/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.79.233/tcp/21641/p2p/16Uiu2HAm886TuuTYeNmXZpCtDExqdyY9tPNj1BN2B5z2gxRA3BSW"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21640/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21640/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015933150507776,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015933150507776,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c64115b740a4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3a81a4aee764
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.