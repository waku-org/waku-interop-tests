[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-10-04_04-20-00__e482068f-7cd5-4e28-acaa-62bacd7f7581
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-04_04-20-00__e482068f-7cd5-4e28-acaa-62bacd7f7581__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.204.163
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['36144', '36145', '36146', '36147', '36148']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 36144:36144 -p 36145:36145 -p 36146:36146 -p 36147:36147 -p 36148:36148 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36146 --rest-port=36144 --tcp-port=36145 --discv5-udp-port=36147 --rest-address=0.0.0.0 --nat=extip:172.18.204.163 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dd5dca6f656ca4460cfaccf51aedbf0bd5ee5fddaf03acb35de16928df8f423c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36148 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.204.163 waku 7bd05cbb9e621a4a21f4f475365086a0af6efceb8784ebe0bd47d219beb9f286
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7bd05cbb9e62. Setting up logs at ./log/docker/receiving_node1_2024-10-04_04-20-00__e482068f-7cd5-4e28-acaa-62bacd7f7581__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 36144
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36144/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36144/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.204.163/tcp/36145/p2p/16Uiu2HAm6hCnoszPFummqhtKNvYwkQ86BZDkTZnXUddAxrRPUurW","/ip4/172.18.204.163/tcp/36146/ws/p2p/16Uiu2HAm6hCnoszPFummqhtKNvYwkQ86BZDkTZnXUddAxrRPUurW"],"enrUri":"enr:-LO4QA7mvTpbOCY37dNsnoHYEavrijP0EUGIstxL2P61o8pNfmOqkwjaIlNGrHH2rIaIEK171Tn4y5D7xcYmWm_Of1gBgmlkgnY0gmlwhKwSzKOKbXVsdGlhZGRyc4wACgSsEsyjBo0y3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKnaxsio7Gjdg3-bfqTU_6VjzcVNdzSGU77r6aWRucL34N0Y3CCjTGDdWRwgo0zhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-04_04-20-00__e482068f-7cd5-4e28-acaa-62bacd7f7581__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.153.5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['16037', '16038', '16039', '16040', '16041']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 16037:16037 -p 16038:16038 -p 16039:16039 -p 16040:16040 -p 16041:16041 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16039 --rest-port=16037 --tcp-port=16038 --discv5-udp-port=16040 --rest-address=0.0.0.0 --nat=extip:172.18.153.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ba300e0c0fbd51b5543dccacbd713efbfa95adcb5feba7c8ae579d88b31bafbe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16041 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.153.5 waku 665d5292729d106fc26bbc56a557e7b28a65c2abc4c2a968e92b326565f2d4e5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 665d5292729d. Setting up logs at ./log/docker/receiving_node2_2024-10-04_04-20-00__e482068f-7cd5-4e28-acaa-62bacd7f7581__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 16037
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16037/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16037/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.153.5/tcp/16038/p2p/16Uiu2HAkvjAqseTWijcXB9ruKRkrYQmEuUw46uCXHHodFSffUtFm","/ip4/172.18.153.5/tcp/16039/ws/p2p/16Uiu2HAkvjAqseTWijcXB9ruKRkrYQmEuUw46uCXHHodFSffUtFm"],"enrUri":"enr:-LO4QISSaOwRFJ2epsvS645v_GuLk2AO9p51k3j21mw1_Ai6bgVQB-g1zAXO2lONB51R1qnXQWvffNYAplTzoYJccoIBgmlkgnY0gmlwhKwSmQWKbXVsdGlhZGRyc4wACgSsEpkFBj6n3QOCcnOFAAMBAACJc2VjcDI1NmsxoQITVzJaoflf_oF45F3HBgMAkHuRymS2auk-FVuo_pFJHIN0Y3CCPqaDdWRwgj6ohXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16037/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.204.163/tcp/36145/p2p/16Uiu2HAm6hCnoszPFummqhtKNvYwkQ86BZDkTZnXUddAxrRPUurW"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-04_04-20-00__e482068f-7cd5-4e28-acaa-62bacd7f7581__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.167.15
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['22476', '22477', '22478', '22479', '22480']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 22476:22476 -p 22477:22477 -p 22478:22478 -p 22479:22479 -p 22480:22480 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22478 --rest-port=22476 --tcp-port=22477 --discv5-udp-port=22479 --rest-address=0.0.0.0 --nat=extip:172.18.167.15 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b6c72dfd8bf29c0e34b65d0acbf6f0dc9ec49ddece227dd4eea52dd05a50aa2a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22480 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QA7mvTpbOCY37dNsnoHYEavrijP0EUGIstxL2P61o8pNfmOqkwjaIlNGrHH2rIaIEK171Tn4y5D7xcYmWm_Of1gBgmlkgnY0gmlwhKwSzKOKbXVsdGlhZGRyc4wACgSsEsyjBo0y3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKnaxsio7Gjdg3-bfqTU_6VjzcVNdzSGU77r6aWRucL34N0Y3CCjTGDdWRwgo0zhXdha3UyCQ --lightpushnode=/ip4/172.18.204.163/tcp/36145/p2p/16Uiu2HAm6hCnoszPFummqhtKNvYwkQ86BZDkTZnXUddAxrRPUurW --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.167.15 waku 7b455f9f152551c624f251db87e70253e780e4666e40e8d23e572f0c1fae4a58
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7b455f9f1525. Setting up logs at ./log/docker/lightpush_node1_2024-10-04_04-20-00__e482068f-7cd5-4e28-acaa-62bacd7f7581__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22476
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22476/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22476/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.167.15/tcp/22477/p2p/16Uiu2HAmSGNs9nnCa6QVMXDikBR6uQofhuD6YLKHQgY6pgugvi93","/ip4/172.18.167.15/tcp/22478/ws/p2p/16Uiu2HAmSGNs9nnCa6QVMXDikBR6uQofhuD6YLKHQgY6pgugvi93"],"enrUri":"enr:-LO4QMCqZ2cP2tjWTAciIa5D9oIAwSo96cgF-wjkOGlcJcOHBO6dNajxb8BythJ0Rn5XZiQ4OPGJkzVf-WbXEAgb9QkBgmlkgnY0gmlwhKwSpw-KbXVsdGlhZGRyc4wACgSsEqcPBlfO3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPKOLdMHwIoqYPZJdgGU-DfKRoEPSTwSSQAu5HsJ9JJDoN0Y3CCV82DdWRwglfPhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22476/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.204.163/tcp/36145/p2p/16Uiu2HAm6hCnoszPFummqhtKNvYwkQ86BZDkTZnXUddAxrRPUurW"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22476/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.153.5/tcp/16038/p2p/16Uiu2HAkvjAqseTWijcXB9ruKRkrYQmEuUw46uCXHHodFSffUtFm"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36144/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16037/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22476/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728015604912041216}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36144/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015604912041216,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16037/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015604912041216,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22476/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728015604912041216}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:22476/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7bd05cbb9e62
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 665d5292729d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7b455f9f1525
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.