[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-10-04_04-19-53__e4228278-4264-47e6-9178-4876e92f9142
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-04_04-19-53__e4228278-4264-47e6-9178-4876e92f9142__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.125.47
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['27454', '27455', '27456', '27457', '27458']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 27454:27454 -p 27455:27455 -p 27456:27456 -p 27457:27457 -p 27458:27458 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27456 --rest-port=27454 --tcp-port=27455 --discv5-udp-port=27457 --rest-address=0.0.0.0 --nat=extip:172.18.125.47 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=98dfc2ad15b5eccefdfb53cfa1ee5dd1e9fc0eef91df5b9d318cdd3bdb3b74b3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27458 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.125.47 waku d30222bb34b911b27eeda4ad27f01f87cdeb6dc600f5b25044554a9f4c0da576
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID d30222bb34b9. Setting up logs at ./log/docker/receiving_node1_2024-10-04_04-19-53__e4228278-4264-47e6-9178-4876e92f9142__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 27454
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27454/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27454/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.125.47/tcp/27455/p2p/16Uiu2HAmCrsQ3CriL8n2stxagJyKinTZHcegTDmz3twGLDWMLaM5","/ip4/172.18.125.47/tcp/27456/ws/p2p/16Uiu2HAmCrsQ3CriL8n2stxagJyKinTZHcegTDmz3twGLDWMLaM5"],"enrUri":"enr:-LO4QJBdFRo49lxcB7C9k1EDIDAPg-ycnjAh3ekpMYPBpb2wLFV7Y8o5YpOzEaICTEfRgubWbsaVgrDuL0IfS7iouZEBgmlkgnY0gmlwhKwSfS-KbXVsdGlhZGRyc4wACgSsEn0vBmtA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMDCxu-Z7flbKJs7tCINxhvHI6A_FIF4Ky8mbPWvIOJCIN0Y3CCaz-DdWRwgmtBhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-04_04-19-53__e4228278-4264-47e6-9178-4876e92f9142__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.226.179
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['23619', '23620', '23621', '23622', '23623']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 23619:23619 -p 23620:23620 -p 23621:23621 -p 23622:23622 -p 23623:23623 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23621 --rest-port=23619 --tcp-port=23620 --discv5-udp-port=23622 --rest-address=0.0.0.0 --nat=extip:172.18.226.179 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bc1ee9c257fec037aa251245e4ffba3fdda0febad8975dda4dde09ee27eeecad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23623 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.226.179 waku dd78e738d2358fe8dce3ef628582121bbe366a0df7594b01f72706724055fc25
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID dd78e738d235. Setting up logs at ./log/docker/receiving_node2_2024-10-04_04-19-53__e4228278-4264-47e6-9178-4876e92f9142__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 23619
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23619/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23619/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.226.179/tcp/23620/p2p/16Uiu2HAm8cnW6yepY3o8Rw6h6erhvJGJyDvTKYajhNW7FPEBXUEU","/ip4/172.18.226.179/tcp/23621/ws/p2p/16Uiu2HAm8cnW6yepY3o8Rw6h6erhvJGJyDvTKYajhNW7FPEBXUEU"],"enrUri":"enr:-LO4QGF63RCK04w-PvEEjo41ASQNezjdwLmPmgqi50c3-3RLArlVq9MqQkKOgvv6JQ_mllyH0NZvXJWsc8_eGap8aUABgmlkgnY0gmlwhKwS4rOKbXVsdGlhZGRyc4wACgSsEuKzBlxF3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLEALGt-b74z5hkMRlmnFOSxqClHN89EEj6zrx827EayYN0Y3CCXESDdWRwglxGhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23619/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.125.47/tcp/27455/p2p/16Uiu2HAmCrsQ3CriL8n2stxagJyKinTZHcegTDmz3twGLDWMLaM5"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-04_04-19-53__e4228278-4264-47e6-9178-4876e92f9142__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.190.217
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['38867', '38868', '38869', '38870', '38871']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 38867:38867 -p 38868:38868 -p 38869:38869 -p 38870:38870 -p 38871:38871 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38869 --rest-port=38867 --tcp-port=38868 --discv5-udp-port=38870 --rest-address=0.0.0.0 --nat=extip:172.18.190.217 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a07f06edf4902f0aecfa463d04d65abe662223ea15b4f7a70fde26836af220e1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38871 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QJBdFRo49lxcB7C9k1EDIDAPg-ycnjAh3ekpMYPBpb2wLFV7Y8o5YpOzEaICTEfRgubWbsaVgrDuL0IfS7iouZEBgmlkgnY0gmlwhKwSfS-KbXVsdGlhZGRyc4wACgSsEn0vBmtA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMDCxu-Z7flbKJs7tCINxhvHI6A_FIF4Ky8mbPWvIOJCIN0Y3CCaz-DdWRwgmtBhXdha3UyCQ --lightpushnode=/ip4/172.18.125.47/tcp/27455/p2p/16Uiu2HAmCrsQ3CriL8n2stxagJyKinTZHcegTDmz3twGLDWMLaM5 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.190.217 waku 454958c2068f344725ff3b0dbabfa4d3aff42953b7b658b986e13d00de5ce949
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 454958c2068f. Setting up logs at ./log/docker/lightpush_node1_2024-10-04_04-19-53__e4228278-4264-47e6-9178-4876e92f9142__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 38867
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38867/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38867/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.190.217/tcp/38868/p2p/16Uiu2HAm2VmWST2gmwmFxoSxLRUN4LjbmBJ8pmbVS877f4dGCxCX","/ip4/172.18.190.217/tcp/38869/ws/p2p/16Uiu2HAm2VmWST2gmwmFxoSxLRUN4LjbmBJ8pmbVS877f4dGCxCX"],"enrUri":"enr:-LO4QIPh7NZeACfxoyAt_3CMQ1Z7o2-yDgr3YavRxbV82FEPE9t1m6S4iJR4xzy32eBjwObDO5G4u9WDT7_99ix29ZUBgmlkgnY0gmlwhKwSvtmKbXVsdGlhZGRyc4wACgSsEr7ZBpfV3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJpDmH3WqJSkODUHT5dQVLbU0bua67K5kQdLDKzys6LQIN0Y3CCl9SDdWRwgpfWhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38867/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.125.47/tcp/27455/p2p/16Uiu2HAmCrsQ3CriL8n2stxagJyKinTZHcegTDmz3twGLDWMLaM5"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38867/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.226.179/tcp/23620/p2p/16Uiu2HAm8cnW6yepY3o8Rw6h6erhvJGJyDvTKYajhNW7FPEBXUEU"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27454/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23619/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38867/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728015598253873152, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27454/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015598253873152,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23619/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015598253873152,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38867/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728015598372589056, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27454/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015598372589056,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23619/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728015598372589056,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d30222bb34b9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id dd78e738d235
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 454958c2068f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.