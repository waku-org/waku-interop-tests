[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-10-05_04-18-24__6639cae2-dacd-4ebb-b514-c2f08a2820e5
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-05_04-18-24__6639cae2-dacd-4ebb-b514-c2f08a2820e5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.97.235
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['21842', '21843', '21844', '21845', '21846']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 21842:21842 -p 21843:21843 -p 21844:21844 -p 21845:21845 -p 21846:21846 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21844 --rest-port=21842 --tcp-port=21843 --discv5-udp-port=21845 --rest-address=0.0.0.0 --nat=extip:172.18.97.235 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aa08ac9bbcf0af41b8d1ba5e7fe05f01f30c3cd9cab93bd51970d1fe354e35ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21846 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.97.235 waku ca16bb552b46da2c6d6e310f32fd2827a04bb420285e0a34b2f4d11af6a98b51
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ca16bb552b46. Setting up logs at ./log/docker/receiving_node1_2024-10-05_04-18-24__6639cae2-dacd-4ebb-b514-c2f08a2820e5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 21842
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21842/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21842/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.235/tcp/21843/p2p/16Uiu2HAm8RFK5dMQrpFGuqzdBHs6SLZiiXCB6UcQrpBQz18n7zhY","/ip4/172.18.97.235/tcp/21844/ws/p2p/16Uiu2HAm8RFK5dMQrpFGuqzdBHs6SLZiiXCB6UcQrpBQz18n7zhY"],"enrUri":"enr:-LO4QE68snFPshfJ3135Jo7O5zNhOctp_0q8jcWSzIDjfbDmNUvVeYBo32q6JS-v6FBhUXUAig26QM-MEuMTBP3-L_4BgmlkgnY0gmlwhKwSYeuKbXVsdGlhZGRyc4wACgSsEmHrBlVU3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLBDAnX-epnpj4Bsv8iFCJPVRFJ7VfawuNMTum-q-8704N0Y3CCVVODdWRwglVVhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-05_04-18-24__6639cae2-dacd-4ebb-b514-c2f08a2820e5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.40.109
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['9784', '9785', '9786', '9787', '9788']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 9784:9784 -p 9785:9785 -p 9786:9786 -p 9787:9787 -p 9788:9788 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9786 --rest-port=9784 --tcp-port=9785 --discv5-udp-port=9787 --rest-address=0.0.0.0 --nat=extip:172.18.40.109 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ef59cd2d0ecee004abad4200b26bb64d0b3a8cdab4c2c733142dd4e29ec6354e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9788 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.40.109 waku 177faa68b0aba08cfb6de7073a4aaceb2393d2b163caa00db568544f72d61408
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 177faa68b0ab. Setting up logs at ./log/docker/receiving_node2_2024-10-05_04-18-24__6639cae2-dacd-4ebb-b514-c2f08a2820e5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 9784
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9784/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9784/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.40.109/tcp/9785/p2p/16Uiu2HAkzYm2yZSbyUFp8ZH7dEdtXdNy4mDCrdFKfWynipfXCcun","/ip4/172.18.40.109/tcp/9786/ws/p2p/16Uiu2HAkzYm2yZSbyUFp8ZH7dEdtXdNy4mDCrdFKfWynipfXCcun"],"enrUri":"enr:-LO4QLJNK18DsK7iUoOqUZU1Bas8V6R_dco3lYEOWbykVph-Qpb9DXRbczSgBkoOS-CZImytb6ZpFEtHDRogNoww8WgBgmlkgnY0gmlwhKwSKG2KbXVsdGlhZGRyc4wACgSsEihtBiY63QOCcnOFAAMBAACJc2VjcDI1NmsxoQJMGzdCRlxuukV6KWBHh5o7GK2mvtels4a0FHr3FUgKeYN0Y3CCJjmDdWRwgiY7hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9784/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.97.235/tcp/21843/p2p/16Uiu2HAm8RFK5dMQrpFGuqzdBHs6SLZiiXCB6UcQrpBQz18n7zhY"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-05_04-18-24__6639cae2-dacd-4ebb-b514-c2f08a2820e5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.247.201
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['15729', '15730', '15731', '15732', '15733']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 15729:15729 -p 15730:15730 -p 15731:15731 -p 15732:15732 -p 15733:15733 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15731 --rest-port=15729 --tcp-port=15730 --discv5-udp-port=15732 --rest-address=0.0.0.0 --nat=extip:172.18.247.201 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ededdffe3ebfc53ecd12f8d17a69ca22d204a27a7cfae0e4efeae9ed5fb8fe55 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15733 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QE68snFPshfJ3135Jo7O5zNhOctp_0q8jcWSzIDjfbDmNUvVeYBo32q6JS-v6FBhUXUAig26QM-MEuMTBP3-L_4BgmlkgnY0gmlwhKwSYeuKbXVsdGlhZGRyc4wACgSsEmHrBlVU3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLBDAnX-epnpj4Bsv8iFCJPVRFJ7VfawuNMTum-q-8704N0Y3CCVVODdWRwglVVhXdha3UyCQ --lightpushnode=/ip4/172.18.97.235/tcp/21843/p2p/16Uiu2HAm8RFK5dMQrpFGuqzdBHs6SLZiiXCB6UcQrpBQz18n7zhY --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.247.201 waku 432ce9a732eb07302de199409a5b1d763f74192045e7ef4da2e7fbaa77abfac7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 432ce9a732eb. Setting up logs at ./log/docker/lightpush_node1_2024-10-05_04-18-24__6639cae2-dacd-4ebb-b514-c2f08a2820e5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 15729
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15729/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15729/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.247.201/tcp/15730/p2p/16Uiu2HAm8h26wvtNxzNYFurghtcJguuSDjoDjCtgM7oT4SFRFHRk","/ip4/172.18.247.201/tcp/15731/ws/p2p/16Uiu2HAm8h26wvtNxzNYFurghtcJguuSDjoDjCtgM7oT4SFRFHRk"],"enrUri":"enr:-LO4QH0gGtz5eoTuTIlMnHDeCDB2JrlBOxHEZT2UV-288y73VeTTT0XcV8TLt5IurJZ_40l9qBM79pxbo-HIYgMB8FgBgmlkgnY0gmlwhKwS98mKbXVsdGlhZGRyc4wACgSsEvfJBj1z3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLFFmVOLNvxcXJ5kuz0m7Wd_fqLb09QlrSagOn13oa4C4N0Y3CCPXKDdWRwgj10hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.97.235/tcp/21843/p2p/16Uiu2HAm8RFK5dMQrpFGuqzdBHs6SLZiiXCB6UcQrpBQz18n7zhY"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.40.109/tcp/9785/p2p/16Uiu2HAkzYm2yZSbyUFp8ZH7dEdtXdNy4mDCrdFKfWynipfXCcun"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21842/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9784/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728101909467719680}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15729/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728101909472528384}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15729/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728101909475990528}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15729/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728101909481000960}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15729/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728101909487293184}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15729/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15729/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728101909494121472}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15729/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ca16bb552b46
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 177faa68b0ab
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 432ce9a732eb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.