[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-10-15_04-21-23__5ce74234-6a9e-4792-b934-5985b7c2efbb
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-15_04-21-23__5ce74234-6a9e-4792-b934-5985b7c2efbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.203.211
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['24712', '24713', '24714', '24715', '24716']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 24712:24712 -p 24713:24713 -p 24714:24714 -p 24715:24715 -p 24716:24716 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24714 --rest-port=24712 --tcp-port=24713 --discv5-udp-port=24715 --rest-address=0.0.0.0 --nat=extip:172.18.203.211 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5abe813a369ba1e3ab3af489aa3c4f0aafac47e9d5deedcf02ccdccdc3b25a4b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24716 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.203.211 waku c4711f6c3efa23fa12dd564e07537c59abdebcd4957c4e45dacee02a9b5838b0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c4711f6c3efa. Setting up logs at ./log/docker/receiving_node1_2024-10-15_04-21-23__5ce74234-6a9e-4792-b934-5985b7c2efbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 24712
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24712/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24712/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.203.211/tcp/24713/p2p/16Uiu2HAkyd8P9sSAnGqBdsjrPqX3Bs6drbCKcaXbsFkNob733rfg","/ip4/172.18.203.211/tcp/24714/ws/p2p/16Uiu2HAkyd8P9sSAnGqBdsjrPqX3Bs6drbCKcaXbsFkNob733rfg"],"enrUri":"enr:-LO4QPm8YrzTb2Q5AdjTbpPTzkgKX-wt7zGVIFWjEq_mG8JUX24u0DzHE7QaQiE6JnPzj_t_sf4dlP37ytrMcUw4KSABgmlkgnY0gmlwhKwSy9OKbXVsdGlhZGRyc4wACgSsEsvTBmCK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI-Xf2EjtNzS0PXsyr_0joRbqzPi6wgJxEO8gECRNvvV4N0Y3CCYImDdWRwgmCLhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-15_04-21-23__5ce74234-6a9e-4792-b934-5985b7c2efbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.192.203
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['44192', '44193', '44194', '44195', '44196']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 44192:44192 -p 44193:44193 -p 44194:44194 -p 44195:44195 -p 44196:44196 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44194 --rest-port=44192 --tcp-port=44193 --discv5-udp-port=44195 --rest-address=0.0.0.0 --nat=extip:172.18.192.203 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c9c9ecb927c58006b4bd39fc3880de26c3f2fdcee2ffadbed9db9e19ae32edb0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44196 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.192.203 waku 1d488c3695fb00c2458a1f17b0aa439bfc0de9b8c608858359ba9d74f1fb7594
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 1d488c3695fb. Setting up logs at ./log/docker/receiving_node2_2024-10-15_04-21-23__5ce74234-6a9e-4792-b934-5985b7c2efbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 44192
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44192/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44192/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.192.203/tcp/44193/p2p/16Uiu2HAm7kLukkHxT27NUJMgfHhQSfFyzd35otvLVh9QPjnhYj69","/ip4/172.18.192.203/tcp/44194/ws/p2p/16Uiu2HAm7kLukkHxT27NUJMgfHhQSfFyzd35otvLVh9QPjnhYj69"],"enrUri":"enr:-LO4QJbNbuvElq0NeMv6iK-EsaFr9fM0uag_VvZRtDqd4YLMW_aaukWHuSYU0AD3hCNwcccdIgY91UhrUZ_2V1xmG8kBgmlkgnY0gmlwhKwSwMuKbXVsdGlhZGRyc4wACgSsEsDLBqyi3QOCcnOFAAMBAACJc2VjcDI1NmsxoQK3FLdlZlaK8jzl2zY-SckUCVtHWJ-ZCQn87vIuwyMwCoN0Y3CCrKGDdWRwgqyjhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44192/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.203.211/tcp/24713/p2p/16Uiu2HAkyd8P9sSAnGqBdsjrPqX3Bs6drbCKcaXbsFkNob733rfg"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-15_04-21-23__5ce74234-6a9e-4792-b934-5985b7c2efbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.6.88
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['16111', '16112', '16113', '16114', '16115']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 16111:16111 -p 16112:16112 -p 16113:16113 -p 16114:16114 -p 16115:16115 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16113 --rest-port=16111 --tcp-port=16112 --discv5-udp-port=16114 --rest-address=0.0.0.0 --nat=extip:172.18.6.88 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ccc6eae5267452d4655bbb0a183884e048a2ae03ab106fe7cbbc70dfd4d74f8f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16115 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QPm8YrzTb2Q5AdjTbpPTzkgKX-wt7zGVIFWjEq_mG8JUX24u0DzHE7QaQiE6JnPzj_t_sf4dlP37ytrMcUw4KSABgmlkgnY0gmlwhKwSy9OKbXVsdGlhZGRyc4wACgSsEsvTBmCK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI-Xf2EjtNzS0PXsyr_0joRbqzPi6wgJxEO8gECRNvvV4N0Y3CCYImDdWRwgmCLhXdha3UyCQ --lightpushnode=/ip4/172.18.203.211/tcp/24713/p2p/16Uiu2HAkyd8P9sSAnGqBdsjrPqX3Bs6drbCKcaXbsFkNob733rfg --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.6.88 waku afe06a49a00ab07373e98e7d22844e07abef630b8ae5b15c5ef14d3940bfe780
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID afe06a49a00a. Setting up logs at ./log/docker/lightpush_node1_2024-10-15_04-21-23__5ce74234-6a9e-4792-b934-5985b7c2efbb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 16111
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16111/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16111/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.6.88/tcp/16112/p2p/16Uiu2HAmEJt4uBT7GGazMzQj6fds17mTz1ZDoJU9ddc3o8qPki1a","/ip4/172.18.6.88/tcp/16113/ws/p2p/16Uiu2HAmEJt4uBT7GGazMzQj6fds17mTz1ZDoJU9ddc3o8qPki1a"],"enrUri":"enr:-LO4QIFKHbIty6XKtr-WgYeG-55iQ_xCinpfCbE6-wu858svYCHzYwSHT2f4HJGxbo0tuaNO_WYzIjXJUoZr8zSBmHwBgmlkgnY0gmlwhKwSBliKbXVsdGlhZGRyc4wACgSsEgZYBj7x3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMYkKdonKbsJTarLALPjLw5haVekTq8pet5msoLByD7vYN0Y3CCPvCDdWRwgj7yhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16111/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.203.211/tcp/24713/p2p/16Uiu2HAkyd8P9sSAnGqBdsjrPqX3Bs6drbCKcaXbsFkNob733rfg"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16111/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.192.203/tcp/44193/p2p/16Uiu2HAm7kLukkHxT27NUJMgfHhQSfFyzd35otvLVh9QPjnhYj69"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:24712/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44192/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16111/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1728966088525518848}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24712/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1728966088525518848,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.203.211/tcp/24713"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.203.211/tcp/24713"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c4711f6c3efa
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1d488c3695fb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id afe06a49a00a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.