[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2025-01-06_04-12-46__0f64da5c-5b96-42c7-be17-00b260e556e7
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-01-06_04-12-46__0f64da5c-5b96-42c7-be17-00b260e556e7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.72.80
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['46084', '46085', '46086', '46087', '46088']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 46084:46084 -p 46085:46085 -p 46086:46086 -p 46087:46087 -p 46088:46088 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46086 --rest-port=46084 --tcp-port=46085 --discv5-udp-port=46087 --rest-address=0.0.0.0 --nat=extip:172.18.72.80 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a42fba11cca0c4cbcaaa44e7580edcb5cfdc14fd7f0fe835a22d738c214e782c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46088 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.72.80 waku f932d5cde926e3728e6092dc878e8081e623930832f64161bbc49c73a3674038
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f932d5cde926. Setting up logs at ./log/docker/receiving_node1_2025-01-06_04-12-46__0f64da5c-5b96-42c7-be17-00b260e556e7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 46084
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 268be8f09ad0. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46084/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46084/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.72.80/tcp/46085/p2p/16Uiu2HAm6e8y6FqFPkJg5Tqy99f9YgaP4Bd3PV12MqYNbHopv3gi","/ip4/172.18.72.80/tcp/46086/ws/p2p/16Uiu2HAm6e8y6FqFPkJg5Tqy99f9YgaP4Bd3PV12MqYNbHopv3gi"],"enrUri":"enr:-L24QEKMQZC1TMBY0BGhSHYru1SVzTHsH82pWRsZ3iLGlK1YBcHLxpPLfLC1HHiIENFewmcas55AK4ySB9gBsg8PRvUCgmlkgnY0gmlwhKwSSFCKbXVsdGlhZGRyc5YACASsEkhQBrQFAAoErBJIUAa0Bt0DgnJzhQADAQAAiXNlY3AyNTZrMaECpqIKjKz33FjH7akDcGpx77KUdTdrD80WO005Ah4lSj-DdGNwgrQFg3VkcIK0B4V3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-01-06_04-12-46__0f64da5c-5b96-42c7-be17-00b260e556e7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.154.45
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['6135', '6136', '6137', '6138', '6139']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 6135:6135 -p 6136:6136 -p 6137:6137 -p 6138:6138 -p 6139:6139 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6137 --rest-port=6135 --tcp-port=6136 --discv5-udp-port=6138 --rest-address=0.0.0.0 --nat=extip:172.18.154.45 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c90f0dce6ffccf310e82fccb6bab17bc952c0b9db86a5bdcd67d100aad99d5b9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6139 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.154.45 waku d4f15590c8ffca8d8315a79d47ad0aa9f46c6a0b624307e97b7f1372c7abd5bd
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d4f15590c8ff. Setting up logs at ./log/docker/receiving_node2_2025-01-06_04-12-46__0f64da5c-5b96-42c7-be17-00b260e556e7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 6135
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6135/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6135/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.154.45/tcp/6136/p2p/16Uiu2HAmNwWas3G8iRCgnYSjCMMaX5W3s91HbYDC4TrijSbAAiUc","/ip4/172.18.154.45/tcp/6137/ws/p2p/16Uiu2HAmNwWas3G8iRCgnYSjCMMaX5W3s91HbYDC4TrijSbAAiUc"],"enrUri":"enr:-L24QO8PGY6I6xAVGL8rdC46Off5SiWkF8qcpBWZUKuOSsXVOmjRNts8uBLFoMxtSnSHgyaPdukztyViUOpjmGt-i8cCgmlkgnY0gmlwhKwSmi2KbXVsdGlhZGRyc5YACASsEpotBhf4AAoErBKaLQYX-d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDmNBZEji5NpaOGG3K51VThKlye6eNhoIk1YnRObdFCX2DdGNwghf4g3VkcIIX-oV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6135/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.72.80/tcp/46085/p2p/16Uiu2HAm6e8y6FqFPkJg5Tqy99f9YgaP4Bd3PV12MqYNbHopv3gi"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-01-06_04-12-46__0f64da5c-5b96-42c7-be17-00b260e556e7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.75.203
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['2781', '2782', '2783', '2784', '2785']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 2781:2781 -p 2782:2782 -p 2783:2783 -p 2784:2784 -p 2785:2785 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2783 --rest-port=2781 --tcp-port=2782 --discv5-udp-port=2784 --rest-address=0.0.0.0 --nat=extip:172.18.75.203 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=35cf2fa05d16beadd17ce4cf8d1abf3fa3a44fa3a4b6a0e8c7863189d0af93af --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2785 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QEKMQZC1TMBY0BGhSHYru1SVzTHsH82pWRsZ3iLGlK1YBcHLxpPLfLC1HHiIENFewmcas55AK4ySB9gBsg8PRvUCgmlkgnY0gmlwhKwSSFCKbXVsdGlhZGRyc5YACASsEkhQBrQFAAoErBJIUAa0Bt0DgnJzhQADAQAAiXNlY3AyNTZrMaECpqIKjKz33FjH7akDcGpx77KUdTdrD80WO005Ah4lSj-DdGNwgrQFg3VkcIK0B4V3YWt1Mgk --lightpushnode=/ip4/172.18.72.80/tcp/46085/p2p/16Uiu2HAm6e8y6FqFPkJg5Tqy99f9YgaP4Bd3PV12MqYNbHopv3gi --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.75.203 waku f59250974e81c5581606c46d57de465c46e32dceb71e03a186d19bb248225487
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f59250974e81. Setting up logs at ./log/docker/lightpush_node1_2025-01-06_04-12-46__0f64da5c-5b96-42c7-be17-00b260e556e7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 2781
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2781/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2781/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.75.203/tcp/2782/p2p/16Uiu2HAkzzok1X27kzp8ZedvLCLqKpCTuToXCRmLhik7522TLAdB","/ip4/172.18.75.203/tcp/2783/ws/p2p/16Uiu2HAkzzok1X27kzp8ZedvLCLqKpCTuToXCRmLhik7522TLAdB"],"enrUri":"enr:-L24QEf_aEa_KMthnLE_yX-us7JbYMr9cQOyc_UwI1Y_Nu3Vem9aCZdYdz_5SZY05Atko_Cy56hCVsXEWWeW5qZnU5MCgmlkgnY0gmlwhKwSS8uKbXVsdGlhZGRyc5YACASsEkvLBgreAAoErBJLywYK390DgnJzhQADAQAAiXNlY3AyNTZrMaECUsdg1MlYQBVx7DeOxRnnknkvvtN5UQUZwW6GfsY3oO6DdGNwggreg3VkcIIK4IV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2781/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.72.80/tcp/46085/p2p/16Uiu2HAm6e8y6FqFPkJg5Tqy99f9YgaP4Bd3PV12MqYNbHopv3gi"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2781/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.154.45/tcp/6136/p2p/16Uiu2HAmNwWas3G8iRCgnYSjCMMaX5W3s91HbYDC4TrijSbAAiUc"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46084/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6135/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2781/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1736136770466301696}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46084/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1736136770466301696,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6135/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1736136770466301696,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2781/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1736136770466301696}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:2781/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id f932d5cde926
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d4f15590c8ff
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f932d5cde926. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id f59250974e81
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d4f15590c8ff. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.