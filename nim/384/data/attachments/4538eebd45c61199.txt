[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-10-07_04-20-06__b26552d7-77ea-4d8e-9943-0db31e0841a3
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-07_04-20-06__b26552d7-77ea-4d8e-9943-0db31e0841a3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.146.157
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['18259', '18260', '18261', '18262', '18263']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 18259:18259 -p 18260:18260 -p 18261:18261 -p 18262:18262 -p 18263:18263 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18261 --rest-port=18259 --tcp-port=18260 --discv5-udp-port=18262 --rest-address=0.0.0.0 --nat=extip:172.18.146.157 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bff1cbea3af477cbccda104992af74ac3bbbd66f5dcbbc2dce3e9cb39865caf4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18263 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.146.157 waku acc665e4ae72094e41edca9ea68e70f40bb4d1635dad0e76e099086cbc4dfbb4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID acc665e4ae72. Setting up logs at ./log/docker/receiving_node1_2024-10-07_04-20-06__b26552d7-77ea-4d8e-9943-0db31e0841a3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 18259
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18259/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18259/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.146.157/tcp/18260/p2p/16Uiu2HAmKaZGDqThroEbfTc6Vzy7KG2vSDeciGELwiu8ybUdSLXu","/ip4/172.18.146.157/tcp/18261/ws/p2p/16Uiu2HAmKaZGDqThroEbfTc6Vzy7KG2vSDeciGELwiu8ybUdSLXu"],"enrUri":"enr:-LO4QDddEUER8QCfx2Sc_LpDpum-OOSmnfoT99TiDTrhJ_YVat0izRNNFM3oDw3HwgoongV6Gtemg9zMn-siKQr9asQBgmlkgnY0gmlwhKwSkp2KbXVsdGlhZGRyc4wACgSsEpKdBkdV3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNm3x5tyMMEps9vVB-YVHQQ7dy2xsGqTcBLgf-jY1hANIN0Y3CCR1SDdWRwgkdWhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-07_04-20-06__b26552d7-77ea-4d8e-9943-0db31e0841a3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.250.182
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['29456', '29457', '29458', '29459', '29460']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 29456:29456 -p 29457:29457 -p 29458:29458 -p 29459:29459 -p 29460:29460 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29458 --rest-port=29456 --tcp-port=29457 --discv5-udp-port=29459 --rest-address=0.0.0.0 --nat=extip:172.18.250.182 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7fcd5fa7ee37c56f44f758d4541f79d1e6fdedb6ea0121fbcd3566ccfd29d8f4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29460 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.250.182 waku 6e36ed21276cd38e007984446df34d97ffd33f27ec9ce16af06ed8cf88db8fb2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 6e36ed21276c. Setting up logs at ./log/docker/receiving_node2_2024-10-07_04-20-06__b26552d7-77ea-4d8e-9943-0db31e0841a3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 29456
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29456/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29456/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.250.182/tcp/29457/p2p/16Uiu2HAm4b4hS8wpJ99wugSqJUaSrArmo916cY9akMpxyQrajcqo","/ip4/172.18.250.182/tcp/29458/ws/p2p/16Uiu2HAm4b4hS8wpJ99wugSqJUaSrArmo916cY9akMpxyQrajcqo"],"enrUri":"enr:-LO4QBsiJAujEZDUHXbX2L34DhuKP-fp1UvrI-2rj2qKZJ4_LmrB0azVif68BQDNyxTSSXDltDRuq1Au1LTaK6L83YMBgmlkgnY0gmlwhKwS-raKbXVsdGlhZGRyc4wACgSsEvq2BnMS3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKIIRjNDpc773Ojq3mGOOYHpQXK3ztNCBM07cnmU8EE-oN0Y3CCcxGDdWRwgnMThXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29456/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.146.157/tcp/18260/p2p/16Uiu2HAmKaZGDqThroEbfTc6Vzy7KG2vSDeciGELwiu8ybUdSLXu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-07_04-20-06__b26552d7-77ea-4d8e-9943-0db31e0841a3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.38.123
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['48517', '48518', '48519', '48520', '48521']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 48517:48517 -p 48518:48518 -p 48519:48519 -p 48520:48520 -p 48521:48521 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48519 --rest-port=48517 --tcp-port=48518 --discv5-udp-port=48520 --rest-address=0.0.0.0 --nat=extip:172.18.38.123 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bdbad07418acc9ccd19d3bbaf4b9010bde81fbefefcb0cd8acfe3dd3df125ca8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48521 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QDddEUER8QCfx2Sc_LpDpum-OOSmnfoT99TiDTrhJ_YVat0izRNNFM3oDw3HwgoongV6Gtemg9zMn-siKQr9asQBgmlkgnY0gmlwhKwSkp2KbXVsdGlhZGRyc4wACgSsEpKdBkdV3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNm3x5tyMMEps9vVB-YVHQQ7dy2xsGqTcBLgf-jY1hANIN0Y3CCR1SDdWRwgkdWhXdha3UyCQ --lightpushnode=/ip4/172.18.146.157/tcp/18260/p2p/16Uiu2HAmKaZGDqThroEbfTc6Vzy7KG2vSDeciGELwiu8ybUdSLXu --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.38.123 waku bb496265bc40080a0cf955bfa9447ed773ba8d3ed6530b4b981d9aed83ea1022
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID bb496265bc40. Setting up logs at ./log/docker/lightpush_node1_2024-10-07_04-20-06__b26552d7-77ea-4d8e-9943-0db31e0841a3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 48517
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48517/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48517/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.123/tcp/48518/p2p/16Uiu2HAky2dJK5UeZ1tAsX4oTmQXrRbT14qd3rn6VFJxWGpVcD43","/ip4/172.18.38.123/tcp/48519/ws/p2p/16Uiu2HAky2dJK5UeZ1tAsX4oTmQXrRbT14qd3rn6VFJxWGpVcD43"],"enrUri":"enr:-LO4QBUBp6tliK4PIMXGiXSBrqeWbF6JJZHgfDaqnrw0cuFDVv3rszjFO1ApDp9P0dQgbs_rM3Z2iRIDzJ8dbKBF3jsBgmlkgnY0gmlwhKwSJnuKbXVsdGlhZGRyc4wACgSsEiZ7Br2H3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI1h1umn_mcZ4JhzE2D6KLcAajdz25XWf7sLwU_CtHfOIN0Y3CCvYaDdWRwgr2IhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48517/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.146.157/tcp/18260/p2p/16Uiu2HAmKaZGDqThroEbfTc6Vzy7KG2vSDeciGELwiu8ybUdSLXu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48517/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.250.182/tcp/29457/p2p/16Uiu2HAm4b4hS8wpJ99wugSqJUaSrArmo916cY9akMpxyQrajcqo"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18259/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29456/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48517/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728274811995675136, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18259/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728274811995675136,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29456/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728274811995675136,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48517/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1728274812119455232, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18259/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728274812119455232,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29456/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728274812119455232,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id acc665e4ae72
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 6e36ed21276c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id bb496265bc40
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.