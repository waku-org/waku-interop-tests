[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-10-07_04-21-19__18a5b30c-9def-442d-aa75-e454741a01c7
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-07_04-21-19__18a5b30c-9def-442d-aa75-e454741a01c7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.196.163
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['55544', '55545', '55546', '55547', '55548']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 55544:55544 -p 55545:55545 -p 55546:55546 -p 55547:55547 -p 55548:55548 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55546 --rest-port=55544 --tcp-port=55545 --discv5-udp-port=55547 --rest-address=0.0.0.0 --nat=extip:172.18.196.163 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dece57a6f18ec2a470dcdc6b4aecf47bc242b6acd8ff61b2572cb246697adf73 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55548 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.196.163 waku 26d01e409a0846739b80c5a854892861639962d327664ca770a6c4a41b2dad64
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 26d01e409a08. Setting up logs at ./log/docker/receiving_node1_2024-10-07_04-21-19__18a5b30c-9def-442d-aa75-e454741a01c7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 55544
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55544/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55544/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.196.163/tcp/55545/p2p/16Uiu2HAmMhNBeXUEsqHe2CJeTA819GvbBtMBGSNoALvRgH83vvq8","/ip4/172.18.196.163/tcp/55546/ws/p2p/16Uiu2HAmMhNBeXUEsqHe2CJeTA819GvbBtMBGSNoALvRgH83vvq8"],"enrUri":"enr:-LO4QNEtj4Qcrp23_3LC4_ED-bjOWk3LseuroX4qMN09rahffU3JeDVyfiWHYRxMcFYzkGb4ZT70kSaBywL2x58PkrwBgmlkgnY0gmlwhKwSxKOKbXVsdGlhZGRyc4wACgSsEsSjBtj63QOCcnOFAAMBAACJc2VjcDI1NmsxoQOGVQgN_it0RTzk-okkpnYi4bXMXGsGZR2VDBAVeoVqo4N0Y3CC2PmDdWRwgtj7hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-07_04-21-19__18a5b30c-9def-442d-aa75-e454741a01c7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.82.15
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['50371', '50372', '50373', '50374', '50375']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 50371:50371 -p 50372:50372 -p 50373:50373 -p 50374:50374 -p 50375:50375 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50373 --rest-port=50371 --tcp-port=50372 --discv5-udp-port=50374 --rest-address=0.0.0.0 --nat=extip:172.18.82.15 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ebf8ffed9e9ed223018f4bccbcba0b2019f8a2c827b2f089bc5dde3b0dc7f8aa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50375 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.82.15 waku 98da7d056ff797b1bf4dafe6284882746a756832b289f20c147c82174fcbab2d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 98da7d056ff7. Setting up logs at ./log/docker/receiving_node2_2024-10-07_04-21-19__18a5b30c-9def-442d-aa75-e454741a01c7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 50371
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50371/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50371/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.82.15/tcp/50372/p2p/16Uiu2HAkzsTx77VJzTSRbyWq8KHSvy36h7LrRbzB9y951xVTnmov","/ip4/172.18.82.15/tcp/50373/ws/p2p/16Uiu2HAkzsTx77VJzTSRbyWq8KHSvy36h7LrRbzB9y951xVTnmov"],"enrUri":"enr:-LO4QCzPJe4aRu_V68sfrshBDED-kfjqdROtbjL3KkkInBH5JUYfoNcfexH4aqWzpY6WKPvfNUxsnikdcWrmxUNzNsUBgmlkgnY0gmlwhKwSUg-KbXVsdGlhZGRyc4wACgSsElIPBsTF3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJQ5e8wRLWP7BjzRKNZtlOuHWhDzNSbfJYyKWP2JwgiuYN0Y3CCxMSDdWRwgsTGhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50371/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.196.163/tcp/55545/p2p/16Uiu2HAmMhNBeXUEsqHe2CJeTA819GvbBtMBGSNoALvRgH83vvq8"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-07_04-21-19__18a5b30c-9def-442d-aa75-e454741a01c7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.93.165
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['16179', '16180', '16181', '16182', '16183']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 16179:16179 -p 16180:16180 -p 16181:16181 -p 16182:16182 -p 16183:16183 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16181 --rest-port=16179 --tcp-port=16180 --discv5-udp-port=16182 --rest-address=0.0.0.0 --nat=extip:172.18.93.165 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e1c1fd5868d0addbe9805fd867663e8cfdf9ac6f2e5aab452072b4bde13fb01b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16183 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QNEtj4Qcrp23_3LC4_ED-bjOWk3LseuroX4qMN09rahffU3JeDVyfiWHYRxMcFYzkGb4ZT70kSaBywL2x58PkrwBgmlkgnY0gmlwhKwSxKOKbXVsdGlhZGRyc4wACgSsEsSjBtj63QOCcnOFAAMBAACJc2VjcDI1NmsxoQOGVQgN_it0RTzk-okkpnYi4bXMXGsGZR2VDBAVeoVqo4N0Y3CC2PmDdWRwgtj7hXdha3UyCQ --lightpushnode=/ip4/172.18.196.163/tcp/55545/p2p/16Uiu2HAmMhNBeXUEsqHe2CJeTA819GvbBtMBGSNoALvRgH83vvq8 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.93.165 waku 16d647af79f077f4c45174d8ea1aa461589211cd55b5422d86803200551cd58a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 16d647af79f0. Setting up logs at ./log/docker/lightpush_node1_2024-10-07_04-21-19__18a5b30c-9def-442d-aa75-e454741a01c7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 16179
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16179/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16179/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.93.165/tcp/16180/p2p/16Uiu2HAmPT96SK6BzfJjvsmvpdKKBUKQoU16Vr96fNk7LyRANCp2","/ip4/172.18.93.165/tcp/16181/ws/p2p/16Uiu2HAmPT96SK6BzfJjvsmvpdKKBUKQoU16Vr96fNk7LyRANCp2"],"enrUri":"enr:-LO4QG9jsWh_ma4hqT_V74ScyzTxNVJBBVMJjTogiG0IhJolbK6pMwfiF3fwdX8Vgzo2c6bScGr8006BL367x_v9Fp0BgmlkgnY0gmlwhKwSXaWKbXVsdGlhZGRyc4wACgSsEl2lBj813QOCcnOFAAMBAACJc2VjcDI1NmsxoQOgZ3knvlTGi32rHeZpghf0hJlgjx3ka8FFGoTSSMF6i4N0Y3CCPzSDdWRwgj82hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16179/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.196.163/tcp/55545/p2p/16Uiu2HAmMhNBeXUEsqHe2CJeTA819GvbBtMBGSNoALvRgH83vvq8"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16179/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.82.15/tcp/50372/p2p/16Uiu2HAkzsTx77VJzTSRbyWq8KHSvy36h7LrRbzB9y951xVTnmov"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55544/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50371/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16179/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1728274885011523072}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55544/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1728274885011523072,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.196.163/tcp/55545"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.196.163/tcp/55545"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 26d01e409a08
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 98da7d056ff7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 16d647af79f0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.