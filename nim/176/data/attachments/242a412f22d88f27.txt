[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2024-05-05_04-21-22__7864bbe0-b207-4fd7-adaf-4a6954851b7b
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-05_04-21-22__7864bbe0-b207-4fd7-adaf-4a6954851b7b__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.133.94
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['22863', '22864', '22865', '22866', '22867']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 22863:22863 -p 22864:22864 -p 22865:22865 -p 22866:22866 -p 22867:22867 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22865 --rest-port=22863 --tcp-port=22864 --discv5-udp-port=22866 --rest-address=0.0.0.0 --nat=extip:172.18.133.94 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22867 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.133.94 waku 862474c58036a479ee39e78c63ac84c2b0e263d03303ff0b1c614876687aff57
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 862474c58036. Setting up logs at ./log/docker/publishing_node1_2024-05-05_04-21-22__7864bbe0-b207-4fd7-adaf-4a6954851b7b__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 22863
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22863/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.133.94/tcp/22864/p2p/16Uiu2HAmD3VZqxVZ9uEfhT894kQBhbsuyTumXQNfcvE1gJ6YFNrn","/ip4/172.18.133.94/tcp/22865/ws/p2p/16Uiu2HAmD3VZqxVZ9uEfhT894kQBhbsuyTumXQNfcvE1gJ6YFNrn"],"enrUri":"enr:-LO4QHKERy_VgCw9GwxRgvRWmybqowavJlZYLWVC1bEaVDXBFNAzeEMHlXkWTZgqkccKY_4Why2Mtpfyn1btTQvuVaUBgmlkgnY0gmlwhKwShV6KbXVsdGlhZGRyc4wACgSsEoVeBllR3QOCcnOFAAABAACJc2VjcDI1NmsxoQMFw9AeV074W_5QQNrOT-SZnpdP7slhjHFLrJZSmeUwO4N0Y3CCWVCDdWRwgllShXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-05_04-21-22__7864bbe0-b207-4fd7-adaf-4a6954851b7b__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.149.13
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['55898', '55899', '55900', '55901', '55902']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 55898:55898 -p 55899:55899 -p 55900:55900 -p 55901:55901 -p 55902:55902 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55900 --rest-port=55898 --tcp-port=55899 --discv5-udp-port=55901 --rest-address=0.0.0.0 --nat=extip:172.18.149.13 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55902 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QHKERy_VgCw9GwxRgvRWmybqowavJlZYLWVC1bEaVDXBFNAzeEMHlXkWTZgqkccKY_4Why2Mtpfyn1btTQvuVaUBgmlkgnY0gmlwhKwShV6KbXVsdGlhZGRyc4wACgSsEoVeBllR3QOCcnOFAAABAACJc2VjcDI1NmsxoQMFw9AeV074W_5QQNrOT-SZnpdP7slhjHFLrJZSmeUwO4N0Y3CCWVCDdWRwgllShXdha3UyAw --storenode=/ip4/172.18.133.94/tcp/22864/p2p/16Uiu2HAmD3VZqxVZ9uEfhT894kQBhbsuyTumXQNfcvE1gJ6YFNrn --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.149.13 waku 88f8dd657482e9542b96195e3543884adc1b56131e8dc5b3d0206bdfc9fc3fe9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 88f8dd657482. Setting up logs at ./log/docker/store_node1_2024-05-05_04-21-22__7864bbe0-b207-4fd7-adaf-4a6954851b7b__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 55898
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55898/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.149.13/tcp/55899/p2p/16Uiu2HAm9mx8oxb9nC2iLtseFaGCJxzcgh34F8Mqfra1qBR2TQoo","/ip4/172.18.149.13/tcp/55900/ws/p2p/16Uiu2HAm9mx8oxb9nC2iLtseFaGCJxzcgh34F8Mqfra1qBR2TQoo"],"enrUri":"enr:-LO4QG3coqm9ah6o4lt81i2xeT3YMakalLqVKB8ZqRsT2gLDJrqegiI0y5ZHKXdbZlwryJl9gy1RvnbOSovSuewqXHQBgmlkgnY0gmlwhKwSlQ2KbXVsdGlhZGRyc4wACgSsEpUNBtpc3QOCcnOFAAABAACJc2VjcDI1NmsxoQLVNYAMlyyRVWdL2FzAEgnSfmL2DW7FzaSbDN847EkZdoN0Y3CC2luDdWRwgtpdhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55898/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.133.94/tcp/22864/p2p/16Uiu2HAmD3VZqxVZ9uEfhT894kQBhbsuyTumXQNfcvE1gJ6YFNrn"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22863/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55898/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22863/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22863/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714882894872668416,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 862474c58036
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 88f8dd657482
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-05_04-21-22__7864bbe0-b207-4fd7-adaf-4a6954851b7b__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-05_04-21-22__7864bbe0-b207-4fd7-adaf-4a6954851b7b__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2024-05-05_04-21-39__20beeb1f-1021-4dfa-ac17-306ce0baa647
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-05_04-21-39__20beeb1f-1021-4dfa-ac17-306ce0baa647__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.170.62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['44029', '44030', '44031', '44032', '44033']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 44029:44029 -p 44030:44030 -p 44031:44031 -p 44032:44032 -p 44033:44033 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44031 --rest-port=44029 --tcp-port=44030 --discv5-udp-port=44032 --rest-address=0.0.0.0 --nat=extip:172.18.170.62 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44033 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.170.62 waku 4f78dca79350f5764ed2bf65048c17c7e6a7af3abf2d1adc3a169f2835fcf7f7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 4f78dca79350. Setting up logs at ./log/docker/publishing_node1_2024-05-05_04-21-39__20beeb1f-1021-4dfa-ac17-306ce0baa647__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 44029
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44029/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.170.62/tcp/44030/p2p/16Uiu2HAmDFDAQShrFPdWecrCgVmgdN9cGbU6HGtb25YA67yUkMpu","/ip4/172.18.170.62/tcp/44031/ws/p2p/16Uiu2HAmDFDAQShrFPdWecrCgVmgdN9cGbU6HGtb25YA67yUkMpu"],"enrUri":"enr:-LO4QMlskt7ZU-cUQJfna3ZQR4Zu3CJm9MM5F83Mg4f-PHNEPTgKEi-hjNARo-P1U8Dr5pgYBkJydjaJb1IclOj925YBgmlkgnY0gmlwhKwSqj6KbXVsdGlhZGRyc4wACgSsEqo-Bqv_3QOCcnOFAAABAACJc2VjcDI1NmsxoQMIxDwFUS2B_66mnjXE89jJd9ugAV406MM9EY3QO0czEoN0Y3CCq_6DdWRwgqwAhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-05_04-21-39__20beeb1f-1021-4dfa-ac17-306ce0baa647__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.202.220
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['36012', '36013', '36014', '36015', '36016']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 36012:36012 -p 36013:36013 -p 36014:36014 -p 36015:36015 -p 36016:36016 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36014 --rest-port=36012 --tcp-port=36013 --discv5-udp-port=36015 --rest-address=0.0.0.0 --nat=extip:172.18.202.220 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36016 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QMlskt7ZU-cUQJfna3ZQR4Zu3CJm9MM5F83Mg4f-PHNEPTgKEi-hjNARo-P1U8Dr5pgYBkJydjaJb1IclOj925YBgmlkgnY0gmlwhKwSqj6KbXVsdGlhZGRyc4wACgSsEqo-Bqv_3QOCcnOFAAABAACJc2VjcDI1NmsxoQMIxDwFUS2B_66mnjXE89jJd9ugAV406MM9EY3QO0czEoN0Y3CCq_6DdWRwgqwAhXdha3UyAw --storenode=/ip4/172.18.170.62/tcp/44030/p2p/16Uiu2HAmDFDAQShrFPdWecrCgVmgdN9cGbU6HGtb25YA67yUkMpu --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.202.220 waku 200ee1e94045870b28179a7a58f2c0aff96354365823189c33268ff577e77127
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 200ee1e94045. Setting up logs at ./log/docker/store_node1_2024-05-05_04-21-39__20beeb1f-1021-4dfa-ac17-306ce0baa647__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 36012
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36012/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.202.220/tcp/36013/p2p/16Uiu2HAmMwg54GBB97jaatWZ9bhroatJUceRF61DEFHpLTLr7DDz","/ip4/172.18.202.220/tcp/36014/ws/p2p/16Uiu2HAmMwg54GBB97jaatWZ9bhroatJUceRF61DEFHpLTLr7DDz"],"enrUri":"enr:-LO4QNXvdC60k5mz_C9azKGNIbRCZ12f8NNEvIhk2fdHE3udaFWRuwJCtC5gD0eCJY68Q_8fp6R3uCxHNzqmAkYQ7C8BgmlkgnY0gmlwhKwSytyKbXVsdGlhZGRyc4wACgSsEsrcBoyu3QOCcnOFAAABAACJc2VjcDI1NmsxoQOJ_2MQbeLqy_jzWpMf68N1SHie7KNk7bmnpNLZFnlRgYN0Y3CCjK2DdWRwgoyvhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36012/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.170.62/tcp/44030/p2p/16Uiu2HAmDFDAQShrFPdWecrCgVmgdN9cGbU6HGtb25YA67yUkMpu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44029/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36012/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44029/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44029/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714882911294917888,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 4f78dca79350
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 200ee1e94045
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-05_04-21-39__20beeb1f-1021-4dfa-ac17-306ce0baa647__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-05_04-21-39__20beeb1f-1021-4dfa-ac17-306ce0baa647__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2024-05-05_04-21-55__4317338b-0100-4256-ad15-6ab29fe687b9
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-05_04-21-55__4317338b-0100-4256-ad15-6ab29fe687b9__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.212.174
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['44036', '44037', '44038', '44039', '44040']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 44036:44036 -p 44037:44037 -p 44038:44038 -p 44039:44039 -p 44040:44040 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44038 --rest-port=44036 --tcp-port=44037 --discv5-udp-port=44039 --rest-address=0.0.0.0 --nat=extip:172.18.212.174 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44040 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.212.174 waku 626ad1b3f7e40ad7ac26d17f970c59b7cc6516bd2ac8c483968381e4bb7f79a9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 626ad1b3f7e4. Setting up logs at ./log/docker/publishing_node1_2024-05-05_04-21-55__4317338b-0100-4256-ad15-6ab29fe687b9__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 44036
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44036/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.212.174/tcp/44037/p2p/16Uiu2HAkxTGn3yMLm3B1w9vA6zXzvQSzNt2sCLSbyi9t1XuqzDsU","/ip4/172.18.212.174/tcp/44038/ws/p2p/16Uiu2HAkxTGn3yMLm3B1w9vA6zXzvQSzNt2sCLSbyi9t1XuqzDsU"],"enrUri":"enr:-LO4QNsNOapUi2-0VKlK0ioX8mcpF27-vC0VqUQdxVmwhT_feEL7yro676mQC5DKshkmPSKH0syK-sreeaMmIvn_i5EBgmlkgnY0gmlwhKwS1K6KbXVsdGlhZGRyc4wACgSsEtSuBqwG3QOCcnOFAAABAACJc2VjcDI1NmsxoQIs-_zAuLpQpKa41pxPAGl-w9gNugjdE7N8-_8u4dEWB4N0Y3CCrAWDdWRwgqwHhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-05_04-21-55__4317338b-0100-4256-ad15-6ab29fe687b9__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.222.160
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['63844', '63845', '63846', '63847', '63848']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 63844:63844 -p 63845:63845 -p 63846:63846 -p 63847:63847 -p 63848:63848 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63846 --rest-port=63844 --tcp-port=63845 --discv5-udp-port=63847 --rest-address=0.0.0.0 --nat=extip:172.18.222.160 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63848 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QNsNOapUi2-0VKlK0ioX8mcpF27-vC0VqUQdxVmwhT_feEL7yro676mQC5DKshkmPSKH0syK-sreeaMmIvn_i5EBgmlkgnY0gmlwhKwS1K6KbXVsdGlhZGRyc4wACgSsEtSuBqwG3QOCcnOFAAABAACJc2VjcDI1NmsxoQIs-_zAuLpQpKa41pxPAGl-w9gNugjdE7N8-_8u4dEWB4N0Y3CCrAWDdWRwgqwHhXdha3UyAw --storenode=/ip4/172.18.212.174/tcp/44037/p2p/16Uiu2HAkxTGn3yMLm3B1w9vA6zXzvQSzNt2sCLSbyi9t1XuqzDsU --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.222.160 waku ae0a1b3423a13a2156c28fa58b39c34c82a3b5ba217149a4799c679f64e36055
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID ae0a1b3423a1. Setting up logs at ./log/docker/store_node1_2024-05-05_04-21-55__4317338b-0100-4256-ad15-6ab29fe687b9__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 63844
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63844/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.222.160/tcp/63845/p2p/16Uiu2HAm63u5ZFUQovpFCcLoezZXQr1MmpKGSMzc3F6Z9Bc7WBdf","/ip4/172.18.222.160/tcp/63846/ws/p2p/16Uiu2HAm63u5ZFUQovpFCcLoezZXQr1MmpKGSMzc3F6Z9Bc7WBdf"],"enrUri":"enr:-LO4QLWHpQXQAThZlB3pOGS0cqi8LHMuKYfXTrLi9hTOYIMKHUfPd4VPWm_oKllIhPxeC50hD4rvh43j7ZxpP_7RGs0BgmlkgnY0gmlwhKwS3qCKbXVsdGlhZGRyc4wACgSsEt6gBvlm3QOCcnOFAAABAACJc2VjcDI1NmsxoQKd3JcDMaflZeLUPifaZD4O2i8Vh6nQrXWS3JWGgqAx_oN0Y3CC-WWDdWRwgvlnhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63844/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.212.174/tcp/44037/p2p/16Uiu2HAkxTGn3yMLm3B1w9vA6zXzvQSzNt2sCLSbyi9t1XuqzDsU"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44036/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63844/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44036/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44036/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714882927770636032,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 626ad1b3f7e4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id ae0a1b3423a1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-05_04-21-55__4317338b-0100-4256-ad15-6ab29fe687b9__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-05_04-21-55__4317338b-0100-4256-ad15-6ab29fe687b9__harbor.status.im_wakuorg_nwaku:latest.log