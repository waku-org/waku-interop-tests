2025-02-09 04:05:12.972 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:05:12.973 DEBUG [tests.conftest] Running test: test_single_content_topic[/waku/2/content/test.js] with id: 2025-02-09_04-05-12__78d2ea4f-5238-4299-819a-a873802e8212
2025-02-09 04:05:12.973 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:05:12.973 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:05:12.973 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-09 04:05:12.980 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:05:12.980 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_04-05-12__78d2ea4f-5238-4299-819a-a873802e8212__wakuorg_nwaku:latest.log
2025-02-09 04:05:12.981 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:05:12.981 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:05:12.982 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:05:12.982 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.21.229
2025-02-09 04:05:12.982 DEBUG [src.node.docker_mananger] Generated ports ['19104', '19105', '19106', '19107', '19108']
2025-02-09 04:05:12.983 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:05:12.983 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:05:12.983 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:05:12.983 DEBUG [src.node.docker_mananger] docker run -i -t -p 19104:19104 -p 19105:19105 -p 19106:19106 -p 19107:19107 -p 19108:19108 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19106 --rest-port=19104 --tcp-port=19105 --discv5-udp-port=19107 --rest-address=0.0.0.0 --nat=extip:172.18.21.229 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=6aa31ba57df481bebfae04d9dbad253891bbd2f15fe33df02dd18a40c5ac6292 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19108 --metrics-logging=true --relay=true --filter=true --content-topic=/waku/2/content/test.js
2025-02-09 04:05:13.214 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.21.229 waku 64946b8dc816312c6d9ff0d94c2845af9ca462679f0fb3da82926f19c8cfd239
2025-02-09 04:05:13.267 DEBUG [src.node.docker_mananger] Container started with ID 64946b8dc816. Setting up logs at ./log/docker/node1_2025-02-09_04-05-12__78d2ea4f-5238-4299-819a-a873802e8212__wakuorg_nwaku:latest.log
2025-02-09 04:05:13.267 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19104
2025-02-09 04:05:13.268 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:05:13.769 ERROR [src.node.docker_mananger] Max retries reached for container f89971b3e5d6. Exiting log stream.
2025-02-09 04:05:14.269 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19104/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:14.272 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:05:14.272 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:05:14.273 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19104/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:14.275 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.21.229/tcp/19105/p2p/16Uiu2HAkvyB3RsDHdKbuisiGA6iTtAH1bY1JsJzhtJAKxj4nFGVq","/ip4/172.18.21.229/tcp/19106/ws/p2p/16Uiu2HAkvyB3RsDHdKbuisiGA6iTtAH1bY1JsJzhtJAKxj4nFGVq"],"enrUri":"enr:-L24QKCSHDOc3twYzWSDCkzOdFSyeOvqQAFyuVhYseS2PMXkQykYKZF2gmwv1Nwg-GhpGugcBDkr22-sVLqkbWRZRXMCgmlkgnY0gmlwhKwSFeWKbXVsdGlhZGRyc5YACASsEhXlBkqhAAoErBIV5QZKot0DgnJzhQACAQAAiXNlY3AyNTZrMaECFu2NpM6Ari3vNkc3z90kq2MN-xrn5ZXT6p8_Q1LDRoSDdGNwgkqhg3VkcIJKo4V3YWt1MgU"}'
2025-02-09 04:05:14.275 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:05:14.282 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:05:14.282 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_04-05-12__78d2ea4f-5238-4299-819a-a873802e8212__wakuorg_nwaku:latest.log
2025-02-09 04:05:14.282 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:05:14.282 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:05:14.283 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:05:14.284 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.211.232
2025-02-09 04:05:14.284 DEBUG [src.node.docker_mananger] Generated ports ['33852', '33853', '33854', '33855', '33856']
2025-02-09 04:05:14.284 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:05:14.284 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:05:14.284 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:05:14.284 DEBUG [src.node.docker_mananger] docker run -i -t -p 33852:33852 -p 33853:33853 -p 33854:33854 -p 33855:33855 -p 33856:33856 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33854 --rest-port=33852 --tcp-port=33853 --discv5-udp-port=33855 --rest-address=0.0.0.0 --nat=extip:172.18.211.232 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=14f345d9fa1ea71ce834ea6b1790f67b55ddac8d51ddeb909bdb7ed2d8a19cdb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33856 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QKCSHDOc3twYzWSDCkzOdFSyeOvqQAFyuVhYseS2PMXkQykYKZF2gmwv1Nwg-GhpGugcBDkr22-sVLqkbWRZRXMCgmlkgnY0gmlwhKwSFeWKbXVsdGlhZGRyc5YACASsEhXlBkqhAAoErBIV5QZKot0DgnJzhQACAQAAiXNlY3AyNTZrMaECFu2NpM6Ari3vNkc3z90kq2MN-xrn5ZXT6p8_Q1LDRoSDdGNwgkqhg3VkcIJKo4V3YWt1MgU --content-topic=/waku/2/content/test.js
2025-02-09 04:05:14.511 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.211.232 waku d7693b92dcbb3dcad9d3f6a37f05650d5e85cef9780e055ccfc3bb58c3f5d2e0
2025-02-09 04:05:14.564 DEBUG [src.node.docker_mananger] Container started with ID d7693b92dcbb. Setting up logs at ./log/docker/node2_2025-02-09_04-05-12__78d2ea4f-5238-4299-819a-a873802e8212__wakuorg_nwaku:latest.log
2025-02-09 04:05:14.565 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33852
2025-02-09 04:05:14.565 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:05:15.565 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33852/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:15.570 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:05:15.571 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:05:15.571 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33852/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:15.580 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.211.232/tcp/33853/p2p/16Uiu2HAmMFvaRJRM4F1zyCZ4usXYiRdsZpHAUcXUR4o5VxoWLF7V","/ip4/172.18.211.232/tcp/33854/ws/p2p/16Uiu2HAmMFvaRJRM4F1zyCZ4usXYiRdsZpHAUcXUR4o5VxoWLF7V"],"enrUri":"enr:-L24QL8yRlDkr1aJIrVVfAfwIaP9TfK8vYVi0aneukpcLcR0NZulg5kIcQDf1WZgaBa1WheTulS_K9oXo1hnxza7Vb0CgmlkgnY0gmlwhKwS0-iKbXVsdGlhZGRyc5YACASsEtPoBoQ9AAoErBLT6AaEPt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDf9COj7OKRVuFMI90GFN3YuMBV0vxEQcyIusdoa8vMbiDdGNwgoQ9g3VkcIKEP4V3YWt1MgE"}'
2025-02-09 04:05:15.581 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:05:15.581 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33852/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.21.229/tcp/19105/p2p/16Uiu2HAkvyB3RsDHdKbuisiGA6iTtAH1bY1JsJzhtJAKxj4nFGVq"]'
2025-02-09 04:05:15.584 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:15.585 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19104/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/content/test.js"]'
2025-02-09 04:05:15.588 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:15.588 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33852/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/content/test.js"]'
2025-02-09 04:05:15.590 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:15.591 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19104/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/waku/2/content/test.js", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:05:15.596 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:15.596 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:05:15.697 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:05:15.697 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19104/relay/v1/auto/messages/%2Fwaku%2F2%2Fcontent%2Ftest.js" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:15.700 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/waku/2/content/test.js","version":0,"timestamp":1739073915591195904,"ephemeral":false}]'
2025-02-09 04:05:15.702 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:05:15.702 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33852/relay/v1/auto/messages/%2Fwaku%2F2%2Fcontent%2Ftest.js" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:15.704 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/waku/2/content/test.js","version":0,"timestamp":1739073915591195904,"ephemeral":false}]'
2025-02-09 04:05:15.707 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:05:15.708 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:05:15.708 DEBUG [src.node.waku_node] Stopping container with id 64946b8dc816
2025-02-09 04:05:16.758 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:05:16.758 DEBUG [src.node.waku_node] Stopping container with id d7693b92dcbb
2025-02-09 04:05:17.570 ERROR [src.node.docker_mananger] Max retries reached for container 64946b8dc816. Exiting log stream.
2025-02-09 04:05:18.249 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:05:18.250 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:05:18.255 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:05:18.260 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
