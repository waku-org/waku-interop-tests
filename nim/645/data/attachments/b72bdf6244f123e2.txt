2025-02-09 04:06:11.832 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:06:11.833 DEBUG [tests.conftest] Running test: test_publish_with_missing_content_topic with id: 2025-02-09_04-06-11__1878581e-3c37-4f31-81e1-9fc83fab81f7
2025-02-09 04:06:11.833 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:06:11.833 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:06:11.834 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-09 04:06:11.840 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:06:11.840 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_04-06-11__1878581e-3c37-4f31-81e1-9fc83fab81f7__wakuorg_nwaku:latest.log
2025-02-09 04:06:11.840 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:06:11.840 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:06:11.842 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:06:11.842 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.80.213
2025-02-09 04:06:11.842 DEBUG [src.node.docker_mananger] Generated ports ['24326', '24327', '24328', '24329', '24330']
2025-02-09 04:06:11.842 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:06:11.842 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:06:11.842 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:06:11.843 DEBUG [src.node.docker_mananger] docker run -i -t -p 24326:24326 -p 24327:24327 -p 24328:24328 -p 24329:24329 -p 24330:24330 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24328 --rest-port=24326 --tcp-port=24327 --discv5-udp-port=24329 --rest-address=0.0.0.0 --nat=extip:172.18.80.213 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=64fd2ddb0a2d1fe8fcdc458eac74089db80a48099dd90bfe4497fef7c949b17d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24330 --metrics-logging=true --relay=true
2025-02-09 04:06:12.077 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.80.213 waku ac92a034fb52282c43e3e3c3d444067712db31c5a2189534f667d198d194eb32
2025-02-09 04:06:12.129 DEBUG [src.node.docker_mananger] Container started with ID ac92a034fb52. Setting up logs at ./log/docker/node1_2025-02-09_04-06-11__1878581e-3c37-4f31-81e1-9fc83fab81f7__wakuorg_nwaku:latest.log
2025-02-09 04:06:12.129 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24326
2025-02-09 04:06:12.130 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:06:12.546 ERROR [src.node.docker_mananger] Max retries reached for container a4dfd1b19784. Exiting log stream.
2025-02-09 04:06:13.131 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24326/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:13.133 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:06:13.134 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:06:13.134 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24326/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:13.136 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.80.213/tcp/24327/p2p/16Uiu2HAmTUXQTt19J5qoPM6vFr8VxkDc8BK8SfVD2JiuoswTrvbZ","/ip4/172.18.80.213/tcp/24328/ws/p2p/16Uiu2HAmTUXQTt19J5qoPM6vFr8VxkDc8BK8SfVD2JiuoswTrvbZ"],"enrUri":"enr:-L24QHq8vxs3ZixnxUJCL6kD3afJ4HaTs3CJqOJB6AWUzWw0IXfW60L8TC_nPEbWrSl-Ku_MakEapfrl-gU1nDLWcTECgmlkgnY0gmlwhKwSUNWKbXVsdGlhZGRyc5YACASsElDVBl8HAAoErBJQ1QZfCN0DgnJzhQADAQAAiXNlY3AyNTZrMaED3DEHWFDpHhwrLi4nPb-ww7nLrm5s7tZFwwTpO5AcKtCDdGNwgl8Hg3VkcIJfCYV3YWt1MgE"}'
2025-02-09 04:06:13.136 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:06:13.143 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:06:13.143 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_04-06-11__1878581e-3c37-4f31-81e1-9fc83fab81f7__wakuorg_nwaku:latest.log
2025-02-09 04:06:13.143 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:06:13.143 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:06:13.144 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:06:13.144 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.229.98
2025-02-09 04:06:13.145 DEBUG [src.node.docker_mananger] Generated ports ['20198', '20199', '20200', '20201', '20202']
2025-02-09 04:06:13.145 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:06:13.145 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:06:13.145 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:06:13.145 DEBUG [src.node.docker_mananger] docker run -i -t -p 20198:20198 -p 20199:20199 -p 20200:20200 -p 20201:20201 -p 20202:20202 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20200 --rest-port=20198 --tcp-port=20199 --discv5-udp-port=20201 --rest-address=0.0.0.0 --nat=extip:172.18.229.98 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=384cbdfdc6dbdac6e682eac53eccee2aace6dd7f604ded4acbffd6c10b6d2f66 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20202 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QHq8vxs3ZixnxUJCL6kD3afJ4HaTs3CJqOJB6AWUzWw0IXfW60L8TC_nPEbWrSl-Ku_MakEapfrl-gU1nDLWcTECgmlkgnY0gmlwhKwSUNWKbXVsdGlhZGRyc5YACASsElDVBl8HAAoErBJQ1QZfCN0DgnJzhQADAQAAiXNlY3AyNTZrMaED3DEHWFDpHhwrLi4nPb-ww7nLrm5s7tZFwwTpO5AcKtCDdGNwgl8Hg3VkcIJfCYV3YWt1MgE
2025-02-09 04:06:13.375 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.229.98 waku 9acad782ba981958ac08806edeb82af791774ec1ee81a6affd8d635d89faff89
2025-02-09 04:06:13.423 DEBUG [src.node.docker_mananger] Container started with ID 9acad782ba98. Setting up logs at ./log/docker/node2_2025-02-09_04-06-11__1878581e-3c37-4f31-81e1-9fc83fab81f7__wakuorg_nwaku:latest.log
2025-02-09 04:06:13.423 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20198
2025-02-09 04:06:13.423 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:06:14.425 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20198/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:14.435 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:06:14.436 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:06:14.436 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20198/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:14.439 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.229.98/tcp/20199/p2p/16Uiu2HAmQpda8Y3GotXzRe2zaXdmsy8AeLmtSy1GikHoaMsbBmSr","/ip4/172.18.229.98/tcp/20200/ws/p2p/16Uiu2HAmQpda8Y3GotXzRe2zaXdmsy8AeLmtSy1GikHoaMsbBmSr"],"enrUri":"enr:-L24QBrCeESgkcuD9TmA20PZd6Qoe1Wwi7F_7KxQ16kFBZqYOiKHBtuDpRQbmh3YghkiX2IcN3M-5H5fYG-TD4AVYfYCgmlkgnY0gmlwhKwS5WKKbXVsdGlhZGRyc5YACASsEuViBk7nAAoErBLlYgZO6N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDtMSOh_qDwyk-P2-BAbmeYnUMCQjSDgh_PpYQyNSwbHuDdGNwgk7ng3VkcIJO6YV3YWt1MgE"}'
2025-02-09 04:06:14.440 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:06:14.441 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20198/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.80.213/tcp/24327/p2p/16Uiu2HAmTUXQTt19J5qoPM6vFr8VxkDc8BK8SfVD2JiuoswTrvbZ"]'
2025-02-09 04:06:14.443 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:14.444 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-09 04:06:14.444 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24326/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:06:14.448 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:14.449 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20198/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:06:14.453 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:14.455 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24326/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:06:14.461 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:14.461 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:06:14.562 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:06:14.562 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24326/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:14.565 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073974454995712,"ephemeral":false}]'
2025-02-09 04:06:14.566 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:06:14.566 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20198/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:14.569 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073974454995712,"ephemeral":false}]'
2025-02-09 04:06:14.570 INFO [src.steps.relay] WARM UP successful!!
2025-02-09 04:06:14.571 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24326/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:06:14.574 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24326/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:06:14.576 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:06:14.576 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:06:14.577 DEBUG [src.node.waku_node] Stopping container with id ac92a034fb52
2025-02-09 04:06:15.594 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:06:15.594 DEBUG [src.node.waku_node] Stopping container with id 9acad782ba98
2025-02-09 04:06:16.406 ERROR [src.node.docker_mananger] Max retries reached for container ac92a034fb52. Exiting log stream.
2025-02-09 04:06:17.078 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:06:17.079 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:06:17.084 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:06:17.090 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
