2025-02-09 04:03:58.744 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:03:58.744 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-09_04-03-58__7106ffc6-3001-4e04-baad-200a710ec52a
2025-02-09 04:03:58.744 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:03:58.745 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:03:58.745 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-09 04:03:58.752 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:03:58.752 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_04-03-58__7106ffc6-3001-4e04-baad-200a710ec52a__wakuorg_nwaku:latest.log
2025-02-09 04:03:58.752 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:03:58.752 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:03:58.754 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:03:58.754 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.253.101
2025-02-09 04:03:58.754 DEBUG [src.node.docker_mananger] Generated ports ['30780', '30781', '30782', '30783', '30784']
2025-02-09 04:03:58.754 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:03:58.754 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:03:58.755 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:03:58.755 DEBUG [src.node.docker_mananger] docker run -i -t -p 30780:30780 -p 30781:30781 -p 30782:30782 -p 30783:30783 -p 30784:30784 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30782 --rest-port=30780 --tcp-port=30781 --discv5-udp-port=30783 --rest-address=0.0.0.0 --nat=extip:172.18.253.101 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ebfbedf81b8dae173cee84bfeb2c580ecaa69cf9a72024692ee3c015cce30fd6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30784 --metrics-logging=true --relay=true
2025-02-09 04:03:58.989 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.253.101 waku 1b60d57df41da6c5531e1807124b5ceac7e3032108cd112abc971e7666f74be1
2025-02-09 04:03:59.038 DEBUG [src.node.docker_mananger] Container started with ID 1b60d57df41d. Setting up logs at ./log/docker/node1_2025-02-09_04-03-58__7106ffc6-3001-4e04-baad-200a710ec52a__wakuorg_nwaku:latest.log
2025-02-09 04:03:59.038 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30780
2025-02-09 04:03:59.038 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:03:59.532 ERROR [src.node.docker_mananger] Max retries reached for container 8c890813bd1e. Exiting log stream.
2025-02-09 04:04:00.039 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30780/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:04:00.042 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:04:00.042 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:04:00.042 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30780/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:04:00.045 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.253.101/tcp/30781/p2p/16Uiu2HAm74v5q74x2kuc8vRC3o5MNp9qnZwEiR6QEd5XFTDqfsip","/ip4/172.18.253.101/tcp/30782/ws/p2p/16Uiu2HAm74v5q74x2kuc8vRC3o5MNp9qnZwEiR6QEd5XFTDqfsip"],"enrUri":"enr:-L24QOO0QElO1dC8J7RKQ9MBDeBuiGUWq5qlGgudUWioUtG4eI9fbzF23gjZyc812FMMLtdBA3NVvRqEqCGyHHsug8ACgmlkgnY0gmlwhKwS_WWKbXVsdGlhZGRyc5YACASsEv1lBng9AAoErBL9ZQZ4Pt0DgnJzhQADAQAAiXNlY3AyNTZrMaECrPr-YIxrjHbcd4xpB16wowFDtouGDO8Xn5Ea92uw1nGDdGNwgng9g3VkcIJ4P4V3YWt1MgE"}'
2025-02-09 04:04:00.045 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:04:00.051 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:04:00.051 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_04-03-58__7106ffc6-3001-4e04-baad-200a710ec52a__wakuorg_nwaku:latest.log
2025-02-09 04:04:00.052 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:04:00.052 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:04:00.053 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:04:00.053 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.89.245
2025-02-09 04:04:00.053 DEBUG [src.node.docker_mananger] Generated ports ['17802', '17803', '17804', '17805', '17806']
2025-02-09 04:04:00.053 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:04:00.054 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:04:00.054 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:04:00.054 DEBUG [src.node.docker_mananger] docker run -i -t -p 17802:17802 -p 17803:17803 -p 17804:17804 -p 17805:17805 -p 17806:17806 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17804 --rest-port=17802 --tcp-port=17803 --discv5-udp-port=17805 --rest-address=0.0.0.0 --nat=extip:172.18.89.245 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2c68494eaa7ed97bbed7fcc4fef7fbadbb02658a8bfccf453dd8f65ea3ce1aae --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17806 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOO0QElO1dC8J7RKQ9MBDeBuiGUWq5qlGgudUWioUtG4eI9fbzF23gjZyc812FMMLtdBA3NVvRqEqCGyHHsug8ACgmlkgnY0gmlwhKwS_WWKbXVsdGlhZGRyc5YACASsEv1lBng9AAoErBL9ZQZ4Pt0DgnJzhQADAQAAiXNlY3AyNTZrMaECrPr-YIxrjHbcd4xpB16wowFDtouGDO8Xn5Ea92uw1nGDdGNwgng9g3VkcIJ4P4V3YWt1MgE
2025-02-09 04:04:00.300 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.89.245 waku 5d5c06734f9151c4bd3f9778865373d919e78adefcef240295c8d7eee655c71f
2025-02-09 04:04:00.348 DEBUG [src.node.docker_mananger] Container started with ID 5d5c06734f91. Setting up logs at ./log/docker/node2_2025-02-09_04-03-58__7106ffc6-3001-4e04-baad-200a710ec52a__wakuorg_nwaku:latest.log
2025-02-09 04:04:00.349 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17802
2025-02-09 04:04:00.349 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:04:01.351 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17802/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:04:01.361 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:04:01.361 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:04:01.362 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17802/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:04:01.367 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.89.245/tcp/17803/p2p/16Uiu2HAm1UyUsMnMVkzH3LBHibotzX4TFBzuGs6xVufJBeiVHGzQ","/ip4/172.18.89.245/tcp/17804/ws/p2p/16Uiu2HAm1UyUsMnMVkzH3LBHibotzX4TFBzuGs6xVufJBeiVHGzQ"],"enrUri":"enr:-L24QNGDzYyNBh-y9LggZsxuLRcRkJ08WYwgX7qynBcYFlpMZJC_wZPzQTDGITIESOFi3c9bnaErysrOMoiWA1xcLZoCgmlkgnY0gmlwhKwSWfWKbXVsdGlhZGRyc5YACASsEln1BkWLAAoErBJZ9QZFjN0DgnJzhQADAQAAiXNlY3AyNTZrMaECWf6nHAMrg9Ba0TETLHyyiGwUC3DDxQ3ZjkCnRsuCNj2DdGNwgkWLg3VkcIJFjYV3YWt1MgE"}'
2025-02-09 04:04:01.367 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:04:01.369 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17802/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.253.101/tcp/30781/p2p/16Uiu2HAm74v5q74x2kuc8vRC3o5MNp9qnZwEiR6QEd5XFTDqfsip"]'
2025-02-09 04:04:01.374 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:04:01.374 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-09 04:04:01.375 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30780/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:04:01.379 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:04:01.379 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17802/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:04:01.384 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:04:01.385 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:04:01.391 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:04:01.391 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:04:01.492 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:04:01.492 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:04:01.495 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073841385285120,"ephemeral":false}]'
2025-02-09 04:04:01.496 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:04:01.497 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17802/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:04:01.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073841385285120,"ephemeral":false}]'
2025-02-09 04:04:01.501 INFO [src.steps.relay] WARM UP successful!!
2025-02-09 04:04:01.501 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-09 04:04:01.502 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:04:01.504 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:04:01.504 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-09 04:04:01.505 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-09 04:04:01.507 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:04:01.507 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-09 04:04:01.507 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-09 04:04:01.509 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:04:01.510 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-09 04:04:01.510 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-09 04:04:01.512 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:04:01.512 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-09 04:04:01.513 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-09 04:04:01.515 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:30780/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:04:01.517 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:04:01.518 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:04:01.518 DEBUG [src.node.waku_node] Stopping container with id 1b60d57df41d
2025-02-09 04:04:02.335 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:04:02.336 DEBUG [src.node.waku_node] Stopping container with id 5d5c06734f91
2025-02-09 04:04:03.149 ERROR [src.node.docker_mananger] Max retries reached for container 1b60d57df41d. Exiting log stream.
2025-02-09 04:04:03.857 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:04:03.858 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:04:03.863 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:04:03.868 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
