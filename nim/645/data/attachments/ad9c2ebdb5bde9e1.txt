2025-02-09 04:07:15.696 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:07:15.696 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-09_04-07-15__0cb40ac7-ba02-49fe-a7dd-8ef48b0baed5
2025-02-09 04:07:15.697 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:07:15.697 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:07:15.697 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-09 04:07:15.704 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:07:15.704 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_04-07-15__0cb40ac7-ba02-49fe-a7dd-8ef48b0baed5__wakuorg_nwaku:latest.log
2025-02-09 04:07:15.704 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:07:15.704 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:07:15.706 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:07:15.706 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.240.93
2025-02-09 04:07:15.706 DEBUG [src.node.docker_mananger] Generated ports ['25966', '25967', '25968', '25969', '25970']
2025-02-09 04:07:15.706 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:07:15.706 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:07:15.706 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:07:15.706 DEBUG [src.node.docker_mananger] docker run -i -t -p 25966:25966 -p 25967:25967 -p 25968:25968 -p 25969:25969 -p 25970:25970 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25968 --rest-port=25966 --tcp-port=25967 --discv5-udp-port=25969 --rest-address=0.0.0.0 --nat=extip:172.18.240.93 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1deea282dfcdfff8d79aac10be1cdea34fee9f727bcb6c6cdf95edf9aa1aa6bb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25970 --metrics-logging=true --relay=true
2025-02-09 04:07:15.942 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.240.93 waku 71cad2f006db937f9c55206573f3fed22bedbeee7de4b6896825bd20a5703c6e
2025-02-09 04:07:15.989 DEBUG [src.node.docker_mananger] Container started with ID 71cad2f006db. Setting up logs at ./log/docker/node1_2025-02-09_04-07-15__0cb40ac7-ba02-49fe-a7dd-8ef48b0baed5__wakuorg_nwaku:latest.log
2025-02-09 04:07:15.990 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25966
2025-02-09 04:07:15.990 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:07:16.478 ERROR [src.node.docker_mananger] Max retries reached for container fa1eb1e177ff. Exiting log stream.
2025-02-09 04:07:16.991 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25966/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:07:16.994 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:07:16.994 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:07:16.994 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25966/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:07:16.996 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.240.93/tcp/25967/p2p/16Uiu2HAkvxtUXKvAULkTKa1ctn7VDKppJFhHmB9HNmUDVYo96QCL","/ip4/172.18.240.93/tcp/25968/ws/p2p/16Uiu2HAkvxtUXKvAULkTKa1ctn7VDKppJFhHmB9HNmUDVYo96QCL"],"enrUri":"enr:-L24QOjueqtB_8DoaDBlFUubXGTdz-3ru37bqif1A7tqqVHEI9LK3pKBd-Xf7xTTcoX5V7IvQdmH7smSTuaHQ9Xc-Z0CgmlkgnY0gmlwhKwS8F2KbXVsdGlhZGRyc5YACASsEvBdBmVvAAoErBLwXQZlcN0DgnJzhQADAQAAiXNlY3AyNTZrMaECFtrSDw-nUCq-TKL-KA0RbJ7Butwe8bqQJ--yY6vfyJWDdGNwgmVvg3VkcIJlcYV3YWt1MgE"}'
2025-02-09 04:07:16.997 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:07:17.003 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:07:17.003 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_04-07-15__0cb40ac7-ba02-49fe-a7dd-8ef48b0baed5__wakuorg_nwaku:latest.log
2025-02-09 04:07:17.004 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:07:17.004 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:07:17.005 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:07:17.005 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.107.79
2025-02-09 04:07:17.005 DEBUG [src.node.docker_mananger] Generated ports ['31086', '31087', '31088', '31089', '31090']
2025-02-09 04:07:17.006 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:07:17.006 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:07:17.006 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:07:17.006 DEBUG [src.node.docker_mananger] docker run -i -t -p 31086:31086 -p 31087:31087 -p 31088:31088 -p 31089:31089 -p 31090:31090 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31088 --rest-port=31086 --tcp-port=31087 --discv5-udp-port=31089 --rest-address=0.0.0.0 --nat=extip:172.18.107.79 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=edba6fce2db4e1ae332c3dc3bf436e10f27ccd85259d2a4b10ed8a2db5e247ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31090 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOjueqtB_8DoaDBlFUubXGTdz-3ru37bqif1A7tqqVHEI9LK3pKBd-Xf7xTTcoX5V7IvQdmH7smSTuaHQ9Xc-Z0CgmlkgnY0gmlwhKwS8F2KbXVsdGlhZGRyc5YACASsEvBdBmVvAAoErBLwXQZlcN0DgnJzhQADAQAAiXNlY3AyNTZrMaECFtrSDw-nUCq-TKL-KA0RbJ7Butwe8bqQJ--yY6vfyJWDdGNwgmVvg3VkcIJlcYV3YWt1MgE
2025-02-09 04:07:17.242 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.107.79 waku 60096ad2c122caf30bea3bd89fa7de8dda94c5bf94747bf8ebb503c03e1cb6e3
2025-02-09 04:07:17.291 DEBUG [src.node.docker_mananger] Container started with ID 60096ad2c122. Setting up logs at ./log/docker/node2_2025-02-09_04-07-15__0cb40ac7-ba02-49fe-a7dd-8ef48b0baed5__wakuorg_nwaku:latest.log
2025-02-09 04:07:17.291 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31086
2025-02-09 04:07:17.291 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:07:18.292 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31086/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:07:18.301 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:07:18.301 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:07:18.302 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31086/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:07:18.305 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.107.79/tcp/31087/p2p/16Uiu2HAmMc6u6XcPoAw3pMUGA5pGk4q2D5KEW972HRafZpQkvxQE","/ip4/172.18.107.79/tcp/31088/ws/p2p/16Uiu2HAmMc6u6XcPoAw3pMUGA5pGk4q2D5KEW972HRafZpQkvxQE"],"enrUri":"enr:-L24QEc7ZJepBwsWv9uFV53EJM5uCb4Hh7UOi2cUOs7Y7psneew5Mt5Fzaf9Qkc09otju5ZAwZKRLOvnwTpT-ayUXvkCgmlkgnY0gmlwhKwSa0-KbXVsdGlhZGRyc5YACASsEmtPBnlvAAoErBJrTwZ5cN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDhPvYHOQoG2seFsPm73afyPbjbpEJ9h4weoNhIW9zqxeDdGNwgnlvg3VkcIJ5cYV3YWt1MgE"}'
2025-02-09 04:07:18.306 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:07:18.306 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31086/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.240.93/tcp/25967/p2p/16Uiu2HAkvxtUXKvAULkTKa1ctn7VDKppJFhHmB9HNmUDVYo96QCL"]'
2025-02-09 04:07:18.308 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:07:18.309 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-09 04:07:18.309 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:07:18.313 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:07:18.314 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31086/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:07:18.320 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:07:18.322 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.327 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:07:18.328 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:07:18.428 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:07:18.428 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:07:18.431 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739074038322322688,"ephemeral":false}]'
2025-02-09 04:07:18.433 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:07:18.433 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31086/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:07:18.435 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739074038322322688,"ephemeral":false}]'
2025-02-09 04:07:18.437 INFO [src.steps.relay] WARM UP successful!!
2025-02-09 04:07:18.438 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-09 04:07:18.438 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.440 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:07:18.441 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-09 04:07:18.442 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.444 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:07:18.445 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-09 04:07:18.445 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.447 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:07:18.448 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-09 04:07:18.448 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.450 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:07:18.451 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-09 04:07:18.452 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.454 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:07:18.455 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-09 04:07:18.455 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.457 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:07:18.458 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-09 04:07:18.458 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:07:18.460 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:25966/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 04:07:18.463 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:07:18.464 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:07:18.464 DEBUG [src.node.waku_node] Stopping container with id 71cad2f006db
2025-02-09 04:07:19.503 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:07:19.503 DEBUG [src.node.waku_node] Stopping container with id 60096ad2c122
2025-02-09 04:07:20.316 ERROR [src.node.docker_mananger] Max retries reached for container 71cad2f006db. Exiting log stream.
2025-02-09 04:07:20.714 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:07:20.715 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:07:20.720 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:07:20.725 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
