2025-02-09 04:06:49.424 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:06:49.425 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-09_04-06-49__46baa37e-e0d7-4d49-b072-ebc24a4622f6
2025-02-09 04:06:49.425 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:06:49.425 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-09 04:06:49.425 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-09 04:06:49.426 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:06:49.426 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-09 04:06:49.433 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:06:49.433 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-09_04-06-49__46baa37e-e0d7-4d49-b072-ebc24a4622f6__wakuorg_nwaku:latest.log
2025-02-09 04:06:49.434 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:06:49.434 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:06:49.435 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:06:49.435 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.4.140
2025-02-09 04:06:49.435 DEBUG [src.node.docker_mananger] Generated ports ['56144', '56145', '56146', '56147', '56148']
2025-02-09 04:06:49.436 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:06:49.436 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:06:49.436 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:06:49.436 DEBUG [src.node.docker_mananger] docker run -i -t -p 56144:56144 -p 56145:56145 -p 56146:56146 -p 56147:56147 -p 56148:56148 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56146 --rest-port=56144 --tcp-port=56145 --discv5-udp-port=56147 --rest-address=0.0.0.0 --nat=extip:172.18.4.140 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f17e16b5db5a0a0be8e4ee2dcda8bcad11abfb9f5f31d157a0c4d7299adcba94 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56148 --metrics-logging=true --lightpush=true --relay=true
2025-02-09 04:06:49.673 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.4.140 waku 39c8ca1ebf7da195e721de86db72b4f19ab82059015b0df9d5dd0a926eeae0e2
2025-02-09 04:06:49.727 DEBUG [src.node.docker_mananger] Container started with ID 39c8ca1ebf7d. Setting up logs at ./log/docker/receiving_node1_2025-02-09_04-06-49__46baa37e-e0d7-4d49-b072-ebc24a4622f6__wakuorg_nwaku:latest.log
2025-02-09 04:06:49.728 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 56144
2025-02-09 04:06:49.728 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:06:50.209 ERROR [src.node.docker_mananger] Max retries reached for container 420179b39a17. Exiting log stream.
2025-02-09 04:06:50.728 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56144/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:50.732 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:06:50.732 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:06:50.732 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56144/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:50.735 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.4.140/tcp/56145/p2p/16Uiu2HAmPe5rUBqaU857ydKK8kwQu4kpjE2VNYBk3UkRAcvf8nbP","/ip4/172.18.4.140/tcp/56146/ws/p2p/16Uiu2HAmPe5rUBqaU857ydKK8kwQu4kpjE2VNYBk3UkRAcvf8nbP"],"enrUri":"enr:-L24QK1o8UFKLiJlnH3s2-uUJoV6usOe4RWYIso6oq5RJnPsF5diTjcr3qYQNzvpgYRPCtTNev7l3y5eczIFiGvXGC8CgmlkgnY0gmlwhKwSBIyKbXVsdGlhZGRyc5YACASsEgSMBttRAAoErBIEjAbbUt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDozUyn_hor5gRV6y2wipM4Uo0oKcxAsMm231keuMQk_aDdGNwgttRg3VkcILbU4V3YWt1Mgk"}'
2025-02-09 04:06:50.735 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:06:50.743 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:06:50.743 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-09_04-06-49__46baa37e-e0d7-4d49-b072-ebc24a4622f6__wakuorg_nwaku:latest.log
2025-02-09 04:06:50.743 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:06:50.743 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:06:50.745 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:06:50.745 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.96.62
2025-02-09 04:06:50.745 DEBUG [src.node.docker_mananger] Generated ports ['5611', '5612', '5613', '5614', '5615']
2025-02-09 04:06:50.745 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:06:50.745 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:06:50.746 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:06:50.746 DEBUG [src.node.docker_mananger] docker run -i -t -p 5611:5611 -p 5612:5612 -p 5613:5613 -p 5614:5614 -p 5615:5615 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5613 --rest-port=5611 --tcp-port=5612 --discv5-udp-port=5614 --rest-address=0.0.0.0 --nat=extip:172.18.96.62 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=19eafb472fdd208b5bfad271fc4967cfec8acfb5de8269ed897a0fc8ec3c4bf4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5615 --metrics-logging=true --lightpush=false --relay=true
2025-02-09 04:06:50.974 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.96.62 waku 05a5bf2e9c399632fdf8b68b9e1fae75c50d436099f5f77eb96ed4e7d3facce8
2025-02-09 04:06:51.025 DEBUG [src.node.docker_mananger] Container started with ID 05a5bf2e9c39. Setting up logs at ./log/docker/receiving_node2_2025-02-09_04-06-49__46baa37e-e0d7-4d49-b072-ebc24a4622f6__wakuorg_nwaku:latest.log
2025-02-09 04:06:51.026 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 5611
2025-02-09 04:06:51.026 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:06:52.026 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5611/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:52.029 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:06:52.029 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:06:52.029 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5611/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:52.031 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.96.62/tcp/5612/p2p/16Uiu2HAkzFLKk2m4BcyzveuWwT3YQYhVy666VVTxuzK6JjevANTA","/ip4/172.18.96.62/tcp/5613/ws/p2p/16Uiu2HAkzFLKk2m4BcyzveuWwT3YQYhVy666VVTxuzK6JjevANTA"],"enrUri":"enr:-L24QN3CL24U-vCxD2EaG_-YI18PghPtw0LfRJ-mYIS8wCzzXIyQJw7Xk64heZWhTOtmg00RCqDntn1zwM7k6Rymo1ICgmlkgnY0gmlwhKwSYD6KbXVsdGlhZGRyc5YACASsEmA-BhXsAAoErBJgPgYV7d0DgnJzhQADAQAAiXNlY3AyNTZrMaECR6RmwJqkb-R73lNOJMgOQPyUBc95n8h9rDL1jGjMH7mDdGNwghXsg3VkcIIV7oV3YWt1MgE"}'
2025-02-09 04:06:52.032 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:06:52.032 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5611/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.4.140/tcp/56145/p2p/16Uiu2HAmPe5rUBqaU857ydKK8kwQu4kpjE2VNYBk3UkRAcvf8nbP"]'
2025-02-09 04:06:52.068 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:52.077 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:06:52.077 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-09_04-06-49__46baa37e-e0d7-4d49-b072-ebc24a4622f6__wakuorg_nwaku:latest.log
2025-02-09 04:06:52.077 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:06:52.078 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:06:52.079 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:06:52.079 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.167.152
2025-02-09 04:06:52.079 DEBUG [src.node.docker_mananger] Generated ports ['37915', '37916', '37917', '37918', '37919']
2025-02-09 04:06:52.079 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:06:52.080 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:06:52.080 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:06:52.080 DEBUG [src.node.docker_mananger] docker run -i -t -p 37915:37915 -p 37916:37916 -p 37917:37917 -p 37918:37918 -p 37919:37919 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37917 --rest-port=37915 --tcp-port=37916 --discv5-udp-port=37918 --rest-address=0.0.0.0 --nat=extip:172.18.167.152 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ddcbfabeddeda4c24fd78ca0cb0d957df79fd9bcde0c6dfdd4e8cc5fdc6af33f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37919 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QK1o8UFKLiJlnH3s2-uUJoV6usOe4RWYIso6oq5RJnPsF5diTjcr3qYQNzvpgYRPCtTNev7l3y5eczIFiGvXGC8CgmlkgnY0gmlwhKwSBIyKbXVsdGlhZGRyc5YACASsEgSMBttRAAoErBIEjAbbUt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDozUyn_hor5gRV6y2wipM4Uo0oKcxAsMm231keuMQk_aDdGNwgttRg3VkcILbU4V3YWt1Mgk --lightpushnode=/ip4/172.18.4.140/tcp/56145/p2p/16Uiu2HAmPe5rUBqaU857ydKK8kwQu4kpjE2VNYBk3UkRAcvf8nbP --lightpush=true --relay=false
2025-02-09 04:06:52.319 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.167.152 waku 6bde02ca2a7044e2345e3b13386d54c106f589118955561a47cdeb669d2c835f
2025-02-09 04:06:52.366 DEBUG [src.node.docker_mananger] Container started with ID 6bde02ca2a70. Setting up logs at ./log/docker/lightpush_node1_2025-02-09_04-06-49__46baa37e-e0d7-4d49-b072-ebc24a4622f6__wakuorg_nwaku:latest.log
2025-02-09 04:06:52.366 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 37915
2025-02-09 04:06:52.366 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:06:53.368 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37915/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:53.370 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:06:53.371 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:06:53.371 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37915/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:53.373 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.167.152/tcp/37916/p2p/16Uiu2HAm4oq3SWm2dBzgyabX4h4crUFhdvFQ5NadsB45LaSSoFPJ","/ip4/172.18.167.152/tcp/37917/ws/p2p/16Uiu2HAm4oq3SWm2dBzgyabX4h4crUFhdvFQ5NadsB45LaSSoFPJ"],"enrUri":"enr:-L24QA_8LXnzIfYpil0mD6C64cqq_fP2i_DQPjcZpaPr5JAyc863OixsRFGToEAYQPJvW2aogq9if9FdwJSKYoAouoECgmlkgnY0gmlwhKwSp5iKbXVsdGlhZGRyc5YACASsEqeYBpQcAAoErBKnmAaUHd0DgnJzhQADAQAAiXNlY3AyNTZrMaECi2Y1I1l54VyI3-gGqivFsUkAjAZSO1y1aD8VuOEAsyWDdGNwgpQcg3VkcIKUHoV3YWt1Mgg"}'
2025-02-09 04:06:53.373 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:06:53.374 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37915/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.4.140/tcp/56145/p2p/16Uiu2HAmPe5rUBqaU857ydKK8kwQu4kpjE2VNYBk3UkRAcvf8nbP"]'
2025-02-09 04:06:53.415 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:53.416 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37915/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.96.62/tcp/5612/p2p/16Uiu2HAkzFLKk2m4BcyzveuWwT3YQYhVy666VVTxuzK6JjevANTA"]'
2025-02-09 04:06:53.443 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:53.446 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56144/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:06:53.455 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:53.456 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5611/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:06:53.463 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:53.465 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37915/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1739074013465320192}}'
2025-02-09 04:06:53.479 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:53.479 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-09 04:06:53.979 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56144/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:53.982 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739074013465320192,"ephemeral":false}]'
2025-02-09 04:06:53.982 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-09 04:06:58.983 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.4.140/tcp/56145"} has 1
2025-02-09 04:06:58.988 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.4.140/tcp/56145"} with value 1.0
2025-02-09 04:06:58.988 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-09 04:06:58.991 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-09 04:06:58.991 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-09 04:06:58.994 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-09 04:06:58.994 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-09 04:06:58.998 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-09 04:06:58.998 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-09 04:06:59.001 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-09 04:06:59.002 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-09 04:06:59.004 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-09 04:06:59.005 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-09 04:06:59.008 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-09 04:06:59.008 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-09 04:06:59.011 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-09 04:06:59.011 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-09 04:06:59.014 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-09 04:06:59.014 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-09 04:06:59.017 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-09 04:06:59.019 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:06:59.020 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:06:59.020 DEBUG [src.node.waku_node] Stopping container with id 39c8ca1ebf7d
2025-02-09 04:07:00.542 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:07:00.542 DEBUG [src.node.waku_node] Stopping container with id 05a5bf2e9c39
2025-02-09 04:07:01.355 ERROR [src.node.docker_mananger] Max retries reached for container 39c8ca1ebf7d. Exiting log stream.
2025-02-09 04:07:02.029 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:07:02.030 DEBUG [src.node.waku_node] Stopping container with id 6bde02ca2a70
2025-02-09 04:07:02.843 ERROR [src.node.docker_mananger] Max retries reached for container 05a5bf2e9c39. Exiting log stream.
2025-02-09 04:07:03.343 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:07:03.344 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:07:03.353 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:07:03.360 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:07:03.366 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
