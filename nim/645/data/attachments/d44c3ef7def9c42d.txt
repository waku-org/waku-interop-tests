2025-02-09 04:03:09.496 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:03:09.497 DEBUG [tests.conftest] Running test: test_publish_with_valid_meta with id: 2025-02-09_04-03-09__ef201295-ba55-47bd-b5b4-deb8f427de55
2025-02-09 04:03:09.497 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:03:09.497 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:03:09.498 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-09 04:03:09.504 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:03:09.504 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_04-03-09__ef201295-ba55-47bd-b5b4-deb8f427de55__wakuorg_nwaku:latest.log
2025-02-09 04:03:09.504 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:03:09.504 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:03:09.506 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:03:09.506 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.90.61
2025-02-09 04:03:09.506 DEBUG [src.node.docker_mananger] Generated ports ['48877', '48878', '48879', '48880', '48881']
2025-02-09 04:03:09.506 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:03:09.506 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:03:09.507 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:03:09.507 DEBUG [src.node.docker_mananger] docker run -i -t -p 48877:48877 -p 48878:48878 -p 48879:48879 -p 48880:48880 -p 48881:48881 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48879 --rest-port=48877 --tcp-port=48878 --discv5-udp-port=48880 --rest-address=0.0.0.0 --nat=extip:172.18.90.61 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=31c434eaf8fda6bea9cb5da3d4ebd60b245c1ead6c7dcd7ad2acda9ceefd3ddc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48881 --metrics-logging=true --relay=true
2025-02-09 04:03:09.721 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.90.61 waku cdb2aac703543cd5f1e21b1d8affccf15032d67f12eb9f3ba3a36e7f6558d254
2025-02-09 04:03:09.772 DEBUG [src.node.docker_mananger] Container started with ID cdb2aac70354. Setting up logs at ./log/docker/node1_2025-02-09_04-03-09__ef201295-ba55-47bd-b5b4-deb8f427de55__wakuorg_nwaku:latest.log
2025-02-09 04:03:09.772 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48877
2025-02-09 04:03:09.772 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:03:10.295 ERROR [src.node.docker_mananger] Max retries reached for container 0c1fb6be4055. Exiting log stream.
2025-02-09 04:03:10.774 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48877/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:10.776 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:03:10.776 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:03:10.776 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48877/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:10.778 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.90.61/tcp/48878/p2p/16Uiu2HAmBxpHS9CncijLqwzVD7Cod27Vrmm8HSPWGc7eYF298es6","/ip4/172.18.90.61/tcp/48879/ws/p2p/16Uiu2HAmBxpHS9CncijLqwzVD7Cod27Vrmm8HSPWGc7eYF298es6"],"enrUri":"enr:-L24QJZimNYYd8b-ctLvQPg-LBqRz2TT6VwFjk3J_tWVX7waKRkt8mSB2Sa4uQXvaqyYP6spiOZjSYgBrSvrS1TmAqMCgmlkgnY0gmlwhKwSWj2KbXVsdGlhZGRyc5YACASsElo9Br7uAAoErBJaPQa-790DgnJzhQADAQAAiXNlY3AyNTZrMaEC9bViq_sEgVfb-mJe61BKo9CJLCf77_TrB3Otxcos2MWDdGNwgr7ug3VkcIK-8IV3YWt1MgE"}'
2025-02-09 04:03:10.778 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:03:10.784 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:03:10.784 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_04-03-09__ef201295-ba55-47bd-b5b4-deb8f427de55__wakuorg_nwaku:latest.log
2025-02-09 04:03:10.784 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:03:10.785 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:03:10.786 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:03:10.786 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.105.40
2025-02-09 04:03:10.786 DEBUG [src.node.docker_mananger] Generated ports ['25387', '25388', '25389', '25390', '25391']
2025-02-09 04:03:10.786 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:03:10.787 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:03:10.787 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:03:10.787 DEBUG [src.node.docker_mananger] docker run -i -t -p 25387:25387 -p 25388:25388 -p 25389:25389 -p 25390:25390 -p 25391:25391 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25389 --rest-port=25387 --tcp-port=25388 --discv5-udp-port=25390 --rest-address=0.0.0.0 --nat=extip:172.18.105.40 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ebc7ad22e4d5d3772b4ff347b4a17d8c10c8dca5aae30ad0d39d53a0421365e5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25391 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJZimNYYd8b-ctLvQPg-LBqRz2TT6VwFjk3J_tWVX7waKRkt8mSB2Sa4uQXvaqyYP6spiOZjSYgBrSvrS1TmAqMCgmlkgnY0gmlwhKwSWj2KbXVsdGlhZGRyc5YACASsElo9Br7uAAoErBJaPQa-790DgnJzhQADAQAAiXNlY3AyNTZrMaEC9bViq_sEgVfb-mJe61BKo9CJLCf77_TrB3Otxcos2MWDdGNwgr7ug3VkcIK-8IV3YWt1MgE
2025-02-09 04:03:11.008 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.105.40 waku 4c05c4cc22dcd1e396e2b439481cb2dfce8d83f73b34962ac84dd2f70f2926e3
2025-02-09 04:03:11.055 DEBUG [src.node.docker_mananger] Container started with ID 4c05c4cc22dc. Setting up logs at ./log/docker/node2_2025-02-09_04-03-09__ef201295-ba55-47bd-b5b4-deb8f427de55__wakuorg_nwaku:latest.log
2025-02-09 04:03:11.055 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25387
2025-02-09 04:03:11.055 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:03:12.056 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25387/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:12.063 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:03:12.064 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:03:12.064 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25387/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:12.070 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.105.40/tcp/25388/p2p/16Uiu2HAmNPdmiYpE8egqnmtiSiAh23owiWv3kcLDWCWBB7u5CZuA","/ip4/172.18.105.40/tcp/25389/ws/p2p/16Uiu2HAmNPdmiYpE8egqnmtiSiAh23owiWv3kcLDWCWBB7u5CZuA"],"enrUri":"enr:-L24QCZn8msi79LvlkjzTN7I5i08K5Jl9TzQ0tinOQFYLchrUpWw2bx36bjV8QTxVuXZjgCiHj_bhBzRLbCaGgNnCR8CgmlkgnY0gmlwhKwSaSiKbXVsdGlhZGRyc5YACASsEmkoBmMsAAoErBJpKAZjLd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDkKXjeJwJGsqsUiifXtUbYJ3GgEjZC0GtsJrIMiZVJ0mDdGNwgmMsg3VkcIJjLoV3YWt1MgE"}'
2025-02-09 04:03:12.072 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:03:12.074 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25387/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.90.61/tcp/48878/p2p/16Uiu2HAmBxpHS9CncijLqwzVD7Cod27Vrmm8HSPWGc7eYF298es6"]'
2025-02-09 04:03:12.078 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:12.078 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-09 04:03:12.079 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48877/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:03:12.082 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:12.083 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25387/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:03:12.089 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:12.090 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48877/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:03:12.094 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:12.095 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:03:12.195 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:12.195 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48877/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:12.198 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073792089872896,"ephemeral":false}]'
2025-02-09 04:03:12.199 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:12.199 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25387/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:12.201 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073792089872896,"ephemeral":false}]'
2025-02-09 04:03:12.203 INFO [src.steps.relay] WARM UP successful!!
2025-02-09 04:03:12.203 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48877/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "meta": "UmVsYXkgd29ya3MhIQ=="}'
2025-02-09 04:03:12.207 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:12.208 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:03:12.308 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:12.308 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48877/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:12.311 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073792203860480,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false}]'
2025-02-09 04:03:12.312 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:12.312 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25387/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:12.314 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073792203860480,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false}]'
2025-02-09 04:03:12.317 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:03:12.318 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:03:12.318 DEBUG [src.node.waku_node] Stopping container with id cdb2aac70354
2025-02-09 04:03:13.239 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:03:13.239 DEBUG [src.node.waku_node] Stopping container with id 4c05c4cc22dc
2025-02-09 04:03:14.050 ERROR [src.node.docker_mananger] Max retries reached for container cdb2aac70354. Exiting log stream.
2025-02-09 04:03:14.720 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:03:14.721 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:03:14.727 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:03:14.731 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
