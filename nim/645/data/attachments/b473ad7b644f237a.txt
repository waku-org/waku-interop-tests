2025-02-09 04:03:27.176 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:03:27.177 DEBUG [tests.conftest] Running test: test_publish_with_valid_version with id: 2025-02-09_04-03-27__659ef593-eeb6-4121-ac42-e3c078384c26
2025-02-09 04:03:27.177 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:03:27.177 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:03:27.177 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-09 04:03:27.183 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:03:27.183 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_04-03-27__659ef593-eeb6-4121-ac42-e3c078384c26__wakuorg_nwaku:latest.log
2025-02-09 04:03:27.184 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:03:27.184 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:03:27.185 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:03:27.186 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.234.227
2025-02-09 04:03:27.186 DEBUG [src.node.docker_mananger] Generated ports ['16970', '16971', '16972', '16973', '16974']
2025-02-09 04:03:27.186 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:03:27.186 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:03:27.186 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:03:27.186 DEBUG [src.node.docker_mananger] docker run -i -t -p 16970:16970 -p 16971:16971 -p 16972:16972 -p 16973:16973 -p 16974:16974 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16972 --rest-port=16970 --tcp-port=16971 --discv5-udp-port=16973 --rest-address=0.0.0.0 --nat=extip:172.18.234.227 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4fba0c56abe8b0edd23a4498f11b6ca41a6556cadbdfefaf3bec01bbca5cdad8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16974 --metrics-logging=true --relay=true
2025-02-09 04:03:27.411 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.234.227 waku c7f49692d1aee11610b5a4d870c306005b7c09b4cdeda553e4272406aea415a7
2025-02-09 04:03:27.470 DEBUG [src.node.docker_mananger] Container started with ID c7f49692d1ae. Setting up logs at ./log/docker/node1_2025-02-09_04-03-27__659ef593-eeb6-4121-ac42-e3c078384c26__wakuorg_nwaku:latest.log
2025-02-09 04:03:27.470 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16970
2025-02-09 04:03:27.470 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:03:27.959 ERROR [src.node.docker_mananger] Max retries reached for container 850102b6f85d. Exiting log stream.
2025-02-09 04:03:28.471 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16970/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:28.474 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:03:28.474 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:03:28.474 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16970/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:28.476 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.234.227/tcp/16971/p2p/16Uiu2HAm8RA9rqmrZPxaS2KfxphUw5MuSbt6zZjWKiKN6h7Nr6TZ","/ip4/172.18.234.227/tcp/16972/ws/p2p/16Uiu2HAm8RA9rqmrZPxaS2KfxphUw5MuSbt6zZjWKiKN6h7Nr6TZ"],"enrUri":"enr:-L24QAPRcLDPTxyCft_8-yQIGQmViqcGJN6Hmi6fkb7VXIoWUYLhIxw-e2yMQ0v9E-gKXGTdiKyDtuy-4gJ0TZ_p7RUCgmlkgnY0gmlwhKwS6uOKbXVsdGlhZGRyc5YACASsEurjBkJLAAoErBLq4wZCTN0DgnJzhQADAQAAiXNlY3AyNTZrMaECwQY0htH-HulMyLbv-GWFVghMYcqAaeVsLFI0trVxWPCDdGNwgkJLg3VkcIJCTYV3YWt1MgE"}'
2025-02-09 04:03:28.477 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:03:28.483 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:03:28.483 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_04-03-27__659ef593-eeb6-4121-ac42-e3c078384c26__wakuorg_nwaku:latest.log
2025-02-09 04:03:28.483 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:03:28.483 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:03:28.484 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:03:28.484 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.3.17
2025-02-09 04:03:28.484 DEBUG [src.node.docker_mananger] Generated ports ['48717', '48718', '48719', '48720', '48721']
2025-02-09 04:03:28.485 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:03:28.485 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:03:28.485 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:03:28.485 DEBUG [src.node.docker_mananger] docker run -i -t -p 48717:48717 -p 48718:48718 -p 48719:48719 -p 48720:48720 -p 48721:48721 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48719 --rest-port=48717 --tcp-port=48718 --discv5-udp-port=48720 --rest-address=0.0.0.0 --nat=extip:172.18.3.17 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bd138bdb69b4360a620f1aaea2a3a70ccd51a0bef1ea4cbfe4c9efc917cf0deb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48721 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QAPRcLDPTxyCft_8-yQIGQmViqcGJN6Hmi6fkb7VXIoWUYLhIxw-e2yMQ0v9E-gKXGTdiKyDtuy-4gJ0TZ_p7RUCgmlkgnY0gmlwhKwS6uOKbXVsdGlhZGRyc5YACASsEurjBkJLAAoErBLq4wZCTN0DgnJzhQADAQAAiXNlY3AyNTZrMaECwQY0htH-HulMyLbv-GWFVghMYcqAaeVsLFI0trVxWPCDdGNwgkJLg3VkcIJCTYV3YWt1MgE
2025-02-09 04:03:28.707 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.3.17 waku 734b6ad2de396a87af9f7d75584ed9834c70a0ab1e9c8b1ab2950bdfb7b4d856
2025-02-09 04:03:28.755 DEBUG [src.node.docker_mananger] Container started with ID 734b6ad2de39. Setting up logs at ./log/docker/node2_2025-02-09_04-03-27__659ef593-eeb6-4121-ac42-e3c078384c26__wakuorg_nwaku:latest.log
2025-02-09 04:03:28.756 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48717
2025-02-09 04:03:28.756 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:03:29.756 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48717/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:29.764 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:03:29.765 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:03:29.765 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48717/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:29.770 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.3.17/tcp/48718/p2p/16Uiu2HAm5LewmZZffNFtmBkr95wLgBJUFwZ6uJ1j9PksppPSgkH3","/ip4/172.18.3.17/tcp/48719/ws/p2p/16Uiu2HAm5LewmZZffNFtmBkr95wLgBJUFwZ6uJ1j9PksppPSgkH3"],"enrUri":"enr:-L24QMtgvT3hxzMmA_DwL_3rS8h90E9Ma-LebxMXyZ8Dr_8RE6VF_BzpkUIYJGMAbNP5WF1h6l0ugzZgwAVoaopCx-8CgmlkgnY0gmlwhKwSAxGKbXVsdGlhZGRyc5YACASsEgMRBr5OAAoErBIDEQa-T90DgnJzhQADAQAAiXNlY3AyNTZrMaECk0vLiFZJvPCo54OdhvsfDcwbunqOBLnRHwA8HTCtUlaDdGNwgr5Og3VkcIK-UIV3YWt1MgE"}'
2025-02-09 04:03:29.770 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:03:29.770 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48717/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.234.227/tcp/16971/p2p/16Uiu2HAm8RA9rqmrZPxaS2KfxphUw5MuSbt6zZjWKiKN6h7Nr6TZ"]'
2025-02-09 04:03:29.773 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:29.773 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-09 04:03:29.774 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16970/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:03:29.777 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:29.778 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48717/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 04:03:29.783 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:29.784 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16970/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:03:29.789 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:29.790 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:03:29.890 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:29.890 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16970/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:29.892 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073809784823040,"ephemeral":false}]'
2025-02-09 04:03:29.894 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:29.894 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48717/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:29.896 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739073809784823040,"ephemeral":false}]'
2025-02-09 04:03:29.898 INFO [src.steps.relay] WARM UP successful!!
2025-02-09 04:03:29.899 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16970/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
2025-02-09 04:03:29.903 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:03:29.904 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:03:30.004 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:30.004 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16970/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:30.007 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1739073809898959616,"ephemeral":false}]'
2025-02-09 04:03:30.009 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:03:30.009 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48717/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:03:30.011 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1739073809898959616,"ephemeral":false}]'
2025-02-09 04:03:30.014 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:03:30.015 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:03:30.015 DEBUG [src.node.waku_node] Stopping container with id c7f49692d1ae
2025-02-09 04:03:30.815 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:03:30.815 DEBUG [src.node.waku_node] Stopping container with id 734b6ad2de39
2025-02-09 04:03:31.627 ERROR [src.node.docker_mananger] Max retries reached for container c7f49692d1ae. Exiting log stream.
2025-02-09 04:03:32.304 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:03:32.309 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:03:32.313 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:03:32.318 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
