2025-02-09 04:05:20.243 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:05:20.243 DEBUG [tests.conftest] Running test: test_main_node_only_relay__peer_only_store with id: 2025-02-09_04-05-20__45bb2625-dbab-42a9-a487-597e51ca734e
2025-02-09 04:05:20.243 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:05:20.243 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-09 04:05:20.250 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:05:20.250 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-09_04-05-20__45bb2625-dbab-42a9-a487-597e51ca734e__wakuorg_nwaku:latest.log
2025-02-09 04:05:20.250 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:05:20.250 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:05:20.252 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:05:20.252 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.88.169
2025-02-09 04:05:20.252 DEBUG [src.node.docker_mananger] Generated ports ['24294', '24295', '24296', '24297', '24298']
2025-02-09 04:05:20.252 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:05:20.252 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:05:20.252 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:05:20.253 DEBUG [src.node.docker_mananger] docker run -i -t -p 24294:24294 -p 24295:24295 -p 24296:24296 -p 24297:24297 -p 24298:24298 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24296 --rest-port=24294 --tcp-port=24295 --discv5-udp-port=24297 --rest-address=0.0.0.0 --nat=extip:172.18.88.169 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ec570bec7cea4afd0af1c7a2ba9bbca41e12ab651051ba4e0213ea5bdddceff6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24298 --metrics-logging=true --store=false --relay=true
2025-02-09 04:05:20.479 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.88.169 waku 9b953da07a47debd784ba076d64693368b4bfd9cab50a0ac1520ffe9db33a7f3
2025-02-09 04:05:20.529 DEBUG [src.node.docker_mananger] Container started with ID 9b953da07a47. Setting up logs at ./log/docker/publishing_node1_2025-02-09_04-05-20__45bb2625-dbab-42a9-a487-597e51ca734e__wakuorg_nwaku:latest.log
2025-02-09 04:05:20.529 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24294
2025-02-09 04:05:20.529 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:05:21.048 ERROR [src.node.docker_mananger] Max retries reached for container e1051a262f59. Exiting log stream.
2025-02-09 04:05:21.530 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24294/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:21.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:05:21.532 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:05:21.532 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24294/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:21.534 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.88.169/tcp/24295/p2p/16Uiu2HAmFQqraLky7YMMaKt4Nco5tineZS6Uec7Bue3yJeJedEHo","/ip4/172.18.88.169/tcp/24296/ws/p2p/16Uiu2HAmFQqraLky7YMMaKt4Nco5tineZS6Uec7Bue3yJeJedEHo"],"enrUri":"enr:-L24QCgjMlG97oXvM7NDq3R6GbocuW0MEAO2p2rgikhNQc3xeJzZF9LM0MU5h8rhK_4XKIWwg-f6JBV5lSu-qxWIEGECgmlkgnY0gmlwhKwSWKmKbXVsdGlhZGRyc5YACASsElipBl7nAAoErBJYqQZe6N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDKPNS9HS3ccuOjLLoY3Q6u2U5cUchF3gFKUubRygp6PKDdGNwgl7ng3VkcIJe6YV3YWt1MgE"}'
2025-02-09 04:05:21.535 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:05:21.541 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:05:21.541 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-09_04-05-20__45bb2625-dbab-42a9-a487-597e51ca734e__wakuorg_nwaku:latest.log
2025-02-09 04:05:21.542 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:05:21.542 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:05:21.543 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:05:21.543 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.235.248
2025-02-09 04:05:21.543 DEBUG [src.node.docker_mananger] Generated ports ['35125', '35126', '35127', '35128', '35129']
2025-02-09 04:05:21.543 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:05:21.544 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:05:21.544 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:05:21.544 DEBUG [src.node.docker_mananger] docker run -i -t -p 35125:35125 -p 35126:35126 -p 35127:35127 -p 35128:35128 -p 35129:35129 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=35127 --rest-port=35125 --tcp-port=35126 --discv5-udp-port=35128 --rest-address=0.0.0.0 --nat=extip:172.18.235.248 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c48ec36fa142b730f9f42c4b2bda2c5c20f6fcfa441fe044fab0a3584a1000f2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=35129 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QCgjMlG97oXvM7NDq3R6GbocuW0MEAO2p2rgikhNQc3xeJzZF9LM0MU5h8rhK_4XKIWwg-f6JBV5lSu-qxWIEGECgmlkgnY0gmlwhKwSWKmKbXVsdGlhZGRyc5YACASsElipBl7nAAoErBJYqQZe6N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDKPNS9HS3ccuOjLLoY3Q6u2U5cUchF3gFKUubRygp6PKDdGNwgl7ng3VkcIJe6YV3YWt1MgE --storenode=/ip4/172.18.88.169/tcp/24295/p2p/16Uiu2HAmFQqraLky7YMMaKt4Nco5tineZS6Uec7Bue3yJeJedEHo --store=true --relay=false
2025-02-09 04:05:21.779 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.235.248 waku ffdf9285f239ae4544f85200da10587646635ce9310d6ffbc33c7e67a25e0ce9
2025-02-09 04:05:21.831 DEBUG [src.node.docker_mananger] Container started with ID ffdf9285f239. Setting up logs at ./log/docker/store_node1_2025-02-09_04-05-20__45bb2625-dbab-42a9-a487-597e51ca734e__wakuorg_nwaku:latest.log
2025-02-09 04:05:21.832 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 35125
2025-02-09 04:05:21.833 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:05:22.833 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35125/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:22.836 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:05:22.836 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:05:22.836 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35125/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:22.838 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.248/tcp/35126/p2p/16Uiu2HAmR7wBdVa1X1mrLJLb5VBbkPYj7TTFgSC2fhg8B2g2tMtL","/ip4/172.18.235.248/tcp/35127/ws/p2p/16Uiu2HAmR7wBdVa1X1mrLJLb5VBbkPYj7TTFgSC2fhg8B2g2tMtL"],"enrUri":"enr:-L24QN7s1s3DGKu7NGsAroyqXaumzCfv6y5qWREPaHx2rD3Ib34qb1Yg35Hs-3hLCXFu9Z4H72Uf7EO6PjpqwTmGqGMCgmlkgnY0gmlwhKwS6_iKbXVsdGlhZGRyc5YACASsEuv4Bok2AAoErBLr-AaJN90DgnJzhQADAQAAiXNlY3AyNTZrMaEDuTNYM0MSBESWOClzmA2o48mjdycJH2eBE_SCM38izRmDdGNwgok2g3VkcIKJOIV3YWt1MgI"}'
2025-02-09 04:05:22.839 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:05:22.839 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35125/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.88.169/tcp/24295/p2p/16Uiu2HAmFQqraLky7YMMaKt4Nco5tineZS6Uec7Bue3yJeJedEHo"]'
2025-02-09 04:05:22.874 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:22.874 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24294/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-09 04:05:22.891 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:22.891 DEBUG [src.steps.store] Relaying message
2025-02-09 04:05:22.894 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24294/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:05:22.899 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:22.899 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:05:23.100 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-09 04:05:23.101 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35125/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:23.104 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-09 04:05:23.105 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:05:23.106 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:05:23.107 DEBUG [src.node.waku_node] Stopping container with id 9b953da07a47
2025-02-09 04:05:24.219 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:05:24.220 DEBUG [src.node.waku_node] Stopping container with id ffdf9285f239
2025-02-09 04:05:25.044 ERROR [src.node.docker_mananger] Max retries reached for container 9b953da07a47. Exiting log stream.
2025-02-09 04:05:25.713 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:05:25.714 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:05:25.721 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:05:25.726 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
