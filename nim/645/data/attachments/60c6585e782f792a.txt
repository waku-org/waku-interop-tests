2025-02-09 04:06:08.337 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:06:08.337 DEBUG [tests.conftest] Running test: test_legacy_store_v1 with id: 2025-02-09_04-06-08__317e45b3-d36b-47c2-bc46-b1cc3ce4d65d
2025-02-09 04:06:08.338 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:06:08.338 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-09 04:06:08.338 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-09 04:06:08.344 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:06:08.344 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-09_04-06-08__317e45b3-d36b-47c2-bc46-b1cc3ce4d65d__wakuorg_nwaku:latest.log
2025-02-09 04:06:08.344 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:06:08.344 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:06:08.346 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:06:08.346 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.17.249
2025-02-09 04:06:08.346 DEBUG [src.node.docker_mananger] Generated ports ['12709', '12710', '12711', '12712', '12713']
2025-02-09 04:06:08.346 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:06:08.346 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:06:08.346 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:06:08.346 DEBUG [src.node.docker_mananger] docker run -i -t -p 12709:12709 -p 12710:12710 -p 12711:12711 -p 12712:12712 -p 12713:12713 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12711 --rest-port=12709 --tcp-port=12710 --discv5-udp-port=12712 --rest-address=0.0.0.0 --nat=extip:172.18.17.249 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=abda75c64bc14d95eae6cffba7f4141ac5effa4caedb0fd9f1731ecea544e920 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12713 --metrics-logging=true --store=true --relay=true
2025-02-09 04:06:08.568 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.17.249 waku cb68edf6cdb39f6cb039b62c5d8fd71c36a5ba960be62af46144e00dd9d59f6a
2025-02-09 04:06:08.628 DEBUG [src.node.docker_mananger] Container started with ID cb68edf6cdb3. Setting up logs at ./log/docker/publishing_node1_2025-02-09_04-06-08__317e45b3-d36b-47c2-bc46-b1cc3ce4d65d__wakuorg_nwaku:latest.log
2025-02-09 04:06:08.629 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 12709
2025-02-09 04:06:08.629 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:06:09.010 ERROR [src.node.docker_mananger] Max retries reached for container ccf63175fdf6. Exiting log stream.
2025-02-09 04:06:09.630 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12709/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:09.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:06:09.633 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:06:09.633 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12709/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:09.635 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.17.249/tcp/12710/p2p/16Uiu2HAmMZTFGaiRoCFCC8TywXcjMLDHmc5bSTrnVDXa2ED6DJ7V","/ip4/172.18.17.249/tcp/12711/ws/p2p/16Uiu2HAmMZTFGaiRoCFCC8TywXcjMLDHmc5bSTrnVDXa2ED6DJ7V"],"enrUri":"enr:-L24QDvNRhN_79FT-OghTV4fOBx7qkbMRHIeUq1WIjqOUbbUccyI3QRVd3M_BwKHYw50bqDP7ria6CCw_MFB3Lh_N2UCgmlkgnY0gmlwhKwSEfmKbXVsdGlhZGRyc5YACASsEhH5BjGmAAoErBIR-QYxp90DgnJzhQADAQAAiXNlY3AyNTZrMaEDhE4b7s8aF1GuMnQVdmzXAy3I9__4n6za_huYKNtcqEyDdGNwgjGmg3VkcIIxqIV3YWt1MgM"}'
2025-02-09 04:06:09.635 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:06:09.642 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:06:09.642 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-09_04-06-08__317e45b3-d36b-47c2-bc46-b1cc3ce4d65d__wakuorg_nwaku:latest.log
2025-02-09 04:06:09.642 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:06:09.642 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:06:09.643 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:06:09.644 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.123.241
2025-02-09 04:06:09.644 DEBUG [src.node.docker_mananger] Generated ports ['4491', '4492', '4493', '4494', '4495']
2025-02-09 04:06:09.644 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:06:09.644 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:06:09.644 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:06:09.644 DEBUG [src.node.docker_mananger] docker run -i -t -p 4491:4491 -p 4492:4492 -p 4493:4493 -p 4494:4494 -p 4495:4495 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4493 --rest-port=4491 --tcp-port=4492 --discv5-udp-port=4494 --rest-address=0.0.0.0 --nat=extip:172.18.123.241 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6ef0d44daaf9beb07bb17dd02df13de003f4b51b831e7ac8d9b1e4f973fb5fbf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4495 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QDvNRhN_79FT-OghTV4fOBx7qkbMRHIeUq1WIjqOUbbUccyI3QRVd3M_BwKHYw50bqDP7ria6CCw_MFB3Lh_N2UCgmlkgnY0gmlwhKwSEfmKbXVsdGlhZGRyc5YACASsEhH5BjGmAAoErBIR-QYxp90DgnJzhQADAQAAiXNlY3AyNTZrMaEDhE4b7s8aF1GuMnQVdmzXAy3I9__4n6za_huYKNtcqEyDdGNwgjGmg3VkcIIxqIV3YWt1MgM --storenode=/ip4/172.18.17.249/tcp/12710/p2p/16Uiu2HAmMZTFGaiRoCFCC8TywXcjMLDHmc5bSTrnVDXa2ED6DJ7V --store=true --relay=true
2025-02-09 04:06:09.877 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.123.241 waku 0dc6067a5aa06ab17d445528e48749aa36a09481089ff2b97c043bbf3c2d6972
2025-02-09 04:06:09.922 DEBUG [src.node.docker_mananger] Container started with ID 0dc6067a5aa0. Setting up logs at ./log/docker/store_node1_2025-02-09_04-06-08__317e45b3-d36b-47c2-bc46-b1cc3ce4d65d__wakuorg_nwaku:latest.log
2025-02-09 04:06:09.922 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 4491
2025-02-09 04:06:09.922 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:06:10.924 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4491/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:10.927 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:06:10.927 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:06:10.927 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4491/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:10.929 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.123.241/tcp/4492/p2p/16Uiu2HAkwRUkfnJhUdiKDeFjMJmcDkRBUDqFnPXETPtxTDpNZodp","/ip4/172.18.123.241/tcp/4493/ws/p2p/16Uiu2HAkwRUkfnJhUdiKDeFjMJmcDkRBUDqFnPXETPtxTDpNZodp"],"enrUri":"enr:-L24QNws2ozdvBHNywOxn_80aYYmPTX7RBCA97muCP8xGGQtIcU5lLxldMLp4p5U8t4CtgDNlPZ-9nJRU0bLgeppOnUCgmlkgnY0gmlwhKwSe_GKbXVsdGlhZGRyc5YACASsEnvxBhGMAAoErBJ78QYRjd0DgnJzhQADAQAAiXNlY3AyNTZrMaECHaquJZS0wvzdmOPFKrMH07PiWtdcXJT0nuCq9gcdbX-DdGNwghGMg3VkcIIRjoV3YWt1MgM"}'
2025-02-09 04:06:10.929 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:06:10.930 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4491/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.17.249/tcp/12710/p2p/16Uiu2HAmMZTFGaiRoCFCC8TywXcjMLDHmc5bSTrnVDXa2ED6DJ7V"]'
2025-02-09 04:06:10.933 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:10.933 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12709/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-09 04:06:10.936 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:10.936 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:4491/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-09 04:06:10.938 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:10.939 DEBUG [src.steps.store] Relaying message
2025-02-09 04:06:10.939 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12709/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:06:10.945 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:06:10.946 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:06:11.146 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12709/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:11.150 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739073970939365888,"ephemeral":false}]}'
2025-02-09 04:06:11.150 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:4491/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:06:11.153 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739073970939365888,"ephemeral":false}]}'
2025-02-09 04:06:11.154 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:06:11.155 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:06:11.156 DEBUG [src.node.waku_node] Stopping container with id cb68edf6cdb3
2025-02-09 04:06:12.149 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:06:12.150 DEBUG [src.node.waku_node] Stopping container with id 0dc6067a5aa0
2025-02-09 04:06:12.961 ERROR [src.node.docker_mananger] Max retries reached for container cb68edf6cdb3. Exiting log stream.
2025-02-09 04:06:13.661 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:06:13.664 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:06:13.668 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:06:13.673 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
