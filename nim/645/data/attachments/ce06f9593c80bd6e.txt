2025-02-09 04:08:30.004 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:08:30.005 DEBUG [tests.conftest] Running test: test_store_with_wrong_url_pubsub_topic with id: 2025-02-09_04-08-30__ec09082f-fce2-4265-859f-7e4e80783c25
2025-02-09 04:08:30.005 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:08:30.005 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-09 04:08:30.006 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-09 04:08:30.012 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:08:30.012 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-09_04-08-30__ec09082f-fce2-4265-859f-7e4e80783c25__wakuorg_nwaku:latest.log
2025-02-09 04:08:30.012 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:08:30.012 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:08:30.013 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:08:30.013 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.218.111
2025-02-09 04:08:30.014 DEBUG [src.node.docker_mananger] Generated ports ['53376', '53377', '53378', '53379', '53380']
2025-02-09 04:08:30.014 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:08:30.014 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:08:30.014 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:08:30.014 DEBUG [src.node.docker_mananger] docker run -i -t -p 53376:53376 -p 53377:53377 -p 53378:53378 -p 53379:53379 -p 53380:53380 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53378 --rest-port=53376 --tcp-port=53377 --discv5-udp-port=53379 --rest-address=0.0.0.0 --nat=extip:172.18.218.111 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fcc6ffc11ccc701a93fdcfc2e6c2f5cef103f7eb3cfbd6ee77d59ad7d9890ea1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53380 --metrics-logging=true --store=true --relay=true
2025-02-09 04:08:30.240 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.218.111 waku 8303bf6681e6a44aa151370db01d4f832d232492a95e9870546414907a402a74
2025-02-09 04:08:30.291 DEBUG [src.node.docker_mananger] Container started with ID 8303bf6681e6. Setting up logs at ./log/docker/publishing_node1_2025-02-09_04-08-30__ec09082f-fce2-4265-859f-7e4e80783c25__wakuorg_nwaku:latest.log
2025-02-09 04:08:30.293 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53376
2025-02-09 04:08:30.293 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:08:30.806 ERROR [src.node.docker_mananger] Max retries reached for container 4330b436fd9b. Exiting log stream.
2025-02-09 04:08:31.293 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53376/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:31.296 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:08:31.296 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:08:31.296 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53376/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:31.298 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.218.111/tcp/53377/p2p/16Uiu2HAmLCSACwQtCiWssti4cpw9despHZ64HFNqsWfanSonHbUF","/ip4/172.18.218.111/tcp/53378/ws/p2p/16Uiu2HAmLCSACwQtCiWssti4cpw9despHZ64HFNqsWfanSonHbUF"],"enrUri":"enr:-L24QM2xsrjvTp4O9lOCHpTol1GL_6y4qS5q4Zt5DGOLK_u2T6mbrPcj5IuGDUhndvOmenQ94AMQ3JkMGpNDraVTTZICgmlkgnY0gmlwhKwS2m-KbXVsdGlhZGRyc5YACASsEtpvBtCBAAoErBLabwbQgt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDcA_-7E0tl2IpQXOTh0SnEXnpBtkywhMCjTKppgQtC8SDdGNwgtCBg3VkcILQg4V3YWt1MgM"}'
2025-02-09 04:08:31.299 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:08:31.305 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:08:31.306 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-09_04-08-30__ec09082f-fce2-4265-859f-7e4e80783c25__wakuorg_nwaku:latest.log
2025-02-09 04:08:31.306 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:08:31.306 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:08:31.307 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:08:31.307 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.12.84
2025-02-09 04:08:31.307 DEBUG [src.node.docker_mananger] Generated ports ['54686', '54687', '54688', '54689', '54690']
2025-02-09 04:08:31.308 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:08:31.308 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:08:31.308 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:08:31.308 DEBUG [src.node.docker_mananger] docker run -i -t -p 54686:54686 -p 54687:54687 -p 54688:54688 -p 54689:54689 -p 54690:54690 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54688 --rest-port=54686 --tcp-port=54687 --discv5-udp-port=54689 --rest-address=0.0.0.0 --nat=extip:172.18.12.84 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fb79ca9d97a300edc6d2d3bfa66b5ffea8c7b130ccfaa5c12a24aec8de1cdf63 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54690 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QM2xsrjvTp4O9lOCHpTol1GL_6y4qS5q4Zt5DGOLK_u2T6mbrPcj5IuGDUhndvOmenQ94AMQ3JkMGpNDraVTTZICgmlkgnY0gmlwhKwS2m-KbXVsdGlhZGRyc5YACASsEtpvBtCBAAoErBLabwbQgt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDcA_-7E0tl2IpQXOTh0SnEXnpBtkywhMCjTKppgQtC8SDdGNwgtCBg3VkcILQg4V3YWt1MgM --storenode=/ip4/172.18.218.111/tcp/53377/p2p/16Uiu2HAmLCSACwQtCiWssti4cpw9despHZ64HFNqsWfanSonHbUF --store=true --relay=true
2025-02-09 04:08:31.544 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.12.84 waku 5a5e5d348743b1ebe22ac13da77d78cfbb6ea93eff2a063e65d9fa0135811a01
2025-02-09 04:08:31.602 DEBUG [src.node.docker_mananger] Container started with ID 5a5e5d348743. Setting up logs at ./log/docker/store_node1_2025-02-09_04-08-30__ec09082f-fce2-4265-859f-7e4e80783c25__wakuorg_nwaku:latest.log
2025-02-09 04:08:31.602 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54686
2025-02-09 04:08:31.602 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:08:32.603 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54686/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:32.606 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:08:32.606 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:08:32.606 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54686/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:32.608 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.12.84/tcp/54687/p2p/16Uiu2HAmJRFHujwEaRBh3Kq9X9TgMJU7XNtonPyQwbNzLCUAVzQp","/ip4/172.18.12.84/tcp/54688/ws/p2p/16Uiu2HAmJRFHujwEaRBh3Kq9X9TgMJU7XNtonPyQwbNzLCUAVzQp"],"enrUri":"enr:-L24QMe2LB8lrV6dJVxWrtPptVPYZpwArhvAQX8lkPZtROUvVd_Y0_cd45J4lr5w7VsH_rVzI1ChpH_2dlTksUfzOyACgmlkgnY0gmlwhKwSDFSKbXVsdGlhZGRyc5YACASsEgxUBtWfAAoErBIMVAbVoN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDVaDiiKKFK97ZEGPyE4-2Sy49CW4C5lQ872uvwtLM23mDdGNwgtWfg3VkcILVoYV3YWt1MgM"}'
2025-02-09 04:08:32.608 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:08:32.609 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54686/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.218.111/tcp/53377/p2p/16Uiu2HAmLCSACwQtCiWssti4cpw9despHZ64HFNqsWfanSonHbUF"]'
2025-02-09 04:08:41.594 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:41.594 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-09 04:08:41.596 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:41.597 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54686/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-09 04:08:41.599 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:41.600 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:41.600 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:41.605 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:41.606 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:41.807 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:41.807 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/waku/2/content/test.js", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:41.812 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:41.813 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:42.014 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:42.014 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/22/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:42.020 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:42.021 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:42.221 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:42.222 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:42.228 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:42.228 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:42.429 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:42.429 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/statusim/1/community/cbor", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:42.434 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:42.435 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:42.636 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:42.636 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/27/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:42.641 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:42.641 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:42.842 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:42.843 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/29/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:42.848 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:42.849 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:43.050 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:43.050 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/20/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:43.055 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:43.055 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:43.257 DEBUG [tests.store.test_topics] Trying to get stored msg with wrong url topic waku/2/rs/3/0
2025-02-09 04:08:43.257 DEBUG [src.steps.store] Relaying message
2025-02-09 04:08:43.258 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53376/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:08:43.263 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:43.263 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:43.464 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-09 04:08:43.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53376/store/v3/messages?pubsubTopic=waku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:43.467 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-09 04:08:43.467 ERROR [tests.store.test_topics] Topic waku/2/rs/3/0 is wrong ''n: Peer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
2025-02-09 04:08:43.470 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:08:43.471 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:08:43.471 DEBUG [src.node.waku_node] Stopping container with id 8303bf6681e6
2025-02-09 04:08:44.582 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:08:44.582 DEBUG [src.node.waku_node] Stopping container with id 5a5e5d348743
2025-02-09 04:08:45.107 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:08:45.108 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:08:45.115 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:08:45.122 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
