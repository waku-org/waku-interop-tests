2025-02-09 04:08:05.361 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:08:05.362 DEBUG [tests.conftest] Running test: test_store_lightpushed_message with id: 2025-02-09_04-08-05__1628af3e-512e-4f27-8279-7dce19985f04
2025-02-09 04:08:05.362 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:08:05.362 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-09 04:08:05.369 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:08:05.370 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-09_04-08-05__1628af3e-512e-4f27-8279-7dce19985f04__wakuorg_nwaku:latest.log
2025-02-09 04:08:05.370 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:08:05.370 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:08:05.371 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:08:05.371 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.81.94
2025-02-09 04:08:05.372 DEBUG [src.node.docker_mananger] Generated ports ['53479', '53480', '53481', '53482', '53483']
2025-02-09 04:08:05.372 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:08:05.372 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:08:05.372 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:08:05.372 DEBUG [src.node.docker_mananger] docker run -i -t -p 53479:53479 -p 53480:53480 -p 53481:53481 -p 53482:53482 -p 53483:53483 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53481 --rest-port=53479 --tcp-port=53480 --discv5-udp-port=53482 --rest-address=0.0.0.0 --nat=extip:172.18.81.94 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=efaa58bff42ffcd87df52a93e0072a700b1eafeaf5c7da6c99dbea73fd0bc15a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53483 --metrics-logging=true --store=true --relay=true --lightpush=true
2025-02-09 04:08:05.614 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.81.94 waku 4a493612d0a8994e18e588deba0aa824d83d0c4fefae8b0cc8a8e26b5c3a0fff
2025-02-09 04:08:05.666 DEBUG [src.node.docker_mananger] Container started with ID 4a493612d0a8. Setting up logs at ./log/docker/publishing_node1_2025-02-09_04-08-05__1628af3e-512e-4f27-8279-7dce19985f04__wakuorg_nwaku:latest.log
2025-02-09 04:08:05.668 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53479
2025-02-09 04:08:05.668 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:08:06.165 ERROR [src.node.docker_mananger] Max retries reached for container f8e0ad4f30eb. Exiting log stream.
2025-02-09 04:08:06.669 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53479/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:06.671 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:08:06.672 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:08:06.672 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53479/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:06.674 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.94/tcp/53480/p2p/16Uiu2HAmN2eHvS6LayfhRsShwd63NfndbMCL83PkCMUBVZytJYy7","/ip4/172.18.81.94/tcp/53481/ws/p2p/16Uiu2HAmN2eHvS6LayfhRsShwd63NfndbMCL83PkCMUBVZytJYy7"],"enrUri":"enr:-L24QIUqo-Izr01vXfBrCwZu310_IWcN0BqUxuoaYnNN6yBASdLPZcF_RISVlGzPElr6nw1jCZpYuh1lN7JBK5UZtVkCgmlkgnY0gmlwhKwSUV6KbXVsdGlhZGRyc5YACASsElFeBtDoAAoErBJRXgbQ6d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDi0VHyO3ycm_6X-W55EMZnYyy0fUPlicmGBPt1VxrA-qDdGNwgtDog3VkcILQ6oV3YWt1Mgs"}'
2025-02-09 04:08:06.674 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:08:06.681 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:08:06.681 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node2_2025-02-09_04-08-05__1628af3e-512e-4f27-8279-7dce19985f04__wakuorg_nwaku:latest.log
2025-02-09 04:08:06.681 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:08:06.681 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:08:06.683 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:08:06.683 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.133.159
2025-02-09 04:08:06.683 DEBUG [src.node.docker_mananger] Generated ports ['59387', '59388', '59389', '59390', '59391']
2025-02-09 04:08:06.683 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:08:06.683 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:08:06.683 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:08:06.684 DEBUG [src.node.docker_mananger] docker run -i -t -p 59387:59387 -p 59388:59388 -p 59389:59389 -p 59390:59390 -p 59391:59391 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59389 --rest-port=59387 --tcp-port=59388 --discv5-udp-port=59390 --rest-address=0.0.0.0 --nat=extip:172.18.133.159 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5fb7ec8c41db76fbad675e4b634abf7c8f815e34f5aeb8bfedcacc1a7bd78ced --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59391 --metrics-logging=true --store=false --relay=true
2025-02-09 04:08:06.912 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.133.159 waku dc8732c91442f2f324b5c94586f2d5823c79f926200b45f71321a5ce64584315
2025-02-09 04:08:06.958 DEBUG [src.node.docker_mananger] Container started with ID dc8732c91442. Setting up logs at ./log/docker/publishing_node2_2025-02-09_04-08-05__1628af3e-512e-4f27-8279-7dce19985f04__wakuorg_nwaku:latest.log
2025-02-09 04:08:06.959 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59387
2025-02-09 04:08:06.959 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:08:07.959 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59387/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:07.962 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:08:07.963 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:08:07.963 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59387/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:07.965 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.133.159/tcp/59388/p2p/16Uiu2HAkwcjqe824m2vVzk3QUmXEWyfJnvMRF4bFyNeK1uKxsCLy","/ip4/172.18.133.159/tcp/59389/ws/p2p/16Uiu2HAkwcjqe824m2vVzk3QUmXEWyfJnvMRF4bFyNeK1uKxsCLy"],"enrUri":"enr:-L24QMV5w_JUjwB5hkOvJym1cS5dRK-xpv-L6-3iFT3TIBpkMtOoTnDkvmar5qzRGOPGyI-Q_zS4tx2UaHRwSXaLImACgmlkgnY0gmlwhKwShZ-KbXVsdGlhZGRyc5YACASsEoWfBuf8AAoErBKFnwbn_d0DgnJzhQADAQAAiXNlY3AyNTZrMaECII0gauh2yE0hQNnHNRQmydRAEk2J1Nq9OTMv29TCMZKDdGNwguf8g3VkcILn_oV3YWt1MgE"}'
2025-02-09 04:08:07.965 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:08:07.965 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59387/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.81.94/tcp/53480/p2p/16Uiu2HAmN2eHvS6LayfhRsShwd63NfndbMCL83PkCMUBVZytJYy7"]'
2025-02-09 04:08:08.004 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:08.016 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:08:08.016 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-09_04-08-05__1628af3e-512e-4f27-8279-7dce19985f04__wakuorg_nwaku:latest.log
2025-02-09 04:08:08.017 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:08:08.017 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:08:08.018 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:08:08.019 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.148.115
2025-02-09 04:08:08.019 DEBUG [src.node.docker_mananger] Generated ports ['52322', '52323', '52324', '52325', '52326']
2025-02-09 04:08:08.019 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:08:08.019 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:08:08.019 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:08:08.020 DEBUG [src.node.docker_mananger] docker run -i -t -p 52322:52322 -p 52323:52323 -p 52324:52324 -p 52325:52325 -p 52326:52326 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52324 --rest-port=52322 --tcp-port=52323 --discv5-udp-port=52325 --rest-address=0.0.0.0 --nat=extip:172.18.148.115 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cfdc7bfdeee6a617e4cbeb90724dfaae22cbf13b32ebb96cbfbda4cefc78ee8c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52326 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QIUqo-Izr01vXfBrCwZu310_IWcN0BqUxuoaYnNN6yBASdLPZcF_RISVlGzPElr6nw1jCZpYuh1lN7JBK5UZtVkCgmlkgnY0gmlwhKwSUV6KbXVsdGlhZGRyc5YACASsElFeBtDoAAoErBJRXgbQ6d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDi0VHyO3ycm_6X-W55EMZnYyy0fUPlicmGBPt1VxrA-qDdGNwgtDog3VkcILQ6oV3YWt1Mgs --storenode=/ip4/172.18.81.94/tcp/53480/p2p/16Uiu2HAmN2eHvS6LayfhRsShwd63NfndbMCL83PkCMUBVZytJYy7 --store=false --relay=false --lightpush=true --lightpushnode=/ip4/172.18.81.94/tcp/53480/p2p/16Uiu2HAmN2eHvS6LayfhRsShwd63NfndbMCL83PkCMUBVZytJYy7
2025-02-09 04:08:08.260 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.148.115 waku 36f14715249cdf068c952e6cb55317a1c68e2bb885fea9c3c53d4962a889e97f
2025-02-09 04:08:08.308 DEBUG [src.node.docker_mananger] Container started with ID 36f14715249c. Setting up logs at ./log/docker/store_node1_2025-02-09_04-08-05__1628af3e-512e-4f27-8279-7dce19985f04__wakuorg_nwaku:latest.log
2025-02-09 04:08:08.308 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 52322
2025-02-09 04:08:08.309 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:08:09.310 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:52322/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:09.312 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:08:09.313 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:08:09.313 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:52322/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:09.315 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.148.115/tcp/52323/p2p/16Uiu2HAmL8WGfkN3LAEAicdReXybMjJsj3kfzzEpaShrFZKqtsvQ","/ip4/172.18.148.115/tcp/52324/ws/p2p/16Uiu2HAmL8WGfkN3LAEAicdReXybMjJsj3kfzzEpaShrFZKqtsvQ"],"enrUri":"enr:-L24QJvZ7BuV2ZBAtvNxXuywH1KWlc8-b2qSfOLs_yFbgKzdP0uNzgOYL09cn3gb4aGr1dwk3gxRVIdtdEdAzhHV7poCgmlkgnY0gmlwhKwSlHOKbXVsdGlhZGRyc5YACASsEpRzBsxjAAoErBKUcwbMZN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDbw5SRByyzsIZl2bMN4g6YYnokE8mY40CBfbdrf1Fo1mDdGNwgsxjg3VkcILMZYV3YWt1Mgg"}'
2025-02-09 04:08:09.315 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:08:09.316 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:52322/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.81.94/tcp/53480/p2p/16Uiu2HAmN2eHvS6LayfhRsShwd63NfndbMCL83PkCMUBVZytJYy7"]'
2025-02-09 04:08:09.353 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:09.353 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:52322/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.133.159/tcp/59388/p2p/16Uiu2HAkwcjqe824m2vVzk3QUmXEWyfJnvMRF4bFyNeK1uKxsCLy"]'
2025-02-09 04:08:09.380 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:09.382 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53479/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-09 04:08:09.389 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:09.390 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59387/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-09 04:08:09.394 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:09.395 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:52322/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739074089395054336}}'
2025-02-09 04:08:09.407 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:08:09.407 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-09 04:08:09.608 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-09 04:08:09.608 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53479/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:09.612 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x30d7bf73dd6dcccb4f6a17a7845d2d20ed6f3d08f5cc36d53772f6347599cc7e"}]}'
2025-02-09 04:08:09.612 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-09 04:08:09.613 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:52322/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:08:09.620 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"774108d579dd2bc581ef","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x30d7bf73dd6dcccb4f6a17a7845d2d20ed6f3d08f5cc36d53772f6347599cc7e"}]}'
2025-02-09 04:08:09.622 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:08:09.623 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:08:09.623 DEBUG [src.node.waku_node] Stopping container with id 4a493612d0a8
2025-02-09 04:08:10.210 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:08:10.210 DEBUG [src.node.waku_node] Stopping container with id dc8732c91442
2025-02-09 04:08:11.024 ERROR [src.node.docker_mananger] Max retries reached for container 4a493612d0a8. Exiting log stream.
2025-02-09 04:08:11.742 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:08:11.743 DEBUG [src.node.waku_node] Stopping container with id 36f14715249c
2025-02-09 04:08:12.556 ERROR [src.node.docker_mananger] Max retries reached for container dc8732c91442. Exiting log stream.
2025-02-09 04:08:13.252 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:08:13.253 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:08:13.261 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:08:13.268 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:08:13.273 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
