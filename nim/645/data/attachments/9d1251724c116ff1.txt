2025-02-09 04:05:08.311 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 04:05:08.312 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_content_topic_from_same_shard with id: 2025-02-09_04-05-08__6a23a821-6b25-4547-90e0-d44149835af2
2025-02-09 04:05:08.312 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 04:05:08.312 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 04:05:08.313 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-09 04:05:08.319 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:05:08.319 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_04-05-08__6a23a821-6b25-4547-90e0-d44149835af2__wakuorg_nwaku:latest.log
2025-02-09 04:05:08.319 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:05:08.319 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:05:08.329 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:05:08.330 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.206.89
2025-02-09 04:05:08.330 DEBUG [src.node.docker_mananger] Generated ports ['47305', '47306', '47307', '47308', '47309']
2025-02-09 04:05:08.330 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:05:08.330 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:05:08.330 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:05:08.330 DEBUG [src.node.docker_mananger] docker run -i -t -p 47305:47305 -p 47306:47306 -p 47307:47307 -p 47308:47308 -p 47309:47309 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47307 --rest-port=47305 --tcp-port=47306 --discv5-udp-port=47308 --rest-address=0.0.0.0 --nat=extip:172.18.206.89 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=02a47df48d7d8ddaaca7bd797ceac6d4e9db8bfc3b33bb1cebbe47e01a7cc816 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47309 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-09 04:05:08.547 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.206.89 waku 971eb60b5ef0b1d2c60a85f1e96cdacb5a0cc929328eb1fc82c3cad65304abdb
2025-02-09 04:05:08.597 DEBUG [src.node.docker_mananger] Container started with ID 971eb60b5ef0. Setting up logs at ./log/docker/node1_2025-02-09_04-05-08__6a23a821-6b25-4547-90e0-d44149835af2__wakuorg_nwaku:latest.log
2025-02-09 04:05:08.598 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47305
2025-02-09 04:05:08.599 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:05:09.110 ERROR [src.node.docker_mananger] Max retries reached for container c5047eba124b. Exiting log stream.
2025-02-09 04:05:09.599 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47305/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:09.602 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:05:09.602 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:05:09.602 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47305/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:09.605 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.206.89/tcp/47306/p2p/16Uiu2HAm6qSBk7ABFHYhyhZKHKB7h5Bc6ZhKu1ePAsesTGQpSexr","/ip4/172.18.206.89/tcp/47307/ws/p2p/16Uiu2HAm6qSBk7ABFHYhyhZKHKB7h5Bc6ZhKu1ePAsesTGQpSexr"],"enrUri":"enr:-L24QLWOOIj6M-96vZ0AJ6sDfdfyexLJ2D8Frmak1yjH0rOBTy9qjiDDw2hts3MO-hTrISk_X70_jW5znMqklUVcIEoCgmlkgnY0gmlwhKwSzlmKbXVsdGlhZGRyc5YACASsEs5ZBrjKAAoErBLOWQa4y90DgnJzhQACAQAAiXNlY3AyNTZrMaECqYbmEz1R9VFUZ5JrKnTTZkHnbKcv6h2XvG1xnTbSitODdGNwgrjKg3VkcIK4zIV3YWt1MgU"}'
2025-02-09 04:05:09.605 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:05:09.611 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 04:05:09.611 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_04-05-08__6a23a821-6b25-4547-90e0-d44149835af2__wakuorg_nwaku:latest.log
2025-02-09 04:05:09.612 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 04:05:09.612 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 04:05:09.613 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 04:05:09.613 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.188.36
2025-02-09 04:05:09.613 DEBUG [src.node.docker_mananger] Generated ports ['47210', '47211', '47212', '47213', '47214']
2025-02-09 04:05:09.614 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 04:05:09.614 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 04:05:09.614 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 04:05:09.614 DEBUG [src.node.docker_mananger] docker run -i -t -p 47210:47210 -p 47211:47211 -p 47212:47212 -p 47213:47213 -p 47214:47214 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47212 --rest-port=47210 --tcp-port=47211 --discv5-udp-port=47213 --rest-address=0.0.0.0 --nat=extip:172.18.188.36 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=1328c9aba52deb6ab98b4bbcda4cffe0b7d5acc8ecbdf7b5dacb1b01afac19ac --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47214 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QLWOOIj6M-96vZ0AJ6sDfdfyexLJ2D8Frmak1yjH0rOBTy9qjiDDw2hts3MO-hTrISk_X70_jW5znMqklUVcIEoCgmlkgnY0gmlwhKwSzlmKbXVsdGlhZGRyc5YACASsEs5ZBrjKAAoErBLOWQa4y90DgnJzhQACAQAAiXNlY3AyNTZrMaECqYbmEz1R9VFUZ5JrKnTTZkHnbKcv6h2XvG1xnTbSitODdGNwgrjKg3VkcIK4zIV3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-09 04:05:09.842 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.188.36 waku c8c7f525336a535f0539d6059c72f9253e0fd1496e986288dc9dbf22d691e008
2025-02-09 04:05:09.889 DEBUG [src.node.docker_mananger] Container started with ID c8c7f525336a. Setting up logs at ./log/docker/node2_2025-02-09_04-05-08__6a23a821-6b25-4547-90e0-d44149835af2__wakuorg_nwaku:latest.log
2025-02-09 04:05:09.890 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47210
2025-02-09 04:05:09.890 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 04:05:10.890 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47210/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:10.897 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 04:05:10.899 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 04:05:10.900 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47210/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:10.905 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.188.36/tcp/47211/p2p/16Uiu2HAmFP2RsRABwydaxsEpRTZyxjgaNj3bV4NARSA9UyzadAg2","/ip4/172.18.188.36/tcp/47212/ws/p2p/16Uiu2HAmFP2RsRABwydaxsEpRTZyxjgaNj3bV4NARSA9UyzadAg2"],"enrUri":"enr:-L24QDhOP9kRieZc2QBLgcohSYOl8vgXyeedmgx2_wRHPMHmX5HMvsoX_glJR5vUZTD1KuHdqZqq9U-FqO1111tp94kCgmlkgnY0gmlwhKwSvCSKbXVsdGlhZGRyc5YACASsErwkBrhrAAoErBK8JAa4bN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDKHweWBKRrXmNZBW7PDez2M2dNvOpvjS2wlRhK6HXy-uDdGNwgrhrg3VkcIK4bYV3YWt1MgE"}'
2025-02-09 04:05:10.906 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 04:05:10.906 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47210/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.206.89/tcp/47306/p2p/16Uiu2HAm6qSBk7ABFHYhyhZKHKB7h5Bc6ZhKu1ePAsesTGQpSexr"]'
2025-02-09 04:05:10.911 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:10.912 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47305/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2025-02-09 04:05:10.916 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:10.916 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47210/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2025-02-09 04:05:10.921 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:10.922 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47305/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/newsService/1.0/weekly/protobuf", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:05:10.927 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:10.928 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:05:11.029 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:05:11.029 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47305/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:11.031 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1739073910921954304,"ephemeral":false}]'
2025-02-09 04:05:11.033 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:05:11.033 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47210/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:11.035 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1739073910921954304,"ephemeral":false}]'
2025-02-09 04:05:11.037 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47305/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 04:05:11.042 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 04:05:11.043 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 04:05:11.143 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 04:05:11.144 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47305/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:11.146 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739073911037211136,"ephemeral":false}]'
2025-02-09 04:05:11.147 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-09 04:05:11.148 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47210/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-09 04:05:11.150 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739073911037211136,"ephemeral":false}]'
2025-02-09 04:05:11.152 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 04:05:11.153 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 04:05:11.153 DEBUG [src.node.waku_node] Stopping container with id 971eb60b5ef0
2025-02-09 04:05:12.058 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:05:12.058 DEBUG [src.node.waku_node] Stopping container with id c8c7f525336a
2025-02-09 04:05:12.870 ERROR [src.node.docker_mananger] Max retries reached for container 971eb60b5ef0. Exiting log stream.
2025-02-09 04:05:13.547 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 04:05:13.548 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 04:05:13.554 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 04:05:13.559 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
