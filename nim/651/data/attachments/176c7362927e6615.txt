2025-02-14 04:06:24.223 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 04:06:24.224 DEBUG [tests.conftest] Running test: test_pubsub_topic_not_in_docker_flags with id: 2025-02-14_04-06-24__cc518bf1-bbcc-445c-b0e6-ecf462c17521
2025-02-14 04:06:24.224 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 04:06:24.224 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 04:06:24.224 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-14 04:06:24.231 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:06:24.232 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_04-06-24__cc518bf1-bbcc-445c-b0e6-ecf462c17521__wakuorg_nwaku:latest.log
2025-02-14 04:06:24.232 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:06:24.232 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:06:24.233 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:06:24.234 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.150.203
2025-02-14 04:06:24.234 DEBUG [src.node.docker_mananger] Generated ports ['40134', '40135', '40136', '40137', '40138']
2025-02-14 04:06:24.234 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:06:24.234 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:06:24.234 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:06:24.234 DEBUG [src.node.docker_mananger] docker run -i -t -p 40134:40134 -p 40135:40135 -p 40136:40136 -p 40137:40137 -p 40138:40138 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40136 --rest-port=40134 --tcp-port=40135 --discv5-udp-port=40137 --rest-address=0.0.0.0 --nat=extip:172.18.150.203 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=2d4da9deb18af7fac812bccfef78f3f2b06b29dfaf31c918c713ca1c319f0bab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40138 --metrics-logging=true --relay=true --filter=true
2025-02-14 04:06:24.459 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.150.203 waku 737369c032929334909f56898838b1318169e5856726af8ec6b3cd3aa1120f02
2025-02-14 04:06:24.508 DEBUG [src.node.docker_mananger] Container started with ID 737369c03292. Setting up logs at ./log/docker/node1_2025-02-14_04-06-24__cc518bf1-bbcc-445c-b0e6-ecf462c17521__wakuorg_nwaku:latest.log
2025-02-14 04:06:24.508 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40134
2025-02-14 04:06:24.508 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:06:25.031 ERROR [src.node.docker_mananger] Max retries reached for container 9c97e7a7bcef. Exiting log stream.
2025-02-14 04:06:25.509 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40134/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:06:25.512 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:06:25.512 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:06:25.512 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40134/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:06:25.514 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.150.203/tcp/40135/p2p/16Uiu2HAmJxe9iQJn44s7UNCrw7R3LA4wbDDR4evHQ1NBQQUtB2gU","/ip4/172.18.150.203/tcp/40136/ws/p2p/16Uiu2HAmJxe9iQJn44s7UNCrw7R3LA4wbDDR4evHQ1NBQQUtB2gU"],"enrUri":"enr:-L24QM_u6HRZscCy-EU6Ut21kDI8fQnVwz5EVBXmwiekuWtQFHnn-XiT8zAjJzVyJMeImJB5b-hLdVJ20ENBs6xu3CMCgmlkgnY0gmlwhKwSlsuKbXVsdGlhZGRyc5YACASsEpbLBpzHAAoErBKWywacyN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDXau8hCZKf6LcOaXSb9XCP2d9EPJaq7ME5YZ6CSBmgvWDdGNwgpzHg3VkcIKcyYV3YWt1MgU"}'
2025-02-14 04:06:25.515 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:06:25.521 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:06:25.522 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-14_04-06-24__cc518bf1-bbcc-445c-b0e6-ecf462c17521__wakuorg_nwaku:latest.log
2025-02-14 04:06:25.522 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:06:25.522 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:06:25.523 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:06:25.523 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.231.43
2025-02-14 04:06:25.523 DEBUG [src.node.docker_mananger] Generated ports ['34141', '34142', '34143', '34144', '34145']
2025-02-14 04:06:25.524 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:06:25.524 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:06:25.524 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:06:25.524 DEBUG [src.node.docker_mananger] docker run -i -t -p 34141:34141 -p 34142:34142 -p 34143:34143 -p 34144:34144 -p 34145:34145 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34143 --rest-port=34141 --tcp-port=34142 --discv5-udp-port=34144 --rest-address=0.0.0.0 --nat=extip:172.18.231.43 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a29ee3e5aa6da2b95c790ba56f6ebf8b2b3df65bcec6e20eadadefdb56cdc4d1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34145 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QM_u6HRZscCy-EU6Ut21kDI8fQnVwz5EVBXmwiekuWtQFHnn-XiT8zAjJzVyJMeImJB5b-hLdVJ20ENBs6xu3CMCgmlkgnY0gmlwhKwSlsuKbXVsdGlhZGRyc5YACASsEpbLBpzHAAoErBKWywacyN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDXau8hCZKf6LcOaXSb9XCP2d9EPJaq7ME5YZ6CSBmgvWDdGNwgpzHg3VkcIKcyYV3YWt1MgU
2025-02-14 04:06:25.759 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.231.43 waku 762c568d27fcc2d2f55f43b7f92b348c510ec70b8d0ea40bdff3ebca30206b69
2025-02-14 04:06:25.807 DEBUG [src.node.docker_mananger] Container started with ID 762c568d27fc. Setting up logs at ./log/docker/node2_2025-02-14_04-06-24__cc518bf1-bbcc-445c-b0e6-ecf462c17521__wakuorg_nwaku:latest.log
2025-02-14 04:06:25.808 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 34141
2025-02-14 04:06:25.808 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:06:26.808 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34141/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:06:26.825 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:06:26.829 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:06:26.831 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34141/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:06:26.835 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.231.43/tcp/34142/p2p/16Uiu2HAmUUBH3L4mNVuQn6p1LzL2KqpKk9VTccStvu9D4TmXPJXA","/ip4/172.18.231.43/tcp/34143/ws/p2p/16Uiu2HAmUUBH3L4mNVuQn6p1LzL2KqpKk9VTccStvu9D4TmXPJXA"],"enrUri":"enr:-L24QPBLBXopMfe9_Ky90Ykq-QspXlS3lK7EyZ6RaQx3s1YsJhuOJbgQvDgh6Ma-nPyWr_Awa9VW_HuDfXaFCcdftEICgmlkgnY0gmlwhKwS5yuKbXVsdGlhZGRyc5YACASsEucrBoVeAAoErBLnKwaFX90DgnJzhQACAQAAiXNlY3AyNTZrMaED6vX08sY3dLma2s5hkjMvfvDMvEbrfoI22TKJZlJWywmDdGNwgoVeg3VkcIKFYIV3YWt1MgE"}'
2025-02-14 04:06:26.835 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:06:26.836 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34141/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.150.203/tcp/40135/p2p/16Uiu2HAmJxe9iQJn44s7UNCrw7R3LA4wbDDR4evHQ1NBQQUtB2gU"]'
2025-02-14 04:06:26.838 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:06:26.839 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40134/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-14 04:06:26.841 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:06:26.842 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34141/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-14 04:06:26.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:06:26.844 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40134/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:06:26.849 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:06:26.849 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 04:06:26.950 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 04:06:26.950 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40134/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:06:26.953 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739505986844637696,"ephemeral":false}]'
2025-02-14 04:06:26.954 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-14 04:06:26.955 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34141/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:06:26.957 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739505986844637696,"ephemeral":false}]'
2025-02-14 04:06:26.960 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 04:06:26.961 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 04:06:26.961 DEBUG [src.node.waku_node] Stopping container with id 737369c03292
2025-02-14 04:06:27.990 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:06:27.990 DEBUG [src.node.waku_node] Stopping container with id 762c568d27fc
2025-02-14 04:06:28.802 ERROR [src.node.docker_mananger] Max retries reached for container 737369c03292. Exiting log stream.
2025-02-14 04:06:29.178 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:06:29.180 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 04:06:29.185 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 04:06:29.189 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
