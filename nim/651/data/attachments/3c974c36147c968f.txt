2025-02-14 04:03:02.458 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 04:03:02.459 DEBUG [tests.conftest] Running test: test_metrics_after_filter_get with id: 2025-02-14_04-03-02__0233030c-e62b-4982-9bea-e9206fa59ae0
2025-02-14 04:03:02.460 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 04:03:02.460 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-14 04:03:02.460 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-14 04:03:02.460 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 04:03:02.461 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-14 04:03:02.461 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-14 04:03:02.468 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:03:02.468 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_04-03-02__0233030c-e62b-4982-9bea-e9206fa59ae0__wakuorg_nwaku:latest.log
2025-02-14 04:03:02.468 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:03:02.468 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:03:02.469 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:03:02.469 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.68.213
2025-02-14 04:03:02.470 DEBUG [src.node.docker_mananger] Generated ports ['16077', '16078', '16079', '16080', '16081']
2025-02-14 04:03:02.470 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:03:02.470 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:03:02.470 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:03:02.470 DEBUG [src.node.docker_mananger] docker run -i -t -p 16077:16077 -p 16078:16078 -p 16079:16079 -p 16080:16080 -p 16081:16081 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16079 --rest-port=16077 --tcp-port=16078 --discv5-udp-port=16080 --rest-address=0.0.0.0 --nat=extip:172.18.68.213 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6cecb92c74cbaa21f9dd1bd20c4faeec4f17eda510b6bcc415b3bd20a27afa1b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16081 --metrics-logging=true --relay=true --filter=true
2025-02-14 04:03:02.703 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.68.213 waku 1ba383397d396aa7982adee74057a68fe11c18423a6dfe12870621a140fdf3b4
2025-02-14 04:03:02.752 DEBUG [src.node.docker_mananger] Container started with ID 1ba383397d39. Setting up logs at ./log/docker/node1_2025-02-14_04-03-02__0233030c-e62b-4982-9bea-e9206fa59ae0__wakuorg_nwaku:latest.log
2025-02-14 04:03:02.753 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16077
2025-02-14 04:03:02.753 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:03:03.276 ERROR [src.node.docker_mananger] Max retries reached for container 778e31116613. Exiting log stream.
2025-02-14 04:03:03.754 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16077/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:03:03.757 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:03:03.757 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:03:03.757 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16077/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:03:03.759 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.68.213/tcp/16078/p2p/16Uiu2HAkxmsSDEg9z7BphuXgW4zfSouUmf1h17fqXxwSJzWhDbcv","/ip4/172.18.68.213/tcp/16079/ws/p2p/16Uiu2HAkxmsSDEg9z7BphuXgW4zfSouUmf1h17fqXxwSJzWhDbcv"],"enrUri":"enr:-L24QJ-0-1WA6V0Xi_2qxrw69aiBBkID4I1mEvkHFxZBt_NEe182EscGJ8FIV9khuBeKoANn-Aq5Y7l8zLM2x3PZexwCgmlkgnY0gmlwhKwSRNWKbXVsdGlhZGRyc5YACASsEkTVBj7OAAoErBJE1QY-z90DgnJzhQADAQAAiXNlY3AyNTZrMaECMb-hNWo1URSM-E-Zkk88KsF7UIf-0YeRijdiJoDoFiuDdGNwgj7Og3VkcII-0IV3YWt1MgU"}'
2025-02-14 04:03:03.759 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:03:03.760 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-14 04:03:03.766 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:03:03.766 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-14_04-03-02__0233030c-e62b-4982-9bea-e9206fa59ae0__wakuorg_nwaku:latest.log
2025-02-14 04:03:03.766 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:03:03.766 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:03:03.768 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:03:03.768 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.111.41
2025-02-14 04:03:03.768 DEBUG [src.node.docker_mananger] Generated ports ['5979', '5980', '5981', '5982', '5983']
2025-02-14 04:03:03.768 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:03:03.768 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:03:03.768 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:03:03.768 DEBUG [src.node.docker_mananger] docker run -i -t -p 5979:5979 -p 5980:5980 -p 5981:5981 -p 5982:5982 -p 5983:5983 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5981 --rest-port=5979 --tcp-port=5980 --discv5-udp-port=5982 --rest-address=0.0.0.0 --nat=extip:172.18.111.41 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fa3a2f704ce9a2dd0f05882ee6f5fafdc40232bba8bf96f3ddb7d51b25a11c89 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5983 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QJ-0-1WA6V0Xi_2qxrw69aiBBkID4I1mEvkHFxZBt_NEe182EscGJ8FIV9khuBeKoANn-Aq5Y7l8zLM2x3PZexwCgmlkgnY0gmlwhKwSRNWKbXVsdGlhZGRyc5YACASsEkTVBj7OAAoErBJE1QY-z90DgnJzhQADAQAAiXNlY3AyNTZrMaECMb-hNWo1URSM-E-Zkk88KsF7UIf-0YeRijdiJoDoFiuDdGNwgj7Og3VkcII-0IV3YWt1MgU --filternode=/ip4/172.18.68.213/tcp/16078/p2p/16Uiu2HAkxmsSDEg9z7BphuXgW4zfSouUmf1h17fqXxwSJzWhDbcv
2025-02-14 04:03:03.993 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.111.41 waku 9a77068a20b9083a66274889fff4863d40956592b57c2d4b609594fd9ddc19b6
2025-02-14 04:03:04.037 DEBUG [src.node.docker_mananger] Container started with ID 9a77068a20b9. Setting up logs at ./log/docker/node2_2025-02-14_04-03-02__0233030c-e62b-4982-9bea-e9206fa59ae0__wakuorg_nwaku:latest.log
2025-02-14 04:03:04.038 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 5979
2025-02-14 04:03:04.038 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:03:05.038 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5979/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:03:05.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:03:05.041 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:03:05.042 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5979/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:03:05.044 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.111.41/tcp/5980/p2p/16Uiu2HAm41dcw7tHUCsfqx9uZMwsqmMeV4QDbYCygMoea623vwcF","/ip4/172.18.111.41/tcp/5981/ws/p2p/16Uiu2HAm41dcw7tHUCsfqx9uZMwsqmMeV4QDbYCygMoea623vwcF"],"enrUri":"enr:-L24QI3fuKUbc7HGgQCvlfR2ipHVL5eb1_k58Vs4eBXRX6MMERYEGY_IY20YmX0dgjpC2j7h9shvr9-v_DCjwV6GBPICgmlkgnY0gmlwhKwSbymKbXVsdGlhZGRyc5YACASsEm8pBhdcAAoErBJvKQYXXd0DgnJzhQADAQAAiXNlY3AyNTZrMaECf5CTKcY2R5fzqzTz8FUum6wWRGeih3OFdvwbdMjvGlyDdGNwghdcg3VkcIIXXoV3YWt1MgA"}'
2025-02-14 04:03:05.044 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:03:05.044 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5979/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.68.213/tcp/16078/p2p/16Uiu2HAkxmsSDEg9z7BphuXgW4zfSouUmf1h17fqXxwSJzWhDbcv"]'
2025-02-14 04:03:05.079 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:03:05.081 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-14 04:03:05.081 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16077/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 04:03:05.103 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:03:05.106 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5979/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "4ab30098-e51e-47f4-a783-909d607993f9", "contentFilters": ["/test/1/waku-relay/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-14 04:03:05.116 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"4ab30098-e51e-47f4-a783-909d607993f9","statusDesc":"OK"}'
2025-02-14 04:03:05.117 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16077/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:03:05.124 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:03:05.124 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-14 04:03:05.625 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5979/filter/v2/messages/%2Ftest%2F1%2Fwaku-relay%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:03:05.628 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739505785117428480,"ephemeral":false}]'
2025-02-14 04:03:05.628 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-14 04:03:10.629 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-14 04:03:10.632 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 1.0
2025-02-14 04:03:10.633 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-14 04:03:10.636 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 1.0
2025-02-14 04:03:10.636 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-14 04:03:10.639 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-14 04:03:10.639 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-14 04:03:10.643 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-14 04:03:10.643 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-14 04:03:10.646 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 1.0
2025-02-14 04:03:10.646 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-14 04:03:10.649 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-14 04:03:10.649 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-14 04:03:10.652 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-14 04:03:10.652 DEBUG [src.steps.metrics] Checking metric: waku_filter_requests{type="SUBSCRIBE"} has 1
2025-02-14 04:03:10.655 DEBUG [src.steps.metrics] Found metric: waku_filter_requests{type="SUBSCRIBE"} with value 1.0
2025-02-14 04:03:10.655 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/filter-subscribe/2.0.0-beta1",peerId="/ip4/172.18.68.213/tcp/16078"} has 1
2025-02-14 04:03:10.658 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/filter-subscribe/2.0.0-beta1",peerId="/ip4/172.18.68.213/tcp/16078"} with value 1.0
2025-02-14 04:03:10.659 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-14 04:03:10.662 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 1.0
2025-02-14 04:03:10.662 DEBUG [src.steps.metrics] Checking metric: libp2p_total_dial_attempts_total has 1
2025-02-14 04:03:10.665 DEBUG [src.steps.metrics] Found metric: libp2p_total_dial_attempts_total with value 1.0
2025-02-14 04:03:10.665 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-14 04:03:10.667 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 1.0
2025-02-14 04:03:10.670 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 04:03:10.671 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 04:03:10.671 DEBUG [src.node.waku_node] Stopping container with id 1ba383397d39
2025-02-14 04:03:11.873 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:03:11.874 DEBUG [src.node.waku_node] Stopping container with id 9a77068a20b9
2025-02-14 04:03:12.703 ERROR [src.node.docker_mananger] Max retries reached for container 1ba383397d39. Exiting log stream.
2025-02-14 04:03:12.966 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:03:12.967 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 04:03:12.977 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 04:03:12.981 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
