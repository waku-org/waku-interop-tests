2025-02-14 04:03:59.352 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 04:03:59.353 DEBUG [tests.conftest] Running test: test_cursor_pointing_to_deleted_message with id: 2025-02-14_04-03-59__c98262fc-f6e8-4482-8400-62fbdf36d7bf
2025-02-14 04:03:59.353 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 04:03:59.353 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-14 04:03:59.353 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-14 04:03:59.360 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:03:59.360 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-14_04-03-59__c98262fc-f6e8-4482-8400-62fbdf36d7bf__wakuorg_nwaku:latest.log
2025-02-14 04:03:59.360 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:03:59.360 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:03:59.361 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:03:59.362 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.152.228
2025-02-14 04:03:59.362 DEBUG [src.node.docker_mananger] Generated ports ['36580', '36581', '36582', '36583', '36584']
2025-02-14 04:03:59.362 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:03:59.362 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:03:59.362 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:03:59.362 DEBUG [src.node.docker_mananger] docker run -i -t -p 36580:36580 -p 36581:36581 -p 36582:36582 -p 36583:36583 -p 36584:36584 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36582 --rest-port=36580 --tcp-port=36581 --discv5-udp-port=36583 --rest-address=0.0.0.0 --nat=extip:172.18.152.228 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=98caaabcdace1baabd4fefbe3a5b8af9cdde7e22bafd13cbd9d6cf9ee96a90f9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36584 --metrics-logging=true --store=true --relay=true
2025-02-14 04:03:59.600 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.152.228 waku 6c38145ec32b35365b477d52672ba8b6f29b4ba282d7e20c069cf896a8b83a69
2025-02-14 04:03:59.651 DEBUG [src.node.docker_mananger] Container started with ID 6c38145ec32b. Setting up logs at ./log/docker/publishing_node1_2025-02-14_04-03-59__c98262fc-f6e8-4482-8400-62fbdf36d7bf__wakuorg_nwaku:latest.log
2025-02-14 04:03:59.653 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36580
2025-02-14 04:03:59.653 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:04:00.155 ERROR [src.node.docker_mananger] Max retries reached for container 14489797ba13. Exiting log stream.
2025-02-14 04:04:00.654 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36580/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:04:00.657 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:04:00.657 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:04:00.657 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36580/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:04:00.659 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.152.228/tcp/36581/p2p/16Uiu2HAmVCWwMYmL9JSnJSauM8ZbmdzU7rJYxmWkryY2EmyzZbJ8","/ip4/172.18.152.228/tcp/36582/ws/p2p/16Uiu2HAmVCWwMYmL9JSnJSauM8ZbmdzU7rJYxmWkryY2EmyzZbJ8"],"enrUri":"enr:-L24QO6NqUhFNs2olNhEne5TqXFHtBFe6XFeg27Rx6v6AirYZHOpdTeirkiOHY0wrFxWUgsrFJKeM-kBwGhlqPTv0ZoCgmlkgnY0gmlwhKwSmOSKbXVsdGlhZGRyc5YACASsEpjkBo7lAAoErBKY5AaO5t0DgnJzhQADAQAAiXNlY3AyNTZrMaED9c6Uw4jyYwuY4SwBISZ75CS4iLEBiXRKxwsWP-CmxbmDdGNwgo7lg3VkcIKO54V3YWt1MgM"}'
2025-02-14 04:04:00.660 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:04:00.666 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:04:00.666 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-14_04-03-59__c98262fc-f6e8-4482-8400-62fbdf36d7bf__wakuorg_nwaku:latest.log
2025-02-14 04:04:00.667 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:04:00.667 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:04:00.668 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:04:00.668 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.230.192
2025-02-14 04:04:00.668 DEBUG [src.node.docker_mananger] Generated ports ['65332', '65333', '65334', '65335', '65336']
2025-02-14 04:04:00.668 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:04:00.668 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:04:00.669 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:04:00.669 DEBUG [src.node.docker_mananger] docker run -i -t -p 65332:65332 -p 65333:65333 -p 65334:65334 -p 65335:65335 -p 65336:65336 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65334 --rest-port=65332 --tcp-port=65333 --discv5-udp-port=65335 --rest-address=0.0.0.0 --nat=extip:172.18.230.192 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d189ffbcdb2ec1c80ac803abbb4a9ce1bf8e2e8b0bed1f801b5a9b7e6f9e1ce7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65336 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QO6NqUhFNs2olNhEne5TqXFHtBFe6XFeg27Rx6v6AirYZHOpdTeirkiOHY0wrFxWUgsrFJKeM-kBwGhlqPTv0ZoCgmlkgnY0gmlwhKwSmOSKbXVsdGlhZGRyc5YACASsEpjkBo7lAAoErBKY5AaO5t0DgnJzhQADAQAAiXNlY3AyNTZrMaED9c6Uw4jyYwuY4SwBISZ75CS4iLEBiXRKxwsWP-CmxbmDdGNwgo7lg3VkcIKO54V3YWt1MgM --storenode=/ip4/172.18.152.228/tcp/36581/p2p/16Uiu2HAmVCWwMYmL9JSnJSauM8ZbmdzU7rJYxmWkryY2EmyzZbJ8 --store=true --relay=true
2025-02-14 04:04:00.894 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.230.192 waku c7f0a67c400719b3377991eb8f9458209f2c4ad58cdcc66fd8245ab83fc9e87a
2025-02-14 04:04:00.940 DEBUG [src.node.docker_mananger] Container started with ID c7f0a67c4007. Setting up logs at ./log/docker/store_node1_2025-02-14_04-03-59__c98262fc-f6e8-4482-8400-62fbdf36d7bf__wakuorg_nwaku:latest.log
2025-02-14 04:04:00.940 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 65332
2025-02-14 04:04:00.940 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:04:01.941 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65332/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:04:01.944 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:04:01.944 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:04:01.944 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65332/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:04:01.946 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.230.192/tcp/65333/p2p/16Uiu2HAmCxZTwzjYUVZxV69eiYfBMf1dvSZQ18552T8nHcaZNW9L","/ip4/172.18.230.192/tcp/65334/ws/p2p/16Uiu2HAmCxZTwzjYUVZxV69eiYfBMf1dvSZQ18552T8nHcaZNW9L"],"enrUri":"enr:-L24QCVFp1n-qcqMwvMAq3I1EtrihANtIFEBGuHT6c_fE8WoDwI3vq0R4Vlm1XF_Z1gjLiheNTmQdeg0EXP5riq3ID8CgmlkgnY0gmlwhKwS5sCKbXVsdGlhZGRyc5YACASsEubABv81AAoErBLmwAb_Nt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDBIBRGU4Up_SFf7Y_mzzkFL5HvJWyV443ct4SsUUSZZ-DdGNwgv81g3VkcIL_N4V3YWt1MgM"}'
2025-02-14 04:04:01.947 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:04:01.947 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65332/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.152.228/tcp/36581/p2p/16Uiu2HAmVCWwMYmL9JSnJSauM8ZbmdzU7rJYxmWkryY2EmyzZbJ8"]'
2025-02-14 04:04:01.950 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:01.950 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-14 04:04:01.952 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:01.953 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65332/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-14 04:04:01.955 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:01.956 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:01.956 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8w", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:01.962 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:01.962 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:02.163 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:02.163 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8x", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:02.169 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:02.170 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:02.371 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:02.371 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8y", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:02.378 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:02.378 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:02.579 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:02.579 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8z", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:02.585 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:02.586 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:02.787 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:02.787 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV80", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:02.793 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:02.793 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:02.994 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:02.994 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV81", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:03.001 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:03.001 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:03.202 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:03.202 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV82", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:03.209 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:03.210 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:03.410 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:03.411 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV83", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:03.418 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:03.418 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:03.619 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:03.619 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV84", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:03.625 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:03.626 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:03.826 DEBUG [src.steps.store] Relaying message
2025-02-14 04:04:03.827 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36580/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV85", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 04:04:03.833 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:04:03.833 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-14 04:04:04.034 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36580/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x9c066c7d52b7f257a3b86a56cca08ffb6c3878d8c919c7f2dcbe59ef62a2d3f0&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:04:04.037 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:36580/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x9c066c7d52b7f257a3b86a56cca08ffb6c3878d8c919c7f2dcbe59ef62a2d3f0&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found'
2025-02-14 04:04:04.038 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65332/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x9c066c7d52b7f257a3b86a56cca08ffb6c3878d8c919c7f2dcbe59ef62a2d3f0&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:04:04.040 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:65332/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x9c066c7d52b7f257a3b86a56cca08ffb6c3878d8c919c7f2dcbe59ef62a2d3f0&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found'
2025-02-14 04:04:04.042 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 04:04:04.043 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 04:04:04.043 DEBUG [src.node.waku_node] Stopping container with id 6c38145ec32b
2025-02-14 04:04:05.087 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:04:05.087 DEBUG [src.node.waku_node] Stopping container with id c7f0a67c4007
2025-02-14 04:04:05.919 ERROR [src.node.docker_mananger] Max retries reached for container 6c38145ec32b. Exiting log stream.
2025-02-14 04:04:06.557 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:04:06.558 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 04:04:06.572 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 04:04:06.580 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
