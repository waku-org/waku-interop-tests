2025-02-14 04:05:15.009 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 04:05:15.010 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-14_04-05-15__13cbd446-553f-4beb-8347-8e4e3379415f
2025-02-14 04:05:15.010 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 04:05:15.010 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-14 04:05:15.010 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-14 04:05:15.011 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 04:05:15.011 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-14 04:05:15.017 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:05:15.017 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-14_04-05-15__13cbd446-553f-4beb-8347-8e4e3379415f__wakuorg_nwaku:latest.log
2025-02-14 04:05:15.018 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:05:15.018 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:05:15.019 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:05:15.019 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.13.3
2025-02-14 04:05:15.020 DEBUG [src.node.docker_mananger] Generated ports ['46130', '46131', '46132', '46133', '46134']
2025-02-14 04:05:15.020 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:05:15.020 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:05:15.020 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:05:15.020 DEBUG [src.node.docker_mananger] docker run -i -t -p 46130:46130 -p 46131:46131 -p 46132:46132 -p 46133:46133 -p 46134:46134 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46132 --rest-port=46130 --tcp-port=46131 --discv5-udp-port=46133 --rest-address=0.0.0.0 --nat=extip:172.18.13.3 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=93cbab33fad5386fabfba63725cbe57ceba479bed5dc3c617fa2b5ab94d6ccda --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46134 --metrics-logging=true --lightpush=true --relay=true
2025-02-14 04:05:15.247 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.13.3 waku e711c3b46dbb810654afb527f690bce31ac7f618632278f3f2a93e901d0d0264
2025-02-14 04:05:15.295 DEBUG [src.node.docker_mananger] Container started with ID e711c3b46dbb. Setting up logs at ./log/docker/receiving_node1_2025-02-14_04-05-15__13cbd446-553f-4beb-8347-8e4e3379415f__wakuorg_nwaku:latest.log
2025-02-14 04:05:15.295 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 46130
2025-02-14 04:05:15.296 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:05:15.788 ERROR [src.node.docker_mananger] Max retries reached for container 6eb395599720. Exiting log stream.
2025-02-14 04:05:16.297 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46130/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:05:16.300 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:05:16.300 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:05:16.300 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46130/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:05:16.302 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.13.3/tcp/46131/p2p/16Uiu2HAmSZpPZkcS89PtidgFu2UzfX8rtiydJvQkonnm8wMf4Jj8","/ip4/172.18.13.3/tcp/46132/ws/p2p/16Uiu2HAmSZpPZkcS89PtidgFu2UzfX8rtiydJvQkonnm8wMf4Jj8"],"enrUri":"enr:-L24QNPGcuxmE8BvbP0b7m3QlJ4E59ZIKb3x8Xmtw0yw7c5cID8ByALoQlVrIZ6aT_laCgwkSeLWZRazdE2Wfo2kpMsCgmlkgnY0gmlwhKwSDQOKbXVsdGlhZGRyc5YACASsEg0DBrQzAAoErBINAwa0NN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDzrBzQ6Ayig-IfnKxCtkKiIUGI90Xt7bFXXhhQajRZUeDdGNwgrQzg3VkcIK0NYV3YWt1Mgk"}'
2025-02-14 04:05:16.302 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:05:16.309 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:05:16.309 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-14_04-05-15__13cbd446-553f-4beb-8347-8e4e3379415f__wakuorg_nwaku:latest.log
2025-02-14 04:05:16.309 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:05:16.309 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:05:16.310 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:05:16.310 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.63.228
2025-02-14 04:05:16.311 DEBUG [src.node.docker_mananger] Generated ports ['30474', '30475', '30476', '30477', '30478']
2025-02-14 04:05:16.311 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:05:16.311 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:05:16.311 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:05:16.311 DEBUG [src.node.docker_mananger] docker run -i -t -p 30474:30474 -p 30475:30475 -p 30476:30476 -p 30477:30477 -p 30478:30478 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30476 --rest-port=30474 --tcp-port=30475 --discv5-udp-port=30477 --rest-address=0.0.0.0 --nat=extip:172.18.63.228 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=35c4d5dcf84adf50b151fccde9b7d3daa7b74cac23515b46f4d8a2aec2cd2844 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30478 --metrics-logging=true --lightpush=false --relay=true
2025-02-14 04:05:16.537 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.63.228 waku 981c542137c934ff54c0f3eb86ca9c078bcaf7068449692066e0eb8f980ef131
2025-02-14 04:05:16.586 DEBUG [src.node.docker_mananger] Container started with ID 981c542137c9. Setting up logs at ./log/docker/receiving_node2_2025-02-14_04-05-15__13cbd446-553f-4beb-8347-8e4e3379415f__wakuorg_nwaku:latest.log
2025-02-14 04:05:16.586 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30474
2025-02-14 04:05:16.587 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:05:17.588 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30474/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:05:17.591 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:05:17.591 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:05:17.591 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30474/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:05:17.593 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.63.228/tcp/30475/p2p/16Uiu2HAm7qpX3F2dSXDuRSQHCSBM7NGcXuV6X9bM2rUJZUga8W1b","/ip4/172.18.63.228/tcp/30476/ws/p2p/16Uiu2HAm7qpX3F2dSXDuRSQHCSBM7NGcXuV6X9bM2rUJZUga8W1b"],"enrUri":"enr:-L24QBQ6IA-2KjnMXcB_VPnv9awv-n01wVuqKd7UTy7PJbDmFPYAMQQcE1cCD4gmfemW64j9X-KQnQWZkEMo5dT7iY0CgmlkgnY0gmlwhKwSP-SKbXVsdGlhZGRyc5YACASsEj_kBncLAAoErBI_5AZ3DN0DgnJzhQADAQAAiXNlY3AyNTZrMaECuHvWWT6K-U7IQ7xFJZED739zCQfF0FWsx-hMR3H6wn6DdGNwgncLg3VkcIJ3DYV3YWt1MgE"}'
2025-02-14 04:05:17.593 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:05:17.594 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30474/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.13.3/tcp/46131/p2p/16Uiu2HAmSZpPZkcS89PtidgFu2UzfX8rtiydJvQkonnm8wMf4Jj8"]'
2025-02-14 04:05:17.636 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:05:17.643 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 04:05:17.643 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-14_04-05-15__13cbd446-553f-4beb-8347-8e4e3379415f__wakuorg_nwaku:latest.log
2025-02-14 04:05:17.643 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 04:05:17.643 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 04:05:17.644 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 04:05:17.645 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.210.233
2025-02-14 04:05:17.645 DEBUG [src.node.docker_mananger] Generated ports ['57073', '57074', '57075', '57076', '57077']
2025-02-14 04:05:17.645 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 04:05:17.645 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 04:05:17.645 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 04:05:17.645 DEBUG [src.node.docker_mananger] docker run -i -t -p 57073:57073 -p 57074:57074 -p 57075:57075 -p 57076:57076 -p 57077:57077 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57075 --rest-port=57073 --tcp-port=57074 --discv5-udp-port=57076 --rest-address=0.0.0.0 --nat=extip:172.18.210.233 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b2972dbec857def87bba4a6e7372d09d4ac9da682dfcab208b1cb3ae46b71fc1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57077 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QNPGcuxmE8BvbP0b7m3QlJ4E59ZIKb3x8Xmtw0yw7c5cID8ByALoQlVrIZ6aT_laCgwkSeLWZRazdE2Wfo2kpMsCgmlkgnY0gmlwhKwSDQOKbXVsdGlhZGRyc5YACASsEg0DBrQzAAoErBINAwa0NN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDzrBzQ6Ayig-IfnKxCtkKiIUGI90Xt7bFXXhhQajRZUeDdGNwgrQzg3VkcIK0NYV3YWt1Mgk --lightpushnode=/ip4/172.18.13.3/tcp/46131/p2p/16Uiu2HAmSZpPZkcS89PtidgFu2UzfX8rtiydJvQkonnm8wMf4Jj8 --lightpush=true --relay=false
2025-02-14 04:05:17.877 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.210.233 waku 1a1fbec51c051c775f8887e4d8d89ef5d55e3d085858e10794b1d437ce5ca54e
2025-02-14 04:05:17.925 DEBUG [src.node.docker_mananger] Container started with ID 1a1fbec51c05. Setting up logs at ./log/docker/lightpush_node1_2025-02-14_04-05-15__13cbd446-553f-4beb-8347-8e4e3379415f__wakuorg_nwaku:latest.log
2025-02-14 04:05:17.926 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57073
2025-02-14 04:05:17.926 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 04:05:18.926 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57073/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:05:18.929 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 04:05:18.929 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 04:05:18.929 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57073/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:05:18.931 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.210.233/tcp/57074/p2p/16Uiu2HAmQSjG3NTWUz8AvyyViWGw1LVKw65tkACvYERqEfKhnJft","/ip4/172.18.210.233/tcp/57075/ws/p2p/16Uiu2HAmQSjG3NTWUz8AvyyViWGw1LVKw65tkACvYERqEfKhnJft"],"enrUri":"enr:-L24QNiSIJ7Hrv9pVL96zX6OqfWkNjMyc12nRG8ArLaMA9LhS3ZVnSwzm9cLEsltdD-5D14Y_AsbgNQ55WFRx6R5ANACgmlkgnY0gmlwhKwS0umKbXVsdGlhZGRyc5YACASsEtLpBt7yAAoErBLS6Qbe890DgnJzhQADAQAAiXNlY3AyNTZrMaEDryg15faGcn5HRxNDcw5yM1FJapWR-o5_mvf8a0yfwvuDdGNwgt7yg3VkcILe9IV3YWt1Mgg"}'
2025-02-14 04:05:18.931 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 04:05:18.931 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57073/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.13.3/tcp/46131/p2p/16Uiu2HAmSZpPZkcS89PtidgFu2UzfX8rtiydJvQkonnm8wMf4Jj8"]'
2025-02-14 04:05:18.967 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:05:18.967 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57073/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.63.228/tcp/30475/p2p/16Uiu2HAm7qpX3F2dSXDuRSQHCSBM7NGcXuV6X9bM2rUJZUga8W1b"]'
2025-02-14 04:05:18.999 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:05:19.000 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46130/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 04:05:19.007 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:05:19.008 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30474/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 04:05:19.020 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:05:19.020 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57073/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1739505919020592640}}'
2025-02-14 04:05:19.030 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 04:05:19.031 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-14 04:05:19.531 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46130/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 04:05:19.533 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739505919020592640,"ephemeral":false}]'
2025-02-14 04:05:19.534 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-14 04:05:24.534 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.13.3/tcp/46131"} has 1
2025-02-14 04:05:24.538 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.13.3/tcp/46131"} with value 1.0
2025-02-14 04:05:24.538 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-14 04:05:24.541 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-14 04:05:24.541 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-14 04:05:24.544 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-14 04:05:24.544 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-14 04:05:24.547 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-14 04:05:24.548 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-14 04:05:24.551 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-14 04:05:24.551 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-14 04:05:24.554 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-14 04:05:24.555 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-14 04:05:24.557 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-14 04:05:24.558 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-14 04:05:24.561 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-14 04:05:24.561 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-14 04:05:24.564 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-14 04:05:24.564 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-14 04:05:24.567 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-14 04:05:24.568 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 04:05:24.569 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 04:05:24.569 DEBUG [src.node.waku_node] Stopping container with id e711c3b46dbb
2025-02-14 04:05:25.697 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:05:25.697 DEBUG [src.node.waku_node] Stopping container with id 981c542137c9
2025-02-14 04:05:26.533 ERROR [src.node.docker_mananger] Max retries reached for container e711c3b46dbb. Exiting log stream.
2025-02-14 04:05:27.185 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:05:27.186 DEBUG [src.node.waku_node] Stopping container with id 1a1fbec51c05
2025-02-14 04:05:28.000 ERROR [src.node.docker_mananger] Max retries reached for container 981c542137c9. Exiting log stream.
2025-02-14 04:05:28.001 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 04:05:28.002 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 04:05:28.019 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 04:05:28.028 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 04:05:28.034 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
