2025-02-04 17:12:47.740 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:12:47.740 DEBUG [tests.conftest] Running test: test_publish_on_multiple_content_topics_and_only_after_fetch_them[content_topic_list1] with id: 2025-02-04_17-12-47__e0ce2033-d01a-411b-b957-17337704bedf
2025-02-04 17:12:47.740 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:12:47.740 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-04 17:12:47.741 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-04 17:12:47.748 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:12:47.748 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-12-47__e0ce2033-d01a-411b-b957-17337704bedf__wakuorg_nwaku:latest.log
2025-02-04 17:12:47.749 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:12:47.749 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:12:47.750 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:12:47.750 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.27.58
2025-02-04 17:12:47.751 DEBUG [src.node.docker_mananger] Generated ports ['48428', '48429', '48430', '48431', '48432']
2025-02-04 17:12:47.751 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:12:47.751 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:12:47.751 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:12:47.751 DEBUG [src.node.docker_mananger] docker run -i -t -p 48428:48428 -p 48429:48429 -p 48430:48430 -p 48431:48431 -p 48432:48432 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48430 --rest-port=48428 --tcp-port=48429 --discv5-udp-port=48431 --rest-address=0.0.0.0 --nat=extip:172.18.27.58 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ad1bca7faae3e7fd7df7dedaba24f04bf107c7a9bcf74f808f43aa31c917afaa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48432 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-04 17:12:47.984 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.27.58 waku 313f54123d7e7c5d5e28295bc4cca2d5b03afcffc21405da2426685413c61747
2025-02-04 17:12:48.032 DEBUG [src.node.docker_mananger] Container started with ID 313f54123d7e. Setting up logs at ./log/docker/node1_2025-02-04_17-12-47__e0ce2033-d01a-411b-b957-17337704bedf__wakuorg_nwaku:latest.log
2025-02-04 17:12:48.032 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48428
2025-02-04 17:12:48.033 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:12:48.544 ERROR [src.node.docker_mananger] Max retries reached for container 20d7b1335d0e. Exiting log stream.
2025-02-04 17:12:49.034 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48428/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:49.037 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:12:49.037 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:12:49.037 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48428/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:49.039 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.27.58/tcp/48429/p2p/16Uiu2HAkx72WoXJnopXPiGvNzNdTTgpUwkQThikgjN2ZFSBAaooo","/ip4/172.18.27.58/tcp/48430/ws/p2p/16Uiu2HAkx72WoXJnopXPiGvNzNdTTgpUwkQThikgjN2ZFSBAaooo"],"enrUri":"enr:-L24QMkhqQHkdzLRO5CczTAsXzqUn19IdGCOOx7QiyIcRbGnfFtG1tri00ekhDLosWADqchytTTBgalRxFUrPSBDxoACgmlkgnY0gmlwhKwSGzqKbXVsdGlhZGRyc5YACASsEhs6Br0tAAoErBIbOga9Lt0DgnJzhQACAQAAiXNlY3AyNTZrMaECJ8w-dwhXGmiWcuSZcBbrQpZ_nPJS12fWWutDLSyNEUqDdGNwgr0tg3VkcIK9L4V3YWt1MgU"}'
2025-02-04 17:12:49.040 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:12:49.047 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:12:49.047 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-12-47__e0ce2033-d01a-411b-b957-17337704bedf__wakuorg_nwaku:latest.log
2025-02-04 17:12:49.047 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:12:49.047 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:12:49.049 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:12:49.049 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.24.16
2025-02-04 17:12:49.049 DEBUG [src.node.docker_mananger] Generated ports ['54060', '54061', '54062', '54063', '54064']
2025-02-04 17:12:49.049 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:12:49.049 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:12:49.050 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:12:49.050 DEBUG [src.node.docker_mananger] docker run -i -t -p 54060:54060 -p 54061:54061 -p 54062:54062 -p 54063:54063 -p 54064:54064 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54062 --rest-port=54060 --tcp-port=54061 --discv5-udp-port=54063 --rest-address=0.0.0.0 --nat=extip:172.18.24.16 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ec28c165e5e744bddeca72695fcfbcab3facad903637d7d60ba224c0df0a7a99 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54064 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMkhqQHkdzLRO5CczTAsXzqUn19IdGCOOx7QiyIcRbGnfFtG1tri00ekhDLosWADqchytTTBgalRxFUrPSBDxoACgmlkgnY0gmlwhKwSGzqKbXVsdGlhZGRyc5YACASsEhs6Br0tAAoErBIbOga9Lt0DgnJzhQACAQAAiXNlY3AyNTZrMaECJ8w-dwhXGmiWcuSZcBbrQpZ_nPJS12fWWutDLSyNEUqDdGNwgr0tg3VkcIK9L4V3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-04 17:12:49.292 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.24.16 waku fc03b34e23fde5d7b31a4b0d5dcb9ea1c2bd1fe52d3af77f7a902f65887d5c4a
2025-02-04 17:12:49.341 DEBUG [src.node.docker_mananger] Container started with ID fc03b34e23fd. Setting up logs at ./log/docker/node2_2025-02-04_17-12-47__e0ce2033-d01a-411b-b957-17337704bedf__wakuorg_nwaku:latest.log
2025-02-04 17:12:49.342 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54060
2025-02-04 17:12:49.343 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:12:50.343 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.351 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:12:50.351 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:12:50.352 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.359 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.24.16/tcp/54061/p2p/16Uiu2HAmGn1fJ1AH8wGXgmeNa9j8kQ9TUFUZetGX6mwZcx3QcwdF","/ip4/172.18.24.16/tcp/54062/ws/p2p/16Uiu2HAmGn1fJ1AH8wGXgmeNa9j8kQ9TUFUZetGX6mwZcx3QcwdF"],"enrUri":"enr:-L24QOztuGVmf_Ky2rpst6VwwCN_WSaCbB8brm8KfBf5jOAsBapIHoH7cWWZM1-OjTjhbjPYc6U-wCBzwGq1l7DwtzoCgmlkgnY0gmlwhKwSGBCKbXVsdGlhZGRyc5YACASsEhgQBtMtAAoErBIYEAbTLt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDPTtLiRKlCsQmcuunmvWzmorkBoRqJwx-91UWbfyJ1DaDdGNwgtMtg3VkcILTL4V3YWt1MgE"}'
2025-02-04 17:12:50.359 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:12:50.361 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54060/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.27.58/tcp/48429/p2p/16Uiu2HAkx72WoXJnopXPiGvNzNdTTgpUwkQThikgjN2ZFSBAaooo"]'
2025-02-04 17:12:50.364 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.364 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto", "/waku/2/content/test.js", "/app/22/sometopic/someencoding", "/toychat/2/huilong/proto", "/statusim/1/community/cbor", "/app/27/sometopic/someencoding", "/app/29/sometopic/someencoding", "/app/20/sometopic/someencoding"]'
2025-02-04 17:12:50.376 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.377 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54060/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto", "/waku/2/content/test.js", "/app/22/sometopic/someencoding", "/toychat/2/huilong/proto", "/statusim/1/community/cbor", "/app/27/sometopic/someencoding", "/app/29/sometopic/someencoding", "/app/20/sometopic/someencoding"]'
2025-02-04 17:12:50.395 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.396 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L215YXBwLzEvbGF0ZXN0L3Byb3Rv", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.408 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.409 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L3dha3UvMi9jb250ZW50L3Rlc3QuanM=", "contentTopic": "/waku/2/content/test.js", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.415 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.417 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yMi9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/22/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.423 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.424 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L3RveWNoYXQvMi9odWlsb25nL3Byb3Rv", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.430 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.430 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L3N0YXR1c2ltLzEvY29tbXVuaXR5L2Nib3I=", "contentTopic": "/statusim/1/community/cbor", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.435 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.436 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yNy9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/27/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.441 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.442 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yOS9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/29/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.447 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.447 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48428/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "L2FwcC8yMC9zb21ldG9waWMvc29tZWVuY29kaW5n", "contentTopic": "/app/20/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.453 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.453 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:12:50.553 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.557 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L215YXBwLzEvbGF0ZXN0L3Byb3Rv","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738689170396185600,"ephemeral":false}]'
2025-02-04 17:12:50.557 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Fwaku%2F2%2Fcontent%2Ftest.js" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.560 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L3dha3UvMi9jb250ZW50L3Rlc3QuanM=","contentTopic":"/waku/2/content/test.js","version":0,"timestamp":1738689170409272064,"ephemeral":false}]'
2025-02-04 17:12:50.560 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Fapp%2F22%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.563 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yMi9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/22/sometopic/someencoding","version":0,"timestamp":1738689170417813248,"ephemeral":false}]'
2025-02-04 17:12:50.563 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Ftoychat%2F2%2Fhuilong%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.565 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L3RveWNoYXQvMi9odWlsb25nL3Byb3Rv","contentTopic":"/toychat/2/huilong/proto","version":0,"timestamp":1738689170424248320,"ephemeral":false}]'
2025-02-04 17:12:50.566 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Fstatusim%2F1%2Fcommunity%2Fcbor" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.568 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L3N0YXR1c2ltLzEvY29tbXVuaXR5L2Nib3I=","contentTopic":"/statusim/1/community/cbor","version":0,"timestamp":1738689170430540544,"ephemeral":false}]'
2025-02-04 17:12:50.568 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Fapp%2F27%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.570 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yNy9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/27/sometopic/someencoding","version":0,"timestamp":1738689170436159488,"ephemeral":false}]'
2025-02-04 17:12:50.571 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Fapp%2F29%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.573 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yOS9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/29/sometopic/someencoding","version":0,"timestamp":1738689170442109184,"ephemeral":false}]'
2025-02-04 17:12:50.573 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54060/relay/v1/auto/messages/%2Fapp%2F20%2Fsometopic%2Fsomeencoding" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.576 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"L2FwcC8yMC9zb21ldG9waWMvc29tZWVuY29kaW5n","contentTopic":"/app/20/sometopic/someencoding","version":0,"timestamp":1738689170447738880,"ephemeral":false}]'
2025-02-04 17:12:50.577 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:12:50.578 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:12:50.578 DEBUG [src.node.waku_node] Stopping container with id 313f54123d7e
2025-02-04 17:12:51.639 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:12:51.639 DEBUG [src.node.waku_node] Stopping container with id fc03b34e23fd
2025-02-04 17:12:52.452 ERROR [src.node.docker_mananger] Max retries reached for container 313f54123d7e. Exiting log stream.
2025-02-04 17:12:53.151 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:12:53.152 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:12:53.161 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:12:53.170 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
