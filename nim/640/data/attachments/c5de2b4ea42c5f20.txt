2025-02-04 17:13:40.591 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:13:40.591 DEBUG [tests.conftest] Running test: test_light_push_with_valid_meta with id: 2025-02-04_17-13-40__225ccdc2-52e0-48b0-957a-fb9d634fa405
2025-02-04 17:13:40.591 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:13:40.592 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-04 17:13:40.598 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:40.598 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-04_17-13-40__225ccdc2-52e0-48b0-957a-fb9d634fa405__wakuorg_nwaku:latest.log
2025-02-04 17:13:40.598 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:40.598 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:40.599 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:40.600 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.147.58
2025-02-04 17:13:40.600 DEBUG [src.node.docker_mananger] Generated ports ['25724', '25725', '25726', '25727', '25728']
2025-02-04 17:13:40.600 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:40.600 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:40.600 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:40.600 DEBUG [src.node.docker_mananger] docker run -i -t -p 25724:25724 -p 25725:25725 -p 25726:25726 -p 25727:25727 -p 25728:25728 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25726 --rest-port=25724 --tcp-port=25725 --discv5-udp-port=25727 --rest-address=0.0.0.0 --nat=extip:172.18.147.58 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3eeef1fe78f0f41bf3f03cfef38efbeeeebce63fbd4fb9ce6e1c9d930249564f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25728 --metrics-logging=true --lightpush=true --relay=true
2025-02-04 17:13:40.826 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.147.58 waku b79946d59b9b14ea768035cd5478f5f05d983f21c680ef1bba50de4c48cf8982
2025-02-04 17:13:40.873 DEBUG [src.node.docker_mananger] Container started with ID b79946d59b9b. Setting up logs at ./log/docker/receiving_node1_2025-02-04_17-13-40__225ccdc2-52e0-48b0-957a-fb9d634fa405__wakuorg_nwaku:latest.log
2025-02-04 17:13:40.874 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25724
2025-02-04 17:13:40.874 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:41.382 ERROR [src.node.docker_mananger] Max retries reached for container e9bbf9ed3b48. Exiting log stream.
2025-02-04 17:13:41.875 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25724/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:41.878 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:41.878 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:41.878 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25724/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:41.881 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.147.58/tcp/25725/p2p/16Uiu2HAm72HnksLB4qFQtr7Bj6zaSwrMVQhDtAYrrHNMGL5uSzLB","/ip4/172.18.147.58/tcp/25726/ws/p2p/16Uiu2HAm72HnksLB4qFQtr7Bj6zaSwrMVQhDtAYrrHNMGL5uSzLB"],"enrUri":"enr:-L24QOVsjnSUsiYSyBAImZj9tWMyau8KKXank3oYjrbuQ8fPRDTcKc6JQGh2sEXeqFGlfdlbyKGi1UAOm7DNQYnUgTkCgmlkgnY0gmlwhKwSkzqKbXVsdGlhZGRyc5YACASsEpM6BmR9AAoErBKTOgZkft0DgnJzhQADAQAAiXNlY3AyNTZrMaECrE7LO24ZrGBJqu1kdpuya2_PwBT5M96iaAXI8gOb30SDdGNwgmR9g3VkcIJkf4V3YWt1Mgk"}'
2025-02-04 17:13:41.881 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:41.887 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:41.887 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-04_17-13-40__225ccdc2-52e0-48b0-957a-fb9d634fa405__wakuorg_nwaku:latest.log
2025-02-04 17:13:41.888 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:41.888 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:41.889 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:41.889 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.22.117
2025-02-04 17:13:41.889 DEBUG [src.node.docker_mananger] Generated ports ['30155', '30156', '30157', '30158', '30159']
2025-02-04 17:13:41.890 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:41.890 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:41.890 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:41.890 DEBUG [src.node.docker_mananger] docker run -i -t -p 30155:30155 -p 30156:30156 -p 30157:30157 -p 30158:30158 -p 30159:30159 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30157 --rest-port=30155 --tcp-port=30156 --discv5-udp-port=30158 --rest-address=0.0.0.0 --nat=extip:172.18.22.117 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8285ba8b05e1fc8c2bfd133b9d21781eedb4e7144aad51fdd0b5eda1a1fec6de --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30159 --metrics-logging=true --lightpush=false --relay=true
2025-02-04 17:13:42.123 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.22.117 waku 8f27655a7bdaafb75b06f770c1326f80c46c78b2d4d425767ce21a747225ba4a
2025-02-04 17:13:42.173 DEBUG [src.node.docker_mananger] Container started with ID 8f27655a7bda. Setting up logs at ./log/docker/receiving_node2_2025-02-04_17-13-40__225ccdc2-52e0-48b0-957a-fb9d634fa405__wakuorg_nwaku:latest.log
2025-02-04 17:13:42.173 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30155
2025-02-04 17:13:42.173 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:43.174 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30155/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:43.176 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:43.177 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:43.177 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30155/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:43.179 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.22.117/tcp/30156/p2p/16Uiu2HAmU2mL2HMFJ3acXUSWyPipLcDxWFr1Aa2nLCUaUPQJzUzV","/ip4/172.18.22.117/tcp/30157/ws/p2p/16Uiu2HAmU2mL2HMFJ3acXUSWyPipLcDxWFr1Aa2nLCUaUPQJzUzV"],"enrUri":"enr:-L24QOXwcp00A8V5tCy3EETGLCr22E4ToViMYr4J28IfAzCqI1Gs8bfeEnn6InxYDed2_n0xD-XTkcWQTjpjNQNlNaICgmlkgnY0gmlwhKwSFnWKbXVsdGlhZGRyc5YACASsEhZ1BnXMAAoErBIWdQZ1zd0DgnJzhQADAQAAiXNlY3AyNTZrMaED5HNbm_utkuW5AxAiU6NGUmYgGKqkKqJINxy6iMDXiiqDdGNwgnXMg3VkcIJ1zoV3YWt1MgE"}'
2025-02-04 17:13:43.179 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:43.179 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30155/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.147.58/tcp/25725/p2p/16Uiu2HAm72HnksLB4qFQtr7Bj6zaSwrMVQhDtAYrrHNMGL5uSzLB"]'
2025-02-04 17:13:43.219 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:43.227 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:43.228 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-04_17-13-40__225ccdc2-52e0-48b0-957a-fb9d634fa405__wakuorg_nwaku:latest.log
2025-02-04 17:13:43.228 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:43.228 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:43.229 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:43.229 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.249.169
2025-02-04 17:13:43.230 DEBUG [src.node.docker_mananger] Generated ports ['32252', '32253', '32254', '32255', '32256']
2025-02-04 17:13:43.230 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:43.230 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:43.230 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:43.230 DEBUG [src.node.docker_mananger] docker run -i -t -p 32252:32252 -p 32253:32253 -p 32254:32254 -p 32255:32255 -p 32256:32256 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32254 --rest-port=32252 --tcp-port=32253 --discv5-udp-port=32255 --rest-address=0.0.0.0 --nat=extip:172.18.249.169 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f325fe0bf1aef2dfcddfd920ddf866cbb582f8aed7b20540c36eca0b20eddb7c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32256 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QOVsjnSUsiYSyBAImZj9tWMyau8KKXank3oYjrbuQ8fPRDTcKc6JQGh2sEXeqFGlfdlbyKGi1UAOm7DNQYnUgTkCgmlkgnY0gmlwhKwSkzqKbXVsdGlhZGRyc5YACASsEpM6BmR9AAoErBKTOgZkft0DgnJzhQADAQAAiXNlY3AyNTZrMaECrE7LO24ZrGBJqu1kdpuya2_PwBT5M96iaAXI8gOb30SDdGNwgmR9g3VkcIJkf4V3YWt1Mgk --lightpushnode=/ip4/172.18.147.58/tcp/25725/p2p/16Uiu2HAm72HnksLB4qFQtr7Bj6zaSwrMVQhDtAYrrHNMGL5uSzLB --lightpush=true --relay=false
2025-02-04 17:13:43.457 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.249.169 waku 1d496fe83125cc38f9d8609d84452a568c8f597c08b93754976f452637229cc5
2025-02-04 17:13:43.512 DEBUG [src.node.docker_mananger] Container started with ID 1d496fe83125. Setting up logs at ./log/docker/lightpush_node1_2025-02-04_17-13-40__225ccdc2-52e0-48b0-957a-fb9d634fa405__wakuorg_nwaku:latest.log
2025-02-04 17:13:43.512 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 32252
2025-02-04 17:13:43.513 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:44.513 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32252/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:44.516 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:44.517 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:44.517 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32252/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:44.519 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.249.169/tcp/32253/p2p/16Uiu2HAmVHR6Got19JUv6xp4V5DWqEGVw7JVAQjqVUVvTzepz7XD","/ip4/172.18.249.169/tcp/32254/ws/p2p/16Uiu2HAmVHR6Got19JUv6xp4V5DWqEGVw7JVAQjqVUVvTzepz7XD"],"enrUri":"enr:-L24QCFS0wnHFNH6ic8cPc7rTwyOIccXFbXz8E4RihuAoTjNB2tY_1vIc-Wl28JgU7AaTjPPsLHoQauqOjFfSmapeooCgmlkgnY0gmlwhKwS-amKbXVsdGlhZGRyc5YACASsEvmpBn39AAoErBL5qQZ9_t0DgnJzhQADAQAAiXNlY3AyNTZrMaED9w_f8nWB3J0HTyiQ9Kncfk_VbCQW2MqqoacLVxR3POiDdGNwgn39g3VkcIJ9_4V3YWt1Mgg"}'
2025-02-04 17:13:44.519 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:44.519 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32252/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.147.58/tcp/25725/p2p/16Uiu2HAm72HnksLB4qFQtr7Bj6zaSwrMVQhDtAYrrHNMGL5uSzLB"]'
2025-02-04 17:13:44.556 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:44.557 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32252/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.22.117/tcp/30156/p2p/16Uiu2HAmU2mL2HMFJ3acXUSWyPipLcDxWFr1Aa2nLCUaUPQJzUzV"]'
2025-02-04 17:13:44.585 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:44.586 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25724/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-04 17:13:44.592 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:44.593 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30155/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-04 17:13:44.597 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:44.599 DEBUG [src.steps.light_push] Lightpushing message
2025-02-04 17:13:44.600 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32252/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738689224599702528, "meta": "TGlnaHQgcHVzaCB3b3JrcyEh"}}'
2025-02-04 17:13:44.615 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:44.615 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:13:44.715 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-04 17:13:44.716 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25724/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:44.718 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738689224599702528,"meta":"TGlnaHQgcHVzaCB3b3JrcyEh","ephemeral":false}]'
2025-02-04 17:13:44.719 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-04 17:13:44.719 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30155/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:44.721 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738689224599702528,"meta":"TGlnaHQgcHVzaCB3b3JrcyEh","ephemeral":false}]'
2025-02-04 17:13:44.724 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:13:44.725 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:13:44.725 DEBUG [src.node.waku_node] Stopping container with id b79946d59b9b
2025-02-04 17:13:45.372 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:45.372 DEBUG [src.node.waku_node] Stopping container with id 8f27655a7bda
2025-02-04 17:13:46.183 ERROR [src.node.docker_mananger] Max retries reached for container b79946d59b9b. Exiting log stream.
2025-02-04 17:13:46.850 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:46.851 DEBUG [src.node.waku_node] Stopping container with id 1d496fe83125
2025-02-04 17:13:47.682 ERROR [src.node.docker_mananger] Max retries reached for container 8f27655a7bda. Exiting log stream.
2025-02-04 17:13:48.338 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:48.342 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:13:48.349 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:13:48.362 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:13:48.369 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
