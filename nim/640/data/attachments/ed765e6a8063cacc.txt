2025-02-04 17:11:11.434 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:11:11.434 DEBUG [tests.conftest] Running test: test_publish_after_node_pauses_and_pauses with id: 2025-02-04_17-11-11__39f17efc-05d8-48ad-8319-d6edbc720b63
2025-02-04 17:11:11.435 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:11:11.436 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-04 17:11:11.436 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-04 17:11:11.443 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:11:11.444 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-11-11__39f17efc-05d8-48ad-8319-d6edbc720b63__wakuorg_nwaku:latest.log
2025-02-04 17:11:11.444 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:11:11.444 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:11:11.448 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:11:11.448 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.110.235
2025-02-04 17:11:11.448 DEBUG [src.node.docker_mananger] Generated ports ['12446', '12447', '12448', '12449', '12450']
2025-02-04 17:11:11.448 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:11:11.449 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:11:11.449 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:11:11.449 DEBUG [src.node.docker_mananger] docker run -i -t -p 12446:12446 -p 12447:12447 -p 12448:12448 -p 12449:12449 -p 12450:12450 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12448 --rest-port=12446 --tcp-port=12447 --discv5-udp-port=12449 --rest-address=0.0.0.0 --nat=extip:172.18.110.235 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ffb06a521ead7f1c4c3fbd29f56cb41e9e007f0fa09c72339b8bac2cc2fcd6ed --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12450 --metrics-logging=true --relay=true
2025-02-04 17:11:11.678 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.110.235 waku 1b036d7d20a0c5dae64a7496a8913deb40670ca0833062799e481020872fd7bd
2025-02-04 17:11:11.722 DEBUG [src.node.docker_mananger] Container started with ID 1b036d7d20a0. Setting up logs at ./log/docker/node1_2025-02-04_17-11-11__39f17efc-05d8-48ad-8319-d6edbc720b63__wakuorg_nwaku:latest.log
2025-02-04 17:11:11.723 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 12446
2025-02-04 17:11:11.723 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:11:12.265 ERROR [src.node.docker_mananger] Max retries reached for container 46bc9439fc2e. Exiting log stream.
2025-02-04 17:11:12.724 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12446/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:12.727 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:11:12.727 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:11:12.727 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12446/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:12.730 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.110.235/tcp/12447/p2p/16Uiu2HAkzRz7ZqUw1L447GY8E3xPgXN2hWc6SWaJJby7o76pymvD","/ip4/172.18.110.235/tcp/12448/ws/p2p/16Uiu2HAkzRz7ZqUw1L447GY8E3xPgXN2hWc6SWaJJby7o76pymvD"],"enrUri":"enr:-L24QJTvH0vc4R9GjJpiPJDgA6jv89X_1t8kprdKY9APlLF8FQdNBONEkAJfpkqv8oHSoP5wGkNwH46-pKr9QRxxFz8CgmlkgnY0gmlwhKwSbuuKbXVsdGlhZGRyc5YACASsEm7rBjCfAAoErBJu6wYwoN0DgnJzhQADAQAAiXNlY3AyNTZrMaECSl7wV7877D-womyOHNvFJilBjPfVsE_uDQ3rNHugt46DdGNwgjCfg3VkcIIwoYV3YWt1MgE"}'
2025-02-04 17:11:12.730 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:11:12.736 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:11:12.736 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-11-11__39f17efc-05d8-48ad-8319-d6edbc720b63__wakuorg_nwaku:latest.log
2025-02-04 17:11:12.736 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:11:12.736 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:11:12.738 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:11:12.738 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.142.126
2025-02-04 17:11:12.738 DEBUG [src.node.docker_mananger] Generated ports ['19001', '19002', '19003', '19004', '19005']
2025-02-04 17:11:12.738 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:11:12.738 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:11:12.738 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:11:12.738 DEBUG [src.node.docker_mananger] docker run -i -t -p 19001:19001 -p 19002:19002 -p 19003:19003 -p 19004:19004 -p 19005:19005 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19003 --rest-port=19001 --tcp-port=19002 --discv5-udp-port=19004 --rest-address=0.0.0.0 --nat=extip:172.18.142.126 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=edf2d9d9fc82de6f02ebfebea9bb46286ce24a7dcf05f0b558bb3a855266dece --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19005 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJTvH0vc4R9GjJpiPJDgA6jv89X_1t8kprdKY9APlLF8FQdNBONEkAJfpkqv8oHSoP5wGkNwH46-pKr9QRxxFz8CgmlkgnY0gmlwhKwSbuuKbXVsdGlhZGRyc5YACASsEm7rBjCfAAoErBJu6wYwoN0DgnJzhQADAQAAiXNlY3AyNTZrMaECSl7wV7877D-womyOHNvFJilBjPfVsE_uDQ3rNHugt46DdGNwgjCfg3VkcIIwoYV3YWt1MgE
2025-02-04 17:11:12.968 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.142.126 waku 402101a8766487bcf5ecd34b82d05cf6944487109c956467d8ec589d00cec359
2025-02-04 17:11:13.021 DEBUG [src.node.docker_mananger] Container started with ID 402101a87664. Setting up logs at ./log/docker/node2_2025-02-04_17-11-11__39f17efc-05d8-48ad-8319-d6edbc720b63__wakuorg_nwaku:latest.log
2025-02-04 17:11:13.022 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19001
2025-02-04 17:11:13.022 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:11:14.022 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19001/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.029 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:11:14.031 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:11:14.031 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19001/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.037 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.142.126/tcp/19002/p2p/16Uiu2HAm3LsYHEkHaAbeGMZ3Qpb2DZwZ7mT7WF2JkobzrQaZWKio","/ip4/172.18.142.126/tcp/19003/ws/p2p/16Uiu2HAm3LsYHEkHaAbeGMZ3Qpb2DZwZ7mT7WF2JkobzrQaZWKio"],"enrUri":"enr:-L24QNZgXp1Y122GbN-NJH_IIKThlfR63FBtaaf-6LaLO3ieZnwXvc6y7J-M54TweSyFmVCr0e5PCoOzvfXE-GrIrXgCgmlkgnY0gmlwhKwSjn6KbXVsdGlhZGRyc5YACASsEo5-Bko6AAoErBKOfgZKO90DgnJzhQADAQAAiXNlY3AyNTZrMaECdaKplbHSB8wiBUHL4vXDvOEG9oHT59DmNi-yyJvF12iDdGNwgko6g3VkcIJKPIV3YWt1MgE"}'
2025-02-04 17:11:14.038 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:11:14.038 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19001/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.110.235/tcp/12447/p2p/16Uiu2HAkzRz7ZqUw1L447GY8E3xPgXN2hWc6SWaJJby7o76pymvD"]'
2025-02-04 17:11:14.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:14.041 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-04 17:11:14.042 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12446/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:11:14.046 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:14.046 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19001/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:11:14.051 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:14.052 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:11:14.057 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:14.057 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:11:14.158 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.158 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.161 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074052112128,"ephemeral":false}]'
2025-02-04 17:11:14.162 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.163 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19001/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.165 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074052112128,"ephemeral":false}]'
2025-02-04 17:11:14.166 INFO [src.steps.relay] WARM UP successful!!
2025-02-04 17:11:14.167 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:11:14.171 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:14.172 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:11:14.272 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.273 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.275 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074167380224,"ephemeral":false}]'
2025-02-04 17:11:14.277 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.277 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19001/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.280 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074167380224,"ephemeral":false}]'
2025-02-04 17:11:14.282 DEBUG [src.node.waku_node] Pausing container with id 1b036d7d20a0
2025-02-04 17:11:14.291 DEBUG [src.node.waku_node] Unpause container with id 1b036d7d20a0
2025-02-04 17:11:14.300 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTE=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:11:14.305 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:14.305 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:11:14.406 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.406 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.408 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074300673280,"ephemeral":false}]'
2025-02-04 17:11:14.410 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.410 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19001/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074300673280,"ephemeral":false}]'
2025-02-04 17:11:14.414 DEBUG [src.node.waku_node] Pausing container with id 402101a87664
2025-02-04 17:11:14.423 DEBUG [src.node.waku_node] Unpause container with id 402101a87664
2025-02-04 17:11:14.432 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTI=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:11:14.437 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:14.437 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:11:14.538 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.538 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12446/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.541 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074432651264,"ephemeral":false}]'
2025-02-04 17:11:14.542 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:11:14.542 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19001/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:14.545 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689074432651264,"ephemeral":false}]'
2025-02-04 17:11:14.548 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:11:14.549 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:11:14.549 DEBUG [src.node.waku_node] Stopping container with id 1b036d7d20a0
2025-02-04 17:11:15.231 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:11:15.231 DEBUG [src.node.waku_node] Stopping container with id 402101a87664
2025-02-04 17:11:16.002 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:11:16.003 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:11:16.009 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:11:16.015 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
