2025-02-04 17:13:18.972 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:13:18.972 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_only_relay with id: 2025-02-04_17-13-18__85e6697f-e7c3-4609-8977-fe85b9cb029b
2025-02-04 17:13:18.972 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:13:18.972 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-04 17:13:18.979 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:18.980 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-04_17-13-18__85e6697f-e7c3-4609-8977-fe85b9cb029b__wakuorg_nwaku:latest.log
2025-02-04 17:13:18.980 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:18.980 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:18.982 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:18.982 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.185.177
2025-02-04 17:13:18.982 DEBUG [src.node.docker_mananger] Generated ports ['13427', '13428', '13429', '13430', '13431']
2025-02-04 17:13:18.982 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:18.982 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:18.982 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:18.982 DEBUG [src.node.docker_mananger] docker run -i -t -p 13427:13427 -p 13428:13428 -p 13429:13429 -p 13430:13430 -p 13431:13431 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13429 --rest-port=13427 --tcp-port=13428 --discv5-udp-port=13430 --rest-address=0.0.0.0 --nat=extip:172.18.185.177 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=82f016d9edc954b54f56dfcdf4334fa4ef9ff9d9ce3bc21d14f9c69dad1af7cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13431 --metrics-logging=true --lightpush=false --relay=true
2025-02-04 17:13:19.222 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.185.177 waku a6ff859c7947d478ed87762f3d4b4a095bcfebf647cc63c496afeb1a8d9a895e
2025-02-04 17:13:19.272 DEBUG [src.node.docker_mananger] Container started with ID a6ff859c7947. Setting up logs at ./log/docker/receiving_node1_2025-02-04_17-13-18__85e6697f-e7c3-4609-8977-fe85b9cb029b__wakuorg_nwaku:latest.log
2025-02-04 17:13:19.272 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 13427
2025-02-04 17:13:19.273 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:19.780 ERROR [src.node.docker_mananger] Max retries reached for container 3ce9cd5d44ac. Exiting log stream.
2025-02-04 17:13:20.273 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13427/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:20.276 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:20.276 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:20.276 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13427/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:20.278 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.185.177/tcp/13428/p2p/16Uiu2HAkxUB6bJMfw3aiUrhsZhpim4VWUr1zK9kfPKNmLrXWNhTH","/ip4/172.18.185.177/tcp/13429/ws/p2p/16Uiu2HAkxUB6bJMfw3aiUrhsZhpim4VWUr1zK9kfPKNmLrXWNhTH"],"enrUri":"enr:-L24QNyoS0Otu0dFRntfGtMvdhFDOB0IEMgeup58SWh0M7nmaTQgdmTLC995RVKIoZHlhtH_-4bI9VDvQhsQXA1AlQMCgmlkgnY0gmlwhKwSubGKbXVsdGlhZGRyc5YACASsErmxBjR0AAoErBK5sQY0dd0DgnJzhQADAQAAiXNlY3AyNTZrMaECLTclNRESN5qUsJkH0kmhHiJYrHkhLfIa4MO4GNAVXCyDdGNwgjR0g3VkcII0doV3YWt1MgE"}'
2025-02-04 17:13:20.279 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:20.279 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13427/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-04 17:13:20.297 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:20.304 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:20.304 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-04_17-13-18__85e6697f-e7c3-4609-8977-fe85b9cb029b__wakuorg_nwaku:latest.log
2025-02-04 17:13:20.305 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:20.305 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:20.306 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:20.306 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.81.59
2025-02-04 17:13:20.307 DEBUG [src.node.docker_mananger] Generated ports ['33595', '33596', '33597', '33598', '33599']
2025-02-04 17:13:20.307 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:20.307 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:20.307 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:20.307 DEBUG [src.node.docker_mananger] docker run -i -t -p 33595:33595 -p 33596:33596 -p 33597:33597 -p 33598:33598 -p 33599:33599 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33597 --rest-port=33595 --tcp-port=33596 --discv5-udp-port=33598 --rest-address=0.0.0.0 --nat=extip:172.18.81.59 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2f01fc8d92ea2ffe6febfaafca4cd44ee6f85c36dbb4aa9defc6bf61fe31a4e5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33599 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QNyoS0Otu0dFRntfGtMvdhFDOB0IEMgeup58SWh0M7nmaTQgdmTLC995RVKIoZHlhtH_-4bI9VDvQhsQXA1AlQMCgmlkgnY0gmlwhKwSubGKbXVsdGlhZGRyc5YACASsErmxBjR0AAoErBK5sQY0dd0DgnJzhQADAQAAiXNlY3AyNTZrMaECLTclNRESN5qUsJkH0kmhHiJYrHkhLfIa4MO4GNAVXCyDdGNwgjR0g3VkcII0doV3YWt1MgE --lightpushnode=/ip4/172.18.185.177/tcp/13428/p2p/16Uiu2HAkxUB6bJMfw3aiUrhsZhpim4VWUr1zK9kfPKNmLrXWNhTH --lightpush=true --relay=false
2025-02-04 17:13:20.536 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.81.59 waku 9f3334f976d5530a5299c27f53be0e31f837db8fcf3676893a89dba4ea515558
2025-02-04 17:13:20.588 DEBUG [src.node.docker_mananger] Container started with ID 9f3334f976d5. Setting up logs at ./log/docker/lightpush_node1_2025-02-04_17-13-18__85e6697f-e7c3-4609-8977-fe85b9cb029b__wakuorg_nwaku:latest.log
2025-02-04 17:13:20.589 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33595
2025-02-04 17:13:20.589 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:21.589 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33595/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:21.592 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:21.593 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:21.593 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33595/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:21.595 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.59/tcp/33596/p2p/16Uiu2HAmNNDtq3gS9PqmML8xPFQzotcdMv2n425de2xrM4Gd2k5F","/ip4/172.18.81.59/tcp/33597/ws/p2p/16Uiu2HAmNNDtq3gS9PqmML8xPFQzotcdMv2n425de2xrM4Gd2k5F"],"enrUri":"enr:-L24QNzbvARu_JVij_nswgTVYc5safRm2egj_3HaUfsPwHW_dbGTNQK-m63T59ONI5AdY_HTBS6QJvVsVxrp2Fx55lICgmlkgnY0gmlwhKwSUTuKbXVsdGlhZGRyc5YACASsElE7BoM8AAoErBJROwaDPd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDkElPPClIIV5uYkSsA2grW3qwjUVFmB08xMfGiv2qYoqDdGNwgoM8g3VkcIKDPoV3YWt1Mgg"}'
2025-02-04 17:13:21.595 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:21.596 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33595/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.185.177/tcp/13428/p2p/16Uiu2HAkxUB6bJMfw3aiUrhsZhpim4VWUr1zK9kfPKNmLrXWNhTH"]'
2025-02-04 17:13:21.635 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:21.637 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33595/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738689201637056000}}'
2025-02-04 17:13:21.655 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:33595/lightpush/v1/message. Response content: b'Failed to request a message push: dial_failure'
2025-02-04 17:13:21.656 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:13:21.657 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:13:21.657 DEBUG [src.node.waku_node] Stopping container with id a6ff859c7947
2025-02-04 17:13:22.767 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:22.767 DEBUG [src.node.waku_node] Stopping container with id 9f3334f976d5
2025-02-04 17:13:23.580 ERROR [src.node.docker_mananger] Max retries reached for container a6ff859c7947. Exiting log stream.
2025-02-04 17:13:24.301 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:24.302 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:13:24.307 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:13:24.311 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
