2025-02-04 17:10:28.511 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:10:28.511 DEBUG [tests.conftest] Running test: test_publish_with_valid_version with id: 2025-02-04_17-10-28__5ce9deff-0690-4bc8-a84e-a5ad3efacfb0
2025-02-04 17:10:28.512 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:10:28.512 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-04 17:10:28.512 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-04 17:10:28.518 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:10:28.518 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-10-28__5ce9deff-0690-4bc8-a84e-a5ad3efacfb0__wakuorg_nwaku:latest.log
2025-02-04 17:10:28.519 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:10:28.519 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:10:28.520 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:10:28.520 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.227.14
2025-02-04 17:10:28.520 DEBUG [src.node.docker_mananger] Generated ports ['60477', '60478', '60479', '60480', '60481']
2025-02-04 17:10:28.521 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:10:28.521 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:10:28.521 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:10:28.521 DEBUG [src.node.docker_mananger] docker run -i -t -p 60477:60477 -p 60478:60478 -p 60479:60479 -p 60480:60480 -p 60481:60481 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60479 --rest-port=60477 --tcp-port=60478 --discv5-udp-port=60480 --rest-address=0.0.0.0 --nat=extip:172.18.227.14 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b5a0d3cc1837b821d46fcf4d83ffaafe7fa8d75fcddacd82ab42ffaa4ba5bf2b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60481 --metrics-logging=true --relay=true
2025-02-04 17:10:28.744 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.227.14 waku 0f77d913abb1d043be2fa2e9791b932de7c94ffee14ed298477dce7cb64e3805
2025-02-04 17:10:28.798 DEBUG [src.node.docker_mananger] Container started with ID 0f77d913abb1. Setting up logs at ./log/docker/node1_2025-02-04_17-10-28__5ce9deff-0690-4bc8-a84e-a5ad3efacfb0__wakuorg_nwaku:latest.log
2025-02-04 17:10:28.798 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60477
2025-02-04 17:10:28.798 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:10:29.294 ERROR [src.node.docker_mananger] Max retries reached for container d678df366b44. Exiting log stream.
2025-02-04 17:10:29.799 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60477/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:29.801 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:10:29.802 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:10:29.802 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60477/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:29.804 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.227.14/tcp/60478/p2p/16Uiu2HAmQRpJ8vRkZ2mxfLumdEPAU6oBETCsLomxKQcLqkrhFhur","/ip4/172.18.227.14/tcp/60479/ws/p2p/16Uiu2HAmQRpJ8vRkZ2mxfLumdEPAU6oBETCsLomxKQcLqkrhFhur"],"enrUri":"enr:-L24QAG24eLQOo7_PLVdvLdTHXOn8Vp0FYTrg3Y6UKaGnyO2dexODKshhGG3L-BuqNowM0g-cv3SfDTj1PR_rg-HVz8CgmlkgnY0gmlwhKwS4w6KbXVsdGlhZGRyc5YACASsEuMOBuw-AAoErBLjDgbsP90DgnJzhQADAQAAiXNlY3AyNTZrMaEDruxS-Ig0PJsJjgufUnpCLUmyz3FqJIrelAt_QQ6Kl6mDdGNwguw-g3VkcILsQIV3YWt1MgE"}'
2025-02-04 17:10:29.804 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:10:29.810 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:10:29.810 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-10-28__5ce9deff-0690-4bc8-a84e-a5ad3efacfb0__wakuorg_nwaku:latest.log
2025-02-04 17:10:29.811 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:10:29.811 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:10:29.812 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:10:29.812 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.196.191
2025-02-04 17:10:29.812 DEBUG [src.node.docker_mananger] Generated ports ['1136', '1137', '1138', '1139', '1140']
2025-02-04 17:10:29.812 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:10:29.812 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:10:29.813 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:10:29.813 DEBUG [src.node.docker_mananger] docker run -i -t -p 1136:1136 -p 1137:1137 -p 1138:1138 -p 1139:1139 -p 1140:1140 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1138 --rest-port=1136 --tcp-port=1137 --discv5-udp-port=1139 --rest-address=0.0.0.0 --nat=extip:172.18.196.191 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cf7d5bbea940d8baaea32a8c03cd86fdeafd2cbb7bc45be518eb88e497d3c1fe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1140 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QAG24eLQOo7_PLVdvLdTHXOn8Vp0FYTrg3Y6UKaGnyO2dexODKshhGG3L-BuqNowM0g-cv3SfDTj1PR_rg-HVz8CgmlkgnY0gmlwhKwS4w6KbXVsdGlhZGRyc5YACASsEuMOBuw-AAoErBLjDgbsP90DgnJzhQADAQAAiXNlY3AyNTZrMaEDruxS-Ig0PJsJjgufUnpCLUmyz3FqJIrelAt_QQ6Kl6mDdGNwguw-g3VkcILsQIV3YWt1MgE
2025-02-04 17:10:30.057 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.196.191 waku 1faceeb90d159c1bd09b026c7d4da72c0453573e906abecdfd138d0c8c7ac5b3
2025-02-04 17:10:30.108 DEBUG [src.node.docker_mananger] Container started with ID 1faceeb90d15. Setting up logs at ./log/docker/node2_2025-02-04_17-10-28__5ce9deff-0690-4bc8-a84e-a5ad3efacfb0__wakuorg_nwaku:latest.log
2025-02-04 17:10:30.108 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 1136
2025-02-04 17:10:30.108 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:10:31.109 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1136/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:31.116 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:10:31.117 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:10:31.117 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1136/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:31.120 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.196.191/tcp/1137/p2p/16Uiu2HAm4YBbTR33n4pMAyogZUS1RCp88nnqsHtsUoTCT6EqZa73","/ip4/172.18.196.191/tcp/1138/ws/p2p/16Uiu2HAm4YBbTR33n4pMAyogZUS1RCp88nnqsHtsUoTCT6EqZa73"],"enrUri":"enr:-L24QH-Xb7fdkzaAWzsHmV9E2BfdOIjg5cycaMd1snMUJu8OWwiElKkO3KxRVvE5cqC5_E4pTOyXg7o-vKynprxv1xQCgmlkgnY0gmlwhKwSxL-KbXVsdGlhZGRyc5YACASsEsS_BgRxAAoErBLEvwYEct0DgnJzhQADAQAAiXNlY3AyNTZrMaECh2QnIFKbyyoffytcO5HvA2FTCQ6lAaDCrmjnYo-wM2KDdGNwggRxg3VkcIIEc4V3YWt1MgE"}'
2025-02-04 17:10:31.120 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:10:31.121 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1136/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.227.14/tcp/60478/p2p/16Uiu2HAmQRpJ8vRkZ2mxfLumdEPAU6oBETCsLomxKQcLqkrhFhur"]'
2025-02-04 17:10:31.123 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:31.124 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-04 17:10:31.124 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60477/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:10:31.128 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:31.128 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:1136/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:10:31.133 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:31.137 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60477/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:10:31.141 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:31.142 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:10:31.242 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:10:31.242 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60477/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:31.245 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689031136968192,"ephemeral":false}]'
2025-02-04 17:10:31.246 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:10:31.247 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1136/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:31.249 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689031136968192,"ephemeral":false}]'
2025-02-04 17:10:31.250 INFO [src.steps.relay] WARM UP successful!!
2025-02-04 17:10:31.251 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60477/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
2025-02-04 17:10:31.256 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:31.257 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:10:31.357 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:10:31.357 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60477/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:31.359 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1738689031251544064,"ephemeral":false}]'
2025-02-04 17:10:31.361 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:10:31.361 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1136/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:31.363 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1738689031251544064,"ephemeral":false}]'
2025-02-04 17:10:31.366 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:10:31.367 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:10:31.367 DEBUG [src.node.waku_node] Stopping container with id 0f77d913abb1
2025-02-04 17:10:32.267 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:10:32.267 DEBUG [src.node.waku_node] Stopping container with id 1faceeb90d15
2025-02-04 17:10:33.080 ERROR [src.node.docker_mananger] Max retries reached for container 0f77d913abb1. Exiting log stream.
2025-02-04 17:10:33.775 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:10:33.777 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:10:33.782 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:10:33.787 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
