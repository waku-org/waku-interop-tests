2025-02-04 17:12:48.192 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:12:48.192 DEBUG [tests.conftest] Running test: test_content_topic_not_in_docker_flags with id: 2025-02-04_17-12-48__52ff73fd-93de-401a-a40f-29d3f410f9ab
2025-02-04 17:12:48.192 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:12:48.193 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-04 17:12:48.193 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-04 17:12:48.200 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:12:48.200 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-12-48__52ff73fd-93de-401a-a40f-29d3f410f9ab__wakuorg_nwaku:latest.log
2025-02-04 17:12:48.200 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:12:48.200 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:12:48.201 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:12:48.202 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.62.172
2025-02-04 17:12:48.202 DEBUG [src.node.docker_mananger] Generated ports ['62769', '62770', '62771', '62772', '62773']
2025-02-04 17:12:48.202 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:12:48.202 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:12:48.202 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:12:48.202 DEBUG [src.node.docker_mananger] docker run -i -t -p 62769:62769 -p 62770:62770 -p 62771:62771 -p 62772:62772 -p 62773:62773 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62771 --rest-port=62769 --tcp-port=62770 --discv5-udp-port=62772 --rest-address=0.0.0.0 --nat=extip:172.18.62.172 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=55eaab6e8261913978a3db7fdcbb4dd63bec446fa6621ae6e844e01d3dddfaad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62773 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
2025-02-04 17:12:48.430 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.62.172 waku a9571d96030805271a3b31b7c0764bd66cf38a14f72636dab4ef5f4551b4f4c3
2025-02-04 17:12:48.477 DEBUG [src.node.docker_mananger] Container started with ID a9571d960308. Setting up logs at ./log/docker/node1_2025-02-04_17-12-48__52ff73fd-93de-401a-a40f-29d3f410f9ab__wakuorg_nwaku:latest.log
2025-02-04 17:12:48.478 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62769
2025-02-04 17:12:48.478 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:12:48.989 ERROR [src.node.docker_mananger] Max retries reached for container e0d581a58abf. Exiting log stream.
2025-02-04 17:12:49.478 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62769/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:49.481 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:12:49.481 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:12:49.482 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62769/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:49.484 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.62.172/tcp/62770/p2p/16Uiu2HAmEX89rfgjb8p6k77v19mpFE8k44Wmbi5WgE7aaUpbEUh5","/ip4/172.18.62.172/tcp/62771/ws/p2p/16Uiu2HAmEX89rfgjb8p6k77v19mpFE8k44Wmbi5WgE7aaUpbEUh5"],"enrUri":"enr:-L24QOifQJ31K8ua5SOPMdwKnOp8CzZ6xBpSCPp4WO95TBifFlfS2TpmiABdZiJtVpLT1Wyg1KfvdiziZDstav8jPP4CgmlkgnY0gmlwhKwSPqyKbXVsdGlhZGRyc5YACASsEj6sBvUyAAoErBI-rAb1M90DgnJzhQACAQAAiXNlY3AyNTZrMaEDG7OM1UKBvh8prbx-S2RHatHjhojwCg4uI3NAYafIkKiDdGNwgvUyg3VkcIL1NIV3YWt1MgU"}'
2025-02-04 17:12:49.484 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:12:49.490 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:12:49.491 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-12-48__52ff73fd-93de-401a-a40f-29d3f410f9ab__wakuorg_nwaku:latest.log
2025-02-04 17:12:49.491 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:12:49.491 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:12:49.492 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:12:49.492 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.185.64
2025-02-04 17:12:49.492 DEBUG [src.node.docker_mananger] Generated ports ['28820', '28821', '28822', '28823', '28824']
2025-02-04 17:12:49.493 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:12:49.493 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:12:49.493 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:12:49.493 DEBUG [src.node.docker_mananger] docker run -i -t -p 28820:28820 -p 28821:28821 -p 28822:28822 -p 28823:28823 -p 28824:28824 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=28822 --rest-port=28820 --tcp-port=28821 --discv5-udp-port=28823 --rest-address=0.0.0.0 --nat=extip:172.18.185.64 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=06eefe5ecad64e10ce18b0df7509560cc03cf9ba8f831be81903fcf2dbc05559 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=28824 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOifQJ31K8ua5SOPMdwKnOp8CzZ6xBpSCPp4WO95TBifFlfS2TpmiABdZiJtVpLT1Wyg1KfvdiziZDstav8jPP4CgmlkgnY0gmlwhKwSPqyKbXVsdGlhZGRyc5YACASsEj6sBvUyAAoErBI-rAb1M90DgnJzhQACAQAAiXNlY3AyNTZrMaEDG7OM1UKBvh8prbx-S2RHatHjhojwCg4uI3NAYafIkKiDdGNwgvUyg3VkcIL1NIV3YWt1MgU --pubsub-topic=/waku/2/rs/2/0
2025-02-04 17:12:49.717 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.185.64 waku 2969c5bbc4b7a3e6be8e87999cee7680b08abb192ef754c4886ee919f0d2ca27
2025-02-04 17:12:49.762 DEBUG [src.node.docker_mananger] Container started with ID 2969c5bbc4b7. Setting up logs at ./log/docker/node2_2025-02-04_17-12-48__52ff73fd-93de-401a-a40f-29d3f410f9ab__wakuorg_nwaku:latest.log
2025-02-04 17:12:49.762 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 28820
2025-02-04 17:12:49.762 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:12:50.763 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28820/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.771 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:12:50.771 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:12:50.771 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28820/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.776 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.185.64/tcp/28821/p2p/16Uiu2HAm5oSVKB39zweYYKGFS88qM2Mnd2iUbMWYsUj7s5JWkiwL","/ip4/172.18.185.64/tcp/28822/ws/p2p/16Uiu2HAm5oSVKB39zweYYKGFS88qM2Mnd2iUbMWYsUj7s5JWkiwL"],"enrUri":"enr:-L24QFf4FxBVRRjsNCgtnLZLLpuqstaCITe78FlpGMShdEj8Bfywen4nisZx4Isip3dttgiYO-WZHndRCmxWDLjxdLECgmlkgnY0gmlwhKwSuUCKbXVsdGlhZGRyc5YACASsErlABnCVAAoErBK5QAZwlt0DgnJzhQACAQAAiXNlY3AyNTZrMaECmihkiOkuzv2mKCYl-EqFZfm5pdRP3XuSQRYCrVjnMjuDdGNwgnCVg3VkcIJwl4V3YWt1MgE"}'
2025-02-04 17:12:50.776 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:12:50.777 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28820/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.62.172/tcp/62770/p2p/16Uiu2HAmEX89rfgjb8p6k77v19mpFE8k44Wmbi5WgE7aaUpbEUh5"]'
2025-02-04 17:12:50.781 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.782 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62769/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-04 17:12:50.786 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.787 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:28820/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-04 17:12:50.792 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.792 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62769/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:12:50.799 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:12:50.799 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:12:50.899 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:12:50.900 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62769/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.902 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738689170792662272,"ephemeral":false}]'
2025-02-04 17:12:50.903 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:12:50.904 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:28820/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:12:50.906 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738689170792662272,"ephemeral":false}]'
2025-02-04 17:12:50.908 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:12:50.909 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:12:50.910 DEBUG [src.node.waku_node] Stopping container with id a9571d960308
2025-02-04 17:12:51.990 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:12:51.990 DEBUG [src.node.waku_node] Stopping container with id 2969c5bbc4b7
2025-02-04 17:12:52.801 ERROR [src.node.docker_mananger] Max retries reached for container a9571d960308. Exiting log stream.
2025-02-04 17:12:53.486 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:12:53.488 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:12:53.492 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:12:53.497 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
