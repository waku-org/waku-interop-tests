2025-02-04 17:13:15.048 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:13:15.049 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-04_17-13-15__9a421511-f9a7-453b-a761-e0948f1a947a
2025-02-04 17:13:15.049 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:13:15.049 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-04 17:13:15.049 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-04 17:13:15.056 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:15.056 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-13-15__9a421511-f9a7-453b-a761-e0948f1a947a__wakuorg_nwaku:latest.log
2025-02-04 17:13:15.056 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:15.056 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:15.057 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:15.058 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.239.199
2025-02-04 17:13:15.058 DEBUG [src.node.docker_mananger] Generated ports ['35960', '35961', '35962', '35963', '35964']
2025-02-04 17:13:15.058 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:15.058 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:15.058 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:15.058 DEBUG [src.node.docker_mananger] docker run -i -t -p 35960:35960 -p 35961:35961 -p 35962:35962 -p 35963:35963 -p 35964:35964 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=35962 --rest-port=35960 --tcp-port=35961 --discv5-udp-port=35963 --rest-address=0.0.0.0 --nat=extip:172.18.239.199 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e13ad5ecac8c4edff5193c0ba09cb6dd28a5bcb65e55b550b7243aec7b061a3f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=35964 --metrics-logging=true --relay=true
2025-02-04 17:13:15.294 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.239.199 waku 47ae38b63e5d40e39a8c4c56c2d0fdd61feab70314e6292aad7a2a3a52b87e0e
2025-02-04 17:13:15.347 DEBUG [src.node.docker_mananger] Container started with ID 47ae38b63e5d. Setting up logs at ./log/docker/node1_2025-02-04_17-13-15__9a421511-f9a7-453b-a761-e0948f1a947a__wakuorg_nwaku:latest.log
2025-02-04 17:13:15.347 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 35960
2025-02-04 17:13:15.348 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:15.838 ERROR [src.node.docker_mananger] Max retries reached for container 7d890ff7a3f3. Exiting log stream.
2025-02-04 17:13:16.349 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35960/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:16.352 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:16.352 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:16.352 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35960/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:16.354 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.239.199/tcp/35961/p2p/16Uiu2HAkx6VSrrSYASAbFT1mMW7gZ2HrAodp9YavWG6PP5Aq4pGd","/ip4/172.18.239.199/tcp/35962/ws/p2p/16Uiu2HAkx6VSrrSYASAbFT1mMW7gZ2HrAodp9YavWG6PP5Aq4pGd"],"enrUri":"enr:-L24QGWIUCpSlAFmiGCxgA5blonnbneEK2WqmN0jctUQ8OVeTAXlWZgGiIeQe6Dy-D0k-wxGzTV1iReRRD1v0PXnW4gCgmlkgnY0gmlwhKwS78eKbXVsdGlhZGRyc5YACASsEu_HBox5AAoErBLvxwaMet0DgnJzhQADAQAAiXNlY3AyNTZrMaECJ6kdhmFE1S_SffrISDlYUb_LMIk_sAA2Q0cgcc-a_T6DdGNwgox5g3VkcIKMe4V3YWt1MgE"}'
2025-02-04 17:13:16.355 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:16.361 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:16.361 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-13-15__9a421511-f9a7-453b-a761-e0948f1a947a__wakuorg_nwaku:latest.log
2025-02-04 17:13:16.361 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:16.361 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:16.362 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:16.363 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.97.168
2025-02-04 17:13:16.363 DEBUG [src.node.docker_mananger] Generated ports ['36311', '36312', '36313', '36314', '36315']
2025-02-04 17:13:16.363 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:16.363 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:16.363 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:16.363 DEBUG [src.node.docker_mananger] docker run -i -t -p 36311:36311 -p 36312:36312 -p 36313:36313 -p 36314:36314 -p 36315:36315 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36313 --rest-port=36311 --tcp-port=36312 --discv5-udp-port=36314 --rest-address=0.0.0.0 --nat=extip:172.18.97.168 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0adaced9d02be3abecab6aea182a52ad27ceeccd3c6bb0beb755f72c9bd5bef2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36315 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QGWIUCpSlAFmiGCxgA5blonnbneEK2WqmN0jctUQ8OVeTAXlWZgGiIeQe6Dy-D0k-wxGzTV1iReRRD1v0PXnW4gCgmlkgnY0gmlwhKwS78eKbXVsdGlhZGRyc5YACASsEu_HBox5AAoErBLvxwaMet0DgnJzhQADAQAAiXNlY3AyNTZrMaECJ6kdhmFE1S_SffrISDlYUb_LMIk_sAA2Q0cgcc-a_T6DdGNwgox5g3VkcIKMe4V3YWt1MgE
2025-02-04 17:13:16.591 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.97.168 waku 380f2cdad28d6eb9bc84ebeadbd125bfb9b4ed32e5e58a068a5c72127f718e65
2025-02-04 17:13:16.638 DEBUG [src.node.docker_mananger] Container started with ID 380f2cdad28d. Setting up logs at ./log/docker/node2_2025-02-04_17-13-15__9a421511-f9a7-453b-a761-e0948f1a947a__wakuorg_nwaku:latest.log
2025-02-04 17:13:16.639 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36311
2025-02-04 17:13:16.639 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:17.639 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36311/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:17.645 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:17.645 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:17.646 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36311/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:17.653 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.168/tcp/36312/p2p/16Uiu2HAmHeNiSfyQgh93PcNWCCcAwiD17GH2ZGbFCuP5qGqyHkYF","/ip4/172.18.97.168/tcp/36313/ws/p2p/16Uiu2HAmHeNiSfyQgh93PcNWCCcAwiD17GH2ZGbFCuP5qGqyHkYF"],"enrUri":"enr:-L24QNNoru_tzMl8IRidHBejoW-ty_uLsg95vI8PZGFizH9JJloxHgQFTlx1ShpXKrGKMYVIp--vcOUgX3S-2ZEiOIcCgmlkgnY0gmlwhKwSYaiKbXVsdGlhZGRyc5YACASsEmGoBo3YAAoErBJhqAaN2d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDSiIkRa9nqkRZa9gIMpxEppdxAX4fv2KqoEnPhQEj5eCDdGNwgo3Yg3VkcIKN2oV3YWt1MgE"}'
2025-02-04 17:13:17.655 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:17.655 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36311/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.239.199/tcp/35961/p2p/16Uiu2HAkx6VSrrSYASAbFT1mMW7gZ2HrAodp9YavWG6PP5Aq4pGd"]'
2025-02-04 17:13:17.658 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:17.659 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-04 17:13:17.659 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:13:17.663 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:17.663 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36311/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:13:17.669 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:17.670 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.675 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:17.675 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:13:17.775 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:13:17.776 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:17.778 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689197670138880,"ephemeral":false}]'
2025-02-04 17:13:17.780 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:13:17.780 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36311/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:17.782 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689197670138880,"ephemeral":false}]'
2025-02-04 17:13:17.784 INFO [src.steps.relay] WARM UP successful!!
2025-02-04 17:13:17.785 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-04 17:13:17.785 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.787 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:13:17.788 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-04 17:13:17.788 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.790 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:13:17.791 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-04 17:13:17.791 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.794 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:13:17.794 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-04 17:13:17.795 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.797 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:13:17.797 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-04 17:13:17.798 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.800 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:13:17.801 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-04 17:13:17.801 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.804 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:13:17.804 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-04 17:13:17.805 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:17.807 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:35960/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:13:17.809 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:13:17.810 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:13:17.810 DEBUG [src.node.waku_node] Stopping container with id 47ae38b63e5d
2025-02-04 17:13:18.853 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:18.854 DEBUG [src.node.waku_node] Stopping container with id 380f2cdad28d
2025-02-04 17:13:19.684 ERROR [src.node.docker_mananger] Max retries reached for container 47ae38b63e5d. Exiting log stream.
2025-02-04 17:13:20.373 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:20.374 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:13:20.383 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:13:20.388 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
