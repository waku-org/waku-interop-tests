2025-02-04 17:10:15.464 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:10:15.464 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-04_17-10-15__1507df7d-e61d-443d-b7da-e6758231e1d7
2025-02-04 17:10:15.464 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:10:15.465 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-04 17:10:15.465 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-04 17:10:15.471 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:10:15.471 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-10-15__1507df7d-e61d-443d-b7da-e6758231e1d7__wakuorg_nwaku:latest.log
2025-02-04 17:10:15.471 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:10:15.472 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:10:15.473 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:10:15.473 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.148.215
2025-02-04 17:10:15.473 DEBUG [src.node.docker_mananger] Generated ports ['23443', '23444', '23445', '23446', '23447']
2025-02-04 17:10:15.473 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:10:15.474 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:10:15.474 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:10:15.474 DEBUG [src.node.docker_mananger] docker run -i -t -p 23443:23443 -p 23444:23444 -p 23445:23445 -p 23446:23446 -p 23447:23447 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23445 --rest-port=23443 --tcp-port=23444 --discv5-udp-port=23446 --rest-address=0.0.0.0 --nat=extip:172.18.148.215 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7bfcd1e9fde74dbef669deebb6cf66bdebbfe51381df50add6aa436c43ceb443 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23447 --metrics-logging=true --relay=true
2025-02-04 17:10:15.710 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.148.215 waku 585cae1655f3d18c99ece507d9a7f483cf515d04ecc6464a7f7b1775341a6e23
2025-02-04 17:10:15.760 DEBUG [src.node.docker_mananger] Container started with ID 585cae1655f3. Setting up logs at ./log/docker/node1_2025-02-04_17-10-15__1507df7d-e61d-443d-b7da-e6758231e1d7__wakuorg_nwaku:latest.log
2025-02-04 17:10:15.760 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23443
2025-02-04 17:10:15.761 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:10:16.253 ERROR [src.node.docker_mananger] Max retries reached for container 410af7002d15. Exiting log stream.
2025-02-04 17:10:16.762 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23443/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:16.765 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:10:16.766 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:10:16.766 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23443/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:16.768 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.148.215/tcp/23444/p2p/16Uiu2HAmCpPg4bKCeP7xTDuLmqe4UsvdZJDAZ9AsL5HegVqsrQYP","/ip4/172.18.148.215/tcp/23445/ws/p2p/16Uiu2HAmCpPg4bKCeP7xTDuLmqe4UsvdZJDAZ9AsL5HegVqsrQYP"],"enrUri":"enr:-L24QInqU68ZgjFSY_ffGsSiOYT4PC92faLiJOBpAX3ftymCSTTIDQcKRZqrWYz5Ph0Hz8SFKMQXLjfXMJpochcGzkUCgmlkgnY0gmlwhKwSlNeKbXVsdGlhZGRyc5YACASsEpTXBluUAAoErBKU1wZbld0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAmiZdN4zKKr2BitlBgqIuE7cM7q8-Ntn-dcZzwSPR6CDdGNwgluUg3VkcIJbloV3YWt1MgE"}'
2025-02-04 17:10:16.768 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:10:16.775 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:10:16.775 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-10-15__1507df7d-e61d-443d-b7da-e6758231e1d7__wakuorg_nwaku:latest.log
2025-02-04 17:10:16.775 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:10:16.775 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:10:16.777 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:10:16.777 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.228.43
2025-02-04 17:10:16.777 DEBUG [src.node.docker_mananger] Generated ports ['44816', '44817', '44818', '44819', '44820']
2025-02-04 17:10:16.777 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:10:16.777 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:10:16.777 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:10:16.777 DEBUG [src.node.docker_mananger] docker run -i -t -p 44816:44816 -p 44817:44817 -p 44818:44818 -p 44819:44819 -p 44820:44820 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44818 --rest-port=44816 --tcp-port=44817 --discv5-udp-port=44819 --rest-address=0.0.0.0 --nat=extip:172.18.228.43 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=980fb45dee9afc74ee69b9b0aedb3efe4bbb1aae8ffc2bbe1c686ada5b45ffcf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44820 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QInqU68ZgjFSY_ffGsSiOYT4PC92faLiJOBpAX3ftymCSTTIDQcKRZqrWYz5Ph0Hz8SFKMQXLjfXMJpochcGzkUCgmlkgnY0gmlwhKwSlNeKbXVsdGlhZGRyc5YACASsEpTXBluUAAoErBKU1wZbld0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAmiZdN4zKKr2BitlBgqIuE7cM7q8-Ntn-dcZzwSPR6CDdGNwgluUg3VkcIJbloV3YWt1MgE
2025-02-04 17:10:17.013 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.228.43 waku e2844c7342403abace87616d1c08cbea0048364ceacde857b3aea0cb016a90f4
2025-02-04 17:10:17.062 DEBUG [src.node.docker_mananger] Container started with ID e2844c734240. Setting up logs at ./log/docker/node2_2025-02-04_17-10-15__1507df7d-e61d-443d-b7da-e6758231e1d7__wakuorg_nwaku:latest.log
2025-02-04 17:10:17.063 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44816
2025-02-04 17:10:17.063 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:10:18.064 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44816/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:18.081 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:10:18.082 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:10:18.082 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44816/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:18.090 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.228.43/tcp/44817/p2p/16Uiu2HAmSsWfo48AYUsPj1D12KoisNi9M5UqSxKcR6jydc4q42YJ","/ip4/172.18.228.43/tcp/44818/ws/p2p/16Uiu2HAmSsWfo48AYUsPj1D12KoisNi9M5UqSxKcR6jydc4q42YJ"],"enrUri":"enr:-L24QG46A8M-fHAK6EIzQ2OXHC16UnJumKbBTvPxXN-pDYZyDIzjqItMXdoG3QV1RdndDHtSAkxCWSJHbpPYxdIDsSECgmlkgnY0gmlwhKwS5CuKbXVsdGlhZGRyc5YACASsEuQrBq8RAAoErBLkKwavEt0DgnJzhQADAQAAiXNlY3AyNTZrMaED0zjeWIfa4jaNV4xHgkGpd3y7v2RV1w2FdqzYZ6LgK1ODdGNwgq8Rg3VkcIKvE4V3YWt1MgE"}'
2025-02-04 17:10:18.091 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:10:18.091 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44816/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.148.215/tcp/23444/p2p/16Uiu2HAmCpPg4bKCeP7xTDuLmqe4UsvdZJDAZ9AsL5HegVqsrQYP"]'
2025-02-04 17:10:18.093 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:18.094 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-04 17:10:18.094 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23443/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:10:18.098 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:18.099 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44816/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:10:18.105 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:18.106 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:10:18.112 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:18.112 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:10:18.213 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-04 17:10:18.213 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:18.216 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689018106256384,"ephemeral":false}]'
2025-02-04 17:10:18.218 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-04 17:10:18.218 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44816/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:18.221 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738689018106256384,"ephemeral":false}]'
2025-02-04 17:10:18.222 INFO [src.steps.relay] WARM UP successful!!
2025-02-04 17:10:18.223 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-04 17:10:18.223 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:10:18.226 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:10:18.226 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-04 17:10:18.226 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-04 17:10:18.229 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:10:18.229 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-04 17:10:18.229 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-04 17:10:18.232 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:10:18.232 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-04 17:10:18.232 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-04 17:10:18.234 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:10:18.235 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-04 17:10:18.235 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-04 17:10:18.237 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23443/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-04 17:10:18.239 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:10:18.240 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:10:18.240 DEBUG [src.node.waku_node] Stopping container with id 585cae1655f3
2025-02-04 17:10:19.266 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:10:19.267 DEBUG [src.node.waku_node] Stopping container with id e2844c734240
2025-02-04 17:10:20.080 ERROR [src.node.docker_mananger] Max retries reached for container 585cae1655f3. Exiting log stream.
2025-02-04 17:10:20.769 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:10:20.771 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:10:20.776 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:10:20.781 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
