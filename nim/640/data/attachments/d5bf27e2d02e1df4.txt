2025-02-04 17:13:08.166 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:13:08.166 DEBUG [tests.conftest] Running test: test_main_node_relay_and_store__peer_only_store with id: 2025-02-04_17-13-08__5047d49e-5a89-496d-a9f0-57bd1759c379
2025-02-04 17:13:08.166 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:13:08.166 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-04 17:13:08.173 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:08.173 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-04_17-13-08__5047d49e-5a89-496d-a9f0-57bd1759c379__wakuorg_nwaku:latest.log
2025-02-04 17:13:08.174 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:08.174 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:08.175 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:08.175 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.227.143
2025-02-04 17:13:08.175 DEBUG [src.node.docker_mananger] Generated ports ['10143', '10144', '10145', '10146', '10147']
2025-02-04 17:13:08.175 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:08.176 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:08.176 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:08.176 DEBUG [src.node.docker_mananger] docker run -i -t -p 10143:10143 -p 10144:10144 -p 10145:10145 -p 10146:10146 -p 10147:10147 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10145 --rest-port=10143 --tcp-port=10144 --discv5-udp-port=10146 --rest-address=0.0.0.0 --nat=extip:172.18.227.143 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bbadfcd09c4dfaf1ffbccbef8b4a25d9f0b4ea79a2fcfeadc82a6bafdd1bf2aa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10147 --metrics-logging=true --store=true --relay=true
2025-02-04 17:13:08.399 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.227.143 waku b364113f9da7eba2e3b36c09c1259791d2848a3d9bdae88bb7c8728d8d8c8130
2025-02-04 17:13:08.446 DEBUG [src.node.docker_mananger] Container started with ID b364113f9da7. Setting up logs at ./log/docker/publishing_node1_2025-02-04_17-13-08__5047d49e-5a89-496d-a9f0-57bd1759c379__wakuorg_nwaku:latest.log
2025-02-04 17:13:08.448 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10143
2025-02-04 17:13:08.448 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:08.970 ERROR [src.node.docker_mananger] Max retries reached for container 55c8a53e77ad. Exiting log stream.
2025-02-04 17:13:09.448 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10143/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:09.451 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:09.452 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:09.452 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10143/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:09.454 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.227.143/tcp/10144/p2p/16Uiu2HAmPMXQqnWrykXuM798CKPaGKLSKhrU4VpAV9nSiDikCZVA","/ip4/172.18.227.143/tcp/10145/ws/p2p/16Uiu2HAmPMXQqnWrykXuM798CKPaGKLSKhrU4VpAV9nSiDikCZVA"],"enrUri":"enr:-L24QD2fXbUE9hv8wKf2NB8FaxfUY_zz4gtrK9HSiSIjGrO2Byi_e5BrNRPx5Q3zn17qP9I7eGThu8Hm-GcCuyFqXKQCgmlkgnY0gmlwhKwS44-KbXVsdGlhZGRyc5YACASsEuOPBiegAAoErBLjjwYnod0DgnJzhQADAQAAiXNlY3AyNTZrMaEDnvc5AeYWmZzk0zLYd-ScJR9Jnt2vYiyGzI5LhHCER2mDdGNwgiegg3VkcIInooV3YWt1MgM"}'
2025-02-04 17:13:09.454 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:09.461 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:13:09.461 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-04_17-13-08__5047d49e-5a89-496d-a9f0-57bd1759c379__wakuorg_nwaku:latest.log
2025-02-04 17:13:09.461 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:13:09.461 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:13:09.462 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:13:09.463 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.224.85
2025-02-04 17:13:09.463 DEBUG [src.node.docker_mananger] Generated ports ['33172', '33173', '33174', '33175', '33176']
2025-02-04 17:13:09.463 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:13:09.463 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:13:09.463 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:13:09.463 DEBUG [src.node.docker_mananger] docker run -i -t -p 33172:33172 -p 33173:33173 -p 33174:33174 -p 33175:33175 -p 33176:33176 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33174 --rest-port=33172 --tcp-port=33173 --discv5-udp-port=33175 --rest-address=0.0.0.0 --nat=extip:172.18.224.85 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c3ce1f7184368c05e2e8fd6eba5fac45ab0bbc8c74a2dafb4b1fc1d0a67887f6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33176 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QD2fXbUE9hv8wKf2NB8FaxfUY_zz4gtrK9HSiSIjGrO2Byi_e5BrNRPx5Q3zn17qP9I7eGThu8Hm-GcCuyFqXKQCgmlkgnY0gmlwhKwS44-KbXVsdGlhZGRyc5YACASsEuOPBiegAAoErBLjjwYnod0DgnJzhQADAQAAiXNlY3AyNTZrMaEDnvc5AeYWmZzk0zLYd-ScJR9Jnt2vYiyGzI5LhHCER2mDdGNwgiegg3VkcIInooV3YWt1MgM --storenode=/ip4/172.18.227.143/tcp/10144/p2p/16Uiu2HAmPMXQqnWrykXuM798CKPaGKLSKhrU4VpAV9nSiDikCZVA --store=true --relay=false
2025-02-04 17:13:09.690 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.224.85 waku 0b3ab4b7c0ca28662a9b8662aba3e07a30498fd064f3d50abc7ab207705a2247
2025-02-04 17:13:09.738 DEBUG [src.node.docker_mananger] Container started with ID 0b3ab4b7c0ca. Setting up logs at ./log/docker/store_node1_2025-02-04_17-13-08__5047d49e-5a89-496d-a9f0-57bd1759c379__wakuorg_nwaku:latest.log
2025-02-04 17:13:09.738 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33172
2025-02-04 17:13:09.739 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:13:10.740 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33172/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:10.743 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:13:10.743 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:13:10.743 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33172/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:10.746 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.224.85/tcp/33173/p2p/16Uiu2HAm9FTbQwieEpJNjJoZ88qAhD5H1DeGqXNost8uSh74NyvF","/ip4/172.18.224.85/tcp/33174/ws/p2p/16Uiu2HAm9FTbQwieEpJNjJoZ88qAhD5H1DeGqXNost8uSh74NyvF"],"enrUri":"enr:-L24QJODKvQWrXcaoTOUQ30HZ4I3vnSPgYzgk1Suo0BWMGGfapiV2NBVw6e5UHy64hrydHlyY07AlFdBYNUxRJdLJkwCgmlkgnY0gmlwhKwS4FWKbXVsdGlhZGRyc5YACASsEuBVBoGVAAoErBLgVQaBlt0DgnJzhQADAQAAiXNlY3AyNTZrMaECzWXN3DjWuDz6vKi9i0WXCfTD5_3pn9YGRTrsQOlUYKiDdGNwgoGVg3VkcIKBl4V3YWt1MgI"}'
2025-02-04 17:13:10.746 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:13:10.746 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33172/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.227.143/tcp/10144/p2p/16Uiu2HAmPMXQqnWrykXuM798CKPaGKLSKhrU4VpAV9nSiDikCZVA"]'
2025-02-04 17:13:10.786 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:10.788 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10143/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-04 17:13:10.804 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:10.805 DEBUG [src.steps.store] Relaying message
2025-02-04 17:13:10.806 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10143/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:13:10.812 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:13:10.812 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-04 17:13:11.013 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-04 17:13:11.014 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10143/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:13:11.017 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-04 17:13:11.018 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:13:11.020 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:13:11.020 DEBUG [src.node.waku_node] Stopping container with id b364113f9da7
2025-02-04 17:13:11.960 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:11.961 DEBUG [src.node.waku_node] Stopping container with id 0b3ab4b7c0ca
2025-02-04 17:13:12.773 ERROR [src.node.docker_mananger] Max retries reached for container b364113f9da7. Exiting log stream.
2025-02-04 17:13:13.499 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:13:13.500 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:13:13.505 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:13:13.508 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
