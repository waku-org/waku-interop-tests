2025-02-04 17:11:54.821 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:11:54.823 DEBUG [tests.conftest] Running test: test_store_with_peerAddr with id: 2025-02-04_17-11-54__302fc665-4875-41df-b576-9eab19aaccfa
2025-02-04 17:11:54.823 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:11:54.823 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-04 17:11:54.824 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-04 17:11:54.832 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:11:54.832 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-04_17-11-54__302fc665-4875-41df-b576-9eab19aaccfa__wakuorg_nwaku:latest.log
2025-02-04 17:11:54.833 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:11:54.834 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:11:54.836 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:11:54.836 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.37.129
2025-02-04 17:11:54.836 DEBUG [src.node.docker_mananger] Generated ports ['7038', '7039', '7040', '7041', '7042']
2025-02-04 17:11:54.837 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:11:54.837 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:11:54.837 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:11:54.837 DEBUG [src.node.docker_mananger] docker run -i -t -p 7038:7038 -p 7039:7039 -p 7040:7040 -p 7041:7041 -p 7042:7042 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7040 --rest-port=7038 --tcp-port=7039 --discv5-udp-port=7041 --rest-address=0.0.0.0 --nat=extip:172.18.37.129 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ea1e83e57bfc4f1aea83aff1b0c2de40b9575a3dadca32a5b303d6daf4eb3bc6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7042 --metrics-logging=true --store=true --relay=true
2025-02-04 17:11:55.076 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.37.129 waku b6692f1fa24a85b1fa802e1782ef77ba237eed880e60e42746f5e3b28f1c85ea
2025-02-04 17:11:55.122 DEBUG [src.node.docker_mananger] Container started with ID b6692f1fa24a. Setting up logs at ./log/docker/publishing_node1_2025-02-04_17-11-54__302fc665-4875-41df-b576-9eab19aaccfa__wakuorg_nwaku:latest.log
2025-02-04 17:11:55.123 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 7038
2025-02-04 17:11:55.124 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:11:55.654 ERROR [src.node.docker_mananger] Max retries reached for container 340efaa4905b. Exiting log stream.
2025-02-04 17:11:56.125 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7038/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:56.128 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:11:56.128 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:11:56.129 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7038/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:56.131 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.37.129/tcp/7039/p2p/16Uiu2HAmK8fGbd3mpQPJsWVacMua5i9YyQxFxQUvGgi8HRUAyqJB","/ip4/172.18.37.129/tcp/7040/ws/p2p/16Uiu2HAmK8fGbd3mpQPJsWVacMua5i9YyQxFxQUvGgi8HRUAyqJB"],"enrUri":"enr:-L24QCxDgiBndLWB4kQPhGs_Z_oTZ51Fk2TRW2esQMFGyJ1leq6pDb6FWJHXzNr3pk3twzwV2zzBO2zoL4uxWlh5La0CgmlkgnY0gmlwhKwSJYGKbXVsdGlhZGRyc5YACASsEiWBBht_AAoErBIlgQYbgN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYDzPMvChJDKUmxRhavMnCSuflhQf7hK8dNLNt5-G49SDdGNwght_g3VkcIIbgYV3YWt1MgM"}'
2025-02-04 17:11:56.131 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:11:56.138 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:11:56.138 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-04_17-11-54__302fc665-4875-41df-b576-9eab19aaccfa__wakuorg_nwaku:latest.log
2025-02-04 17:11:56.138 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:11:56.138 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:11:56.140 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:11:56.140 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.142.240
2025-02-04 17:11:56.140 DEBUG [src.node.docker_mananger] Generated ports ['45513', '45514', '45515', '45516', '45517']
2025-02-04 17:11:56.140 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:11:56.140 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:11:56.140 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:11:56.141 DEBUG [src.node.docker_mananger] docker run -i -t -p 45513:45513 -p 45514:45514 -p 45515:45515 -p 45516:45516 -p 45517:45517 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45515 --rest-port=45513 --tcp-port=45514 --discv5-udp-port=45516 --rest-address=0.0.0.0 --nat=extip:172.18.142.240 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1feb3d7b1aa8528a8e39a9a3ba4c1aa7acdd1a9f1bf99eedc5b61ebd8d11d0ad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45517 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QCxDgiBndLWB4kQPhGs_Z_oTZ51Fk2TRW2esQMFGyJ1leq6pDb6FWJHXzNr3pk3twzwV2zzBO2zoL4uxWlh5La0CgmlkgnY0gmlwhKwSJYGKbXVsdGlhZGRyc5YACASsEiWBBht_AAoErBIlgQYbgN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYDzPMvChJDKUmxRhavMnCSuflhQf7hK8dNLNt5-G49SDdGNwght_g3VkcIIbgYV3YWt1MgM --storenode=/ip4/172.18.37.129/tcp/7039/p2p/16Uiu2HAmK8fGbd3mpQPJsWVacMua5i9YyQxFxQUvGgi8HRUAyqJB --store=true --relay=true
2025-02-04 17:11:56.365 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.142.240 waku 106c141e26cfd6a1db61a7163a8f762b74f8fbca64d608cc70af121e433053e8
2025-02-04 17:11:56.414 DEBUG [src.node.docker_mananger] Container started with ID 106c141e26cf. Setting up logs at ./log/docker/store_node1_2025-02-04_17-11-54__302fc665-4875-41df-b576-9eab19aaccfa__wakuorg_nwaku:latest.log
2025-02-04 17:11:56.416 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 45513
2025-02-04 17:11:56.416 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:11:57.416 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45513/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:57.419 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:11:57.419 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:11:57.420 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45513/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:57.422 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.142.240/tcp/45514/p2p/16Uiu2HAm699pecZugF8Wtqw3K2uXz92WZbYyVnWy7fkErd27Ce2E","/ip4/172.18.142.240/tcp/45515/ws/p2p/16Uiu2HAm699pecZugF8Wtqw3K2uXz92WZbYyVnWy7fkErd27Ce2E"],"enrUri":"enr:-L24QEkrJVv2xAjOJeZsAFSRJM743PuHCp7F_BmLuMNAdwaSESSabCBrA0HDzLlbPsKhhtnK9WwXxbOdGGeUqzfHd1oCgmlkgnY0gmlwhKwSjvCKbXVsdGlhZGRyc5YACASsEo7wBrHKAAoErBKO8Aaxy90DgnJzhQADAQAAiXNlY3AyNTZrMaECnzUp83pXLAaDh1DylglkOty8hC4NHKDIaQtlEc2HwLODdGNwgrHKg3VkcIKxzIV3YWt1MgM"}'
2025-02-04 17:11:57.422 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:11:57.422 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45513/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.37.129/tcp/7039/p2p/16Uiu2HAmK8fGbd3mpQPJsWVacMua5i9YyQxFxQUvGgi8HRUAyqJB"]'
2025-02-04 17:11:57.425 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:57.425 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7038/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-04 17:11:57.428 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:57.428 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45513/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-04 17:11:57.430 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:57.431 DEBUG [src.steps.store] Relaying message
2025-02-04 17:11:57.431 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7038/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:11:57.437 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:11:57.437 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-04 17:11:57.639 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-04 17:11:57.639 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45513/store/v3/messages?peerAddr=%2Fip4%2F172.18.37.129%2Ftcp%2F7039%2Fp2p%2F16Uiu2HAmK8fGbd3mpQPJsWVacMua5i9YyQxFxQUvGgi8HRUAyqJB&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:11:57.648 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"b8ea19ec16e23406bd71","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xed7b710a0a6b244cf3d18323fd543aad7031defc5b6a5a9477c60b02128f8643"}]}'
2025-02-04 17:11:57.650 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:11:57.651 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:11:57.651 DEBUG [src.node.waku_node] Stopping container with id b6692f1fa24a
2025-02-04 17:11:58.670 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:11:58.671 DEBUG [src.node.waku_node] Stopping container with id 106c141e26cf
2025-02-04 17:11:59.484 ERROR [src.node.docker_mananger] Max retries reached for container b6692f1fa24a. Exiting log stream.
2025-02-04 17:12:00.186 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:12:00.187 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:12:00.193 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:12:00.199 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
