2025-02-04 17:10:15.216 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:10:15.217 DEBUG [tests.conftest] Running test: test_msg_stored_when_ephemeral_false with id: 2025-02-04_17-10-15__f7400c08-c83c-4a02-8d6a-cbaef56645e3
2025-02-04 17:10:15.217 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:10:15.217 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-04 17:10:15.217 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-04 17:10:15.223 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:10:15.223 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-10-15__f7400c08-c83c-4a02-8d6a-cbaef56645e3__wakuorg_nwaku:latest.log
2025-02-04 17:10:15.228 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:10:15.229 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-10-15__f7400c08-c83c-4a02-8d6a-cbaef56645e3__wakuorg_nwaku:latest.log
2025-02-04 17:10:15.234 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:10:15.234 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-04_17-10-15__f7400c08-c83c-4a02-8d6a-cbaef56645e3__wakuorg_nwaku:latest.log
2025-02-04 17:10:15.234 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-04 17:10:15.234 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-04 17:10:15.235 DEBUG [tests.e2e.test_e2e] Start 3 nodes
2025-02-04 17:10:15.235 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:10:15.235 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:10:15.236 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:10:15.237 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.54.71
2025-02-04 17:10:15.237 DEBUG [src.node.docker_mananger] Generated ports ['61958', '61959', '61960', '61961', '61962']
2025-02-04 17:10:15.237 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:10:15.237 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:10:15.237 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:10:15.237 DEBUG [src.node.docker_mananger] docker run -i -t -p 61958:61958 -p 61959:61959 -p 61960:61960 -p 61961:61961 -p 61962:61962 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61960 --rest-port=61958 --tcp-port=61959 --discv5-udp-port=61961 --rest-address=0.0.0.0 --nat=extip:172.18.54.71 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f6dcd58a3471ad820cb6a3acd6465edcd2bb557ee862ea08b3c4aefb95a62fdd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61962 --metrics-logging=true --relay=true --store=true
2025-02-04 17:10:15.457 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.54.71 waku cb498385100ed1454e484f670a9cb821e68d5d3750bb71d4cd6b87704bcb8f47
2025-02-04 17:10:15.507 DEBUG [src.node.docker_mananger] Container started with ID cb498385100e. Setting up logs at ./log/docker/node1_2025-02-04_17-10-15__f7400c08-c83c-4a02-8d6a-cbaef56645e3__wakuorg_nwaku:latest.log
2025-02-04 17:10:15.508 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61958
2025-02-04 17:10:15.509 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:10:16.008 ERROR [src.node.docker_mananger] Max retries reached for container b2efdd99dbba. Exiting log stream.
2025-02-04 17:10:16.510 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61958/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:16.513 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:10:16.513 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:10:16.513 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61958/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:16.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.54.71/tcp/61959/p2p/16Uiu2HAmR8ftksugaFCAeD6C5PPYb51mMnZyd9t5AxGMVGb11n8B","/ip4/172.18.54.71/tcp/61960/ws/p2p/16Uiu2HAmR8ftksugaFCAeD6C5PPYb51mMnZyd9t5AxGMVGb11n8B"],"enrUri":"enr:-L24QOpUCv5dcos2NOA3Q8pfs8hdYjp09bE7vQAts2RAuwd2K9k84VJK6gaq-twIVt0Fx_t_7zpeC8uq80gA4Us53xUCgmlkgnY0gmlwhKwSNkeKbXVsdGlhZGRyc5YACASsEjZHBvIHAAoErBI2RwbyCN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDuWOix3uUGQ8fGymyTcpY1Kw_2b3MViL5ywR_feMx0fSDdGNwgvIHg3VkcILyCYV3YWt1MgM"}'
2025-02-04 17:10:16.515 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:10:16.515 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:10:16.516 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:10:16.517 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:10:16.517 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.215.159
2025-02-04 17:10:16.517 DEBUG [src.node.docker_mananger] Generated ports ['37262', '37263', '37264', '37265', '37266']
2025-02-04 17:10:16.517 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:10:16.518 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:10:16.518 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:10:16.518 DEBUG [src.node.docker_mananger] docker run -i -t -p 37262:37262 -p 37263:37263 -p 37264:37264 -p 37265:37265 -p 37266:37266 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37264 --rest-port=37262 --tcp-port=37263 --discv5-udp-port=37265 --rest-address=0.0.0.0 --nat=extip:172.18.215.159 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b2ddfc03c21dc9cf02cd1d4da2a17fa4bb54ababb663637eaeee3cfb7b808c63 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37266 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QOpUCv5dcos2NOA3Q8pfs8hdYjp09bE7vQAts2RAuwd2K9k84VJK6gaq-twIVt0Fx_t_7zpeC8uq80gA4Us53xUCgmlkgnY0gmlwhKwSNkeKbXVsdGlhZGRyc5YACASsEjZHBvIHAAoErBI2RwbyCN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDuWOix3uUGQ8fGymyTcpY1Kw_2b3MViL5ywR_feMx0fSDdGNwgvIHg3VkcILyCYV3YWt1MgM
2025-02-04 17:10:16.755 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.215.159 waku c10acd8f40d6b548d49d1783474233e169d7d2196285adb040180753e0b01623
2025-02-04 17:10:16.802 DEBUG [src.node.docker_mananger] Container started with ID c10acd8f40d6. Setting up logs at ./log/docker/node2_2025-02-04_17-10-15__f7400c08-c83c-4a02-8d6a-cbaef56645e3__wakuorg_nwaku:latest.log
2025-02-04 17:10:16.803 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 37262
2025-02-04 17:10:16.804 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:10:17.805 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37262/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:17.813 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:10:17.813 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:10:17.813 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37262/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:17.822 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.215.159/tcp/37263/p2p/16Uiu2HAmKEFuBQmtS18mQKFAeN5DGnVoEieP1XwN8WJ7h6s8XGyf","/ip4/172.18.215.159/tcp/37264/ws/p2p/16Uiu2HAmKEFuBQmtS18mQKFAeN5DGnVoEieP1XwN8WJ7h6s8XGyf"],"enrUri":"enr:-L24QKzT0x6rB5ecimqb8jRAob13cHUUnQmm_LO37QQsguYuWWFFi6xFhlUQ1G8H2wSHh6-7qT_PbdEXH--lS6jrsLACgmlkgnY0gmlwhKwS15-KbXVsdGlhZGRyc5YACASsEtefBpGPAAoErBLXnwaRkN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYave2d5S-IfcvLa0pFjXSmRJ9LiLXIk8laRwiDcD1pKDdGNwgpGPg3VkcIKRkYV3YWt1MgM"}'
2025-02-04 17:10:17.822 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:10:17.823 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:10:17.823 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:10:17.825 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:10:17.826 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.5.125
2025-02-04 17:10:17.826 DEBUG [src.node.docker_mananger] Generated ports ['38701', '38702', '38703', '38704', '38705']
2025-02-04 17:10:17.826 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:10:17.826 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:10:17.826 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:10:17.826 DEBUG [src.node.docker_mananger] docker run -i -t -p 38701:38701 -p 38702:38702 -p 38703:38703 -p 38704:38704 -p 38705:38705 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38703 --rest-port=38701 --tcp-port=38702 --discv5-udp-port=38704 --rest-address=0.0.0.0 --nat=extip:172.18.5.125 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cd515163ecbea84af3c9abcbea2e1c6ecec0c1f1bfbed3d211dd6288bf5d9d8e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38705 --metrics-logging=true --relay=false --storenode=/ip4/172.18.215.159/tcp/37263/p2p/16Uiu2HAmKEFuBQmtS18mQKFAeN5DGnVoEieP1XwN8WJ7h6s8XGyf --discv5-bootstrap-node=enr:-L24QKzT0x6rB5ecimqb8jRAob13cHUUnQmm_LO37QQsguYuWWFFi6xFhlUQ1G8H2wSHh6-7qT_PbdEXH--lS6jrsLACgmlkgnY0gmlwhKwS15-KbXVsdGlhZGRyc5YACASsEtefBpGPAAoErBLXnwaRkN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYave2d5S-IfcvLa0pFjXSmRJ9LiLXIk8laRwiDcD1pKDdGNwgpGPg3VkcIKRkYV3YWt1MgM
2025-02-04 17:10:18.073 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.5.125 waku b5b3068c651d3b75900b380d9520c0e8362caeb5e968123e597df2be534480e6
2025-02-04 17:10:18.120 DEBUG [src.node.docker_mananger] Container started with ID b5b3068c651d. Setting up logs at ./log/docker/node3_2025-02-04_17-10-15__f7400c08-c83c-4a02-8d6a-cbaef56645e3__wakuorg_nwaku:latest.log
2025-02-04 17:10:18.120 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 38701
2025-02-04 17:10:18.121 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:10:19.122 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38701/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:19.124 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:10:19.125 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:10:19.125 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38701/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:19.127 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.5.125/tcp/38702/p2p/16Uiu2HAmAX1mq3CxAm1qJiBNeH1Cy9BNfqDtFMf9374pfVn5kTMA","/ip4/172.18.5.125/tcp/38703/ws/p2p/16Uiu2HAmAX1mq3CxAm1qJiBNeH1Cy9BNfqDtFMf9374pfVn5kTMA"],"enrUri":"enr:-L24QJ48u4wSXEnZz5DJjFaEBnmTVgw9D9HQduWNQ0tpw8ULEKE84jwBZ3Ckdr7jdl1dqzKkalDw7zfp2UiblSdnjNICgmlkgnY0gmlwhKwSBX2KbXVsdGlhZGRyc5YACASsEgV9BpcuAAoErBIFfQaXL90DgnJzhQADAQAAiXNlY3AyNTZrMaEC4D2WuW5beBxbUfzkcGRSa9BLW4wp3_YlGKzh9qAsY1GDdGNwgpcug3VkcIKXMIV3YWt1MgA"}'
2025-02-04 17:10:19.127 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:10:19.127 DEBUG [tests.e2e.test_e2e] Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
2025-02-04 17:10:19.127 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61958/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:10:19.132 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:19.132 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37262/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:10:19.137 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:19.138 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61958/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:19.141 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.215.159/tcp/37263/p2p/16Uiu2HAmKEFuBQmtS18mQKFAeN5DGnVoEieP1XwN8WJ7h6s8XGyf","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
2025-02-04 17:10:19.141 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37262/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:19.144 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.54.71/tcp/61959/p2p/16Uiu2HAmR8ftksugaFCAeD6C5PPYb51mMnZyd9t5AxGMVGb11n8B","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
2025-02-04 17:10:19.144 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-04 17:10:49.145 DEBUG [tests.e2e.test_e2e] Node1 publish message with ephemeral = false
2025-02-04 17:10:49.145 DEBUG [src.steps.store] Relaying message
2025-02-04 17:10:49.146 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61958/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2025-02-04 17:10:49.152 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:10:49.153 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-04 17:10:49.353 DEBUG [src.libs.common] Sleeping for 3 seconds
2025-02-04 17:10:52.353 DEBUG [tests.e2e.test_e2e] Check if message is stored 
2025-02-04 17:10:52.354 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-04 17:10:52.355 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38701/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:10:52.401 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"5891f40e5d75b5cf9739","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x2eefd4a33043e6171fd17262a934e987457f12fa8c63f239716dd06280fc529f"}]}'
2025-02-04 17:10:52.409 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:10:52.410 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:10:52.410 DEBUG [src.node.waku_node] Stopping container with id cb498385100e
2025-02-04 17:10:53.086 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:10:53.087 DEBUG [src.node.waku_node] Stopping container with id c10acd8f40d6
2025-02-04 17:10:53.898 ERROR [src.node.docker_mananger] Max retries reached for container cb498385100e. Exiting log stream.
2025-02-04 17:10:54.530 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:10:54.530 DEBUG [src.node.waku_node] Stopping container with id b5b3068c651d
2025-02-04 17:10:55.342 ERROR [src.node.docker_mananger] Max retries reached for container c10acd8f40d6. Exiting log stream.
2025-02-04 17:10:55.563 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:10:55.565 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:10:55.575 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:10:55.588 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:10:55.592 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
