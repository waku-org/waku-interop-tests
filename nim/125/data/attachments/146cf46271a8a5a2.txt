[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_filter_get_message_after_node2_restarts with id: 2024-04-01_13-37-53__42a13fe1-2bf6-4543-9146-7281f6f99044
[35mDEBUG   [0m src.steps.filter:filter.py:27 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:33 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node1_2024-04-01_13-37-53__42a13fe1-2bf6-4543-9146-7281f6f99044__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.170.227
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['34615', '34616', '34617', '34618', '34619']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:294 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 34615:34615 -p 34616:34616 -p 34617:34617 -p 34618:34618 -p 34619:34619 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34617 --rest-port=34615 --tcp-port=34616 --discv5-udp-port=34618 --rest-address=0.0.0.0 --nat=extip:172.18.170.227 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34619 --metrics-logging=true --relay=true --filter=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.170.227 waku 72fb69f21abe9fcb72eb9ba3a168342ba8bc7bcfdb5cc43b2688f288440aa86c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 72fb69f21abe. Setting up logs at ./log/docker/node1_2024-04-01_13-37-53__42a13fe1-2bf6-4543-9146-7281f6f99044__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 34615
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:34615/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.170.227/tcp/34616/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.170.227/tcp/34617/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LG4QHfPYDGO1RAe4J1ErtGZ_qdzRSLxFB1FjSlOIiVF6_OSPrTixNzwe2WmJQGqXMXt-eNodXwIhcSx7tHmWZ2nSgQBgmlkgnY0gmlwhKwSquOKbXVsdGlhZGRyc4wACgSsEqrjBoc53QOCcnODAAAAiXNlY3AyNTZrMaEDN06qX-XhZ-Cc7ZuIAdGNCVUicscmbFvEEfkFOQ2W_j2DdGNwgoc4g3VkcIKHOoV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:38 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node2_2024-04-01_13-37-53__42a13fe1-2bf6-4543-9146-7281f6f99044__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.225.71
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['11442', '11443', '11444', '11445', '11446']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:294 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 11442:11442 -p 11443:11443 -p 11444:11444 -p 11445:11445 -p 11446:11446 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11444 --rest-port=11442 --tcp-port=11443 --discv5-udp-port=11445 --rest-address=0.0.0.0 --nat=extip:172.18.225.71 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11446 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LG4QHfPYDGO1RAe4J1ErtGZ_qdzRSLxFB1FjSlOIiVF6_OSPrTixNzwe2WmJQGqXMXt-eNodXwIhcSx7tHmWZ2nSgQBgmlkgnY0gmlwhKwSquOKbXVsdGlhZGRyc4wACgSsEqrjBoc53QOCcnODAAAAiXNlY3AyNTZrMaEDN06qX-XhZ-Cc7ZuIAdGNCVUicscmbFvEEfkFOQ2W_j2DdGNwgoc4g3VkcIKHOoV3YWt1MgU --filternode=/ip4/172.18.170.227/tcp/34616/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.225.71 waku a7e11079773462db15da73f73b350d52462a6526c497e40b9ed644f81e0b6353
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a7e110797734. Setting up logs at ./log/docker/node2_2024-04-01_13-37-53__42a13fe1-2bf6-4543-9146-7281f6f99044__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 11442
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:11442/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.225.71/tcp/11443/p2p/16Uiu2HAm8G1mTYmMWon2rpiecCEYDDCTqcHcG1WFajghuzSZuveX","/ip4/172.18.225.71/tcp/11444/ws/p2p/16Uiu2HAm8G1mTYmMWon2rpiecCEYDDCTqcHcG1WFajghuzSZuveX"],"enrUri":"enr:-LG4QJLW1KCU_PDCbNuP-6va9hHIdYsCpKghwKS_oMMlC_jIKOSghXyRycaAaOEY3SJmxXiCHZVuXMwVx0soMdg9HBcBgmlkgnY0gmlwhKwS4UeKbXVsdGlhZGRyc4wACgSsEuFHBiy03QOCcnODAAAAiXNlY3AyNTZrMaECvq5-3K4Jd6GrQjpJgguezn8Ogt8OUfhZilaG0Pwf4_SDdGNwgiyzg3VkcIIstYV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:45 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:34615/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:11442/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "9587dba3-df4c-4747-ac7b-016d3565f201", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"9587dba3-df4c-4747-ac7b-016d3565f201","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:34615/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:11442/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1711978677847061248,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:175 Restarting container with id a7e110797734
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:11442/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:11442/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.225.71/tcp/11443/p2p/16Uiu2HAmNAYBjpZvMHE5xq7ncg4NbvRgcJyQZSFRMwwnVsqPEEVp","/ip4/172.18.225.71/tcp/11444/ws/p2p/16Uiu2HAmNAYBjpZvMHE5xq7ncg4NbvRgcJyQZSFRMwwnVsqPEEVp"],"enrUri":"enr:-LG4QNgRRNCgMRkJZIqemZSXhQdx359O_PGoDalcQ6XOCTa_UbO0NQSWqsoOCvpmMGnCnuAy_3dAZ6jPmZLH2r_SoPUBgmlkgnY0gmlwhKwS4UeKbXVsdGlhZGRyc4wACgSsEuFHBiy03QOCcnODAAAAiXNlY3AyNTZrMaEDjUsFqe-ZbDYbMCsvvD_KUguptiQr5w7WTCn9gIltskODdGNwgiyzg3VkcIIstYV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:34615/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:11442/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1951c0c7-c421-4c23-9e5a-b2fee24067de", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"1951c0c7-c421-4c23-9e5a-b2fee24067de","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:34615/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:11442/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1711978682444185344,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 72fb69f21abe
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id a7e110797734
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.