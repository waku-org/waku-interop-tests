[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_works_with_static_sharding with id: 2024-12-01_04-25-25__c3df5ecd-2042-4956-b6e7-4d2af1851b27
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-01_04-25-25__c3df5ecd-2042-4956-b6e7-4d2af1851b27__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.50.165
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['31880', '31881', '31882', '31883', '31884']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 31880:31880 -p 31881:31881 -p 31882:31882 -p 31883:31883 -p 31884:31884 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31882 --rest-port=31880 --tcp-port=31881 --discv5-udp-port=31883 --rest-address=0.0.0.0 --nat=extip:172.18.50.165 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=c62c9e81fa880a1b5c4c8b18cffaa4fac2deaba2c53dc9e95acb80a91f86779d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31884 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 44631137a188. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.50.165 waku fd48be9147a8c2b29991c3acc3547375afd0cd5b7e8434fafa4d164f3d7826be
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID fd48be9147a8. Setting up logs at ./log/docker/node1_2024-12-01_04-25-25__c3df5ecd-2042-4956-b6e7-4d2af1851b27__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 31880
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31880/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31880/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.50.165/tcp/31881/p2p/16Uiu2HAmASRa8xAmbapNRyXRhrwYwtYD1smcTH3wxgGaN4sw4Vyd","/ip4/172.18.50.165/tcp/31882/ws/p2p/16Uiu2HAmASRa8xAmbapNRyXRhrwYwtYD1smcTH3wxgGaN4sw4Vyd"],"enrUri":"enr:-L24QIfIs3WbjFOsKUU63AQ-Eu-K9jT7cX5qz6in7MaFzyQlHAR-iEkJfJJXfgVDvUfxouSz7qeud1HkcxSFdsUCJQcCgmlkgnY0gmlwhKwSMqWKbXVsdGlhZGRyc5YACASsEjKlBnyJAAoErBIypQZ8it0DgnJzhQACAQAAiXNlY3AyNTZrMaEC3xCX_Bdn4h4WsVU5GUonJoHK1rwwHPS4PVFQoWT18ByDdGNwgnyJg3VkcIJ8i4V3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-01_04-25-25__c3df5ecd-2042-4956-b6e7-4d2af1851b27__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.46.31
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['55704', '55705', '55706', '55707', '55708']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 55704:55704 -p 55705:55705 -p 55706:55706 -p 55707:55707 -p 55708:55708 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55706 --rest-port=55704 --tcp-port=55705 --discv5-udp-port=55707 --rest-address=0.0.0.0 --nat=extip:172.18.46.31 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=338b20f9cde8fced6abd8c5bebfc2411083fe62fdffaaecfed1d513c42579bfb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55708 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QIfIs3WbjFOsKUU63AQ-Eu-K9jT7cX5qz6in7MaFzyQlHAR-iEkJfJJXfgVDvUfxouSz7qeud1HkcxSFdsUCJQcCgmlkgnY0gmlwhKwSMqWKbXVsdGlhZGRyc5YACASsEjKlBnyJAAoErBIypQZ8it0DgnJzhQACAQAAiXNlY3AyNTZrMaEC3xCX_Bdn4h4WsVU5GUonJoHK1rwwHPS4PVFQoWT18ByDdGNwgnyJg3VkcIJ8i4V3YWt1MgU --filternode=/ip4/172.18.50.165/tcp/31881/p2p/16Uiu2HAmASRa8xAmbapNRyXRhrwYwtYD1smcTH3wxgGaN4sw4Vyd --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.46.31 waku 2e2ed9c750a09fc7f63892ef7ff53f30755e71a4f35aab464c2dea2ec498209b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2e2ed9c750a0. Setting up logs at ./log/docker/node2_2024-12-01_04-25-25__c3df5ecd-2042-4956-b6e7-4d2af1851b27__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 55704
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55704/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55704/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.46.31/tcp/55705/p2p/16Uiu2HAmDAzMLrCqwiRzXFvq6UiSJEPfWST8iv32aP6iJZSQefHJ","/ip4/172.18.46.31/tcp/55706/ws/p2p/16Uiu2HAmDAzMLrCqwiRzXFvq6UiSJEPfWST8iv32aP6iJZSQefHJ"],"enrUri":"enr:-L24QBm795ZsaMSZZb5YgS8DyjrmKpYqMNO3OCG2UyXFIf0DTvPy1aEZm_lnaTdLU3ZHwvLkHhb9MprQyvSmfHpqomYCgmlkgnY0gmlwhKwSLh-KbXVsdGlhZGRyc5YACASsEi4fBtmZAAoErBIuHwbZmt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDB69s4QQJmvU9w78OsnbHh2SxpSjDqv2OHmozEykBfWGDdGNwgtmZg3VkcILZm4V3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55704/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.50.165/tcp/31881/p2p/16Uiu2HAmASRa8xAmbapNRyXRhrwYwtYD1smcTH3wxgGaN4sw4Vyd"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31880/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55704/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "073a8b4c-60bd-4050-ade7-ffbe44e283d7", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"073a8b4c-60bd-4050-ade7-ffbe44e283d7","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31880/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:186 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55704/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1733027129291014400,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id fd48be9147a8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 2e2ed9c750a0
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container fd48be9147a8. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.