[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_extra_field with id: 2024-12-27_13-46-34__7d9cf308-7023-486e-bca1-4e354e33c673
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-27_13-46-34__7d9cf308-7023-486e-bca1-4e354e33c673__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.205.50
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['46232', '46233', '46234', '46235', '46236']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 46232:46232 -p 46233:46233 -p 46234:46234 -p 46235:46235 -p 46236:46236 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46234 --rest-port=46232 --tcp-port=46233 --discv5-udp-port=46235 --rest-address=0.0.0.0 --nat=extip:172.18.205.50 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1cd42fe0937c2329072a15ddd00c6b2ffffef1a88eccbb8051fb3df0efc2f581 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46236 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.205.50 waku 8283873d7698bb6e259d3fc0225fccc5eab53ba5182a32a40b265572716b28a3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 8283873d7698. Setting up logs at ./log/docker/node1_2024-12-27_13-46-34__7d9cf308-7023-486e-bca1-4e354e33c673__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 46232
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 0445c13ec0d2. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46232/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46232/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.205.50/tcp/46233/p2p/16Uiu2HAkzWMDgbUvh4RggFcsn8Hzg6rMWRZELSCWT5cx3RiFqGHZ","/ip4/172.18.205.50/tcp/46234/ws/p2p/16Uiu2HAkzWMDgbUvh4RggFcsn8Hzg6rMWRZELSCWT5cx3RiFqGHZ"],"enrUri":"enr:-L24QFhanx3LbA8REMRZH4djB9ebyMwiZ3dh4v4I4o9WkYHhN1fZX2IJfwHquMmCeDuhOqsf1bz58elkP2PQPAd-NeQCgmlkgnY0gmlwhKwSzTKKbXVsdGlhZGRyc5YACASsEs0yBrSZAAoErBLNMga0mt0DgnJzhQADAQAAiXNlY3AyNTZrMaECS30gR4_iBddZyDH55VrL177rbVJxsslCbkdSy4nK_dyDdGNwgrSZg3VkcIK0m4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-27_13-46-34__7d9cf308-7023-486e-bca1-4e354e33c673__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.136.244
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['18705', '18706', '18707', '18708', '18709']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 18705:18705 -p 18706:18706 -p 18707:18707 -p 18708:18708 -p 18709:18709 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18707 --rest-port=18705 --tcp-port=18706 --discv5-udp-port=18708 --rest-address=0.0.0.0 --nat=extip:172.18.136.244 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a3ad192faf2400dcb63bf3f7aced6f1ceb1b8fcddb0f2563b7ca57ce0b10468c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18709 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QFhanx3LbA8REMRZH4djB9ebyMwiZ3dh4v4I4o9WkYHhN1fZX2IJfwHquMmCeDuhOqsf1bz58elkP2PQPAd-NeQCgmlkgnY0gmlwhKwSzTKKbXVsdGlhZGRyc5YACASsEs0yBrSZAAoErBLNMga0mt0DgnJzhQADAQAAiXNlY3AyNTZrMaECS30gR4_iBddZyDH55VrL177rbVJxsslCbkdSy4nK_dyDdGNwgrSZg3VkcIK0m4V3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.136.244 waku 7469b8b6dc7a437cf6c049aca287eb430ecbcb5eec8dc96ac3a4a94058d25e41
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 7469b8b6dc7a. Setting up logs at ./log/docker/node2_2024-12-27_13-46-34__7d9cf308-7023-486e-bca1-4e354e33c673__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 18705
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18705/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18705/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.136.244/tcp/18706/p2p/16Uiu2HAm2JNvC4qBSJjAZnDEw8RjLmWSzTAjRWt5CEzRguHqG524","/ip4/172.18.136.244/tcp/18707/ws/p2p/16Uiu2HAm2JNvC4qBSJjAZnDEw8RjLmWSzTAjRWt5CEzRguHqG524"],"enrUri":"enr:-L24QC6LZukYUtUMnfDAuT0QN1W1ZMa2gZji9IXIGuiISBaETSiNcKUHhesCB_RVWJHqqVFEkjWEGpoP5kjQi3hHYXACgmlkgnY0gmlwhKwSiPSKbXVsdGlhZGRyc5YACASsEoj0BkkSAAoErBKI9AZJE90DgnJzhQADAQAAiXNlY3AyNTZrMaECZiNzXTN80s3q2JPM5QtuIxFn1or8BUBBMWT1Qb9HFqWDdGNwgkkSg3VkcIJJFIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18705/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.205.50/tcp/46233/p2p/16Uiu2HAkzWMDgbUvh4RggFcsn8Hzg6rMWRZELSCWT5cx3RiFqGHZ"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46232/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18705/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46232/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46232/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1735307196919586048,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18705/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1735307196919586048,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46232/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "extraField": "extraValue"}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:46232/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 8283873d7698
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 7469b8b6dc7a
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 8283873d7698. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.