[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-09-22_04-20-11__330f1dcd-497d-4e3a-96a5-e16409797a13
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-22_04-20-11__330f1dcd-497d-4e3a-96a5-e16409797a13__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.81.142
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['36990', '36991', '36992', '36993', '36994']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 36990:36990 -p 36991:36991 -p 36992:36992 -p 36993:36993 -p 36994:36994 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36992 --rest-port=36990 --tcp-port=36991 --discv5-udp-port=36993 --rest-address=0.0.0.0 --nat=extip:172.18.81.142 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c56fac2adf5ddf31f999030cba33dd8a62dd5eaeea1da60cd03a6ed14479ffb0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36994 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.81.142 waku c12644e2e4e3c1bb38b4ea10f42caecba5373e1a7d4107472d43dc6bbd117a06
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c12644e2e4e3. Setting up logs at ./log/docker/receiving_node1_2024-09-22_04-20-11__330f1dcd-497d-4e3a-96a5-e16409797a13__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 36990
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36990/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36990/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.142/tcp/36991/p2p/16Uiu2HAmDLr4Fzbkv5aHX7sxSteAgCyUZsSSz4j3eprsxoF8t3Zo","/ip4/172.18.81.142/tcp/36992/ws/p2p/16Uiu2HAmDLr4Fzbkv5aHX7sxSteAgCyUZsSSz4j3eprsxoF8t3Zo"],"enrUri":"enr:-LO4QBQ3GtuEnIqgIiVv9UbwoBMh1_eJKV57Cla2Ih1EwUyOGWUQMRKRIJlCBcSZOE-AbGPiXBRzW48pOg91kVuEJUEBgmlkgnY0gmlwhKwSUY6KbXVsdGlhZGRyc4wACgSsElGOBpCA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMKNdrPRy1YvcR-FUksz0HQaFloNw7IB7kvbZmlXSpy3oN0Y3CCkH-DdWRwgpCBhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-22_04-20-11__330f1dcd-497d-4e3a-96a5-e16409797a13__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.39.170
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['33690', '33691', '33692', '33693', '33694']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 33690:33690 -p 33691:33691 -p 33692:33692 -p 33693:33693 -p 33694:33694 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33692 --rest-port=33690 --tcp-port=33691 --discv5-udp-port=33693 --rest-address=0.0.0.0 --nat=extip:172.18.39.170 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a1f902d796eeecbb8978de8eaf1d1aad692b3abaf44e999ddefaac2f9da60664 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33694 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.39.170 waku 4c4e57a9ac1373d1528455c5e2657ec77226759ca317322e9a43d2206ad3d38d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 4c4e57a9ac13. Setting up logs at ./log/docker/receiving_node2_2024-09-22_04-20-11__330f1dcd-497d-4e3a-96a5-e16409797a13__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 33690
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33690/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33690/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.170/tcp/33691/p2p/16Uiu2HAkyg83wyJwuEaVYqTvbDi6ioYFV1jBZmYmgaF1J79mhEoC","/ip4/172.18.39.170/tcp/33692/ws/p2p/16Uiu2HAkyg83wyJwuEaVYqTvbDi6ioYFV1jBZmYmgaF1J79mhEoC"],"enrUri":"enr:-LO4QNtmVHDgXxyQn2PvKb_0sgIvV0ftW_rosYjVOfctnUDGA-FO60evj3qUnYf2Smpvr4yF04SAzoczhWqSgD1dVGYBgmlkgnY0gmlwhKwSJ6qKbXVsdGlhZGRyc4wACgSsEieqBoOc3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI_Ilu7cM3jv0mlBWFoLHU9G5cvcqhGzuZ_yg2cZqd3S4N0Y3CCg5uDdWRwgoOdhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33690/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.81.142/tcp/36991/p2p/16Uiu2HAmDLr4Fzbkv5aHX7sxSteAgCyUZsSSz4j3eprsxoF8t3Zo"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-22_04-20-11__330f1dcd-497d-4e3a-96a5-e16409797a13__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.163.255
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['10128', '10129', '10130', '10131', '10132']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 10128:10128 -p 10129:10129 -p 10130:10130 -p 10131:10131 -p 10132:10132 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10130 --rest-port=10128 --tcp-port=10129 --discv5-udp-port=10131 --rest-address=0.0.0.0 --nat=extip:172.18.163.255 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ed1aad5c0fc2300ccaf5c3c7fb8c060b2f1b025ada89cc3bf1fe2c510bfc567f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10132 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QBQ3GtuEnIqgIiVv9UbwoBMh1_eJKV57Cla2Ih1EwUyOGWUQMRKRIJlCBcSZOE-AbGPiXBRzW48pOg91kVuEJUEBgmlkgnY0gmlwhKwSUY6KbXVsdGlhZGRyc4wACgSsElGOBpCA3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMKNdrPRy1YvcR-FUksz0HQaFloNw7IB7kvbZmlXSpy3oN0Y3CCkH-DdWRwgpCBhXdha3UyCQ --lightpushnode=/ip4/172.18.81.142/tcp/36991/p2p/16Uiu2HAmDLr4Fzbkv5aHX7sxSteAgCyUZsSSz4j3eprsxoF8t3Zo --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.163.255 waku 9ee7df0f0ad8d617730d2d0a125dba5be9a6b762e88b5410413626e1b9c95ae9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9ee7df0f0ad8. Setting up logs at ./log/docker/lightpush_node1_2024-09-22_04-20-11__330f1dcd-497d-4e3a-96a5-e16409797a13__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 10128
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10128/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10128/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.163.255/tcp/10129/p2p/16Uiu2HAmCQtC75T1b4anxBkz1KF7Nu8X574wNHiJaY44wGFkjb9p","/ip4/172.18.163.255/tcp/10130/ws/p2p/16Uiu2HAmCQtC75T1b4anxBkz1KF7Nu8X574wNHiJaY44wGFkjb9p"],"enrUri":"enr:-LO4QFAAFPgguQyOwOUCYh_IQGKUc-WVmA7ZZofBeaw6qqXSGJnDY3IchdChTrPSO4r5ZRQLo-S8TdqnCiMf2fdy0bMBgmlkgnY0gmlwhKwSo_-KbXVsdGlhZGRyc4wACgSsEqP_BieS3QOCcnOFAAMBAACJc2VjcDI1NmsxoQL8YufImN8sGAbWSKL42aFmuLdpmQ-KA3qRO85JsC6Fh4N0Y3CCJ5GDdWRwgieThXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10128/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.81.142/tcp/36991/p2p/16Uiu2HAmDLr4Fzbkv5aHX7sxSteAgCyUZsSSz4j3eprsxoF8t3Zo"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10128/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.170/tcp/33691/p2p/16Uiu2HAkyg83wyJwuEaVYqTvbDi6ioYFV1jBZmYmgaF1J79mhEoC"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36990/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33690/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10128/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726978815791439616, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36990/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726978815791439616,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33690/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726978815791439616,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10128/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726978815935216896, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36990/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726978815935216896,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33690/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726978815935216896,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c12644e2e4e3
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 4c4e57a9ac13
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9ee7df0f0ad8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.