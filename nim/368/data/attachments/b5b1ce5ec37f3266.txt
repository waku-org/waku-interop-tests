[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_message_relayed_while_store_node_is_stopped_without_removing with id: 2024-09-22_04-34-14__3c793b3c-56cb-471d-bc1c-654f281d6370
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-09-22_04-34-14__3c793b3c-56cb-471d-bc1c-654f281d6370__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.112.68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['25085', '25086', '25087', '25088', '25089']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 25085:25085 -p 25086:25086 -p 25087:25087 -p 25088:25088 -p 25089:25089 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25087 --rest-port=25085 --tcp-port=25086 --discv5-udp-port=25088 --rest-address=0.0.0.0 --nat=extip:172.18.112.68 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dbd9bfca497faa1c19ac68bf1a33edaecf48b5ac2a69954fdfb3f272ccd56dfb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25089 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.112.68 waku f48e2487e04db97b191df2d2bd088e384f06e3059b40176dd148bced9c2e3f3c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID f48e2487e04d. Setting up logs at ./log/docker/publishing_node1_2024-09-22_04-34-14__3c793b3c-56cb-471d-bc1c-654f281d6370__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 25085
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25085/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25085/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.112.68/tcp/25086/p2p/16Uiu2HAmHdH4tcE6QQRjRXjUc9xZYX4PvBeHmGUcQ2kXxZ1Yn3vc","/ip4/172.18.112.68/tcp/25087/ws/p2p/16Uiu2HAmHdH4tcE6QQRjRXjUc9xZYX4PvBeHmGUcQ2kXxZ1Yn3vc"],"enrUri":"enr:-LO4QCVQETqabKM7hiIUgMFlRd2I0cKeJ57xB14Tgze1S0tBXt3o2D5v6dIOCd76DcE38Co2AdR-Gs6zsjHajQ61hvYBgmlkgnY0gmlwhKwScESKbXVsdGlhZGRyc4wACgSsEnBEBmH_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNJ2izerUB83foiyagUGA6iCBh00LAlxLc3IovUXbzl5YN0Y3CCYf6DdWRwgmIAhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-09-22_04-34-14__3c793b3c-56cb-471d-bc1c-654f281d6370__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.119.151
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['47034', '47035', '47036', '47037', '47038']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 47034:47034 -p 47035:47035 -p 47036:47036 -p 47037:47037 -p 47038:47038 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47036 --rest-port=47034 --tcp-port=47035 --discv5-udp-port=47037 --rest-address=0.0.0.0 --nat=extip:172.18.119.151 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6c479b730a1bee1c789dad1e83eaeaca3f5befea5ee71666df0d79e917ebc23b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47038 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QCVQETqabKM7hiIUgMFlRd2I0cKeJ57xB14Tgze1S0tBXt3o2D5v6dIOCd76DcE38Co2AdR-Gs6zsjHajQ61hvYBgmlkgnY0gmlwhKwScESKbXVsdGlhZGRyc4wACgSsEnBEBmH_3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNJ2izerUB83foiyagUGA6iCBh00LAlxLc3IovUXbzl5YN0Y3CCYf6DdWRwgmIAhXdha3UyAw --storenode=/ip4/172.18.112.68/tcp/25086/p2p/16Uiu2HAmHdH4tcE6QQRjRXjUc9xZYX4PvBeHmGUcQ2kXxZ1Yn3vc --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.119.151 waku 741b1667e0c44fac9acf5eb00bd2a63a10ce55d23a93f1d1116bab335d83d120
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 741b1667e0c4. Setting up logs at ./log/docker/store_node1_2024-09-22_04-34-14__3c793b3c-56cb-471d-bc1c-654f281d6370__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 47034
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47034/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47034/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.119.151/tcp/47035/p2p/16Uiu2HAm5bJN9KydGPmbAWXBhpmtdu9UqGQo3WZSkBy7G35SqFm5","/ip4/172.18.119.151/tcp/47036/ws/p2p/16Uiu2HAm5bJN9KydGPmbAWXBhpmtdu9UqGQo3WZSkBy7G35SqFm5"],"enrUri":"enr:-LO4QMJcjOg26p-vu-Y99EUWHMqMxG0_ITa2eteQSpACknBNL83CmbMKCdCfGq2i4jWiiM_oGpHYEom5QXbz6eqNDjIBgmlkgnY0gmlwhKwSd5eKbXVsdGlhZGRyc4wACgSsEneXBre83QOCcnOFAAMBAACJc2VjcDI1NmsxoQKXDDzTiIvfdJaOFJpBo-65FGvU2W5cFeAuMamCFQEWhIN0Y3CCt7uDdWRwgre9hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47034/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.112.68/tcp/25086/p2p/16Uiu2HAmHdH4tcE6QQRjRXjUc9xZYX4PvBeHmGUcQ2kXxZ1Yn3vc"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25085/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47034/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25085/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25085/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"v1anGHGKH8COoX1XDATwTRk/KNOvUAAdwMbv+Em9wko="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47034/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"6174835c73f3ba11a845","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"v1anGHGKH8COoX1XDATwTRk/KNOvUAAdwMbv+Em9wko="}]}'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25085/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47034/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47034/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47034/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.119.151/tcp/47035/p2p/16Uiu2HAm5bJN9KydGPmbAWXBhpmtdu9UqGQo3WZSkBy7G35SqFm5","/ip4/172.18.119.151/tcp/47036/ws/p2p/16Uiu2HAm5bJN9KydGPmbAWXBhpmtdu9UqGQo3WZSkBy7G35SqFm5"],"enrUri":"enr:-LO4QMJcjOg26p-vu-Y99EUWHMqMxG0_ITa2eteQSpACknBNL83CmbMKCdCfGq2i4jWiiM_oGpHYEom5QXbz6eqNDjIBgmlkgnY0gmlwhKwSd5eKbXVsdGlhZGRyc4wACgSsEneXBre83QOCcnOFAAMBAACJc2VjcDI1NmsxoQKXDDzTiIvfdJaOFJpBo-65FGvU2W5cFeAuMamCFQEWhIN0Y3CCt7uDdWRwgre9hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25085/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"v1anGHGKH8COoX1XDATwTRk/KNOvUAAdwMbv+Em9wko="},{"messageHash":"qY7mjrD9gvUBc2iP/Z2WbFJAvdB93W1buzTBK/PpFZY="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47034/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"11e08a73c6de6a511a90","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"v1anGHGKH8COoX1XDATwTRk/KNOvUAAdwMbv+Em9wko="},{"messageHash":"qY7mjrD9gvUBc2iP/Z2WbFJAvdB93W1buzTBK/PpFZY="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id f48e2487e04d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 741b1667e0c4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.