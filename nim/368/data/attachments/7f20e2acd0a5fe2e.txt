[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_single_pubsub_topic[/waku/2/rs/2/0] with id: 2024-09-22_04-26-50__c1efb171-9794-4117-b306-d9be0c92691e
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-22_04-26-50__c1efb171-9794-4117-b306-d9be0c92691e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.219.200
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['47058', '47059', '47060', '47061', '47062']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 47058:47058 -p 47059:47059 -p 47060:47060 -p 47061:47061 -p 47062:47062 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47060 --rest-port=47058 --tcp-port=47059 --discv5-udp-port=47061 --rest-address=0.0.0.0 --nat=extip:172.18.219.200 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e53dbdeaecafad6ba79daf325d7aee2ccac040e804f6dd57c7c0778da001826d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47062 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.219.200 waku 141c905123ecbe6dfc5c9781e52fdbeb9f1e175ea79e2debd5638531b2465243
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 141c905123ec. Setting up logs at ./log/docker/node1_2024-09-22_04-26-50__c1efb171-9794-4117-b306-d9be0c92691e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 47058
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47058/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47058/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.219.200/tcp/47059/p2p/16Uiu2HAmBFMN5tYqYGaZpp42JDbmJTmZtqS55jxd48EAw1Lg3VCM","/ip4/172.18.219.200/tcp/47060/ws/p2p/16Uiu2HAmBFMN5tYqYGaZpp42JDbmJTmZtqS55jxd48EAw1Lg3VCM"],"enrUri":"enr:-LO4QOd0fW_sDAMSL-il_PB4Tf01QeheJMhES4m5YGSHQZLnNUfIDvpYm_5-vLZ-zETjumaQx3PZySyDGbQrW9ydc0YBgmlkgnY0gmlwhKwS28iKbXVsdGlhZGRyc4wACgSsEtvIBrfU3QOCcnOFAAIBAACJc2VjcDI1NmsxoQLrFiJJh1lattNoL4ZOa-A5kz7lY0SpkAX5cTSA6Y2lIoN0Y3CCt9ODdWRwgrfVhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-22_04-26-50__c1efb171-9794-4117-b306-d9be0c92691e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.9.44
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['59345', '59346', '59347', '59348', '59349']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 59345:59345 -p 59346:59346 -p 59347:59347 -p 59348:59348 -p 59349:59349 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59347 --rest-port=59345 --tcp-port=59346 --discv5-udp-port=59348 --rest-address=0.0.0.0 --nat=extip:172.18.9.44 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=4c84c3d7206aa470061737cf361e4da7f6d46c62748c11fc8bd8ebdda6389ace --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59349 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QOd0fW_sDAMSL-il_PB4Tf01QeheJMhES4m5YGSHQZLnNUfIDvpYm_5-vLZ-zETjumaQx3PZySyDGbQrW9ydc0YBgmlkgnY0gmlwhKwS28iKbXVsdGlhZGRyc4wACgSsEtvIBrfU3QOCcnOFAAIBAACJc2VjcDI1NmsxoQLrFiJJh1lattNoL4ZOa-A5kz7lY0SpkAX5cTSA6Y2lIoN0Y3CCt9ODdWRwgrfVhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.9.44 waku e82e869fef0bb3297e9ec7b05692731722e76568b60622ffc5996e67a65fd923
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e82e869fef0b. Setting up logs at ./log/docker/node2_2024-09-22_04-26-50__c1efb171-9794-4117-b306-d9be0c92691e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 59345
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59345/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59345/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.9.44/tcp/59346/p2p/16Uiu2HAm6b514yRonemhaAQZ5qqnUqU4baZ51t2cRjReXCgvkeKJ","/ip4/172.18.9.44/tcp/59347/ws/p2p/16Uiu2HAm6b514yRonemhaAQZ5qqnUqU4baZ51t2cRjReXCgvkeKJ"],"enrUri":"enr:-LO4QOcnkENwbpqRV9Eq4yz8o6kybwNsTMZXEqhELw2zMrbaMZrFkcNItD3fzIPS7qi17rgd0XCjv-WnAO-fa7fZfAcBgmlkgnY0gmlwhKwSCSyKbXVsdGlhZGRyc4wACgSsEgksBufT3QOCcnOFAAIBAACJc2VjcDI1NmsxoQKl2NCExoIRY-OGPRp99m9p0_oXw8_9dXuA-VvEmTN7gYN0Y3CC59KDdWRwgufUhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59345/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.219.200/tcp/47059/p2p/16Uiu2HAmBFMN5tYqYGaZpp42JDbmJTmZtqS55jxd48EAw1Lg3VCM"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47058/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59345/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47058/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47058/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726979214497618944,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59345/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726979214497618944,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 141c905123ec
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e82e869fef0b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.