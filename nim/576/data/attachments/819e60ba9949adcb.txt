[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-12-25_18-52-59__0f3329f3-0bff-4a2f-9aea-ed33b87ca4b6
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-12-25_18-52-59__0f3329f3-0bff-4a2f-9aea-ed33b87ca4b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.116.45
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['56643', '56644', '56645', '56646', '56647']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 56643:56643 -p 56644:56644 -p 56645:56645 -p 56646:56646 -p 56647:56647 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56645 --rest-port=56643 --tcp-port=56644 --discv5-udp-port=56646 --rest-address=0.0.0.0 --nat=extip:172.18.116.45 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fa3cecfeec629b2b0818a18d59e58fc8beaa6cbbdcea4f4fb4e66518e2dc624b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56647 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.116.45 waku eeda160397b510fdfe19e95c309428644e41fb43dc775e5a9ca4c449f58174a5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID eeda160397b5. Setting up logs at ./log/docker/receiving_node1_2024-12-25_18-52-59__0f3329f3-0bff-4a2f-9aea-ed33b87ca4b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 56643
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 7b01a880d3fb. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56643/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56643/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.116.45/tcp/56644/p2p/16Uiu2HAkzgDVhRrrBefUTFUzfzipkVd1cHDHa59HPH5nnKbeSPtH","/ip4/172.18.116.45/tcp/56645/ws/p2p/16Uiu2HAkzgDVhRrrBefUTFUzfzipkVd1cHDHa59HPH5nnKbeSPtH"],"enrUri":"enr:-L24QABSWf4gRFlmxzOXXDlKtgsdbJFVMjWut2EYpF7vwc7rFVp6gq0WK2YhCjd6PPHvQC5TD8JTqdotDQIMK03vTnkCgmlkgnY0gmlwhKwSdC2KbXVsdGlhZGRyc5YACASsEnQtBt1EAAoErBJ0LQbdRd0DgnJzhQADAQAAiXNlY3AyNTZrMaECTgQzZINRT7DVJYShaNo5SuJAR5h85K4r_fe7S4A7yy6DdGNwgt1Eg3VkcILdRoV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-12-25_18-52-59__0f3329f3-0bff-4a2f-9aea-ed33b87ca4b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.13.233
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['61024', '61025', '61026', '61027', '61028']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 61024:61024 -p 61025:61025 -p 61026:61026 -p 61027:61027 -p 61028:61028 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61026 --rest-port=61024 --tcp-port=61025 --discv5-udp-port=61027 --rest-address=0.0.0.0 --nat=extip:172.18.13.233 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=480ce5cdd13bd65c470aecde55b2caa0cd4cf9039bb62671ff8b4e3eca17d5f6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61028 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.13.233 waku 921c2f0f687861a03eb30ba748205bf316a87083cec196c4ff1d4956ff2834a3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 921c2f0f6878. Setting up logs at ./log/docker/receiving_node2_2024-12-25_18-52-59__0f3329f3-0bff-4a2f-9aea-ed33b87ca4b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 61024
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61024/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61024/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.13.233/tcp/61025/p2p/16Uiu2HAmKfAjhU3ogfTVxa58uS1qyPZJ9Nz1Jd2UCJcbLaqFm6yu","/ip4/172.18.13.233/tcp/61026/ws/p2p/16Uiu2HAmKfAjhU3ogfTVxa58uS1qyPZJ9Nz1Jd2UCJcbLaqFm6yu"],"enrUri":"enr:-L24QNM-7lCK_3ZAVGqSWTXGOI71GYnDOF4qsc1brSJsMclpBVL8GxnffVYum8OdDOiaamAeVtj0PKkPiMsPI0dZn18CgmlkgnY0gmlwhKwSDemKbXVsdGlhZGRyc5YACASsEg3pBu5hAAoErBIN6QbuYt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDaA2NaGitZBShnBYthFzynU3ZyvKL2cmj27GS97zq5BiDdGNwgu5hg3VkcILuY4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61024/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.116.45/tcp/56644/p2p/16Uiu2HAkzgDVhRrrBefUTFUzfzipkVd1cHDHa59HPH5nnKbeSPtH"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-12-25_18-52-59__0f3329f3-0bff-4a2f-9aea-ed33b87ca4b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.203.245
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['23582', '23583', '23584', '23585', '23586']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 23582:23582 -p 23583:23583 -p 23584:23584 -p 23585:23585 -p 23586:23586 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23584 --rest-port=23582 --tcp-port=23583 --discv5-udp-port=23585 --rest-address=0.0.0.0 --nat=extip:172.18.203.245 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a6afab1dfd8bfb27a5620faa5ba7e6da8ac2f8a1e2bc2cfa512a1ceb9c63bff4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23586 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QABSWf4gRFlmxzOXXDlKtgsdbJFVMjWut2EYpF7vwc7rFVp6gq0WK2YhCjd6PPHvQC5TD8JTqdotDQIMK03vTnkCgmlkgnY0gmlwhKwSdC2KbXVsdGlhZGRyc5YACASsEnQtBt1EAAoErBJ0LQbdRd0DgnJzhQADAQAAiXNlY3AyNTZrMaECTgQzZINRT7DVJYShaNo5SuJAR5h85K4r_fe7S4A7yy6DdGNwgt1Eg3VkcILdRoV3YWt1Mgk --lightpushnode=/ip4/172.18.116.45/tcp/56644/p2p/16Uiu2HAkzgDVhRrrBefUTFUzfzipkVd1cHDHa59HPH5nnKbeSPtH --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.203.245 waku 59a40f5afbb0a7a3b6618b8cd3e1b0448ffcc3ff5975871d1afb7cfadbf6f396
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 59a40f5afbb0. Setting up logs at ./log/docker/lightpush_node1_2024-12-25_18-52-59__0f3329f3-0bff-4a2f-9aea-ed33b87ca4b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 23582
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23582/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23582/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.203.245/tcp/23583/p2p/16Uiu2HAm3m7JBnue33JWjHc4NPj4ktP4nkFyWjYudrkt7BAbQv6P","/ip4/172.18.203.245/tcp/23584/ws/p2p/16Uiu2HAm3m7JBnue33JWjHc4NPj4ktP4nkFyWjYudrkt7BAbQv6P"],"enrUri":"enr:-L24QLDI4oq1_WZjlyKnBY6EQg_7D6ubU4tds1v3cy92C-cvP6Uo0BB-lWOY_XL_uOQd1OdE845lKPuTg6LCeVuCVuECgmlkgnY0gmlwhKwSy_WKbXVsdGlhZGRyc5YACASsEsv1BlwfAAoErBLL9QZcIN0DgnJzhQADAQAAiXNlY3AyNTZrMaECe9goLd4kMjEMQO4rswSFcQgiiW7sRIJCn0QYvx-zxISDdGNwglwfg3VkcIJcIYV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23582/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.116.45/tcp/56644/p2p/16Uiu2HAkzgDVhRrrBefUTFUzfzipkVd1cHDHa59HPH5nnKbeSPtH"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23582/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.13.233/tcp/61025/p2p/16Uiu2HAmKfAjhU3ogfTVxa58uS1qyPZJ9Nz1Jd2UCJcbLaqFm6yu"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:56643/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61024/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23582/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1735152783585302272}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56643/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1735152783585302272,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.116.45/tcp/56644"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.116.45/tcp/56644"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id eeda160397b5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 921c2f0f6878
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container eeda160397b5. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 59a40f5afbb0
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 921c2f0f6878. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.