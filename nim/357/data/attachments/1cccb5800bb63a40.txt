[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-12_04-31-54__ee3afb73-f3ca-4da7-9bcf-c2ae2ff882ae
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-12_04-31-54__ee3afb73-f3ca-4da7-9bcf-c2ae2ff882ae__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.87.195
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['58739', '58740', '58741', '58742', '58743']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 58739:58739 -p 58740:58740 -p 58741:58741 -p 58742:58742 -p 58743:58743 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58741 --rest-port=58739 --tcp-port=58740 --discv5-udp-port=58742 --rest-address=0.0.0.0 --nat=extip:172.18.87.195 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=cafb9f284eaae7eb34afe90bcba130ab3fdb91f830af49dbde09b03138e8faaa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58743 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.87.195 waku 07a45e79a0697f7d27d8202fc77a754a6d6a3c6e1f016a747d1ad06c726820ab
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 07a45e79a069. Setting up logs at ./log/docker/node1_2024-09-12_04-31-54__ee3afb73-f3ca-4da7-9bcf-c2ae2ff882ae__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 58739
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58739/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58739/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.87.195/tcp/58740/p2p/16Uiu2HAm2aQQr2Te92m8o7e8D341PdvHXEMKfkDB5rcGByN5S2jB","/ip4/172.18.87.195/tcp/58741/ws/p2p/16Uiu2HAm2aQQr2Te92m8o7e8D341PdvHXEMKfkDB5rcGByN5S2jB"],"enrUri":"enr:-LO4QI7unKMZ8AMNDm3pxoHsNOSGQYMlNYWubwUEKr2WrOv8CLsun__FZmn5zz8sN1izJZ38ZL9CJT-mEseaNHsvxfIBgmlkgnY0gmlwhKwSV8OKbXVsdGlhZGRyc4wACgSsElfDBuV13QOCcnOFAAIBAACJc2VjcDI1NmsxoQJqPm7S4v9jt8jyMJOWaAq57jcjp6PUXq-AiEkAWZKm-oN0Y3CC5XSDdWRwguV2hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-12_04-31-54__ee3afb73-f3ca-4da7-9bcf-c2ae2ff882ae__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.31.60
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['4701', '4702', '4703', '4704', '4705']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 4701:4701 -p 4702:4702 -p 4703:4703 -p 4704:4704 -p 4705:4705 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4703 --rest-port=4701 --tcp-port=4702 --discv5-udp-port=4704 --rest-address=0.0.0.0 --nat=extip:172.18.31.60 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ac649d1c547be70bcf9dee3b4dc976f9bdcf3c63332ac3dcfc229e7ff54a8b85 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4705 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QI7unKMZ8AMNDm3pxoHsNOSGQYMlNYWubwUEKr2WrOv8CLsun__FZmn5zz8sN1izJZ38ZL9CJT-mEseaNHsvxfIBgmlkgnY0gmlwhKwSV8OKbXVsdGlhZGRyc4wACgSsElfDBuV13QOCcnOFAAIBAACJc2VjcDI1NmsxoQJqPm7S4v9jt8jyMJOWaAq57jcjp6PUXq-AiEkAWZKm-oN0Y3CC5XSDdWRwguV2hXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.31.60 waku 74d1763a70a3d575dfb97fb93c4e70fff118b2f4fdedcb72c90ffaaf23ae6127
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 74d1763a70a3. Setting up logs at ./log/docker/node2_2024-09-12_04-31-54__ee3afb73-f3ca-4da7-9bcf-c2ae2ff882ae__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 4701
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4701/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4701/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.31.60/tcp/4702/p2p/16Uiu2HAmFu4cUhd3TRBZFpAUBPX8oupGV4yGRBD3RxGFgedb3Rf5","/ip4/172.18.31.60/tcp/4703/ws/p2p/16Uiu2HAmFu4cUhd3TRBZFpAUBPX8oupGV4yGRBD3RxGFgedb3Rf5"],"enrUri":"enr:-LO4QEeDWfsrgAEpph1urcFu9iAX6MLm6FyJXwtuBGaCTg_yM3_9nVLqgnqY2bgq7pc0vChggXELYvT35x4-b_KGSRoBgmlkgnY0gmlwhKwSHzyKbXVsdGlhZGRyc4wACgSsEh88BhJf3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQMwLgLSKTNkVJTWCrfLhMLb39vXJE2SS9x_i1d7475PsIN0Y3CCEl6DdWRwghJghXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4701/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.87.195/tcp/58740/p2p/16Uiu2HAm2aQQr2Te92m8o7e8D341PdvHXEMKfkDB5rcGByN5S2jB"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58739/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4701/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58739/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58739/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726115518768711168,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4701/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726115518768711168,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 07a45e79a069
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 74d1763a70a3
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-12_04-31-54__ee3afb73-f3ca-4da7-9bcf-c2ae2ff882ae__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-12_04-31-54__ee3afb73-f3ca-4da7-9bcf-c2ae2ff882ae__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-12_04-32-04__d012c022-da97-4ce9-a51f-c5354a8dc6ed
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-12_04-32-04__d012c022-da97-4ce9-a51f-c5354a8dc6ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.210.77
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['3296', '3297', '3298', '3299', '3300']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 3296:3296 -p 3297:3297 -p 3298:3298 -p 3299:3299 -p 3300:3300 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3298 --rest-port=3296 --tcp-port=3297 --discv5-udp-port=3299 --rest-address=0.0.0.0 --nat=extip:172.18.210.77 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=2a3c3201ec7cfcd2ce7e1dd5ff5eafc75010f6fd2cdd6804fcde77f7dc908282 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3300 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.210.77 waku c7c61ccce6179ec5a05e140ea2a5aff28b883aee050713843323c5194d2a8924
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c7c61ccce617. Setting up logs at ./log/docker/node1_2024-09-12_04-32-04__d012c022-da97-4ce9-a51f-c5354a8dc6ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3296
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3296/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3296/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.210.77/tcp/3297/p2p/16Uiu2HAmF8L1T3vXzG4sf4FFsBmrqT6VhkqzRHTjomd7g35iCVQH","/ip4/172.18.210.77/tcp/3298/ws/p2p/16Uiu2HAmF8L1T3vXzG4sf4FFsBmrqT6VhkqzRHTjomd7g35iCVQH"],"enrUri":"enr:-LO4QB3eo5QMXRZQZ6bAPD_AFYoq-BhqMRRdZ7PZ3eeraobQaDeetnIuTbSKeM_6eAoLN-fE_7GVlBNn1QnQXJKwAREBgmlkgnY0gmlwhKwS0k2KbXVsdGlhZGRyc4wACgSsEtJNBgzi3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMkuEhyOI4Fu21rLb8FdjQ-10VtBNqBuBdeSsYC4ys2_oN0Y3CCDOGDdWRwggzjhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-12_04-32-04__d012c022-da97-4ce9-a51f-c5354a8dc6ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.81.96
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['30161', '30162', '30163', '30164', '30165']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 30161:30161 -p 30162:30162 -p 30163:30163 -p 30164:30164 -p 30165:30165 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30163 --rest-port=30161 --tcp-port=30162 --discv5-udp-port=30164 --rest-address=0.0.0.0 --nat=extip:172.18.81.96 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=f7d4a5103dabadfe93abe5cdcb8610f7cea8db842d529ea0d3ffbed3a734ffce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30165 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QB3eo5QMXRZQZ6bAPD_AFYoq-BhqMRRdZ7PZ3eeraobQaDeetnIuTbSKeM_6eAoLN-fE_7GVlBNn1QnQXJKwAREBgmlkgnY0gmlwhKwS0k2KbXVsdGlhZGRyc4wACgSsEtJNBgzi3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMkuEhyOI4Fu21rLb8FdjQ-10VtBNqBuBdeSsYC4ys2_oN0Y3CCDOGDdWRwggzjhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.81.96 waku 364632f831fb709a84eb51909f67b0866c43c5acc60f847196028c6d22316514
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 364632f831fb. Setting up logs at ./log/docker/node2_2024-09-12_04-32-04__d012c022-da97-4ce9-a51f-c5354a8dc6ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 30161
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30161/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30161/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.96/tcp/30162/p2p/16Uiu2HAmARwySXAq1EA6nNEWXm9SY7Fk5NAKe7k1x9qDvFLbaPvp","/ip4/172.18.81.96/tcp/30163/ws/p2p/16Uiu2HAmARwySXAq1EA6nNEWXm9SY7Fk5NAKe7k1x9qDvFLbaPvp"],"enrUri":"enr:-LO4QOqlEbFYgsII2mobSbxFqfr7zwyMje2QWPBrP6M23jarDG-zkXwSr1OubeKaCtBsNWjhHZ9kyVFSkFpTH9DC4r8BgmlkgnY0gmlwhKwSUWCKbXVsdGlhZGRyc4wACgSsElFgBnXT3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQLe8WNmIbh1XayJRjx4GRm6B463JfgVEhScpRWzzHnLcYN0Y3CCddKDdWRwgnXUhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30161/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.210.77/tcp/3297/p2p/16Uiu2HAmF8L1T3vXzG4sf4FFsBmrqT6VhkqzRHTjomd7g35iCVQH"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3296/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30161/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3296/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3296/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726115527543277568,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30161/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726115527543277568,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c7c61ccce617
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 364632f831fb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-12_04-32-04__d012c022-da97-4ce9-a51f-c5354a8dc6ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-12_04-32-04__d012c022-da97-4ce9-a51f-c5354a8dc6ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-12_04-32-12__bb7ebbbf-12e4-4387-ad02-b64fe1a3d8ac
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-12_04-32-12__bb7ebbbf-12e4-4387-ad02-b64fe1a3d8ac__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.98.146
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['65346', '65347', '65348', '65349', '65350']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 65346:65346 -p 65347:65347 -p 65348:65348 -p 65349:65349 -p 65350:65350 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65348 --rest-port=65346 --tcp-port=65347 --discv5-udp-port=65349 --rest-address=0.0.0.0 --nat=extip:172.18.98.146 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=3d6e7f9c9ec5baba5034bbecb8d3b11b2fbaadeed3deebb8ae7f83e772cb4596 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65350 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.98.146 waku 5db974d2237878417f35a0a857bcdcc53023e332da6097eef23bb521bb16703c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 5db974d22378. Setting up logs at ./log/docker/node1_2024-09-12_04-32-12__bb7ebbbf-12e4-4387-ad02-b64fe1a3d8ac__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 65346
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65346/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65346/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.98.146/tcp/65347/p2p/16Uiu2HAkv8AKc26DrVweQRhF4MYj91MgaXUYLQeN6PX6Rs6aM35e","/ip4/172.18.98.146/tcp/65348/ws/p2p/16Uiu2HAkv8AKc26DrVweQRhF4MYj91MgaXUYLQeN6PX6Rs6aM35e"],"enrUri":"enr:-LO4QOU_7GMLcOlVQBgnOWjvoGJDpWoPle4mfpkWo_yugJ8nBJsYIvLKDpBoI-ExxVmkeIavBsYipymCGzA7AF1MoqsBgmlkgnY0gmlwhKwSYpKKbXVsdGlhZGRyc4wACgSsEmKSBv9E3QOCcnOFAAIBAACJc2VjcDI1NmsxoQIKX0c9RA0bpfS2WianTFAEkRK_hWxuSpxhydDKqbF3JYN0Y3CC_0ODdWRwgv9FhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-12_04-32-12__bb7ebbbf-12e4-4387-ad02-b64fe1a3d8ac__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.11.61
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['48485', '48486', '48487', '48488', '48489']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 48485:48485 -p 48486:48486 -p 48487:48487 -p 48488:48488 -p 48489:48489 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48487 --rest-port=48485 --tcp-port=48486 --discv5-udp-port=48488 --rest-address=0.0.0.0 --nat=extip:172.18.11.61 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=bcfd3ddc67fc252fd8b1da3f77ddabdcb88bf6fec3bac7a605b2efdc1b5abcdd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48489 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QOU_7GMLcOlVQBgnOWjvoGJDpWoPle4mfpkWo_yugJ8nBJsYIvLKDpBoI-ExxVmkeIavBsYipymCGzA7AF1MoqsBgmlkgnY0gmlwhKwSYpKKbXVsdGlhZGRyc4wACgSsEmKSBv9E3QOCcnOFAAIBAACJc2VjcDI1NmsxoQIKX0c9RA0bpfS2WianTFAEkRK_hWxuSpxhydDKqbF3JYN0Y3CC_0ODdWRwgv9FhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.11.61 waku 48b3b0d94a6e156fd0776f3c589690e88d4a1aa034c6b3775bb0887722354e74
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 48b3b0d94a6e. Setting up logs at ./log/docker/node2_2024-09-12_04-32-12__bb7ebbbf-12e4-4387-ad02-b64fe1a3d8ac__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 48485
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48485/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48485/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.11.61/tcp/48486/p2p/16Uiu2HAmHTqTXtQm5HdQcw62LRKyJsvdkFMHqhhDcbRyRKyCgJ8T","/ip4/172.18.11.61/tcp/48487/ws/p2p/16Uiu2HAmHTqTXtQm5HdQcw62LRKyJsvdkFMHqhhDcbRyRKyCgJ8T"],"enrUri":"enr:-LO4QOpYbPeWsgDuO2xcGo3zK_I9qJMDwgPiUOF3T78DJshnZS2lnhJjHlFBEK0rE5HQZi2XLDzfaku9xltzfu_7BEABgmlkgnY0gmlwhKwSCz2KbXVsdGlhZGRyc4wACgSsEgs9Br1n3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQNHbv25uLrLT9RtpRgw1PXMhHcEa8wRIf_VVpfJhTN8XIN0Y3CCvWaDdWRwgr1ohXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48485/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.98.146/tcp/65347/p2p/16Uiu2HAkv8AKc26DrVweQRhF4MYj91MgaXUYLQeN6PX6Rs6aM35e"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65346/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48485/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65346/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65346/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726115536448413440,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48485/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726115536448413440,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 5db974d22378
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 48b3b0d94a6e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-12_04-32-12__bb7ebbbf-12e4-4387-ad02-b64fe1a3d8ac__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-12_04-32-12__bb7ebbbf-12e4-4387-ad02-b64fe1a3d8ac__wakuorg_nwaku:latest.log