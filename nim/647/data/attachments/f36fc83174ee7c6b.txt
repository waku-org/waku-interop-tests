2025-02-11 04:07:06.024 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:07:06.025 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_only_lightpush with id: 2025-02-11_04-07-06__7dc388be-4414-455a-b23f-e0c57b2df066
2025-02-11 04:07:06.025 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:07:06.025 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 04:07:06.032 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:07:06.032 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_04-07-06__7dc388be-4414-455a-b23f-e0c57b2df066__wakuorg_nwaku:latest.log
2025-02-11 04:07:06.032 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:07:06.032 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:07:06.033 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:07:06.034 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.37.226
2025-02-11 04:07:06.034 DEBUG [src.node.docker_mananger] Generated ports ['2217', '2218', '2219', '2220', '2221']
2025-02-11 04:07:06.034 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:07:06.034 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:07:06.034 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:07:06.034 DEBUG [src.node.docker_mananger] docker run -i -t -p 2217:2217 -p 2218:2218 -p 2219:2219 -p 2220:2220 -p 2221:2221 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2219 --rest-port=2217 --tcp-port=2218 --discv5-udp-port=2220 --rest-address=0.0.0.0 --nat=extip:172.18.37.226 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2f98cb374ccfd0bccaf8d2d37f2fcd416683e0056ccee0de65881dbdb733f85e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2221 --metrics-logging=true --lightpush=true --relay=false
2025-02-11 04:07:06.254 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.37.226 waku 500b044211eddb5ae18e1d7d36cb4770c10146d672c5b404fdcd47390796c0e8
2025-02-11 04:07:06.303 DEBUG [src.node.docker_mananger] Container started with ID 500b044211ed. Setting up logs at ./log/docker/receiving_node1_2025-02-11_04-07-06__7dc388be-4414-455a-b23f-e0c57b2df066__wakuorg_nwaku:latest.log
2025-02-11 04:07:06.304 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 2217
2025-02-11 04:07:06.305 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:07:06.834 ERROR [src.node.docker_mananger] Max retries reached for container 1dc1c706f313. Exiting log stream.
2025-02-11 04:07:07.305 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2217/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:07:07.308 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:07:07.308 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:07:07.308 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2217/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:07:07.310 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.37.226/tcp/2218/p2p/16Uiu2HAmLGHkvjb7KdXzQZCEqLQWcmEPbjU2hkC3KAkQRHzLDgpj","/ip4/172.18.37.226/tcp/2219/ws/p2p/16Uiu2HAmLGHkvjb7KdXzQZCEqLQWcmEPbjU2hkC3KAkQRHzLDgpj"],"enrUri":"enr:-L24QPDIxrqt7QwXN91_yi-kbQUXz9Lm4EITh1_eWXyNuU0UE6vWTtwCDBYzbwzrxxyW7PIBPGoYH9nZv_jPBjjLqncCgmlkgnY0gmlwhKwSJeKKbXVsdGlhZGRyc5YACASsEiXiBgiqAAoErBIl4gYIq90DgnJzhQADAQAAiXNlY3AyNTZrMaEDcQzRz3RPjtKmQTgFFkcwQPNwIxgfwgZnks7tzfuaNvyDdGNwggiqg3VkcIIIrIV3YWt1Mgg"}'
2025-02-11 04:07:07.310 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:07:07.317 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:07:07.317 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_04-07-06__7dc388be-4414-455a-b23f-e0c57b2df066__wakuorg_nwaku:latest.log
2025-02-11 04:07:07.317 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:07:07.317 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:07:07.318 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:07:07.319 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.138.2
2025-02-11 04:07:07.319 DEBUG [src.node.docker_mananger] Generated ports ['30859', '30860', '30861', '30862', '30863']
2025-02-11 04:07:07.319 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:07:07.319 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:07:07.319 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:07:07.319 DEBUG [src.node.docker_mananger] docker run -i -t -p 30859:30859 -p 30860:30860 -p 30861:30861 -p 30862:30862 -p 30863:30863 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30861 --rest-port=30859 --tcp-port=30860 --discv5-udp-port=30862 --rest-address=0.0.0.0 --nat=extip:172.18.138.2 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=46c831abfe9d0ade4daae0c99a8165a7880a0cd7fe4d91ab3bfcf5245ef05c71 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30863 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QPDIxrqt7QwXN91_yi-kbQUXz9Lm4EITh1_eWXyNuU0UE6vWTtwCDBYzbwzrxxyW7PIBPGoYH9nZv_jPBjjLqncCgmlkgnY0gmlwhKwSJeKKbXVsdGlhZGRyc5YACASsEiXiBgiqAAoErBIl4gYIq90DgnJzhQADAQAAiXNlY3AyNTZrMaEDcQzRz3RPjtKmQTgFFkcwQPNwIxgfwgZnks7tzfuaNvyDdGNwggiqg3VkcIIIrIV3YWt1Mgg --lightpushnode=/ip4/172.18.37.226/tcp/2218/p2p/16Uiu2HAmLGHkvjb7KdXzQZCEqLQWcmEPbjU2hkC3KAkQRHzLDgpj --lightpush=true --relay=false
2025-02-11 04:07:07.544 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.138.2 waku fdb50ea794dfb2603a8b529d2bdf2998af867cda58cbc20366a90ab9fcf26ad4
2025-02-11 04:07:07.588 DEBUG [src.node.docker_mananger] Container started with ID fdb50ea794df. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_04-07-06__7dc388be-4414-455a-b23f-e0c57b2df066__wakuorg_nwaku:latest.log
2025-02-11 04:07:07.588 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30859
2025-02-11 04:07:07.589 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:07:08.590 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30859/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:07:08.593 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:07:08.593 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:07:08.593 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30859/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:07:08.595 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.138.2/tcp/30860/p2p/16Uiu2HAm3kfLg3yMqLSaVUNFwuktb9G6L2Zoro8j82PPTKdMP9LL","/ip4/172.18.138.2/tcp/30861/ws/p2p/16Uiu2HAm3kfLg3yMqLSaVUNFwuktb9G6L2Zoro8j82PPTKdMP9LL"],"enrUri":"enr:-L24QF_MsM-1Qn73SR0AM3CSoeFnqVKPtAa7bd1AYcSKQGfvTgbcL-6TW9hgB5TS89ZsFkapjWIAdCbFmUd-NZC5n3ACgmlkgnY0gmlwhKwSigKKbXVsdGlhZGRyc5YACASsEooCBniMAAoErBKKAgZ4jd0DgnJzhQADAQAAiXNlY3AyNTZrMaECe7rOoQbAW6mds-4jeLMNeOD2f2IgtskkXu_pffhJDDGDdGNwgniMg3VkcIJ4joV3YWt1Mgg"}'
2025-02-11 04:07:08.595 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:07:08.596 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30859/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.37.226/tcp/2218/p2p/16Uiu2HAmLGHkvjb7KdXzQZCEqLQWcmEPbjU2hkC3KAkQRHzLDgpj"]'
2025-02-11 04:07:08.631 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:08.633 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30859/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739246828633688832}}'
2025-02-11 04:07:08.655 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:30859/lightpush/v1/message. Response content: b'Failed to request a message push: no waku relay found'
2025-02-11 04:07:08.656 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:07:08.657 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:07:08.658 DEBUG [src.node.waku_node] Stopping container with id 500b044211ed
2025-02-11 04:07:09.793 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:07:09.794 DEBUG [src.node.waku_node] Stopping container with id fdb50ea794df
2025-02-11 04:07:10.606 ERROR [src.node.docker_mananger] Max retries reached for container 500b044211ed. Exiting log stream.
2025-02-11 04:07:11.301 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:07:11.302 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:07:11.305 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:07:11.309 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
