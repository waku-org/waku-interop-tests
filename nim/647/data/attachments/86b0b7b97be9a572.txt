2025-02-11 04:06:57.040 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:06:57.041 DEBUG [tests.conftest] Running test: test_store_with_wrong_url_pubsub_topic with id: 2025-02-11_04-06-57__057a3291-dccb-44d5-a642-5f371fbc0d13
2025-02-11 04:06:57.042 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:06:57.042 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 04:06:57.043 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-11 04:06:57.051 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:06:57.051 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-11_04-06-57__057a3291-dccb-44d5-a642-5f371fbc0d13__wakuorg_nwaku:latest.log
2025-02-11 04:06:57.051 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:06:57.051 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:06:57.053 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:06:57.054 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.176.97
2025-02-11 04:06:57.054 DEBUG [src.node.docker_mananger] Generated ports ['33894', '33895', '33896', '33897', '33898']
2025-02-11 04:06:57.054 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:06:57.054 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:06:57.054 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:06:57.054 DEBUG [src.node.docker_mananger] docker run -i -t -p 33894:33894 -p 33895:33895 -p 33896:33896 -p 33897:33897 -p 33898:33898 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33896 --rest-port=33894 --tcp-port=33895 --discv5-udp-port=33897 --rest-address=0.0.0.0 --nat=extip:172.18.176.97 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1dd72744b6a7c05dd69654dea02ffac11c6debae6ba8ccac5710c8ad9b8b2a29 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33898 --metrics-logging=true --store=true --relay=true
2025-02-11 04:06:57.291 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.176.97 waku 0478d5445fa3cb2f271efd2812eb46daf0c19ed0da957291cffeb213183bade3
2025-02-11 04:06:57.340 DEBUG [src.node.docker_mananger] Container started with ID 0478d5445fa3. Setting up logs at ./log/docker/publishing_node1_2025-02-11_04-06-57__057a3291-dccb-44d5-a642-5f371fbc0d13__wakuorg_nwaku:latest.log
2025-02-11 04:06:57.341 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33894
2025-02-11 04:06:57.343 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:06:57.873 ERROR [src.node.docker_mananger] Max retries reached for container 9ea7b095d9dc. Exiting log stream.
2025-02-11 04:06:58.343 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33894/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:06:58.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:06:58.347 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:06:58.347 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33894/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:06:58.349 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.176.97/tcp/33895/p2p/16Uiu2HAmU7ebnah23Tf6ezB7YPbBufABLJ3VQfzb8ktiEwjAF9wL","/ip4/172.18.176.97/tcp/33896/ws/p2p/16Uiu2HAmU7ebnah23Tf6ezB7YPbBufABLJ3VQfzb8ktiEwjAF9wL"],"enrUri":"enr:-L24QO5gkg_xzvb1g29vKtk6TJ8pEjlVho8z5DfEl_ZEAsIPRQNE13bG2C_G6c9vOUBXbNqeNlW7wQMW73jncvnR5mgCgmlkgnY0gmlwhKwSsGGKbXVsdGlhZGRyc5YACASsErBhBoRnAAoErBKwYQaEaN0DgnJzhQADAQAAiXNlY3AyNTZrMaED5bOnfweirqJ7XONx0DNps_SqmhjAtLb9m-s3HnneOm-DdGNwgoRng3VkcIKEaYV3YWt1MgM"}'
2025-02-11 04:06:58.349 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:06:58.356 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:06:58.356 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-11_04-06-57__057a3291-dccb-44d5-a642-5f371fbc0d13__wakuorg_nwaku:latest.log
2025-02-11 04:06:58.357 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:06:58.357 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:06:58.358 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:06:58.358 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.230.22
2025-02-11 04:06:58.358 DEBUG [src.node.docker_mananger] Generated ports ['7703', '7704', '7705', '7706', '7707']
2025-02-11 04:06:58.359 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:06:58.359 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:06:58.359 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:06:58.359 DEBUG [src.node.docker_mananger] docker run -i -t -p 7703:7703 -p 7704:7704 -p 7705:7705 -p 7706:7706 -p 7707:7707 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7705 --rest-port=7703 --tcp-port=7704 --discv5-udp-port=7706 --rest-address=0.0.0.0 --nat=extip:172.18.230.22 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c8618483bebbcd61d6f61ef22245d2dcee36eeac039febc8d6284ec2a992f325 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7707 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QO5gkg_xzvb1g29vKtk6TJ8pEjlVho8z5DfEl_ZEAsIPRQNE13bG2C_G6c9vOUBXbNqeNlW7wQMW73jncvnR5mgCgmlkgnY0gmlwhKwSsGGKbXVsdGlhZGRyc5YACASsErBhBoRnAAoErBKwYQaEaN0DgnJzhQADAQAAiXNlY3AyNTZrMaED5bOnfweirqJ7XONx0DNps_SqmhjAtLb9m-s3HnneOm-DdGNwgoRng3VkcIKEaYV3YWt1MgM --storenode=/ip4/172.18.176.97/tcp/33895/p2p/16Uiu2HAmU7ebnah23Tf6ezB7YPbBufABLJ3VQfzb8ktiEwjAF9wL --store=true --relay=true
2025-02-11 04:06:58.589 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.230.22 waku 3b20425b81768cdd38aefeea3b3be62212014e58ae32e113ba332d81f9fa8c35
2025-02-11 04:06:58.639 DEBUG [src.node.docker_mananger] Container started with ID 3b20425b8176. Setting up logs at ./log/docker/store_node1_2025-02-11_04-06-57__057a3291-dccb-44d5-a642-5f371fbc0d13__wakuorg_nwaku:latest.log
2025-02-11 04:06:58.641 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 7703
2025-02-11 04:06:58.641 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:06:59.641 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7703/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:06:59.644 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:06:59.645 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:06:59.645 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7703/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:06:59.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.230.22/tcp/7704/p2p/16Uiu2HAm7trxgc1EUuB7aanxz4vw3rusfcyTGFd584wY86iEZEcu","/ip4/172.18.230.22/tcp/7705/ws/p2p/16Uiu2HAm7trxgc1EUuB7aanxz4vw3rusfcyTGFd584wY86iEZEcu"],"enrUri":"enr:-L24QKkjuvjrkF9g8QKaNuYavtiDvNfi0HTvoEGokL7r2Fx5TdgEh2e6J6neQA3oVvdzfKz9EKB7sNSDWzS-zUnPSpUCgmlkgnY0gmlwhKwS5haKbXVsdGlhZGRyc5YACASsEuYWBh4YAAoErBLmFgYeGd0DgnJzhQADAQAAiXNlY3AyNTZrMaECuUNXT_aV9Xr7gx_xhCiOYy_PllaICygJF2fYG9MRwCaDdGNwgh4Yg3VkcIIeGoV3YWt1MgM"}'
2025-02-11 04:06:59.647 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:06:59.647 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7703/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.176.97/tcp/33895/p2p/16Uiu2HAmU7ebnah23Tf6ezB7YPbBufABLJ3VQfzb8ktiEwjAF9wL"]'
2025-02-11 04:06:59.650 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:06:59.650 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 04:06:59.653 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:06:59.653 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7703/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 04:06:59.655 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:06:59.656 DEBUG [src.steps.store] Relaying message
2025-02-11 04:06:59.656 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:06:59.662 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:06:59.662 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:06:59.864 DEBUG [src.steps.store] Relaying message
2025-02-11 04:06:59.864 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/waku/2/content/test.js", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:06:59.871 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:06:59.871 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:00.072 DEBUG [src.steps.store] Relaying message
2025-02-11 04:07:00.073 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/22/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:07:00.080 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:00.080 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:00.281 DEBUG [src.steps.store] Relaying message
2025-02-11 04:07:00.282 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:07:00.287 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:00.288 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:00.488 DEBUG [src.steps.store] Relaying message
2025-02-11 04:07:00.489 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/statusim/1/community/cbor", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:07:00.495 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:00.496 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:00.697 DEBUG [src.steps.store] Relaying message
2025-02-11 04:07:00.697 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/27/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:07:00.704 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:00.704 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:00.905 DEBUG [src.steps.store] Relaying message
2025-02-11 04:07:00.906 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/29/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:07:00.912 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:00.912 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:01.113 DEBUG [src.steps.store] Relaying message
2025-02-11 04:07:01.113 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/20/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:07:01.119 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:01.120 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:01.322 DEBUG [tests.store.test_topics] Trying to get stored msg with wrong url topic waku/2/rs/3/0
2025-02-11 04:07:01.322 DEBUG [src.steps.store] Relaying message
2025-02-11 04:07:01.322 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33894/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:07:01.328 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:07:01.328 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:07:01.529 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 04:07:01.530 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33894/store/v3/messages?pubsubTopic=waku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:07:01.533 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-11 04:07:01.533 ERROR [tests.store.test_topics] Topic waku/2/rs/3/0 is wrong ''n: Peer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
2025-02-11 04:07:01.536 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:07:01.538 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:07:01.538 DEBUG [src.node.waku_node] Stopping container with id 0478d5445fa3
2025-02-11 04:07:02.866 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:07:02.866 DEBUG [src.node.waku_node] Stopping container with id 3b20425b8176
2025-02-11 04:07:03.626 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:07:03.627 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:07:03.639 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:07:03.646 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
