2025-02-11 04:04:08.560 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:04:08.560 DEBUG [tests.conftest] Running test: test_subscribe_and_publish_on_another_content_topic_from_same_shard with id: 2025-02-11_04-04-08__eb4eaa19-abdc-4955-9dbc-e15593efd30c
2025-02-11 04:04:08.560 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:04:08.560 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 04:04:08.561 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-11 04:04:08.567 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:04:08.567 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_04-04-08__eb4eaa19-abdc-4955-9dbc-e15593efd30c__wakuorg_nwaku:latest.log
2025-02-11 04:04:08.567 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:04:08.568 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:04:08.569 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:04:08.569 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.132.227
2025-02-11 04:04:08.569 DEBUG [src.node.docker_mananger] Generated ports ['6932', '6933', '6934', '6935', '6936']
2025-02-11 04:04:08.569 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:04:08.570 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:04:08.570 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:04:08.570 DEBUG [src.node.docker_mananger] docker run -i -t -p 6932:6932 -p 6933:6933 -p 6934:6934 -p 6935:6935 -p 6936:6936 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6934 --rest-port=6932 --tcp-port=6933 --discv5-udp-port=6935 --rest-address=0.0.0.0 --nat=extip:172.18.132.227 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=47cdead6acbb523b657803dedbe2aecafc5cb8c949fbaeafce6dc1adf7edd8ad --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6936 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
2025-02-11 04:04:08.805 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.132.227 waku 3d7cb2ffd2af0def1a53276a407c367481247a74d9dac323c8d04ecef4a0c34f
2025-02-11 04:04:08.858 DEBUG [src.node.docker_mananger] Container started with ID 3d7cb2ffd2af. Setting up logs at ./log/docker/node1_2025-02-11_04-04-08__eb4eaa19-abdc-4955-9dbc-e15593efd30c__wakuorg_nwaku:latest.log
2025-02-11 04:04:08.859 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6932
2025-02-11 04:04:08.859 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:04:09.345 ERROR [src.node.docker_mananger] Max retries reached for container 6cb2805bfdd4. Exiting log stream.
2025-02-11 04:04:09.859 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6932/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:09.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:04:09.862 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:04:09.862 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6932/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:09.864 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.132.227/tcp/6933/p2p/16Uiu2HAm8QxB9R8JA8BGJC8GVkLUrCe9TTQV8EjStFdNY5rLBMqv","/ip4/172.18.132.227/tcp/6934/ws/p2p/16Uiu2HAm8QxB9R8JA8BGJC8GVkLUrCe9TTQV8EjStFdNY5rLBMqv"],"enrUri":"enr:-L24QEGFFMVYc8pamGa5aR8psCwCIT__u8Aud1JFPgVlkvfiFhWoQ1FjWE8KRPN6wn4yzU4BrM8LEqK8kK2Nyu4stfgCgmlkgnY0gmlwhKwShOOKbXVsdGlhZGRyc5YACASsEoTjBhsVAAoErBKE4wYbFt0DgnJzhQACAQAAiXNlY3AyNTZrMaECwPipbA2a6tHHn0kTUXk6d1r2EGAgIsm2OJxpVXBUDsWDdGNwghsVg3VkcIIbF4V3YWt1MgU"}'
2025-02-11 04:04:09.865 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:04:09.871 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:04:09.871 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_04-04-08__eb4eaa19-abdc-4955-9dbc-e15593efd30c__wakuorg_nwaku:latest.log
2025-02-11 04:04:09.871 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:04:09.871 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:04:09.873 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:04:09.873 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.142.247
2025-02-11 04:04:09.873 DEBUG [src.node.docker_mananger] Generated ports ['24960', '24961', '24962', '24963', '24964']
2025-02-11 04:04:09.873 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:04:09.873 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:04:09.874 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:04:09.874 DEBUG [src.node.docker_mananger] docker run -i -t -p 24960:24960 -p 24961:24961 -p 24962:24962 -p 24963:24963 -p 24964:24964 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24962 --rest-port=24960 --tcp-port=24961 --discv5-udp-port=24963 --rest-address=0.0.0.0 --nat=extip:172.18.142.247 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=f1dca38dd13b5fbeddd1dbbcb2e64f5c64ec9f6f1cf672705edb3c2432385c08 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24964 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QEGFFMVYc8pamGa5aR8psCwCIT__u8Aud1JFPgVlkvfiFhWoQ1FjWE8KRPN6wn4yzU4BrM8LEqK8kK2Nyu4stfgCgmlkgnY0gmlwhKwShOOKbXVsdGlhZGRyc5YACASsEoTjBhsVAAoErBKE4wYbFt0DgnJzhQACAQAAiXNlY3AyNTZrMaECwPipbA2a6tHHn0kTUXk6d1r2EGAgIsm2OJxpVXBUDsWDdGNwghsVg3VkcIIbF4V3YWt1MgU --content-topic=/myapp/1/latest/proto
2025-02-11 04:04:10.111 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.142.247 waku 4c181a7f5446944fecd2c62d2976494d005316644c9693e5b482dc7b4376fe41
2025-02-11 04:04:10.158 DEBUG [src.node.docker_mananger] Container started with ID 4c181a7f5446. Setting up logs at ./log/docker/node2_2025-02-11_04-04-08__eb4eaa19-abdc-4955-9dbc-e15593efd30c__wakuorg_nwaku:latest.log
2025-02-11 04:04:10.159 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24960
2025-02-11 04:04:10.159 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:04:11.162 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24960/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:11.169 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:04:11.169 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:04:11.170 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24960/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:11.173 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.142.247/tcp/24961/p2p/16Uiu2HAmMEG8asxJkak8ZDD9d4JR4q9PVPtGvR1nrxrb9ykRtqxk","/ip4/172.18.142.247/tcp/24962/ws/p2p/16Uiu2HAmMEG8asxJkak8ZDD9d4JR4q9PVPtGvR1nrxrb9ykRtqxk"],"enrUri":"enr:-L24QFER9ZjRY-OhtWp6KeTXu7kEDlus6YfJe_qN7ZhoMGqXI4em9RvJyIpsg_U1b5AaYTzcEh2NhKHW8QPdxUxLrncCgmlkgnY0gmlwhKwSjveKbXVsdGlhZGRyc5YACASsEo73BmGBAAoErBKO9wZhgt0DgnJzhQACAQAAiXNlY3AyNTZrMaEDf2OBdKpWOa1-rGvEYeZV_2HnPJI884g7tTZVx1f_NrmDdGNwgmGBg3VkcIJhg4V3YWt1MgE"}'
2025-02-11 04:04:11.173 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:04:11.174 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24960/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.132.227/tcp/6933/p2p/16Uiu2HAm8QxB9R8JA8BGJC8GVkLUrCe9TTQV8EjStFdNY5rLBMqv"]'
2025-02-11 04:04:11.176 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:11.176 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6932/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2025-02-11 04:04:11.180 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:11.181 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24960/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2025-02-11 04:04:11.187 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:11.188 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6932/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/newsService/1.0/weekly/protobuf", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:04:11.194 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:11.194 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:04:11.294 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:11.295 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6932/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:11.297 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1739246651188138752,"ephemeral":false}]'
2025-02-11 04:04:11.299 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:11.299 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24960/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:11.301 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1739246651188138752,"ephemeral":false}]'
2025-02-11 04:04:11.303 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6932/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:04:11.308 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:11.308 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:04:11.409 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:11.409 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6932/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:11.411 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739246651303116800,"ephemeral":false}]'
2025-02-11 04:04:11.413 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:11.413 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24960/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:11.415 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739246651303116800,"ephemeral":false}]'
2025-02-11 04:04:11.417 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:04:11.418 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:04:11.418 DEBUG [src.node.waku_node] Stopping container with id 3d7cb2ffd2af
2025-02-11 04:04:12.331 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:04:12.332 DEBUG [src.node.waku_node] Stopping container with id 4c181a7f5446
2025-02-11 04:04:13.144 ERROR [src.node.docker_mananger] Max retries reached for container 3d7cb2ffd2af. Exiting log stream.
2025-02-11 04:04:13.828 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:04:13.830 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:04:13.835 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:04:13.840 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
