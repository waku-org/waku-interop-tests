2025-02-11 04:02:43.173 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:02:43.173 DEBUG [tests.conftest] Running test: test_filter_resubscribe_to_unsubscribed_topics with id: 2025-02-11_04-02-43__6c2e5746-3863-4bac-bab4-166efe7a0172
2025-02-11 04:02:43.174 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:02:43.174 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 04:02:43.174 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-11 04:02:43.180 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:02:43.180 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_04-02-43__6c2e5746-3863-4bac-bab4-166efe7a0172__wakuorg_nwaku:latest.log
2025-02-11 04:02:43.180 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:02:43.180 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:02:43.182 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:02:43.182 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.206.3
2025-02-11 04:02:43.182 DEBUG [src.node.docker_mananger] Generated ports ['31909', '31910', '31911', '31912', '31913']
2025-02-11 04:02:43.182 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:02:43.182 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:02:43.182 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:02:43.183 DEBUG [src.node.docker_mananger] docker run -i -t -p 31909:31909 -p 31910:31910 -p 31911:31911 -p 31912:31912 -p 31913:31913 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31911 --rest-port=31909 --tcp-port=31910 --discv5-udp-port=31912 --rest-address=0.0.0.0 --nat=extip:172.18.206.3 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=493d8169fcbeaecedada3163ba70cdfb7d1eee7ecb3669b2cb211af891b3c565 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31913 --metrics-logging=true --relay=true --filter=true
2025-02-11 04:02:43.405 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.206.3 waku d0dbb1564e2648ed16ea5411afd9f69d59da81cc384d837f7e0d1e27058eedf6
2025-02-11 04:02:43.450 DEBUG [src.node.docker_mananger] Container started with ID d0dbb1564e26. Setting up logs at ./log/docker/node1_2025-02-11_04-02-43__6c2e5746-3863-4bac-bab4-166efe7a0172__wakuorg_nwaku:latest.log
2025-02-11 04:02:43.452 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31909
2025-02-11 04:02:43.452 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:02:43.980 ERROR [src.node.docker_mananger] Max retries reached for container bef243acdf7d. Exiting log stream.
2025-02-11 04:02:44.454 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31909/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:02:44.457 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:02:44.457 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:02:44.457 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31909/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:02:44.459 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.206.3/tcp/31910/p2p/16Uiu2HAm4zyBf1ZfLDQujmfcxD5DaVLWLwWizweCTbZCDPdKAowU","/ip4/172.18.206.3/tcp/31911/ws/p2p/16Uiu2HAm4zyBf1ZfLDQujmfcxD5DaVLWLwWizweCTbZCDPdKAowU"],"enrUri":"enr:-L24QEumoGF-jAleYIzjecpX1gV2M8rdqZrztN-KU9UH8UjpCnmxtfyEhA__ayivZTqOA705EWgzwE4YXvHoWuOmupsCgmlkgnY0gmlwhKwSzgOKbXVsdGlhZGRyc5YACASsEs4DBnymAAoErBLOAwZ8p90DgnJzhQADAQAAiXNlY3AyNTZrMaECjkDNYNSxLPRnp9Z88bDRgwDtO3ARMFU5Cvumaj5_BFeDdGNwgnymg3VkcIJ8qIV3YWt1MgU"}'
2025-02-11 04:02:44.459 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:02:44.460 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-11 04:02:44.466 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:02:44.466 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_04-02-43__6c2e5746-3863-4bac-bab4-166efe7a0172__wakuorg_nwaku:latest.log
2025-02-11 04:02:44.466 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:02:44.466 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:02:44.468 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:02:44.468 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.15.183
2025-02-11 04:02:44.468 DEBUG [src.node.docker_mananger] Generated ports ['15848', '15849', '15850', '15851', '15852']
2025-02-11 04:02:44.468 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:02:44.468 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:02:44.468 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:02:44.468 DEBUG [src.node.docker_mananger] docker run -i -t -p 15848:15848 -p 15849:15849 -p 15850:15850 -p 15851:15851 -p 15852:15852 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15850 --rest-port=15848 --tcp-port=15849 --discv5-udp-port=15851 --rest-address=0.0.0.0 --nat=extip:172.18.15.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=96c70a0ed3efeceb7dbab9fddf308b124d5dfbb176bcfdaa8bba98bc4fdff690 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15852 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QEumoGF-jAleYIzjecpX1gV2M8rdqZrztN-KU9UH8UjpCnmxtfyEhA__ayivZTqOA705EWgzwE4YXvHoWuOmupsCgmlkgnY0gmlwhKwSzgOKbXVsdGlhZGRyc5YACASsEs4DBnymAAoErBLOAwZ8p90DgnJzhQADAQAAiXNlY3AyNTZrMaECjkDNYNSxLPRnp9Z88bDRgwDtO3ARMFU5Cvumaj5_BFeDdGNwgnymg3VkcIJ8qIV3YWt1MgU --filternode=/ip4/172.18.206.3/tcp/31910/p2p/16Uiu2HAm4zyBf1ZfLDQujmfcxD5DaVLWLwWizweCTbZCDPdKAowU
2025-02-11 04:02:44.705 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.15.183 waku 95fca756a6e8666fcaa0002dcdb8156876e567fe954270f35057fd33267ea5af
2025-02-11 04:02:44.753 DEBUG [src.node.docker_mananger] Container started with ID 95fca756a6e8. Setting up logs at ./log/docker/node2_2025-02-11_04-02-43__6c2e5746-3863-4bac-bab4-166efe7a0172__wakuorg_nwaku:latest.log
2025-02-11 04:02:44.754 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15848
2025-02-11 04:02:44.754 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:02:45.755 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15848/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:02:45.758 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:02:45.758 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:02:45.758 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15848/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:02:45.760 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.15.183/tcp/15849/p2p/16Uiu2HAmTCjkADcoEa3Ex5ktSjQR5HTYLVezJ7GwTW3E5BVuAd5Z","/ip4/172.18.15.183/tcp/15850/ws/p2p/16Uiu2HAmTCjkADcoEa3Ex5ktSjQR5HTYLVezJ7GwTW3E5BVuAd5Z"],"enrUri":"enr:-L24QMg-d9JlrbnXaylRVovwds3Ts9Ys5NbvPWo3OLV9nAszaWRY7eQQTEz3_j6rgZAsaHz0bPpD2ZnrrJ5S10j3MF8CgmlkgnY0gmlwhKwSD7eKbXVsdGlhZGRyc5YACASsEg-3Bj3pAAoErBIPtwY96t0DgnJzhQADAQAAiXNlY3AyNTZrMaED2CWwKqVsmGwf0hGVdwYFdi_UMjWguVZv6MmlcQXNV8CDdGNwgj3pg3VkcII964V3YWt1MgA"}'
2025-02-11 04:02:45.760 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:02:45.761 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15848/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.206.3/tcp/31910/p2p/16Uiu2HAm4zyBf1ZfLDQujmfcxD5DaVLWLwWizweCTbZCDPdKAowU"]'
2025-02-11 04:02:45.798 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:02:45.799 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-11 04:02:45.799 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31909/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:02:45.816 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:02:45.817 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15848/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "6332380d-ce03-4a30-a158-83fffb1f556b", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 04:02:45.829 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"6332380d-ce03-4a30-a158-83fffb1f556b","statusDesc":"OK"}'
2025-02-11 04:02:45.831 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31909/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:02:45.839 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:02:45.840 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:02:45.940 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:02:45.940 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15848/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:02:45.943 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739246565831727872,"ephemeral":false}]'
2025-02-11 04:02:45.944 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:15848/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 04:02:45.952 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-11 04:02:45.952 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31909/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:02:45.955 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:02:45.955 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:02:46.055 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:02:46.056 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15848/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:02:46.058 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:15848/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
2025-02-11 04:02:46.060 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31909/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:02:46.062 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:02:46.063 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15848/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "c3795866-d167-481a-bc98-c7e3d39f75eb", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 04:02:46.071 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"c3795866-d167-481a-bc98-c7e3d39f75eb","statusDesc":"OK"}'
2025-02-11 04:02:46.071 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31909/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:02:46.075 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:02:46.075 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:02:46.175 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:02:46.176 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15848/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:02:46.178 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739246566071706624,"ephemeral":false}]'
2025-02-11 04:02:46.181 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:02:46.182 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:02:46.182 DEBUG [src.node.waku_node] Stopping container with id d0dbb1564e26
2025-02-11 04:02:47.027 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:02:47.027 DEBUG [src.node.waku_node] Stopping container with id 95fca756a6e8
2025-02-11 04:02:47.840 ERROR [src.node.docker_mananger] Max retries reached for container d0dbb1564e26. Exiting log stream.
2025-02-11 04:02:48.506 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:02:48.506 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:02:48.512 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:02:48.517 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
