2025-02-11 04:05:50.005 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:05:50.005 DEBUG [tests.conftest] Running test: test_publishing_node_is_stopped with id: 2025-02-11_04-05-50__8fa4e9d2-3d71-4160-aaae-5ed40b6719d1
2025-02-11 04:05:50.006 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:05:50.006 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-11 04:05:50.006 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-11 04:05:50.013 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:05:50.013 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-11_04-05-50__8fa4e9d2-3d71-4160-aaae-5ed40b6719d1__wakuorg_nwaku:latest.log
2025-02-11 04:05:50.013 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:05:50.013 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:05:50.014 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:05:50.015 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.191
2025-02-11 04:05:50.015 DEBUG [src.node.docker_mananger] Generated ports ['26390', '26391', '26392', '26393', '26394']
2025-02-11 04:05:50.015 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:05:50.015 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:05:50.015 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:05:50.015 DEBUG [src.node.docker_mananger] docker run -i -t -p 26390:26390 -p 26391:26391 -p 26392:26392 -p 26393:26393 -p 26394:26394 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26392 --rest-port=26390 --tcp-port=26391 --discv5-udp-port=26393 --rest-address=0.0.0.0 --nat=extip:172.18.254.191 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9ef08c34774e318afcf79dd22fe4a284d27fec3dc7f8d17d8c96b1b77eea3eea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26394 --metrics-logging=true --store=true --relay=true
2025-02-11 04:05:50.260 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.191 waku 6d5ec3e180d5b288341c5ab246fe6abe9e65850969cefd21efa54f1ef50d9abb
2025-02-11 04:05:50.306 DEBUG [src.node.docker_mananger] Container started with ID 6d5ec3e180d5. Setting up logs at ./log/docker/publishing_node1_2025-02-11_04-05-50__8fa4e9d2-3d71-4160-aaae-5ed40b6719d1__wakuorg_nwaku:latest.log
2025-02-11 04:05:50.308 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 26390
2025-02-11 04:05:50.309 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:05:50.812 ERROR [src.node.docker_mananger] Max retries reached for container 45ad64412f52. Exiting log stream.
2025-02-11 04:05:51.310 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26390/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:05:51.313 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:05:51.314 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:05:51.314 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26390/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:05:51.316 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.191/tcp/26391/p2p/16Uiu2HAkuv22CUw6CHzMnpLm3qyNjAbc7NdYfECbxEEdF7UChZgK","/ip4/172.18.254.191/tcp/26392/ws/p2p/16Uiu2HAkuv22CUw6CHzMnpLm3qyNjAbc7NdYfECbxEEdF7UChZgK"],"enrUri":"enr:-L24QCd8FStg7uQa5NlLyalfv7kKLuTKEY-QwRYOavC09q1lDCadYI6HzN0FFRlIbWpfNwl8XJSeZ90TiVKEh2-FYbkCgmlkgnY0gmlwhKwS_r-KbXVsdGlhZGRyc5YACASsEv6_BmcXAAoErBL-vwZnGN0DgnJzhQADAQAAiXNlY3AyNTZrMaECB0LsciBqX6GEf8_TJb1XUlRPhDk1z84P47SHY-90FbiDdGNwgmcXg3VkcIJnGYV3YWt1MgM"}'
2025-02-11 04:05:51.316 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:05:51.323 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:05:51.323 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-11_04-05-50__8fa4e9d2-3d71-4160-aaae-5ed40b6719d1__wakuorg_nwaku:latest.log
2025-02-11 04:05:51.323 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:05:51.323 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:05:51.324 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:05:51.325 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.230.183
2025-02-11 04:05:51.325 DEBUG [src.node.docker_mananger] Generated ports ['56215', '56216', '56217', '56218', '56219']
2025-02-11 04:05:51.325 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:05:51.325 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:05:51.325 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:05:51.325 DEBUG [src.node.docker_mananger] docker run -i -t -p 56215:56215 -p 56216:56216 -p 56217:56217 -p 56218:56218 -p 56219:56219 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56217 --rest-port=56215 --tcp-port=56216 --discv5-udp-port=56218 --rest-address=0.0.0.0 --nat=extip:172.18.230.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e7b0903fe03ac778afc4ed7639170f58c2ca0bd11cf9f9ab0cebf5e29bbcaa1d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56219 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QCd8FStg7uQa5NlLyalfv7kKLuTKEY-QwRYOavC09q1lDCadYI6HzN0FFRlIbWpfNwl8XJSeZ90TiVKEh2-FYbkCgmlkgnY0gmlwhKwS_r-KbXVsdGlhZGRyc5YACASsEv6_BmcXAAoErBL-vwZnGN0DgnJzhQADAQAAiXNlY3AyNTZrMaECB0LsciBqX6GEf8_TJb1XUlRPhDk1z84P47SHY-90FbiDdGNwgmcXg3VkcIJnGYV3YWt1MgM --storenode=/ip4/172.18.254.191/tcp/26391/p2p/16Uiu2HAkuv22CUw6CHzMnpLm3qyNjAbc7NdYfECbxEEdF7UChZgK --store=true --relay=true
2025-02-11 04:05:51.558 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.230.183 waku 74678bd9f1f8859fb1e90f2670fcabc57f33faeaab9d5d46addb702ee41eee1c
2025-02-11 04:05:51.609 DEBUG [src.node.docker_mananger] Container started with ID 74678bd9f1f8. Setting up logs at ./log/docker/store_node1_2025-02-11_04-05-50__8fa4e9d2-3d71-4160-aaae-5ed40b6719d1__wakuorg_nwaku:latest.log
2025-02-11 04:05:51.610 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 56215
2025-02-11 04:05:51.611 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:05:52.611 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56215/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:05:52.614 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:05:52.614 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:05:52.614 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56215/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:05:52.616 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.230.183/tcp/56216/p2p/16Uiu2HAkz5SvvxJhyQdqaDUUi1ukAjV75fw192yg5rcYUp9EWFQF","/ip4/172.18.230.183/tcp/56217/ws/p2p/16Uiu2HAkz5SvvxJhyQdqaDUUi1ukAjV75fw192yg5rcYUp9EWFQF"],"enrUri":"enr:-L24QIy6pcqTopoaXHkQL28JQKt0YPuMd4blgCq-zZFScZfpCZwm17aV7rueVvUmUot2Uuov7ZKB9pcoR6tjhCC6w_cCgmlkgnY0gmlwhKwS5reKbXVsdGlhZGRyc5YACASsEua3BtuYAAoErBLmtwbbmd0DgnJzhQADAQAAiXNlY3AyNTZrMaECRRwQQYfTghyQ0vvukZjWOj_1Tk6hs7lgrQ5B92sSbNSDdGNwgtuYg3VkcILbmoV3YWt1MgM"}'
2025-02-11 04:05:52.617 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:05:52.617 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56215/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.254.191/tcp/26391/p2p/16Uiu2HAkuv22CUw6CHzMnpLm3qyNjAbc7NdYfECbxEEdF7UChZgK"]'
2025-02-11 04:05:52.620 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:05:52.620 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26390/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 04:05:52.623 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:05:52.623 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56215/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 04:05:52.625 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:05:52.626 DEBUG [src.steps.store] Relaying message
2025-02-11 04:05:52.627 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26390/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:05:52.633 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:05:52.633 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-11 04:05:52.834 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 04:05:52.834 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26390/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:05:52.838 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x2c0c89b87e73d018f897ec51e323781bed08b58b37793b9d3e63e2a1a00c8b73"}]}'
2025-02-11 04:05:52.838 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-11 04:05:52.838 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56215/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:05:52.841 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x2c0c89b87e73d018f897ec51e323781bed08b58b37793b9d3e63e2a1a00c8b73"}]}'
2025-02-11 04:05:52.841 DEBUG [src.node.waku_node] Stopping container with id 6d5ec3e180d5
2025-02-11 04:05:53.860 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:05:53.860 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56215/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:05:53.864 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x2c0c89b87e73d018f897ec51e323781bed08b58b37793b9d3e63e2a1a00c8b73"}]}'
2025-02-11 04:05:53.866 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:05:53.867 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:05:53.867 DEBUG [src.node.waku_node] Stopping container with id 74678bd9f1f8
2025-02-11 04:05:54.673 ERROR [src.node.docker_mananger] Max retries reached for container 6d5ec3e180d5. Exiting log stream.
2025-02-11 04:05:55.122 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:05:55.122 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:05:55.127 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:05:55.133 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
