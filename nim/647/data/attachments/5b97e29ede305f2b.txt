2025-02-11 04:04:12.562 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:04:12.563 DEBUG [tests.conftest] Running test: test_publish_and_retrieve_duplicate_message with id: 2025-02-11_04-04-12__702cc525-a2c9-464a-a497-f858ea99aeb9
2025-02-11 04:04:12.564 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:04:12.564 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 04:04:12.565 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 04:04:12.575 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:04:12.575 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_04-04-12__702cc525-a2c9-464a-a497-f858ea99aeb9__wakuorg_nwaku:latest.log
2025-02-11 04:04:12.575 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:04:12.575 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:04:12.578 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:04:12.578 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.75.220
2025-02-11 04:04:12.578 DEBUG [src.node.docker_mananger] Generated ports ['26004', '26005', '26006', '26007', '26008']
2025-02-11 04:04:12.578 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:04:12.578 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:04:12.579 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:04:12.580 DEBUG [src.node.docker_mananger] docker run -i -t -p 26004:26004 -p 26005:26005 -p 26006:26006 -p 26007:26007 -p 26008:26008 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26006 --rest-port=26004 --tcp-port=26005 --discv5-udp-port=26007 --rest-address=0.0.0.0 --nat=extip:172.18.75.220 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f27fba10dcc9e88a3eb23af4c795b7df94fd01f5f8ae6e02adbc5a95facb6f4c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26008 --metrics-logging=true --relay=true
2025-02-11 04:04:12.812 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.75.220 waku c899f10697bfd417f1132e24ddcce12655b410a33a16f7e0c7c9e3eca63e77ad
2025-02-11 04:04:12.859 DEBUG [src.node.docker_mananger] Container started with ID c899f10697bf. Setting up logs at ./log/docker/node1_2025-02-11_04-04-12__702cc525-a2c9-464a-a497-f858ea99aeb9__wakuorg_nwaku:latest.log
2025-02-11 04:04:12.860 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 26004
2025-02-11 04:04:12.860 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:04:13.395 ERROR [src.node.docker_mananger] Max retries reached for container 7db81def5937. Exiting log stream.
2025-02-11 04:04:13.861 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26004/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:13.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:04:13.864 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:04:13.864 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26004/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:13.866 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.75.220/tcp/26005/p2p/16Uiu2HAmTL6LRkzNAx6HLtBhcsnVTD8krDEkdh5VqLNequaFwwxP","/ip4/172.18.75.220/tcp/26006/ws/p2p/16Uiu2HAmTL6LRkzNAx6HLtBhcsnVTD8krDEkdh5VqLNequaFwwxP"],"enrUri":"enr:-L24QOaYXR5qL2YeRFQQRAM07HVkteScnCkmaVgZkv-1CMR7WduVE0EN4KLY7I8eJdYeW3QS9vNT_uK_hEDOjzJzI0MCgmlkgnY0gmlwhKwSS9yKbXVsdGlhZGRyc5YACASsEkvcBmWVAAoErBJL3AZllt0DgnJzhQADAQAAiXNlY3AyNTZrMaED2ggJMx0rbJdug0-Os_5mJBKl8FE4QCaOuFvV4gFb5xSDdGNwgmWVg3VkcIJll4V3YWt1MgE"}'
2025-02-11 04:04:13.866 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:04:13.872 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:04:13.872 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_04-04-12__702cc525-a2c9-464a-a497-f858ea99aeb9__wakuorg_nwaku:latest.log
2025-02-11 04:04:13.872 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:04:13.872 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:04:13.874 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:04:13.874 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.163.160
2025-02-11 04:04:13.874 DEBUG [src.node.docker_mananger] Generated ports ['21576', '21577', '21578', '21579', '21580']
2025-02-11 04:04:13.874 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:04:13.874 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:04:13.874 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:04:13.875 DEBUG [src.node.docker_mananger] docker run -i -t -p 21576:21576 -p 21577:21577 -p 21578:21578 -p 21579:21579 -p 21580:21580 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21578 --rest-port=21576 --tcp-port=21577 --discv5-udp-port=21579 --rest-address=0.0.0.0 --nat=extip:172.18.163.160 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=177bb79241d1cc57e5924b4a827dcade8c9e4b6d3e1e888b6eb7f3fac1cea2d9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21580 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOaYXR5qL2YeRFQQRAM07HVkteScnCkmaVgZkv-1CMR7WduVE0EN4KLY7I8eJdYeW3QS9vNT_uK_hEDOjzJzI0MCgmlkgnY0gmlwhKwSS9yKbXVsdGlhZGRyc5YACASsEkvcBmWVAAoErBJL3AZllt0DgnJzhQADAQAAiXNlY3AyNTZrMaED2ggJMx0rbJdug0-Os_5mJBKl8FE4QCaOuFvV4gFb5xSDdGNwgmWVg3VkcIJll4V3YWt1MgE
2025-02-11 04:04:14.098 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.163.160 waku a16f012526a13ba040068f9041417170379dae572459b2b973aa270af3030f7e
2025-02-11 04:04:14.147 DEBUG [src.node.docker_mananger] Container started with ID a16f012526a1. Setting up logs at ./log/docker/node2_2025-02-11_04-04-12__702cc525-a2c9-464a-a497-f858ea99aeb9__wakuorg_nwaku:latest.log
2025-02-11 04:04:14.147 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 21576
2025-02-11 04:04:14.147 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:04:15.147 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21576/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.158 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:04:15.159 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:04:15.159 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21576/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.162 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.163.160/tcp/21577/p2p/16Uiu2HAm11jWT63c5jQdiPCSiQfYUFGozs8aBQ6zbr2f3paafGCJ","/ip4/172.18.163.160/tcp/21578/ws/p2p/16Uiu2HAm11jWT63c5jQdiPCSiQfYUFGozs8aBQ6zbr2f3paafGCJ"],"enrUri":"enr:-L24QDyrvy3CI97cikmG7tcGw0XVP5Vy4PKLDW6sxpyjGDVoZeWAm5yX--SOlcaoIWvgYFIzTe8HGPdsnHgI8qPQ2RoCgmlkgnY0gmlwhKwSo6CKbXVsdGlhZGRyc5YACASsEqOgBlRJAAoErBKjoAZUSt0DgnJzhQADAQAAiXNlY3AyNTZrMaECUwQsAh_1wIte0e6lQKXzfYxz1vOgbR9MMMAg8dc1AQuDdGNwglRJg3VkcIJUS4V3YWt1MgE"}'
2025-02-11 04:04:15.163 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:04:15.163 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21576/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.75.220/tcp/26005/p2p/16Uiu2HAmTL6LRkzNAx6HLtBhcsnVTD8krDEkdh5VqLNequaFwwxP"]'
2025-02-11 04:04:15.167 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:15.168 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 04:04:15.170 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26004/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:04:15.174 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:15.174 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21576/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:04:15.180 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:15.181 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26004/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:04:15.187 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:15.187 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:04:15.288 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:15.288 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26004/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.291 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246655181501440,"ephemeral":false}]'
2025-02-11 04:04:15.292 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:15.292 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21576/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.294 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246655181501440,"ephemeral":false}]'
2025-02-11 04:04:15.296 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 04:04:15.297 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26004/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:04:15.301 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:15.302 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:04:15.402 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:15.402 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26004/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.404 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246655297027072,"ephemeral":false}]'
2025-02-11 04:04:15.406 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:15.406 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21576/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.408 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246655297027072,"ephemeral":false}]'
2025-02-11 04:04:15.409 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26004/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:04:15.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:04:15.412 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:04:15.512 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:15.513 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26004/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246655297027072,"ephemeral":false}]'
2025-02-11 04:04:15.516 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:04:15.516 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21576/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:04:15.519 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-11 04:04:15.522 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:04:15.522 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:04:15.523 DEBUG [src.node.waku_node] Stopping container with id c899f10697bf
2025-02-11 04:04:16.331 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:04:16.331 DEBUG [src.node.waku_node] Stopping container with id a16f012526a1
2025-02-11 04:04:17.161 ERROR [src.node.docker_mananger] Max retries reached for container c899f10697bf. Exiting log stream.
2025-02-11 04:04:17.812 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:04:17.812 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:04:17.822 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:04:17.827 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
