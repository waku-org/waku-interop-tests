2025-02-11 04:03:50.242 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:03:50.243 DEBUG [tests.conftest] Running test: test_publish_after_node_pauses_and_pauses with id: 2025-02-11_04-03-50__7264d6b0-2443-4885-89bb-2615b805c705
2025-02-11 04:03:50.243 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:03:50.244 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 04:03:50.244 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 04:03:50.253 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:03:50.254 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_04-03-50__7264d6b0-2443-4885-89bb-2615b805c705__wakuorg_nwaku:latest.log
2025-02-11 04:03:50.254 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:03:50.254 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:03:50.256 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:03:50.256 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.232.96
2025-02-11 04:03:50.256 DEBUG [src.node.docker_mananger] Generated ports ['64804', '64805', '64806', '64807', '64808']
2025-02-11 04:03:50.257 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:03:50.257 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:03:50.257 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:03:50.257 DEBUG [src.node.docker_mananger] docker run -i -t -p 64804:64804 -p 64805:64805 -p 64806:64806 -p 64807:64807 -p 64808:64808 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=64806 --rest-port=64804 --tcp-port=64805 --discv5-udp-port=64807 --rest-address=0.0.0.0 --nat=extip:172.18.232.96 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1cc6c9ea44aaa7af2e0a3df187a9fa1eb3afc05bcac3fb3496bb857bddfefff0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=64808 --metrics-logging=true --relay=true
2025-02-11 04:03:50.477 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.232.96 waku 02bf96fc3422967fff414f91cb1f3b09cbe37f5878138eead3e4c7cd4431afbd
2025-02-11 04:03:50.526 DEBUG [src.node.docker_mananger] Container started with ID 02bf96fc3422. Setting up logs at ./log/docker/node1_2025-02-11_04-03-50__7264d6b0-2443-4885-89bb-2615b805c705__wakuorg_nwaku:latest.log
2025-02-11 04:03:50.527 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 64804
2025-02-11 04:03:50.527 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:03:51.073 ERROR [src.node.docker_mananger] Max retries reached for container abea06b9fca6. Exiting log stream.
2025-02-11 04:03:51.528 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64804/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:51.531 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:03:51.531 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:03:51.531 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64804/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:51.533 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.232.96/tcp/64805/p2p/16Uiu2HAm8UmmuHjUYMLTZrNYqTnpePt4HmtRmZhaoUCdopt2NUhp","/ip4/172.18.232.96/tcp/64806/ws/p2p/16Uiu2HAm8UmmuHjUYMLTZrNYqTnpePt4HmtRmZhaoUCdopt2NUhp"],"enrUri":"enr:-L24QJLbzaO4rstJBUNUIjGU-0YMpp1iT2Kh1Pr8oBfXvD3iEFxSo8G4DhVrlnSZLv1-Y3MGhxVuDd9Zugb-SW2hSJECgmlkgnY0gmlwhKwS6GCKbXVsdGlhZGRyc5YACASsEuhgBv0lAAoErBLoYAb9Jt0DgnJzhQADAQAAiXNlY3AyNTZrMaECwfM5kVyHw4XZoOEmSBdCQgnKM6SWG6peAzNhbzB1ZAODdGNwgv0lg3VkcIL9J4V3YWt1MgE"}'
2025-02-11 04:03:51.534 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:03:51.540 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:03:51.540 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_04-03-50__7264d6b0-2443-4885-89bb-2615b805c705__wakuorg_nwaku:latest.log
2025-02-11 04:03:51.540 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:03:51.540 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:03:51.541 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:03:51.541 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.169.63
2025-02-11 04:03:51.542 DEBUG [src.node.docker_mananger] Generated ports ['49874', '49875', '49876', '49877', '49878']
2025-02-11 04:03:51.542 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:03:51.542 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:03:51.542 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:03:51.542 DEBUG [src.node.docker_mananger] docker run -i -t -p 49874:49874 -p 49875:49875 -p 49876:49876 -p 49877:49877 -p 49878:49878 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49876 --rest-port=49874 --tcp-port=49875 --discv5-udp-port=49877 --rest-address=0.0.0.0 --nat=extip:172.18.169.63 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0ddaaaa1ce2fe26faa05dbb3dec5cbb1731e6079e9cfe6f98efdeabdcbcd6f76 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49878 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QJLbzaO4rstJBUNUIjGU-0YMpp1iT2Kh1Pr8oBfXvD3iEFxSo8G4DhVrlnSZLv1-Y3MGhxVuDd9Zugb-SW2hSJECgmlkgnY0gmlwhKwS6GCKbXVsdGlhZGRyc5YACASsEuhgBv0lAAoErBLoYAb9Jt0DgnJzhQADAQAAiXNlY3AyNTZrMaECwfM5kVyHw4XZoOEmSBdCQgnKM6SWG6peAzNhbzB1ZAODdGNwgv0lg3VkcIL9J4V3YWt1MgE
2025-02-11 04:03:51.773 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.169.63 waku f29b8651e16024d3f60c73d0203b3522560497890ff8c776bc468cacc4bdce57
2025-02-11 04:03:51.825 DEBUG [src.node.docker_mananger] Container started with ID f29b8651e160. Setting up logs at ./log/docker/node2_2025-02-11_04-03-50__7264d6b0-2443-4885-89bb-2615b805c705__wakuorg_nwaku:latest.log
2025-02-11 04:03:51.825 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 49874
2025-02-11 04:03:51.825 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:03:52.826 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49874/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:52.831 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:03:52.831 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:03:52.832 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49874/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:52.834 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.169.63/tcp/49875/p2p/16Uiu2HAm6WEbWREooBVEQoqg9SgzVJTwT6kaQbfxaF5SNcy7dqhR","/ip4/172.18.169.63/tcp/49876/ws/p2p/16Uiu2HAm6WEbWREooBVEQoqg9SgzVJTwT6kaQbfxaF5SNcy7dqhR"],"enrUri":"enr:-L24QKqysrsz65ow2mFzDmWju8tpBloeVfEegFtwx01fksyPYGl_cgKd5rc6Te0UO66wDICKP9qfKQuBhvSOOmsmcWECgmlkgnY0gmlwhKwSqT-KbXVsdGlhZGRyc5YACASsEqk_BsLTAAoErBKpPwbC1N0DgnJzhQADAQAAiXNlY3AyNTZrMaECpJvCGNyGg86S4mYMuSoc9vPYsGGr2w-zYxT8XM04nyiDdGNwgsLTg3VkcILC1YV3YWt1MgE"}'
2025-02-11 04:03:52.835 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:03:52.835 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:49874/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.232.96/tcp/64805/p2p/16Uiu2HAm8UmmuHjUYMLTZrNYqTnpePt4HmtRmZhaoUCdopt2NUhp"]'
2025-02-11 04:03:52.837 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:52.838 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 04:03:52.838 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:64804/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:03:52.842 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:52.842 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:49874/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:03:52.847 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:52.848 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:03:52.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:52.856 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:03:52.956 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:52.956 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:52.959 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246632848739840,"ephemeral":false}]'
2025-02-11 04:03:52.960 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:52.960 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49874/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:52.962 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246632848739840,"ephemeral":false}]'
2025-02-11 04:03:52.964 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 04:03:52.965 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:03:52.969 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:52.969 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:03:53.070 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:53.070 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:53.073 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246632964984320,"ephemeral":false}]'
2025-02-11 04:03:53.074 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:53.074 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49874/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:53.077 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246632964984320,"ephemeral":false}]'
2025-02-11 04:03:53.079 DEBUG [src.node.waku_node] Pausing container with id 02bf96fc3422
2025-02-11 04:03:53.088 DEBUG [src.node.waku_node] Unpause container with id 02bf96fc3422
2025-02-11 04:03:53.096 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTE=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:03:53.100 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:53.101 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:03:53.202 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:53.202 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:53.204 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246633096542976,"ephemeral":false}]'
2025-02-11 04:03:53.206 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:53.206 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49874/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:53.208 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246633096542976,"ephemeral":false}]'
2025-02-11 04:03:53.210 DEBUG [src.node.waku_node] Pausing container with id f29b8651e160
2025-02-11 04:03:53.218 DEBUG [src.node.waku_node] Unpause container with id f29b8651e160
2025-02-11 04:03:53.226 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTI=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:03:53.231 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:53.232 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:03:53.332 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:53.332 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64804/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:53.335 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246633226480896,"ephemeral":false}]'
2025-02-11 04:03:53.336 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:53.336 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49874/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:53.338 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246633226480896,"ephemeral":false}]'
2025-02-11 04:03:53.341 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:03:53.342 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:03:53.342 DEBUG [src.node.waku_node] Stopping container with id 02bf96fc3422
2025-02-11 04:03:53.994 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:03:53.994 DEBUG [src.node.waku_node] Stopping container with id f29b8651e160
2025-02-11 04:03:54.806 ERROR [src.node.docker_mananger] Max retries reached for container 02bf96fc3422. Exiting log stream.
2025-02-11 04:03:55.494 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:03:55.495 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:03:55.500 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:03:55.506 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
