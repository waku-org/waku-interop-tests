2025-02-11 04:03:29.214 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:03:29.214 DEBUG [tests.conftest] Running test: test_publish_with_valid_version with id: 2025-02-11_04-03-29__0a9c389e-f9ca-413c-a173-e1ded3009e77
2025-02-11 04:03:29.214 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:03:29.215 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 04:03:29.215 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 04:03:29.221 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:03:29.221 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_04-03-29__0a9c389e-f9ca-413c-a173-e1ded3009e77__wakuorg_nwaku:latest.log
2025-02-11 04:03:29.221 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:03:29.221 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:03:29.223 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:03:29.223 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.4.67
2025-02-11 04:03:29.223 DEBUG [src.node.docker_mananger] Generated ports ['11228', '11229', '11230', '11231', '11232']
2025-02-11 04:03:29.223 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:03:29.224 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:03:29.224 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:03:29.224 DEBUG [src.node.docker_mananger] docker run -i -t -p 11228:11228 -p 11229:11229 -p 11230:11230 -p 11231:11231 -p 11232:11232 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11230 --rest-port=11228 --tcp-port=11229 --discv5-udp-port=11231 --rest-address=0.0.0.0 --nat=extip:172.18.4.67 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e8f5df0dcce92e2bdc8dfafb2b4f9b2e78ffad70e93fe612e3a2dbcaafb2ebee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11232 --metrics-logging=true --relay=true
2025-02-11 04:03:29.451 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.4.67 waku 4d87d04cb107088d5de8271b3fd2610edaefe41705e49b5ba3d7e82d77a72293
2025-02-11 04:03:29.498 DEBUG [src.node.docker_mananger] Container started with ID 4d87d04cb107. Setting up logs at ./log/docker/node1_2025-02-11_04-03-29__0a9c389e-f9ca-413c-a173-e1ded3009e77__wakuorg_nwaku:latest.log
2025-02-11 04:03:29.500 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 11228
2025-02-11 04:03:29.500 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:03:29.987 ERROR [src.node.docker_mananger] Max retries reached for container 473abc7fe5d5. Exiting log stream.
2025-02-11 04:03:30.500 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11228/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:30.503 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:03:30.503 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:03:30.503 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11228/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:30.505 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.4.67/tcp/11229/p2p/16Uiu2HAkvQXKoVt5vXdfs8RkxqsiYKQoWnRhFkCvukXh5dWj4Ywo","/ip4/172.18.4.67/tcp/11230/ws/p2p/16Uiu2HAkvQXKoVt5vXdfs8RkxqsiYKQoWnRhFkCvukXh5dWj4Ywo"],"enrUri":"enr:-L24QGf_eX4INRBjIAKjFneFTM9yQ3A98C0nzuKMFzifSbquOPg7hNIlJU36muNKLLOIiME7Sn8MI9hUsBirTeuCOhoCgmlkgnY0gmlwhKwSBEOKbXVsdGlhZGRyc5YACASsEgRDBivdAAoErBIEQwYr3t0DgnJzhQADAQAAiXNlY3AyNTZrMaECDpBR4jRAi-l2v65-u2h-KIp6d9DtLTD-l7HyUX40JP6DdGNwgivdg3VkcIIr34V3YWt1MgE"}'
2025-02-11 04:03:30.506 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:03:30.512 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:03:30.512 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_04-03-29__0a9c389e-f9ca-413c-a173-e1ded3009e77__wakuorg_nwaku:latest.log
2025-02-11 04:03:30.512 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:03:30.512 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:03:30.514 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:03:30.514 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.188.52
2025-02-11 04:03:30.514 DEBUG [src.node.docker_mananger] Generated ports ['20387', '20388', '20389', '20390', '20391']
2025-02-11 04:03:30.514 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:03:30.514 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:03:30.514 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:03:30.514 DEBUG [src.node.docker_mananger] docker run -i -t -p 20387:20387 -p 20388:20388 -p 20389:20389 -p 20390:20390 -p 20391:20391 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20389 --rest-port=20387 --tcp-port=20388 --discv5-udp-port=20390 --rest-address=0.0.0.0 --nat=extip:172.18.188.52 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f9c6cc1cc3cf9da7049a27ffeea0ae5d59dbc8fbc593a2b6ea2be728fd23bf2e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20391 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QGf_eX4INRBjIAKjFneFTM9yQ3A98C0nzuKMFzifSbquOPg7hNIlJU36muNKLLOIiME7Sn8MI9hUsBirTeuCOhoCgmlkgnY0gmlwhKwSBEOKbXVsdGlhZGRyc5YACASsEgRDBivdAAoErBIEQwYr3t0DgnJzhQADAQAAiXNlY3AyNTZrMaECDpBR4jRAi-l2v65-u2h-KIp6d9DtLTD-l7HyUX40JP6DdGNwgivdg3VkcIIr34V3YWt1MgE
2025-02-11 04:03:30.745 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.188.52 waku 35de2a537cf9758b8ba3ee5699c9c9da381b47d6444560a3bf6cfa7ac84108b9
2025-02-11 04:03:30.789 DEBUG [src.node.docker_mananger] Container started with ID 35de2a537cf9. Setting up logs at ./log/docker/node2_2025-02-11_04-03-29__0a9c389e-f9ca-413c-a173-e1ded3009e77__wakuorg_nwaku:latest.log
2025-02-11 04:03:30.790 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20387
2025-02-11 04:03:30.791 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:03:31.791 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20387/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:31.801 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:03:31.802 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:03:31.803 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20387/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:31.806 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.188.52/tcp/20388/p2p/16Uiu2HAmBkKb6kAYWuJ4i76AZkMhyHoeLg7HZbJPcid4J12ryCxB","/ip4/172.18.188.52/tcp/20389/ws/p2p/16Uiu2HAmBkKb6kAYWuJ4i76AZkMhyHoeLg7HZbJPcid4J12ryCxB"],"enrUri":"enr:-L24QD4tlJr-htSFppYCSD-cFPJtuQIEgW3tTQHMy7V5gMnfQybfgJ6M9DeIGPckXODkzVX6_IBxpYwZa1N4SOh-oqsCgmlkgnY0gmlwhKwSvDSKbXVsdGlhZGRyc5YACASsErw0Bk-kAAoErBK8NAZPpd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC8oH4PwOrSbMQzNjhla3s1CudIZBBb0HaGXvxhtu3RPyDdGNwgk-kg3VkcIJPpoV3YWt1MgE"}'
2025-02-11 04:03:31.806 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:03:31.806 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20387/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.4.67/tcp/11229/p2p/16Uiu2HAkvQXKoVt5vXdfs8RkxqsiYKQoWnRhFkCvukXh5dWj4Ywo"]'
2025-02-11 04:03:31.809 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:31.810 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 04:03:31.810 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11228/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:03:31.813 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:31.814 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20387/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:03:31.819 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:31.820 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11228/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:03:31.826 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:31.826 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:03:31.926 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:31.926 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11228/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:31.929 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246611820655616,"ephemeral":false}]'
2025-02-11 04:03:31.930 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:31.931 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20387/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:31.933 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246611820655616,"ephemeral":false}]'
2025-02-11 04:03:31.934 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 04:03:31.935 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11228/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
2025-02-11 04:03:31.940 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:31.940 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:03:32.041 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:32.041 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11228/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:32.043 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1739246611935690240,"ephemeral":false}]'
2025-02-11 04:03:32.044 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:32.045 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20387/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:32.047 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1739246611935690240,"ephemeral":false}]'
2025-02-11 04:03:32.050 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:03:32.051 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:03:32.051 DEBUG [src.node.waku_node] Stopping container with id 4d87d04cb107
2025-02-11 04:03:32.982 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:03:32.982 DEBUG [src.node.waku_node] Stopping container with id 35de2a537cf9
2025-02-11 04:03:33.794 ERROR [src.node.docker_mananger] Max retries reached for container 4d87d04cb107. Exiting log stream.
2025-02-11 04:03:34.493 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:03:34.494 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:03:34.500 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:03:34.505 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
