2025-02-11 04:03:48.223 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 04:03:48.223 DEBUG [tests.conftest] Running test: test_publish_with_invalid_version with id: 2025-02-11_04-03-48__32b1e5cf-8642-4c5e-b32d-41226b90ed7e
2025-02-11 04:03:48.223 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 04:03:48.224 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 04:03:48.224 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 04:03:48.232 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:03:48.232 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_04-03-48__32b1e5cf-8642-4c5e-b32d-41226b90ed7e__wakuorg_nwaku:latest.log
2025-02-11 04:03:48.232 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:03:48.233 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:03:48.234 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:03:48.234 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.235.42
2025-02-11 04:03:48.234 DEBUG [src.node.docker_mananger] Generated ports ['42068', '42069', '42070', '42071', '42072']
2025-02-11 04:03:48.235 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:03:48.235 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:03:48.235 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:03:48.235 DEBUG [src.node.docker_mananger] docker run -i -t -p 42068:42068 -p 42069:42069 -p 42070:42070 -p 42071:42071 -p 42072:42072 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42070 --rest-port=42068 --tcp-port=42069 --discv5-udp-port=42071 --rest-address=0.0.0.0 --nat=extip:172.18.235.42 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5bea841bc6c6f1c571f4f48bc345b3aceabcbd52c2e2fd8b617b02d60d2cb7ea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42072 --metrics-logging=true --relay=true
2025-02-11 04:03:48.492 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.235.42 waku b64e08d91e574a2661ae76eb6122bc4026144ebe027f0c7168ff3b6e4536be22
2025-02-11 04:03:48.550 DEBUG [src.node.docker_mananger] Container started with ID b64e08d91e57. Setting up logs at ./log/docker/node1_2025-02-11_04-03-48__32b1e5cf-8642-4c5e-b32d-41226b90ed7e__wakuorg_nwaku:latest.log
2025-02-11 04:03:48.551 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42068
2025-02-11 04:03:48.552 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:03:49.013 ERROR [src.node.docker_mananger] Max retries reached for container 6f97f2f59b0f. Exiting log stream.
2025-02-11 04:03:49.553 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42068/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:49.556 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:03:49.557 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:03:49.557 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42068/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:49.559 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.42/tcp/42069/p2p/16Uiu2HAmNtLNZJLX3ZTzJuBXXzPzFBrYepsfGAfUfgDvqu9agXT1","/ip4/172.18.235.42/tcp/42070/ws/p2p/16Uiu2HAmNtLNZJLX3ZTzJuBXXzPzFBrYepsfGAfUfgDvqu9agXT1"],"enrUri":"enr:-L24QNAvfkkf3yELUyt4EsC3zkD6w2v5l_0-Hq0GU-JKjLQyLBKEY_unTMCC_5FJZn9jpx_pWM4ankmttK_NN8azQJ4CgmlkgnY0gmlwhKwS6yqKbXVsdGlhZGRyc5YACASsEusqBqRVAAoErBLrKgakVt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDmAAO_mpG20miTt4yOjHVo5liSMNUDYRz1Pnl11VEjkSDdGNwgqRVg3VkcIKkV4V3YWt1MgE"}'
2025-02-11 04:03:49.560 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:03:49.567 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 04:03:49.567 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_04-03-48__32b1e5cf-8642-4c5e-b32d-41226b90ed7e__wakuorg_nwaku:latest.log
2025-02-11 04:03:49.567 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 04:03:49.568 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 04:03:49.569 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 04:03:49.569 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.17.88
2025-02-11 04:03:49.570 DEBUG [src.node.docker_mananger] Generated ports ['39904', '39905', '39906', '39907', '39908']
2025-02-11 04:03:49.570 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 04:03:49.570 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 04:03:49.570 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 04:03:49.570 DEBUG [src.node.docker_mananger] docker run -i -t -p 39904:39904 -p 39905:39905 -p 39906:39906 -p 39907:39907 -p 39908:39908 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39906 --rest-port=39904 --tcp-port=39905 --discv5-udp-port=39907 --rest-address=0.0.0.0 --nat=extip:172.18.17.88 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2132af503b8bec4bea29c379fe622d311cd95de71df3b1f0658dea12dfecced5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39908 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QNAvfkkf3yELUyt4EsC3zkD6w2v5l_0-Hq0GU-JKjLQyLBKEY_unTMCC_5FJZn9jpx_pWM4ankmttK_NN8azQJ4CgmlkgnY0gmlwhKwS6yqKbXVsdGlhZGRyc5YACASsEusqBqRVAAoErBLrKgakVt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDmAAO_mpG20miTt4yOjHVo5liSMNUDYRz1Pnl11VEjkSDdGNwgqRVg3VkcIKkV4V3YWt1MgE
2025-02-11 04:03:49.818 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.17.88 waku 0ca8ba29ab301f567af86a0a4afc17d5b36684f664ff1b77af8de3f2937d9fdd
2025-02-11 04:03:49.868 DEBUG [src.node.docker_mananger] Container started with ID 0ca8ba29ab30. Setting up logs at ./log/docker/node2_2025-02-11_04-03-48__32b1e5cf-8642-4c5e-b32d-41226b90ed7e__wakuorg_nwaku:latest.log
2025-02-11 04:03:49.869 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39904
2025-02-11 04:03:49.870 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 04:03:50.870 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39904/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:50.880 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 04:03:50.881 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 04:03:50.881 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39904/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:50.884 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.17.88/tcp/39905/p2p/16Uiu2HAkvJx5SWzpVkdPucwGxJCXYJrrvMuRdvrHh8pmEHD5FVGC","/ip4/172.18.17.88/tcp/39906/ws/p2p/16Uiu2HAkvJx5SWzpVkdPucwGxJCXYJrrvMuRdvrHh8pmEHD5FVGC"],"enrUri":"enr:-L24QIwxq0bJUIOpLFrTGkWZL_THL9oNTSMXhsEnAcFJXjvAbNyiyGfh-eMSrpA0ctvoUZDQfPCVXaBYlW1y4hjIiXMCgmlkgnY0gmlwhKwSEViKbXVsdGlhZGRyc5YACASsEhFYBpvhAAoErBIRWAab4t0DgnJzhQADAQAAiXNlY3AyNTZrMaECDSLSlsSX0TnS_HiLZl2O1ILlo-LgpDf8hDk6B5hDE9GDdGNwgpvhg3VkcIKb44V3YWt1MgE"}'
2025-02-11 04:03:50.884 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 04:03:50.884 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39904/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.235.42/tcp/42069/p2p/16Uiu2HAmNtLNZJLX3ZTzJuBXXzPzFBrYepsfGAfUfgDvqu9agXT1"]'
2025-02-11 04:03:50.887 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:50.888 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 04:03:50.888 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42068/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:03:50.892 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:50.892 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39904/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 04:03:50.898 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:50.900 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42068/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 04:03:50.905 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 04:03:50.906 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 04:03:51.006 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:51.007 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42068/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:51.010 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246630899890176,"ephemeral":false}]'
2025-02-11 04:03:51.012 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-11 04:03:51.013 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 04:03:51.015 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739246630899890176,"ephemeral":false}]'
2025-02-11 04:03:51.017 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 04:03:51.018 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42068/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 2.1}'
2025-02-11 04:03:51.021 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:42068/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 04:03:51.023 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 04:03:51.025 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 04:03:51.025 DEBUG [src.node.waku_node] Stopping container with id b64e08d91e57
2025-02-11 04:03:52.059 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:03:52.059 DEBUG [src.node.waku_node] Stopping container with id 0ca8ba29ab30
2025-02-11 04:03:52.874 ERROR [src.node.docker_mananger] Max retries reached for container b64e08d91e57. Exiting log stream.
2025-02-11 04:03:53.595 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 04:03:53.599 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 04:03:53.603 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 04:03:53.610 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
