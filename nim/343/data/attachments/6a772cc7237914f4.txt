[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publishing_node_restarts with id: 2024-09-03_04-35-12__5d07749a-b8c3-489a-b70b-848f88d4a73b
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:28 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:36 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-09-03_04-35-12__5d07749a-b8c3-489a-b70b-848f88d4a73b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.41.223
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['44740', '44741', '44742', '44743', '44744']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 44740:44740 -p 44741:44741 -p 44742:44742 -p 44743:44743 -p 44744:44744 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44742 --rest-port=44740 --tcp-port=44741 --discv5-udp-port=44743 --rest-address=0.0.0.0 --nat=extip:172.18.41.223 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a26faa017baab77ac8deada2a389e6d0b17a64fb075bf60bdd6f83a44ef3025a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44744 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.41.223 waku 6125606e7e3d620964c78b214b175ca811820e7c83ff2d04b2f66e54c87513b4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 6125606e7e3d. Setting up logs at ./log/docker/publishing_node1_2024-09-03_04-35-12__5d07749a-b8c3-489a-b70b-848f88d4a73b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 44740
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.41.223/tcp/44741/p2p/16Uiu2HAmBBbstWmLrsgdGmMBVGutn5X27fRAtt5VSfN1qvSbiWQ9","/ip4/172.18.41.223/tcp/44742/ws/p2p/16Uiu2HAmBBbstWmLrsgdGmMBVGutn5X27fRAtt5VSfN1qvSbiWQ9"],"enrUri":"enr:-LO4QB8GhjHEGBlSxB--v8cnTzszEbhONt4lhw3IaJ8aHG1yTmPaaVu50-aQasXWu7V2WujHfuUOA7WNtPHafTDopb8BgmlkgnY0gmlwhKwSKd-KbXVsdGlhZGRyc4wACgSsEinfBq7G3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLqIDi47WRoQBvmwmR4Ujws6rHX84ejtSON7dkYOPdwuoN0Y3CCrsWDdWRwgq7HhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-09-03_04-35-12__5d07749a-b8c3-489a-b70b-848f88d4a73b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.94.211
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['63829', '63830', '63831', '63832', '63833']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 63829:63829 -p 63830:63830 -p 63831:63831 -p 63832:63832 -p 63833:63833 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63831 --rest-port=63829 --tcp-port=63830 --discv5-udp-port=63832 --rest-address=0.0.0.0 --nat=extip:172.18.94.211 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5cfabe3eeba45ac187fc23e8aee123efe1a2a5682ee7c4e037d8d6dece214b69 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63833 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QB8GhjHEGBlSxB--v8cnTzszEbhONt4lhw3IaJ8aHG1yTmPaaVu50-aQasXWu7V2WujHfuUOA7WNtPHafTDopb8BgmlkgnY0gmlwhKwSKd-KbXVsdGlhZGRyc4wACgSsEinfBq7G3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLqIDi47WRoQBvmwmR4Ujws6rHX84ejtSON7dkYOPdwuoN0Y3CCrsWDdWRwgq7HhXdha3UyAw --storenode=/ip4/172.18.41.223/tcp/44741/p2p/16Uiu2HAmBBbstWmLrsgdGmMBVGutn5X27fRAtt5VSfN1qvSbiWQ9 --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.94.211 waku 76ae052b50e6ff05a469cc3c668595f99996a1316bac1cc2aa8a5fda54b9d6dc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 76ae052b50e6. Setting up logs at ./log/docker/store_node1_2024-09-03_04-35-12__5d07749a-b8c3-489a-b70b-848f88d4a73b__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 63829
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63829/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63829/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.94.211/tcp/63830/p2p/16Uiu2HAmFxyE1oqC8FR1kcKgYZfV19FDXxeA1WLVYh7b8puwEVLK","/ip4/172.18.94.211/tcp/63831/ws/p2p/16Uiu2HAmFxyE1oqC8FR1kcKgYZfV19FDXxeA1WLVYh7b8puwEVLK"],"enrUri":"enr:-LO4QHBgsm8CaR9onR4gYmteq8N47AJj0ls6qnog0hSAAs9iJEZ8qv1d8rSN_R7I7XdQn_SPim7lxGSI-yUyBH1LpFUBgmlkgnY0gmlwhKwSXtOKbXVsdGlhZGRyc4wACgSsEl7TBvlX3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMxLj4o2OyVcgxpmRyIYzZgB08opF3r7v7EzJj-5PHTeIN0Y3CC-VaDdWRwgvlYhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63829/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.41.223/tcp/44741/p2p/16Uiu2HAmBBbstWmLrsgdGmMBVGutn5X27fRAtt5VSfN1qvSbiWQ9"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44740/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63829/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:129 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44740/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:217 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"+kwnM+PfNwo9+cyfQRwByIKCQ4vx1Kc3ROg0Np7VfSU="}]}'
[35mDEBUG   [0m src.steps.store:store.py:217 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63829/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"+kwnM+PfNwo9+cyfQRwByIKCQ4vx1Kc3ROg0Np7VfSU="}]}'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:244 Restarting container with id 6125606e7e3d
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.41.223/tcp/44741/p2p/16Uiu2HAmBBbstWmLrsgdGmMBVGutn5X27fRAtt5VSfN1qvSbiWQ9","/ip4/172.18.41.223/tcp/44742/ws/p2p/16Uiu2HAmBBbstWmLrsgdGmMBVGutn5X27fRAtt5VSfN1qvSbiWQ9"],"enrUri":"enr:-LO4QB8GhjHEGBlSxB--v8cnTzszEbhONt4lhw3IaJ8aHG1yTmPaaVu50-aQasXWu7V2WujHfuUOA7WNtPHafTDopb8BgmlkgnY0gmlwhKwSKd-KbXVsdGlhZGRyc4wACgSsEinfBq7G3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLqIDi47WRoQBvmwmR4Ujws6rHX84ejtSON7dkYOPdwuoN0Y3CCrsWDdWRwgq7HhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63829/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.41.223/tcp/44741/p2p/16Uiu2HAmBBbstWmLrsgdGmMBVGutn5X27fRAtt5VSfN1qvSbiWQ9"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44740/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:129 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44740/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:217 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"+kwnM+PfNwo9+cyfQRwByIKCQ4vx1Kc3ROg0Np7VfSU="},{"messageHash":"PsIg7KjHLnbnZvs1SG5aqZoPkixh5KA8M2UIFTaOl7w="}]}'
[35mDEBUG   [0m src.steps.store:store.py:217 Checking that peer wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63829/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"+kwnM+PfNwo9+cyfQRwByIKCQ4vx1Kc3ROg0Np7VfSU="},{"messageHash":"PsIg7KjHLnbnZvs1SG5aqZoPkixh5KA8M2UIFTaOl7w="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44740/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"+kwnM+PfNwo9+cyfQRwByIKCQ4vx1Kc3ROg0Np7VfSU="},{"messageHash":"PsIg7KjHLnbnZvs1SG5aqZoPkixh5KA8M2UIFTaOl7w="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63829/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"+kwnM+PfNwo9+cyfQRwByIKCQ4vx1Kc3ROg0Np7VfSU="},{"messageHash":"PsIg7KjHLnbnZvs1SG5aqZoPkixh5KA8M2UIFTaOl7w="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 6125606e7e3d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 76ae052b50e6
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.