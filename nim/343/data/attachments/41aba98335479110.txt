[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_single_pubsub_topic[/waku/2/rs/2/1] with id: 2024-09-03_04-29-33__0c83913e-0576-44cf-b372-b209138fef01
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-03_04-29-33__0c83913e-0576-44cf-b372-b209138fef01__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.59.211
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['44973', '44974', '44975', '44976', '44977']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 44973:44973 -p 44974:44974 -p 44975:44975 -p 44976:44976 -p 44977:44977 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44975 --rest-port=44973 --tcp-port=44974 --discv5-udp-port=44976 --rest-address=0.0.0.0 --nat=extip:172.18.59.211 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ba9d391df545bba4f7fd80b6cd229c9b7e6bfabdeb44e38da2ecd4392b5010d4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44977 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.59.211 waku 4056e9140ee916038eb9ecc4a8bf4d6270f60a54b1620f710a08843071fbd6a7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 4056e9140ee9. Setting up logs at ./log/docker/node1_2024-09-03_04-29-33__0c83913e-0576-44cf-b372-b209138fef01__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 44973
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44973/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44973/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.59.211/tcp/44974/p2p/16Uiu2HAmD2qWS7a7YiWTtLnZp5APq6fMLhzpJFUJgvpyNtbxFN3q","/ip4/172.18.59.211/tcp/44975/ws/p2p/16Uiu2HAmD2qWS7a7YiWTtLnZp5APq6fMLhzpJFUJgvpyNtbxFN3q"],"enrUri":"enr:-LO4QKJuinVRW09IvXyfom3I1uWTqcJmhIA0g6ErUw6p5YCONP2dGK8w4IceTtpLS5wxwHKt4kWL1Aer28mgINFioPwBgmlkgnY0gmlwhKwSO9OKbXVsdGlhZGRyc4wACgSsEjvTBq-v3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQMFmMecMaDMiE-J-ZQtTJUGTSMUIPelPxf9KNaGa-VFuIN0Y3CCr66DdWRwgq-whXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-03_04-29-33__0c83913e-0576-44cf-b372-b209138fef01__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.104.59
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['7805', '7806', '7807', '7808', '7809']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 7805:7805 -p 7806:7806 -p 7807:7807 -p 7808:7808 -p 7809:7809 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7807 --rest-port=7805 --tcp-port=7806 --discv5-udp-port=7808 --rest-address=0.0.0.0 --nat=extip:172.18.104.59 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a7b44012abaa8d33473f8d77287edafa10ab4df9c1bc1fedc417ecbab0f3cdc3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7809 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QKJuinVRW09IvXyfom3I1uWTqcJmhIA0g6ErUw6p5YCONP2dGK8w4IceTtpLS5wxwHKt4kWL1Aer28mgINFioPwBgmlkgnY0gmlwhKwSO9OKbXVsdGlhZGRyc4wACgSsEjvTBq-v3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQMFmMecMaDMiE-J-ZQtTJUGTSMUIPelPxf9KNaGa-VFuIN0Y3CCr66DdWRwgq-whXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.104.59 waku 2d485db7b944726b05133bf45fe189f4d648e2f88c17bc196843bc0a7a830719
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 2d485db7b944. Setting up logs at ./log/docker/node2_2024-09-03_04-29-33__0c83913e-0576-44cf-b372-b209138fef01__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 7805
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7805/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7805/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.104.59/tcp/7806/p2p/16Uiu2HAm6dtkgg7hvgDEN6K5avXgTJwL87mh7J9TN5xgHGKC9aKC","/ip4/172.18.104.59/tcp/7807/ws/p2p/16Uiu2HAm6dtkgg7hvgDEN6K5avXgTJwL87mh7J9TN5xgHGKC9aKC"],"enrUri":"enr:-LO4QMa3_dW6cXYlsR9dpKeRKXlcvWvQB1UdNHv7QK1dA5QnRgLFY4u06YCAv8sZ4bdNqvlXi7ry31fn2Z8TGFtRPHUBgmlkgnY0gmlwhKwSaDuKbXVsdGlhZGRyc4wACgSsEmg7Bh5_3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQKmkfgwvnUfQHSqntwg-LHQyy9hLnRSunLjtQCJQG0Ws4N0Y3CCHn6DdWRwgh6AhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7805/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.59.211/tcp/44974/p2p/16Uiu2HAmD2qWS7a7YiWTtLnZp5APq6fMLhzpJFUJgvpyNtbxFN3q"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44973/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7805/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44973/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44973/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725337777005140736,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7805/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725337777005140736,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 4056e9140ee9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 2d485db7b944
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.