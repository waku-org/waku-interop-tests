[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_filter_get with id: 2024-12-20_04-13-26__efb0b3ec-2e5b-4884-a195-fb8e6c73b1fb
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-20_04-13-26__efb0b3ec-2e5b-4884-a195-fb8e6c73b1fb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.205.205
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['22267', '22268', '22269', '22270', '22271']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 22267:22267 -p 22268:22268 -p 22269:22269 -p 22270:22270 -p 22271:22271 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22269 --rest-port=22267 --tcp-port=22268 --discv5-udp-port=22270 --rest-address=0.0.0.0 --nat=extip:172.18.205.205 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c71b2bb3d60a7ba0dd105b0be86ed9a214565fa101cacf5d7953f1bd6b5165ca --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22271 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.205.205 waku 55d447031cb41ea2204b0fc0bcc64eebe0682e674817be2222664577ba9c76f7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 55d447031cb4. Setting up logs at ./log/docker/node1_2024-12-20_04-13-26__efb0b3ec-2e5b-4884-a195-fb8e6c73b1fb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 22267
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c466eec494ab. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22267/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22267/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.205.205/tcp/22268/p2p/16Uiu2HAm33WxbNYnj7Ywe5DUDWzJ4HS8riffwpgbuJWNVuPhBrSp","/ip4/172.18.205.205/tcp/22269/ws/p2p/16Uiu2HAm33WxbNYnj7Ywe5DUDWzJ4HS8riffwpgbuJWNVuPhBrSp"],"enrUri":"enr:-L24QHSD_f-GFMEwVUI4McvgxNbN7EAcEuoDjoGss9W6el2jJcHDNh-Q4czPnMgV9P6DHu0OnhSTUFvKPc7ic4JHc0wCgmlkgnY0gmlwhKwSzc2KbXVsdGlhZGRyc5YACASsEs3NBlb8AAoErBLNzQZW_d0DgnJzhQADAQAAiXNlY3AyNTZrMaECcTCEk_1C22W-PhuZzwH8gsi1IcDs8mWO7RsUoiPhq42DdGNwglb8g3VkcIJW_oV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-20_04-13-26__efb0b3ec-2e5b-4884-a195-fb8e6c73b1fb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.201.174
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59742', '59743', '59744', '59745', '59746']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59742:59742 -p 59743:59743 -p 59744:59744 -p 59745:59745 -p 59746:59746 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59744 --rest-port=59742 --tcp-port=59743 --discv5-udp-port=59745 --rest-address=0.0.0.0 --nat=extip:172.18.201.174 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aaa05a3cdc5cba14e513e5a2c6ae1f19156d4b334a2c8bfd28dfc6bea8861ddd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59746 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QHSD_f-GFMEwVUI4McvgxNbN7EAcEuoDjoGss9W6el2jJcHDNh-Q4czPnMgV9P6DHu0OnhSTUFvKPc7ic4JHc0wCgmlkgnY0gmlwhKwSzc2KbXVsdGlhZGRyc5YACASsEs3NBlb8AAoErBLNzQZW_d0DgnJzhQADAQAAiXNlY3AyNTZrMaECcTCEk_1C22W-PhuZzwH8gsi1IcDs8mWO7RsUoiPhq42DdGNwglb8g3VkcIJW_oV3YWt1MgU --filternode=/ip4/172.18.205.205/tcp/22268/p2p/16Uiu2HAm33WxbNYnj7Ywe5DUDWzJ4HS8riffwpgbuJWNVuPhBrSp
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.201.174 waku 9e6fd4cc08f632ada0f3e1ff8b89cc48fbe65b0b004c76fec779ec6c41417675
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9e6fd4cc08f6. Setting up logs at ./log/docker/node2_2024-12-20_04-13-26__efb0b3ec-2e5b-4884-a195-fb8e6c73b1fb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 59742
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59742/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59742/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.201.174/tcp/59743/p2p/16Uiu2HAmCFJbMfeoytszDp7aCKjNhDhWjHTBQmpXQ7D8oEqKL42P","/ip4/172.18.201.174/tcp/59744/ws/p2p/16Uiu2HAmCFJbMfeoytszDp7aCKjNhDhWjHTBQmpXQ7D8oEqKL42P"],"enrUri":"enr:-L24QGrnJBzkQKURRQ6nzzMvRffOVovqPte6uvCqYHPP70I3Lms64ifhvbQt5GL28XE0_I8z5pAbUEa90jVIE1K5wvcCgmlkgnY0gmlwhKwSya6KbXVsdGlhZGRyc5YACASsEsmuBulfAAoErBLJrgbpYN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-e6v_yFE-jC4y-iaXMK5RxQ6ZZe6QEi9qGKogyK-1RSDdGNwgulfg3VkcILpYYV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59742/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.205.205/tcp/22268/p2p/16Uiu2HAm33WxbNYnj7Ywe5DUDWzJ4HS8riffwpgbuJWNVuPhBrSp"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22267/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59742/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "5cb1a508-eba6-4a3d-a4a3-8b93c3115d55", "contentFilters": ["/test/1/waku-relay/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"5cb1a508-eba6-4a3d-a4a3-8b93c3115d55","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22267/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59742/filter/v2/messages/%2Ftest%2F1%2Fwaku-relay%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1734668009066244096,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_filter_requests{type="SUBSCRIBE"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_filter_requests{type="SUBSCRIBE"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/filter-subscribe/2.0.0-beta1",peerId="/ip4/172.18.205.205/tcp/22268"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/filter-subscribe/2.0.0-beta1",peerId="/ip4/172.18.205.205/tcp/22268"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_total_dial_attempts_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_total_dial_attempts_total with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 55d447031cb4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 9e6fd4cc08f6
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 55d447031cb4. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.