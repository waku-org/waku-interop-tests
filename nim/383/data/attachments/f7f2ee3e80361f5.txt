[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-10-06_04-20-23__423a1a37-d84a-445f-a6b6-fff2fee5dd74
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-06_04-20-23__423a1a37-d84a-445f-a6b6-fff2fee5dd74__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.194.90
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['38812', '38813', '38814', '38815', '38816']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 38812:38812 -p 38813:38813 -p 38814:38814 -p 38815:38815 -p 38816:38816 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38814 --rest-port=38812 --tcp-port=38813 --discv5-udp-port=38815 --rest-address=0.0.0.0 --nat=extip:172.18.194.90 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fab43db239debb06cbf6fa4bde0b6bed6ab5bc13a7bdccceec7cfe54461ee2a6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38816 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.194.90 waku 718c6843a2d1fee8da2b6fdcb99422b24e585304fa6107e1df85958efa9c04dc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 718c6843a2d1. Setting up logs at ./log/docker/receiving_node1_2024-10-06_04-20-23__423a1a37-d84a-445f-a6b6-fff2fee5dd74__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 38812
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38812/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38812/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.194.90/tcp/38813/p2p/16Uiu2HAkyZbTchEL5iK4Gn97eozMPRc6cYuu51FkMR3a5ncWtkwk","/ip4/172.18.194.90/tcp/38814/ws/p2p/16Uiu2HAkyZbTchEL5iK4Gn97eozMPRc6cYuu51FkMR3a5ncWtkwk"],"enrUri":"enr:-LO4QP9zf0H_N31pL_e-ny_Oe8_07bTNAddFV9v09MK2aV-qB_jSFZqWjtG5fh3K4gW9aoTNlzX4BdSARU69QuPPyrUBgmlkgnY0gmlwhKwSwlqKbXVsdGlhZGRyc4wACgSsEsJaBpee3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI9dkh2qIo2IPtFo8EIUQ2wOGYJwOVrwHK3vEqKP-wPW4N0Y3CCl52DdWRwgpefhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-06_04-20-23__423a1a37-d84a-445f-a6b6-fff2fee5dd74__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.200.206
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['42924', '42925', '42926', '42927', '42928']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 42924:42924 -p 42925:42925 -p 42926:42926 -p 42927:42927 -p 42928:42928 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42926 --rest-port=42924 --tcp-port=42925 --discv5-udp-port=42927 --rest-address=0.0.0.0 --nat=extip:172.18.200.206 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5d8ea760cdaeb82dad768448bcc0246980444aa7c4d9fdbc8aa055be5668daa3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42928 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.200.206 waku 7c40fab22ea36cb2958bf3d4b9d8a75d5ddf02ecc81f0b95da49a9a5eb6a5316
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7c40fab22ea3. Setting up logs at ./log/docker/receiving_node2_2024-10-06_04-20-23__423a1a37-d84a-445f-a6b6-fff2fee5dd74__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 42924
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42924/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:42924/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.200.206/tcp/42925/p2p/16Uiu2HAmRSgSjF6gR2uhybzFaVWDtuUaFqv7bMssvKweJ7n1o4e2","/ip4/172.18.200.206/tcp/42926/ws/p2p/16Uiu2HAmRSgSjF6gR2uhybzFaVWDtuUaFqv7bMssvKweJ7n1o4e2"],"enrUri":"enr:-LO4QISaKZIN9ToQzFpE4fBu8TanZ0cG0fSnO64zNUV6cZGQdUnHvOGpE6oKXu07BqILw-FY3SyYXC62QWWq8Zn29CYBgmlkgnY0gmlwhKwSyM6KbXVsdGlhZGRyc4wACgSsEsjOBqeu3QOCcnOFAAMBAACJc2VjcDI1NmsxoQO-ALa1fD-dFMYprnmZF9wi5ck_JeieYBRVbM6ozQX5H4N0Y3CCp62DdWRwgqevhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42924/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.194.90/tcp/38813/p2p/16Uiu2HAkyZbTchEL5iK4Gn97eozMPRc6cYuu51FkMR3a5ncWtkwk"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-06_04-20-23__423a1a37-d84a-445f-a6b6-fff2fee5dd74__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.203.25
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['61609', '61610', '61611', '61612', '61613']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 61609:61609 -p 61610:61610 -p 61611:61611 -p 61612:61612 -p 61613:61613 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61611 --rest-port=61609 --tcp-port=61610 --discv5-udp-port=61612 --rest-address=0.0.0.0 --nat=extip:172.18.203.25 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c22e921235e9fdd02de7bbd09be6c2eed6142d6f0c19ffaece948ddb29f446aa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61613 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QP9zf0H_N31pL_e-ny_Oe8_07bTNAddFV9v09MK2aV-qB_jSFZqWjtG5fh3K4gW9aoTNlzX4BdSARU69QuPPyrUBgmlkgnY0gmlwhKwSwlqKbXVsdGlhZGRyc4wACgSsEsJaBpee3QOCcnOFAAMBAACJc2VjcDI1NmsxoQI9dkh2qIo2IPtFo8EIUQ2wOGYJwOVrwHK3vEqKP-wPW4N0Y3CCl52DdWRwgpefhXdha3UyCQ --lightpushnode=/ip4/172.18.194.90/tcp/38813/p2p/16Uiu2HAkyZbTchEL5iK4Gn97eozMPRc6cYuu51FkMR3a5ncWtkwk --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.203.25 waku 9facca8204fd1fe1606882fcba564a482eaa79588bc07cffece66f007209e8cf
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9facca8204fd. Setting up logs at ./log/docker/lightpush_node1_2024-10-06_04-20-23__423a1a37-d84a-445f-a6b6-fff2fee5dd74__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 61609
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61609/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61609/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.203.25/tcp/61610/p2p/16Uiu2HAmVh7ZW74snxxR2n4yneQzG6yL5VeXggYC4mpKSfkj4Jq2","/ip4/172.18.203.25/tcp/61611/ws/p2p/16Uiu2HAmVh7ZW74snxxR2n4yneQzG6yL5VeXggYC4mpKSfkj4Jq2"],"enrUri":"enr:-LO4QDvnX6rdpoBR226zyJkHkGxjH8APzrJw2ZOzUQskIK0VSVYBomZzj50GiGINT7WRPzFR_QQB4bqnnWMl8omcSuYBgmlkgnY0gmlwhKwSyxmKbXVsdGlhZGRyc4wACgSsEssZBvCr3QOCcnOFAAMBAACJc2VjcDI1NmsxoQP9If4McyEPGLHpZigMR3jkVjxvyUQGpELPaEyeKN9DPYN0Y3CC8KqDdWRwgvCshXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61609/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.194.90/tcp/38813/p2p/16Uiu2HAkyZbTchEL5iK4Gn97eozMPRc6cYuu51FkMR3a5ncWtkwk"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61609/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.200.206/tcp/42925/p2p/16Uiu2HAmRSgSjF6gR2uhybzFaVWDtuUaFqv7bMssvKweJ7n1o4e2"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38812/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:42924/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61609/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1728188427920047616}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38812/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1728188427920047616,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.194.90/tcp/38813"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.194.90/tcp/38813"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 718c6843a2d1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7c40fab22ea3
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9facca8204fd
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.