[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_subscribe_refresh with id: 2024-10-06_04-16-11__cdec0f09-5786-4109-baae-c51c9b455462
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-06_04-16-11__cdec0f09-5786-4109-baae-c51c9b455462__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.189.36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['44271', '44272', '44273', '44274', '44275']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 44271:44271 -p 44272:44272 -p 44273:44273 -p 44274:44274 -p 44275:44275 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44273 --rest-port=44271 --tcp-port=44272 --discv5-udp-port=44274 --rest-address=0.0.0.0 --nat=extip:172.18.189.36 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9f2c1f7e3607dcbbcd5b46f56e5b4fb88e4e8a2c167ccebceba1dcbe9e73ee3e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44275 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.189.36 waku 2d63bed5945bc14995d5920f9ea2e3f75ca47b5ebd865438c910134f416f9d01
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 2d63bed5945b. Setting up logs at ./log/docker/node1_2024-10-06_04-16-11__cdec0f09-5786-4109-baae-c51c9b455462__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 44271
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44271/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44271/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.189.36/tcp/44272/p2p/16Uiu2HAmTBgWjAsrKZNP1SnGumqphLwpN9XBtparQoyhyxchKL6a","/ip4/172.18.189.36/tcp/44273/ws/p2p/16Uiu2HAmTBgWjAsrKZNP1SnGumqphLwpN9XBtparQoyhyxchKL6a"],"enrUri":"enr:-LO4QCHRKhd-L89Pr1udbdwodbLo7eCdwwmgEv3JXGnPrcGhSx6PfRL4QHiZLWtDYq-gTc6YiHYr7MwMlMqi06sTbPwBgmlkgnY0gmlwhKwSvSSKbXVsdGlhZGRyc4wACgSsEr0kBqzx3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPX4HQQm7g48doHh3sNF9oIdZk30wKg0ejED_PVtzBM34N0Y3CCrPCDdWRwgqzyhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-06_04-16-11__cdec0f09-5786-4109-baae-c51c9b455462__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.207.73
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['5157', '5158', '5159', '5160', '5161']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 5157:5157 -p 5158:5158 -p 5159:5159 -p 5160:5160 -p 5161:5161 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5159 --rest-port=5157 --tcp-port=5158 --discv5-udp-port=5160 --rest-address=0.0.0.0 --nat=extip:172.18.207.73 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=88fd574bd78cce2ba0c65f5bdafcf9e29fdd8baf0eb5dc31a131d7ca6d78a13e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5161 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QCHRKhd-L89Pr1udbdwodbLo7eCdwwmgEv3JXGnPrcGhSx6PfRL4QHiZLWtDYq-gTc6YiHYr7MwMlMqi06sTbPwBgmlkgnY0gmlwhKwSvSSKbXVsdGlhZGRyc4wACgSsEr0kBqzx3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPX4HQQm7g48doHh3sNF9oIdZk30wKg0ejED_PVtzBM34N0Y3CCrPCDdWRwgqzyhXdha3UyBQ --filternode=/ip4/172.18.189.36/tcp/44272/p2p/16Uiu2HAmTBgWjAsrKZNP1SnGumqphLwpN9XBtparQoyhyxchKL6a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.207.73 waku 1da7ec8d009b98fcdcbafa417831d1115df47255ae93e4c4625df89a54c7256b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 1da7ec8d009b. Setting up logs at ./log/docker/node2_2024-10-06_04-16-11__cdec0f09-5786-4109-baae-c51c9b455462__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 5157
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5157/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5157/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.207.73/tcp/5158/p2p/16Uiu2HAm1DxJVRjk2RMwx9YhQ6qzRvzHYDKc4RPekWPEkHVoktpm","/ip4/172.18.207.73/tcp/5159/ws/p2p/16Uiu2HAm1DxJVRjk2RMwx9YhQ6qzRvzHYDKc4RPekWPEkHVoktpm"],"enrUri":"enr:-LO4QG7B8-BIk-hg3Kms0khKZ6BdrZn9YNEWenUGCTuHHfXYQYZOa5gDS5UdLfEjJb3DVDbW2SPjwbYggi7eNBqCZ0cBgmlkgnY0gmlwhKwSz0mKbXVsdGlhZGRyc4wACgSsEs9JBhQn3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJWJZuMYrP-OJlBV6jQj7BAdOLNZ4j3iZxBZZkEOdYwloN0Y3CCFCaDdWRwghQohXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5157/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.189.36/tcp/44272/p2p/16Uiu2HAmTBgWjAsrKZNP1SnGumqphLwpN9XBtparQoyhyxchKL6a"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44271/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5157/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "004cc084-a3e1-4572-bcce-1d1c92f00a5a", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"004cc084-a3e1-4572-bcce-1d1c92f00a5a","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44271/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5157/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1728188174895031552,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44271/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5157/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "62ce9fc0-bbbc-4fd4-b6d3-64f2f4cb52e6", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"62ce9fc0-bbbc-4fd4-b6d3-64f2f4cb52e6","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44271/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5157/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1728188175017134336,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 2d63bed5945b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1da7ec8d009b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.