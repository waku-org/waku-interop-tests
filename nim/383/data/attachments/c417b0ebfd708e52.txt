[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_subscribe_and_publish_on_another_shard with id: 2024-10-06_04-24-12__3f24d384-86a5-40f8-86d5-e32a735f5bcd
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-06_04-24-12__3f24d384-86a5-40f8-86d5-e32a735f5bcd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.102.254
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['14832', '14833', '14834', '14835', '14836']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 14832:14832 -p 14833:14833 -p 14834:14834 -p 14835:14835 -p 14836:14836 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14834 --rest-port=14832 --tcp-port=14833 --discv5-udp-port=14835 --rest-address=0.0.0.0 --nat=extip:172.18.102.254 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e17bdab05da89739765ee090aeb76994e7ecc1b852ab8b522ca1698cb0ec3aa9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14836 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.102.254 waku f126c19ec48b8b66b8d3a754c1af8c3593914bd6ee4299e45a43d88b73d6467b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID f126c19ec48b. Setting up logs at ./log/docker/node1_2024-10-06_04-24-12__3f24d384-86a5-40f8-86d5-e32a735f5bcd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 14832
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14832/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14832/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.102.254/tcp/14833/p2p/16Uiu2HAm2cTMYb47BSDg8h8W6zt3ooi5CXEDHFxFhST4CzQe5iFH","/ip4/172.18.102.254/tcp/14834/ws/p2p/16Uiu2HAm2cTMYb47BSDg8h8W6zt3ooi5CXEDHFxFhST4CzQe5iFH"],"enrUri":"enr:-LO4QPHzNCE7THgknia_cCQcpMOIIkdXJbEbzSJo3LLq0-sbM6wwUUlx5cEmSZ8HFX9POe7896tZNNZrzYuuP4ASWecBgmlkgnY0gmlwhKwSZv6KbXVsdGlhZGRyc4wACgSsEmb-Bjny3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJqxOwbGA8A21rXyvLzUqRKXcD9Fo_VPyKqk_2ONvH-EIN0Y3CCOfGDdWRwgjnzhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-06_04-24-12__3f24d384-86a5-40f8-86d5-e32a735f5bcd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.195.140
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['3628', '3629', '3630', '3631', '3632']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 3628:3628 -p 3629:3629 -p 3630:3630 -p 3631:3631 -p 3632:3632 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3630 --rest-port=3628 --tcp-port=3629 --discv5-udp-port=3631 --rest-address=0.0.0.0 --nat=extip:172.18.195.140 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=402a1cc92389748db815cdfbd3c2ece0bf73f93486e65eca33b39559144cbd7f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3632 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QPHzNCE7THgknia_cCQcpMOIIkdXJbEbzSJo3LLq0-sbM6wwUUlx5cEmSZ8HFX9POe7896tZNNZrzYuuP4ASWecBgmlkgnY0gmlwhKwSZv6KbXVsdGlhZGRyc4wACgSsEmb-Bjny3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJqxOwbGA8A21rXyvLzUqRKXcD9Fo_VPyKqk_2ONvH-EIN0Y3CCOfGDdWRwgjnzhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.195.140 waku a1b4c92bddd4293a0e339534c181ca69d5e816b4e79c00fa444ad2d06cfb11c8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID a1b4c92bddd4. Setting up logs at ./log/docker/node2_2024-10-06_04-24-12__3f24d384-86a5-40f8-86d5-e32a735f5bcd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3628
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3628/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3628/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.195.140/tcp/3629/p2p/16Uiu2HAm9EkBEhumPzDoiWKUjtRbQfNuoorJzq43fGrohcyXNggN","/ip4/172.18.195.140/tcp/3630/ws/p2p/16Uiu2HAm9EkBEhumPzDoiWKUjtRbQfNuoorJzq43fGrohcyXNggN"],"enrUri":"enr:-LO4QCmA33hdQnTjbeU3cHGSjIlN6fFwkycAAJIm9kEKK6StcgLDT8ffo2xDmZZCKXLtlgo6Hhq6ARcYLY9u62LbQUcBgmlkgnY0gmlwhKwSw4yKbXVsdGlhZGRyc4wACgSsEsOMBg4u3QOCcnOFAAIBAACJc2VjcDI1NmsxoQLNNvlWcI5sOGMleH-JHixz6ZkwrSoO9dgIdGNMxIXET4N0Y3CCDi2DdWRwgg4vhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3628/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.102.254/tcp/14833/p2p/16Uiu2HAm2cTMYb47BSDg8h8W6zt3ooi5CXEDHFxFhST4CzQe5iFH"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14832/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3628/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14832/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14832/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728188655535147520,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3628/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728188655535147520,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14832/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14832/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728188655661082624,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3628/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728188655661082624,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id f126c19ec48b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a1b4c92bddd4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.