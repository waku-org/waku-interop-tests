[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-16_04-30-48__3131f846-e0a6-4b9a-8971-ff8e093941dd
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-16_04-30-48__3131f846-e0a6-4b9a-8971-ff8e093941dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.214.19
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['9624', '9625', '9626', '9627', '9628']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 9624:9624 -p 9625:9625 -p 9626:9626 -p 9627:9627 -p 9628:9628 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9626 --rest-port=9624 --tcp-port=9625 --discv5-udp-port=9627 --rest-address=0.0.0.0 --nat=extip:172.18.214.19 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=98bfbedefbaa4cd929de8dec6fc17f4f6eba2bdca8ecdd52a700fa2d8af9ee5a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9628 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.214.19 waku dca2c21d86f669e58ce986fe3813ed96e591fd83af69728921ae407919e538f4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID dca2c21d86f6. Setting up logs at ./log/docker/node1_2024-09-16_04-30-48__3131f846-e0a6-4b9a-8971-ff8e093941dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 9624
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9624/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9624/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.19/tcp/9625/p2p/16Uiu2HAkxw3NZJ1CGXt4ERDaYoN48goHjvVBmVpKVLp3dLa6ec5Y","/ip4/172.18.214.19/tcp/9626/ws/p2p/16Uiu2HAkxw3NZJ1CGXt4ERDaYoN48goHjvVBmVpKVLp3dLa6ec5Y"],"enrUri":"enr:-LO4QGKDEcAPAFhsEwUjTUmLwen6jP8JaIfuKRdkSU0LJwzvcLFMGvST7_4EEHhMvYwJlt4nnWpiISFbFqKwnmV70WMBgmlkgnY0gmlwhKwS1hOKbXVsdGlhZGRyc4wACgSsEtYTBiWa3QOCcnOFAAIBAACJc2VjcDI1NmsxoQI0GRfB0H993TxCBaZsMIPjNoInxsJ5D7gKc3GYe1XEa4N0Y3CCJZmDdWRwgiWbhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-16_04-30-48__3131f846-e0a6-4b9a-8971-ff8e093941dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.212.38
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['23835', '23836', '23837', '23838', '23839']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 23835:23835 -p 23836:23836 -p 23837:23837 -p 23838:23838 -p 23839:23839 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23837 --rest-port=23835 --tcp-port=23836 --discv5-udp-port=23838 --rest-address=0.0.0.0 --nat=extip:172.18.212.38 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=d691db6c2ee9d213ccbdaed25e3f3e96e38c97f5b9e491a179a2b7ef0eddac6b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23839 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QGKDEcAPAFhsEwUjTUmLwen6jP8JaIfuKRdkSU0LJwzvcLFMGvST7_4EEHhMvYwJlt4nnWpiISFbFqKwnmV70WMBgmlkgnY0gmlwhKwS1hOKbXVsdGlhZGRyc4wACgSsEtYTBiWa3QOCcnOFAAIBAACJc2VjcDI1NmsxoQI0GRfB0H993TxCBaZsMIPjNoInxsJ5D7gKc3GYe1XEa4N0Y3CCJZmDdWRwgiWbhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.212.38 waku ed53ece2ba28e6144f26addc87200a9532f57117e448de3168f3ace67046ba8f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ed53ece2ba28. Setting up logs at ./log/docker/node2_2024-09-16_04-30-48__3131f846-e0a6-4b9a-8971-ff8e093941dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 23835
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23835/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23835/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.212.38/tcp/23836/p2p/16Uiu2HAm1yTqr1nrtJLUEhPFT5uts6fHuoJSKEp6bYRGfgYrZBFX","/ip4/172.18.212.38/tcp/23837/ws/p2p/16Uiu2HAm1yTqr1nrtJLUEhPFT5uts6fHuoJSKEp6bYRGfgYrZBFX"],"enrUri":"enr:-LO4QJS1S507xoX31ez6fSVvqDxzBm3kPUt2o3GiWFacHUTNGoft3R-zGSaYCBB7JetrMe3xPUoSbLElQCihtm9sa1QBgmlkgnY0gmlwhKwS1CaKbXVsdGlhZGRyc4wACgSsEtQmBl0d3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQJhSvvrz3sVeLppVe7MyTsb1lvPTw94IlSnkcYcl52H4oN0Y3CCXRyDdWRwgl0ehXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23835/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.214.19/tcp/9625/p2p/16Uiu2HAkxw3NZJ1CGXt4ERDaYoN48goHjvVBmVpKVLp3dLa6ec5Y"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9624/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:23835/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9624/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9624/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726461052923427072,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:23835/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726461052923427072,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id dca2c21d86f6
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ed53ece2ba28
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-16_04-30-48__3131f846-e0a6-4b9a-8971-ff8e093941dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-16_04-30-48__3131f846-e0a6-4b9a-8971-ff8e093941dd__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-16_04-30-58__c49a5b33-1d7d-4ca0-9201-9f237239e25c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-16_04-30-58__c49a5b33-1d7d-4ca0-9201-9f237239e25c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.38.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['16994', '16995', '16996', '16997', '16998']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 16994:16994 -p 16995:16995 -p 16996:16996 -p 16997:16997 -p 16998:16998 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16996 --rest-port=16994 --tcp-port=16995 --discv5-udp-port=16997 --rest-address=0.0.0.0 --nat=extip:172.18.38.183 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=afc0a7bcff52ca9fbaffa1b911dbfa3bdd20ff0fab79fd2aada0b4d6dfd5a1e0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16998 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.38.183 waku c0f35763b38034e49ed3f31e00f2c5bf3d8de5be0e50a037ba222ff5580654cc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c0f35763b380. Setting up logs at ./log/docker/node1_2024-09-16_04-30-58__c49a5b33-1d7d-4ca0-9201-9f237239e25c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 16994
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16994/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16994/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.183/tcp/16995/p2p/16Uiu2HAkx1LAp6gKtMEcbD667DfVnWQqmBwG5zu7FfwnJ4n3zbLM","/ip4/172.18.38.183/tcp/16996/ws/p2p/16Uiu2HAkx1LAp6gKtMEcbD667DfVnWQqmBwG5zu7FfwnJ4n3zbLM"],"enrUri":"enr:-LO4QA3xoZrm8qAXBZdZMviu0dUNdFKp1DQkUdt3cX1rn_xIbGNOUchp2e_lZ9OLQ28vQJo7olqIXzlg6n81ycx3-t8BgmlkgnY0gmlwhKwSJreKbXVsdGlhZGRyc4wACgSsEia3BkJk3QOCcnOFAAIBAACJc2VjcDI1NmsxoQImVrjcMIM772NeQnselawY22A3b75HstG23lkR06mzkoN0Y3CCQmODdWRwgkJlhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-16_04-30-58__c49a5b33-1d7d-4ca0-9201-9f237239e25c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.231.127
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['65451', '65452', '65453', '65454', '65455']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 65451:65451 -p 65452:65452 -p 65453:65453 -p 65454:65454 -p 65455:65455 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65453 --rest-port=65451 --tcp-port=65452 --discv5-udp-port=65454 --rest-address=0.0.0.0 --nat=extip:172.18.231.127 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=b870cbcaf4ac542c9ebb6f1e4ffab0a8d10e61c0b9d52a4e5de7d4a69f313baa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65455 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QA3xoZrm8qAXBZdZMviu0dUNdFKp1DQkUdt3cX1rn_xIbGNOUchp2e_lZ9OLQ28vQJo7olqIXzlg6n81ycx3-t8BgmlkgnY0gmlwhKwSJreKbXVsdGlhZGRyc4wACgSsEia3BkJk3QOCcnOFAAIBAACJc2VjcDI1NmsxoQImVrjcMIM772NeQnselawY22A3b75HstG23lkR06mzkoN0Y3CCQmODdWRwgkJlhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.231.127 waku 5e0d6b1e527686f81f2154729c31b1484333eedd00ef21cdbf5b9ada65523d8c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 5e0d6b1e5276. Setting up logs at ./log/docker/node2_2024-09-16_04-30-58__c49a5b33-1d7d-4ca0-9201-9f237239e25c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 65451
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65451/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65451/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.231.127/tcp/65452/p2p/16Uiu2HAmKXLWBpDs9o64s8THDWS5YR7XTEuPHLcgS6ENNvXwTq9Y","/ip4/172.18.231.127/tcp/65453/ws/p2p/16Uiu2HAmKXLWBpDs9o64s8THDWS5YR7XTEuPHLcgS6ENNvXwTq9Y"],"enrUri":"enr:-LO4QJ24omkpXTXKkaNRZ1M5HQEWOjA3RGS98abKk9g9ZBYWQDZduP_w-un55Gp37YnCbgzojpfXssK0pnGaZOkPEpMBgmlkgnY0gmlwhKwS53-KbXVsdGlhZGRyc4wACgSsEud_Bv-t3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQNmC_MU5eQLj2DpT0arob8bl5GhF3SlZ1r4ehxpNzAln4N0Y3CC_6yDdWRwgv-uhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65451/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.38.183/tcp/16995/p2p/16Uiu2HAkx1LAp6gKtMEcbD667DfVnWQqmBwG5zu7FfwnJ4n3zbLM"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16994/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65451/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:16994/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:16994/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726461063386016768,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65451/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726461063386016768,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c0f35763b380
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 5e0d6b1e5276
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-16_04-30-58__c49a5b33-1d7d-4ca0-9201-9f237239e25c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-16_04-30-58__c49a5b33-1d7d-4ca0-9201-9f237239e25c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_same_cluster_different_shards with id: 2024-09-16_04-31-09__e44dd481-c052-44e8-9aef-d7d7a04272fa
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-16_04-31-09__e44dd481-c052-44e8-9aef-d7d7a04272fa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.198.9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['37768', '37769', '37770', '37771', '37772']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 37768:37768 -p 37769:37769 -p 37770:37770 -p 37771:37771 -p 37772:37772 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37770 --rest-port=37768 --tcp-port=37769 --discv5-udp-port=37771 --rest-address=0.0.0.0 --nat=extip:172.18.198.9 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=770cab2ff77f645c8a9facba5afa4dc12de772c8f2914de5aacf8906d5aa9e6e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37772 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.198.9 waku 63c90a27b761a1775ec867dcbf38666d8527379311049b0dd09fe943885ff5ed
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 63c90a27b761. Setting up logs at ./log/docker/node1_2024-09-16_04-31-09__e44dd481-c052-44e8-9aef-d7d7a04272fa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 37768
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37768/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37768/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.198.9/tcp/37769/p2p/16Uiu2HAmKtowaRrnXx7UNMSvoSkDv5mSaVDcPcczUuGe9pguCWBT","/ip4/172.18.198.9/tcp/37770/ws/p2p/16Uiu2HAmKtowaRrnXx7UNMSvoSkDv5mSaVDcPcczUuGe9pguCWBT"],"enrUri":"enr:-LO4QMgLjeiteoU4yFDjJrr-HaSnBmJeihP3jdPV27vCbAZoYnbY-_qXIBYtmR4fkIxLttj8fpCWxh-RvWOQmVpt0WoBgmlkgnY0gmlwhKwSxgmKbXVsdGlhZGRyc4wACgSsEsYJBpOK3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNrjCul0QL_mnghDXMguq5CY0PXmXANBVeJ_AGjLGgOioN0Y3CCk4mDdWRwgpOLhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-16_04-31-09__e44dd481-c052-44e8-9aef-d7d7a04272fa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.48.88
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['33609', '33610', '33611', '33612', '33613']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 33609:33609 -p 33610:33610 -p 33611:33611 -p 33612:33612 -p 33613:33613 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33611 --rest-port=33609 --tcp-port=33610 --discv5-udp-port=33612 --rest-address=0.0.0.0 --nat=extip:172.18.48.88 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=0edf55ff3ffab72bf49c00d7da5a7b5fd9dbd46ab7e80ab5dee1a08fd9aedbf1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33613 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QMgLjeiteoU4yFDjJrr-HaSnBmJeihP3jdPV27vCbAZoYnbY-_qXIBYtmR4fkIxLttj8fpCWxh-RvWOQmVpt0WoBgmlkgnY0gmlwhKwSxgmKbXVsdGlhZGRyc4wACgSsEsYJBpOK3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNrjCul0QL_mnghDXMguq5CY0PXmXANBVeJ_AGjLGgOioN0Y3CCk4mDdWRwgpOLhXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.48.88 waku d3a9f4f6fdd7d497523b048193e2fff8a59c09ef21da6d7a57b5da668aa9a323
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID d3a9f4f6fdd7. Setting up logs at ./log/docker/node2_2024-09-16_04-31-09__e44dd481-c052-44e8-9aef-d7d7a04272fa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 33609
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33609/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33609/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.48.88/tcp/33610/p2p/16Uiu2HAkyFM2NhzpQHs7ZALarW8gVgxVVQhzHsrP6WEQXSxdHx9h","/ip4/172.18.48.88/tcp/33611/ws/p2p/16Uiu2HAkyFM2NhzpQHs7ZALarW8gVgxVVQhzHsrP6WEQXSxdHx9h"],"enrUri":"enr:-LO4QJ5feXRCo21FLKKr0d1Ni9iZNzVv31k4F-a912njPIt1UsfNxTkBRyDFz_OGM6v5tp__zdc-cYa-1qoSqmUahqUBgmlkgnY0gmlwhKwSMFiKbXVsdGlhZGRyc4wACgSsEjBYBoNL3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQI4yYGuyb9ggm3ONSFS6oBS9XDUU4D5RRl8Gmc3HLGPFIN0Y3CCg0qDdWRwgoNMhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33609/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.198.9/tcp/37769/p2p/16Uiu2HAmKtowaRrnXx7UNMSvoSkDv5mSaVDcPcczUuGe9pguCWBT"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37768/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33609/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37768/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37768/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726461072750732288,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33609/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726461072750732288,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 63c90a27b761
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d3a9f4f6fdd7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node2_2024-09-16_04-31-09__e44dd481-c052-44e8-9aef-d7d7a04272fa__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/node1_2024-09-16_04-31-09__e44dd481-c052-44e8-9aef-d7d7a04272fa__wakuorg_nwaku:latest.log