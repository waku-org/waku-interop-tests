[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-09-19_04-19-09__230acb9e-c4d8-4665-9530-01beaf7949b6
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-19_04-19-09__230acb9e-c4d8-4665-9530-01beaf7949b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.146.130
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['6151', '6152', '6153', '6154', '6155']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 6151:6151 -p 6152:6152 -p 6153:6153 -p 6154:6154 -p 6155:6155 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6153 --rest-port=6151 --tcp-port=6152 --discv5-udp-port=6154 --rest-address=0.0.0.0 --nat=extip:172.18.146.130 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f64df3a92feefc50bf28c952f4a8fe57d6dd45fe4f52fe9d18cfed79fc7effaa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6155 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.146.130 waku b5eb9ef06ee731eb8bb00adbbbf4c602235024cbea770e09ed0e2b364392fdb7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID b5eb9ef06ee7. Setting up logs at ./log/docker/receiving_node1_2024-09-19_04-19-09__230acb9e-c4d8-4665-9530-01beaf7949b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 6151
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6151/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6151/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.146.130/tcp/6152/p2p/16Uiu2HAmDabU6XvYHwX8Ag9Xvdw5R7Q8gAimdAvxxE8fGur4KTo7","/ip4/172.18.146.130/tcp/6153/ws/p2p/16Uiu2HAmDabU6XvYHwX8Ag9Xvdw5R7Q8gAimdAvxxE8fGur4KTo7"],"enrUri":"enr:-LO4QGIWSAYagVChmK8_g18sR2J7UPdXuBG9-XCEFA0qnTBmIaxMPvNZmmry6DPQ37xPIHnUDmfh81XZNUoYdSTw3NABgmlkgnY0gmlwhKwSkoKKbXVsdGlhZGRyc4wACgSsEpKCBhgJ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMNu319e-V2Z7MOAzv3nqOkLTWiHRmo5kGpQ_-SAgb8OoN0Y3CCGAiDdWRwghgKhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-19_04-19-09__230acb9e-c4d8-4665-9530-01beaf7949b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.134.63
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['38536', '38537', '38538', '38539', '38540']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 38536:38536 -p 38537:38537 -p 38538:38538 -p 38539:38539 -p 38540:38540 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38538 --rest-port=38536 --tcp-port=38537 --discv5-udp-port=38539 --rest-address=0.0.0.0 --nat=extip:172.18.134.63 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2ff6bd75d19c81f2e3aa99c5bf23b80e1c0de2b0dabf1ddad231b7e7ecbefea5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38540 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.134.63 waku 7b1fd047e88660f30e0ab067bae6bcfb4a90f85c6ae362c5db1391519ce93156
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7b1fd047e886. Setting up logs at ./log/docker/receiving_node2_2024-09-19_04-19-09__230acb9e-c4d8-4665-9530-01beaf7949b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 38536
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38536/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38536/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.134.63/tcp/38537/p2p/16Uiu2HAm4Ps6BzpSSncGPQu7U3ENsCUfmUMtXUNVW2t9XV6PqJKX","/ip4/172.18.134.63/tcp/38538/ws/p2p/16Uiu2HAm4Ps6BzpSSncGPQu7U3ENsCUfmUMtXUNVW2t9XV6PqJKX"],"enrUri":"enr:-LO4QFwTZ9lBLUNee5WdX-s4yY95goRyQwcRdBTfE4eie1TwCJTaBohdG0AN-t4eQL1y12F2uvmYJDZ66vMB8JTT748BgmlkgnY0gmlwhKwShj-KbXVsdGlhZGRyc4wACgSsEoY_BpaK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKFQpVKVkHWYx8-Op9RnTAxeugEJ-LwIeJq4NMvItICloN0Y3CClomDdWRwgpaLhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38536/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.146.130/tcp/6152/p2p/16Uiu2HAmDabU6XvYHwX8Ag9Xvdw5R7Q8gAimdAvxxE8fGur4KTo7"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-19_04-19-09__230acb9e-c4d8-4665-9530-01beaf7949b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.192.26
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['55223', '55224', '55225', '55226', '55227']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 55223:55223 -p 55224:55224 -p 55225:55225 -p 55226:55226 -p 55227:55227 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55225 --rest-port=55223 --tcp-port=55224 --discv5-udp-port=55226 --rest-address=0.0.0.0 --nat=extip:172.18.192.26 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c53dbd9cb70fbee35cf6ca5deccc01e4befabd79a45d5f2e8cbd526dac822e48 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55227 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QGIWSAYagVChmK8_g18sR2J7UPdXuBG9-XCEFA0qnTBmIaxMPvNZmmry6DPQ37xPIHnUDmfh81XZNUoYdSTw3NABgmlkgnY0gmlwhKwSkoKKbXVsdGlhZGRyc4wACgSsEpKCBhgJ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMNu319e-V2Z7MOAzv3nqOkLTWiHRmo5kGpQ_-SAgb8OoN0Y3CCGAiDdWRwghgKhXdha3UyCQ --lightpushnode=/ip4/172.18.146.130/tcp/6152/p2p/16Uiu2HAmDabU6XvYHwX8Ag9Xvdw5R7Q8gAimdAvxxE8fGur4KTo7 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.192.26 waku 2239cb7881131e8399caa5223af4b05be640eeffb3642054feb4598a38cc48af
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 2239cb788113. Setting up logs at ./log/docker/lightpush_node1_2024-09-19_04-19-09__230acb9e-c4d8-4665-9530-01beaf7949b6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 55223
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55223/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55223/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.192.26/tcp/55224/p2p/16Uiu2HAmFNXSymvKxiq8Unkzx4rXHCWwcnpae2KQoAnjttXtGqtp","/ip4/172.18.192.26/tcp/55225/ws/p2p/16Uiu2HAmFNXSymvKxiq8Unkzx4rXHCWwcnpae2KQoAnjttXtGqtp"],"enrUri":"enr:-LO4QIZcNUQneOjp_8egQbJxL_k6bOJv7SORUP73r2ezH71PdiPOL17MXYVPw4QI5wgCpUAWx93Vv0BaUBnt84qpPvMBgmlkgnY0gmlwhKwSwBqKbXVsdGlhZGRyc4wACgSsEsAaBte53QOCcnOFAAMBAACJc2VjcDI1NmsxoQMoW1mJyjyS6m7oex4pZwyEHl4p-UV71M_PRgRHHFzEBYN0Y3CC17iDdWRwgte6hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55223/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.146.130/tcp/6152/p2p/16Uiu2HAmDabU6XvYHwX8Ag9Xvdw5R7Q8gAimdAvxxE8fGur4KTo7"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55223/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.134.63/tcp/38537/p2p/16Uiu2HAm4Ps6BzpSSncGPQu7U3ENsCUfmUMtXUNVW2t9XV6PqJKX"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6151/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:38536/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55223/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726719554075409920, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6151/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726719554075409920,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38536/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726719554075409920,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55223/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1726719554223489280, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6151/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726719554223489280,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:38536/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726719554223489280,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b5eb9ef06ee7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7b1fd047e886
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 2239cb788113
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.