[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-08-30_04-21-36__1a53a33c-89ed-40aa-a830-a1dc7810e4b3
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-30_04-21-36__1a53a33c-89ed-40aa-a830-a1dc7810e4b3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.221.114
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['26063', '26064', '26065', '26066', '26067']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 26063:26063 -p 26064:26064 -p 26065:26065 -p 26066:26066 -p 26067:26067 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26065 --rest-port=26063 --tcp-port=26064 --discv5-udp-port=26066 --rest-address=0.0.0.0 --nat=extip:172.18.221.114 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bbedca7ec9c5e7433a3fefc05f9cef8fa9464adbdc5eed8ec10edacf9dff323b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26067 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.221.114 waku a0a0b463c9922df85e7fe6ee70a71226273ef0bef8d5b2c24609520ccf7e3c01
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID a0a0b463c992. Setting up logs at ./log/docker/receiving_node1_2024-08-30_04-21-36__1a53a33c-89ed-40aa-a830-a1dc7810e4b3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 26063
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26063/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26063/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.221.114/tcp/26064/p2p/16Uiu2HAm8LJFtn2ujJ1HKB6JfZrJF3mAZggxd3G56MGYV2xXoVoa","/ip4/172.18.221.114/tcp/26065/ws/p2p/16Uiu2HAm8LJFtn2ujJ1HKB6JfZrJF3mAZggxd3G56MGYV2xXoVoa"],"enrUri":"enr:-LO4QNwIwAkPRETgwuRBTtpmuPj8VdxuwAOc97l14pAaMhmnZ7Gv4MWWlerNHuuExyfc3tdwT5sQvHDaYXvu6zTLsxMBgmlkgnY0gmlwhKwS3XKKbXVsdGlhZGRyc4wACgSsEt1yBmXR3QOCcnOFAAMBAACJc2VjcDI1NmsxoQK_x3bh-MpaRWdTdshoje2xfsoIdMKCzyFVxRs81MFkLYN0Y3CCZdCDdWRwgmXShXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-08-30_04-21-36__1a53a33c-89ed-40aa-a830-a1dc7810e4b3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.90.148
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['50355', '50356', '50357', '50358', '50359']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 50355:50355 -p 50356:50356 -p 50357:50357 -p 50358:50358 -p 50359:50359 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50357 --rest-port=50355 --tcp-port=50356 --discv5-udp-port=50358 --rest-address=0.0.0.0 --nat=extip:172.18.90.148 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4791c72c2cd24cf1d1ce6b3eb7ce28e656a2ebca2cb5abb6b95c8fef7ed2b3d5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50359 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.90.148 waku c3d2b8b5f3b0d90f3318743d8f8ffa87e88e170641b1b0dd30e7a103315a60b5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c3d2b8b5f3b0. Setting up logs at ./log/docker/receiving_node2_2024-08-30_04-21-36__1a53a33c-89ed-40aa-a830-a1dc7810e4b3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 50355
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50355/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50355/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.90.148/tcp/50356/p2p/16Uiu2HAmGHHxqopvZRZj9Rc15um4PDYyBUFisUWeWzHM25deQxhA","/ip4/172.18.90.148/tcp/50357/ws/p2p/16Uiu2HAmGHHxqopvZRZj9Rc15um4PDYyBUFisUWeWzHM25deQxhA"],"enrUri":"enr:-LO4QLl-fScnVU4RI2nEa6qzFFJkdncTxu2yQU8aKZ6irtbJQ_BA-1wvEOmc-PiknT96EZWrPIgb3EEJq83eg03l9N4BgmlkgnY0gmlwhKwSWpSKbXVsdGlhZGRyc4wACgSsElqUBsS13QOCcnOFAAMBAACJc2VjcDI1NmsxoQM13-KMnIvAPbNOQqpByMvljQHGAhwEjZ3FX16WF8-WvYN0Y3CCxLSDdWRwgsS2hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50355/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.221.114/tcp/26064/p2p/16Uiu2HAm8LJFtn2ujJ1HKB6JfZrJF3mAZggxd3G56MGYV2xXoVoa"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-30_04-21-36__1a53a33c-89ed-40aa-a830-a1dc7810e4b3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.53.22
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['17615', '17616', '17617', '17618', '17619']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 17615:17615 -p 17616:17616 -p 17617:17617 -p 17618:17618 -p 17619:17619 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17617 --rest-port=17615 --tcp-port=17616 --discv5-udp-port=17618 --rest-address=0.0.0.0 --nat=extip:172.18.53.22 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d6bbcbca0f6c1e89a6cb2fb6a8438f46a5e4de3d83feeadf04f4c8aac40ecdf0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17619 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QNwIwAkPRETgwuRBTtpmuPj8VdxuwAOc97l14pAaMhmnZ7Gv4MWWlerNHuuExyfc3tdwT5sQvHDaYXvu6zTLsxMBgmlkgnY0gmlwhKwS3XKKbXVsdGlhZGRyc4wACgSsEt1yBmXR3QOCcnOFAAMBAACJc2VjcDI1NmsxoQK_x3bh-MpaRWdTdshoje2xfsoIdMKCzyFVxRs81MFkLYN0Y3CCZdCDdWRwgmXShXdha3UyCQ --lightpushnode=/ip4/172.18.221.114/tcp/26064/p2p/16Uiu2HAm8LJFtn2ujJ1HKB6JfZrJF3mAZggxd3G56MGYV2xXoVoa --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.53.22 waku e8e45efe6f17cdd5ec7b73ff15db38dfc3a610cab6e253e1f00b764f9d232bc4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID e8e45efe6f17. Setting up logs at ./log/docker/lightpush_node1_2024-08-30_04-21-36__1a53a33c-89ed-40aa-a830-a1dc7810e4b3__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 17615
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17615/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17615/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.53.22/tcp/17616/p2p/16Uiu2HAmKVZYLJMBqNrn9GQgKshXmjkVVLzLh7bzKTQR7Kbarxef","/ip4/172.18.53.22/tcp/17617/ws/p2p/16Uiu2HAmKVZYLJMBqNrn9GQgKshXmjkVVLzLh7bzKTQR7Kbarxef"],"enrUri":"enr:-LO4QHWfnveClTORjFwFIb2_FzBYp_GuAQr9cDt-qQ4GcYtKcdS33Xye96vJL6cHWqjRNMwi7WnrNTyH2JOFTtlxcuEBgmlkgnY0gmlwhKwSNRaKbXVsdGlhZGRyc4wACgSsEjUWBkTR3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNll4dmhNwK9HoEZNOCT73NRZuUacRhCJnyUZRx5jywvIN0Y3CCRNCDdWRwgkTShXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17615/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.221.114/tcp/26064/p2p/16Uiu2HAm8LJFtn2ujJ1HKB6JfZrJF3mAZggxd3G56MGYV2xXoVoa"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17615/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.90.148/tcp/50356/p2p/16Uiu2HAmGHHxqopvZRZj9Rc15um4PDYyBUFisUWeWzHM25deQxhA"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26063/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50355/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17615/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724991702210727424}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26063/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724991702210727424,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50355/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724991702210727424,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17615/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724991702210727424}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:17615/lightpush/v1/message. Response content: b'Failed to request a message push: Lightpush request has not been published to any peers. msg_hash: 0x85605c748738f7b59c3d9ebc64cdb25e7f7e21944f742fe2d267ca43b972f00d'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id a0a0b463c992
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c3d2b8b5f3b0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id e8e45efe6f17
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.