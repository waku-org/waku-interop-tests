[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_add_a_new_content_topic with id: 2024-11-06_23-06-15__ecc7565d-5107-4e7e-9220-e6ae3e7ac023
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-06_23-06-15__ecc7565d-5107-4e7e-9220-e6ae3e7ac023__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.183.100
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['58170', '58171', '58172', '58173', '58174']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 58170:58170 -p 58171:58171 -p 58172:58172 -p 58173:58173 -p 58174:58174 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58172 --rest-port=58170 --tcp-port=58171 --discv5-udp-port=58173 --rest-address=0.0.0.0 --nat=extip:172.18.183.100 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b52ccf0d8e1be2ab5bc3f5da8fda3e2d001757fff9e87d2074aebeee24c29da1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58174 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.183.100 waku 057d3e10d7c98d2e705d37a6d7fd87d822da408f51b13a5b8d04200f4722917e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 057d3e10d7c9. Setting up logs at ./log/docker/node1_2024-11-06_23-06-15__ecc7565d-5107-4e7e-9220-e6ae3e7ac023__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 58170
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 7896d7e134ab. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58170/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58170/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.183.100/tcp/58171/p2p/16Uiu2HAmQKsiPRjF9ZoqAGm9WEp7LswMU3GiEHtQJBXwgbhh2EC5","/ip4/172.18.183.100/tcp/58172/ws/p2p/16Uiu2HAmQKsiPRjF9ZoqAGm9WEp7LswMU3GiEHtQJBXwgbhh2EC5"],"enrUri":"enr:-L24QKs01eLAQB1m_2x2_aGfCKi4UkggmVeofGYA0xFTlX7oWTTPMW9LI7ikt5XnPijpqeTaLs8aT1A8w7WXzbQOFdMCgmlkgnY0gmlwhKwSt2SKbXVsdGlhZGRyc5YACASsErdkBuM7AAoErBK3ZAbjPN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDrWa0QNBun7UjWDwKRLVsNztMf1KhpMtG9cxvhGRtQv6DdGNwguM7g3VkcILjPYV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-06_23-06-15__ecc7565d-5107-4e7e-9220-e6ae3e7ac023__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.11.31
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['30459', '30460', '30461', '30462', '30463']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 30459:30459 -p 30460:30460 -p 30461:30461 -p 30462:30462 -p 30463:30463 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30461 --rest-port=30459 --tcp-port=30460 --discv5-udp-port=30462 --rest-address=0.0.0.0 --nat=extip:172.18.11.31 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8de307b2aeb2ec7f6cd45e865f8846ce9da4ad9fbfcdb7f6facbacb5e48fb2ed --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30463 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QKs01eLAQB1m_2x2_aGfCKi4UkggmVeofGYA0xFTlX7oWTTPMW9LI7ikt5XnPijpqeTaLs8aT1A8w7WXzbQOFdMCgmlkgnY0gmlwhKwSt2SKbXVsdGlhZGRyc5YACASsErdkBuM7AAoErBK3ZAbjPN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDrWa0QNBun7UjWDwKRLVsNztMf1KhpMtG9cxvhGRtQv6DdGNwguM7g3VkcILjPYV3YWt1MgU --filternode=/ip4/172.18.183.100/tcp/58171/p2p/16Uiu2HAmQKsiPRjF9ZoqAGm9WEp7LswMU3GiEHtQJBXwgbhh2EC5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.11.31 waku 24367f33614502624f292cd1338d84725035a72962766e8010c4efb95b412262
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 24367f336145. Setting up logs at ./log/docker/node2_2024-11-06_23-06-15__ecc7565d-5107-4e7e-9220-e6ae3e7ac023__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 30459
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30459/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30459/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.11.31/tcp/30460/p2p/16Uiu2HAkv4mdjbvb4o47cVVZxpS9CrzvRk7pavb5hMU474UnukA6","/ip4/172.18.11.31/tcp/30461/ws/p2p/16Uiu2HAkv4mdjbvb4o47cVVZxpS9CrzvRk7pavb5hMU474UnukA6"],"enrUri":"enr:-L24QO2p90WPKQFoNsaX9KlyrhIhIh7XXhBl4uNuOVStTN_jbkGftHRwVQbSnyyWnNkDb-EnvxZZQLJz01lHX7uye8ICgmlkgnY0gmlwhKwSCx-KbXVsdGlhZGRyc5YACASsEgsfBnb8AAoErBILHwZ2_d0DgnJzhQADAQAAiXNlY3AyNTZrMaECCYDiFIE2TfLPZrDH0Rv0TbzH2o6fzeC9I0CDYI4snauDdGNwgnb8g3VkcIJ2_oV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30459/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.183.100/tcp/58171/p2p/16Uiu2HAmQKsiPRjF9ZoqAGm9WEp7LswMU3GiEHtQJBXwgbhh2EC5"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58170/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30459/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "f5046c74-72fc-4df4-9509-026be3211d8f", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"f5046c74-72fc-4df4-9509-026be3211d8f","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:30459/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58170/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30459/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1730934378440016384,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58170/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30459/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1730934378555868928,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 057d3e10d7c9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 24367f336145
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 057d3e10d7c9. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.