[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-11-06_23-10-12__b7e003ef-e484-492d-83d4-963ebac39666
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-06_23-10-12__b7e003ef-e484-492d-83d4-963ebac39666__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.44.163
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['39258', '39259', '39260', '39261', '39262']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 39258:39258 -p 39259:39259 -p 39260:39260 -p 39261:39261 -p 39262:39262 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39260 --rest-port=39258 --tcp-port=39259 --discv5-udp-port=39261 --rest-address=0.0.0.0 --nat=extip:172.18.44.163 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6b0cebcb49bbe74c49017fd2afb3a2f6e67f8f49ed9b4e65e4497af8da838be9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39262 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.44.163 waku 9f53343f9801b7cafd9d1db9c8a3573f25b59e034ec003ace893b5df3df77f9f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9f53343f9801. Setting up logs at ./log/docker/receiving_node1_2024-11-06_23-10-12__b7e003ef-e484-492d-83d4-963ebac39666__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 39258
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 42c88f146bf4. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39258/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39258/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.44.163/tcp/39259/p2p/16Uiu2HAmVS76NAdUT68V8XpScaA7YPQnLxuyjciL6sabNzFE4geL","/ip4/172.18.44.163/tcp/39260/ws/p2p/16Uiu2HAmVS76NAdUT68V8XpScaA7YPQnLxuyjciL6sabNzFE4geL"],"enrUri":"enr:-L24QL1EkTJLmkg3QTZ4TtnurxErdhrKmhhdW7xNn5XAvRiEOJVZ4CJ5VeUQ1VUFYFgAxDDdgDig6OC8-IikFeHUfi4CgmlkgnY0gmlwhKwSLKOKbXVsdGlhZGRyc5YACASsEiyjBplbAAoErBIsowaZXN0DgnJzhQADAQAAiXNlY3AyNTZrMaED-UnAT11mM3g3-PuQS_nSnEDHq8DirXg3sZEZXUiwrLmDdGNwgplbg3VkcIKZXYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-06_23-10-12__b7e003ef-e484-492d-83d4-963ebac39666__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.224.197
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['34538', '34539', '34540', '34541', '34542']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 34538:34538 -p 34539:34539 -p 34540:34540 -p 34541:34541 -p 34542:34542 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34540 --rest-port=34538 --tcp-port=34539 --discv5-udp-port=34541 --rest-address=0.0.0.0 --nat=extip:172.18.224.197 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3530dc416af2ab1c3df94d45f5df760fea9a63ddef6cacafb0becc86fcbbdbd3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34542 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.224.197 waku 254dc694347c577cb55e765873b4f8cdb14fb360b0340f37d0ea69fb7308467f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 254dc694347c. Setting up logs at ./log/docker/receiving_node2_2024-11-06_23-10-12__b7e003ef-e484-492d-83d4-963ebac39666__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 34538
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34538/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34538/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.224.197/tcp/34539/p2p/16Uiu2HAkygg56NNVy8raY9fAtdTQLdfYcuibFdNG2GqyyRannqGq","/ip4/172.18.224.197/tcp/34540/ws/p2p/16Uiu2HAkygg56NNVy8raY9fAtdTQLdfYcuibFdNG2GqyyRannqGq"],"enrUri":"enr:-L24QLYxP6b6QCOJy6DP36ZMkmydm1zA8EVcY5iA2VDy-p1rU5WJn_siPz3DhSsOj3CMEezU1nS6rYuAyHW7zL1NyScCgmlkgnY0gmlwhKwS4MWKbXVsdGlhZGRyc5YACASsEuDFBobrAAoErBLgxQaG7N0DgnJzhQADAQAAiXNlY3AyNTZrMaECP0aQK12GhAhJKx20-wQpW8JtpTQQuYI14xM3L5e5ls6DdGNwgobrg3VkcIKG7YV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34538/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.44.163/tcp/39259/p2p/16Uiu2HAmVS76NAdUT68V8XpScaA7YPQnLxuyjciL6sabNzFE4geL"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-06_23-10-12__b7e003ef-e484-492d-83d4-963ebac39666__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.119.143
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['37887', '37888', '37889', '37890', '37891']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 37887:37887 -p 37888:37888 -p 37889:37889 -p 37890:37890 -p 37891:37891 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37889 --rest-port=37887 --tcp-port=37888 --discv5-udp-port=37890 --rest-address=0.0.0.0 --nat=extip:172.18.119.143 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f968ccfab9bd3c3f0cafcc2eb9e2aefc2b355e6d81f7ac9dea0edad1cabb0db1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37891 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QL1EkTJLmkg3QTZ4TtnurxErdhrKmhhdW7xNn5XAvRiEOJVZ4CJ5VeUQ1VUFYFgAxDDdgDig6OC8-IikFeHUfi4CgmlkgnY0gmlwhKwSLKOKbXVsdGlhZGRyc5YACASsEiyjBplbAAoErBIsowaZXN0DgnJzhQADAQAAiXNlY3AyNTZrMaED-UnAT11mM3g3-PuQS_nSnEDHq8DirXg3sZEZXUiwrLmDdGNwgplbg3VkcIKZXYV3YWt1Mgk --lightpushnode=/ip4/172.18.44.163/tcp/39259/p2p/16Uiu2HAmVS76NAdUT68V8XpScaA7YPQnLxuyjciL6sabNzFE4geL --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.119.143 waku cc591ec243909c7519bfaee382a114969bf7b3e6ab5e67c09ed57729b8efd1ce
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID cc591ec24390. Setting up logs at ./log/docker/lightpush_node1_2024-11-06_23-10-12__b7e003ef-e484-492d-83d4-963ebac39666__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 37887
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37887/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37887/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.119.143/tcp/37888/p2p/16Uiu2HAkzssjbq8Kg6hLqEbqiyzhj22zDX1Dkz7Hn3wcAZHBTqhd","/ip4/172.18.119.143/tcp/37889/ws/p2p/16Uiu2HAkzssjbq8Kg6hLqEbqiyzhj22zDX1Dkz7Hn3wcAZHBTqhd"],"enrUri":"enr:-L24QAWTeJb9dCZlwhrSDQqc-XzG8bZDi0tJaGUS-WETTEwbDqhg74-CnM3c8k22M26rqCCAMB7KUkeNGI879unvUgYCgmlkgnY0gmlwhKwSd4-KbXVsdGlhZGRyc5YACASsEnePBpQAAAoErBJ3jwaUAd0DgnJzhQADAQAAiXNlY3AyNTZrMaECUQDT0tXPyL3pD0e5rMqvewCUlhARmoBorrFRLle2WiSDdGNwgpQAg3VkcIKUAoV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37887/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.44.163/tcp/39259/p2p/16Uiu2HAmVS76NAdUT68V8XpScaA7YPQnLxuyjciL6sabNzFE4geL"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37887/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.224.197/tcp/34539/p2p/16Uiu2HAkygg56NNVy8raY9fAtdTQLdfYcuibFdNG2GqyyRannqGq"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39258/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34538/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37887/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730934617898173440, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39258/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730934617898173440,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34538/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730934617898173440,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37887/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730934618030401280, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39258/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730934618030401280,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34538/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730934618030401280,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9f53343f9801
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 254dc694347c
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 9f53343f9801. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id cc591ec24390
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 254dc694347c. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.