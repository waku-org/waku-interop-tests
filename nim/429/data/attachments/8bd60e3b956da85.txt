[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_invalid_meta with id: 2024-11-06_23-14-38__b3e39aa4-0225-4548-a46c-e3748b24d2e8
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-06_23-14-38__b3e39aa4-0225-4548-a46c-e3748b24d2e8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.124.15
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3869', '3870', '3871', '3872', '3873']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3869:3869 -p 3870:3870 -p 3871:3871 -p 3872:3872 -p 3873:3873 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3871 --rest-port=3869 --tcp-port=3870 --discv5-udp-port=3872 --rest-address=0.0.0.0 --nat=extip:172.18.124.15 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a95cadcaeadddd6380effff2b8147c9f5951d48e65757dffeabf50db45cee3ef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3873 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.124.15 waku 3eaa6321e1830f70b069e71e5609979768fd4bc816acea088d4c689014effae6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3eaa6321e183. Setting up logs at ./log/docker/node1_2024-11-06_23-14-38__b3e39aa4-0225-4548-a46c-e3748b24d2e8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3869
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 34ff50662730. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3869/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3869/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.124.15/tcp/3870/p2p/16Uiu2HAm5opFNCYzb5KfSXvb1FirmnkCEcg7xZVmTFcego1RFkjo","/ip4/172.18.124.15/tcp/3871/ws/p2p/16Uiu2HAm5opFNCYzb5KfSXvb1FirmnkCEcg7xZVmTFcego1RFkjo"],"enrUri":"enr:-L24QOEJOoknyyBkv0EkEfjC0eh-Lq_1-BEzI12an3qgEn3AL7NSF2uTV7jodoTBIF2G5huNjJOxhz5jIYiB-fBiWYoCgmlkgnY0gmlwhKwSfA-KbXVsdGlhZGRyc5YACASsEnwPBg8eAAoErBJ8DwYPH90DgnJzhQADAQAAiXNlY3AyNTZrMaECmkD_DFeRR2whhe-iA_i5FvqSmWUOaVmKv2YQB5w9um6DdGNwgg8eg3VkcIIPIIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-06_23-14-38__b3e39aa4-0225-4548-a46c-e3748b24d2e8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.114.67
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['33406', '33407', '33408', '33409', '33410']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 33406:33406 -p 33407:33407 -p 33408:33408 -p 33409:33409 -p 33410:33410 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33408 --rest-port=33406 --tcp-port=33407 --discv5-udp-port=33409 --rest-address=0.0.0.0 --nat=extip:172.18.114.67 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1ca805ad6020eab9b8c3eaf0d75b77c5088b4aa22a1fd2162fe47e5ebbafbfaa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33410 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QOEJOoknyyBkv0EkEfjC0eh-Lq_1-BEzI12an3qgEn3AL7NSF2uTV7jodoTBIF2G5huNjJOxhz5jIYiB-fBiWYoCgmlkgnY0gmlwhKwSfA-KbXVsdGlhZGRyc5YACASsEnwPBg8eAAoErBJ8DwYPH90DgnJzhQADAQAAiXNlY3AyNTZrMaECmkD_DFeRR2whhe-iA_i5FvqSmWUOaVmKv2YQB5w9um6DdGNwgg8eg3VkcIIPIIV3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.114.67 waku 7451728deebbdb6c4ce1fa38133f4ab6cf39c693ff3e187c417d68db667d9d36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 7451728deebb. Setting up logs at ./log/docker/node2_2024-11-06_23-14-38__b3e39aa4-0225-4548-a46c-e3748b24d2e8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 33406
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33406/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33406/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.114.67/tcp/33407/p2p/16Uiu2HAmQxKLfMC9c4W4xSwGvDrRnxTW7zrb5fPKURkw5MeD1GFd","/ip4/172.18.114.67/tcp/33408/ws/p2p/16Uiu2HAmQxKLfMC9c4W4xSwGvDrRnxTW7zrb5fPKURkw5MeD1GFd"],"enrUri":"enr:-L24QKvtsQNQnKt1c54HU_6drq7pcWruC03RkAHRATeDpwQ3FU2Y0pxBArc1tp2zK1vQNrW5gEFUtLgBa_-MuspVSU0CgmlkgnY0gmlwhKwSckOKbXVsdGlhZGRyc5YACASsEnJDBoJ_AAoErBJyQwaCgN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDtryWhxD_RQDF8U43835wDpK2VJVuXkuezNE0yeCauEyDdGNwgoJ_g3VkcIKCgYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33406/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.124.15/tcp/3870/p2p/16Uiu2HAm5opFNCYzb5KfSXvb1FirmnkCEcg7xZVmTFcego1RFkjo"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3869/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33406/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3869/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3869/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730934882169913600,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33406/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730934882169913600,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3869/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "meta": "Relay works!!"}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:3869/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Incorrect base64 string'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3eaa6321e183
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7451728deebb
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3eaa6321e183. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.