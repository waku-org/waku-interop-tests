[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-09-28_04-18-43__5d9000d6-99b0-4ab2-bc98-c2ddc0ad24f2
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-28_04-18-43__5d9000d6-99b0-4ab2-bc98-c2ddc0ad24f2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.198.196
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['61529', '61530', '61531', '61532', '61533']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 61529:61529 -p 61530:61530 -p 61531:61531 -p 61532:61532 -p 61533:61533 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61531 --rest-port=61529 --tcp-port=61530 --discv5-udp-port=61532 --rest-address=0.0.0.0 --nat=extip:172.18.198.196 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=534bc1c2826ea0edc3a1caceedc8d59a9fe785c7cbdf43ce0f969fedad8b5af9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61533 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.198.196 waku 7c97440e60aa9a5e1961a586affbe053a46565a960d4787224954da21428fde9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7c97440e60aa. Setting up logs at ./log/docker/receiving_node1_2024-09-28_04-18-43__5d9000d6-99b0-4ab2-bc98-c2ddc0ad24f2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 61529
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61529/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61529/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.198.196/tcp/61530/p2p/16Uiu2HAkwDYNKjHasgeyNLdmE2tCPaabzgm18XhCwrr7g78Y4JG6","/ip4/172.18.198.196/tcp/61531/ws/p2p/16Uiu2HAkwDYNKjHasgeyNLdmE2tCPaabzgm18XhCwrr7g78Y4JG6"],"enrUri":"enr:-LO4QOmo7VaXRusCiJBf6GHpbt8brTPlMgelLqS5a5IjVYlpNDM8ke-p3zTYNgzPj27ZePtco6vKG5WoEjum0Oty6fcBgmlkgnY0gmlwhKwSxsSKbXVsdGlhZGRyc4wACgSsEsbEBvBb3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIam8w4n7DqQ9g1HXmZ_3RSTBO8fEnRwqezuF_M0avAl4N0Y3CC8FqDdWRwgvBchXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-28_04-18-43__5d9000d6-99b0-4ab2-bc98-c2ddc0ad24f2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.82.176
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['39022', '39023', '39024', '39025', '39026']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 39022:39022 -p 39023:39023 -p 39024:39024 -p 39025:39025 -p 39026:39026 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39024 --rest-port=39022 --tcp-port=39023 --discv5-udp-port=39025 --rest-address=0.0.0.0 --nat=extip:172.18.82.176 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5f01bdec20ed16faf79cf495623b1bd8cee133934bd661d1fc1c9dcf5e135c8a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39026 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.82.176 waku 30eec5390c667174cb2de44ed6087e2c58dd2feca62767d50e842ffc7c880396
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 30eec5390c66. Setting up logs at ./log/docker/receiving_node2_2024-09-28_04-18-43__5d9000d6-99b0-4ab2-bc98-c2ddc0ad24f2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 39022
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39022/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39022/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.82.176/tcp/39023/p2p/16Uiu2HAm5zN5mzXshEUG2wMZ4Ess52D2EBL63McvA2E5UqaEA5aB","/ip4/172.18.82.176/tcp/39024/ws/p2p/16Uiu2HAm5zN5mzXshEUG2wMZ4Ess52D2EBL63McvA2E5UqaEA5aB"],"enrUri":"enr:-LO4QFKAoxg7C6LWwIvKxdx6w40cuz0p98VgSjWNuvb_9iG2AFubUPAJ9Kknu-xLd3gWC1a6nxkyg8z2IU-m-tFcWdoBgmlkgnY0gmlwhKwSUrCKbXVsdGlhZGRyc4wACgSsElKwBphw3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKc9MzIow-X6U7W98VN8nuXaNrbFS40caG5SEEra8fUbIN0Y3CCmG-DdWRwgphxhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39022/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.198.196/tcp/61530/p2p/16Uiu2HAkwDYNKjHasgeyNLdmE2tCPaabzgm18XhCwrr7g78Y4JG6"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-28_04-18-43__5d9000d6-99b0-4ab2-bc98-c2ddc0ad24f2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.102.154
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['18229', '18230', '18231', '18232', '18233']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 18229:18229 -p 18230:18230 -p 18231:18231 -p 18232:18232 -p 18233:18233 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18231 --rest-port=18229 --tcp-port=18230 --discv5-udp-port=18232 --rest-address=0.0.0.0 --nat=extip:172.18.102.154 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=faff0e7c3c9de27db356e266a7a43a3fa0d1e9f8ffd3dbfb95bfbcaa156c8cd7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18233 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QOmo7VaXRusCiJBf6GHpbt8brTPlMgelLqS5a5IjVYlpNDM8ke-p3zTYNgzPj27ZePtco6vKG5WoEjum0Oty6fcBgmlkgnY0gmlwhKwSxsSKbXVsdGlhZGRyc4wACgSsEsbEBvBb3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIam8w4n7DqQ9g1HXmZ_3RSTBO8fEnRwqezuF_M0avAl4N0Y3CC8FqDdWRwgvBchXdha3UyCQ --lightpushnode=/ip4/172.18.198.196/tcp/61530/p2p/16Uiu2HAkwDYNKjHasgeyNLdmE2tCPaabzgm18XhCwrr7g78Y4JG6 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.102.154 waku 30c201be8ead991cc943ba26fc40d1e05f0bc4946a86a345ca9e4eebc27853a1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 30c201be8ead. Setting up logs at ./log/docker/lightpush_node1_2024-09-28_04-18-43__5d9000d6-99b0-4ab2-bc98-c2ddc0ad24f2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 18229
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18229/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18229/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.102.154/tcp/18230/p2p/16Uiu2HAmD2tLwMLpfMEFkW854rDkJ16FGLuyDDiNDBwPAwUUZKTZ","/ip4/172.18.102.154/tcp/18231/ws/p2p/16Uiu2HAmD2tLwMLpfMEFkW854rDkJ16FGLuyDDiNDBwPAwUUZKTZ"],"enrUri":"enr:-LO4QOVoLm3bUkJtU0sGNutKpfUOiTx8ctqiY-fKwEVj2tyRBcNK2RPTCbEJDSBIoCqq6M46q6yrQRk3ty51mT5glxIBgmlkgnY0gmlwhKwSZpqKbXVsdGlhZGRyc4wACgSsEmaaBkc33QOCcnOFAAMBAACJc2VjcDI1NmsxoQMFm_yZb5K6aC_0bM5FdI8yt43sUqH8gwTc8jAdTjj6HIN0Y3CCRzaDdWRwgkc4hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18229/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.198.196/tcp/61530/p2p/16Uiu2HAkwDYNKjHasgeyNLdmE2tCPaabzgm18XhCwrr7g78Y4JG6"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18229/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.82.176/tcp/39023/p2p/16Uiu2HAm5zN5mzXshEUG2wMZ4Ess52D2EBL63McvA2E5UqaEA5aB"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61529/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39022/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18229/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1727497128720136704, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61529/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727497128720136704,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39022/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727497128720136704,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18229/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1727497128848196096, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61529/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727497128848196096,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39022/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727497128848196096,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7c97440e60aa
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 30eec5390c66
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 30c201be8ead
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.