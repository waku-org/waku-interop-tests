[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-12-05_08-10-20__893444bb-da11-435d-aab6-f1995e26e4b2
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-12-05_08-10-20__893444bb-da11-435d-aab6-f1995e26e4b2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.32.66
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29843', '29844', '29845', '29846', '29847']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29843:29843 -p 29844:29844 -p 29845:29845 -p 29846:29846 -p 29847:29847 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29845 --rest-port=29843 --tcp-port=29844 --discv5-udp-port=29846 --rest-address=0.0.0.0 --nat=extip:172.18.32.66 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=27c9e535ea81bacaaa39eef6c4b25dafed616e3dba3dab67c24deee78cbef782 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29847 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.32.66 waku a23a2775879914f6b69eb88e57f7bc10e8386dbd86441c8be7cadeb56230209a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a23a27758799. Setting up logs at ./log/docker/receiving_node1_2024-12-05_08-10-20__893444bb-da11-435d-aab6-f1995e26e4b2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 29843
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f10ed28f95ce. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29843/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29843/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.32.66/tcp/29844/p2p/16Uiu2HAkzTNa5bk3iQLkZoTDfB5JEKGCEyTrgvnGjbHqdRFUHxys","/ip4/172.18.32.66/tcp/29845/ws/p2p/16Uiu2HAkzTNa5bk3iQLkZoTDfB5JEKGCEyTrgvnGjbHqdRFUHxys"],"enrUri":"enr:-L24QAfObQLmXu8uNrGSXmwlhw8RbCFVEUvaFdJRciaAMqAcUoywYoDxpMY7eUhGcyjMvpfBO_AMZGsJAR3l13cumWsCgmlkgnY0gmlwhKwSIEKKbXVsdGlhZGRyc5YACASsEiBCBnSUAAoErBIgQgZ0ld0DgnJzhQADAQAAiXNlY3AyNTZrMaECSrnpeLmaNrBInlN31PxI1hMRD1P4lnuh7pn7911UOY6DdGNwgnSUg3VkcIJ0loV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-12-05_08-10-20__893444bb-da11-435d-aab6-f1995e26e4b2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.233.68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['48135', '48136', '48137', '48138', '48139']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 48135:48135 -p 48136:48136 -p 48137:48137 -p 48138:48138 -p 48139:48139 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48137 --rest-port=48135 --tcp-port=48136 --discv5-udp-port=48138 --rest-address=0.0.0.0 --nat=extip:172.18.233.68 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0efff5aeaff65efa2ab2cfffad44128e1be55cdbcc1f7daa62ebce68bd2f2e48 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48139 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.233.68 waku d01ae4d2bae877c330f42db56a81785be3386b9606bed050e7d4173097f234bb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d01ae4d2bae8. Setting up logs at ./log/docker/receiving_node2_2024-12-05_08-10-20__893444bb-da11-435d-aab6-f1995e26e4b2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 48135
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48135/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48135/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.233.68/tcp/48136/p2p/16Uiu2HAmJBuwG7h2m7Q2xuVNZxPByjnCDPZHDuVghTZWSLxixREy","/ip4/172.18.233.68/tcp/48137/ws/p2p/16Uiu2HAmJBuwG7h2m7Q2xuVNZxPByjnCDPZHDuVghTZWSLxixREy"],"enrUri":"enr:-L24QNwrxrrgaUOjlBhnpvMzwuvOc8nHUfriP-Iuq-CoaKgtULsvhGC_XSxsLuBPtohDgv5zYPbcRmo_diSBQu76maACgmlkgnY0gmlwhKwS6USKbXVsdGlhZGRyc5YACASsEulEBrwIAAoErBLpRAa8Cd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDUjZyzrZk5ZhuakquU7w7qnP0dMSRlzqk1gUCGdgHDFKDdGNwgrwIg3VkcIK8CoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48135/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.32.66/tcp/29844/p2p/16Uiu2HAkzTNa5bk3iQLkZoTDfB5JEKGCEyTrgvnGjbHqdRFUHxys"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-12-05_08-10-20__893444bb-da11-435d-aab6-f1995e26e4b2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.204.62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['6763', '6764', '6765', '6766', '6767']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 6763:6763 -p 6764:6764 -p 6765:6765 -p 6766:6766 -p 6767:6767 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6765 --rest-port=6763 --tcp-port=6764 --discv5-udp-port=6766 --rest-address=0.0.0.0 --nat=extip:172.18.204.62 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=95e4efaeaaa43cbceefec3238d2d44db0dbd1b2384f11fcf18bd17dbfc1be3eb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6767 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QAfObQLmXu8uNrGSXmwlhw8RbCFVEUvaFdJRciaAMqAcUoywYoDxpMY7eUhGcyjMvpfBO_AMZGsJAR3l13cumWsCgmlkgnY0gmlwhKwSIEKKbXVsdGlhZGRyc5YACASsEiBCBnSUAAoErBIgQgZ0ld0DgnJzhQADAQAAiXNlY3AyNTZrMaECSrnpeLmaNrBInlN31PxI1hMRD1P4lnuh7pn7911UOY6DdGNwgnSUg3VkcIJ0loV3YWt1Mgk --lightpushnode=/ip4/172.18.32.66/tcp/29844/p2p/16Uiu2HAkzTNa5bk3iQLkZoTDfB5JEKGCEyTrgvnGjbHqdRFUHxys --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.204.62 waku 9b19b94f10e7563a0307bf2b78b8f198d4a1ae8302b61af334fa278feb7834d4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9b19b94f10e7. Setting up logs at ./log/docker/lightpush_node1_2024-12-05_08-10-20__893444bb-da11-435d-aab6-f1995e26e4b2__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 6763
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6763/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6763/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.204.62/tcp/6764/p2p/16Uiu2HAkwp4nKHBmL15uHnQuLyPmZtQZ6u2ccM5W7MrUVx1J9eqJ","/ip4/172.18.204.62/tcp/6765/ws/p2p/16Uiu2HAkwp4nKHBmL15uHnQuLyPmZtQZ6u2ccM5W7MrUVx1J9eqJ"],"enrUri":"enr:-L24QHiSs9xRt6OvPlCDHrhyloO8O3Nyf47rhUVsTX8YC-p2I-Y2qw5PL0M26y-X9enxjGGAV4p3Wm623WLDGJFVpyMCgmlkgnY0gmlwhKwSzD6KbXVsdGlhZGRyc5YACASsEsw-BhpsAAoErBLMPgYabd0DgnJzhQADAQAAiXNlY3AyNTZrMaECI3PvH_wpOToL8lx7uz7DZYO0bIfn0KVlAkmTxXUNAzWDdGNwghpsg3VkcIIaboV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6763/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.32.66/tcp/29844/p2p/16Uiu2HAkzTNa5bk3iQLkZoTDfB5JEKGCEyTrgvnGjbHqdRFUHxys"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6763/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.233.68/tcp/48136/p2p/16Uiu2HAmJBuwG7h2m7Q2xuVNZxPByjnCDPZHDuVghTZWSLxixREy"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29843/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48135/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6763/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1733386225035517696, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29843/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1733386225035517696,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48135/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1733386225035517696,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6763/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1733386225158036224, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29843/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1733386225158036224,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48135/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1733386225158036224,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id a23a27758799
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d01ae4d2bae8
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a23a27758799. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 9b19b94f10e7
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d01ae4d2bae8. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.