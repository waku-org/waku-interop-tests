[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2024-12-12_08-24-08__b335aaf0-4e6f-43b6-8f2f-269a60be041c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-12_08-24-08__b335aaf0-4e6f-43b6-8f2f-269a60be041c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-12_08-24-08__b335aaf0-4e6f-43b6-8f2f-269a60be041c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-12-12_08-24-08__b335aaf0-4e6f-43b6-8f2f-269a60be041c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:388 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.23.161
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['11301', '11302', '11303', '11304', '11305']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 11301:11301 -p 11302:11302 -p 11303:11303 -p 11304:11304 -p 11305:11305 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11303 --rest-port=11301 --tcp-port=11302 --discv5-udp-port=11304 --rest-address=0.0.0.0 --nat=extip:172.18.23.161 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=69efb5b7b1fb1afaa6ef52cea705f6ec40a37caee87faa13db6c3a1aceaace5d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11305 --metrics-logging=true --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.23.161 waku 39d412ec9a6723a4b01c6b78203a519cc43034952a3ab08fa1e1d9fa7b0b047f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 39d412ec9a67. Setting up logs at ./log/docker/node1_2024-12-12_08-24-08__b335aaf0-4e6f-43b6-8f2f-269a60be041c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 11301
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container e7fe360921eb. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11301/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11301/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.23.161/tcp/11302/p2p/16Uiu2HAmFwEH7LGL5NxkdFYEb4SQQvVGLLgyCe2b7LqTiSgDRBWk","/ip4/172.18.23.161/tcp/11303/ws/p2p/16Uiu2HAmFwEH7LGL5NxkdFYEb4SQQvVGLLgyCe2b7LqTiSgDRBWk"],"enrUri":"enr:-L24QHAOf9kPaJ8dbauIyGWlMZh7zU8h-7VjHIYqvuxpj8S2DvO_rd0zO1V8s7OCsPZeh4_O0Rc-FDUtFHtposD1vVACgmlkgnY0gmlwhKwSF6GKbXVsdGlhZGRyc5YACASsEhehBiwmAAoErBIXoQYsJ90DgnJzhQADAQAAiXNlY3AyNTZrMaEDMLwaInX9i_MR3r_onwewQCR5wkC8j-fXR6ew02RwJsWDdGNwgiwmg3VkcIIsKIV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.245.6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['37052', '37053', '37054', '37055', '37056']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 37052:37052 -p 37053:37053 -p 37054:37054 -p 37055:37055 -p 37056:37056 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37054 --rest-port=37052 --tcp-port=37053 --discv5-udp-port=37055 --rest-address=0.0.0.0 --nat=extip:172.18.245.6 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b8a78a6887ba9d49e10d17a2ef3bf35888806d59f46b9e8ac1d3c4a6df4142c4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37056 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QHAOf9kPaJ8dbauIyGWlMZh7zU8h-7VjHIYqvuxpj8S2DvO_rd0zO1V8s7OCsPZeh4_O0Rc-FDUtFHtposD1vVACgmlkgnY0gmlwhKwSF6GKbXVsdGlhZGRyc5YACASsEhehBiwmAAoErBIXoQYsJ90DgnJzhQADAQAAiXNlY3AyNTZrMaEDMLwaInX9i_MR3r_onwewQCR5wkC8j-fXR6ew02RwJsWDdGNwgiwmg3VkcIIsKIV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.245.6 waku 7fb33f62b4bed115cbbd88d2c063172b86fdcb44856944204bd7880002473b96
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 7fb33f62b4be. Setting up logs at ./log/docker/node2_2024-12-12_08-24-08__b335aaf0-4e6f-43b6-8f2f-269a60be041c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 37052
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37052/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37052/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.245.6/tcp/37053/p2p/16Uiu2HAmCJshhJ7b6GA1K5ZpqbmAKBGkRMcM9WkYUvJ9K7wANNMk","/ip4/172.18.245.6/tcp/37054/ws/p2p/16Uiu2HAmCJshhJ7b6GA1K5ZpqbmAKBGkRMcM9WkYUvJ9K7wANNMk"],"enrUri":"enr:-L24QILhWWiNZVhR89hLlrq_nEodhUMIcLCVnbGg1Q7JPj_tWDqyyrVOD1VkQme1VROPZCbN_OMzhRQ29DA5OU_SXesCgmlkgnY0gmlwhKwS9QaKbXVsdGlhZGRyc5YACASsEvUGBpC9AAoErBL1BgaQvt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-tjd4AnKCZjDLP9ulrv7hb2o6z6xatxnmSKOy02fQ7-DdGNwgpC9g3VkcIKQv4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.173.111
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3986', '3987', '3988', '3989', '3990']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3986:3986 -p 3987:3987 -p 3988:3988 -p 3989:3989 -p 3990:3990 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3988 --rest-port=3986 --tcp-port=3987 --discv5-udp-port=3989 --rest-address=0.0.0.0 --nat=extip:172.18.173.111 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c15cd7ed2dc4e2e9807bd2efdbeaf7cfbab0592231f367d7db7770dba16d6c4c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3990 --metrics-logging=true --relay=false --storenode=/ip4/172.18.245.6/tcp/37053/p2p/16Uiu2HAmCJshhJ7b6GA1K5ZpqbmAKBGkRMcM9WkYUvJ9K7wANNMk --discv5-bootstrap-node=enr:-L24QILhWWiNZVhR89hLlrq_nEodhUMIcLCVnbGg1Q7JPj_tWDqyyrVOD1VkQme1VROPZCbN_OMzhRQ29DA5OU_SXesCgmlkgnY0gmlwhKwS9QaKbXVsdGlhZGRyc5YACASsEvUGBpC9AAoErBL1BgaQvt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-tjd4AnKCZjDLP9ulrv7hb2o6z6xatxnmSKOy02fQ7-DdGNwgpC9g3VkcIKQv4V3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.173.111 waku 18ac04909a63da559efd5e61d29ec939ef52df7018bfc982bcc7ac15887450fa
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 18ac04909a63. Setting up logs at ./log/docker/node3_2024-12-12_08-24-08__b335aaf0-4e6f-43b6-8f2f-269a60be041c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 3986
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3986/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3986/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.173.111/tcp/3987/p2p/16Uiu2HAm226Su3HobLYUZHiCGRFSGbQaMqNjsKLbzW29ACPJnwv7","/ip4/172.18.173.111/tcp/3988/ws/p2p/16Uiu2HAm226Su3HobLYUZHiCGRFSGbQaMqNjsKLbzW29ACPJnwv7"],"enrUri":"enr:-L24QN4L748thzv_RjlSu70MAoEoltaPamS08SzfjUv_GixyMGcHFAXgMAPcu-Br1qAOE5_FuC_FQPQv881qrg-wbS4CgmlkgnY0gmlwhKwSrW-KbXVsdGlhZGRyc5YACASsEq1vBg-TAAoErBKtbwYPlN0DgnJzhQADAQAAiXNlY3AyNTZrMaECYfeIy1xTjFxLHY17IaH-ti7Rh1JhGfjM1kC_q_RUBbiDdGNwgg-Tg3VkcIIPlYV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:393 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11301/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37052/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11301/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.245.6/tcp/37053/p2p/16Uiu2HAmCJshhJ7b6GA1K5ZpqbmAKBGkRMcM9WkYUvJ9K7wANNMk","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37052/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.23.161/tcp/11302/p2p/16Uiu2HAmFwEH7LGL5NxkdFYEb4SQQvVGLLgyCe2b7LqTiSgDRBWk","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:398 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11301/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:403 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3986/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"9136fa3f15e5798e72d2","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:407 Response for store when ephemeral = true is strPeer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '9136fa3f15e5798e72d2', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:409 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 39d412ec9a67
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 7fb33f62b4be
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 39d412ec9a67. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 18ac04909a63
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 7fb33f62b4be. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.