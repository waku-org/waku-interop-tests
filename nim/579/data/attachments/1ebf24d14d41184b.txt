[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-12-26_04-13-09__b1a0af10-3abc-4274-b3b2-78817232889d
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-12-26_04-13-09__b1a0af10-3abc-4274-b3b2-78817232889d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.218.32
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['33570', '33571', '33572', '33573', '33574']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 33570:33570 -p 33571:33571 -p 33572:33572 -p 33573:33573 -p 33574:33574 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33572 --rest-port=33570 --tcp-port=33571 --discv5-udp-port=33573 --rest-address=0.0.0.0 --nat=extip:172.18.218.32 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5039db8346cfcffcf3fa5c713f254fed8a391f7bcae19cbe42f11fdeb92896d0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33574 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.218.32 waku 6b6fefaed532f69a337288a94ba9509acfa40bce4665d93c9048666af536d5b8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 6b6fefaed532. Setting up logs at ./log/docker/receiving_node1_2024-12-26_04-13-09__b1a0af10-3abc-4274-b3b2-78817232889d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 33570
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container e03ba8860319. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33570/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33570/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.218.32/tcp/33571/p2p/16Uiu2HAmUVUnLRP3emSs2mFughudSypS5E38r2hTz1qkdgwPy4Pw","/ip4/172.18.218.32/tcp/33572/ws/p2p/16Uiu2HAmUVUnLRP3emSs2mFughudSypS5E38r2hTz1qkdgwPy4Pw"],"enrUri":"enr:-L24QGRocz8Hc0nrKy5JfjiLEIznQgquykro0BL77AYuZPkqfgW4CoLv2SzIns42TFCPfTQXKjhvIvPZQ1b27VIOWFUCgmlkgnY0gmlwhKwS2iCKbXVsdGlhZGRyc5YACASsEtogBoMjAAoErBLaIAaDJN0DgnJzhQADAQAAiXNlY3AyNTZrMaED60tUqIVKdfmiIb2WCgK4Sby790ukm60LdOomwPRnFT6DdGNwgoMjg3VkcIKDJYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-12-26_04-13-09__b1a0af10-3abc-4274-b3b2-78817232889d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.208.31
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['41350', '41351', '41352', '41353', '41354']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 41350:41350 -p 41351:41351 -p 41352:41352 -p 41353:41353 -p 41354:41354 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=41352 --rest-port=41350 --tcp-port=41351 --discv5-udp-port=41353 --rest-address=0.0.0.0 --nat=extip:172.18.208.31 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c7dd5cd13ef6ebb66a627d5e70f888a6ce0e1fe4ceb5f3bc9ea3cbf30dcda9f2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=41354 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.208.31 waku ecc9bad532834febdde863849873fa2cacb12e547d6783395e1ca6342493f281
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ecc9bad53283. Setting up logs at ./log/docker/receiving_node2_2024-12-26_04-13-09__b1a0af10-3abc-4274-b3b2-78817232889d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 41350
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41350/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41350/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.208.31/tcp/41351/p2p/16Uiu2HAm1sbuwKH6veBeb5ZvHTHsthf6Lrvh7idzW1WEcLbFNXTn","/ip4/172.18.208.31/tcp/41352/ws/p2p/16Uiu2HAm1sbuwKH6veBeb5ZvHTHsthf6Lrvh7idzW1WEcLbFNXTn"],"enrUri":"enr:-L24QLjFwMlSytgwnaCjB04d6c0LP3mwmimYJZB0nw6YSbMtPi0EzGozaiN_X2P6ZxUq2-vRTtKn4Vm_N7WsJUwm-w0CgmlkgnY0gmlwhKwS0B-KbXVsdGlhZGRyc5YACASsEtAfBqGHAAoErBLQHwahiN0DgnJzhQADAQAAiXNlY3AyNTZrMaECX8qf5fhLnbfHGUXicOGbyZkA0mOvDvoo4xv_OP38qPGDdGNwgqGHg3VkcIKhiYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41350/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.218.32/tcp/33571/p2p/16Uiu2HAmUVUnLRP3emSs2mFughudSypS5E38r2hTz1qkdgwPy4Pw"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-12-26_04-13-09__b1a0af10-3abc-4274-b3b2-78817232889d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.210.14
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['58478', '58479', '58480', '58481', '58482']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 58478:58478 -p 58479:58479 -p 58480:58480 -p 58481:58481 -p 58482:58482 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58480 --rest-port=58478 --tcp-port=58479 --discv5-udp-port=58481 --rest-address=0.0.0.0 --nat=extip:172.18.210.14 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7aec77f09cfba0cf1dfeed8c65add17feaaef17cf7c0cf98e1bc3dc2b5d7da3e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58482 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QGRocz8Hc0nrKy5JfjiLEIznQgquykro0BL77AYuZPkqfgW4CoLv2SzIns42TFCPfTQXKjhvIvPZQ1b27VIOWFUCgmlkgnY0gmlwhKwS2iCKbXVsdGlhZGRyc5YACASsEtogBoMjAAoErBLaIAaDJN0DgnJzhQADAQAAiXNlY3AyNTZrMaED60tUqIVKdfmiIb2WCgK4Sby790ukm60LdOomwPRnFT6DdGNwgoMjg3VkcIKDJYV3YWt1Mgk --lightpushnode=/ip4/172.18.218.32/tcp/33571/p2p/16Uiu2HAmUVUnLRP3emSs2mFughudSypS5E38r2hTz1qkdgwPy4Pw --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.210.14 waku e05b4f9099ed95e67d374d15de4974c010766af8b3c7b6306b4b7ad1a32bfc01
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID e05b4f9099ed. Setting up logs at ./log/docker/lightpush_node1_2024-12-26_04-13-09__b1a0af10-3abc-4274-b3b2-78817232889d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 58478
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58478/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:58478/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.210.14/tcp/58479/p2p/16Uiu2HAkxEVuqUZ4VLDBpgpeyH6qCQYkjMPLHmBykptaatmomri4","/ip4/172.18.210.14/tcp/58480/ws/p2p/16Uiu2HAkxEVuqUZ4VLDBpgpeyH6qCQYkjMPLHmBykptaatmomri4"],"enrUri":"enr:-L24QGEJroGurVRCrTeOgMjuvad0hDSg1VdP27RduJVE0dmSSVLZ-iWomMUP6MzEeDjiRIC2ie5gfnnpMR4qE8rOUDMCgmlkgnY0gmlwhKwS0g6KbXVsdGlhZGRyc5YACASsEtIOBuRvAAoErBLSDgbkcN0DgnJzhQADAQAAiXNlY3AyNTZrMaECKbZJpu3jgIerNQTBMmcA223PYSTkVnccJn2aVYDVGLGDdGNwguRvg3VkcILkcYV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58478/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.218.32/tcp/33571/p2p/16Uiu2HAmUVUnLRP3emSs2mFughudSypS5E38r2hTz1qkdgwPy4Pw"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58478/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.208.31/tcp/41351/p2p/16Uiu2HAm1sbuwKH6veBeb5ZvHTHsthf6Lrvh7idzW1WEcLbFNXTn"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33570/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41350/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58478/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1735186393913405184}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33570/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1735186393913405184,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41350/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1735186393913405184,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:58478/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1735186393913405184}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:58478/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 6b6fefaed532
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id ecc9bad53283
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 6b6fefaed532. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id e05b4f9099ed
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ecc9bad53283. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.