[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_neither_relay_nor_store with id: 2024-05-01_04-21-48__c9449ef0-f8ff-48d8-8a44-4024219363b0
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-01_04-21-48__c9449ef0-f8ff-48d8-8a44-4024219363b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.79.163
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['31096', '31097', '31098', '31099', '31100']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 31096:31096 -p 31097:31097 -p 31098:31098 -p 31099:31099 -p 31100:31100 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31098 --rest-port=31096 --tcp-port=31097 --discv5-udp-port=31099 --rest-address=0.0.0.0 --nat=extip:172.18.79.163 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31100 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.79.163 waku 7c4f4ccd2d142d90bbf449c6f3f107c7e2b3c27a43d6139e12b15983de1f4530
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 7c4f4ccd2d14. Setting up logs at ./log/docker/publishing_node1_2024-05-01_04-21-48__c9449ef0-f8ff-48d8-8a44-4024219363b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 31096
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31096/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.79.163/tcp/31097/p2p/16Uiu2HAm1ux9DNhznWpvzxyX6jTW258c19wToMqWECFY8oUG74u8","/ip4/172.18.79.163/tcp/31098/ws/p2p/16Uiu2HAm1ux9DNhznWpvzxyX6jTW258c19wToMqWECFY8oUG74u8"],"enrUri":"enr:-LO4QMktvXiYkuM7Bjw3ojCtPOjIlLJ4O53vRiHeiC6RnzL3TopW3KsArf6jFXp5WXB3pWaiUaujDNVwJjUFwnmQw7cBgmlkgnY0gmlwhKwST6OKbXVsdGlhZGRyc4wACgSsEk-jBnl63QOCcnOFAAABAACJc2VjcDI1NmsxoQJgZKi8YGHNVKhNAZIAeyKUht2LPBBcFROcXMefgaxz-4N0Y3CCeXmDdWRwgnl7hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-01_04-21-48__c9449ef0-f8ff-48d8-8a44-4024219363b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.250.111
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['39182', '39183', '39184', '39185', '39186']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 39182:39182 -p 39183:39183 -p 39184:39184 -p 39185:39185 -p 39186:39186 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39184 --rest-port=39182 --tcp-port=39183 --discv5-udp-port=39185 --rest-address=0.0.0.0 --nat=extip:172.18.250.111 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39186 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QMktvXiYkuM7Bjw3ojCtPOjIlLJ4O53vRiHeiC6RnzL3TopW3KsArf6jFXp5WXB3pWaiUaujDNVwJjUFwnmQw7cBgmlkgnY0gmlwhKwST6OKbXVsdGlhZGRyc4wACgSsEk-jBnl63QOCcnOFAAABAACJc2VjcDI1NmsxoQJgZKi8YGHNVKhNAZIAeyKUht2LPBBcFROcXMefgaxz-4N0Y3CCeXmDdWRwgnl7hXdha3UyAw --storenode=/ip4/172.18.79.163/tcp/31097/p2p/16Uiu2HAm1ux9DNhznWpvzxyX6jTW258c19wToMqWECFY8oUG74u8 --store=false --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.250.111 waku 8098e6a78475edeec22f3aacd168f7addcdecd8198f2a75f5a8531b942d33270
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 8098e6a78475. Setting up logs at ./log/docker/store_node1_2024-05-01_04-21-48__c9449ef0-f8ff-48d8-8a44-4024219363b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 39182
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39182/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.250.111/tcp/39183/p2p/16Uiu2HAmVinS4ZcgMubexURzgeW9jhM6kn2zFzkRBLWLKVscVeGx","/ip4/172.18.250.111/tcp/39184/ws/p2p/16Uiu2HAmVinS4ZcgMubexURzgeW9jhM6kn2zFzkRBLWLKVscVeGx"],"enrUri":"enr:-LO4QFI79WorfRLIlN9WAU3JXih30ybXhYbyE94ZIfbxdDrcEV2u4NAo4CrbHNQ09ZLSRdUx0hQunuJwuuvI4cueYWABgmlkgnY0gmlwhKwS-m-KbXVsdGlhZGRyc4wACgSsEvpvBpkQ3QOCcnOFAAABAACJc2VjcDI1NmsxoQP9j4aMQfhXBy0eGa2ys1R-OogYy10er8qkz840S7-1oYN0Y3CCmQ-DdWRwgpkRhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39182/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.79.163/tcp/31097/p2p/16Uiu2HAm1ux9DNhznWpvzxyX6jTW258c19wToMqWECFY8oUG74u8"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31096/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31096/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31096/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714537312189250304,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 7c4f4ccd2d14
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 8098e6a78475
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-01_04-21-48__c9449ef0-f8ff-48d8-8a44-4024219363b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-01_04-21-48__c9449ef0-f8ff-48d8-8a44-4024219363b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_neither_relay_nor_store with id: 2024-05-01_04-21-56__13b3df46-b483-4a47-bd07-943146236d7d
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-01_04-21-56__13b3df46-b483-4a47-bd07-943146236d7d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.145.221
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['46327', '46328', '46329', '46330', '46331']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 46327:46327 -p 46328:46328 -p 46329:46329 -p 46330:46330 -p 46331:46331 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46329 --rest-port=46327 --tcp-port=46328 --discv5-udp-port=46330 --rest-address=0.0.0.0 --nat=extip:172.18.145.221 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46331 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.145.221 waku 309f1013e6dece7fc6e3525c4cc64b88fe25767dafca1a8b8913989c91ba7c3d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 309f1013e6de. Setting up logs at ./log/docker/publishing_node1_2024-05-01_04-21-56__13b3df46-b483-4a47-bd07-943146236d7d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 46327
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46327/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.145.221/tcp/46328/p2p/16Uiu2HAkwuyHRTT7Q9KQvVddhW4tat3uiqFBL7q4T515XZQRTB6x","/ip4/172.18.145.221/tcp/46329/ws/p2p/16Uiu2HAkwuyHRTT7Q9KQvVddhW4tat3uiqFBL7q4T515XZQRTB6x"],"enrUri":"enr:-LO4QMxyNtK1kpf6H5GQr8ozfX38qDu3qcfkLJDtkRD9dS3PIS6rbefLS8MkiEHnk50EytbZNlMRCIbtbYh76f1azJoBgmlkgnY0gmlwhKwSkd2KbXVsdGlhZGRyc4wACgSsEpHdBrT53QOCcnOFAAABAACJc2VjcDI1NmsxoQIk9zO_nnfo_Fec_6VK9N19GBlAVgcJ9Vd0w-VUlWYOsYN0Y3CCtPiDdWRwgrT6hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-01_04-21-56__13b3df46-b483-4a47-bd07-943146236d7d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.65.10
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['39360', '39361', '39362', '39363', '39364']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 39360:39360 -p 39361:39361 -p 39362:39362 -p 39363:39363 -p 39364:39364 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39362 --rest-port=39360 --tcp-port=39361 --discv5-udp-port=39363 --rest-address=0.0.0.0 --nat=extip:172.18.65.10 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39364 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QMxyNtK1kpf6H5GQr8ozfX38qDu3qcfkLJDtkRD9dS3PIS6rbefLS8MkiEHnk50EytbZNlMRCIbtbYh76f1azJoBgmlkgnY0gmlwhKwSkd2KbXVsdGlhZGRyc4wACgSsEpHdBrT53QOCcnOFAAABAACJc2VjcDI1NmsxoQIk9zO_nnfo_Fec_6VK9N19GBlAVgcJ9Vd0w-VUlWYOsYN0Y3CCtPiDdWRwgrT6hXdha3UyAw --storenode=/ip4/172.18.145.221/tcp/46328/p2p/16Uiu2HAkwuyHRTT7Q9KQvVddhW4tat3uiqFBL7q4T515XZQRTB6x --store=false --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.65.10 waku 35d26d0fca051ecefd4ebce620e2b680d9bfe91769fc4efeddd3800c5ffca26a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 35d26d0fca05. Setting up logs at ./log/docker/store_node1_2024-05-01_04-21-56__13b3df46-b483-4a47-bd07-943146236d7d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 39360
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39360/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.65.10/tcp/39361/p2p/16Uiu2HAmUkdiC2eVKhiXE3mkSS6ocWvhEYHGKzPy9B1uJwmWv6hD","/ip4/172.18.65.10/tcp/39362/ws/p2p/16Uiu2HAmUkdiC2eVKhiXE3mkSS6ocWvhEYHGKzPy9B1uJwmWv6hD"],"enrUri":"enr:-LO4QBaFWJS4Acc4ZYkhKuyrdqaZGDmb-ezZhu7f_hNURW-PSrC1pxeClGwx1MfsL4_Y13s0V-4AJW3sUUIyac66S0cBgmlkgnY0gmlwhKwSQQqKbXVsdGlhZGRyc4wACgSsEkEKBpnC3QOCcnOFAAABAACJc2VjcDI1NmsxoQPvLSNr3wsNbJCKwPa58ysN7mRkefNUYEOMW-xTEmgnaIN0Y3CCmcGDdWRwgpnDhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39360/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.145.221/tcp/46328/p2p/16Uiu2HAkwuyHRTT7Q9KQvVddhW4tat3uiqFBL7q4T515XZQRTB6x"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46327/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46327/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46327/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714537320083303936,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 309f1013e6de
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 35d26d0fca05
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-01_04-21-56__13b3df46-b483-4a47-bd07-943146236d7d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-01_04-21-56__13b3df46-b483-4a47-bd07-943146236d7d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_neither_relay_nor_store with id: 2024-05-01_04-22-04__ea2f0046-3cdf-47cc-8ffb-542baccf9dc7
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-01_04-22-04__ea2f0046-3cdf-47cc-8ffb-542baccf9dc7__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.197.15
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['47963', '47964', '47965', '47966', '47967']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 47963:47963 -p 47964:47964 -p 47965:47965 -p 47966:47966 -p 47967:47967 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47965 --rest-port=47963 --tcp-port=47964 --discv5-udp-port=47966 --rest-address=0.0.0.0 --nat=extip:172.18.197.15 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47967 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.197.15 waku 381a46199f33ce500436ce52830ee5e421eca2c80a07fa8dc825cfb7e6399ad6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 381a46199f33. Setting up logs at ./log/docker/publishing_node1_2024-05-01_04-22-04__ea2f0046-3cdf-47cc-8ffb-542baccf9dc7__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 47963
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47963/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.197.15/tcp/47964/p2p/16Uiu2HAky8xfj5uKADdM9nok5iB2AxmaYz7FnWMkkAZ1LoHp1Pg2","/ip4/172.18.197.15/tcp/47965/ws/p2p/16Uiu2HAky8xfj5uKADdM9nok5iB2AxmaYz7FnWMkkAZ1LoHp1Pg2"],"enrUri":"enr:-LO4QAVa2qqbLF6FlfDrYjORHMUGZMxG6ZcQBxVl2dYZMPYFR23goiJdzi5i1evc-Pptz_z8H5efDNFgL-lCsEUMe2wBgmlkgnY0gmlwhKwSxQ-KbXVsdGlhZGRyc4wACgSsEsUPBrtd3QOCcnOFAAABAACJc2VjcDI1NmsxoQI3Jr5i34aJnZgxHbstr8F4M0EtUV2Gp9wFzD9xmLd834N0Y3CCu1yDdWRwgrtehXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-01_04-22-04__ea2f0046-3cdf-47cc-8ffb-542baccf9dc7__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.80.59
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['45704', '45705', '45706', '45707', '45708']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 45704:45704 -p 45705:45705 -p 45706:45706 -p 45707:45707 -p 45708:45708 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45706 --rest-port=45704 --tcp-port=45705 --discv5-udp-port=45707 --rest-address=0.0.0.0 --nat=extip:172.18.80.59 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45708 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QAVa2qqbLF6FlfDrYjORHMUGZMxG6ZcQBxVl2dYZMPYFR23goiJdzi5i1evc-Pptz_z8H5efDNFgL-lCsEUMe2wBgmlkgnY0gmlwhKwSxQ-KbXVsdGlhZGRyc4wACgSsEsUPBrtd3QOCcnOFAAABAACJc2VjcDI1NmsxoQI3Jr5i34aJnZgxHbstr8F4M0EtUV2Gp9wFzD9xmLd834N0Y3CCu1yDdWRwgrtehXdha3UyAw --storenode=/ip4/172.18.197.15/tcp/47964/p2p/16Uiu2HAky8xfj5uKADdM9nok5iB2AxmaYz7FnWMkkAZ1LoHp1Pg2 --store=false --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.80.59 waku 2dfdd4329c65098ef85cd625776da279a415b95217da0129194435996876bf7b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 2dfdd4329c65. Setting up logs at ./log/docker/store_node1_2024-05-01_04-22-04__ea2f0046-3cdf-47cc-8ffb-542baccf9dc7__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 45704
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45704/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.80.59/tcp/45705/p2p/16Uiu2HAkvvsypGEg2DAAMki3PChVFV8T3a2K7YFGfYRrPDQubDkr","/ip4/172.18.80.59/tcp/45706/ws/p2p/16Uiu2HAkvvsypGEg2DAAMki3PChVFV8T3a2K7YFGfYRrPDQubDkr"],"enrUri":"enr:-LO4QBW8xfqNGNv0HkHPR2KEHDk8X7rwpn-pKthczL-Y8nNockMivkklbu4G1Q06J0vIlHrnoVbS-cBeRj_238CTx-MBgmlkgnY0gmlwhKwSUDuKbXVsdGlhZGRyc4wACgSsElA7BrKK3QOCcnOFAAABAACJc2VjcDI1NmsxoQIWVxlpbzH_I2vrOffltPS1NwwRF9wCMAljLAX0xYnIj4N0Y3CCsomDdWRwgrKLhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45704/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.197.15/tcp/47964/p2p/16Uiu2HAky8xfj5uKADdM9nok5iB2AxmaYz7FnWMkkAZ1LoHp1Pg2"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47963/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47963/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47963/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714537327652022016,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 381a46199f33
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 2dfdd4329c65
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-01_04-22-04__ea2f0046-3cdf-47cc-8ffb-542baccf9dc7__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-01_04-22-04__ea2f0046-3cdf-47cc-8ffb-542baccf9dc7__harbor.status.im_wakuorg_nwaku:latest.log