[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-10-17_04-11-10__9d50afe8-be81-4f50-add6-45f5313ebdd8
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-10-17_04-11-10__9d50afe8-be81-4f50-add6-45f5313ebdd8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.187.118
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['22326', '22327', '22328', '22329', '22330']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 22326:22326 -p 22327:22327 -p 22328:22328 -p 22329:22329 -p 22330:22330 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22328 --rest-port=22326 --tcp-port=22327 --discv5-udp-port=22329 --rest-address=0.0.0.0 --nat=extip:172.18.187.118 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ae8defb9d6d2d4377bbc4a52411cfd7e3d7c6ccdf579730f131b4e4554d32df7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22330 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.187.118 waku 45d9b457450bc11bf45edc66f2d649e6c429404a04b1fe7e2b617cb1707c0c53
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 45d9b457450b. Setting up logs at ./log/docker/receiving_node1_2024-10-17_04-11-10__9d50afe8-be81-4f50-add6-45f5313ebdd8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22326
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22326/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22326/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.187.118/tcp/22327/p2p/16Uiu2HAkyK2LZXLcESQxDiE3TQxtgTtpGmGB9pAbLR5zkDhS1tne","/ip4/172.18.187.118/tcp/22328/ws/p2p/16Uiu2HAkyK2LZXLcESQxDiE3TQxtgTtpGmGB9pAbLR5zkDhS1tne"],"enrUri":"enr:-LO4QFenblIiEAvjM3Z0SlpFNXL55zVChWEJR_RiO8FpvYRNQZ10g4yg_nAhbcbm5wmcohvcD29q556UvMtdbfRFQMwBgmlkgnY0gmlwhKwSu3aKbXVsdGlhZGRyc4wACgSsErt2Blc43QOCcnOFAAMBAACJc2VjcDI1NmsxoQI5urNzuywkeWdJdBHK30gIU35c88Pj0hYbvl6ysYH3k4N0Y3CCVzeDdWRwglc5hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-10-17_04-11-10__9d50afe8-be81-4f50-add6-45f5313ebdd8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.39.157
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['29879', '29880', '29881', '29882', '29883']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 29879:29879 -p 29880:29880 -p 29881:29881 -p 29882:29882 -p 29883:29883 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29881 --rest-port=29879 --tcp-port=29880 --discv5-udp-port=29882 --rest-address=0.0.0.0 --nat=extip:172.18.39.157 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4aa4a80cea7a18cc0ad1ef00eb501c5dea06fe8d5da36feb4e32a8fb807dcff9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29883 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.39.157 waku 66b3b0b8c305cd43c0524ef76f77b0ab0008122141b974c8d9afd922fff330f3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 66b3b0b8c305. Setting up logs at ./log/docker/receiving_node2_2024-10-17_04-11-10__9d50afe8-be81-4f50-add6-45f5313ebdd8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 29879
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29879/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29879/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.157/tcp/29880/p2p/16Uiu2HAm1zH8fYGKrag6K8c7BUsN4kHF78hHxJmUrEVJ155Pm1C1","/ip4/172.18.39.157/tcp/29881/ws/p2p/16Uiu2HAm1zH8fYGKrag6K8c7BUsN4kHF78hHxJmUrEVJ155Pm1C1"],"enrUri":"enr:-LO4QDih2rrpLBuWrXHDeAhD1ytiDveA2hgugqN1J2bMD5oMdSauFObCLYYYG0P-eB0efKz5vUoeRsy8jnJ-Vg_1egwBgmlkgnY0gmlwhKwSJ52KbXVsdGlhZGRyc4wACgSsEiedBnS53QOCcnOFAAMBAACJc2VjcDI1NmsxoQJhgHR8xAGeZhCwQr9-VsrGVupo-LnM6Qz4gYn9Z51FPoN0Y3CCdLiDdWRwgnS6hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29879/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.187.118/tcp/22327/p2p/16Uiu2HAkyK2LZXLcESQxDiE3TQxtgTtpGmGB9pAbLR5zkDhS1tne"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-10-17_04-11-10__9d50afe8-be81-4f50-add6-45f5313ebdd8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.219.243
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['40609', '40610', '40611', '40612', '40613']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 40609:40609 -p 40610:40610 -p 40611:40611 -p 40612:40612 -p 40613:40613 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40611 --rest-port=40609 --tcp-port=40610 --discv5-udp-port=40612 --rest-address=0.0.0.0 --nat=extip:172.18.219.243 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ff47d34926aec5fac45d9ab963008226c2d4ceca29f5c19dcb7bccd86521bd0f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40613 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QFenblIiEAvjM3Z0SlpFNXL55zVChWEJR_RiO8FpvYRNQZ10g4yg_nAhbcbm5wmcohvcD29q556UvMtdbfRFQMwBgmlkgnY0gmlwhKwSu3aKbXVsdGlhZGRyc4wACgSsErt2Blc43QOCcnOFAAMBAACJc2VjcDI1NmsxoQI5urNzuywkeWdJdBHK30gIU35c88Pj0hYbvl6ysYH3k4N0Y3CCVzeDdWRwglc5hXdha3UyCQ --lightpushnode=/ip4/172.18.187.118/tcp/22327/p2p/16Uiu2HAkyK2LZXLcESQxDiE3TQxtgTtpGmGB9pAbLR5zkDhS1tne --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.219.243 waku 855bbe9f2b828d244c2f32cd93bca5220391bcba1fc167f826626b1c30b82274
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 855bbe9f2b82. Setting up logs at ./log/docker/lightpush_node1_2024-10-17_04-11-10__9d50afe8-be81-4f50-add6-45f5313ebdd8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 40609
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40609/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40609/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.219.243/tcp/40610/p2p/16Uiu2HAm1uBG7mSRXSWeixLTkMKW29MBN1Gf5ry6ur4KTAKZMRNx","/ip4/172.18.219.243/tcp/40611/ws/p2p/16Uiu2HAm1uBG7mSRXSWeixLTkMKW29MBN1Gf5ry6ur4KTAKZMRNx"],"enrUri":"enr:-LO4QB_YMnr6FSGNkz2CJwPhgPJ8-AqsQhIYvxxINJBlqmytfZsaT1dFYp18-DfhpRqrqNV4qWRmywyb7Erp6oHvLagBgmlkgnY0gmlwhKwS2_OKbXVsdGlhZGRyc4wACgSsEtvzBp6j3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJgMel7jBl520cqPTnxkI4oWynN0vdex-F1Ks_WlR6v-YN0Y3CCnqKDdWRwgp6khXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40609/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.187.118/tcp/22327/p2p/16Uiu2HAkyK2LZXLcESQxDiE3TQxtgTtpGmGB9pAbLR5zkDhS1tne"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40609/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.157/tcp/29880/p2p/16Uiu2HAm1zH8fYGKrag6K8c7BUsN4kHF78hHxJmUrEVJ155Pm1C1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22326/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29879/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40609/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1729138276591492864, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22326/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729138276591492864,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29879/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729138276591492864,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40609/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1729138276714497792, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22326/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729138276714497792,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29879/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729138276714497792,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 45d9b457450b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 66b3b0b8c305
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 855bbe9f2b82
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.