[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_refresh_existing with id: 2024-10-17_04-07-13__6a7a0214-86e2-4a74-891e-a0139ae90e85
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-17_04-07-13__6a7a0214-86e2-4a74-891e-a0139ae90e85__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.17.203
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['9047', '9048', '9049', '9050', '9051']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 9047:9047 -p 9048:9048 -p 9049:9049 -p 9050:9050 -p 9051:9051 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9049 --rest-port=9047 --tcp-port=9048 --discv5-udp-port=9050 --rest-address=0.0.0.0 --nat=extip:172.18.17.203 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aea925fb6df6eb3ea7dbdc0d34d0cde8bcb9bbcf3161626dccdbfc7dbd85a4f2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9051 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.17.203 waku 05a8cc2ed36a2ce0b244a325435956eb31789edd750b3cb940284447cc320c5f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 05a8cc2ed36a. Setting up logs at ./log/docker/node1_2024-10-17_04-07-13__6a7a0214-86e2-4a74-891e-a0139ae90e85__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 9047
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9047/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9047/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.17.203/tcp/9048/p2p/16Uiu2HAkvtNkNo8TQeXq8qG89fFWmACbGqghf4fMJZTx11dGYPQ6","/ip4/172.18.17.203/tcp/9049/ws/p2p/16Uiu2HAkvtNkNo8TQeXq8qG89fFWmACbGqghf4fMJZTx11dGYPQ6"],"enrUri":"enr:-LO4QI8p63yzPy5SPlAc9CugqU_hJ1mbpFcGQ7arH7Mhr5MnVjSHCDLV1EVIXmJQ2QmdEfY6CSZZDIkZMQaO3LVRFBsBgmlkgnY0gmlwhKwSEcuKbXVsdGlhZGRyc4wACgSsEhHLBiNZ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIVsuKfqUOh9q1AJixSL_9kY7Q3QMGQInGR2nQ5XTUCm4N0Y3CCI1iDdWRwgiNahXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-17_04-07-13__6a7a0214-86e2-4a74-891e-a0139ae90e85__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.48.83
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['51627', '51628', '51629', '51630', '51631']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 51627:51627 -p 51628:51628 -p 51629:51629 -p 51630:51630 -p 51631:51631 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51629 --rest-port=51627 --tcp-port=51628 --discv5-udp-port=51630 --rest-address=0.0.0.0 --nat=extip:172.18.48.83 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7b6ffe1aec27ff57cac3ec6fc9e80299b7dd26b6bc7cbf818fe4ab507b021df2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51631 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QI8p63yzPy5SPlAc9CugqU_hJ1mbpFcGQ7arH7Mhr5MnVjSHCDLV1EVIXmJQ2QmdEfY6CSZZDIkZMQaO3LVRFBsBgmlkgnY0gmlwhKwSEcuKbXVsdGlhZGRyc4wACgSsEhHLBiNZ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQIVsuKfqUOh9q1AJixSL_9kY7Q3QMGQInGR2nQ5XTUCm4N0Y3CCI1iDdWRwgiNahXdha3UyBQ --filternode=/ip4/172.18.17.203/tcp/9048/p2p/16Uiu2HAkvtNkNo8TQeXq8qG89fFWmACbGqghf4fMJZTx11dGYPQ6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.48.83 waku d21f37b2d7a95c0103b91d8b70b75ca784794ecc5cbccd7c17a2eeffccd4d88a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID d21f37b2d7a9. Setting up logs at ./log/docker/node2_2024-10-17_04-07-13__6a7a0214-86e2-4a74-891e-a0139ae90e85__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 51627
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51627/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51627/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.48.83/tcp/51628/p2p/16Uiu2HAmVYJYhiL1xQkS5qNv5LsemzdZafTqU8jdcW6PHHXQZBSu","/ip4/172.18.48.83/tcp/51629/ws/p2p/16Uiu2HAmVYJYhiL1xQkS5qNv5LsemzdZafTqU8jdcW6PHHXQZBSu"],"enrUri":"enr:-LO4QAJ87cDIrO18WiWl9t2o2j9NbF8UCFDzZn6mICOva6Ygf5WNNuJT9NZCi9aKq9QmUXLQWHsv1IWQuyFTwdNrMDUBgmlkgnY0gmlwhKwSMFOKbXVsdGlhZGRyc4wACgSsEjBTBsmt3QOCcnOFAAMBAACJc2VjcDI1NmsxoQP64C_vGujxtUavm6e2ogNMFC_B5MlA1pgb1gOxX9KzdoN0Y3CCyayDdWRwgsmuhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51627/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.17.203/tcp/9048/p2p/16Uiu2HAkvtNkNo8TQeXq8qG89fFWmACbGqghf4fMJZTx11dGYPQ6"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9047/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51627/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "4ae91615-a37d-4fb4-879b-121a6a721ce2", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"4ae91615-a37d-4fb4-879b-121a6a721ce2","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:51627/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9047/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51627/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1729138036131228672,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 05a8cc2ed36a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id d21f37b2d7a9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.