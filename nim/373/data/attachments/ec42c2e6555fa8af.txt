[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_works_with_static_sharding with id: 2024-09-27_04-23-35__20002b36-5ed6-41bd-83f5-4e72764ef9c9
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-27_04-23-35__20002b36-5ed6-41bd-83f5-4e72764ef9c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.159.157
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['55661', '55662', '55663', '55664', '55665']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 55661:55661 -p 55662:55662 -p 55663:55663 -p 55664:55664 -p 55665:55665 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55663 --rest-port=55661 --tcp-port=55662 --discv5-udp-port=55664 --rest-address=0.0.0.0 --nat=extip:172.18.159.157 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=dba34b55d265b39e62ed6aa4d7bcbe9dfe4d29ccaebd3f9985c2c8f5f5935a08 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55665 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.159.157 waku 9d0847b2544cd931f0c3d93f1266cee70d97eafbbe7af193b06bfee015462538
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9d0847b2544c. Setting up logs at ./log/docker/node1_2024-09-27_04-23-35__20002b36-5ed6-41bd-83f5-4e72764ef9c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 55661
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55661/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55661/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.159.157/tcp/55662/p2p/16Uiu2HAmD2hwoSczAp5LBkGajszv6rgtZwgSzpUhPWUkHom7zJA1","/ip4/172.18.159.157/tcp/55663/ws/p2p/16Uiu2HAmD2hwoSczAp5LBkGajszv6rgtZwgSzpUhPWUkHom7zJA1"],"enrUri":"enr:-LO4QL5B-w8rej58l3J-1zCsVufS8gajXWKavbao8R-ze5LBMCG7GnOa6pTo6gnIVTk6NYP-bXDRqaumMKRidt10mLUBgmlkgnY0gmlwhKwSn52KbXVsdGlhZGRyc4wACgSsEp-dBtlv3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMFkDqIHCpygtj8PrC3kyZF1KIhGEyhazZdE3KzaPPutoN0Y3CC2W6DdWRwgtlwhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-27_04-23-35__20002b36-5ed6-41bd-83f5-4e72764ef9c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.191.84
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['64837', '64838', '64839', '64840', '64841']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 64837:64837 -p 64838:64838 -p 64839:64839 -p 64840:64840 -p 64841:64841 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=64839 --rest-port=64837 --tcp-port=64838 --discv5-udp-port=64840 --rest-address=0.0.0.0 --nat=extip:172.18.191.84 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=8d3e08e5f1ba05aad5aa3e0184bb00ad29aab0a6e4c7bbdd9debb093c2afa91d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=64841 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QL5B-w8rej58l3J-1zCsVufS8gajXWKavbao8R-ze5LBMCG7GnOa6pTo6gnIVTk6NYP-bXDRqaumMKRidt10mLUBgmlkgnY0gmlwhKwSn52KbXVsdGlhZGRyc4wACgSsEp-dBtlv3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMFkDqIHCpygtj8PrC3kyZF1KIhGEyhazZdE3KzaPPutoN0Y3CC2W6DdWRwgtlwhXdha3UyBQ --filternode=/ip4/172.18.159.157/tcp/55662/p2p/16Uiu2HAmD2hwoSczAp5LBkGajszv6rgtZwgSzpUhPWUkHom7zJA1 --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.191.84 waku f52b0f4ea6d8d1a4b6799e82908de08c06c2fbe5cd86d7d693e4a4a25815fb5a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID f52b0f4ea6d8. Setting up logs at ./log/docker/node2_2024-09-27_04-23-35__20002b36-5ed6-41bd-83f5-4e72764ef9c9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 64837
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64837/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64837/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.191.84/tcp/64838/p2p/16Uiu2HAmBHfLRzvB19xP2UnWDkKqDHuAxdgDEsCTqcaHvny2nF4e","/ip4/172.18.191.84/tcp/64839/ws/p2p/16Uiu2HAmBHfLRzvB19xP2UnWDkKqDHuAxdgDEsCTqcaHvny2nF4e"],"enrUri":"enr:-LO4QL6D3wvl6SxIb8Fk7RUv_qgkdhlBMuF07QcHID8x7LafeoXKe7_DGvYs0N79ykTzQkuwAWJjT4JEhO2eO768rogBgmlkgnY0gmlwhKwSv1SKbXVsdGlhZGRyc4wACgSsEr9UBv1H3QOCcnOFAAIBAACJc2VjcDI1NmsxoQLrrZ2xUtek3in36ygFfIrp05Un20sN3uAsEvzskXxVo4N0Y3CC_UaDdWRwgv1IhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64837/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.159.157/tcp/55662/p2p/16Uiu2HAmD2hwoSczAp5LBkGajszv6rgtZwgSzpUhPWUkHom7zJA1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55661/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64837/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d645b5af-d328-4947-ad21-1e8e78af35f4", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"d645b5af-d328-4947-ad21-1e8e78af35f4","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55661/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:186 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64837/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1727411019636803840,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9d0847b2544c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id f52b0f4ea6d8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.