[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_filter_get with id: 2024-09-27_04-20-55__3087cd74-9563-4eee-8934-73af88fdafeb
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-27_04-20-55__3087cd74-9563-4eee-8934-73af88fdafeb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.225.116
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['18159', '18160', '18161', '18162', '18163']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 18159:18159 -p 18160:18160 -p 18161:18161 -p 18162:18162 -p 18163:18163 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18161 --rest-port=18159 --tcp-port=18160 --discv5-udp-port=18162 --rest-address=0.0.0.0 --nat=extip:172.18.225.116 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ae89dcf342b1ba7037a481fd9f76e90276eaba78cc39c7cc72aad7cbcec36686 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18163 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.225.116 waku 986915e5eefa18af528ff11b5d9d8530f098b4a27797d665a2e68fbb27918dca
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 986915e5eefa. Setting up logs at ./log/docker/node1_2024-09-27_04-20-55__3087cd74-9563-4eee-8934-73af88fdafeb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 18159
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18159/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18159/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.225.116/tcp/18160/p2p/16Uiu2HAm5hE3cZAFSN23XQxYHtgsLq7bhYtCvcD8YHdQBptYTiux","/ip4/172.18.225.116/tcp/18161/ws/p2p/16Uiu2HAm5hE3cZAFSN23XQxYHtgsLq7bhYtCvcD8YHdQBptYTiux"],"enrUri":"enr:-LO4QHRE3VlYksEmcqjZbzIkE8Wbxp9YwZJusw0pQUT6nGU2GEmUTMWNDkPrYypugOqWOA7PeOoUO9vXbZ-lS2eEiiMBgmlkgnY0gmlwhKwS4XSKbXVsdGlhZGRyc4wACgSsEuF0Bkbx3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKYkNag0t-t1AtbVEmGDhiSxq_AA9alcok_NR4kQUrIY4N0Y3CCRvCDdWRwgkbyhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-27_04-20-55__3087cd74-9563-4eee-8934-73af88fdafeb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.73.34
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['22570', '22571', '22572', '22573', '22574']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 22570:22570 -p 22571:22571 -p 22572:22572 -p 22573:22573 -p 22574:22574 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22572 --rest-port=22570 --tcp-port=22571 --discv5-udp-port=22573 --rest-address=0.0.0.0 --nat=extip:172.18.73.34 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e3197cdd4168226a226a6caad1d1517deca8233652288c6fa1a1084107fb5e01 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22574 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QHRE3VlYksEmcqjZbzIkE8Wbxp9YwZJusw0pQUT6nGU2GEmUTMWNDkPrYypugOqWOA7PeOoUO9vXbZ-lS2eEiiMBgmlkgnY0gmlwhKwS4XSKbXVsdGlhZGRyc4wACgSsEuF0Bkbx3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKYkNag0t-t1AtbVEmGDhiSxq_AA9alcok_NR4kQUrIY4N0Y3CCRvCDdWRwgkbyhXdha3UyBQ --filternode=/ip4/172.18.225.116/tcp/18160/p2p/16Uiu2HAm5hE3cZAFSN23XQxYHtgsLq7bhYtCvcD8YHdQBptYTiux
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.73.34 waku 200b3815575d31580eed77407ca840341640243e8d818051618888c6d032b302
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 200b3815575d. Setting up logs at ./log/docker/node2_2024-09-27_04-20-55__3087cd74-9563-4eee-8934-73af88fdafeb__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22570
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22570/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22570/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.73.34/tcp/22571/p2p/16Uiu2HAmMmmuNqAdH7sCvB2GftWDmbxHMSKQmSUHKubRXKtJk9fe","/ip4/172.18.73.34/tcp/22572/ws/p2p/16Uiu2HAmMmmuNqAdH7sCvB2GftWDmbxHMSKQmSUHKubRXKtJk9fe"],"enrUri":"enr:-LO4QLlMlnzB5HW54e0JZ0ifJFai4ar-pFd0uogFYGDbjqWXKqlP-fIcp-ElHy0Fy7iJnGBX4ME8fW-YVDoMrn8OG-0BgmlkgnY0gmlwhKwSSSKKbXVsdGlhZGRyc4wACgSsEkkiBlgs3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOHdiylAL2eGhifUaujFbC4hPldTpGR-OX02OYEFB3bCYN0Y3CCWCuDdWRwglgthXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22570/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.225.116/tcp/18160/p2p/16Uiu2HAm5hE3cZAFSN23XQxYHtgsLq7bhYtCvcD8YHdQBptYTiux"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18159/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22570/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "840be8eb-05ee-452a-8f13-e3f75c5b762f", "contentFilters": ["/test/1/waku-relay/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"840be8eb-05ee-452a-8f13-e3f75c5b762f","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18159/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22570/filter/v2/messages/%2Ftest%2F1%2Fwaku-relay%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1727410858794147840,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_filter_requests{type="SUBSCRIBE"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_filter_requests{type="SUBSCRIBE"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/filter-subscribe/2.0.0-beta1",peerId="/ip4/172.18.225.116/tcp/18160"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/filter-subscribe/2.0.0-beta1",peerId="/ip4/172.18.225.116/tcp/18160"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_total_dial_attempts_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_total_dial_attempts_total with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 986915e5eefa
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 200b3815575d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.