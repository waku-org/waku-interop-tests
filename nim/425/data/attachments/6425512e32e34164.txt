[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-11-06_21-14-49__d360cf30-50a9-4bf2-8bf6-853dcdebca0c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-06_21-14-49__d360cf30-50a9-4bf2-8bf6-853dcdebca0c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.51.230
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['49439', '49440', '49441', '49442', '49443']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 49439:49439 -p 49440:49440 -p 49441:49441 -p 49442:49442 -p 49443:49443 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49441 --rest-port=49439 --tcp-port=49440 --discv5-udp-port=49442 --rest-address=0.0.0.0 --nat=extip:172.18.51.230 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9ab1834aced9b574fbba9ae54fdda237ba8d1acabefe2bb286d9fcf334ac1e2e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49443 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.51.230 waku ca5ae43a0846c2d351dc554498cbdea4b8c5256908dd298be90a277223eeb7bf
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b900bcf4853f. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ca5ae43a0846. Setting up logs at ./log/docker/receiving_node1_2024-11-06_21-14-49__d360cf30-50a9-4bf2-8bf6-853dcdebca0c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 49439
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49439/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49439/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.51.230/tcp/49440/p2p/16Uiu2HAm4kArgpDjcia9x8giBxmFxJ1A9BgEu3bSiCnjg5pc7Kor","/ip4/172.18.51.230/tcp/49441/ws/p2p/16Uiu2HAm4kArgpDjcia9x8giBxmFxJ1A9BgEu3bSiCnjg5pc7Kor"],"enrUri":"enr:-L24QGQts2ILbcqSalVg5xVaRkmIIml6CFVFRwgU2f3eRRS9Wlzv8V0yLU547o1K0lFKVw67OC-EN94f4WGWE-6rj1gCgmlkgnY0gmlwhKwSM-aKbXVsdGlhZGRyc5YACASsEjPmBsEgAAoErBIz5gbBId0DgnJzhQADAQAAiXNlY3AyNTZrMaECinZJ7Mw7lMp7BUrFNX--M5u34cgkgpRincy_x7POiCWDdGNwgsEgg3VkcILBIoV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-06_21-14-49__d360cf30-50a9-4bf2-8bf6-853dcdebca0c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.114.169
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['26666', '26667', '26668', '26669', '26670']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 26666:26666 -p 26667:26667 -p 26668:26668 -p 26669:26669 -p 26670:26670 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26668 --rest-port=26666 --tcp-port=26667 --discv5-udp-port=26669 --rest-address=0.0.0.0 --nat=extip:172.18.114.169 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ae38cddbfec8601cbf66f5eabefcabf0689edcfc6542e675bc7e2ead966d7ca7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26670 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.114.169 waku b3aa42fd910fcf3313e49d1b673a5d9d663e7555c290c4f1b3f0c0bc889a2b54
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b3aa42fd910f. Setting up logs at ./log/docker/receiving_node2_2024-11-06_21-14-49__d360cf30-50a9-4bf2-8bf6-853dcdebca0c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 26666
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26666/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26666/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.114.169/tcp/26667/p2p/16Uiu2HAmTT7g6i9rVVgrU6Nv4aANZr6dVLeMG3Y8AYGNRZvexe3b","/ip4/172.18.114.169/tcp/26668/ws/p2p/16Uiu2HAmTT7g6i9rVVgrU6Nv4aANZr6dVLeMG3Y8AYGNRZvexe3b"],"enrUri":"enr:-L24QCFXzllh8BIGVaZ7GtvZqSOoA6rPV0odT5ZBNcS2JLQ7RxYic1nk1TmRJQlOhOmJYl1fBmxyjhqshhOwIdOLt9oCgmlkgnY0gmlwhKwScqmKbXVsdGlhZGRyc5YACASsEnKpBmgrAAoErBJyqQZoLN0DgnJzhQADAQAAiXNlY3AyNTZrMaED29SdpPcPBgcu8j40lzb6tNMRTWqUAKNaIKS_GxM89dKDdGNwgmgrg3VkcIJoLYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26666/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.51.230/tcp/49440/p2p/16Uiu2HAm4kArgpDjcia9x8giBxmFxJ1A9BgEu3bSiCnjg5pc7Kor"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-06_21-14-49__d360cf30-50a9-4bf2-8bf6-853dcdebca0c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.230.239
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['55195', '55196', '55197', '55198', '55199']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 55195:55195 -p 55196:55196 -p 55197:55197 -p 55198:55198 -p 55199:55199 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55197 --rest-port=55195 --tcp-port=55196 --discv5-udp-port=55198 --rest-address=0.0.0.0 --nat=extip:172.18.230.239 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ffb72a0ea5d1eb22977d8bec5f68adfabb4fdf5cb30e802f61bc1c1aeb5bdc31 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55199 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QGQts2ILbcqSalVg5xVaRkmIIml6CFVFRwgU2f3eRRS9Wlzv8V0yLU547o1K0lFKVw67OC-EN94f4WGWE-6rj1gCgmlkgnY0gmlwhKwSM-aKbXVsdGlhZGRyc5YACASsEjPmBsEgAAoErBIz5gbBId0DgnJzhQADAQAAiXNlY3AyNTZrMaECinZJ7Mw7lMp7BUrFNX--M5u34cgkgpRincy_x7POiCWDdGNwgsEgg3VkcILBIoV3YWt1Mgk --lightpushnode=/ip4/172.18.51.230/tcp/49440/p2p/16Uiu2HAm4kArgpDjcia9x8giBxmFxJ1A9BgEu3bSiCnjg5pc7Kor --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.230.239 waku 9ac4be7ea84c704ed2c97d42d0da48eff17e5585f54bb91879bd1cade9532dd5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9ac4be7ea84c. Setting up logs at ./log/docker/lightpush_node1_2024-11-06_21-14-49__d360cf30-50a9-4bf2-8bf6-853dcdebca0c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 55195
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55195/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55195/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.230.239/tcp/55196/p2p/16Uiu2HAm9EWaXem3ixexP9LtTPLHnbN3hV411AX1JmS9irBwcEJq","/ip4/172.18.230.239/tcp/55197/ws/p2p/16Uiu2HAm9EWaXem3ixexP9LtTPLHnbN3hV411AX1JmS9irBwcEJq"],"enrUri":"enr:-L24QPB92_6BXzYsmeJHwvHJQq47okyRCwj8QrDZGn3A_s4-YLd5Bf0PmyT3vAEZJemCTvmCMpmU1L3MffxFGlihImkCgmlkgnY0gmlwhKwS5u-KbXVsdGlhZGRyc5YACASsEubvBtecAAoErBLm7wbXnd0DgnJzhQADAQAAiXNlY3AyNTZrMaECzSeZI9SGjfoD5sOmSeipoqlLR3igl8Qz5y2QXbij5raDdGNwgtecg3VkcILXnoV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.51.230/tcp/49440/p2p/16Uiu2HAm4kArgpDjcia9x8giBxmFxJ1A9BgEu3bSiCnjg5pc7Kor"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.114.169/tcp/26667/p2p/16Uiu2HAmTT7g6i9rVVgrU6Nv4aANZr6dVLeMG3Y8AYGNRZvexe3b"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49439/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26666/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730927695331287040}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55195/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730927695336624128}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55195/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730927695344561920}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55195/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730927695348354048}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55195/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730927695351750912}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55195/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55195/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730927695354990336}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55195/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ca5ae43a0846
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b3aa42fd910f
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ca5ae43a0846. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9ac4be7ea84c
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b3aa42fd910f. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.