[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2024-05-04_04-21-46__293f540d-9c28-4983-869c-047693dbbed8
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-04_04-21-46__293f540d-9c28-4983-869c-047693dbbed8__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.46.67
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['56567', '56568', '56569', '56570', '56571']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 56567:56567 -p 56568:56568 -p 56569:56569 -p 56570:56570 -p 56571:56571 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56569 --rest-port=56567 --tcp-port=56568 --discv5-udp-port=56570 --rest-address=0.0.0.0 --nat=extip:172.18.46.67 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56571 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.46.67 waku 3ba9a50f80db79c4dc50a91047887d1f0f4350ded5bdb45da3e588d50c6ad5e7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 3ba9a50f80db. Setting up logs at ./log/docker/publishing_node1_2024-05-04_04-21-46__293f540d-9c28-4983-869c-047693dbbed8__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 56567
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56567/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.46.67/tcp/56568/p2p/16Uiu2HAmL6sr7V4C399nhsm7Dd5V9F9R4NrhjpmCH6ZDp5xTyKxE","/ip4/172.18.46.67/tcp/56569/ws/p2p/16Uiu2HAmL6sr7V4C399nhsm7Dd5V9F9R4NrhjpmCH6ZDp5xTyKxE"],"enrUri":"enr:-LO4QFgknLI9JO9lk8gYC0pAfFhjo2UmM2Chrv9AgV8GJ3cFJDHLkP4U56MVirIoxIuiS4XRaa3x0SmyhmNt8xvLutEBgmlkgnY0gmlwhKwSLkOKbXVsdGlhZGRyc4wACgSsEi5DBtz53QOCcnOFAAABAACJc2VjcDI1NmsxoQNuo452M1Um2B7-Z14vpKX0th99CZj2TmLbE8sDfDchS4N0Y3CC3PiDdWRwgtz6hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-04_04-21-46__293f540d-9c28-4983-869c-047693dbbed8__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.7.192
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['12909', '12910', '12911', '12912', '12913']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 12909:12909 -p 12910:12910 -p 12911:12911 -p 12912:12912 -p 12913:12913 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12911 --rest-port=12909 --tcp-port=12910 --discv5-udp-port=12912 --rest-address=0.0.0.0 --nat=extip:172.18.7.192 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12913 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QFgknLI9JO9lk8gYC0pAfFhjo2UmM2Chrv9AgV8GJ3cFJDHLkP4U56MVirIoxIuiS4XRaa3x0SmyhmNt8xvLutEBgmlkgnY0gmlwhKwSLkOKbXVsdGlhZGRyc4wACgSsEi5DBtz53QOCcnOFAAABAACJc2VjcDI1NmsxoQNuo452M1Um2B7-Z14vpKX0th99CZj2TmLbE8sDfDchS4N0Y3CC3PiDdWRwgtz6hXdha3UyAw --storenode=/ip4/172.18.46.67/tcp/56568/p2p/16Uiu2HAmL6sr7V4C399nhsm7Dd5V9F9R4NrhjpmCH6ZDp5xTyKxE --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.7.192 waku 4f21c1f7dd6d47c982d3f8b91b7753befda4406376e5a7677c4b8487f64535a4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 4f21c1f7dd6d. Setting up logs at ./log/docker/store_node1_2024-05-04_04-21-46__293f540d-9c28-4983-869c-047693dbbed8__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 12909
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:12909/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.7.192/tcp/12910/p2p/16Uiu2HAmTsx8gdKsjHtaHFsunghusL9Yv3GcP3chi5ykGPAXekPy","/ip4/172.18.7.192/tcp/12911/ws/p2p/16Uiu2HAmTsx8gdKsjHtaHFsunghusL9Yv3GcP3chi5ykGPAXekPy"],"enrUri":"enr:-LO4QNvl8DsYvLxnwGsfr2MpZ48zdLLJmiQNI_fQYN6JVtWSfbviJflR0ci1VFp9BH06dPhfeYOWzJBXJAjWbE9JZ0cBgmlkgnY0gmlwhKwSB8CKbXVsdGlhZGRyc4wACgSsEgfABjJv3QOCcnOFAAABAACJc2VjcDI1NmsxoQPiMVjlzFuUIJfreLKnYn_GDO7QG-cOW9dFChC2ArpmiIN0Y3CCMm6DdWRwgjJwhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12909/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.46.67/tcp/56568/p2p/16Uiu2HAmL6sr7V4C399nhsm7Dd5V9F9R4NrhjpmCH6ZDp5xTyKxE"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:56567/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:12909/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:56567/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56567/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714796518881497856,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 3ba9a50f80db
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 4f21c1f7dd6d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-04_04-21-46__293f540d-9c28-4983-869c-047693dbbed8__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-04_04-21-46__293f540d-9c28-4983-869c-047693dbbed8__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2024-05-04_04-22-02__39f4fc30-7e6b-4721-8c8f-ce632e4a3658
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-04_04-22-02__39f4fc30-7e6b-4721-8c8f-ce632e4a3658__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.160.103
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['10040', '10041', '10042', '10043', '10044']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 10040:10040 -p 10041:10041 -p 10042:10042 -p 10043:10043 -p 10044:10044 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10042 --rest-port=10040 --tcp-port=10041 --discv5-udp-port=10043 --rest-address=0.0.0.0 --nat=extip:172.18.160.103 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10044 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.160.103 waku a47ac043411cf4f7c4aaf9cd45ac24f85d248be27cad8b22087455eb7d396de9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a47ac043411c. Setting up logs at ./log/docker/publishing_node1_2024-05-04_04-22-02__39f4fc30-7e6b-4721-8c8f-ce632e4a3658__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 10040
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10040/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.160.103/tcp/10041/p2p/16Uiu2HAm8tMzpp8X1Qo1qeA1BZNSVYta8rk7tQQGbCW56fNvgkLL","/ip4/172.18.160.103/tcp/10042/ws/p2p/16Uiu2HAm8tMzpp8X1Qo1qeA1BZNSVYta8rk7tQQGbCW56fNvgkLL"],"enrUri":"enr:-LO4QI-AiE8yLhDv6rTJK0d967UXCwF5mMvJz3egX7AVjA_yT4Vtedy8BQq0PuFj7FDx-aat6r2p9gXUllRnPnlR_VkBgmlkgnY0gmlwhKwSoGeKbXVsdGlhZGRyc4wACgSsEqBnBic63QOCcnOFAAABAACJc2VjcDI1NmsxoQLH_keCerRXmGA2gOft315nGS8fhmQA7g5fZMSASsDT9YN0Y3CCJzmDdWRwgic7hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-04_04-22-02__39f4fc30-7e6b-4721-8c8f-ce632e4a3658__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.167.216
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['60585', '60586', '60587', '60588', '60589']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 60585:60585 -p 60586:60586 -p 60587:60587 -p 60588:60588 -p 60589:60589 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60587 --rest-port=60585 --tcp-port=60586 --discv5-udp-port=60588 --rest-address=0.0.0.0 --nat=extip:172.18.167.216 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60589 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QI-AiE8yLhDv6rTJK0d967UXCwF5mMvJz3egX7AVjA_yT4Vtedy8BQq0PuFj7FDx-aat6r2p9gXUllRnPnlR_VkBgmlkgnY0gmlwhKwSoGeKbXVsdGlhZGRyc4wACgSsEqBnBic63QOCcnOFAAABAACJc2VjcDI1NmsxoQLH_keCerRXmGA2gOft315nGS8fhmQA7g5fZMSASsDT9YN0Y3CCJzmDdWRwgic7hXdha3UyAw --storenode=/ip4/172.18.160.103/tcp/10041/p2p/16Uiu2HAm8tMzpp8X1Qo1qeA1BZNSVYta8rk7tQQGbCW56fNvgkLL --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.167.216 waku 27e4921c5464d5989df3c2f8278043732abf373c75a7421ea8b25bdc4c798123
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 27e4921c5464. Setting up logs at ./log/docker/store_node1_2024-05-04_04-22-02__39f4fc30-7e6b-4721-8c8f-ce632e4a3658__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 60585
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:60585/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.167.216/tcp/60586/p2p/16Uiu2HAmAgE5k42aywGhrmwgFqZAEESxmvjqmSJieXT2zufCDE8w","/ip4/172.18.167.216/tcp/60587/ws/p2p/16Uiu2HAmAgE5k42aywGhrmwgFqZAEESxmvjqmSJieXT2zufCDE8w"],"enrUri":"enr:-LO4QNeAa3cBLeM0aTyi7ttZ3RvXUlh17GYsm7IHFmkQfHD9Y2lzpYopk6WkWcJCNGy7fXrJ4AoE_dyB5cCRCzRaiuABgmlkgnY0gmlwhKwSp9iKbXVsdGlhZGRyc4wACgSsEqfYBuyr3QOCcnOFAAABAACJc2VjcDI1NmsxoQLimbvVVyd98I1jU0n_aYRASbnL3zuTZhLpWeHWy8_8cIN0Y3CC7KqDdWRwguyshXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60585/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.160.103/tcp/10041/p2p/16Uiu2HAm8tMzpp8X1Qo1qeA1BZNSVYta8rk7tQQGbCW56fNvgkLL"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10040/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:60585/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10040/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10040/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714796534963548160,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id a47ac043411c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 27e4921c5464
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-04_04-22-02__39f4fc30-7e6b-4721-8c8f-ce632e4a3658__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-04_04-22-02__39f4fc30-7e6b-4721-8c8f-ce632e4a3658__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_only_relay with id: 2024-05-04_04-22-19__4fb4c1da-c8ff-4919-97b6-e1df3899feaa
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-04_04-22-19__4fb4c1da-c8ff-4919-97b6-e1df3899feaa__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.172.239
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['22932', '22933', '22934', '22935', '22936']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 22932:22932 -p 22933:22933 -p 22934:22934 -p 22935:22935 -p 22936:22936 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22934 --rest-port=22932 --tcp-port=22933 --discv5-udp-port=22935 --rest-address=0.0.0.0 --nat=extip:172.18.172.239 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22936 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.172.239 waku ec182170d842e07875a78fd2adb50c0b207f8cc60cf8763cc7aa0e0e3ef3bcba
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID ec182170d842. Setting up logs at ./log/docker/publishing_node1_2024-05-04_04-22-19__4fb4c1da-c8ff-4919-97b6-e1df3899feaa__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 22932
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22932/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.172.239/tcp/22933/p2p/16Uiu2HAm5VPiEVe6sPqn3Sa4Jh6wo5k6jK4NB7JowP6MweRVwu3b","/ip4/172.18.172.239/tcp/22934/ws/p2p/16Uiu2HAm5VPiEVe6sPqn3Sa4Jh6wo5k6jK4NB7JowP6MweRVwu3b"],"enrUri":"enr:-LO4QJCDDbzGAMApVcpkH7uoMAjbFL868ZtniGc5HJy1VoMYLYcEuUyjx9NuijbWwdl5oxQv3yLu0aE0gC5EcU1DKlABgmlkgnY0gmlwhKwSrO-KbXVsdGlhZGRyc4wACgSsEqzvBlmW3QOCcnOFAAABAACJc2VjcDI1NmsxoQKViMxDOH57ewgz_rVx4h2m7ZbjSPXFKS5cfham6iJhVoN0Y3CCWZWDdWRwglmXhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-04_04-22-19__4fb4c1da-c8ff-4919-97b6-e1df3899feaa__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.214.153
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['48302', '48303', '48304', '48305', '48306']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 48302:48302 -p 48303:48303 -p 48304:48304 -p 48305:48305 -p 48306:48306 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48304 --rest-port=48302 --tcp-port=48303 --discv5-udp-port=48305 --rest-address=0.0.0.0 --nat=extip:172.18.214.153 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48306 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QJCDDbzGAMApVcpkH7uoMAjbFL868ZtniGc5HJy1VoMYLYcEuUyjx9NuijbWwdl5oxQv3yLu0aE0gC5EcU1DKlABgmlkgnY0gmlwhKwSrO-KbXVsdGlhZGRyc4wACgSsEqzvBlmW3QOCcnOFAAABAACJc2VjcDI1NmsxoQKViMxDOH57ewgz_rVx4h2m7ZbjSPXFKS5cfham6iJhVoN0Y3CCWZWDdWRwglmXhXdha3UyAw --storenode=/ip4/172.18.172.239/tcp/22933/p2p/16Uiu2HAm5VPiEVe6sPqn3Sa4Jh6wo5k6jK4NB7JowP6MweRVwu3b --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.214.153 waku 02ab66cca59c66115c0dbb94cff74a9c837274cad378fd64c61a5b7672ee8def
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 02ab66cca59c. Setting up logs at ./log/docker/store_node1_2024-05-04_04-22-19__4fb4c1da-c8ff-4919-97b6-e1df3899feaa__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 48302
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48302/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.153/tcp/48303/p2p/16Uiu2HAmQpXr9pHGZqHbFguxmASiUUDeJsNYt72Sk3dV2j4H2cm5","/ip4/172.18.214.153/tcp/48304/ws/p2p/16Uiu2HAmQpXr9pHGZqHbFguxmASiUUDeJsNYt72Sk3dV2j4H2cm5"],"enrUri":"enr:-LO4QM95FecGMr09eNylJa-F3EmK805IFRmXQ83no9gZTyheV3sWpUTi8XhiI0TX_P8hZjxaMcUCEnbedZ3kPncjnz0BgmlkgnY0gmlwhKwS1pmKbXVsdGlhZGRyc4wACgSsEtaZBryw3QOCcnOFAAABAACJc2VjcDI1NmsxoQO0vhW7TLOcUHrg424hmfeBwu9eYiZYh-gp5oYKPaYm8IN0Y3CCvK-DdWRwgryxhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48302/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.172.239/tcp/22933/p2p/16Uiu2HAm5VPiEVe6sPqn3Sa4Jh6wo5k6jK4NB7JowP6MweRVwu3b"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22932/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48302/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22932/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22932/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714796551195894528,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id ec182170d842
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 02ab66cca59c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-04_04-22-19__4fb4c1da-c8ff-4919-97b6-e1df3899feaa__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-04_04-22-19__4fb4c1da-c8ff-4919-97b6-e1df3899feaa__harbor.status.im_wakuorg_nwaku:latest.log