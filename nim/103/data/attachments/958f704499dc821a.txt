[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_filter_get_message_after_node2_restarts with id: 2024-03-19_16-32-42__5d74d577-3d26-4831-af24-7f5dcf9c5d09
[35mDEBUG   [0m src.steps.filter:filter.py:27 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:33 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node1_2024-03-19_16-32-42__5d74d577-3d26-4831-af24-7f5dcf9c5d09__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.102.214
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['10518', '10519', '10520', '10521', '10522']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:294 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 10518:10518 -p 10519:10519 -p 10520:10520 -p 10521:10521 -p 10522:10522 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10520 --rest-port=10518 --tcp-port=10519 --discv5-udp-port=10521 --rest-address=0.0.0.0 --nat=extip:172.18.102.214 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10522 --metrics-logging=true --relay=true --filter=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.102.214 waku 856978473c3291cce686b96f812d2d63daf8421a6266a651144a084555441bb2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 856978473c32. Setting up logs at ./log/docker/node1_2024-03-19_16-32-42__5d74d577-3d26-4831-af24-7f5dcf9c5d09__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 10518
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:10518/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.102.214/tcp/10519/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.102.214/tcp/10520/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QBWC4X5FZeka89HfosPV5V1VhqeiZfVAqfTJ9IkQXbHMXDG0BQCyaP5Aj_iQ7nx8YrhQdUG6cNbI9HvWj77VE6cBgmlkgnY0gmlwhKwSZtaKbXVsdGlhZGRyc4wACgSsEmbWBikY3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCKReDdWRwgikZhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:38 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node2_2024-03-19_16-32-42__5d74d577-3d26-4831-af24-7f5dcf9c5d09__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.144.208
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['22240', '22241', '22242', '22243', '22244']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:294 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 22240:22240 -p 22241:22241 -p 22242:22242 -p 22243:22243 -p 22244:22244 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22242 --rest-port=22240 --tcp-port=22241 --discv5-udp-port=22243 --rest-address=0.0.0.0 --nat=extip:172.18.144.208 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22244 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QBWC4X5FZeka89HfosPV5V1VhqeiZfVAqfTJ9IkQXbHMXDG0BQCyaP5Aj_iQ7nx8YrhQdUG6cNbI9HvWj77VE6cBgmlkgnY0gmlwhKwSZtaKbXVsdGlhZGRyc4wACgSsEmbWBikY3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCKReDdWRwgikZhXdha3UyBQ --filternode=/ip4/172.18.102.214/tcp/10519/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.144.208 waku 8e00df911facc61720902dd85c9770e1c11440e9581b45cac98183fb4546c6de
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 8e00df911fac. Setting up logs at ./log/docker/node2_2024-03-19_16-32-42__5d74d577-3d26-4831-af24-7f5dcf9c5d09__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 22240
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:22240/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.144.208/tcp/22241/p2p/16Uiu2HAm6nzhVJkdo5aAdFyVgJ1UbJcA1A8CMCzgwx9JBtUoRFK1","/ip4/172.18.144.208/tcp/22242/ws/p2p/16Uiu2HAm6nzhVJkdo5aAdFyVgJ1UbJcA1A8CMCzgwx9JBtUoRFK1"],"enrUri":"enr:-LO4QHdSV5blYBO5o_E4XihFgKzPlmPZLloAqJGtY_vtj7nZKMMhf7MxVpElf7x_aO6tyBKzE8zdwm8Owpk0s4HtVCoBgmlkgnY0gmlwhKwSkNCKbXVsdGlhZGRyc4wACgSsEpDQBlbi3QOCcnOFAAABAACJc2VjcDI1NmsxoQKo5usvWlnVsDuuQW7p5a3FHqtqXgr6d9Dxgtesi3k1TIN0Y3CCVuGDdWRwglbjhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:45 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:10518/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:22240/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "288989d6-1624-4b98-b9bf-996902fadede", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"288989d6-1624-4b98-b9bf-996902fadede","statusCode":0,"statusDesc":""}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:10518/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:22240/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1710865966552358400,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:175 Restarting container with id 8e00df911fac
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:22240/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:22240/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.144.208/tcp/22241/p2p/16Uiu2HAkuUpo9FFLCciyGRLtNmsYwLPND3foSgWwaJ7ikM9oisHg","/ip4/172.18.144.208/tcp/22242/ws/p2p/16Uiu2HAkuUpo9FFLCciyGRLtNmsYwLPND3foSgWwaJ7ikM9oisHg"],"enrUri":"enr:-LO4QGA6nHJ4vl2v2IJsRf9oHoGp9QUzX4jhYWjGRspz_g3lDR8Sc0qCo9obmvv9MqiHOCt_7rSR4EMcVx7QZvp96RkBgmlkgnY0gmlwhKwSkNCKbXVsdGlhZGRyc4wACgSsEpDQBlbi3QOCcnOFAAABAACJc2VjcDI1NmsxoQIAzrYMh1upGDuVp859x9mCW5Nq8Qt0f14Enm377kp8l4N0Y3CCVuGDdWRwglbjhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:10518/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:22240/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "4df8150a-d742-4b9c-a787-e93f243316d6", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"4df8150a-d742-4b9c-a787-e93f243316d6","statusCode":0,"statusDesc":""}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:10518/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:22240/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1710865972683136768,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 856978473c32
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 8e00df911fac
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.