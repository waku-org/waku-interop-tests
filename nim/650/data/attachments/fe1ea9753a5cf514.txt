2025-02-13 04:05:09.854 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:05:09.854 DEBUG [tests.conftest] Running test: test_pubsub_topic_also_in_docker_flags[/waku/2/rs/2/1] with id: 2025-02-13_04-05-09__501b7e8f-9974-4b54-9426-80ced47e2f57
2025-02-13 04:05:09.855 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:05:09.855 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-13 04:05:09.855 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-13 04:05:09.862 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:05:09.862 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_04-05-09__501b7e8f-9974-4b54-9426-80ced47e2f57__wakuorg_nwaku:latest.log
2025-02-13 04:05:09.862 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:05:09.862 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:05:09.863 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:05:09.864 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.131.200
2025-02-13 04:05:09.864 DEBUG [src.node.docker_mananger] Generated ports ['41702', '41703', '41704', '41705', '41706']
2025-02-13 04:05:09.864 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:05:09.864 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:05:09.864 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:05:09.864 DEBUG [src.node.docker_mananger] docker run -i -t -p 41702:41702 -p 41703:41703 -p 41704:41704 -p 41705:41705 -p 41706:41706 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=41704 --rest-port=41702 --tcp-port=41703 --discv5-udp-port=41705 --rest-address=0.0.0.0 --nat=extip:172.18.131.200 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=5d728957ed8eac2c0dbcda99198c0dbf4bf3bba76ebe8b2abc0f238fad9cbc6a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=41706 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/1 --content-topic=/myapp/1/latest/proto
2025-02-13 04:05:10.093 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.131.200 waku 1d57d208473440271dc60d0dca81a55a21190b0cb965071c982b7fd9e35bd148
2025-02-13 04:05:10.146 DEBUG [src.node.docker_mananger] Container started with ID 1d57d2084734. Setting up logs at ./log/docker/node1_2025-02-13_04-05-09__501b7e8f-9974-4b54-9426-80ced47e2f57__wakuorg_nwaku:latest.log
2025-02-13 04:05:10.147 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 41702
2025-02-13 04:05:10.148 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:05:10.660 ERROR [src.node.docker_mananger] Max retries reached for container 0f58e4a2f526. Exiting log stream.
2025-02-13 04:05:11.148 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41702/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:11.151 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:05:11.151 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:05:11.151 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41702/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:11.153 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.131.200/tcp/41703/p2p/16Uiu2HAmCEguZMJQztMZQg9HbwxAaHSYPfJRvoqLpEbsfJL7JRVd","/ip4/172.18.131.200/tcp/41704/ws/p2p/16Uiu2HAmCEguZMJQztMZQg9HbwxAaHSYPfJRvoqLpEbsfJL7JRVd"],"enrUri":"enr:-L24QMX_2vjUbLvvQmPUB4ps7XkwGaVn6FvJyrHr-JfD9gjlM6wI0PIsI1HJpdBTimwijRuh9cK_YL-ZdsuzgGZ4H1ACgmlkgnY0gmlwhKwSg8iKbXVsdGlhZGRyc5YACASsEoPIBqLnAAoErBKDyAai6N0DgnJzhQACAQABiXNlY3AyNTZrMaEC-cZWRRxOOaIwhBRgrJyAWt58Pp5SR2jSzjC096XoQwSDdGNwgqLng3VkcIKi6YV3YWt1MgU"}'
2025-02-13 04:05:11.153 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:05:11.160 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:05:11.160 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_04-05-09__501b7e8f-9974-4b54-9426-80ced47e2f57__wakuorg_nwaku:latest.log
2025-02-13 04:05:11.160 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:05:11.160 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:05:11.161 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:05:11.161 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.64.185
2025-02-13 04:05:11.162 DEBUG [src.node.docker_mananger] Generated ports ['24164', '24165', '24166', '24167', '24168']
2025-02-13 04:05:11.162 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:05:11.162 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:05:11.162 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:05:11.162 DEBUG [src.node.docker_mananger] docker run -i -t -p 24164:24164 -p 24165:24165 -p 24166:24166 -p 24167:24167 -p 24168:24168 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24166 --rest-port=24164 --tcp-port=24165 --discv5-udp-port=24167 --rest-address=0.0.0.0 --nat=extip:172.18.64.185 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=c1a92f95660dacb6afeb42a2a8121ffb3abeefdddadfbe2ee1b169d89bc408ac --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24168 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QMX_2vjUbLvvQmPUB4ps7XkwGaVn6FvJyrHr-JfD9gjlM6wI0PIsI1HJpdBTimwijRuh9cK_YL-ZdsuzgGZ4H1ACgmlkgnY0gmlwhKwSg8iKbXVsdGlhZGRyc5YACASsEoPIBqLnAAoErBKDyAai6N0DgnJzhQACAQABiXNlY3AyNTZrMaEC-cZWRRxOOaIwhBRgrJyAWt58Pp5SR2jSzjC096XoQwSDdGNwgqLng3VkcIKi6YV3YWt1MgU --pubsub-topic=/waku/2/rs/2/1 --content-topic=/myapp/1/latest/proto
2025-02-13 04:05:11.380 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.64.185 waku 69e47480d0fe7a7fc22e0ec65fdd4bbc152b197fd8c7051913cafe79f39fb98c
2025-02-13 04:05:11.938 DEBUG [src.node.docker_mananger] Container started with ID 69e47480d0fe. Setting up logs at ./log/docker/node2_2025-02-13_04-05-09__501b7e8f-9974-4b54-9426-80ced47e2f57__wakuorg_nwaku:latest.log
2025-02-13 04:05:11.938 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24164
2025-02-13 04:05:11.939 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:05:12.940 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24164/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:12.943 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:05:12.943 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:05:12.943 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24164/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:12.945 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.64.185/tcp/24165/p2p/16Uiu2HAmLtLVuDAcG4byTZtU7P1w1gxdKt32gAUTWxkempqHwjtU","/ip4/172.18.64.185/tcp/24166/ws/p2p/16Uiu2HAmLtLVuDAcG4byTZtU7P1w1gxdKt32gAUTWxkempqHwjtU"],"enrUri":"enr:-L24QNnwJ2ZRrPtmHABSNRjrSatqU13g4OiKRVYXPCRbw6bJHMvdoZoFnJ5nxCT-SGTV_FEcq_nHN655Sy0xRC0RdwICgmlkgnY0gmlwhKwSQLmKbXVsdGlhZGRyc5YACASsEkC5Bl5lAAoErBJAuQZeZt0DgnJzhQACAQABiXNlY3AyNTZrMaEDekjT74SIz7y0tjHeHRQ_1U3Gr9_mpWKmvXbHmoRN8cGDdGNwgl5lg3VkcIJeZ4V3YWt1MgE"}'
2025-02-13 04:05:12.945 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:05:12.946 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24164/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.131.200/tcp/41703/p2p/16Uiu2HAmCEguZMJQztMZQg9HbwxAaHSYPfJRvoqLpEbsfJL7JRVd"]'
2025-02-13 04:05:12.948 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:12.949 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41702/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-13 04:05:12.951 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:12.951 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24164/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
2025-02-13 04:05:12.954 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:12.954 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41702/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:05:12.959 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:12.960 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:05:13.060 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-13 04:05:13.061 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41702/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:13.063 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419512954484992,"ephemeral":false}]'
2025-02-13 04:05:13.065 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:05:13.065 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24164/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:13.067 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419512954484992,"ephemeral":false}]'
2025-02-13 04:05:13.070 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:05:13.071 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:05:13.071 DEBUG [src.node.waku_node] Stopping container with id 1d57d2084734
2025-02-13 04:05:13.627 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:05:13.627 DEBUG [src.node.waku_node] Stopping container with id 69e47480d0fe
2025-02-13 04:05:14.438 ERROR [src.node.docker_mananger] Max retries reached for container 1d57d2084734. Exiting log stream.
2025-02-13 04:05:15.140 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:05:15.141 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:05:15.147 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:05:15.152 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
