2025-02-13 04:05:00.508 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:05:00.508 DEBUG [tests.conftest] Running test: test_2_nodes_different_cluster_different_shard with id: 2025-02-13_04-05-00__ee48f2a0-d5e3-4483-a28a-f11024ee1ebc
2025-02-13 04:05:00.508 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:05:00.509 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-13 04:05:00.509 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-13 04:05:00.520 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:05:00.520 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_04-05-00__ee48f2a0-d5e3-4483-a28a-f11024ee1ebc__wakuorg_nwaku:latest.log
2025-02-13 04:05:00.521 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:05:00.521 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:05:00.525 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:05:00.525 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.97.188
2025-02-13 04:05:00.525 DEBUG [src.node.docker_mananger] Generated ports ['9481', '9482', '9483', '9484', '9485']
2025-02-13 04:05:00.526 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2025-02-13 04:05:00.526 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:05:00.526 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:05:00.526 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:05:00.527 DEBUG [src.node.docker_mananger] docker run -i -t -p 9481:9481 -p 9482:9482 -p 9483:9483 -p 9484:9484 -p 9485:9485 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9483 --rest-port=9481 --tcp-port=9482 --discv5-udp-port=9484 --rest-address=0.0.0.0 --nat=extip:172.18.97.188 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=a0cfeb38c8c5f3d85ea1dbf6cace5a2e61f96652d9ebb69cbabf1dba7a6af8bc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9485 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
2025-02-13 04:05:00.748 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.97.188 waku 5bee0c51ea8f21cc60546ce64e848530b2056ce583d6bef20bee77985ce43ee8
2025-02-13 04:05:00.800 DEBUG [src.node.docker_mananger] Container started with ID 5bee0c51ea8f. Setting up logs at ./log/docker/node1_2025-02-13_04-05-00__ee48f2a0-d5e3-4483-a28a-f11024ee1ebc__wakuorg_nwaku:latest.log
2025-02-13 04:05:00.801 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 9481
2025-02-13 04:05:00.801 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:05:01.348 ERROR [src.node.docker_mananger] Max retries reached for container e91e470e670a. Exiting log stream.
2025-02-13 04:05:01.801 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9481/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:01.804 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:05:01.804 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:05:01.804 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9481/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:01.807 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.188/tcp/9482/p2p/16Uiu2HAkug9iQK8NTLNUYbUhLCu12t5NRvnXB2YioAC6givnJ5F1","/ip4/172.18.97.188/tcp/9483/ws/p2p/16Uiu2HAkug9iQK8NTLNUYbUhLCu12t5NRvnXB2YioAC6givnJ5F1"],"enrUri":"enr:-L24QP8N5FwHhEWGWEM7BCDDeje1_CyLWUbSawkxSjNas9L5EJ9K6-vFellcFGrjnAFEM74BSzVDfl5T3QsP4R9zZRsCgmlkgnY0gmlwhKwSYbyKbXVsdGlhZGRyc5YACASsEmG8BiUKAAoErBJhvAYlC90DgnJzhQACAQAAiXNlY3AyNTZrMaECA7V9sU-3tpgKenqsSNvj2BPAGfJByqEaWdUapfs4-xSDdGNwgiUKg3VkcIIlDIV3YWt1MgU"}'
2025-02-13 04:05:01.807 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:05:01.813 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:05:01.813 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_04-05-00__ee48f2a0-d5e3-4483-a28a-f11024ee1ebc__wakuorg_nwaku:latest.log
2025-02-13 04:05:01.814 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:05:01.814 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:05:01.815 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:05:01.815 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.111.224
2025-02-13 04:05:01.815 DEBUG [src.node.docker_mananger] Generated ports ['36208', '36209', '36210', '36211', '36212']
2025-02-13 04:05:01.816 DEBUG [src.node.waku_node] Cluster id was resolved to: 4
2025-02-13 04:05:01.816 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:05:01.816 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:05:01.816 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:05:01.816 DEBUG [src.node.docker_mananger] docker run -i -t -p 36208:36208 -p 36209:36209 -p 36210:36210 -p 36211:36211 -p 36212:36212 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36210 --rest-port=36208 --tcp-port=36209 --discv5-udp-port=36211 --rest-address=0.0.0.0 --nat=extip:172.18.111.224 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=efffba776a0321b4dbd9aedbf367a8fbf9b4ffba9cbb6efdd7c19ebfd24f6d7d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36212 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QP8N5FwHhEWGWEM7BCDDeje1_CyLWUbSawkxSjNas9L5EJ9K6-vFellcFGrjnAFEM74BSzVDfl5T3QsP4R9zZRsCgmlkgnY0gmlwhKwSYbyKbXVsdGlhZGRyc5YACASsEmG8BiUKAAoErBJhvAYlC90DgnJzhQACAQAAiXNlY3AyNTZrMaECA7V9sU-3tpgKenqsSNvj2BPAGfJByqEaWdUapfs4-xSDdGNwgiUKg3VkcIIlDIV3YWt1MgU --pubsub-topic=/waku/2/rs/4/1
2025-02-13 04:05:02.049 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.111.224 waku ce9ee4c0567ac1cf73871d1999dab257494ec7a8c7e3db46b8b110107aafd648
2025-02-13 04:05:02.101 DEBUG [src.node.docker_mananger] Container started with ID ce9ee4c0567a. Setting up logs at ./log/docker/node2_2025-02-13_04-05-00__ee48f2a0-d5e3-4483-a28a-f11024ee1ebc__wakuorg_nwaku:latest.log
2025-02-13 04:05:02.101 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36208
2025-02-13 04:05:02.101 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:05:03.102 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36208/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:03.109 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:05:03.113 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:05:03.114 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36208/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:03.118 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.111.224/tcp/36209/p2p/16Uiu2HAkw8MJ3CZonZTxtcHcG5tsaKEHNofUqhR8ZTXkbJxbDzpF","/ip4/172.18.111.224/tcp/36210/ws/p2p/16Uiu2HAkw8MJ3CZonZTxtcHcG5tsaKEHNofUqhR8ZTXkbJxbDzpF"],"enrUri":"enr:-L24QM73wtsPX2-nImxg1tLG2AXop6jCTWvYnhaceG-kbx_HNetuinRwUK_P5FdCy_uJfNPMADyE13jBxdpLjqUDD3YCgmlkgnY0gmlwhKwSb-CKbXVsdGlhZGRyc5YACASsEm_gBo1xAAoErBJv4AaNct0DgnJzhQAEAQABiXNlY3AyNTZrMaECGUdfVtGHj20dYVrsLJwo8rntfoLP0QTEfaH5D1yl0ViDdGNwgo1xg3VkcIKNc4V3YWt1MgE"}'
2025-02-13 04:05:03.118 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:05:03.119 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36208/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.97.188/tcp/9482/p2p/16Uiu2HAkug9iQK8NTLNUYbUhLCu12t5NRvnXB2YioAC6givnJ5F1"]'
2025-02-13 04:05:03.149 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:03.154 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9481/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-13 04:05:03.161 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:03.162 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36208/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/1"]'
2025-02-13 04:05:03.165 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:03.165 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9481/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:05:03.170 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:03.170 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:05:03.270 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-13 04:05:03.271 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9481/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:03.273 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419503165633280,"ephemeral":false}]'
2025-02-13 04:05:03.275 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:05:03.275 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36208/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:03.277 ERROR [src.node.api_clients.base_client] HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:36208/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b''
2025-02-13 04:05:03.279 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:05:03.280 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:05:03.281 DEBUG [src.node.waku_node] Stopping container with id 5bee0c51ea8f
2025-02-13 04:05:03.893 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:05:03.893 DEBUG [src.node.waku_node] Stopping container with id ce9ee4c0567a
2025-02-13 04:05:04.705 ERROR [src.node.docker_mananger] Max retries reached for container 5bee0c51ea8f. Exiting log stream.
2025-02-13 04:05:05.028 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:05:05.029 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:05:05.037 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:05:05.044 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
