2025-02-13 04:04:01.965 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:04:01.965 DEBUG [tests.conftest] Running test: test_light_push_with_invalid_pubsub_topics with id: 2025-02-13_04-04-01__160a32c4-8332-49ac-a121-14a337f8a59c
2025-02-13 04:04:01.966 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:04:01.966 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-13 04:04:01.972 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:04:01.972 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-13_04-04-01__160a32c4-8332-49ac-a121-14a337f8a59c__wakuorg_nwaku:latest.log
2025-02-13 04:04:01.972 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:04:01.972 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:04:01.974 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:04:01.974 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.215.50
2025-02-13 04:04:01.974 DEBUG [src.node.docker_mananger] Generated ports ['60532', '60533', '60534', '60535', '60536']
2025-02-13 04:04:01.974 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:04:01.974 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:04:01.974 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:04:01.974 DEBUG [src.node.docker_mananger] docker run -i -t -p 60532:60532 -p 60533:60533 -p 60534:60534 -p 60535:60535 -p 60536:60536 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60534 --rest-port=60532 --tcp-port=60533 --discv5-udp-port=60535 --rest-address=0.0.0.0 --nat=extip:172.18.215.50 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=febedcae43caacbe02cb4ef3def1d3f4ca313fcd39cb58a2dccf830a9efa2fd8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60536 --metrics-logging=true --lightpush=true --relay=true
2025-02-13 04:04:02.197 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.215.50 waku a365efb5b657e47af306f615b19c3c6bcd7ce65cb55f152ae5416b47cf61bc82
2025-02-13 04:04:02.249 DEBUG [src.node.docker_mananger] Container started with ID a365efb5b657. Setting up logs at ./log/docker/receiving_node1_2025-02-13_04-04-01__160a32c4-8332-49ac-a121-14a337f8a59c__wakuorg_nwaku:latest.log
2025-02-13 04:04:02.250 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60532
2025-02-13 04:04:02.251 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:04:02.760 ERROR [src.node.docker_mananger] Max retries reached for container b6e348edebdc. Exiting log stream.
2025-02-13 04:04:03.251 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60532/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:03.254 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:04:03.254 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:04:03.255 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60532/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:03.257 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.215.50/tcp/60533/p2p/16Uiu2HAmBGvxNVFzopJC7vULBpXivcHuYhazRMWtbVgaGhC9kaMP","/ip4/172.18.215.50/tcp/60534/ws/p2p/16Uiu2HAmBGvxNVFzopJC7vULBpXivcHuYhazRMWtbVgaGhC9kaMP"],"enrUri":"enr:-L24QISbfnE8YlDUq8MQJPYqhGUDkWH1Vyi5szgLzRFtLPw2T0xDqpEYmFfbtozEoYuuVWLIkMMpFmm8mbyzZScSLdgCgmlkgnY0gmlwhKwS1zKKbXVsdGlhZGRyc5YACASsEtcyBux1AAoErBLXMgbsdt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC632yRSjTuImhtziZg8DSCHfvz6k-CfqQGpJnEs8sT9qDdGNwgux1g3VkcILsd4V3YWt1Mgk"}'
2025-02-13 04:04:03.257 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:04:03.263 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:04:03.264 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-13_04-04-01__160a32c4-8332-49ac-a121-14a337f8a59c__wakuorg_nwaku:latest.log
2025-02-13 04:04:03.264 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:04:03.264 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:04:03.265 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:04:03.265 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.117.84
2025-02-13 04:04:03.265 DEBUG [src.node.docker_mananger] Generated ports ['18043', '18044', '18045', '18046', '18047']
2025-02-13 04:04:03.266 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:04:03.266 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:04:03.266 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:04:03.266 DEBUG [src.node.docker_mananger] docker run -i -t -p 18043:18043 -p 18044:18044 -p 18045:18045 -p 18046:18046 -p 18047:18047 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18045 --rest-port=18043 --tcp-port=18044 --discv5-udp-port=18046 --rest-address=0.0.0.0 --nat=extip:172.18.117.84 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2e79ae5edae8978d977d2232580e6f057de2a0106fc8f2b0d19fafa2fbcd7cde --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18047 --metrics-logging=true --lightpush=false --relay=true
2025-02-13 04:04:03.487 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.117.84 waku e6d56a83d12aa71d11fbc7b539ab9f3de7a4249238f6bdd5e6533d3fe398d5e3
2025-02-13 04:04:03.539 DEBUG [src.node.docker_mananger] Container started with ID e6d56a83d12a. Setting up logs at ./log/docker/receiving_node2_2025-02-13_04-04-01__160a32c4-8332-49ac-a121-14a337f8a59c__wakuorg_nwaku:latest.log
2025-02-13 04:04:03.539 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 18043
2025-02-13 04:04:03.539 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:04:04.540 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18043/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:04.542 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:04:04.543 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:04:04.543 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18043/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:04.545 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.117.84/tcp/18044/p2p/16Uiu2HAkzcc6nhucD19PSteL9VCyUSqWonzDwqKJfvsFrixn2REB","/ip4/172.18.117.84/tcp/18045/ws/p2p/16Uiu2HAkzcc6nhucD19PSteL9VCyUSqWonzDwqKJfvsFrixn2REB"],"enrUri":"enr:-L24QHQ7mByqlg5oVYGwRSc-LxkMMOvo8BAz7IOyo531uIDhOFp07mDBHRhngZ3tR8vk4wIXQ0aOYXadEKbYgb3Jx0cCgmlkgnY0gmlwhKwSdVSKbXVsdGlhZGRyc5YACASsEnVUBkZ8AAoErBJ1VAZGfd0DgnJzhQADAQAAiXNlY3AyNTZrMaECTRdv5SSUgmhXXMGP-dhh_w7-u1azfZ2zCk2rO7qvwnSDdGNwgkZ8g3VkcIJGfoV3YWt1MgE"}'
2025-02-13 04:04:04.545 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:04:04.545 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18043/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.215.50/tcp/60533/p2p/16Uiu2HAmBGvxNVFzopJC7vULBpXivcHuYhazRMWtbVgaGhC9kaMP"]'
2025-02-13 04:04:04.584 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:04.596 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:04:04.596 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-13_04-04-01__160a32c4-8332-49ac-a121-14a337f8a59c__wakuorg_nwaku:latest.log
2025-02-13 04:04:04.596 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:04:04.596 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:04:04.598 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:04:04.598 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.239.197
2025-02-13 04:04:04.598 DEBUG [src.node.docker_mananger] Generated ports ['58232', '58233', '58234', '58235', '58236']
2025-02-13 04:04:04.598 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:04:04.598 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:04:04.598 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:04:04.599 DEBUG [src.node.docker_mananger] docker run -i -t -p 58232:58232 -p 58233:58233 -p 58234:58234 -p 58235:58235 -p 58236:58236 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=58234 --rest-port=58232 --tcp-port=58233 --discv5-udp-port=58235 --rest-address=0.0.0.0 --nat=extip:172.18.239.197 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ba4efbf0dd837203a8ed8ccf08566fe3fb1d64e3ed9ffcb6957fdf8fc588c2c4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=58236 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QISbfnE8YlDUq8MQJPYqhGUDkWH1Vyi5szgLzRFtLPw2T0xDqpEYmFfbtozEoYuuVWLIkMMpFmm8mbyzZScSLdgCgmlkgnY0gmlwhKwS1zKKbXVsdGlhZGRyc5YACASsEtcyBux1AAoErBLXMgbsdt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC632yRSjTuImhtziZg8DSCHfvz6k-CfqQGpJnEs8sT9qDdGNwgux1g3VkcILsd4V3YWt1Mgk --lightpushnode=/ip4/172.18.215.50/tcp/60533/p2p/16Uiu2HAmBGvxNVFzopJC7vULBpXivcHuYhazRMWtbVgaGhC9kaMP --lightpush=true --relay=false
2025-02-13 04:04:04.833 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.239.197 waku d0820b2f9700e4bdf3c52e806a0d22d3b9ad40bdad3b82f0290254b373284770
2025-02-13 04:04:04.877 DEBUG [src.node.docker_mananger] Container started with ID d0820b2f9700. Setting up logs at ./log/docker/lightpush_node1_2025-02-13_04-04-01__160a32c4-8332-49ac-a121-14a337f8a59c__wakuorg_nwaku:latest.log
2025-02-13 04:04:04.877 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 58232
2025-02-13 04:04:04.877 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:04:05.877 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58232/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:05.881 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:04:05.881 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:04:05.881 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:58232/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:05.883 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.239.197/tcp/58233/p2p/16Uiu2HAmTWYsyrgfCseuV2Hf5FLjjqD4H2Ms487kAGBG1otnR1aE","/ip4/172.18.239.197/tcp/58234/ws/p2p/16Uiu2HAmTWYsyrgfCseuV2Hf5FLjjqD4H2Ms487kAGBG1otnR1aE"],"enrUri":"enr:-L24QOWGnJ76ZpTmiDWvCo5MGtFuJNlp8hBbXGXK-wKqDl4DVI0h6wSEzRmWlLFOmbKtkIeLW4PaqQp4rd3gMgfM0N8CgmlkgnY0gmlwhKwS78WKbXVsdGlhZGRyc5YACASsEu_FBuN5AAoErBLvxQbjet0DgnJzhQADAQAAiXNlY3AyNTZrMaED3LXbgelmB9ZYoXR572i7xtGJN3VdwEc1lWNP0rsCXHeDdGNwguN5g3VkcILje4V3YWt1Mgg"}'
2025-02-13 04:04:05.883 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:04:05.884 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58232/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.215.50/tcp/60533/p2p/16Uiu2HAmBGvxNVFzopJC7vULBpXivcHuYhazRMWtbVgaGhC9kaMP"]'
2025-02-13 04:04:05.919 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:05.920 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58232/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.117.84/tcp/18044/p2p/16Uiu2HAkzcc6nhucD19PSteL9VCyUSqWonzDwqKJfvsFrixn2REB"]'
2025-02-13 04:04:05.947 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:05.947 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60532/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:04:05.960 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:05.960 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18043/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:04:05.964 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:05.966 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'A dictionary', 'value': {'key': 'YWFh'}}
2025-02-13 04:04:05.966 DEBUG [src.steps.light_push] Lightpushing message
2025-02-13 04:04:05.967 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58232/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": {"key": "YWFh"}, "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739419445966870528}}'
2025-02-13 04:04:05.969 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58232/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 04:04:05.970 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'An integer', 'value': 1234567890}
2025-02-13 04:04:05.970 DEBUG [src.steps.light_push] Lightpushing message
2025-02-13 04:04:05.971 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58232/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": 1234567890, "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739419445970929664}}'
2025-02-13 04:04:05.973 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58232/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 04:04:05.974 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'A list', 'value': ['YWFh']}
2025-02-13 04:04:05.974 DEBUG [src.steps.light_push] Lightpushing message
2025-02-13 04:04:05.974 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58232/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": ["YWFh"], "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739419445974392576}}'
2025-02-13 04:04:05.976 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58232/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 04:04:05.977 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'A bool', 'value': True}
2025-02-13 04:04:05.977 DEBUG [src.steps.light_push] Lightpushing message
2025-02-13 04:04:05.977 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:58232/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": true, "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739419445977745664}}'
2025-02-13 04:04:05.980 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:58232/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 04:04:05.982 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:04:05.982 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:04:05.983 DEBUG [src.node.waku_node] Stopping container with id a365efb5b657
2025-02-13 04:04:06.779 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:04:06.780 DEBUG [src.node.waku_node] Stopping container with id e6d56a83d12a
2025-02-13 04:04:07.591 ERROR [src.node.docker_mananger] Max retries reached for container a365efb5b657. Exiting log stream.
2025-02-13 04:04:08.283 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:04:08.283 DEBUG [src.node.waku_node] Stopping container with id d0820b2f9700
2025-02-13 04:04:09.094 ERROR [src.node.docker_mananger] Max retries reached for container e6d56a83d12a. Exiting log stream.
2025-02-13 04:04:09.776 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:04:09.777 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:04:09.784 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:04:09.790 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:04:09.796 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
