2025-02-13 04:05:30.640 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:05:30.641 DEBUG [tests.conftest] Running test: test_legacy_store_v1 with id: 2025-02-13_04-05-30__338ac8a2-b92d-4bb5-ac4c-a4e5af8b4ca0
2025-02-13 04:05:30.641 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:05:30.641 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-13 04:05:30.641 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-13 04:05:30.650 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:05:30.650 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-13_04-05-30__338ac8a2-b92d-4bb5-ac4c-a4e5af8b4ca0__wakuorg_nwaku:latest.log
2025-02-13 04:05:30.650 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:05:30.650 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:05:30.652 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:05:30.652 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.189.181
2025-02-13 04:05:30.652 DEBUG [src.node.docker_mananger] Generated ports ['19640', '19641', '19642', '19643', '19644']
2025-02-13 04:05:30.652 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:05:30.652 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:05:30.652 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:05:30.652 DEBUG [src.node.docker_mananger] docker run -i -t -p 19640:19640 -p 19641:19641 -p 19642:19642 -p 19643:19643 -p 19644:19644 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19642 --rest-port=19640 --tcp-port=19641 --discv5-udp-port=19643 --rest-address=0.0.0.0 --nat=extip:172.18.189.181 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ebf2c60179b8f27c088cde3fb2f20eacd2e40e57f00825fafcc2eea328ed9943 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19644 --metrics-logging=true --store=true --relay=true
2025-02-13 04:05:30.889 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.189.181 waku 0890bee6c885eb25bc1e721f6e206d9d7332f1196105ec91c2f1836ae24a9c0c
2025-02-13 04:05:30.938 DEBUG [src.node.docker_mananger] Container started with ID 0890bee6c885. Setting up logs at ./log/docker/publishing_node1_2025-02-13_04-05-30__338ac8a2-b92d-4bb5-ac4c-a4e5af8b4ca0__wakuorg_nwaku:latest.log
2025-02-13 04:05:30.940 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19640
2025-02-13 04:05:30.944 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:05:31.442 ERROR [src.node.docker_mananger] Max retries reached for container b86a1c9d962c. Exiting log stream.
2025-02-13 04:05:31.944 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19640/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:31.947 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:05:31.947 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:05:31.948 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19640/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:31.950 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.189.181/tcp/19641/p2p/16Uiu2HAmSiwBizk91kXcyKNmAVUYKiLmY9N6Fy2cNTjKZB9FNyt8","/ip4/172.18.189.181/tcp/19642/ws/p2p/16Uiu2HAmSiwBizk91kXcyKNmAVUYKiLmY9N6Fy2cNTjKZB9FNyt8"],"enrUri":"enr:-L24QP4fzFedU4BC1YkvytYhTgPJTpv9M_RlRAuNeJmyV7CmNxyhCvx1_yRvLu7uSZOs2Ylh5fbbO_ez5ATYPticYPMCgmlkgnY0gmlwhKwSvbWKbXVsdGlhZGRyc5YACASsEr21Bky5AAoErBK9tQZMut0DgnJzhQADAQAAiXNlY3AyNTZrMaED0QZck4LU7NbToDsLBRvZnciUYA5iT0oJS7Tf52_UeR2DdGNwgky5g3VkcIJMu4V3YWt1MgM"}'
2025-02-13 04:05:31.950 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:05:31.957 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:05:31.957 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-13_04-05-30__338ac8a2-b92d-4bb5-ac4c-a4e5af8b4ca0__wakuorg_nwaku:latest.log
2025-02-13 04:05:31.957 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:05:31.957 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:05:31.959 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:05:31.959 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.14
2025-02-13 04:05:31.959 DEBUG [src.node.docker_mananger] Generated ports ['64027', '64028', '64029', '64030', '64031']
2025-02-13 04:05:31.959 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:05:31.959 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:05:31.960 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:05:31.960 DEBUG [src.node.docker_mananger] docker run -i -t -p 64027:64027 -p 64028:64028 -p 64029:64029 -p 64030:64030 -p 64031:64031 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=64029 --rest-port=64027 --tcp-port=64028 --discv5-udp-port=64030 --rest-address=0.0.0.0 --nat=extip:172.18.254.14 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0d3c63dc8bb18cb0ebbcb69a2cd83fd99fde35da83e056e9e7b952b81d1f79a1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=64031 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QP4fzFedU4BC1YkvytYhTgPJTpv9M_RlRAuNeJmyV7CmNxyhCvx1_yRvLu7uSZOs2Ylh5fbbO_ez5ATYPticYPMCgmlkgnY0gmlwhKwSvbWKbXVsdGlhZGRyc5YACASsEr21Bky5AAoErBK9tQZMut0DgnJzhQADAQAAiXNlY3AyNTZrMaED0QZck4LU7NbToDsLBRvZnciUYA5iT0oJS7Tf52_UeR2DdGNwgky5g3VkcIJMu4V3YWt1MgM --storenode=/ip4/172.18.189.181/tcp/19641/p2p/16Uiu2HAmSiwBizk91kXcyKNmAVUYKiLmY9N6Fy2cNTjKZB9FNyt8 --store=true --relay=true
2025-02-13 04:05:32.198 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.14 waku 4d87a6a3f28a798dfad72bf64f1b6a3547fb8e49aa64449b2da21a8ae63df5eb
2025-02-13 04:05:32.250 DEBUG [src.node.docker_mananger] Container started with ID 4d87a6a3f28a. Setting up logs at ./log/docker/store_node1_2025-02-13_04-05-30__338ac8a2-b92d-4bb5-ac4c-a4e5af8b4ca0__wakuorg_nwaku:latest.log
2025-02-13 04:05:32.251 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 64027
2025-02-13 04:05:32.252 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:05:33.252 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64027/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:33.255 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:05:33.255 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:05:33.255 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64027/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:33.258 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.14/tcp/64028/p2p/16Uiu2HAmLVZ8jh3AofYtigEeSBxZQUGh3g4YdvGeUyDdr8PVfxfz","/ip4/172.18.254.14/tcp/64029/ws/p2p/16Uiu2HAmLVZ8jh3AofYtigEeSBxZQUGh3g4YdvGeUyDdr8PVfxfz"],"enrUri":"enr:-L24QJPxoi9vrj_CZ7TJsvtGwvIpSF-HzhVgXJsIhb5vLOEdRcI6SAq99D2AiszNrCH59CoZNC9tdr87IkzgfV-rF6UCgmlkgnY0gmlwhKwS_g6KbXVsdGlhZGRyc5YACASsEv4OBvocAAoErBL-Dgb6Hd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDdHLBfV9k7W6rFml01xRuk5sub1c6OM2wY30-1kKymUGDdGNwgvocg3VkcIL6HoV3YWt1MgM"}'
2025-02-13 04:05:33.258 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:05:33.258 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:64027/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.189.181/tcp/19641/p2p/16Uiu2HAmSiwBizk91kXcyKNmAVUYKiLmY9N6Fy2cNTjKZB9FNyt8"]'
2025-02-13 04:05:33.261 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:33.261 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19640/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:05:33.263 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:33.264 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:64027/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:05:33.266 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:33.267 DEBUG [src.steps.store] Relaying message
2025-02-13 04:05:33.267 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19640/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:05:33.273 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:05:33.273 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-13 04:05:33.474 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19640/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:33.478 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419533267419392,"ephemeral":false}]}'
2025-02-13 04:05:33.478 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:64027/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:05:33.481 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419533267419392,"ephemeral":false}]}'
2025-02-13 04:05:33.482 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:05:33.483 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:05:33.483 DEBUG [src.node.waku_node] Stopping container with id 0890bee6c885
2025-02-13 04:05:34.489 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:05:34.490 DEBUG [src.node.waku_node] Stopping container with id 4d87a6a3f28a
2025-02-13 04:05:35.303 ERROR [src.node.docker_mananger] Max retries reached for container 0890bee6c885. Exiting log stream.
2025-02-13 04:05:35.733 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:05:35.736 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:05:35.741 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:05:35.746 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
