2025-02-13 04:02:58.710 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:02:58.711 DEBUG [tests.conftest] Running test: test_main_node_full__peer_full with id: 2025-02-13_04-02-58__18b8193a-732a-4899-8e6b-90b7e04dd59b
2025-02-13 04:02:58.711 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:02:58.711 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-13 04:02:58.718 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:02:58.718 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-13_04-02-58__18b8193a-732a-4899-8e6b-90b7e04dd59b__wakuorg_nwaku:latest.log
2025-02-13 04:02:58.718 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:02:58.718 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:02:58.719 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:02:58.719 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.68.77
2025-02-13 04:02:58.720 DEBUG [src.node.docker_mananger] Generated ports ['60076', '60077', '60078', '60079', '60080']
2025-02-13 04:02:58.720 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:02:58.720 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:02:58.720 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:02:58.720 DEBUG [src.node.docker_mananger] docker run -i -t -p 60076:60076 -p 60077:60077 -p 60078:60078 -p 60079:60079 -p 60080:60080 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60078 --rest-port=60076 --tcp-port=60077 --discv5-udp-port=60079 --rest-address=0.0.0.0 --nat=extip:172.18.68.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8c84caa47eeefb18a22df4ccf2abd28e2ccfb89df7f170b92ff3fa5b1c9e78ea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60080 --metrics-logging=true --lightpush=true --relay=true --filter=true
2025-02-13 04:02:58.941 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.68.77 waku 4d3601c1c7d1ef41d409aa655c42afb3edec38d957a132ad72ec6d6269ec1359
2025-02-13 04:02:58.987 DEBUG [src.node.docker_mananger] Container started with ID 4d3601c1c7d1. Setting up logs at ./log/docker/receiving_node1_2025-02-13_04-02-58__18b8193a-732a-4899-8e6b-90b7e04dd59b__wakuorg_nwaku:latest.log
2025-02-13 04:02:58.988 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60076
2025-02-13 04:02:58.989 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:02:59.510 ERROR [src.node.docker_mananger] Max retries reached for container 6a9419a3cbaa. Exiting log stream.
2025-02-13 04:02:59.991 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60076/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:02:59.994 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:02:59.994 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:02:59.994 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60076/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:02:59.996 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.68.77/tcp/60077/p2p/16Uiu2HAmTFANBRaDS9dTznxXZLpT5tYDja8hSTu89iSdD2uLGAxS","/ip4/172.18.68.77/tcp/60078/ws/p2p/16Uiu2HAmTFANBRaDS9dTznxXZLpT5tYDja8hSTu89iSdD2uLGAxS"],"enrUri":"enr:-L24QF_05lTF767ilmn84qcoWj0oYba6Hi-Z10WvBJPqx9zbTdOX9Pyk4zpnmaDSP4CR97vHLraZfRNhKFuh63QPhS0CgmlkgnY0gmlwhKwSRE2KbXVsdGlhZGRyc5YACASsEkRNBuqtAAoErBJETQbqrt0DgnJzhQADAQAAiXNlY3AyNTZrMaED2MSwWjtPU3xz4clejvR25qG6td6GsNM3nb6GdshhDhuDdGNwguqtg3VkcILqr4V3YWt1Mg0"}'
2025-02-13 04:02:59.997 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:03:00.003 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:03:00.003 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-13_04-02-58__18b8193a-732a-4899-8e6b-90b7e04dd59b__wakuorg_nwaku:latest.log
2025-02-13 04:03:00.003 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:03:00.003 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:03:00.004 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:03:00.004 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.248.59
2025-02-13 04:03:00.004 DEBUG [src.node.docker_mananger] Generated ports ['6729', '6730', '6731', '6732', '6733']
2025-02-13 04:03:00.005 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:03:00.005 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:03:00.005 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:03:00.005 DEBUG [src.node.docker_mananger] docker run -i -t -p 6729:6729 -p 6730:6730 -p 6731:6731 -p 6732:6732 -p 6733:6733 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6731 --rest-port=6729 --tcp-port=6730 --discv5-udp-port=6732 --rest-address=0.0.0.0 --nat=extip:172.18.248.59 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0f9fc5454aea3a1e90f4dc017cad9ce3f7d08dcaf1768cd8cfec1aa7ed17aa8e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6733 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QF_05lTF767ilmn84qcoWj0oYba6Hi-Z10WvBJPqx9zbTdOX9Pyk4zpnmaDSP4CR97vHLraZfRNhKFuh63QPhS0CgmlkgnY0gmlwhKwSRE2KbXVsdGlhZGRyc5YACASsEkRNBuqtAAoErBJETQbqrt0DgnJzhQADAQAAiXNlY3AyNTZrMaED2MSwWjtPU3xz4clejvR25qG6td6GsNM3nb6GdshhDhuDdGNwguqtg3VkcILqr4V3YWt1Mg0 --lightpushnode=/ip4/172.18.68.77/tcp/60077/p2p/16Uiu2HAmTFANBRaDS9dTznxXZLpT5tYDja8hSTu89iSdD2uLGAxS --lightpush=true --relay=true --filter=true
2025-02-13 04:03:00.229 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.248.59 waku ed2d2b3a31814ddacdb4630929228c597026758c2036c29d4b753e448743513c
2025-02-13 04:03:00.274 DEBUG [src.node.docker_mananger] Container started with ID ed2d2b3a3181. Setting up logs at ./log/docker/lightpush_node1_2025-02-13_04-02-58__18b8193a-732a-4899-8e6b-90b7e04dd59b__wakuorg_nwaku:latest.log
2025-02-13 04:03:00.275 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6729
2025-02-13 04:03:00.275 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:03:01.275 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6729/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:01.278 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:03:01.278 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:03:01.278 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6729/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:01.280 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.248.59/tcp/6730/p2p/16Uiu2HAkyb6tAS1YR3k5NK1i3jqZvz22q9Tcw3bwSxRqucNzz5Jk","/ip4/172.18.248.59/tcp/6731/ws/p2p/16Uiu2HAkyb6tAS1YR3k5NK1i3jqZvz22q9Tcw3bwSxRqucNzz5Jk"],"enrUri":"enr:-L24QIbzZBTruxdVSMUUYgyiR4byAHOGxRqJvdoN56Xgjgx5Qa0HDtwMU1W1RDTLj7eI0O1Gh4SThSqPkJTF8Cv24jQCgmlkgnY0gmlwhKwS-DuKbXVsdGlhZGRyc5YACASsEvg7BhpKAAoErBL4OwYaS90DgnJzhQADAQAAiXNlY3AyNTZrMaECPdkiAG9908hsEViTyRppkXNNfNqDqqoMUk6sBtGxmu2DdGNwghpKg3VkcIIaTIV3YWt1Mg0"}'
2025-02-13 04:03:01.280 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:03:01.281 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6729/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.68.77/tcp/60077/p2p/16Uiu2HAmTFANBRaDS9dTznxXZLpT5tYDja8hSTu89iSdD2uLGAxS"]'
2025-02-13 04:03:10.243 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:10.243 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60076/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:03:10.246 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:10.246 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6729/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:03:10.248 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:10.248 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-13 04:03:10.749 DEBUG [src.steps.light_push] Lightpushing message
2025-02-13 04:03:10.749 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6729/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739419390749525248}}'
2025-02-13 04:03:10.760 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:10.760 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:10.861 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-13 04:03:10.861 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60076/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:10.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419390749525248,"ephemeral":false}]'
2025-02-13 04:03:10.865 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-13 04:03:10.865 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6729/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:10.867 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419390749525248,"ephemeral":false}]'
2025-02-13 04:03:10.869 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:03:10.870 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:03:10.871 DEBUG [src.node.waku_node] Stopping container with id 4d3601c1c7d1
2025-02-13 04:03:11.463 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:03:11.463 DEBUG [src.node.waku_node] Stopping container with id ed2d2b3a3181
2025-02-13 04:03:12.246 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:03:12.249 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:03:12.255 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:03:12.261 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
