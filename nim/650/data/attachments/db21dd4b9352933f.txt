2025-02-13 04:04:01.925 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:04:01.926 DEBUG [tests.conftest] Running test: test_msg_stored_when_ephemeral_false with id: 2025-02-13_04-04-01__dbbd7bae-d535-491e-867c-c6072f6bd67d
2025-02-13 04:04:01.926 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:04:01.926 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-13 04:04:01.926 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-13 04:04:01.933 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:04:01.933 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_04-04-01__dbbd7bae-d535-491e-867c-c6072f6bd67d__wakuorg_nwaku:latest.log
2025-02-13 04:04:01.939 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:04:01.939 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_04-04-01__dbbd7bae-d535-491e-867c-c6072f6bd67d__wakuorg_nwaku:latest.log
2025-02-13 04:04:01.944 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:04:01.944 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-13_04-04-01__dbbd7bae-d535-491e-867c-c6072f6bd67d__wakuorg_nwaku:latest.log
2025-02-13 04:04:01.945 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-13 04:04:01.945 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-13 04:04:01.946 DEBUG [tests.e2e.test_e2e] Start 3 nodes
2025-02-13 04:04:01.946 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:04:01.946 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:04:01.947 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:04:01.948 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.166.239
2025-02-13 04:04:01.948 DEBUG [src.node.docker_mananger] Generated ports ['11516', '11517', '11518', '11519', '11520']
2025-02-13 04:04:01.948 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:04:01.948 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:04:01.948 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:04:01.948 DEBUG [src.node.docker_mananger] docker run -i -t -p 11516:11516 -p 11517:11517 -p 11518:11518 -p 11519:11519 -p 11520:11520 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11518 --rest-port=11516 --tcp-port=11517 --discv5-udp-port=11519 --rest-address=0.0.0.0 --nat=extip:172.18.166.239 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ffbe40dec2ceaa9d2e2bb2bfb9daebeba9eae228c46ade3fd6e220c2f9080fcd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11520 --metrics-logging=true --relay=true --store=true
2025-02-13 04:04:02.195 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.166.239 waku 21e5cc488c3221dd828cc22ef8b5bf2b4fae16da9e8c19e24ddc1835811fe31c
2025-02-13 04:04:02.243 DEBUG [src.node.docker_mananger] Container started with ID 21e5cc488c32. Setting up logs at ./log/docker/node1_2025-02-13_04-04-01__dbbd7bae-d535-491e-867c-c6072f6bd67d__wakuorg_nwaku:latest.log
2025-02-13 04:04:02.244 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 11516
2025-02-13 04:04:02.244 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:04:02.703 ERROR [src.node.docker_mananger] Max retries reached for container 95819276ed45. Exiting log stream.
2025-02-13 04:04:03.245 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11516/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:03.249 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:04:03.249 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:04:03.250 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11516/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:03.252 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.166.239/tcp/11517/p2p/16Uiu2HAmVLy1drBuhXdqrDZmNzFhmvXxZP7yRxnRAsLF9VDJZtm1","/ip4/172.18.166.239/tcp/11518/ws/p2p/16Uiu2HAmVLy1drBuhXdqrDZmNzFhmvXxZP7yRxnRAsLF9VDJZtm1"],"enrUri":"enr:-L24QDyPwMZh556fnWQ932ENqjGOdgJYiduRXAJPuTw4lo7TEUWZAzAbBfg8MBclwbmjmxncV89vKyR2gBKyZbgqWtECgmlkgnY0gmlwhKwSpu-KbXVsdGlhZGRyc5YACASsEqbvBiz9AAoErBKm7wYs_t0DgnJzhQADAQAAiXNlY3AyNTZrMaED9_i1lt9iXGyHFP0OC6KML5xaAL-sdsZdVkg7QlgsHbSDdGNwgiz9g3VkcIIs_4V3YWt1MgM"}'
2025-02-13 04:04:03.252 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:04:03.253 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:04:03.253 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:04:03.255 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:04:03.255 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.105.210
2025-02-13 04:04:03.255 DEBUG [src.node.docker_mananger] Generated ports ['13838', '13839', '13840', '13841', '13842']
2025-02-13 04:04:03.255 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:04:03.255 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:04:03.256 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:04:03.256 DEBUG [src.node.docker_mananger] docker run -i -t -p 13838:13838 -p 13839:13839 -p 13840:13840 -p 13841:13841 -p 13842:13842 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13840 --rest-port=13838 --tcp-port=13839 --discv5-udp-port=13841 --rest-address=0.0.0.0 --nat=extip:172.18.105.210 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=72310a6f34d2ca12bcd1709de52dda4d155ccce15d45ab7f2eef4fdce6ab8bcd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13842 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QDyPwMZh556fnWQ932ENqjGOdgJYiduRXAJPuTw4lo7TEUWZAzAbBfg8MBclwbmjmxncV89vKyR2gBKyZbgqWtECgmlkgnY0gmlwhKwSpu-KbXVsdGlhZGRyc5YACASsEqbvBiz9AAoErBKm7wYs_t0DgnJzhQADAQAAiXNlY3AyNTZrMaED9_i1lt9iXGyHFP0OC6KML5xaAL-sdsZdVkg7QlgsHbSDdGNwgiz9g3VkcIIs_4V3YWt1MgM
2025-02-13 04:04:03.507 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.105.210 waku 8958880502f2ede8681de2b0077ed45b713f7318bcc6214337a0561e193b2238
2025-02-13 04:04:03.559 DEBUG [src.node.docker_mananger] Container started with ID 8958880502f2. Setting up logs at ./log/docker/node2_2025-02-13_04-04-01__dbbd7bae-d535-491e-867c-c6072f6bd67d__wakuorg_nwaku:latest.log
2025-02-13 04:04:03.561 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 13838
2025-02-13 04:04:03.561 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:04:04.561 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13838/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:04.565 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:04:04.565 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:04:04.566 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13838/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:04.570 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.105.210/tcp/13839/p2p/16Uiu2HAmScuFTbaBCiQgwErUaVJBbwWGYqEWms5Ffy8mH8zkUUWR","/ip4/172.18.105.210/tcp/13840/ws/p2p/16Uiu2HAmScuFTbaBCiQgwErUaVJBbwWGYqEWms5Ffy8mH8zkUUWR"],"enrUri":"enr:-L24QFPyjyqPFyhTlO0mEjcl7TLZwzEBSxcc0BUkGZ2BNOzBeJhmyBBxVYUcbqksGIjHaFFDJQ5ks23CdV662A81dPECgmlkgnY0gmlwhKwSadKKbXVsdGlhZGRyc5YACASsEmnSBjYPAAoErBJp0gY2EN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDz3qwK8G0oZeTuEDQeoKt11ffdkNrBW0j-fTPQRthM76DdGNwgjYPg3VkcII2EYV3YWt1MgM"}'
2025-02-13 04:04:04.571 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:04:04.573 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:04:04.575 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:04:04.584 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:04:04.584 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.92.87
2025-02-13 04:04:04.585 DEBUG [src.node.docker_mananger] Generated ports ['51594', '51595', '51596', '51597', '51598']
2025-02-13 04:04:04.585 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:04:04.585 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:04:04.585 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:04:04.585 DEBUG [src.node.docker_mananger] docker run -i -t -p 51594:51594 -p 51595:51595 -p 51596:51596 -p 51597:51597 -p 51598:51598 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51596 --rest-port=51594 --tcp-port=51595 --discv5-udp-port=51597 --rest-address=0.0.0.0 --nat=extip:172.18.92.87 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fddc5dd83b41bdfbfae2c416a8efaaa0bcea69b7996a47eac2bc27abd038be29 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51598 --metrics-logging=true --relay=false --storenode=/ip4/172.18.105.210/tcp/13839/p2p/16Uiu2HAmScuFTbaBCiQgwErUaVJBbwWGYqEWms5Ffy8mH8zkUUWR --discv5-bootstrap-node=enr:-L24QFPyjyqPFyhTlO0mEjcl7TLZwzEBSxcc0BUkGZ2BNOzBeJhmyBBxVYUcbqksGIjHaFFDJQ5ks23CdV662A81dPECgmlkgnY0gmlwhKwSadKKbXVsdGlhZGRyc5YACASsEmnSBjYPAAoErBJp0gY2EN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDz3qwK8G0oZeTuEDQeoKt11ffdkNrBW0j-fTPQRthM76DdGNwgjYPg3VkcII2EYV3YWt1MgM
2025-02-13 04:04:04.852 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.92.87 waku 27444504a4f046433f603486729f9795beee985d888e53a0fb2b16c410e8cfa7
2025-02-13 04:04:04.905 DEBUG [src.node.docker_mananger] Container started with ID 27444504a4f0. Setting up logs at ./log/docker/node3_2025-02-13_04-04-01__dbbd7bae-d535-491e-867c-c6072f6bd67d__wakuorg_nwaku:latest.log
2025-02-13 04:04:04.906 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 51594
2025-02-13 04:04:04.907 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:04:05.907 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51594/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:05.910 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:04:05.910 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:04:05.911 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51594/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:05.913 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.92.87/tcp/51595/p2p/16Uiu2HAmCzVWwj59vhycQFqbneTQBLPbhCu36rGVKML5oXzWNpey","/ip4/172.18.92.87/tcp/51596/ws/p2p/16Uiu2HAmCzVWwj59vhycQFqbneTQBLPbhCu36rGVKML5oXzWNpey"],"enrUri":"enr:-L24QAZNgzrXGrQ7NUWsjDTiuwvF4h9M_2Rt9o_F_FDEDXHXOh2ZGh9xMhJAg253fXJL13Cuxyt3PJKZtV-9t-9i_CICgmlkgnY0gmlwhKwSXFeKbXVsdGlhZGRyc5YACASsElxXBsmLAAoErBJcVwbJjN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDBP8DlNlwElIVETGzw7dsl6pyZVdkrUt3HeCdfzY6s26DdGNwgsmLg3VkcILJjYV3YWt1MgA"}'
2025-02-13 04:04:05.913 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:04:05.913 DEBUG [tests.e2e.test_e2e] Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
2025-02-13 04:04:05.913 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11516/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 04:04:05.921 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:05.922 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13838/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 04:04:05.929 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:05.930 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11516/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:05.934 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.105.210/tcp/13839/p2p/16Uiu2HAmScuFTbaBCiQgwErUaVJBbwWGYqEWms5Ffy8mH8zkUUWR","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
2025-02-13 04:04:05.934 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13838/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:05.937 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.166.239/tcp/11517/p2p/16Uiu2HAmVLy1drBuhXdqrDZmNzFhmvXxZP7yRxnRAsLF9VDJZtm1","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
2025-02-13 04:04:05.937 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-13 04:04:35.938 DEBUG [tests.e2e.test_e2e] Node1 publish message with ephemeral = false
2025-02-13 04:04:35.938 DEBUG [src.steps.store] Relaying message
2025-02-13 04:04:35.939 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11516/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2025-02-13 04:04:35.945 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:04:35.946 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-13 04:04:36.147 DEBUG [src.libs.common] Sleeping for 3 seconds
2025-02-13 04:04:39.147 DEBUG [tests.e2e.test_e2e] Check if message is stored 
2025-02-13 04:04:39.148 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-13 04:04:39.148 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51594/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:04:39.194 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1e29e742d6cd7bdea686","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb4a541a4443094323730f900fd134473599f6587fc68d3ed33c52adfc66cd843"}]}'
2025-02-13 04:04:39.201 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:04:39.202 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:04:39.202 DEBUG [src.node.waku_node] Stopping container with id 21e5cc488c32
2025-02-13 04:04:40.113 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:04:40.114 DEBUG [src.node.waku_node] Stopping container with id 8958880502f2
2025-02-13 04:04:40.959 ERROR [src.node.docker_mananger] Max retries reached for container 21e5cc488c32. Exiting log stream.
2025-02-13 04:04:41.148 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:04:41.149 DEBUG [src.node.waku_node] Stopping container with id 27444504a4f0
2025-02-13 04:04:41.962 ERROR [src.node.docker_mananger] Max retries reached for container 8958880502f2. Exiting log stream.
2025-02-13 04:04:42.659 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:04:42.661 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:04:42.682 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:04:42.695 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:04:42.699 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
