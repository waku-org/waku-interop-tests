2025-02-13 04:02:47.741 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:02:47.741 DEBUG [tests.conftest] Running test: test_filter_subscribe_with_invalid_content_topic_format with id: 2025-02-13_04-02-47__99899fa2-471d-431c-a2ab-08c2a0e82cf9
2025-02-13 04:02:47.741 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:02:47.741 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-13 04:02:47.742 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-13 04:02:47.747 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:02:47.747 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_04-02-47__99899fa2-471d-431c-a2ab-08c2a0e82cf9__wakuorg_nwaku:latest.log
2025-02-13 04:02:47.748 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:02:47.748 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:02:47.749 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:02:47.749 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.78.223
2025-02-13 04:02:47.749 DEBUG [src.node.docker_mananger] Generated ports ['36033', '36034', '36035', '36036', '36037']
2025-02-13 04:02:47.750 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:02:47.750 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:02:47.750 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:02:47.750 DEBUG [src.node.docker_mananger] docker run -i -t -p 36033:36033 -p 36034:36034 -p 36035:36035 -p 36036:36036 -p 36037:36037 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36035 --rest-port=36033 --tcp-port=36034 --discv5-udp-port=36036 --rest-address=0.0.0.0 --nat=extip:172.18.78.223 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5be4afee0c8959d73b9ef0bbecce2ca4f56f37cddbd9a75c0d37b975eea9023b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36037 --metrics-logging=true --relay=true --filter=true
2025-02-13 04:02:47.981 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.78.223 waku 14ac7603b6968fd0ac14dfdc79e230e69c189bddb7dcfb1acf12e9a3ada04418
2025-02-13 04:02:48.027 DEBUG [src.node.docker_mananger] Container started with ID 14ac7603b696. Setting up logs at ./log/docker/node1_2025-02-13_04-02-47__99899fa2-471d-431c-a2ab-08c2a0e82cf9__wakuorg_nwaku:latest.log
2025-02-13 04:02:48.027 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 36033
2025-02-13 04:02:48.027 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:02:48.547 ERROR [src.node.docker_mananger] Max retries reached for container 22674ea16341. Exiting log stream.
2025-02-13 04:02:49.028 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36033/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:02:49.031 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:02:49.031 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:02:49.031 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36033/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:02:49.033 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.78.223/tcp/36034/p2p/16Uiu2HAkucTBmn4THn6DL6MJ8V9PacW5Edxv9iBj3eEjwntbkm8K","/ip4/172.18.78.223/tcp/36035/ws/p2p/16Uiu2HAkucTBmn4THn6DL6MJ8V9PacW5Edxv9iBj3eEjwntbkm8K"],"enrUri":"enr:-L24QOO7eGXyK1XTablTdAnydt_ncxXMQ5xBBeyfoItz_lnJTMaucXzaFugxWQ9kXP03zlqpvlDV0SybAFS52OUhJEECgmlkgnY0gmlwhKwSTt-KbXVsdGlhZGRyc5YACASsEk7fBozCAAoErBJO3waMw90DgnJzhQADAQAAiXNlY3AyNTZrMaECAsLsXKChMvyHTqRDMvulnj6bw2PgdNf_uFoF4N6PY9CDdGNwgozCg3VkcIKMxIV3YWt1MgU"}'
2025-02-13 04:02:49.033 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:02:49.034 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-13 04:02:49.040 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:02:49.040 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_04-02-47__99899fa2-471d-431c-a2ab-08c2a0e82cf9__wakuorg_nwaku:latest.log
2025-02-13 04:02:49.040 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:02:49.040 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:02:49.042 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:02:49.042 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.85.227
2025-02-13 04:02:49.042 DEBUG [src.node.docker_mananger] Generated ports ['59344', '59345', '59346', '59347', '59348']
2025-02-13 04:02:49.042 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:02:49.042 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:02:49.042 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:02:49.042 DEBUG [src.node.docker_mananger] docker run -i -t -p 59344:59344 -p 59345:59345 -p 59346:59346 -p 59347:59347 -p 59348:59348 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59346 --rest-port=59344 --tcp-port=59345 --discv5-udp-port=59347 --rest-address=0.0.0.0 --nat=extip:172.18.85.227 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=18cdf6b9a9ecd0d0ae44fcf5ed4164ed6d729457edd33a7e27c1b74a7d62f167 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59348 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QOO7eGXyK1XTablTdAnydt_ncxXMQ5xBBeyfoItz_lnJTMaucXzaFugxWQ9kXP03zlqpvlDV0SybAFS52OUhJEECgmlkgnY0gmlwhKwSTt-KbXVsdGlhZGRyc5YACASsEk7fBozCAAoErBJO3waMw90DgnJzhQADAQAAiXNlY3AyNTZrMaECAsLsXKChMvyHTqRDMvulnj6bw2PgdNf_uFoF4N6PY9CDdGNwgozCg3VkcIKMxIV3YWt1MgU --filternode=/ip4/172.18.78.223/tcp/36034/p2p/16Uiu2HAkucTBmn4THn6DL6MJ8V9PacW5Edxv9iBj3eEjwntbkm8K
2025-02-13 04:02:49.263 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.85.227 waku 35e72928569f8bd683c7cc17690d888670cefdb1697b40b2c8977e00f0def4af
2025-02-13 04:02:49.311 DEBUG [src.node.docker_mananger] Container started with ID 35e72928569f. Setting up logs at ./log/docker/node2_2025-02-13_04-02-47__99899fa2-471d-431c-a2ab-08c2a0e82cf9__wakuorg_nwaku:latest.log
2025-02-13 04:02:49.312 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59344
2025-02-13 04:02:49.312 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:02:50.312 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59344/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:02:50.315 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:02:50.316 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:02:50.316 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59344/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:02:50.318 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.85.227/tcp/59345/p2p/16Uiu2HAkvQvReWZvLy5bSQWNf1bz9ryv4szLzQUpBNBXHZ63Bvas","/ip4/172.18.85.227/tcp/59346/ws/p2p/16Uiu2HAkvQvReWZvLy5bSQWNf1bz9ryv4szLzQUpBNBXHZ63Bvas"],"enrUri":"enr:-L24QBEUzv2k5jukXDe8WjiElQgQbSIoKztOB41gwrqkvGsEPTi50eUYIi72KTES85CybE6phi_da4FM6pe0GGQpEMkCgmlkgnY0gmlwhKwSVeOKbXVsdGlhZGRyc5YACASsElXjBufRAAoErBJV4wbn0t0DgnJzhQADAQAAiXNlY3AyNTZrMaECDqpwox6lvS7BdKfxsU_hsFrZZ7kDDBCp1Y_k734wEfCDdGNwgufRg3VkcILn04V3YWt1MgA"}'
2025-02-13 04:02:50.318 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:02:50.318 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59344/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.78.223/tcp/36034/p2p/16Uiu2HAkucTBmn4THn6DL6MJ8V9PacW5Edxv9iBj3eEjwntbkm8K"]'
2025-02-13 04:02:50.357 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:02:50.357 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-13 04:02:50.358 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36033/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 04:02:50.374 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:02:50.376 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59344/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "aec4d574-a58f-4ecf-bc1b-44d216ca1a61", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 04:02:50.387 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"aec4d574-a58f-4ecf-bc1b-44d216ca1a61","statusDesc":"OK"}'
2025-02-13 04:02:50.388 DEBUG [tests.filter.test_subscribe_create] Running test with contetn topic Empty string
2025-02-13 04:02:50.388 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59344/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "Empty string", "value": ""}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 04:02:50.391 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59344/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-13 04:02:50.392 DEBUG [tests.filter.test_subscribe_create] Running test with contetn topic A dictionary
2025-02-13 04:02:50.393 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59344/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A dictionary", "value": {"key": "YWFh"}}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 04:02:50.395 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59344/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-13 04:02:50.396 DEBUG [tests.filter.test_subscribe_create] Running test with contetn topic An integer
2025-02-13 04:02:50.396 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59344/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "An integer", "value": 1234567890}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 04:02:50.398 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59344/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-13 04:02:50.399 DEBUG [tests.filter.test_subscribe_create] Running test with contetn topic A list
2025-02-13 04:02:50.399 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59344/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A list", "value": ["YWFh"]}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 04:02:50.401 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59344/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-13 04:02:50.402 DEBUG [tests.filter.test_subscribe_create] Running test with contetn topic A bool
2025-02-13 04:02:50.403 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59344/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": [{"description": "A bool", "value": true}], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 04:02:50.405 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:59344/filter/v2/subscriptions. Response content: b'{"requestId":"unknown","statusDesc":"BAD_REQUEST: Failed to decode request: (status: 400 Bad Request, headers: , kind: Error, errobj: (status: 400 Bad Request, message: \\"Invalid content body, could not decode. Unable to deserialize data\\", contentType: \\"text/plain\\"))"}'
2025-02-13 04:02:50.407 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:02:50.408 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:02:50.408 DEBUG [src.node.waku_node] Stopping container with id 14ac7603b696
2025-02-13 04:02:51.525 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:02:51.525 DEBUG [src.node.waku_node] Stopping container with id 35e72928569f
2025-02-13 04:02:52.337 ERROR [src.node.docker_mananger] Max retries reached for container 14ac7603b696. Exiting log stream.
2025-02-13 04:02:53.018 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:02:53.019 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:02:53.023 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:02:53.028 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
