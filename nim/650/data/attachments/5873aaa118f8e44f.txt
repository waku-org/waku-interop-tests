2025-02-13 04:03:34.334 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:03:34.334 DEBUG [tests.conftest] Running test: test_filter_get_message_with_valid_timestamps with id: 2025-02-13_04-03-34__7b04aa33-fc8c-4600-a2dc-34c975cfa259
2025-02-13 04:03:34.334 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:03:34.335 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-13 04:03:34.335 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-13 04:03:34.341 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:03:34.341 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_04-03-34__7b04aa33-fc8c-4600-a2dc-34c975cfa259__wakuorg_nwaku:latest.log
2025-02-13 04:03:34.341 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:03:34.341 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:03:34.343 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:03:34.343 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.38.85
2025-02-13 04:03:34.343 DEBUG [src.node.docker_mananger] Generated ports ['18526', '18527', '18528', '18529', '18530']
2025-02-13 04:03:34.343 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:03:34.343 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:03:34.343 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:03:34.343 DEBUG [src.node.docker_mananger] docker run -i -t -p 18526:18526 -p 18527:18527 -p 18528:18528 -p 18529:18529 -p 18530:18530 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18528 --rest-port=18526 --tcp-port=18527 --discv5-udp-port=18529 --rest-address=0.0.0.0 --nat=extip:172.18.38.85 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=daea556378d13cd2bca968417c64fef121e06fdee072ffeaa8e5ff1f58ffeeb8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18530 --metrics-logging=true --relay=true --filter=true
2025-02-13 04:03:34.581 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.38.85 waku c89108c71efc52420ac967bb218b2af513448bbd4fb73b69d20fa52ab049bb76
2025-02-13 04:03:34.630 DEBUG [src.node.docker_mananger] Container started with ID c89108c71efc. Setting up logs at ./log/docker/node1_2025-02-13_04-03-34__7b04aa33-fc8c-4600-a2dc-34c975cfa259__wakuorg_nwaku:latest.log
2025-02-13 04:03:34.630 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 18526
2025-02-13 04:03:34.631 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:03:35.018 ERROR [src.node.docker_mananger] Max retries reached for container 552ca1b554e5. Exiting log stream.
2025-02-13 04:03:35.631 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18526/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:35.634 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:03:35.634 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:03:35.634 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18526/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:35.636 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.38.85/tcp/18527/p2p/16Uiu2HAmKG7NWv7A2aa7KvDXVB2Pj8WiphTgdWuAJoYNL2XsiDGT","/ip4/172.18.38.85/tcp/18528/ws/p2p/16Uiu2HAmKG7NWv7A2aa7KvDXVB2Pj8WiphTgdWuAJoYNL2XsiDGT"],"enrUri":"enr:-L24QPMGmcfIkzdtLQpqLuXifqMW76LgsIo-SLcRpW_xyz0DCmVUIzOtuCDceYpRYghtrpotTeh2suK6OtJoKUXngOoCgmlkgnY0gmlwhKwSJlWKbXVsdGlhZGRyc5YACASsEiZVBkhfAAoErBImVQZIYN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYiVjguJLLnXHXWUHc7Ln-y0-2rrjtk1l5PDqDZvtADiDdGNwgkhfg3VkcIJIYYV3YWt1MgU"}'
2025-02-13 04:03:35.636 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:03:35.637 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-13 04:03:35.642 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:03:35.642 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_04-03-34__7b04aa33-fc8c-4600-a2dc-34c975cfa259__wakuorg_nwaku:latest.log
2025-02-13 04:03:35.643 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:03:35.643 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:03:35.644 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:03:35.644 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.39.137
2025-02-13 04:03:35.644 DEBUG [src.node.docker_mananger] Generated ports ['57124', '57125', '57126', '57127', '57128']
2025-02-13 04:03:35.644 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:03:35.645 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:03:35.645 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:03:35.645 DEBUG [src.node.docker_mananger] docker run -i -t -p 57124:57124 -p 57125:57125 -p 57126:57126 -p 57127:57127 -p 57128:57128 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57126 --rest-port=57124 --tcp-port=57125 --discv5-udp-port=57127 --rest-address=0.0.0.0 --nat=extip:172.18.39.137 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c9ae24a8f86cb7f74b9db19a45ead39b9aabfb74fbf20cc4f7ade0bda37f8fe5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57128 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QPMGmcfIkzdtLQpqLuXifqMW76LgsIo-SLcRpW_xyz0DCmVUIzOtuCDceYpRYghtrpotTeh2suK6OtJoKUXngOoCgmlkgnY0gmlwhKwSJlWKbXVsdGlhZGRyc5YACASsEiZVBkhfAAoErBImVQZIYN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYiVjguJLLnXHXWUHc7Ln-y0-2rrjtk1l5PDqDZvtADiDdGNwgkhfg3VkcIJIYYV3YWt1MgU --filternode=/ip4/172.18.38.85/tcp/18527/p2p/16Uiu2HAmKG7NWv7A2aa7KvDXVB2Pj8WiphTgdWuAJoYNL2XsiDGT
2025-02-13 04:03:35.865 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.39.137 waku 4408b508b0b43dd0ccd9db855347cd833d75b909bbe1fc10ec292eec9fdad077
2025-02-13 04:03:35.910 DEBUG [src.node.docker_mananger] Container started with ID 4408b508b0b4. Setting up logs at ./log/docker/node2_2025-02-13_04-03-34__7b04aa33-fc8c-4600-a2dc-34c975cfa259__wakuorg_nwaku:latest.log
2025-02-13 04:03:35.910 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57124
2025-02-13 04:03:35.910 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:03:36.911 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:36.914 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:03:36.914 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:03:36.914 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:36.916 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.137/tcp/57125/p2p/16Uiu2HAkxGrapfz4nQDrrvCJaT6NUfukMjy4kxRtXF62Gi4fMJNu","/ip4/172.18.39.137/tcp/57126/ws/p2p/16Uiu2HAkxGrapfz4nQDrrvCJaT6NUfukMjy4kxRtXF62Gi4fMJNu"],"enrUri":"enr:-L24QHnevXAoN-JAUMe_TpUBZepZuP7OxTNI_BVvUh8VFYuzGQoSuhAs2JAXg556hssPcXV6k8pa5h3xnZBWfNBw6SoCgmlkgnY0gmlwhKwSJ4mKbXVsdGlhZGRyc5YACASsEieJBt8lAAoErBIniQbfJt0DgnJzhQADAQAAiXNlY3AyNTZrMaECKlDSy_IDDPW2kncaNt8UEAuF8t2fdRINVD2eSKnR-XqDdGNwgt8lg3VkcILfJ4V3YWt1MgA"}'
2025-02-13 04:03:36.916 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:03:36.917 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57124/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.38.85/tcp/18527/p2p/16Uiu2HAmKG7NWv7A2aa7KvDXVB2Pj8WiphTgdWuAJoYNL2XsiDGT"]'
2025-02-13 04:03:36.955 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:36.955 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-13 04:03:36.956 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 04:03:36.972 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:36.973 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57124/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "c48b1792-0366-45df-8cdc-0fc5331033d9", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 04:03:36.983 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"c48b1792-0366-45df-8cdc-0fc5331033d9","statusDesc":"OK"}'
2025-02-13 04:03:36.984 DEBUG [tests.filter.test_get_messages] Running test with timestamp Now
2025-02-13 04:03:36.985 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:36.992 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:36.993 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:37.093 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:37.093 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:37.095 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739419340190716672,"ephemeral":false}]'
2025-02-13 04:03:37.097 DEBUG [tests.filter.test_get_messages] Running test with timestamp Far future
2025-02-13 04:03:37.097 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:37.101 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:37.102 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:37.202 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:37.202 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:37.204 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":2054779340190702080,"ephemeral":false}]'
2025-02-13 04:03:37.206 DEBUG [tests.filter.test_get_messages] Running test with timestamp Recent past
2025-02-13 04:03:37.206 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:37.210 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:37.210 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:37.310 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:37.311 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:37.313 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739415740190702080,"ephemeral":false}]'
2025-02-13 04:03:37.314 DEBUG [tests.filter.test_get_messages] Running test with timestamp Near future
2025-02-13 04:03:37.315 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:37.319 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:37.319 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:37.419 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:37.420 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:37.422 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739422940190702080,"ephemeral":false}]'
2025-02-13 04:03:37.423 DEBUG [tests.filter.test_get_messages] Running test with timestamp Positive number
2025-02-13 04:03:37.424 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:37.428 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:37.428 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:37.528 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:37.528 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:37.531 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1,"ephemeral":false}]'
2025-02-13 04:03:37.532 DEBUG [tests.filter.test_get_messages] Running test with timestamp Negative number
2025-02-13 04:03:37.532 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:37.536 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:37.536 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:37.637 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:37.637 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:37.639 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":-1,"ephemeral":false}]'
2025-02-13 04:03:37.641 DEBUG [tests.filter.test_get_messages] Running test with timestamp DST change
2025-02-13 04:03:37.641 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18526/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:37.645 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:37.645 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:37.745 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:37.746 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57124/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:37.748 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1583632800000000000,"ephemeral":false}]'
2025-02-13 04:03:37.751 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:03:37.752 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:03:37.752 DEBUG [src.node.waku_node] Stopping container with id c89108c71efc
2025-02-13 04:03:39.202 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:03:39.203 DEBUG [src.node.waku_node] Stopping container with id 4408b508b0b4
2025-02-13 04:03:40.014 ERROR [src.node.docker_mananger] Max retries reached for container c89108c71efc. Exiting log stream.
2025-02-13 04:03:40.690 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:03:40.693 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:03:40.698 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:03:40.703 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
