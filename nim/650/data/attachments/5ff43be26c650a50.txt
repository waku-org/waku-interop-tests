2025-02-13 04:07:52.326 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:07:52.326 DEBUG [tests.conftest] Running test: test_2_receiving_nodes__relay_node1_forwards_lightpushed_message_to_relay_node2 with id: 2025-02-13_04-07-52__fca4afd8-864f-4074-b576-2502ca44fe5c
2025-02-13 04:07:52.326 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:07:52.327 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-13 04:07:52.333 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:07:52.333 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-13_04-07-52__fca4afd8-864f-4074-b576-2502ca44fe5c__wakuorg_nwaku:latest.log
2025-02-13 04:07:52.333 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:07:52.334 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:07:52.335 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:07:52.335 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.43.164
2025-02-13 04:07:52.335 DEBUG [src.node.docker_mananger] Generated ports ['6620', '6621', '6622', '6623', '6624']
2025-02-13 04:07:52.335 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:07:52.335 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:07:52.336 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:07:52.336 DEBUG [src.node.docker_mananger] docker run -i -t -p 6620:6620 -p 6621:6621 -p 6622:6622 -p 6623:6623 -p 6624:6624 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6622 --rest-port=6620 --tcp-port=6621 --discv5-udp-port=6623 --rest-address=0.0.0.0 --nat=extip:172.18.43.164 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=17ef8aadf017deada1b633f17b6bbd187ab44e7be0017e5fc9499e90b17bb1eb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6624 --metrics-logging=true --lightpush=true --relay=true
2025-02-13 04:07:52.557 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.43.164 waku ee1bab5e902bcb9a45edc797aeff1d2cd4e54d089876890026f5eacb5dc3343e
2025-02-13 04:07:52.607 DEBUG [src.node.docker_mananger] Container started with ID ee1bab5e902b. Setting up logs at ./log/docker/receiving_node1_2025-02-13_04-07-52__fca4afd8-864f-4074-b576-2502ca44fe5c__wakuorg_nwaku:latest.log
2025-02-13 04:07:52.608 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 6620
2025-02-13 04:07:52.608 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:07:53.123 ERROR [src.node.docker_mananger] Max retries reached for container 3385d58317f4. Exiting log stream.
2025-02-13 04:07:53.609 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6620/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:53.612 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:07:53.612 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:07:53.612 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6620/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:53.614 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.43.164/tcp/6621/p2p/16Uiu2HAmAZZznJdhM5eBoYhQBUkfb5AN3VrGpACCnP5FqbMeBqid","/ip4/172.18.43.164/tcp/6622/ws/p2p/16Uiu2HAmAZZznJdhM5eBoYhQBUkfb5AN3VrGpACCnP5FqbMeBqid"],"enrUri":"enr:-L24QN7iuX0TK_fEM7tAToggxuxIUc44cP0-D5iwpNEIT8orLkCcOBdeP0c99t2RbDYEkPGafiULPEDon-_w-rbXpT8CgmlkgnY0gmlwhKwSK6SKbXVsdGlhZGRyc5YACASsEiukBhndAAoErBIrpAYZ3t0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4OUvd1yaaFI__9ZRlW9xT9uhIvWMprhDUVu4OiyZrA6DdGNwghndg3VkcIIZ34V3YWt1Mgk"}'
2025-02-13 04:07:53.615 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:07:53.621 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:07:53.621 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-13_04-07-52__fca4afd8-864f-4074-b576-2502ca44fe5c__wakuorg_nwaku:latest.log
2025-02-13 04:07:53.621 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:07:53.621 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:07:53.622 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:07:53.623 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.235.116
2025-02-13 04:07:53.623 DEBUG [src.node.docker_mananger] Generated ports ['56511', '56512', '56513', '56514', '56515']
2025-02-13 04:07:53.623 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:07:53.623 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:07:53.623 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:07:53.623 DEBUG [src.node.docker_mananger] docker run -i -t -p 56511:56511 -p 56512:56512 -p 56513:56513 -p 56514:56514 -p 56515:56515 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=56513 --rest-port=56511 --tcp-port=56512 --discv5-udp-port=56514 --rest-address=0.0.0.0 --nat=extip:172.18.235.116 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ac5c5003ba7cdbe7ace2fd3fb62f7cebdf57eb7de5f5f07d42be5be8ac52f3ea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=56515 --metrics-logging=true --lightpush=false --relay=true
2025-02-13 04:07:53.856 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.235.116 waku 925b12215c184850e1b88f17c7d11cd0b5b2db092d5c9994dbc5b58cf665599c
2025-02-13 04:07:53.907 DEBUG [src.node.docker_mananger] Container started with ID 925b12215c18. Setting up logs at ./log/docker/receiving_node2_2025-02-13_04-07-52__fca4afd8-864f-4074-b576-2502ca44fe5c__wakuorg_nwaku:latest.log
2025-02-13 04:07:53.908 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 56511
2025-02-13 04:07:53.908 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:07:54.908 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56511/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:54.911 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:07:54.911 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:07:54.911 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56511/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:54.913 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.235.116/tcp/56512/p2p/16Uiu2HAmKXzKEy8vGqxbKmvoiixhWZRPyYuBFkWrAXoVQjXiaCFG","/ip4/172.18.235.116/tcp/56513/ws/p2p/16Uiu2HAmKXzKEy8vGqxbKmvoiixhWZRPyYuBFkWrAXoVQjXiaCFG"],"enrUri":"enr:-L24QDHzIqIw39jRDqi5i4iqEUQtWB9JGp5yXLHnSt04GHzpdsBO_iq0rDv8ricigLCXUmUwhQGUEkxAqAMUuO2KWusCgmlkgnY0gmlwhKwS63SKbXVsdGlhZGRyc5YACASsEut0BtzAAAoErBLrdAbcwd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDZjaz8KdyR9GOIYgypgXd6EyqkXpP_TWL9PovJTOggz-DdGNwgtzAg3VkcILcwoV3YWt1MgE"}'
2025-02-13 04:07:54.914 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:07:54.914 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56511/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.43.164/tcp/6621/p2p/16Uiu2HAmAZZznJdhM5eBoYhQBUkfb5AN3VrGpACCnP5FqbMeBqid"]'
2025-02-13 04:07:54.951 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:07:54.960 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:07:54.960 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-13_04-07-52__fca4afd8-864f-4074-b576-2502ca44fe5c__wakuorg_nwaku:latest.log
2025-02-13 04:07:54.960 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:07:54.960 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:07:54.962 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:07:54.962 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.27.226
2025-02-13 04:07:54.962 DEBUG [src.node.docker_mananger] Generated ports ['47055', '47056', '47057', '47058', '47059']
2025-02-13 04:07:54.962 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:07:54.962 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:07:54.962 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:07:54.962 DEBUG [src.node.docker_mananger] docker run -i -t -p 47055:47055 -p 47056:47056 -p 47057:47057 -p 47058:47058 -p 47059:47059 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47057 --rest-port=47055 --tcp-port=47056 --discv5-udp-port=47058 --rest-address=0.0.0.0 --nat=extip:172.18.27.226 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6d0f2ddccda5a4a3a58fcc3cdecde64daac3c4185e1d22b37c22cd20f5aaa9f4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47059 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QN7iuX0TK_fEM7tAToggxuxIUc44cP0-D5iwpNEIT8orLkCcOBdeP0c99t2RbDYEkPGafiULPEDon-_w-rbXpT8CgmlkgnY0gmlwhKwSK6SKbXVsdGlhZGRyc5YACASsEiukBhndAAoErBIrpAYZ3t0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4OUvd1yaaFI__9ZRlW9xT9uhIvWMprhDUVu4OiyZrA6DdGNwghndg3VkcIIZ34V3YWt1Mgk --lightpushnode=/ip4/172.18.43.164/tcp/6621/p2p/16Uiu2HAmAZZznJdhM5eBoYhQBUkfb5AN3VrGpACCnP5FqbMeBqid --lightpush=true --relay=false
2025-02-13 04:07:55.201 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.27.226 waku 69b95aef6fe6e1bf1baa51ae22141569f4f687be5b72fee5022dec25aa5738c8
2025-02-13 04:07:55.248 DEBUG [src.node.docker_mananger] Container started with ID 69b95aef6fe6. Setting up logs at ./log/docker/lightpush_node1_2025-02-13_04-07-52__fca4afd8-864f-4074-b576-2502ca44fe5c__wakuorg_nwaku:latest.log
2025-02-13 04:07:55.248 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47055
2025-02-13 04:07:55.249 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:07:56.249 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47055/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:56.252 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:07:56.252 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:07:56.252 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47055/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:56.254 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.27.226/tcp/47056/p2p/16Uiu2HAmLF1qVvEpykynoBzj2ivhTdrKW9MhntEbm7QQYc63xtgR","/ip4/172.18.27.226/tcp/47057/ws/p2p/16Uiu2HAmLF1qVvEpykynoBzj2ivhTdrKW9MhntEbm7QQYc63xtgR"],"enrUri":"enr:-L24QCZBasTLjNtI-t7GqozryUXwPhI2RFaJ6klGz7AI2l0aONJOJ7HH3IwVBIiswzmg2qwI9NyXTaoke0XIgP8kKckCgmlkgnY0gmlwhKwSG-KKbXVsdGlhZGRyc5YACASsEhviBrfQAAoErBIb4ga30d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDcLk8lFIzA4kQ109wOQ65yWeZ4K43Mccf8cQ-KAZwUTKDdGNwgrfQg3VkcIK30oV3YWt1Mgg"}'
2025-02-13 04:07:56.254 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:07:56.255 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47055/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.43.164/tcp/6621/p2p/16Uiu2HAmAZZznJdhM5eBoYhQBUkfb5AN3VrGpACCnP5FqbMeBqid"]'
2025-02-13 04:07:56.290 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:07:56.295 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47055/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.235.116/tcp/56512/p2p/16Uiu2HAmKXzKEy8vGqxbKmvoiixhWZRPyYuBFkWrAXoVQjXiaCFG"]'
2025-02-13 04:07:56.322 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:07:56.325 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6620/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:07:56.330 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:07:56.331 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:56511/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-13 04:07:56.336 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:07:56.336 DEBUG [src.steps.light_push] Lightpushing message
2025-02-13 04:07:56.336 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47055/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739419676336531200}}'
2025-02-13 04:07:56.345 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:07:56.346 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:07:56.447 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-13 04:07:56.448 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6620/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:56.450 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419676336531200,"ephemeral":false}]'
2025-02-13 04:07:56.451 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-13 04:07:56.451 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:56511/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:07:56.454 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739419676336531200,"ephemeral":false}]'
2025-02-13 04:07:56.456 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:07:56.457 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:07:56.457 DEBUG [src.node.waku_node] Stopping container with id ee1bab5e902b
2025-02-13 04:07:57.080 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:07:57.080 DEBUG [src.node.waku_node] Stopping container with id 925b12215c18
2025-02-13 04:07:57.893 ERROR [src.node.docker_mananger] Max retries reached for container ee1bab5e902b. Exiting log stream.
2025-02-13 04:07:58.611 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:07:58.611 DEBUG [src.node.waku_node] Stopping container with id 69b95aef6fe6
2025-02-13 04:07:59.423 ERROR [src.node.docker_mananger] Max retries reached for container 925b12215c18. Exiting log stream.
2025-02-13 04:08:00.117 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:08:00.118 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:08:00.125 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:08:00.133 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:08:00.139 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
