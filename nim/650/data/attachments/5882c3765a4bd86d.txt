2025-02-13 04:03:54.262 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 04:03:54.262 DEBUG [tests.conftest] Running test: test_publish_with_invalid_version with id: 2025-02-13_04-03-54__c594ec22-bea2-4c84-bac5-37c7977d11bd
2025-02-13 04:03:54.263 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 04:03:54.263 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-13 04:03:54.263 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-13 04:03:54.269 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:03:54.269 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_04-03-54__c594ec22-bea2-4c84-bac5-37c7977d11bd__wakuorg_nwaku:latest.log
2025-02-13 04:03:54.269 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:03:54.270 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:03:54.271 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:03:54.271 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.117.193
2025-02-13 04:03:54.271 DEBUG [src.node.docker_mananger] Generated ports ['55241', '55242', '55243', '55244', '55245']
2025-02-13 04:03:54.271 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:03:54.272 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:03:54.272 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:03:54.272 DEBUG [src.node.docker_mananger] docker run -i -t -p 55241:55241 -p 55242:55242 -p 55243:55243 -p 55244:55244 -p 55245:55245 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55243 --rest-port=55241 --tcp-port=55242 --discv5-udp-port=55244 --rest-address=0.0.0.0 --nat=extip:172.18.117.193 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fafa6736c8872cdb9bbfba1bf7daca17bd64cfd24b534de7aeebe24cacbd0c27 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55245 --metrics-logging=true --relay=true
2025-02-13 04:03:54.490 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.117.193 waku 1d2f93187b91091e813528bf1f7073585b93a2a57367e11224a366f350c68678
2025-02-13 04:03:54.541 DEBUG [src.node.docker_mananger] Container started with ID 1d2f93187b91. Setting up logs at ./log/docker/node1_2025-02-13_04-03-54__c594ec22-bea2-4c84-bac5-37c7977d11bd__wakuorg_nwaku:latest.log
2025-02-13 04:03:54.542 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55241
2025-02-13 04:03:54.543 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:03:55.054 ERROR [src.node.docker_mananger] Max retries reached for container 7a98514d98e8. Exiting log stream.
2025-02-13 04:03:55.543 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55241/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:55.546 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:03:55.546 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:03:55.546 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55241/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:55.548 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.117.193/tcp/55242/p2p/16Uiu2HAm2yC5eCesqZguSVeWNh4UYJhKNSPD4dYqNFLUDxL7kuYU","/ip4/172.18.117.193/tcp/55243/ws/p2p/16Uiu2HAm2yC5eCesqZguSVeWNh4UYJhKNSPD4dYqNFLUDxL7kuYU"],"enrUri":"enr:-L24QEAcB82xwFbihoX_R7zEUf_PwhCKEUbgwhzTr_y9_hpzPwpVHMufeg1NjH8Ze1eqewlLAbAtbS6WvmgwhL8EfBcCgmlkgnY0gmlwhKwSdcGKbXVsdGlhZGRyc5YACASsEnXBBtfKAAoErBJ1wQbXy90DgnJzhQADAQAAiXNlY3AyNTZrMaECcBTZQ_unSZVsgQT9xWHHCy_6GnkMrUtvLR74sHsJHymDdGNwgtfKg3VkcILXzIV3YWt1MgE"}'
2025-02-13 04:03:55.548 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:03:55.555 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 04:03:55.555 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_04-03-54__c594ec22-bea2-4c84-bac5-37c7977d11bd__wakuorg_nwaku:latest.log
2025-02-13 04:03:55.555 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 04:03:55.555 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 04:03:55.556 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 04:03:55.556 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.10.123
2025-02-13 04:03:55.557 DEBUG [src.node.docker_mananger] Generated ports ['19829', '19830', '19831', '19832', '19833']
2025-02-13 04:03:55.557 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 04:03:55.557 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 04:03:55.557 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 04:03:55.557 DEBUG [src.node.docker_mananger] docker run -i -t -p 19829:19829 -p 19830:19830 -p 19831:19831 -p 19832:19832 -p 19833:19833 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19831 --rest-port=19829 --tcp-port=19830 --discv5-udp-port=19832 --rest-address=0.0.0.0 --nat=extip:172.18.10.123 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4a2a1da4dfc5fc0fb5dcf0ce2d6948c9263bb52febde4ede4984ab01570d40ce --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19833 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QEAcB82xwFbihoX_R7zEUf_PwhCKEUbgwhzTr_y9_hpzPwpVHMufeg1NjH8Ze1eqewlLAbAtbS6WvmgwhL8EfBcCgmlkgnY0gmlwhKwSdcGKbXVsdGlhZGRyc5YACASsEnXBBtfKAAoErBJ1wQbXy90DgnJzhQADAQAAiXNlY3AyNTZrMaECcBTZQ_unSZVsgQT9xWHHCy_6GnkMrUtvLR74sHsJHymDdGNwgtfKg3VkcILXzIV3YWt1MgE
2025-02-13 04:03:55.779 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.10.123 waku f818437b750f78cf6ad7ac587eeeedb64be067b7dddeaf156dc84d12f22ca669
2025-02-13 04:03:55.826 DEBUG [src.node.docker_mananger] Container started with ID f818437b750f. Setting up logs at ./log/docker/node2_2025-02-13_04-03-54__c594ec22-bea2-4c84-bac5-37c7977d11bd__wakuorg_nwaku:latest.log
2025-02-13 04:03:55.826 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19829
2025-02-13 04:03:55.827 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 04:03:56.827 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19829/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:56.842 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 04:03:56.842 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 04:03:56.843 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19829/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:56.849 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.10.123/tcp/19830/p2p/16Uiu2HAkyjds55HDBPy8mAA8ZezTyyNjL6gGza5kxmC1F2i8n2Qk","/ip4/172.18.10.123/tcp/19831/ws/p2p/16Uiu2HAkyjds55HDBPy8mAA8ZezTyyNjL6gGza5kxmC1F2i8n2Qk"],"enrUri":"enr:-L24QH7N2KeCim6gh7BDJGTrwQB2u_F3qvCgdbEfd4MgT1_bCeCdL0fHHY-KJ5wdeMVeE_o4lGtzGq356hXdFTHB1rcCgmlkgnY0gmlwhKwSCnuKbXVsdGlhZGRyc5YACASsEgp7Bk12AAoErBIKewZNd90DgnJzhQADAQAAiXNlY3AyNTZrMaECQAjPT5GpN41q_U25MGjXIdN4k9AuIah3yzuyJz74zN2DdGNwgk12g3VkcIJNeIV3YWt1MgE"}'
2025-02-13 04:03:56.850 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 04:03:56.850 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19829/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.117.193/tcp/55242/p2p/16Uiu2HAm2yC5eCesqZguSVeWNh4UYJhKNSPD4dYqNFLUDxL7kuYU"]'
2025-02-13 04:03:56.853 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:56.854 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-13 04:03:56.854 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55241/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 04:03:56.857 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:56.858 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19829/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 04:03:56.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:56.864 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 04:03:56.870 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 04:03:56.870 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 04:03:56.970 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:56.971 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:56.973 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739419436864372992,"ephemeral":false}]'
2025-02-13 04:03:56.974 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-13 04:03:56.974 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19829/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-13 04:03:56.977 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739419436864372992,"ephemeral":false}]'
2025-02-13 04:03:56.978 INFO [src.steps.relay] WARM UP successful!!
2025-02-13 04:03:56.979 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 2.1}'
2025-02-13 04:03:56.981 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55241/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 04:03:56.983 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 04:03:56.984 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 04:03:56.985 DEBUG [src.node.waku_node] Stopping container with id 1d2f93187b91
2025-02-13 04:03:58.023 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:03:58.023 DEBUG [src.node.waku_node] Stopping container with id f818437b750f
2025-02-13 04:03:58.835 ERROR [src.node.docker_mananger] Max retries reached for container 1d2f93187b91. Exiting log stream.
2025-02-13 04:03:59.524 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 04:03:59.525 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 04:03:59.530 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 04:03:59.536 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
