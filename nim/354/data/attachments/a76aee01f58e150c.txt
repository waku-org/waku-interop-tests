[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_retrieve_messages_without_subscribing_via_api with id: 2024-09-10_15-19-19__cf11e9e9-3412-4302-9b52-5262bebbb698
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-10_15-19-19__cf11e9e9-3412-4302-9b52-5262bebbb698__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.70.122
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['57260', '57261', '57262', '57263', '57264']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 57260:57260 -p 57261:57261 -p 57262:57262 -p 57263:57263 -p 57264:57264 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57262 --rest-port=57260 --tcp-port=57261 --discv5-udp-port=57263 --rest-address=0.0.0.0 --nat=extip:172.18.70.122 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=ff4b2ae0b73bfd7cbfae78acf44de442204eb138f06bc9d759f6d5a932c487a1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57264 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.70.122 waku 056576a242ca58fbc2d684ca55c68140f8b7de32dfd71db13642347b6cbb6bf0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 056576a242ca. Setting up logs at ./log/docker/node1_2024-09-10_15-19-19__cf11e9e9-3412-4302-9b52-5262bebbb698__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 57260
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57260/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57260/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.70.122/tcp/57261/p2p/16Uiu2HAmCuqMb1zNdRQaCiDHghkmE6b53Vnb3v6NFASSnoebSP5s","/ip4/172.18.70.122/tcp/57262/ws/p2p/16Uiu2HAmCuqMb1zNdRQaCiDHghkmE6b53Vnb3v6NFASSnoebSP5s"],"enrUri":"enr:-LO4QGIQN2ux_4U5-nNRBB6ShDbXkC5IcHxZ2eAmHX9NrVZQG2xGQNtmcxAPiRfMa6PT8qUkVAyn-5m5kTMIhLwT2sgBgmlkgnY0gmlwhKwSRnqKbXVsdGlhZGRyc4wACgSsEkZ6Bt-u3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMDzYqmcj469z8RphjW0ClQ4dx-X3MJwAsfwyC6lMlrWoN0Y3CC362DdWRwgt-vhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-10_15-19-19__cf11e9e9-3412-4302-9b52-5262bebbb698__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.214.120
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['3873', '3874', '3875', '3876', '3877']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 3873:3873 -p 3874:3874 -p 3875:3875 -p 3876:3876 -p 3877:3877 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3875 --rest-port=3873 --tcp-port=3874 --discv5-udp-port=3876 --rest-address=0.0.0.0 --nat=extip:172.18.214.120 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=0921d8663d78e4eae62e81fdb45c65f3e25f1cea1dbe7beccd63c272f3bd1ae5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3877 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QGIQN2ux_4U5-nNRBB6ShDbXkC5IcHxZ2eAmHX9NrVZQG2xGQNtmcxAPiRfMa6PT8qUkVAyn-5m5kTMIhLwT2sgBgmlkgnY0gmlwhKwSRnqKbXVsdGlhZGRyc4wACgSsEkZ6Bt-u3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMDzYqmcj469z8RphjW0ClQ4dx-X3MJwAsfwyC6lMlrWoN0Y3CC362DdWRwgt-vhXdha3UyBQ --content-topic=/myapp/1/latest/proto
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.214.120 waku 73010a97c24a0d696eca7a148aa5e153e5db4165cfa9daf6965331afc3b8b3d6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 73010a97c24a. Setting up logs at ./log/docker/node2_2024-09-10_15-19-19__cf11e9e9-3412-4302-9b52-5262bebbb698__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3873
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3873/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3873/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.120/tcp/3874/p2p/16Uiu2HAmPJBfsHxEfv8ZS9Ln5ojYZfcKAYLgMFoQn38yK55awBoM","/ip4/172.18.214.120/tcp/3875/ws/p2p/16Uiu2HAmPJBfsHxEfv8ZS9Ln5ojYZfcKAYLgMFoQn38yK55awBoM"],"enrUri":"enr:-LO4QIyOLU0ZMPSo1kaRrf-OniQ4Eyo9gG2jZ2JUVRSZQ9Y5ZJekDd3CR2irOUwX74v8LfdtsozKDIRMhW_kQ9cV6uEBgmlkgnY0gmlwhKwS1niKbXVsdGlhZGRyc4wACgSsEtZ4Bg8j3QOCcnOFAAIBAACJc2VjcDI1NmsxoQOeHCi70t_x5qAEP-emVQBdSLxf8GwP3Pww1jSiYVib6IN0Y3CCDyKDdWRwgg8khXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3873/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.70.122/tcp/57261/p2p/16Uiu2HAmCuqMb1zNdRQaCiDHghkmE6b53Vnb3v6NFASSnoebSP5s"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57260/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57260/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725981562885753856,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3873/relay/v1/auto/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725981562885753856,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 056576a242ca
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 73010a97c24a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.