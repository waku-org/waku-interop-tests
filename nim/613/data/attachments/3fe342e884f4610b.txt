[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2025-01-11_04-02-15__1a910773-abfe-469d-b62c-657aa107a0bf
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-11_04-02-15__1a910773-abfe-469d-b62c-657aa107a0bf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2025-01-11_04-02-15__1a910773-abfe-469d-b62c-657aa107a0bf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2025-01-11_04-02-15__1a910773-abfe-469d-b62c-657aa107a0bf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:389 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:33 Network waku created
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.9.157
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['34572', '34573', '34574', '34575', '34576']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 34572:34572 -p 34573:34573 -p 34574:34574 -p 34575:34575 -p 34576:34576 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34574 --rest-port=34572 --tcp-port=34573 --discv5-udp-port=34575 --rest-address=0.0.0.0 --nat=extip:172.18.9.157 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=014c2b9e96976350350a6c8a7dddec9774a1824deac8d0ec4a2aeb8c965efe6d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34576 --metrics-logging=true --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.9.157 waku a4ee9ebc35915e5d495f0ecbaf62bf2e566e2fa4e5389815d04061c60320f774
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a4ee9ebc3591. Setting up logs at ./log/docker/node1_2025-01-11_04-02-15__1a910773-abfe-469d-b62c-657aa107a0bf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 34572
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34572/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34572/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.9.157/tcp/34573/p2p/16Uiu2HAmLnDqvHPQYabok6MM8hB4jr1sGiWi8GhjHtUtNJoUA5pZ","/ip4/172.18.9.157/tcp/34574/ws/p2p/16Uiu2HAmLnDqvHPQYabok6MM8hB4jr1sGiWi8GhjHtUtNJoUA5pZ"],"enrUri":"enr:-L24QOiAF3gaqbY-wbB99B2lfF85f6Fik_moIjaDqIqqj0I9cMQYkH8Db_h5IBOofItJPv15uAbjeishsdhNvc-gn0ICgmlkgnY0gmlwhKwSCZ2KbXVsdGlhZGRyc5YACASsEgmdBocNAAoErBIJnQaHDt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeLfRf4dzRj6et9GWgGyboLku1l4I2yMh07j6kPeWce6DdGNwgocNg3VkcIKHD4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.124.245
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['4691', '4692', '4693', '4694', '4695']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 4691:4691 -p 4692:4692 -p 4693:4693 -p 4694:4694 -p 4695:4695 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4693 --rest-port=4691 --tcp-port=4692 --discv5-udp-port=4694 --rest-address=0.0.0.0 --nat=extip:172.18.124.245 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=68cf26cb373ff4beeca1b2edfd5778d0e7c1afc3c7a0c03becc51a1c330d94dc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4695 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QOiAF3gaqbY-wbB99B2lfF85f6Fik_moIjaDqIqqj0I9cMQYkH8Db_h5IBOofItJPv15uAbjeishsdhNvc-gn0ICgmlkgnY0gmlwhKwSCZ2KbXVsdGlhZGRyc5YACASsEgmdBocNAAoErBIJnQaHDt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeLfRf4dzRj6et9GWgGyboLku1l4I2yMh07j6kPeWce6DdGNwgocNg3VkcIKHD4V3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.124.245 waku a105e2848438841ff2592f2e84dad2503e755a906cdd2b344a3f186eb1ba1d4f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a105e2848438. Setting up logs at ./log/docker/node2_2025-01-11_04-02-15__1a910773-abfe-469d-b62c-657aa107a0bf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 4691
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4691/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4691/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.124.245/tcp/4692/p2p/16Uiu2HAm7RwoMfVcakG8YpMWJapFcGSj8MgQuj5rQUJsda29vu1F","/ip4/172.18.124.245/tcp/4693/ws/p2p/16Uiu2HAm7RwoMfVcakG8YpMWJapFcGSj8MgQuj5rQUJsda29vu1F"],"enrUri":"enr:-L24QGig6VLVTDUYDTftOgbA_EhLn0sb4u9bygk7bx0Y6-4DBnew7Y6JSBVIhYIX6TpzXZkvPIDPlPsKc12K1XbCAA4CgmlkgnY0gmlwhKwSfPWKbXVsdGlhZGRyc5YACASsEnz1BhJUAAoErBJ89QYSVd0DgnJzhQADAQAAiXNlY3AyNTZrMaECsl4hg8Q0y1jFx0R1CZEWlM_F8K_t5a2tlU-Be02IfAaDdGNwghJUg3VkcIISVoV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.23.141
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['24882', '24883', '24884', '24885', '24886']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 24882:24882 -p 24883:24883 -p 24884:24884 -p 24885:24885 -p 24886:24886 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24884 --rest-port=24882 --tcp-port=24883 --discv5-udp-port=24885 --rest-address=0.0.0.0 --nat=extip:172.18.23.141 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fddbddf5a7f19f9ddbd96e6fa8eb4620aafb95a42e0ebfdece2b5a88b2771ecd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24886 --metrics-logging=true --relay=false --storenode=/ip4/172.18.124.245/tcp/4692/p2p/16Uiu2HAm7RwoMfVcakG8YpMWJapFcGSj8MgQuj5rQUJsda29vu1F --discv5-bootstrap-node=enr:-L24QGig6VLVTDUYDTftOgbA_EhLn0sb4u9bygk7bx0Y6-4DBnew7Y6JSBVIhYIX6TpzXZkvPIDPlPsKc12K1XbCAA4CgmlkgnY0gmlwhKwSfPWKbXVsdGlhZGRyc5YACASsEnz1BhJUAAoErBJ89QYSVd0DgnJzhQADAQAAiXNlY3AyNTZrMaECsl4hg8Q0y1jFx0R1CZEWlM_F8K_t5a2tlU-Be02IfAaDdGNwghJUg3VkcIISVoV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.23.141 waku 07f0f8166fa4e12a999b0f05640522f89e09438f0daae2fe868967173d903d89
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 07f0f8166fa4. Setting up logs at ./log/docker/node3_2025-01-11_04-02-15__1a910773-abfe-469d-b62c-657aa107a0bf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 24882
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24882/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24882/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.23.141/tcp/24883/p2p/16Uiu2HAmATcDQaTNvGFhond7P2ZKTEVwHF7Kyz1TWumTygdxeCcP","/ip4/172.18.23.141/tcp/24884/ws/p2p/16Uiu2HAmATcDQaTNvGFhond7P2ZKTEVwHF7Kyz1TWumTygdxeCcP"],"enrUri":"enr:-L24QBLczEJLdSd7njfQur4OL4Df8_yjvYBkpUPduW7dtWC2MOYs6vuYNHl9-WepwcAP4ctjsO51lXXDNRM3OAEOcQYCgmlkgnY0gmlwhKwSF42KbXVsdGlhZGRyc5YACASsEheNBmEzAAoErBIXjQZhNN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC3141RfD4rxbAaMXhcyS7WNnr1XoJP2N-InvfY0Y0owiDdGNwgmEzg3VkcIJhNYV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:394 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34572/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4691/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:34572/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.124.245/tcp/4692/p2p/16Uiu2HAm7RwoMfVcakG8YpMWJapFcGSj8MgQuj5rQUJsda29vu1F","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4691/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.9.157/tcp/34573/p2p/16Uiu2HAmLnDqvHPQYabok6MM8hB4jr1sGiWi8GhjHtUtNJoUA5pZ","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:399 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:34572/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:404 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24882/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"250afa454c0dd95ebc60","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:408 Response for store when ephemeral = true is strPeer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': '250afa454c0dd95ebc60', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:410 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id a4ee9ebc3591
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id a105e2848438
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a4ee9ebc3591. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 07f0f8166fa4
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a105e2848438. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.