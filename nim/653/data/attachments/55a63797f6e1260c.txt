2025-02-16 04:04:33.468 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 04:04:33.468 DEBUG [tests.conftest] Running test: test_light_push_with_invalid_payloads with id: 2025-02-16_04-04-33__a0359239-b02c-4619-87e6-04575c81eae7
2025-02-16 04:04:33.469 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 04:04:33.469 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-16 04:04:33.475 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:33.475 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-16_04-04-33__a0359239-b02c-4619-87e6-04575c81eae7__wakuorg_nwaku:latest.log
2025-02-16 04:04:33.476 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:33.476 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:33.477 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:33.477 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.92.140
2025-02-16 04:04:33.477 DEBUG [src.node.docker_mananger] Generated ports ['39931', '39932', '39933', '39934', '39935']
2025-02-16 04:04:33.477 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:33.478 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:33.478 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:33.478 DEBUG [src.node.docker_mananger] docker run -i -t -p 39931:39931 -p 39932:39932 -p 39933:39933 -p 39934:39934 -p 39935:39935 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39933 --rest-port=39931 --tcp-port=39932 --discv5-udp-port=39934 --rest-address=0.0.0.0 --nat=extip:172.18.92.140 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=776a99b8153de510ef78ca9cbd0faed0efef6df9e9fc54c79ba91e6547abedae --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39935 --metrics-logging=true --lightpush=true --relay=true
2025-02-16 04:04:33.713 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.92.140 waku bb499697b7c1e173ffe7568344b73520ec06eef84b8847507cbca4fb9419aa35
2025-02-16 04:04:33.769 DEBUG [src.node.docker_mananger] Container started with ID bb499697b7c1. Setting up logs at ./log/docker/receiving_node1_2025-02-16_04-04-33__a0359239-b02c-4619-87e6-04575c81eae7__wakuorg_nwaku:latest.log
2025-02-16 04:04:33.770 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39931
2025-02-16 04:04:33.770 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:34.230 ERROR [src.node.docker_mananger] Max retries reached for container 7085766d3820. Exiting log stream.
2025-02-16 04:04:34.771 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39931/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:34.774 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:34.774 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:34.774 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39931/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:34.776 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.92.140/tcp/39932/p2p/16Uiu2HAmUXkWJpRyt78dFAVxvJsGzSqAJgu4BeU1E7CYuEKxCMkq","/ip4/172.18.92.140/tcp/39933/ws/p2p/16Uiu2HAmUXkWJpRyt78dFAVxvJsGzSqAJgu4BeU1E7CYuEKxCMkq"],"enrUri":"enr:-L24QHug3PwVbWw4uEXHHcts7lBxXVmp9OE_FzexVuB-1p0uX9LDWE69KzAIDYMpBb0J4xPqYxBcyp5yN0wPVU7TJxcCgmlkgnY0gmlwhKwSXIyKbXVsdGlhZGRyc5YACASsElyMBpv8AAoErBJcjAab_d0DgnJzhQADAQAAiXNlY3AyNTZrMaED6-BFZ9Dh7zkaHxequJ8zBVN5OqieVF05iWS_MBHQFGaDdGNwgpv8g3VkcIKb_oV3YWt1Mgk"}'
2025-02-16 04:04:34.777 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:34.783 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:34.783 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-16_04-04-33__a0359239-b02c-4619-87e6-04575c81eae7__wakuorg_nwaku:latest.log
2025-02-16 04:04:34.783 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:34.783 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:34.785 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:34.785 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.165.46
2025-02-16 04:04:34.785 DEBUG [src.node.docker_mananger] Generated ports ['25404', '25405', '25406', '25407', '25408']
2025-02-16 04:04:34.785 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:34.785 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:34.785 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:34.785 DEBUG [src.node.docker_mananger] docker run -i -t -p 25404:25404 -p 25405:25405 -p 25406:25406 -p 25407:25407 -p 25408:25408 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25406 --rest-port=25404 --tcp-port=25405 --discv5-udp-port=25407 --rest-address=0.0.0.0 --nat=extip:172.18.165.46 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4de019cc9d2a33faceee5ebddcc3b58d03fe74a9edc80dd3ad1a4ee3e5b3e15f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25408 --metrics-logging=true --lightpush=false --relay=true
2025-02-16 04:04:35.016 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.165.46 waku fe2733afe03c01796a645378be7ff008b41ab4f9119fab60b9db5f7376eb1b98
2025-02-16 04:04:35.065 DEBUG [src.node.docker_mananger] Container started with ID fe2733afe03c. Setting up logs at ./log/docker/receiving_node2_2025-02-16_04-04-33__a0359239-b02c-4619-87e6-04575c81eae7__wakuorg_nwaku:latest.log
2025-02-16 04:04:35.066 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25404
2025-02-16 04:04:35.066 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:36.066 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25404/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:36.069 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:36.069 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:36.069 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25404/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:36.072 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.165.46/tcp/25405/p2p/16Uiu2HAmHDzkiPJkHvssAfCyRyVRKTVw8K4ZSKN3QZUXXCbCsdcp","/ip4/172.18.165.46/tcp/25406/ws/p2p/16Uiu2HAmHDzkiPJkHvssAfCyRyVRKTVw8K4ZSKN3QZUXXCbCsdcp"],"enrUri":"enr:-L24QIE_0tirvNR2bI7wrfIQT9aKUaktXxr-D-3-F_L6WJF7FE_dpCHkpaHN24uhdro6XHhn3TQSdFTRAYLJoIFA6xwCgmlkgnY0gmlwhKwSpS6KbXVsdGlhZGRyc5YACASsEqUuBmM9AAoErBKlLgZjPt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDQ-Ne_fBeq_yB1QQSjSW18izM3McNM5kEvWlB_afo_62DdGNwgmM9g3VkcIJjP4V3YWt1MgE"}'
2025-02-16 04:04:36.072 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:36.072 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25404/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.92.140/tcp/39932/p2p/16Uiu2HAmUXkWJpRyt78dFAVxvJsGzSqAJgu4BeU1E7CYuEKxCMkq"]'
2025-02-16 04:04:36.113 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:36.122 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:36.122 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-16_04-04-33__a0359239-b02c-4619-87e6-04575c81eae7__wakuorg_nwaku:latest.log
2025-02-16 04:04:36.122 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:36.122 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:36.124 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:36.124 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.73.197
2025-02-16 04:04:36.124 DEBUG [src.node.docker_mananger] Generated ports ['60657', '60658', '60659', '60660', '60661']
2025-02-16 04:04:36.124 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:36.124 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:36.124 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:36.124 DEBUG [src.node.docker_mananger] docker run -i -t -p 60657:60657 -p 60658:60658 -p 60659:60659 -p 60660:60660 -p 60661:60661 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60659 --rest-port=60657 --tcp-port=60658 --discv5-udp-port=60660 --rest-address=0.0.0.0 --nat=extip:172.18.73.197 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f7dba8aceb07f6cfdeacf8bd2bfae2cda3aabbe56ca230bd4ffbcfb91ccaa4c4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60661 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHug3PwVbWw4uEXHHcts7lBxXVmp9OE_FzexVuB-1p0uX9LDWE69KzAIDYMpBb0J4xPqYxBcyp5yN0wPVU7TJxcCgmlkgnY0gmlwhKwSXIyKbXVsdGlhZGRyc5YACASsElyMBpv8AAoErBJcjAab_d0DgnJzhQADAQAAiXNlY3AyNTZrMaED6-BFZ9Dh7zkaHxequJ8zBVN5OqieVF05iWS_MBHQFGaDdGNwgpv8g3VkcIKb_oV3YWt1Mgk --lightpushnode=/ip4/172.18.92.140/tcp/39932/p2p/16Uiu2HAmUXkWJpRyt78dFAVxvJsGzSqAJgu4BeU1E7CYuEKxCMkq --lightpush=true --relay=false
2025-02-16 04:04:36.357 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.73.197 waku fc39131853de0fa785674c093dc38a3ed2457a5ccd760fd51a050a9f398aa7e3
2025-02-16 04:04:36.405 DEBUG [src.node.docker_mananger] Container started with ID fc39131853de. Setting up logs at ./log/docker/lightpush_node1_2025-02-16_04-04-33__a0359239-b02c-4619-87e6-04575c81eae7__wakuorg_nwaku:latest.log
2025-02-16 04:04:36.406 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60657
2025-02-16 04:04:36.406 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:37.407 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60657/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:37.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:37.410 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:37.410 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60657/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:37.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.73.197/tcp/60658/p2p/16Uiu2HAm47J6tB6W9tKVwbkSdYP3V36Haf5scczKUAu3q4TRsjMN","/ip4/172.18.73.197/tcp/60659/ws/p2p/16Uiu2HAm47J6tB6W9tKVwbkSdYP3V36Haf5scczKUAu3q4TRsjMN"],"enrUri":"enr:-L24QFt2trxTeGvqM1HRvrc6o_zJaCOJGuDLSXmPaeTz4K3fLiDmGa5g-gE1vXZHniHHm6UPBmhitBjSZMVrp_xfRjcCgmlkgnY0gmlwhKwSScWKbXVsdGlhZGRyc5YACASsEknFBuzyAAoErBJJxQbs890DgnJzhQADAQAAiXNlY3AyNTZrMaECgQP9kcf0lG-iGVGHYYXprONlXCt696rIDkeFmbutJNWDdGNwguzyg3VkcILs9IV3YWt1Mgg"}'
2025-02-16 04:04:37.413 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:37.413 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.92.140/tcp/39932/p2p/16Uiu2HAmUXkWJpRyt78dFAVxvJsGzSqAJgu4BeU1E7CYuEKxCMkq"]'
2025-02-16 04:04:37.448 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:37.450 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.165.46/tcp/25405/p2p/16Uiu2HAmHDzkiPJkHvssAfCyRyVRKTVw8K4ZSKN3QZUXXCbCsdcp"]'
2025-02-16 04:04:37.479 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:37.480 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39931/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 04:04:37.489 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:37.491 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25404/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 04:04:37.494 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:37.496 DEBUG [tests.light_push.test_publish] Running test with payload Empty string
2025-02-16 04:04:37.496 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739678677496662784}}'
2025-02-16 04:04:37.500 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60657/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:04:37.501 DEBUG [tests.light_push.test_publish] Running test with payload Unecoded text
2025-02-16 04:04:37.502 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739678677502466816}}'
2025-02-16 04:04:37.506 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60657/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
2025-02-16 04:04:37.506 DEBUG [tests.light_push.test_publish] Running test with payload A dictionary
2025-02-16 04:04:37.507 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739678677507160064}}'
2025-02-16 04:04:37.509 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60657/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:04:37.510 DEBUG [tests.light_push.test_publish] Running test with payload An integer
2025-02-16 04:04:37.510 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739678677510340864}}'
2025-02-16 04:04:37.513 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60657/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:04:37.513 DEBUG [tests.light_push.test_publish] Running test with payload A list
2025-02-16 04:04:37.513 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739678677513526528}}'
2025-02-16 04:04:37.516 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60657/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:04:37.516 DEBUG [tests.light_push.test_publish] Running test with payload A bool
2025-02-16 04:04:37.516 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60657/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739678677516576256}}'
2025-02-16 04:04:37.519 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:60657/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:04:37.520 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 04:04:37.521 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 04:04:37.521 DEBUG [src.node.waku_node] Stopping container with id bb499697b7c1
2025-02-16 04:04:38.264 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:38.264 DEBUG [src.node.waku_node] Stopping container with id fe2733afe03c
2025-02-16 04:04:39.076 ERROR [src.node.docker_mananger] Max retries reached for container bb499697b7c1. Exiting log stream.
2025-02-16 04:04:39.190 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:39.190 DEBUG [src.node.waku_node] Stopping container with id fc39131853de
2025-02-16 04:04:40.003 ERROR [src.node.docker_mananger] Max retries reached for container fe2733afe03c. Exiting log stream.
2025-02-16 04:04:40.342 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:40.343 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 04:04:40.351 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:04:40.358 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:04:40.364 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
