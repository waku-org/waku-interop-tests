2025-02-16 04:04:18.095 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 04:04:18.095 DEBUG [tests.conftest] Running test: test_publish_with_valid_meta with id: 2025-02-16_04-04-18__05ecde5b-a5ff-46be-a530-f5c05394df7a
2025-02-16 04:04:18.096 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 04:04:18.096 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-16 04:04:18.096 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-16 04:04:18.102 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:18.102 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-16_04-04-18__05ecde5b-a5ff-46be-a530-f5c05394df7a__wakuorg_nwaku:latest.log
2025-02-16 04:04:18.103 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:18.103 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:18.104 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:18.104 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.60.159
2025-02-16 04:04:18.104 DEBUG [src.node.docker_mananger] Generated ports ['45892', '45893', '45894', '45895', '45896']
2025-02-16 04:04:18.104 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:18.105 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:18.105 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:18.105 DEBUG [src.node.docker_mananger] docker run -i -t -p 45892:45892 -p 45893:45893 -p 45894:45894 -p 45895:45895 -p 45896:45896 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45894 --rest-port=45892 --tcp-port=45893 --discv5-udp-port=45895 --rest-address=0.0.0.0 --nat=extip:172.18.60.159 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7fa7e9d18faeeaecc1d0e3cccb4b8fe06dc0a02e4a2c0c2133c8c476da6f9bfd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45896 --metrics-logging=true --relay=true
2025-02-16 04:04:18.335 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.60.159 waku 80c528ee5d4921000fc8e56eb3cdf1fa33b41e640508153529ecb9abc113fd32
2025-02-16 04:04:18.391 DEBUG [src.node.docker_mananger] Container started with ID 80c528ee5d49. Setting up logs at ./log/docker/node1_2025-02-16_04-04-18__05ecde5b-a5ff-46be-a530-f5c05394df7a__wakuorg_nwaku:latest.log
2025-02-16 04:04:18.392 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 45892
2025-02-16 04:04:18.392 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:18.893 ERROR [src.node.docker_mananger] Max retries reached for container c61a97a185e3. Exiting log stream.
2025-02-16 04:04:19.392 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45892/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:19.395 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:19.395 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:19.395 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45892/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:19.397 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.60.159/tcp/45893/p2p/16Uiu2HAmLtydG9jEJukgJtcq1GKvphTjRQSxUdXX9xGygtcr5enx","/ip4/172.18.60.159/tcp/45894/ws/p2p/16Uiu2HAmLtydG9jEJukgJtcq1GKvphTjRQSxUdXX9xGygtcr5enx"],"enrUri":"enr:-L24QL-X-qvb0jybML1jAbf3tooCAdlVkTt-hwnv_1GYTgv_GUuE3w-HK8KPal6HLafIYoDzo7Kk1ScyahFNEWrQVKICgmlkgnY0gmlwhKwSPJ-KbXVsdGlhZGRyc5YACASsEjyfBrNFAAoErBI8nwazRt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDenLOsmaOQj8SsvALqk6wiDuWmVG3jdhNqpBk6JHs4G2DdGNwgrNFg3VkcIKzR4V3YWt1MgE"}'
2025-02-16 04:04:19.398 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:19.404 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:19.404 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-16_04-04-18__05ecde5b-a5ff-46be-a530-f5c05394df7a__wakuorg_nwaku:latest.log
2025-02-16 04:04:19.404 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:19.404 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:19.405 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:19.405 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.215.71
2025-02-16 04:04:19.406 DEBUG [src.node.docker_mananger] Generated ports ['20625', '20626', '20627', '20628', '20629']
2025-02-16 04:04:19.406 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:19.406 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:19.406 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:19.406 DEBUG [src.node.docker_mananger] docker run -i -t -p 20625:20625 -p 20626:20626 -p 20627:20627 -p 20628:20628 -p 20629:20629 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20627 --rest-port=20625 --tcp-port=20626 --discv5-udp-port=20628 --rest-address=0.0.0.0 --nat=extip:172.18.215.71 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=feccc9e91c73ebc85ae69682e074afaf8bdbe49b76dd5f0feb831dc2f46aab18 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20629 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QL-X-qvb0jybML1jAbf3tooCAdlVkTt-hwnv_1GYTgv_GUuE3w-HK8KPal6HLafIYoDzo7Kk1ScyahFNEWrQVKICgmlkgnY0gmlwhKwSPJ-KbXVsdGlhZGRyc5YACASsEjyfBrNFAAoErBI8nwazRt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDenLOsmaOQj8SsvALqk6wiDuWmVG3jdhNqpBk6JHs4G2DdGNwgrNFg3VkcIKzR4V3YWt1MgE
2025-02-16 04:04:19.634 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.215.71 waku 346250cf42bcbc56e4cf5661ee95931981cf5b2dcfccddd2cb71bbe6073a6e1a
2025-02-16 04:04:19.682 DEBUG [src.node.docker_mananger] Container started with ID 346250cf42bc. Setting up logs at ./log/docker/node2_2025-02-16_04-04-18__05ecde5b-a5ff-46be-a530-f5c05394df7a__wakuorg_nwaku:latest.log
2025-02-16 04:04:19.682 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20625
2025-02-16 04:04:19.683 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:20.684 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20625/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:20.687 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:20.688 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:20.688 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20625/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:20.694 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.215.71/tcp/20626/p2p/16Uiu2HAmKRGH9JL7zwMW14XM2gNg9ecWHKJYszYS8EFKnBMir61z","/ip4/172.18.215.71/tcp/20627/ws/p2p/16Uiu2HAmKRGH9JL7zwMW14XM2gNg9ecWHKJYszYS8EFKnBMir61z"],"enrUri":"enr:-L24QFrkzuEZIdfmFjNK7RpKzZ7lJ8N6hPYB0AbhLrQIxsGZOgL-5wOiaItRtUGB30x3MUQJuBLqaLVqQpH2xwtR5cQCgmlkgnY0gmlwhKwS10eKbXVsdGlhZGRyc5YACASsEtdHBlCSAAoErBLXRwZQk90DgnJzhQADAQAAiXNlY3AyNTZrMaEDZH2wBeFYFegiVz2PoXBVM0lv-DM9K4RVxqfdiuW6HKWDdGNwglCSg3VkcIJQlIV3YWt1MgE"}'
2025-02-16 04:04:20.695 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:20.695 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20625/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.60.159/tcp/45893/p2p/16Uiu2HAmLtydG9jEJukgJtcq1GKvphTjRQSxUdXX9xGygtcr5enx"]'
2025-02-16 04:04:20.699 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:20.699 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-16 04:04:20.700 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45892/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:04:20.706 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:20.706 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20625/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:04:20.713 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:20.714 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45892/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:20.719 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:20.720 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:20.820 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:20.820 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45892/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:20.823 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678660714068224,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:20.824 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:20.824 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20625/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:20.827 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678660714068224,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:20.828 INFO [src.steps.relay] WARM UP successful!!
2025-02-16 04:04:20.829 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45892/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "meta": "UmVsYXkgd29ya3MhIQ=="}'
2025-02-16 04:04:20.833 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:20.834 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:20.935 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:20.935 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45892/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:20.938 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678660829334272,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false,"proof":""}]'
2025-02-16 04:04:20.940 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:20.941 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20625/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:20.943 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678660829334272,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false,"proof":""}]'
2025-02-16 04:04:20.946 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 04:04:20.947 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 04:04:20.947 DEBUG [src.node.waku_node] Stopping container with id 80c528ee5d49
2025-02-16 04:04:21.878 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:21.878 DEBUG [src.node.waku_node] Stopping container with id 346250cf42bc
2025-02-16 04:04:22.691 ERROR [src.node.docker_mananger] Max retries reached for container 80c528ee5d49. Exiting log stream.
2025-02-16 04:04:23.382 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:23.383 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 04:04:23.389 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:04:23.394 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
