2025-02-16 04:04:48.125 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 04:04:48.126 DEBUG [tests.conftest] Running test: test_publish_after_node_pauses_and_pauses with id: 2025-02-16_04-04-48__30695c6b-3d73-487d-b9e5-1aafbbb65e62
2025-02-16 04:04:48.126 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 04:04:48.126 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-16 04:04:48.126 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-16 04:04:48.132 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:48.132 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-16_04-04-48__30695c6b-3d73-487d-b9e5-1aafbbb65e62__wakuorg_nwaku:latest.log
2025-02-16 04:04:48.133 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:48.133 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:48.134 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:48.134 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.153.14
2025-02-16 04:04:48.134 DEBUG [src.node.docker_mananger] Generated ports ['19534', '19535', '19536', '19537', '19538']
2025-02-16 04:04:48.135 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:48.135 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:48.135 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:48.135 DEBUG [src.node.docker_mananger] docker run -i -t -p 19534:19534 -p 19535:19535 -p 19536:19536 -p 19537:19537 -p 19538:19538 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19536 --rest-port=19534 --tcp-port=19535 --discv5-udp-port=19537 --rest-address=0.0.0.0 --nat=extip:172.18.153.14 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=67f7a05856d45b9dda400babfdbc5b8da0cf8abcd131acd721e7d4ce5b4ae220 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19538 --metrics-logging=true --relay=true
2025-02-16 04:04:48.360 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.153.14 waku 1ed08a6d94f297d8dd3df4c8df8f9716234bd8d2de05dcef432e17421708c673
2025-02-16 04:04:48.407 DEBUG [src.node.docker_mananger] Container started with ID 1ed08a6d94f2. Setting up logs at ./log/docker/node1_2025-02-16_04-04-48__30695c6b-3d73-487d-b9e5-1aafbbb65e62__wakuorg_nwaku:latest.log
2025-02-16 04:04:48.409 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19534
2025-02-16 04:04:48.409 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:48.933 ERROR [src.node.docker_mananger] Max retries reached for container db42c9dd1c6b. Exiting log stream.
2025-02-16 04:04:49.409 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19534/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:49.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:49.412 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:49.413 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19534/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:49.415 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.153.14/tcp/19535/p2p/16Uiu2HAmQwYg2JEwDs2zQJqwooxehQFrBXvzfvAeUPHYCSqre4Hq","/ip4/172.18.153.14/tcp/19536/ws/p2p/16Uiu2HAmQwYg2JEwDs2zQJqwooxehQFrBXvzfvAeUPHYCSqre4Hq"],"enrUri":"enr:-L24QK_AG1uIQBq0AXZnD1_H1zH2PuOVliupevijZBzHitkBH86LUmgDqDbtHg0YL9ne5SOWI3aXEBh3GF_4l2zBYkoCgmlkgnY0gmlwhKwSmQ6KbXVsdGlhZGRyc5YACASsEpkOBkxPAAoErBKZDgZMUN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDtooVcqQHFDs5FLIT1fvG04oiZnusJs0fHAFOgDTaL9SDdGNwgkxPg3VkcIJMUYV3YWt1MgE"}'
2025-02-16 04:04:49.415 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:49.421 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:49.421 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-16_04-04-48__30695c6b-3d73-487d-b9e5-1aafbbb65e62__wakuorg_nwaku:latest.log
2025-02-16 04:04:49.421 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:49.421 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:49.423 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:49.423 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.46.4
2025-02-16 04:04:49.423 DEBUG [src.node.docker_mananger] Generated ports ['30590', '30591', '30592', '30593', '30594']
2025-02-16 04:04:49.423 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:49.423 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:49.424 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:49.424 DEBUG [src.node.docker_mananger] docker run -i -t -p 30590:30590 -p 30591:30591 -p 30592:30592 -p 30593:30593 -p 30594:30594 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30592 --rest-port=30590 --tcp-port=30591 --discv5-udp-port=30593 --rest-address=0.0.0.0 --nat=extip:172.18.46.4 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=234ab4caa2b4c8c1eabc1b1fdec18f7bd2cde53c4434209ce47f0af6d0bff873 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30594 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QK_AG1uIQBq0AXZnD1_H1zH2PuOVliupevijZBzHitkBH86LUmgDqDbtHg0YL9ne5SOWI3aXEBh3GF_4l2zBYkoCgmlkgnY0gmlwhKwSmQ6KbXVsdGlhZGRyc5YACASsEpkOBkxPAAoErBKZDgZMUN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDtooVcqQHFDs5FLIT1fvG04oiZnusJs0fHAFOgDTaL9SDdGNwgkxPg3VkcIJMUYV3YWt1MgE
2025-02-16 04:04:49.648 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.46.4 waku 50a7d289aa244702a655fdbf21ef823db4a01c0a98ab427d1ff7c590405f0ed8
2025-02-16 04:04:49.698 DEBUG [src.node.docker_mananger] Container started with ID 50a7d289aa24. Setting up logs at ./log/docker/node2_2025-02-16_04-04-48__30695c6b-3d73-487d-b9e5-1aafbbb65e62__wakuorg_nwaku:latest.log
2025-02-16 04:04:49.698 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30590
2025-02-16 04:04:49.699 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:50.700 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30590/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:50.706 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:50.707 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:50.708 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30590/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:50.713 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.46.4/tcp/30591/p2p/16Uiu2HAmCEtz6t3YVgk9Y7rorBepfUXMFMNVW4w3hvp3cxrqax5Z","/ip4/172.18.46.4/tcp/30592/ws/p2p/16Uiu2HAmCEtz6t3YVgk9Y7rorBepfUXMFMNVW4w3hvp3cxrqax5Z"],"enrUri":"enr:-L24QKHsmRR6KrgEfkfUapVb7p5ekl3p2pZOCgmDuddwQEFWaG_MzKCIUUPRAnOVjLEtK8pxMmXisJcLU_lgdaMMkPICgmlkgnY0gmlwhKwSLgSKbXVsdGlhZGRyc5YACASsEi4EBnd_AAoErBIuBAZ3gN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-dP-d53fA-tYRRgXrIOVT3vCOHfhTiqAsPhFyjwKTMyDdGNwgnd_g3VkcIJ3gYV3YWt1MgE"}'
2025-02-16 04:04:50.713 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:50.713 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30590/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.153.14/tcp/19535/p2p/16Uiu2HAmQwYg2JEwDs2zQJqwooxehQFrBXvzfvAeUPHYCSqre4Hq"]'
2025-02-16 04:04:50.716 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:50.716 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-16 04:04:50.716 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19534/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:04:50.720 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:50.721 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30590/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:04:50.725 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:50.727 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:50.732 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:50.733 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:50.833 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:50.833 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:50.835 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678690727060224,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:50.837 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:50.837 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30590/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:50.839 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678690727060224,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:50.841 INFO [src.steps.relay] WARM UP successful!!
2025-02-16 04:04:50.842 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:50.846 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:50.847 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:50.947 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:50.947 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:50.950 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678690841953024,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:50.951 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:50.951 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30590/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:50.953 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678690841953024,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:50.955 DEBUG [src.node.waku_node] Pausing container with id 1ed08a6d94f2
2025-02-16 04:04:50.964 DEBUG [src.node.waku_node] Unpause container with id 1ed08a6d94f2
2025-02-16 04:04:50.972 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTE=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:50.977 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:50.977 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:51.077 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:51.078 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:51.080 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678690972448000,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:51.081 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:51.082 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30590/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:51.084 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678690972448000,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:51.085 DEBUG [src.node.waku_node] Pausing container with id 50a7d289aa24
2025-02-16 04:04:51.094 DEBUG [src.node.waku_node] Unpause container with id 50a7d289aa24
2025-02-16 04:04:51.102 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTI=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:51.107 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:51.107 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:51.208 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:51.208 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19534/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:51.211 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678691102541312,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:51.212 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:51.212 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30590/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:51.214 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678691102541312,"ephemeral":false,"proof":""}]'
2025-02-16 04:04:51.217 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 04:04:51.218 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 04:04:51.218 DEBUG [src.node.waku_node] Stopping container with id 1ed08a6d94f2
2025-02-16 04:04:51.873 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:51.873 DEBUG [src.node.waku_node] Stopping container with id 50a7d289aa24
2025-02-16 04:04:52.686 ERROR [src.node.docker_mananger] Max retries reached for container 1ed08a6d94f2. Exiting log stream.
2025-02-16 04:04:53.371 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:53.373 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 04:04:53.379 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:04:53.385 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
