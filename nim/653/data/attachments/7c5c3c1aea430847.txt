2025-02-16 04:04:12.367 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 04:04:12.368 DEBUG [tests.conftest] Running test: test_filter_resubscribe_to_unsubscribed_topics with id: 2025-02-16_04-04-12__bb681ca3-8bb3-4e68-a34b-a76b00b5bd45
2025-02-16 04:04:12.369 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 04:04:12.369 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-16 04:04:12.369 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-16 04:04:12.377 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:12.378 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-16_04-04-12__bb681ca3-8bb3-4e68-a34b-a76b00b5bd45__wakuorg_nwaku:latest.log
2025-02-16 04:04:12.378 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:12.378 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:12.380 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:12.380 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.219.90
2025-02-16 04:04:12.380 DEBUG [src.node.docker_mananger] Generated ports ['8264', '8265', '8266', '8267', '8268']
2025-02-16 04:04:12.381 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:12.381 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:12.381 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:12.381 DEBUG [src.node.docker_mananger] docker run -i -t -p 8264:8264 -p 8265:8265 -p 8266:8266 -p 8267:8267 -p 8268:8268 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8266 --rest-port=8264 --tcp-port=8265 --discv5-udp-port=8267 --rest-address=0.0.0.0 --nat=extip:172.18.219.90 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=71c1ff1e7983d5ca7dab4dc8345b4de221a9ccc5b13cfc07ff8d3aa9fe42a9e9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8268 --metrics-logging=true --relay=true --filter=true
2025-02-16 04:04:12.614 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.219.90 waku bdc4afadfbbe6cfba54202c0893f5c3fe9a6506696967e5baf152c62883f9df9
2025-02-16 04:04:12.664 DEBUG [src.node.docker_mananger] Container started with ID bdc4afadfbbe. Setting up logs at ./log/docker/node1_2025-02-16_04-04-12__bb681ca3-8bb3-4e68-a34b-a76b00b5bd45__wakuorg_nwaku:latest.log
2025-02-16 04:04:12.665 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 8264
2025-02-16 04:04:12.665 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:13.190 ERROR [src.node.docker_mananger] Max retries reached for container 99dffba52250. Exiting log stream.
2025-02-16 04:04:13.665 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8264/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:13.669 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:13.669 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:13.669 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:8264/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:13.671 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.219.90/tcp/8265/p2p/16Uiu2HAmP4rZxR4xpPXWQFNSJVxyGAjFjUUJqNZwCWD3WWJatBN8","/ip4/172.18.219.90/tcp/8266/ws/p2p/16Uiu2HAmP4rZxR4xpPXWQFNSJVxyGAjFjUUJqNZwCWD3WWJatBN8"],"enrUri":"enr:-L24QMlVCLfwnZc_BI2Nf-zkPkybeTfeeJ1S-ksxGpBiChacIFV0chGsvhR6NuBmH3CGsBsY4o8tJATOFmaSHyVVuOgCgmlkgnY0gmlwhKwS21qKbXVsdGlhZGRyc5YACASsEttaBiBJAAoErBLbWgYgSt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDmrICji4Dtd7CiU3iVEcUGhwq2jEIqY1844ymtc_ByJmDdGNwgiBJg3VkcIIgS4V3YWt1MgU"}'
2025-02-16 04:04:13.672 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:13.672 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-16 04:04:13.678 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:04:13.678 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-16_04-04-12__bb681ca3-8bb3-4e68-a34b-a76b00b5bd45__wakuorg_nwaku:latest.log
2025-02-16 04:04:13.678 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:04:13.678 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:04:13.680 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:04:13.680 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.137.206
2025-02-16 04:04:13.680 DEBUG [src.node.docker_mananger] Generated ports ['24016', '24017', '24018', '24019', '24020']
2025-02-16 04:04:13.680 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:04:13.680 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:04:13.680 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:04:13.680 DEBUG [src.node.docker_mananger] docker run -i -t -p 24016:24016 -p 24017:24017 -p 24018:24018 -p 24019:24019 -p 24020:24020 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24018 --rest-port=24016 --tcp-port=24017 --discv5-udp-port=24019 --rest-address=0.0.0.0 --nat=extip:172.18.137.206 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a5fc3a1bbd7e1a46ec7ce0d95ac39f11bb371cb92fc2cddbefdca8f2cfdeb6b6 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24020 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QMlVCLfwnZc_BI2Nf-zkPkybeTfeeJ1S-ksxGpBiChacIFV0chGsvhR6NuBmH3CGsBsY4o8tJATOFmaSHyVVuOgCgmlkgnY0gmlwhKwS21qKbXVsdGlhZGRyc5YACASsEttaBiBJAAoErBLbWgYgSt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDmrICji4Dtd7CiU3iVEcUGhwq2jEIqY1844ymtc_ByJmDdGNwgiBJg3VkcIIgS4V3YWt1MgU --filternode=/ip4/172.18.219.90/tcp/8265/p2p/16Uiu2HAmP4rZxR4xpPXWQFNSJVxyGAjFjUUJqNZwCWD3WWJatBN8
2025-02-16 04:04:13.904 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.137.206 waku cacf10cccc581f56715e71ff05e3dce2a2954f32f8a42b54558f1262f677c902
2025-02-16 04:04:13.957 DEBUG [src.node.docker_mananger] Container started with ID cacf10cccc58. Setting up logs at ./log/docker/node2_2025-02-16_04-04-12__bb681ca3-8bb3-4e68-a34b-a76b00b5bd45__wakuorg_nwaku:latest.log
2025-02-16 04:04:13.957 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24016
2025-02-16 04:04:13.958 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:04:14.958 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24016/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:14.961 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:04:14.961 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:04:14.961 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24016/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:14.963 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.137.206/tcp/24017/p2p/16Uiu2HAmHdJan4HV4AYmtyn4NqTZYsrYEAjHjznsjyh4Jb6dwvej","/ip4/172.18.137.206/tcp/24018/ws/p2p/16Uiu2HAmHdJan4HV4AYmtyn4NqTZYsrYEAjHjznsjyh4Jb6dwvej"],"enrUri":"enr:-L24QOxcFG0uCrvxH_HTEgXM3c0ELfviIw9cKn04pt3VmOZTXlgvqNiKUTJGM7qhl293IApwumbZQlq0MRNCf4tNHNUCgmlkgnY0gmlwhKwSic6KbXVsdGlhZGRyc5YACASsEonOBl3RAAoErBKJzgZd0t0DgnJzhQADAQAAiXNlY3AyNTZrMaEDSdvjfK7AUgl5Sw1F3Iy2Q1YsloVjdULsjinlfzRPMdCDdGNwgl3Rg3VkcIJd04V3YWt1MgA"}'
2025-02-16 04:04:14.964 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:04:14.964 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24016/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.219.90/tcp/8265/p2p/16Uiu2HAmP4rZxR4xpPXWQFNSJVxyGAjFjUUJqNZwCWD3WWJatBN8"]'
2025-02-16 04:04:14.999 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:14.999 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-16 04:04:15.000 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8264/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:04:15.016 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:15.017 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24016/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "c03a995a-05e0-4492-9465-f2dc0d4dd50a", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-16 04:04:15.032 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"c03a995a-05e0-4492-9465-f2dc0d4dd50a","statusDesc":"OK"}'
2025-02-16 04:04:15.033 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8264/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:15.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:15.041 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:15.141 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:15.142 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24016/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:15.145 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739678655033519360,"ephemeral":false}]'
2025-02-16 04:04:15.146 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:24016/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-16 04:04:15.155 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-16 04:04:15.155 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8264/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:15.159 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:15.159 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:15.259 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:15.260 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24016/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:15.262 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24016/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
2025-02-16 04:04:15.264 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8264/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:04:15.267 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:15.267 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24016/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "96e95805-dc8e-4345-bf17-6df38ce3a15b", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-16 04:04:15.275 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"96e95805-dc8e-4345-bf17-6df38ce3a15b","statusDesc":"OK"}'
2025-02-16 04:04:15.276 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:8264/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:04:15.279 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:04:15.280 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:04:15.380 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:04:15.380 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24016/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:04:15.383 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739678655275969792,"ephemeral":false}]'
2025-02-16 04:04:15.386 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 04:04:15.387 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 04:04:15.387 DEBUG [src.node.waku_node] Stopping container with id bdc4afadfbbe
2025-02-16 04:04:16.238 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:16.239 DEBUG [src.node.waku_node] Stopping container with id cacf10cccc58
2025-02-16 04:04:17.051 ERROR [src.node.docker_mananger] Max retries reached for container bdc4afadfbbe. Exiting log stream.
2025-02-16 04:04:17.759 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:04:17.762 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 04:04:17.768 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:04:17.772 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
