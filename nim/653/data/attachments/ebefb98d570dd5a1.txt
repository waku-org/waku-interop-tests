2025-02-16 04:03:07.595 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 04:03:07.595 DEBUG [tests.conftest] Running test: test_msg_stored_when_ephemeral_false with id: 2025-02-16_04-03-07__2fa4d1f0-f1bd-4af0-b93c-ea167b31dc00
2025-02-16 04:03:07.595 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 04:03:07.596 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-16 04:03:07.596 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-16 04:03:07.603 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:03:07.603 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-16_04-03-07__2fa4d1f0-f1bd-4af0-b93c-ea167b31dc00__wakuorg_nwaku:latest.log
2025-02-16 04:03:07.609 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:03:07.610 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-16_04-03-07__2fa4d1f0-f1bd-4af0-b93c-ea167b31dc00__wakuorg_nwaku:latest.log
2025-02-16 04:03:07.616 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:03:07.616 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-16_04-03-07__2fa4d1f0-f1bd-4af0-b93c-ea167b31dc00__wakuorg_nwaku:latest.log
2025-02-16 04:03:07.616 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-16 04:03:07.616 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-16 04:03:07.617 DEBUG [tests.e2e.test_e2e] Start 3 nodes
2025-02-16 04:03:07.618 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:03:07.618 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:03:07.619 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:03:07.619 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.84.21
2025-02-16 04:03:07.620 DEBUG [src.node.docker_mananger] Generated ports ['62212', '62213', '62214', '62215', '62216']
2025-02-16 04:03:07.620 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:03:07.620 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:03:07.620 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:03:07.620 DEBUG [src.node.docker_mananger] docker run -i -t -p 62212:62212 -p 62213:62213 -p 62214:62214 -p 62215:62215 -p 62216:62216 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62214 --rest-port=62212 --tcp-port=62213 --discv5-udp-port=62215 --rest-address=0.0.0.0 --nat=extip:172.18.84.21 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=518dc3e59ef77fd2def78e4963b65db3ab34a6c2e27aab182ddabe8f5a6aeb6e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62216 --metrics-logging=true --relay=true --store=true
2025-02-16 04:03:07.857 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.84.21 waku bf1a5733294e8d6430e65dce8083465060308755c2ea8ff514ad1c742341bd18
2025-02-16 04:03:07.903 DEBUG [src.node.docker_mananger] Container started with ID bf1a5733294e. Setting up logs at ./log/docker/node1_2025-02-16_04-03-07__2fa4d1f0-f1bd-4af0-b93c-ea167b31dc00__wakuorg_nwaku:latest.log
2025-02-16 04:03:07.905 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 62212
2025-02-16 04:03:07.905 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:03:08.398 ERROR [src.node.docker_mananger] Max retries reached for container 9569f6c13833. Exiting log stream.
2025-02-16 04:03:08.905 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62212/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:08.909 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:03:08.909 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:03:08.909 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62212/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:08.912 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.84.21/tcp/62213/p2p/16Uiu2HAmBZu92x84FLGqypXuwxN5qVf5dRRhMSvtxWoB1eXb51t8","/ip4/172.18.84.21/tcp/62214/ws/p2p/16Uiu2HAmBZu92x84FLGqypXuwxN5qVf5dRRhMSvtxWoB1eXb51t8"],"enrUri":"enr:-L24QMEuKahru2gbcnQ1_Po1TYpF20xyv8Ha2h7aAF24Tj2WAy_00DyIe4BZf2jlt10I9TYD1eCGfZygSxq0E43GJocCgmlkgnY0gmlwhKwSVBWKbXVsdGlhZGRyc5YACASsElQVBvMFAAoErBJUFQbzBt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC79aEP16dPwv9fg8sRd06kJFAnCt8qvBa3mVKRlHOslWDdGNwgvMFg3VkcILzB4V3YWt1MgM"}'
2025-02-16 04:03:08.912 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:03:08.912 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:03:08.912 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:03:08.914 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:03:08.914 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.124.36
2025-02-16 04:03:08.914 DEBUG [src.node.docker_mananger] Generated ports ['57748', '57749', '57750', '57751', '57752']
2025-02-16 04:03:08.914 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:03:08.914 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:03:08.914 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:03:08.915 DEBUG [src.node.docker_mananger] docker run -i -t -p 57748:57748 -p 57749:57749 -p 57750:57750 -p 57751:57751 -p 57752:57752 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57750 --rest-port=57748 --tcp-port=57749 --discv5-udp-port=57751 --rest-address=0.0.0.0 --nat=extip:172.18.124.36 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bad7debb7fcea589bca5c62b8a477b3e65d6b535d3a07d71f283ef34c3dbcf2f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57752 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QMEuKahru2gbcnQ1_Po1TYpF20xyv8Ha2h7aAF24Tj2WAy_00DyIe4BZf2jlt10I9TYD1eCGfZygSxq0E43GJocCgmlkgnY0gmlwhKwSVBWKbXVsdGlhZGRyc5YACASsElQVBvMFAAoErBJUFQbzBt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC79aEP16dPwv9fg8sRd06kJFAnCt8qvBa3mVKRlHOslWDdGNwgvMFg3VkcILzB4V3YWt1MgM
2025-02-16 04:03:09.152 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.124.36 waku 6da401971d7101ea2ba6bba9274cfd21af84f8c4c3036d685b49e507d86a54ff
2025-02-16 04:03:09.201 DEBUG [src.node.docker_mananger] Container started with ID 6da401971d71. Setting up logs at ./log/docker/node2_2025-02-16_04-03-07__2fa4d1f0-f1bd-4af0-b93c-ea167b31dc00__wakuorg_nwaku:latest.log
2025-02-16 04:03:09.202 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 57748
2025-02-16 04:03:09.203 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:03:10.203 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57748/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:10.206 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:03:10.207 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:03:10.207 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57748/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:10.211 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.124.36/tcp/57749/p2p/16Uiu2HAmAaodYBGwkpoLifsmMrSmE4GcvAhFkWe9bYJSZUr2eUdQ","/ip4/172.18.124.36/tcp/57750/ws/p2p/16Uiu2HAmAaodYBGwkpoLifsmMrSmE4GcvAhFkWe9bYJSZUr2eUdQ"],"enrUri":"enr:-L24QEA_9huyQnScnXakonRgvaTikiJP2P7jgRivwjuIirK5TvS20zqU6itlx6q23qw4Bxvqk5vb6TMy5lOuFV9qfB8CgmlkgnY0gmlwhKwSfCSKbXVsdGlhZGRyc5YACASsEnwkBuGVAAoErBJ8JAbhlt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4TYukzOjjUsDPMxmXT1Ikq3Zm_Wt9W_Uj7dWBzDGO0ODdGNwguGVg3VkcILhl4V3YWt1MgM"}'
2025-02-16 04:03:10.212 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:03:10.214 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:03:10.215 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:03:10.223 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:03:10.224 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.181.0
2025-02-16 04:03:10.226 DEBUG [src.node.docker_mananger] Generated ports ['39369', '39370', '39371', '39372', '39373']
2025-02-16 04:03:10.226 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:03:10.227 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:03:10.227 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:03:10.227 DEBUG [src.node.docker_mananger] docker run -i -t -p 39369:39369 -p 39370:39370 -p 39371:39371 -p 39372:39372 -p 39373:39373 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39371 --rest-port=39369 --tcp-port=39370 --discv5-udp-port=39372 --rest-address=0.0.0.0 --nat=extip:172.18.181.0 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=74c7b3c029fb3dbfecc1c9a17d2cae4bc34d0cf65f8af6c2ddc9ba5dde2ed2cd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39373 --metrics-logging=true --relay=false --storenode=/ip4/172.18.124.36/tcp/57749/p2p/16Uiu2HAmAaodYBGwkpoLifsmMrSmE4GcvAhFkWe9bYJSZUr2eUdQ --discv5-bootstrap-node=enr:-L24QEA_9huyQnScnXakonRgvaTikiJP2P7jgRivwjuIirK5TvS20zqU6itlx6q23qw4Bxvqk5vb6TMy5lOuFV9qfB8CgmlkgnY0gmlwhKwSfCSKbXVsdGlhZGRyc5YACASsEnwkBuGVAAoErBJ8JAbhlt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4TYukzOjjUsDPMxmXT1Ikq3Zm_Wt9W_Uj7dWBzDGO0ODdGNwguGVg3VkcILhl4V3YWt1MgM
2025-02-16 04:03:10.479 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.181.0 waku 2054e2e2370f1d346351875539234046292ea8ef8d6fd6beca49110244e78dc6
2025-02-16 04:03:10.534 DEBUG [src.node.docker_mananger] Container started with ID 2054e2e2370f. Setting up logs at ./log/docker/node3_2025-02-16_04-03-07__2fa4d1f0-f1bd-4af0-b93c-ea167b31dc00__wakuorg_nwaku:latest.log
2025-02-16 04:03:10.534 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39369
2025-02-16 04:03:10.534 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:03:11.535 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39369/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:11.537 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:03:11.538 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:03:11.538 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39369/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:11.540 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.181.0/tcp/39370/p2p/16Uiu2HAmCvGnpAvsnujus1YLUZcvBa6HQ4dFXNz9fVpzBrpZPQHK","/ip4/172.18.181.0/tcp/39371/ws/p2p/16Uiu2HAmCvGnpAvsnujus1YLUZcvBa6HQ4dFXNz9fVpzBrpZPQHK"],"enrUri":"enr:-L24QNwvQLSHo6nuPIb6zO8ggfLn3Cwag6E8m0Q39CmfMH5tPyzeCyX3mNoc45l2OGWqEMqL5Z-xXArJJ2zm5djccm4CgmlkgnY0gmlwhKwStQCKbXVsdGlhZGRyc5YACASsErUABpnKAAoErBK1AAaZy90DgnJzhQADAQAAiXNlY3AyNTZrMaEDA-pNDWrTY5QLBKix1SDiSUwWiwypZ82F1DFGUbEupf6DdGNwgpnKg3VkcIKZzIV3YWt1MgA"}'
2025-02-16 04:03:11.540 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:03:11.541 DEBUG [tests.e2e.test_e2e] Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
2025-02-16 04:03:11.541 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62212/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:03:11.545 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:03:11.546 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57748/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:03:11.552 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:03:11.552 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62212/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:11.555 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.124.36/tcp/57749/p2p/16Uiu2HAmAaodYBGwkpoLifsmMrSmE4GcvAhFkWe9bYJSZUr2eUdQ","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
2025-02-16 04:03:11.556 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57748/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:11.558 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.84.21/tcp/62213/p2p/16Uiu2HAmBZu92x84FLGqypXuwxN5qVf5dRRhMSvtxWoB1eXb51t8","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
2025-02-16 04:03:11.559 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-16 04:03:41.559 DEBUG [tests.e2e.test_e2e] Node1 publish message with ephemeral = false
2025-02-16 04:03:41.560 DEBUG [src.steps.store] Relaying message
2025-02-16 04:03:41.560 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62212/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2025-02-16 04:03:41.566 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:03:41.567 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-16 04:03:41.767 DEBUG [src.libs.common] Sleeping for 3 seconds
2025-02-16 04:03:44.767 DEBUG [tests.e2e.test_e2e] Check if message is stored 
2025-02-16 04:03:44.768 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-16 04:03:44.768 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39369/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:03:44.815 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"8992b000ec49dc1b20d5","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xd5e1162765b17e126a1fb5f31389c59ca40111e1b5940ddcab533ec32674e363"}]}'
2025-02-16 04:03:44.822 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 04:03:44.823 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 04:03:44.823 DEBUG [src.node.waku_node] Stopping container with id bf1a5733294e
2025-02-16 04:03:45.746 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:03:45.747 DEBUG [src.node.waku_node] Stopping container with id 6da401971d71
2025-02-16 04:03:46.559 ERROR [src.node.docker_mananger] Max retries reached for container bf1a5733294e. Exiting log stream.
2025-02-16 04:03:47.223 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:03:47.224 DEBUG [src.node.waku_node] Stopping container with id 2054e2e2370f
2025-02-16 04:03:48.038 ERROR [src.node.docker_mananger] Max retries reached for container 6da401971d71. Exiting log stream.
2025-02-16 04:03:48.507 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:03:48.508 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 04:03:48.519 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:03:48.533 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:03:48.537 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
