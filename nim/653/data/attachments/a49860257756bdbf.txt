2025-02-16 04:05:48.088 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 04:05:48.088 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-16_04-05-48__9b932eec-f627-4acf-bf2c-2f283129bf2b
2025-02-16 04:05:48.089 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 04:05:48.089 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-16 04:05:48.089 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-16 04:05:48.095 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:05:48.095 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-16_04-05-48__9b932eec-f627-4acf-bf2c-2f283129bf2b__wakuorg_nwaku:latest.log
2025-02-16 04:05:48.096 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:05:48.096 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:05:48.097 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:05:48.097 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.242.2
2025-02-16 04:05:48.097 DEBUG [src.node.docker_mananger] Generated ports ['45325', '45326', '45327', '45328', '45329']
2025-02-16 04:05:48.098 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:05:48.098 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:05:48.098 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:05:48.098 DEBUG [src.node.docker_mananger] docker run -i -t -p 45325:45325 -p 45326:45326 -p 45327:45327 -p 45328:45328 -p 45329:45329 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45327 --rest-port=45325 --tcp-port=45326 --discv5-udp-port=45328 --rest-address=0.0.0.0 --nat=extip:172.18.242.2 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9bf9fcd8381af0aea9126338d9aa8b0d4efaec9ceecbbad3bedcc2be8ceb5c31 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45329 --metrics-logging=true --relay=true
2025-02-16 04:05:48.321 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.242.2 waku c3483d045c2862856317cb42aa52466110f9d522ac55de621cd4a405a62d8056
2025-02-16 04:05:48.372 DEBUG [src.node.docker_mananger] Container started with ID c3483d045c28. Setting up logs at ./log/docker/node1_2025-02-16_04-05-48__9b932eec-f627-4acf-bf2c-2f283129bf2b__wakuorg_nwaku:latest.log
2025-02-16 04:05:48.373 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 45325
2025-02-16 04:05:48.373 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:05:48.872 ERROR [src.node.docker_mananger] Max retries reached for container 1a518a5d0e5c. Exiting log stream.
2025-02-16 04:05:49.373 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45325/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:05:49.376 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:05:49.376 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:05:49.376 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45325/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:05:49.378 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.242.2/tcp/45326/p2p/16Uiu2HAm8Q4RLvNtHmmetUUUMn8sfq9pu23rWAbFZUBAJf29sBjs","/ip4/172.18.242.2/tcp/45327/ws/p2p/16Uiu2HAm8Q4RLvNtHmmetUUUMn8sfq9pu23rWAbFZUBAJf29sBjs"],"enrUri":"enr:-L24QM7pSzmYxRzQV_LH9oxhTqYxG34lFMm0tUcbIDjdNz8vencU9tD1A8ElL6DZ0zomFLSn7XtnwnLcMnsnmzCM1q4CgmlkgnY0gmlwhKwS8gKKbXVsdGlhZGRyc5YACASsEvICBrEOAAoErBLyAgaxD90DgnJzhQADAQAAiXNlY3AyNTZrMaECwL4kWvQmw3SLlc3jNbhAlahI-enaumWullKrZyTeoA6DdGNwgrEOg3VkcIKxEIV3YWt1MgE"}'
2025-02-16 04:05:49.378 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:05:49.384 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:05:49.385 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-16_04-05-48__9b932eec-f627-4acf-bf2c-2f283129bf2b__wakuorg_nwaku:latest.log
2025-02-16 04:05:49.385 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:05:49.385 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:05:49.386 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:05:49.386 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.82.88
2025-02-16 04:05:49.386 DEBUG [src.node.docker_mananger] Generated ports ['65219', '65220', '65221', '65222', '65223']
2025-02-16 04:05:49.386 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:05:49.386 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:05:49.387 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:05:49.387 DEBUG [src.node.docker_mananger] docker run -i -t -p 65219:65219 -p 65220:65220 -p 65221:65221 -p 65222:65222 -p 65223:65223 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65221 --rest-port=65219 --tcp-port=65220 --discv5-udp-port=65222 --rest-address=0.0.0.0 --nat=extip:172.18.82.88 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c01f0fa5a2e7d3cbcae6dbb6bab39eeea2b757fcd92a7ff59bccb78ffed0c2cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65223 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QM7pSzmYxRzQV_LH9oxhTqYxG34lFMm0tUcbIDjdNz8vencU9tD1A8ElL6DZ0zomFLSn7XtnwnLcMnsnmzCM1q4CgmlkgnY0gmlwhKwS8gKKbXVsdGlhZGRyc5YACASsEvICBrEOAAoErBLyAgaxD90DgnJzhQADAQAAiXNlY3AyNTZrMaECwL4kWvQmw3SLlc3jNbhAlahI-enaumWullKrZyTeoA6DdGNwgrEOg3VkcIKxEIV3YWt1MgE
2025-02-16 04:05:49.604 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.82.88 waku be5a8ea4580e8e99f78e50ca63aa4bd7c017a1c8da57fb9115b8f1bc93ec28f5
2025-02-16 04:05:49.650 DEBUG [src.node.docker_mananger] Container started with ID be5a8ea4580e. Setting up logs at ./log/docker/node2_2025-02-16_04-05-48__9b932eec-f627-4acf-bf2c-2f283129bf2b__wakuorg_nwaku:latest.log
2025-02-16 04:05:49.650 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 65219
2025-02-16 04:05:49.650 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:05:50.651 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65219/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:05:50.656 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:05:50.656 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:05:50.657 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65219/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:05:50.664 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.82.88/tcp/65220/p2p/16Uiu2HAm6TkQYuyhHG6EVAPaFUwxxkjrAjprvsbuvCNe556UMeDA","/ip4/172.18.82.88/tcp/65221/ws/p2p/16Uiu2HAm6TkQYuyhHG6EVAPaFUwxxkjrAjprvsbuvCNe556UMeDA"],"enrUri":"enr:-L24QOz8_dgtd1O5biPk6UZrBo7fD7u60SOWHUUIgAWfUA8TQG4sD9547dPlLoT4NF6IpX8GxDS0HAjqK9RP8oifiWwCgmlkgnY0gmlwhKwSUliKbXVsdGlhZGRyc5YACASsElJYBv7EAAoErBJSWAb-xd0DgnJzhQADAQAAiXNlY3AyNTZrMaECo_i5KBOkVSTCwiSAVgYIUxycu9VZzQa6Zlm2O7C8HuWDdGNwgv7Eg3VkcIL-xoV3YWt1MgE"}'
2025-02-16 04:05:50.666 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:05:50.666 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65219/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.242.2/tcp/45326/p2p/16Uiu2HAm8Q4RLvNtHmmetUUUMn8sfq9pu23rWAbFZUBAJf29sBjs"]'
2025-02-16 04:05:50.672 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:05:50.672 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-16 04:05:50.672 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:05:50.676 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:05:50.676 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:65219/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-16 04:05:50.682 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:05:50.684 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.689 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:05:50.690 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 04:05:50.790 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 04:05:50.791 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:05:50.793 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678750683881216,"ephemeral":false,"proof":""}]'
2025-02-16 04:05:50.795 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-16 04:05:50.795 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:65219/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:05:50.797 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739678750683881216,"ephemeral":false,"proof":""}]'
2025-02-16 04:05:50.799 INFO [src.steps.relay] WARM UP successful!!
2025-02-16 04:05:50.799 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-16 04:05:50.800 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.802 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:05:50.803 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-16 04:05:50.803 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.805 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:05:50.806 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-16 04:05:50.806 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.808 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:05:50.809 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-16 04:05:50.809 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.812 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:05:50.812 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-16 04:05:50.813 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.815 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:05:50.816 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-16 04:05:50.816 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.818 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:05:50.819 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-16 04:05:50.819 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:05:50.822 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:45325/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-16 04:05:50.824 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 04:05:50.825 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 04:05:50.825 DEBUG [src.node.waku_node] Stopping container with id c3483d045c28
2025-02-16 04:05:51.840 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:05:51.841 DEBUG [src.node.waku_node] Stopping container with id be5a8ea4580e
2025-02-16 04:05:52.652 ERROR [src.node.docker_mananger] Max retries reached for container c3483d045c28. Exiting log stream.
2025-02-16 04:05:53.324 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:05:53.325 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 04:05:53.331 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:05:53.337 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
