2025-02-16 04:07:33.165 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 04:07:33.165 DEBUG [tests.conftest] Running test: test_messages_with_timestamps_far_from_now with id: 2025-02-16_04-07-33__c398dbe8-989b-409b-8090-8a40976616db
2025-02-16 04:07:33.167 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 04:07:33.168 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-16 04:07:33.169 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-16 04:07:33.177 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:07:33.177 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-16_04-07-33__c398dbe8-989b-409b-8090-8a40976616db__wakuorg_nwaku:latest.log
2025-02-16 04:07:33.177 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:07:33.177 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:07:33.179 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:07:33.180 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.189.128
2025-02-16 04:07:33.180 DEBUG [src.node.docker_mananger] Generated ports ['52189', '52190', '52191', '52192', '52193']
2025-02-16 04:07:33.181 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:07:33.182 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:07:33.182 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:07:33.182 DEBUG [src.node.docker_mananger] docker run -i -t -p 52189:52189 -p 52190:52190 -p 52191:52191 -p 52192:52192 -p 52193:52193 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=52191 --rest-port=52189 --tcp-port=52190 --discv5-udp-port=52192 --rest-address=0.0.0.0 --nat=extip:172.18.189.128 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cfb99f4fc28516fde862b46817ac8ed342e81af5b64643e5c3ffe3c59ffe0a67 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=52193 --metrics-logging=true --store=true --relay=true
2025-02-16 04:07:33.515 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:07:33.516 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:07:33.517 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:07:33.517 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.187.72
2025-02-16 04:07:33.517 DEBUG [src.node.docker_mananger] Generated ports ['39782', '39783', '39784', '39785', '39786']
2025-02-16 04:07:33.518 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:07:33.518 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:07:33.518 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:07:33.518 DEBUG [src.node.docker_mananger] docker run -i -t -p 39782:39782 -p 39783:39783 -p 39784:39784 -p 39785:39785 -p 39786:39786 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39784 --rest-port=39782 --tcp-port=39783 --discv5-udp-port=39785 --rest-address=0.0.0.0 --nat=extip:172.18.187.72 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=06b1abfdb3cd7faf509e135bdd5dddd64ffca7eafe5a1cfcdf81b607b9a08cda --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39786 --metrics-logging=true --store=true --relay=true
2025-02-16 04:07:33.737 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.187.72 waku 4cd3bf16723997a57a988b672488ad5988777fb18f42c2425a35ff68510ecac7
2025-02-16 04:07:33.783 DEBUG [src.node.docker_mananger] Container started with ID 4cd3bf167239. Setting up logs at ./log/docker/publishing_node1_2025-02-16_04-07-33__c398dbe8-989b-409b-8090-8a40976616db__wakuorg_nwaku:latest.log
2025-02-16 04:07:33.784 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39782
2025-02-16 04:07:33.784 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:07:34.004 ERROR [src.node.docker_mananger] Max retries reached for container 8a0143523fe1. Exiting log stream.
2025-02-16 04:07:34.785 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39782/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:07:34.788 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:07:34.788 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:07:34.789 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39782/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:07:34.791 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.187.72/tcp/39783/p2p/16Uiu2HAkupxcqzjLGrHZUaNMVCRXPtqmE1ZmH43waKacb2aJA9mt","/ip4/172.18.187.72/tcp/39784/ws/p2p/16Uiu2HAkupxcqzjLGrHZUaNMVCRXPtqmE1ZmH43waKacb2aJA9mt"],"enrUri":"enr:-L24QHNufV7p4Coey6aGq5L5yZdPPIaZkbPTU1x9CA57mQkGWgStDi1hfc7FR6IwLZWkE-5fqUnV1CZOolMEcIvzXBgCgmlkgnY0gmlwhKwSu0iKbXVsdGlhZGRyc5YACASsErtIBptnAAoErBK7SAabaN0DgnJzhQADAQAAiXNlY3AyNTZrMaECBfcsFMXOTg3vEeXCSdI1PiS1EAYdtal_shiARct6PqODdGNwgptng3VkcIKbaYV3YWt1MgM"}'
2025-02-16 04:07:34.791 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:07:34.797 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 04:07:34.798 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-16_04-07-33__c398dbe8-989b-409b-8090-8a40976616db__wakuorg_nwaku:latest.log
2025-02-16 04:07:34.798 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 04:07:34.798 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 04:07:34.799 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 04:07:34.799 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.241.7
2025-02-16 04:07:34.799 DEBUG [src.node.docker_mananger] Generated ports ['16495', '16496', '16497', '16498', '16499']
2025-02-16 04:07:34.800 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 04:07:34.800 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 04:07:34.800 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 04:07:34.800 DEBUG [src.node.docker_mananger] docker run -i -t -p 16495:16495 -p 16496:16496 -p 16497:16497 -p 16498:16498 -p 16499:16499 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=16497 --rest-port=16495 --tcp-port=16496 --discv5-udp-port=16498 --rest-address=0.0.0.0 --nat=extip:172.18.241.7 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7fc8bb2639676f0abe754b0e1a1470eb7e0df140808a573feb7f7ed191fc0cc9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=16499 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHNufV7p4Coey6aGq5L5yZdPPIaZkbPTU1x9CA57mQkGWgStDi1hfc7FR6IwLZWkE-5fqUnV1CZOolMEcIvzXBgCgmlkgnY0gmlwhKwSu0iKbXVsdGlhZGRyc5YACASsErtIBptnAAoErBK7SAabaN0DgnJzhQADAQAAiXNlY3AyNTZrMaECBfcsFMXOTg3vEeXCSdI1PiS1EAYdtal_shiARct6PqODdGNwgptng3VkcIKbaYV3YWt1MgM --storenode=/ip4/172.18.187.72/tcp/39783/p2p/16Uiu2HAkupxcqzjLGrHZUaNMVCRXPtqmE1ZmH43waKacb2aJA9mt --store=true --relay=true
2025-02-16 04:07:35.031 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.241.7 waku df4a6b645b7e49bfb4c1d0b19d09912ddd6a26ce8d222dad1ec0f8a5b2bf6ae1
2025-02-16 04:07:35.080 DEBUG [src.node.docker_mananger] Container started with ID df4a6b645b7e. Setting up logs at ./log/docker/store_node1_2025-02-16_04-07-33__c398dbe8-989b-409b-8090-8a40976616db__wakuorg_nwaku:latest.log
2025-02-16 04:07:35.081 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 16495
2025-02-16 04:07:35.081 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 04:07:36.082 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16495/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:07:36.085 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 04:07:36.086 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 04:07:36.086 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:16495/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:07:36.088 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.7/tcp/16496/p2p/16Uiu2HAmTnMrLo5pcZdQNCNfCJDdpUhDS79zB3YRLixfgjNqYSQT","/ip4/172.18.241.7/tcp/16497/ws/p2p/16Uiu2HAmTnMrLo5pcZdQNCNfCJDdpUhDS79zB3YRLixfgjNqYSQT"],"enrUri":"enr:-L24QHsAgZpUzeO5AvAYQpA9Iibc0I0AGuP80LiHoElcCpxeRNsXm8zKFDgqjMzdON9rX2vFLVlwSfQq19xpUxohkDQCgmlkgnY0gmlwhKwS8QeKbXVsdGlhZGRyc5YACASsEvEHBkBwAAoErBLxBwZAcd0DgnJzhQADAQAAiXNlY3AyNTZrMaED4MKuQqV3krdakzj7lzLRk0norZavsO1deEBt-fU3acyDdGNwgkBwg3VkcIJAcoV3YWt1MgM"}'
2025-02-16 04:07:36.088 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 04:07:36.088 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16495/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.187.72/tcp/39783/p2p/16Uiu2HAkupxcqzjLGrHZUaNMVCRXPtqmE1ZmH43waKacb2aJA9mt"]'
2025-02-16 04:07:36.091 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:07:36.091 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39782/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 04:07:36.094 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:07:36.094 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:16495/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 04:07:36.096 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:07:36.097 DEBUG [tests.store.test_time_filter] Running test with payload 20 sec Past
2025-02-16 04:07:36.097 DEBUG [src.steps.store] Relaying message
2025-02-16 04:07:36.098 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39782/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:07:36.102 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:07:36.103 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-16 04:07:36.303 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-16 04:07:36.304 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39782/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:07:36.307 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-16 04:07:36.307 DEBUG [tests.store.test_time_filter] Running test with payload 40 sec Future
2025-02-16 04:07:36.307 DEBUG [src.steps.store] Relaying message
2025-02-16 04:07:36.308 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39782/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 04:07:36.312 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 04:07:36.312 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-16 04:07:36.513 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-16 04:07:36.514 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39782/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-16 04:07:36.517 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-16 04:07:36.519 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 04:07:36.520 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 04:07:36.520 DEBUG [src.node.waku_node] Stopping container with id 4cd3bf167239
2025-02-16 04:07:37.323 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:07:37.323 DEBUG [src.node.waku_node] Stopping container with id df4a6b645b7e
2025-02-16 04:07:38.135 ERROR [src.node.docker_mananger] Max retries reached for container 4cd3bf167239. Exiting log stream.
2025-02-16 04:07:38.833 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 04:07:38.834 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 04:07:38.839 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 04:07:38.845 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
