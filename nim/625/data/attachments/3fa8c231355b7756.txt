[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publish_with_invalid_version with id: 2025-01-23_04-03-59__8c702ec3-c58c-471b-8592-a4ed4c88cefe
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:34 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-23_04-03-59__8c702ec3-c58c-471b-8592-a4ed4c88cefe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.114.179
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['33216', '33217', '33218', '33219', '33220']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 33216:33216 -p 33217:33217 -p 33218:33218 -p 33219:33219 -p 33220:33220 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33218 --rest-port=33216 --tcp-port=33217 --discv5-udp-port=33219 --rest-address=0.0.0.0 --nat=extip:172.18.114.179 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a3af8edb06d73d4562742e4a9cb3096e7760da192f38fadfdb39db5fccea89d9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33220 --metrics-logging=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.114.179 waku 3ee6b1e5beabb12d42e279f86174b23caf52b2ef6f9fc8d8603f248f366d52a9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3ee6b1e5beab. Setting up logs at ./log/docker/node1_2025-01-23_04-03-59__8c702ec3-c58c-471b-8592-a4ed4c88cefe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 33216
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 96c320c7e7b2. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33216/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33216/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.114.179/tcp/33217/p2p/16Uiu2HAm1tRwzdZHpoH6VyUJAuWWPNbzpboBV7nAcn3Ub7eR6F7Z","/ip4/172.18.114.179/tcp/33218/ws/p2p/16Uiu2HAm1tRwzdZHpoH6VyUJAuWWPNbzpboBV7nAcn3Ub7eR6F7Z"],"enrUri":"enr:-L24QKOZTLehYBfB7-kWGC22sMOFhNc4sfErATVM-yEscpB_DeglbGbHmPKQL_bX7MMmk0sJc88aDDyolOd-p9IhM30CgmlkgnY0gmlwhKwScrOKbXVsdGlhZGRyc5YACASsEnKzBoHBAAoErBJyswaBwt0DgnJzhQADAQAAiXNlY3AyNTZrMaECYADwQDgXs8gI-JpBR4DG7HvANjb8WHhLdH0ScCEWi1yDdGNwgoHBg3VkcIKBw4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2025-01-23_04-03-59__8c702ec3-c58c-471b-8592-a4ed4c88cefe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.39.238
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['37468', '37469', '37470', '37471', '37472']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 37468:37468 -p 37469:37469 -p 37470:37470 -p 37471:37471 -p 37472:37472 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37470 --rest-port=37468 --tcp-port=37469 --discv5-udp-port=37471 --rest-address=0.0.0.0 --nat=extip:172.18.39.238 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=29461e8cffa43f1e7b5eeace554007fd7f5b9dde59fecfe080c1c0a9bec17522 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37472 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QKOZTLehYBfB7-kWGC22sMOFhNc4sfErATVM-yEscpB_DeglbGbHmPKQL_bX7MMmk0sJc88aDDyolOd-p9IhM30CgmlkgnY0gmlwhKwScrOKbXVsdGlhZGRyc5YACASsEnKzBoHBAAoErBJyswaBwt0DgnJzhQADAQAAiXNlY3AyNTZrMaECYADwQDgXs8gI-JpBR4DG7HvANjb8WHhLdH0ScCEWi1yDdGNwgoHBg3VkcIKBw4V3YWt1MgE
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.39.238 waku d360ac0b46de64bd97185f802db93483657c175f3378b604a19cdf2f1297b20c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d360ac0b46de. Setting up logs at ./log/docker/node2_2025-01-23_04-03-59__8c702ec3-c58c-471b-8592-a4ed4c88cefe__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 37468
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37468/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37468/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.238/tcp/37469/p2p/16Uiu2HAmC1J1PnpHG7oL3p5dkNYGCoB7ss2YG5DExz6wXNtkMgx4","/ip4/172.18.39.238/tcp/37470/ws/p2p/16Uiu2HAmC1J1PnpHG7oL3p5dkNYGCoB7ss2YG5DExz6wXNtkMgx4"],"enrUri":"enr:-L24QMleQMHKXql0l_ZLD18nxR4y-UaT4V9e75S-IaZWqfEnRFAw1VK6DNOzafF_fKxUwGDkoqvhBrm05FuByUeVRHYCgmlkgnY0gmlwhKwSJ-6KbXVsdGlhZGRyc5YACASsEifuBpJdAAoErBIn7gaSXt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC9lfk4EaG3LNIdfTKloNsdxkyWl1hrF6QOPLeCOrjuuWDdGNwgpJdg3VkcIKSX4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37468/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.114.179/tcp/33217/p2p/16Uiu2HAm1tRwzdZHpoH6VyUJAuWWPNbzpboBV7nAcn3Ub7eR6F7Z"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.relay:relay.py:59 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33216/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37468/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33216/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33216/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1737605042136281600,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.relay:relay.py:123 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37468/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1737605042136281600,"ephemeral":false}]'
[32mINFO    [0m src.steps.relay:relay.py:71 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33216/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 2.1}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:33216/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 3ee6b1e5beab
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d360ac0b46de
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3ee6b1e5beab. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.