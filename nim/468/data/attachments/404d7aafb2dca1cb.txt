[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-11-28_04-14-24__2a5202eb-0b8d-4378-98af-278999fb6326
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-28_04-14-24__2a5202eb-0b8d-4378-98af-278999fb6326__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.97.71
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['26973', '26974', '26975', '26976', '26977']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 26973:26973 -p 26974:26974 -p 26975:26975 -p 26976:26976 -p 26977:26977 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26975 --rest-port=26973 --tcp-port=26974 --discv5-udp-port=26976 --rest-address=0.0.0.0 --nat=extip:172.18.97.71 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4bae865fb6fc6be7cd97aa70b56b86c4fb69e68ff3edcebcabdc831fccfefb1d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26977 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.97.71 waku 0932e6ff25d36472d45fe54f3864072ae8691e75988817dfb5aa1f827fbd68e4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0932e6ff25d3. Setting up logs at ./log/docker/receiving_node1_2024-11-28_04-14-24__2a5202eb-0b8d-4378-98af-278999fb6326__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 26973
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 84f80559082d. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26973/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26973/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.71/tcp/26974/p2p/16Uiu2HAmKfMuZtMzeiErprSJf1sraZTMJ2pkffxKXNkTrFVxA89s","/ip4/172.18.97.71/tcp/26975/ws/p2p/16Uiu2HAmKfMuZtMzeiErprSJf1sraZTMJ2pkffxKXNkTrFVxA89s"],"enrUri":"enr:-L24QPoK3Ia5rDpApHWaiAocjX7ITipdCpr0EIUb2mKk6MbkAAfdV84NgdveUJlEsURpkBpC7Ub9SE8fUj5BO1YJbN4CgmlkgnY0gmlwhKwSYUeKbXVsdGlhZGRyc5YACASsEmFHBmleAAoErBJhRwZpX90DgnJzhQADAQAAiXNlY3AyNTZrMaEDaBouuUv11qMcy26uitezJ57DaLY6rOd_qR2YBo1G61aDdGNwgmleg3VkcIJpYIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-28_04-14-24__2a5202eb-0b8d-4378-98af-278999fb6326__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.90.196
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['17766', '17767', '17768', '17769', '17770']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 17766:17766 -p 17767:17767 -p 17768:17768 -p 17769:17769 -p 17770:17770 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17768 --rest-port=17766 --tcp-port=17767 --discv5-udp-port=17769 --rest-address=0.0.0.0 --nat=extip:172.18.90.196 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=51ef306d7edca20ffeed0c5bd9bf4ffbcf6fd7fcc15c3aefe36a4cdeabeb329c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17770 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.90.196 waku 49ffda44713f21c42cbbde578a06cbeb1edbac037347ae2a0c018840be9e4592
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 49ffda44713f. Setting up logs at ./log/docker/receiving_node2_2024-11-28_04-14-24__2a5202eb-0b8d-4378-98af-278999fb6326__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 17766
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17766/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17766/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.90.196/tcp/17767/p2p/16Uiu2HAmKB9c2aC1Uxtox4DteCYvjFuA5F6vaCB7U3sRS4HCPSy5","/ip4/172.18.90.196/tcp/17768/ws/p2p/16Uiu2HAmKB9c2aC1Uxtox4DteCYvjFuA5F6vaCB7U3sRS4HCPSy5"],"enrUri":"enr:-L24QLv1kDKqmGjEKkXXUw_0rP0jGkgYOxEvV9Wt1ZDpcAOVHhobmHx9HI8LEODpU86BQNsU6E99kOwCsPowf_yhQXMCgmlkgnY0gmlwhKwSWsSKbXVsdGlhZGRyc5YACASsElrEBkVnAAoErBJaxAZFaN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDYOACbT5lSuPidIOxA5fIsgPEMnK8jBlhUXN0QyU5A5iDdGNwgkVng3VkcIJFaYV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17766/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.97.71/tcp/26974/p2p/16Uiu2HAmKfMuZtMzeiErprSJf1sraZTMJ2pkffxKXNkTrFVxA89s"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-28_04-14-24__2a5202eb-0b8d-4378-98af-278999fb6326__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.180.91
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['55491', '55492', '55493', '55494', '55495']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 55491:55491 -p 55492:55492 -p 55493:55493 -p 55494:55494 -p 55495:55495 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55493 --rest-port=55491 --tcp-port=55492 --discv5-udp-port=55494 --rest-address=0.0.0.0 --nat=extip:172.18.180.91 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ba7db0cfe1b6f9fbad2f1ca31cfd5eaf4ea6ae9e88bc1ae86adbd9263711ffc0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55495 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QPoK3Ia5rDpApHWaiAocjX7ITipdCpr0EIUb2mKk6MbkAAfdV84NgdveUJlEsURpkBpC7Ub9SE8fUj5BO1YJbN4CgmlkgnY0gmlwhKwSYUeKbXVsdGlhZGRyc5YACASsEmFHBmleAAoErBJhRwZpX90DgnJzhQADAQAAiXNlY3AyNTZrMaEDaBouuUv11qMcy26uitezJ57DaLY6rOd_qR2YBo1G61aDdGNwgmleg3VkcIJpYIV3YWt1Mgk --lightpushnode=/ip4/172.18.97.71/tcp/26974/p2p/16Uiu2HAmKfMuZtMzeiErprSJf1sraZTMJ2pkffxKXNkTrFVxA89s --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.180.91 waku c78dbe3415a1b47e4f84f72b9deefe58c5f7741b92594957a9bffe2869b6131b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c78dbe3415a1. Setting up logs at ./log/docker/lightpush_node1_2024-11-28_04-14-24__2a5202eb-0b8d-4378-98af-278999fb6326__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 55491
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55491/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:55491/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.180.91/tcp/55492/p2p/16Uiu2HAmB5xHgTnaKGbQVTarHgi29QfTXsmSzft4gdPvAZZdZUVg","/ip4/172.18.180.91/tcp/55493/ws/p2p/16Uiu2HAmB5xHgTnaKGbQVTarHgi29QfTXsmSzft4gdPvAZZdZUVg"],"enrUri":"enr:-L24QMv98DWlUqPyTxmuHvRHQUaNOmiMWy4ogiQ-ugQ5sqZ3BNdZof0YWvTllBeDPsHtTtyVuf4qFg2USKzE4M9Kl8cCgmlkgnY0gmlwhKwStFuKbXVsdGlhZGRyc5YACASsErRbBtjEAAoErBK0WwbYxd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6K3Qiq3i6c27aH_3m7In15QLoUiqrfDP5gDVBfLDiAuDdGNwgtjEg3VkcILYxoV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.97.71/tcp/26974/p2p/16Uiu2HAmKfMuZtMzeiErprSJf1sraZTMJ2pkffxKXNkTrFVxA89s"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.90.196/tcp/17767/p2p/16Uiu2HAmKB9c2aC1Uxtox4DteCYvjFuA5F6vaCB7U3sRS4HCPSy5"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26973/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17766/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732767269591304704}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55491/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732767269598588928}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55491/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732767269609518848}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55491/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732767269613823488}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55491/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732767269621398016}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55491/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:55491/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732767269626459648}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55491/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 0932e6ff25d3
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 49ffda44713f
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 0932e6ff25d3. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id c78dbe3415a1
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 49ffda44713f. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.