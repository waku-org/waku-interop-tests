[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_metrics_after_light_push with id: 2024-09-30_04-21-41__c325ea34-bb05-4a40-9754-04b363a7f575
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-30_04-21-41__c325ea34-bb05-4a40-9754-04b363a7f575__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.171.72
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['6168', '6169', '6170', '6171', '6172']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 6168:6168 -p 6169:6169 -p 6170:6170 -p 6171:6171 -p 6172:6172 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6170 --rest-port=6168 --tcp-port=6169 --discv5-udp-port=6171 --rest-address=0.0.0.0 --nat=extip:172.18.171.72 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=29b83e6efafa59fd7d5dea75bcaefe455b5ede2d65eaa19319edddc2a47dd257 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6172 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.171.72 waku 1ab21b51e71bb7bc022531ab5b19e9a0383d9fb04a4fd91db20c08118b2da3ba
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 1ab21b51e71b. Setting up logs at ./log/docker/receiving_node1_2024-09-30_04-21-41__c325ea34-bb05-4a40-9754-04b363a7f575__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 6168
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6168/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6168/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.171.72/tcp/6169/p2p/16Uiu2HAmUt3SYN5rpHCu7UtmAYUNZegekk3Y1kyGD3KCVC69DEQy","/ip4/172.18.171.72/tcp/6170/ws/p2p/16Uiu2HAmUt3SYN5rpHCu7UtmAYUNZegekk3Y1kyGD3KCVC69DEQy"],"enrUri":"enr:-LO4QKsf87XFTHYJoaGY85SGaGiZFdWcSPirt7U5Pi34vYaxMxPSCM7UiVe9ldv-me8fWxhlnNGHq0OPn1G7e77gDB4BgmlkgnY0gmlwhKwSq0iKbXVsdGlhZGRyc4wACgSsEqtIBhga3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPxEwksQcRSp4YfZvCannQ8SLc8_udBiuMPywqs_keAgoN0Y3CCGBmDdWRwghgbhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-30_04-21-41__c325ea34-bb05-4a40-9754-04b363a7f575__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.91.71
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['49071', '49072', '49073', '49074', '49075']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 49071:49071 -p 49072:49072 -p 49073:49073 -p 49074:49074 -p 49075:49075 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49073 --rest-port=49071 --tcp-port=49072 --discv5-udp-port=49074 --rest-address=0.0.0.0 --nat=extip:172.18.91.71 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a1ee0f1c5f886d6ff8fc22560c47ef0b9b4faafb9e35fc8a5a5cb07fe62dc0fc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49075 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.91.71 waku f8c0d62a2dbd0a414707d38b36a58d9604e569e386b91f358e6ccb5df4e74b11
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID f8c0d62a2dbd. Setting up logs at ./log/docker/receiving_node2_2024-09-30_04-21-41__c325ea34-bb05-4a40-9754-04b363a7f575__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 49071
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49071/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49071/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.91.71/tcp/49072/p2p/16Uiu2HAm2rGb9v4ggSgJPhuCUWH3AfmN7n7fZbozaAJ6NGv5Hi7t","/ip4/172.18.91.71/tcp/49073/ws/p2p/16Uiu2HAm2rGb9v4ggSgJPhuCUWH3AfmN7n7fZbozaAJ6NGv5Hi7t"],"enrUri":"enr:-LO4QBtvjvlfzEvMhB79iCAUJd1kFbwLr7LwzdIn5k6hLBWVfx6S3gC9IxcXwJ8ooMlBo_ZK68x88AX54xIBOHmDrd0BgmlkgnY0gmlwhKwSW0eKbXVsdGlhZGRyc4wACgSsEltHBr-x3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJuTuGVQW4GirmMcf6hsbO5P-R79ynY8IRL-yAKbB7Cc4N0Y3CCv7CDdWRwgr-yhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49071/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.171.72/tcp/6169/p2p/16Uiu2HAmUt3SYN5rpHCu7UtmAYUNZegekk3Y1kyGD3KCVC69DEQy"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-30_04-21-41__c325ea34-bb05-4a40-9754-04b363a7f575__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.212.83
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['1381', '1382', '1383', '1384', '1385']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 1381:1381 -p 1382:1382 -p 1383:1383 -p 1384:1384 -p 1385:1385 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1383 --rest-port=1381 --tcp-port=1382 --discv5-udp-port=1384 --rest-address=0.0.0.0 --nat=extip:172.18.212.83 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e39160eb499ddef5606c77d8aabce7de9db729ac1fab132ba65d6d5fb2077cac --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1385 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QKsf87XFTHYJoaGY85SGaGiZFdWcSPirt7U5Pi34vYaxMxPSCM7UiVe9ldv-me8fWxhlnNGHq0OPn1G7e77gDB4BgmlkgnY0gmlwhKwSq0iKbXVsdGlhZGRyc4wACgSsEqtIBhga3QOCcnOFAAMBAACJc2VjcDI1NmsxoQPxEwksQcRSp4YfZvCannQ8SLc8_udBiuMPywqs_keAgoN0Y3CCGBmDdWRwghgbhXdha3UyCQ --lightpushnode=/ip4/172.18.171.72/tcp/6169/p2p/16Uiu2HAmUt3SYN5rpHCu7UtmAYUNZegekk3Y1kyGD3KCVC69DEQy --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.212.83 waku 7369ab45eeb0e2cfa45314841e8b5f8065da4c38c0fbbc6290a1ea9aa5e0b627
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 7369ab45eeb0. Setting up logs at ./log/docker/lightpush_node1_2024-09-30_04-21-41__c325ea34-bb05-4a40-9754-04b363a7f575__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 1381
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1381/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1381/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.212.83/tcp/1382/p2p/16Uiu2HAm4KoYBbpTLB2Qk3fpiemn7o8H9UAjpv6z1AFM2y1cEBps","/ip4/172.18.212.83/tcp/1383/ws/p2p/16Uiu2HAm4KoYBbpTLB2Qk3fpiemn7o8H9UAjpv6z1AFM2y1cEBps"],"enrUri":"enr:-LO4QLDCRSbQJyBrog_rRS_j0N1p4tuo4ye93-95i8WboADuP2iaWUwcm0e7hxE1Wnf3SANmCVNyDqDhj96Zalibb4kBgmlkgnY0gmlwhKwS1FOKbXVsdGlhZGRyc4wACgSsEtRTBgVn3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKEOD5s3cmeXiOqkm0lR1C8kPwxulDdi9_x2SzvNK9n-IN0Y3CCBWaDdWRwggVohXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1381/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.171.72/tcp/6169/p2p/16Uiu2HAmUt3SYN5rpHCu7UtmAYUNZegekk3Y1kyGD3KCVC69DEQy"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1381/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.91.71/tcp/49072/p2p/16Uiu2HAm2rGb9v4ggSgJPhuCUWH3AfmN7n7fZbozaAJ6NGv5Hi7t"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6168/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49071/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1381/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1727670106225825280}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.5 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6168/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1727670106225825280,"ephemeral":false}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 5 seconds
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.171.72/tcp/6169"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.171.72/tcp/6169"} with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_peers has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_peers with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_topics has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_topics with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: libp2p_pubsub_subscriptions_total has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: libp2p_pubsub_subscriptions_total with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_peer_store_size has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_peer_store_size with value 2.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_histogram_message_size_count has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_histogram_message_size_count with value 1.0
[35mDEBUG   [0m src.steps.metrics:metrics.py:15 Checking metric: waku_node_messages_total{type="relay"} has 1
[35mDEBUG   [0m src.steps.metrics:metrics.py:27 Found metric: waku_node_messages_total{type="relay"} with value 1.0
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1ab21b51e71b
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id f8c0d62a2dbd
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 7369ab45eeb0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.