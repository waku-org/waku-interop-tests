[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-08-21_04-21-52__5c7257d0-8d7e-42d4-a8b2-1d9f39e2fb5e
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-21_04-21-52__5c7257d0-8d7e-42d4-a8b2-1d9f39e2fb5e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.39.3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['4535', '4536', '4537', '4538', '4539']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 4535:4535 -p 4536:4536 -p 4537:4537 -p 4538:4538 -p 4539:4539 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4537 --rest-port=4535 --tcp-port=4536 --discv5-udp-port=4538 --rest-address=0.0.0.0 --nat=extip:172.18.39.3 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d67eaadffe61cff053bedc811c5bbbccf1962eec9ab5cbbaaedefe2e18a98bff --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4539 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.39.3 waku a45a82d5eb506ec40d9770957de6c3a369aaa9fd8139775ae006cde131016304
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a45a82d5eb50. Setting up logs at ./log/docker/receiving_node1_2024-08-21_04-21-52__5c7257d0-8d7e-42d4-a8b2-1d9f39e2fb5e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 4535
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4535/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4535/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.3/tcp/4536/p2p/16Uiu2HAm6ZSCeN4bo7ZzteBs2uaAzeEtrLjzfveZHU3gYvjx81uh","/ip4/172.18.39.3/tcp/4537/ws/p2p/16Uiu2HAm6ZSCeN4bo7ZzteBs2uaAzeEtrLjzfveZHU3gYvjx81uh"],"enrUri":"enr:-LO4QChiSJY_N2k3pDwo_3EXxDykxi9yo6FIqaXEUbCbtzwvEuhFbPZ53QZKXXns-z7mspRo_MQesJe22eGZIc1ag0QBgmlkgnY0gmlwhKwSJwOKbXVsdGlhZGRyc4wACgSsEicDBhG53QOCcnOFAAMBAACJc2VjcDI1NmsxoQKlbZ-T5JzbphFXTHmPZ60SMiaIRRi4nxx5DYLYe-kVeIN0Y3CCEbiDdWRwghG6hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-08-21_04-21-52__5c7257d0-8d7e-42d4-a8b2-1d9f39e2fb5e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.148.167
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['14999', '15000', '15001', '15002', '15003']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 14999:14999 -p 15000:15000 -p 15001:15001 -p 15002:15002 -p 15003:15003 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15001 --rest-port=14999 --tcp-port=15000 --discv5-udp-port=15002 --rest-address=0.0.0.0 --nat=extip:172.18.148.167 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=16bacdcd7b5f2ad0cb6b8d4fdba95a0bfefdc76b76d78e73f7d9ffaea60ed00c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15003 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.148.167 waku d57aa2ba574d153379236286f1db223cb8cdb8938ded34011c80687fb48417af
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID d57aa2ba574d. Setting up logs at ./log/docker/receiving_node2_2024-08-21_04-21-52__5c7257d0-8d7e-42d4-a8b2-1d9f39e2fb5e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 14999
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14999/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14999/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.148.167/tcp/15000/p2p/16Uiu2HAm5N89aRxxtUAFp6PEUdQ1wKqZfaf4y3mgG1bcKeUkiCwE","/ip4/172.18.148.167/tcp/15001/ws/p2p/16Uiu2HAm5N89aRxxtUAFp6PEUdQ1wKqZfaf4y3mgG1bcKeUkiCwE"],"enrUri":"enr:-LO4QCKyOriT3MpjhTzy5K5h8cbmO0VNv9hcDamBrsqnvkwicIjwBuWGu9Qh2x0pFepTG4R5OalQvyWyZE1tc-SrCXkBgmlkgnY0gmlwhKwSlKeKbXVsdGlhZGRyc4wACgSsEpSnBjqZ3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKTrCKS0nijUzf-d7y2zcwFsNJeykrPx9oHM3YF_3_qDYN0Y3CCOpiDdWRwgjqahXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14999/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.3/tcp/4536/p2p/16Uiu2HAm6ZSCeN4bo7ZzteBs2uaAzeEtrLjzfveZHU3gYvjx81uh"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-21_04-21-52__5c7257d0-8d7e-42d4-a8b2-1d9f39e2fb5e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.138.121
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['57033', '57034', '57035', '57036', '57037']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 57033:57033 -p 57034:57034 -p 57035:57035 -p 57036:57036 -p 57037:57037 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57035 --rest-port=57033 --tcp-port=57034 --discv5-udp-port=57036 --rest-address=0.0.0.0 --nat=extip:172.18.138.121 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5dba556e609fc0f1e5eb4ed0fe5cfffabbffd5d57deb8b3c61fbe36cccae3a7e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57037 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QChiSJY_N2k3pDwo_3EXxDykxi9yo6FIqaXEUbCbtzwvEuhFbPZ53QZKXXns-z7mspRo_MQesJe22eGZIc1ag0QBgmlkgnY0gmlwhKwSJwOKbXVsdGlhZGRyc4wACgSsEicDBhG53QOCcnOFAAMBAACJc2VjcDI1NmsxoQKlbZ-T5JzbphFXTHmPZ60SMiaIRRi4nxx5DYLYe-kVeIN0Y3CCEbiDdWRwghG6hXdha3UyCQ --lightpushnode=/ip4/172.18.39.3/tcp/4536/p2p/16Uiu2HAm6ZSCeN4bo7ZzteBs2uaAzeEtrLjzfveZHU3gYvjx81uh --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.138.121 waku 0d0cc504b76e54811b3a22a253ad69d9ad12e30ef39fc772cec6691472e22abd
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 0d0cc504b76e. Setting up logs at ./log/docker/lightpush_node1_2024-08-21_04-21-52__5c7257d0-8d7e-42d4-a8b2-1d9f39e2fb5e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 57033
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57033/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57033/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.138.121/tcp/57034/p2p/16Uiu2HAkyrTRWGAw1yaX5TpekHhGdbph5AxxSDsqMLUBWvUPyxP4","/ip4/172.18.138.121/tcp/57035/ws/p2p/16Uiu2HAkyrTRWGAw1yaX5TpekHhGdbph5AxxSDsqMLUBWvUPyxP4"],"enrUri":"enr:-LO4QIQHnW3acCbT2QMb9acxz1D8YcpyH-wlLprXXvIGqgAeIWV_ooxTdZDIZ31St0kgEKduE4l3E0D6nnCLIN2wQ5MBgmlkgnY0gmlwhKwSinmKbXVsdGlhZGRyc4wACgSsEop5Bt7L3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJByBHtxL-1JKsDXyQdvkP2N5NSR4pP1mhPScUMBO6He4N0Y3CC3sqDdWRwgt7MhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57033/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.3/tcp/4536/p2p/16Uiu2HAm6ZSCeN4bo7ZzteBs2uaAzeEtrLjzfveZHU3gYvjx81uh"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57033/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.148.167/tcp/15000/p2p/16Uiu2HAm5N89aRxxtUAFp6PEUdQ1wKqZfaf4y3mgG1bcKeUkiCwE"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4535/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14999/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57033/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724214118957419520, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4535/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724214118957419520,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14999/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724214118957419520,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57033/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724214119089862144, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4535/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724214119089862144,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14999/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724214119089862144,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id a45a82d5eb50
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id d57aa2ba574d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 0d0cc504b76e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.