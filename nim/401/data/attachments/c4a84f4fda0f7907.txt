[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_works_with_auto_sharding with id: 2024-10-23_08-15-46__cfa416b0-0c44-4213-9139-162427a5693d
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-23_08-15-46__cfa416b0-0c44-4213-9139-162427a5693d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.94.207
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['11352', '11353', '11354', '11355', '11356']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 11352:11352 -p 11353:11353 -p 11354:11354 -p 11355:11355 -p 11356:11356 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11354 --rest-port=11352 --tcp-port=11353 --discv5-udp-port=11355 --rest-address=0.0.0.0 --nat=extip:172.18.94.207 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=d10cc45414d91463a2a917f53eeeeb1a3afdf7e5a8efafd17bd1d65321e85ede --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11356 --metrics-logging=true --relay=true --filter=true --content-topic=/myapp/1/latest/proto --pubsub-topic=/waku/2/rs/2/0 --num-shards-in-network=1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.94.207 waku c82703bded76790fb3b8d6c88944f926fcdbbce159c81f60fa67de80902e7177
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c82703bded76. Setting up logs at ./log/docker/node1_2024-10-23_08-15-46__cfa416b0-0c44-4213-9139-162427a5693d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 11352
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11352/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11352/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.94.207/tcp/11353/p2p/16Uiu2HAmUvFnf3YdwK6V64cz8wkzz2YTbug5GSEN4zTkxqV6rXkh","/ip4/172.18.94.207/tcp/11354/ws/p2p/16Uiu2HAmUvFnf3YdwK6V64cz8wkzz2YTbug5GSEN4zTkxqV6rXkh"],"enrUri":"enr:-LO4QOsIVqVGkt-lVG5a_Qccm-VfFcsuQl079z6_e2lyEii7bU1oncTLnInIRlk0GD1EH676ZVLuxu90L3T82tG9h7QBgmlkgnY0gmlwhKwSXs-KbXVsdGlhZGRyc4wACgSsEl7PBixa3QOCcnOFAAIBAACJc2VjcDI1NmsxoQPxpCh1DsC1mEj7NFF1NSUAdfaBbXyu2bJJSbk31GwdFoN0Y3CCLFmDdWRwgixbhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-23_08-15-46__cfa416b0-0c44-4213-9139-162427a5693d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.126.149
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['39900', '39901', '39902', '39903', '39904']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 39900:39900 -p 39901:39901 -p 39902:39902 -p 39903:39903 -p 39904:39904 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39902 --rest-port=39900 --tcp-port=39901 --discv5-udp-port=39903 --rest-address=0.0.0.0 --nat=extip:172.18.126.149 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=c3a661cac2b2cbdcddff835dc9e0da2d9a1d899cacdec1d05b0cc9efa261fab8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39904 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QOsIVqVGkt-lVG5a_Qccm-VfFcsuQl079z6_e2lyEii7bU1oncTLnInIRlk0GD1EH676ZVLuxu90L3T82tG9h7QBgmlkgnY0gmlwhKwSXs-KbXVsdGlhZGRyc4wACgSsEl7PBixa3QOCcnOFAAIBAACJc2VjcDI1NmsxoQPxpCh1DsC1mEj7NFF1NSUAdfaBbXyu2bJJSbk31GwdFoN0Y3CCLFmDdWRwgixbhXdha3UyBQ --filternode=/ip4/172.18.94.207/tcp/11353/p2p/16Uiu2HAmUvFnf3YdwK6V64cz8wkzz2YTbug5GSEN4zTkxqV6rXkh --content-topic=/myapp/1/latest/proto --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.126.149 waku 46f71a0db3c2cca29cf7aea55cef586301ee8ef3a63223b55f9b147f484c1a75
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 46f71a0db3c2. Setting up logs at ./log/docker/node2_2024-10-23_08-15-46__cfa416b0-0c44-4213-9139-162427a5693d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 39900
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39900/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39900/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.126.149/tcp/39901/p2p/16Uiu2HAm7NVzLRYRnFti1J5s6oZcSey7fTuJgUNBZmbEQtU7Fv4e","/ip4/172.18.126.149/tcp/39902/ws/p2p/16Uiu2HAm7NVzLRYRnFti1J5s6oZcSey7fTuJgUNBZmbEQtU7Fv4e"],"enrUri":"enr:-LO4QJQlaDkbB_1akSiXtBDAKFMBZ47_VfnWN0czC-V1Zjs3FQbIi1bHiQyA5sTtaQIbadhV9JAUXbR7WJluSt5Ql3QBgmlkgnY0gmlwhKwSfpWKbXVsdGlhZGRyc4wACgSsEn6VBpve3QOCcnOFAAIBAACJc2VjcDI1NmsxoQKxfDRH8Jppz-rNdsDj76VvvPDRoVLvZizQb1S5EROe94N0Y3CCm92DdWRwgpvfhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39900/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.94.207/tcp/11353/p2p/16Uiu2HAmUvFnf3YdwK6V64cz8wkzz2YTbug5GSEN4zTkxqV6rXkh"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11352/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/myapp/1/latest/proto"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39900/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "5f38b92d-11cf-4b2e-abcd-1ee945ae1452", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"5f38b92d-11cf-4b2e-abcd-1ee945ae1452","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11352/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:186 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39900/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729671350441303040,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c82703bded76
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 46f71a0db3c2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.