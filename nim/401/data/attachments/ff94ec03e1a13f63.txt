[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_subscribe_refresh with id: 2024-10-23_08-05-25__15576478-f689-413d-986b-21cb3934bb55
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-23_08-05-25__15576478-f689-413d-986b-21cb3934bb55__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.194.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['10397', '10398', '10399', '10400', '10401']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 10397:10397 -p 10398:10398 -p 10399:10399 -p 10400:10400 -p 10401:10401 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10399 --rest-port=10397 --tcp-port=10398 --discv5-udp-port=10400 --rest-address=0.0.0.0 --nat=extip:172.18.194.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ba3edeeee5f3fd9bab2210ea0988af1fc2fef6480bfa24a14d9ecacca6c34bec --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10401 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.194.183 waku c6edf72ad657d29d73c51a91a67c951972237063cb82f41e72151cf0016349a5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c6edf72ad657. Setting up logs at ./log/docker/node1_2024-10-23_08-05-25__15576478-f689-413d-986b-21cb3934bb55__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 10397
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10397/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:10397/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.194.183/tcp/10398/p2p/16Uiu2HAm5h8KUPGFaiekx9ca7BJGaRfMrK5omj9zZEj9yG7xjGtv","/ip4/172.18.194.183/tcp/10399/ws/p2p/16Uiu2HAm5h8KUPGFaiekx9ca7BJGaRfMrK5omj9zZEj9yG7xjGtv"],"enrUri":"enr:-LO4QD2MTdbetbZlgZhve5CDBeBGZhBB3N8sdbO8VwMTt5oOIImSwZZvBlintGkqjwWHHFhZoYq4TaqXUXQXflba6zYBgmlkgnY0gmlwhKwSwreKbXVsdGlhZGRyc4wACgSsEsK3Biif3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKYil0D94jNFhXo2GlJPS0n-gfMfmAaLdfW9__vHPdFX4N0Y3CCKJ6DdWRwgiighXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-23_08-05-25__15576478-f689-413d-986b-21cb3934bb55__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.64.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['59733', '59734', '59735', '59736', '59737']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 59733:59733 -p 59734:59734 -p 59735:59735 -p 59736:59736 -p 59737:59737 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59735 --rest-port=59733 --tcp-port=59734 --discv5-udp-port=59736 --rest-address=0.0.0.0 --nat=extip:172.18.64.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7bcbdba4dccc31bcf2def4dfd48eba7e8d0cf9fd2cedca01f18c5eb93dba7b0b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59737 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QD2MTdbetbZlgZhve5CDBeBGZhBB3N8sdbO8VwMTt5oOIImSwZZvBlintGkqjwWHHFhZoYq4TaqXUXQXflba6zYBgmlkgnY0gmlwhKwSwreKbXVsdGlhZGRyc4wACgSsEsK3Biif3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKYil0D94jNFhXo2GlJPS0n-gfMfmAaLdfW9__vHPdFX4N0Y3CCKJ6DdWRwgiighXdha3UyBQ --filternode=/ip4/172.18.194.183/tcp/10398/p2p/16Uiu2HAm5h8KUPGFaiekx9ca7BJGaRfMrK5omj9zZEj9yG7xjGtv
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.64.183 waku 9e62053b51a2a8dbb550cf49755fe66a3e95d2ef56de883f77e76d43a17a226f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9e62053b51a2. Setting up logs at ./log/docker/node2_2024-10-23_08-05-25__15576478-f689-413d-986b-21cb3934bb55__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 59733
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59733/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59733/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.64.183/tcp/59734/p2p/16Uiu2HAmEvm9HwHwRDcsPUUvmBmL5YhprmfwRomb5SfxRfs8B4u7","/ip4/172.18.64.183/tcp/59735/ws/p2p/16Uiu2HAmEvm9HwHwRDcsPUUvmBmL5YhprmfwRomb5SfxRfs8B4u7"],"enrUri":"enr:-LO4QAYhkpyOmzpGL3wEBf6itwZQ7Wqfrocmoce0HM9Gt-qHA4OkeYB2Gc7hizsVYLC2HF815u3sW4tc16T0PrlbEGQBgmlkgnY0gmlwhKwSQLeKbXVsdGlhZGRyc4wACgSsEkC3BulX3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMhwbvYVPUQzlecxgEvmOPufV_6gkBldQns-M2LIHRN-oN0Y3CC6VaDdWRwgulYhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59733/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.194.183/tcp/10398/p2p/16Uiu2HAm5h8KUPGFaiekx9ca7BJGaRfMrK5omj9zZEj9yG7xjGtv"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10397/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59733/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "651f2c7d-de79-4861-b8b6-c8856cebd1ed", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"651f2c7d-de79-4861-b8b6-c8856cebd1ed","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10397/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59733/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1729670730316957696,"ephemeral":false}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10397/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59733/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "a6d0b107-87d3-4a33-ac16-e0640922fb21", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"a6d0b107-87d3-4a33-ac16-e0640922fb21","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:10397/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59733/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1729670730445532928,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c6edf72ad657
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9e62053b51a2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.