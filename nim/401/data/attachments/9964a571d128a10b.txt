[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_works_with_static_sharding with id: 2024-10-23_08-15-42__86f09f28-7a61-4f38-a639-85501e652a24
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-23_08-15-42__86f09f28-7a61-4f38-a639-85501e652a24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.88.237
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['33262', '33263', '33264', '33265', '33266']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 33262:33262 -p 33263:33263 -p 33264:33264 -p 33265:33265 -p 33266:33266 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33264 --rest-port=33262 --tcp-port=33263 --discv5-udp-port=33265 --rest-address=0.0.0.0 --nat=extip:172.18.88.237 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=40c2a3a7c77f8adc3abcef8faba2ded4dc237faeb37eadbf234da38d50d851fe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33266 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.88.237 waku ba241af368f55d498fe1ccbaf87f7ea1fe01f1d0e30292a910619219d0ea6760
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID ba241af368f5. Setting up logs at ./log/docker/node1_2024-10-23_08-15-42__86f09f28-7a61-4f38-a639-85501e652a24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 33262
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33262/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33262/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.88.237/tcp/33263/p2p/16Uiu2HAmVFvou1i87c5Bm6mb3t6bTtuFYuJjoGRzZDhHfVt6GVWr","/ip4/172.18.88.237/tcp/33264/ws/p2p/16Uiu2HAmVFvou1i87c5Bm6mb3t6bTtuFYuJjoGRzZDhHfVt6GVWr"],"enrUri":"enr:-LO4QCXB2OTN8Bm006n_NZwG4tGA6o1KW2kw1EUMkpeYTXShScXkJbTpDLquuiIVgUKhmqgQio4ah3Ok-c4v6GXI7McBgmlkgnY0gmlwhKwSWO2KbXVsdGlhZGRyc4wACgSsEljtBoHw3QOCcnOFAAIBAACJc2VjcDI1NmsxoQP2rlCmZqu0fle-wPh1kDBNNn583lqHO6RCyAgP0P7NO4N0Y3CCge-DdWRwgoHxhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-23_08-15-42__86f09f28-7a61-4f38-a639-85501e652a24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.241.222
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['6364', '6365', '6366', '6367', '6368']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 6364:6364 -p 6365:6365 -p 6366:6366 -p 6367:6367 -p 6368:6368 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=6366 --rest-port=6364 --tcp-port=6365 --discv5-udp-port=6367 --rest-address=0.0.0.0 --nat=extip:172.18.241.222 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=c54dba10192a427bddeca7e9e1efe82fcccc50bcd47b02120a265ed4f87a611f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=6368 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QCXB2OTN8Bm006n_NZwG4tGA6o1KW2kw1EUMkpeYTXShScXkJbTpDLquuiIVgUKhmqgQio4ah3Ok-c4v6GXI7McBgmlkgnY0gmlwhKwSWO2KbXVsdGlhZGRyc4wACgSsEljtBoHw3QOCcnOFAAIBAACJc2VjcDI1NmsxoQP2rlCmZqu0fle-wPh1kDBNNn583lqHO6RCyAgP0P7NO4N0Y3CCge-DdWRwgoHxhXdha3UyBQ --filternode=/ip4/172.18.88.237/tcp/33263/p2p/16Uiu2HAmVFvou1i87c5Bm6mb3t6bTtuFYuJjoGRzZDhHfVt6GVWr --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.241.222 waku 9d50611896291c6981110b18a44a7f06beb5a9564963d99e05c30f2aa12dfbd4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9d5061189629. Setting up logs at ./log/docker/node2_2024-10-23_08-15-42__86f09f28-7a61-4f38-a639-85501e652a24__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 6364
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6364/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6364/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.241.222/tcp/6365/p2p/16Uiu2HAmFyUg71yKRBhrRfmbcDqbuRpTWsjZ8p4DwMkNsLrutSz6","/ip4/172.18.241.222/tcp/6366/ws/p2p/16Uiu2HAmFyUg71yKRBhrRfmbcDqbuRpTWsjZ8p4DwMkNsLrutSz6"],"enrUri":"enr:-LO4QBSVAKPDopZn9Yg9SVc1k5eK1lj6casMK4U_wqm99COKQvBgN1TM0ZWNwVLfB4AlGfUSX9OOClA8Po2ZQvm7AqABgmlkgnY0gmlwhKwS8d6KbXVsdGlhZGRyc4wACgSsEvHeBhje3QOCcnOFAAIBAACJc2VjcDI1NmsxoQMxT4q1l_sY2SBjRXlih9hIhdZ9VnuAa3mfN7Dq1N-NC4N0Y3CCGN2DdWRwghjfhXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6364/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.88.237/tcp/33263/p2p/16Uiu2HAmVFvou1i87c5Bm6mb3t6bTtuFYuJjoGRzZDhHfVt6GVWr"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33262/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:6364/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "8ea42398-ae75-4bc3-ace4-5e442258c4c6", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"8ea42398-ae75-4bc3-ace4-5e442258c4c6","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33262/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:186 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:6364/filter/v2/messages/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1729671346504610816,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ba241af368f5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9d5061189629
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.