[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_get_message_with_ephemeral with id: 2025-01-06_13-35-52__2339b985-8db7-4edb-88a9-2001bd99f084
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2025-01-06_13-35-52__2339b985-8db7-4edb-88a9-2001bd99f084__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.36.162
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['61883', '61884', '61885', '61886', '61887']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 61883:61883 -p 61884:61884 -p 61885:61885 -p 61886:61886 -p 61887:61887 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61885 --rest-port=61883 --tcp-port=61884 --discv5-udp-port=61886 --rest-address=0.0.0.0 --nat=extip:172.18.36.162 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eb2e3da9ad0600e25b6eebd6f294c0dcfbfc0bbb38d36dadecda5dbe6caaa3a8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61887 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.36.162 waku 84227c744430d4e682c7e4de41a9fcf18a7a53fe4421f7e89799ed42554ca2b8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 84227c744430. Setting up logs at ./log/docker/node1_2025-01-06_13-35-52__2339b985-8db7-4edb-88a9-2001bd99f084__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 61883
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f27ea5cd0bbb. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61883/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61883/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.36.162/tcp/61884/p2p/16Uiu2HAmJkBxzubfvgdB9FmoyE4vDFRGwMSEV8W1N95yYN4Q6TAw","/ip4/172.18.36.162/tcp/61885/ws/p2p/16Uiu2HAmJkBxzubfvgdB9FmoyE4vDFRGwMSEV8W1N95yYN4Q6TAw"],"enrUri":"enr:-L24QK1O7aGOtUCivQncdYcMIR8IZlBEu9hV4XzkziNemrl3JecVYdUzXN4BYArw2ofyTZ1xY9i_88gKSObwZWq-U4MCgmlkgnY0gmlwhKwSJKKKbXVsdGlhZGRyc5YACASsEiSiBvG8AAoErBIkogbxvd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDWnso1IMi7Hnld3SLibdbQsU6Jpi64BRehrn2etOzmMCDdGNwgvG8g3VkcILxvoV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2025-01-06_13-35-52__2339b985-8db7-4edb-88a9-2001bd99f084__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.198.93
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['57577', '57578', '57579', '57580', '57581']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 57577:57577 -p 57578:57578 -p 57579:57579 -p 57580:57580 -p 57581:57581 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57579 --rest-port=57577 --tcp-port=57578 --discv5-udp-port=57580 --rest-address=0.0.0.0 --nat=extip:172.18.198.93 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1ffacdeac42ce0fcf4ce59cb59a3817eaaca4abb3e3cb2c1eea9a99c038d8afc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57581 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QK1O7aGOtUCivQncdYcMIR8IZlBEu9hV4XzkziNemrl3JecVYdUzXN4BYArw2ofyTZ1xY9i_88gKSObwZWq-U4MCgmlkgnY0gmlwhKwSJKKKbXVsdGlhZGRyc5YACASsEiSiBvG8AAoErBIkogbxvd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDWnso1IMi7Hnld3SLibdbQsU6Jpi64BRehrn2etOzmMCDdGNwgvG8g3VkcILxvoV3YWt1MgU --filternode=/ip4/172.18.36.162/tcp/61884/p2p/16Uiu2HAmJkBxzubfvgdB9FmoyE4vDFRGwMSEV8W1N95yYN4Q6TAw
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.198.93 waku 5aba83d3653602981fffb06e7919e6ee344096cbe8b2595516b836e502f145db
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 5aba83d36536. Setting up logs at ./log/docker/node2_2025-01-06_13-35-52__2339b985-8db7-4edb-88a9-2001bd99f084__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 57577
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57577/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57577/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.198.93/tcp/57578/p2p/16Uiu2HAkvb4G32H5rEiiSDHXmFvPmmHmEQyNm5dNWAvRxgp7fJ3n","/ip4/172.18.198.93/tcp/57579/ws/p2p/16Uiu2HAkvb4G32H5rEiiSDHXmFvPmmHmEQyNm5dNWAvRxgp7fJ3n"],"enrUri":"enr:-L24QMOPnRfskRRRAUeBj1RkUhcKLiNToaEvxbVWat1IpvBHWkbfOcReM7y1jYyS_1CeeenXs_gGLpVcRkomZ_M7R7oCgmlkgnY0gmlwhKwSxl2KbXVsdGlhZGRyc5YACASsEsZdBuDqAAoErBLGXQbg690DgnJzhQADAQAAiXNlY3AyNTZrMaECEUMbODZsHmkRw9MLBs4Ka7q3UHLfr2e-2statisw0_WDdGNwguDqg3VkcILg7IV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57577/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.36.162/tcp/61884/p2p/16Uiu2HAmJkBxzubfvgdB9FmoyE4vDFRGwMSEV8W1N95yYN4Q6TAw"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.filter:filter.py:47 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61883/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57577/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "f0992a8c-3797-4756-9f26-e39ffcce7836", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"f0992a8c-3797-4756-9f26-e39ffcce7836","statusDesc":"OK"}'
[35mDEBUG   [0m tests.filter.test_get_messages:test_get_messages.py:49 Running test with Ephemeral True
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61883/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57577/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1736170554855215872,"ephemeral":true}]'
[35mDEBUG   [0m tests.filter.test_get_messages:test_get_messages.py:49 Running test with Ephemeral False
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61883/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57577/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1736170554966656000,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 84227c744430
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 5aba83d36536
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 84227c744430. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.