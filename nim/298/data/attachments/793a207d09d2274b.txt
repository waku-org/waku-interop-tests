[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_after_light_push_node_restarts with id: 2024-08-04_04-18-34__46e303e8-ad9c-40ad-b581-adaff085bad0
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-04_04-18-34__46e303e8-ad9c-40ad-b581-adaff085bad0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.244.168
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['37002', '37003', '37004', '37005', '37006']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 37002:37002 -p 37003:37003 -p 37004:37004 -p 37005:37005 -p 37006:37006 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37004 --rest-port=37002 --tcp-port=37003 --discv5-udp-port=37005 --rest-address=0.0.0.0 --nat=extip:172.18.244.168 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37006 --metrics-logging=true --lightpush=true --relay=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.244.168 waku 499d21857889e8e4f33d9cbe7b86ff34c6c395a2bc13ccb266ac6b2aaaaf2d1a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 499d21857889. Setting up logs at ./log/docker/receiving_node1_2024-08-04_04-18-34__46e303e8-ad9c-40ad-b581-adaff085bad0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 37002
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37002/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37002/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.244.168/tcp/37003/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.244.168/tcp/37004/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QDe0050wFxmi7Kow7T5BkLf4OhtavcaOncsq6vYGMwhBNqqu79sfQVtjLv3U_FZeWTHVSoZ9-fW3jrkrniUafIYBgmlkgnY0gmlwhKwS9KiKbXVsdGlhZGRyc4wACgSsEvSoBpCM3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCkIuDdWRwgpCNhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-04_04-18-34__46e303e8-ad9c-40ad-b581-adaff085bad0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.112.143
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['1043', '1044', '1045', '1046', '1047']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 1043:1043 -p 1044:1044 -p 1045:1045 -p 1046:1046 -p 1047:1047 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1045 --rest-port=1043 --tcp-port=1044 --discv5-udp-port=1046 --rest-address=0.0.0.0 --nat=extip:172.18.112.143 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1047 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QDe0050wFxmi7Kow7T5BkLf4OhtavcaOncsq6vYGMwhBNqqu79sfQVtjLv3U_FZeWTHVSoZ9-fW3jrkrniUafIYBgmlkgnY0gmlwhKwS9KiKbXVsdGlhZGRyc4wACgSsEvSoBpCM3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCkIuDdWRwgpCNhXdha3UyCQ --lightpushnode=/ip4/172.18.244.168/tcp/37003/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.112.143 waku 4c59da037bd54282b033320e9bdcae7365fbf7fa3a303aa508913fc4eaedbd36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 4c59da037bd5. Setting up logs at ./log/docker/lightpush_node1_2024-08-04_04-18-34__46e303e8-ad9c-40ad-b581-adaff085bad0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 1043
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1043/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:1043/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.112.143/tcp/1044/p2p/16Uiu2HAm2fUipSyTvujgJHKuLiC5xZujwq5FJW3dgqd2XgTryfrT","/ip4/172.18.112.143/tcp/1045/ws/p2p/16Uiu2HAm2fUipSyTvujgJHKuLiC5xZujwq5FJW3dgqd2XgTryfrT"],"enrUri":"enr:-LO4QNdS6ZTqvOJxa78OhQRibJzRZnHyHN5oh6r7jGy5GuY0LZcyr14wQ9734cvXTDR757-cSsnUgMPC5Qqq2e0b1yIBgmlkgnY0gmlwhKwScI-KbXVsdGlhZGRyc4wACgSsEnCPBgQV3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJrizXL7rCqDXJhPsIZPzYfWuGvAHVdOpv9S2gP8_H5XIN0Y3CCBBSDdWRwggQWhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1043/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.244.168/tcp/37003/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37002/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:1043/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1722745118109259776}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:1043/lightpush/v1/message. Response content: b'Failed to request a message push: Lightpush request has not been published to any peers. msg_hash: 0xe0015dbabc515a07908a887d8ec3170f6d33b9c2c2639d6a41b4cd65de501d36'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 499d21857889
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 4c59da037bd5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-08-04_04-18-34__46e303e8-ad9c-40ad-b581-adaff085bad0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-08-04_04-18-34__46e303e8-ad9c-40ad-b581-adaff085bad0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_after_light_push_node_restarts with id: 2024-08-04_04-18-42__fdddebb8-4b6e-4fba-be3d-bfbf9c97dab7
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-04_04-18-42__fdddebb8-4b6e-4fba-be3d-bfbf9c97dab7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.65.156
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['22472', '22473', '22474', '22475', '22476']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 22472:22472 -p 22473:22473 -p 22474:22474 -p 22475:22475 -p 22476:22476 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22474 --rest-port=22472 --tcp-port=22473 --discv5-udp-port=22475 --rest-address=0.0.0.0 --nat=extip:172.18.65.156 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22476 --metrics-logging=true --lightpush=true --relay=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.65.156 waku 948d70ac9a89609a4a9b0bd3ab6009baf5375b685703bcc3076d17eb318fe198
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 948d70ac9a89. Setting up logs at ./log/docker/receiving_node1_2024-08-04_04-18-42__fdddebb8-4b6e-4fba-be3d-bfbf9c97dab7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 22472
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22472/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22472/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.65.156/tcp/22473/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.65.156/tcp/22474/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QA5LHxrfU9iSEA1064wKvfVGODggOdzxbgRilGItsDNxQwc15-tp__7hBhtLhU_q5BdVU4KEnlM84DaPYgpxoeQBgmlkgnY0gmlwhKwSQZyKbXVsdGlhZGRyc4wACgSsEkGcBlfK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCV8mDdWRwglfLhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-04_04-18-42__fdddebb8-4b6e-4fba-be3d-bfbf9c97dab7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.101.69
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['62595', '62596', '62597', '62598', '62599']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 62595:62595 -p 62596:62596 -p 62597:62597 -p 62598:62598 -p 62599:62599 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62597 --rest-port=62595 --tcp-port=62596 --discv5-udp-port=62598 --rest-address=0.0.0.0 --nat=extip:172.18.101.69 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62599 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QA5LHxrfU9iSEA1064wKvfVGODggOdzxbgRilGItsDNxQwc15-tp__7hBhtLhU_q5BdVU4KEnlM84DaPYgpxoeQBgmlkgnY0gmlwhKwSQZyKbXVsdGlhZGRyc4wACgSsEkGcBlfK3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCV8mDdWRwglfLhXdha3UyCQ --lightpushnode=/ip4/172.18.65.156/tcp/22473/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.101.69 waku 60a0b490cc4f4ffa88fffa1136c06cf5db69961134450b008caede15988a87f0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 60a0b490cc4f. Setting up logs at ./log/docker/lightpush_node1_2024-08-04_04-18-42__fdddebb8-4b6e-4fba-be3d-bfbf9c97dab7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 62595
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62595/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62595/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.101.69/tcp/62596/p2p/16Uiu2HAm1hpdyJ3Qux3uM6vagGNmy6KAzbjPxUKCyURUEMPi5GXm","/ip4/172.18.101.69/tcp/62597/ws/p2p/16Uiu2HAm1hpdyJ3Qux3uM6vagGNmy6KAzbjPxUKCyURUEMPi5GXm"],"enrUri":"enr:-LO4QKdxHvHSKQlhTFh6IrpLJIzCzyCgbH9u3-2g2zSqAfPMUAB7Go6uA6s7uXLQWRiAbhUVQ_GUdG9E-GCsKL36a0EBgmlkgnY0gmlwhKwSZUWKbXVsdGlhZGRyc4wACgSsEmVFBvSF3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJdSTRT76AfCqouwjcTtbTa2II0BxszNPlZrNNGCjtUhIN0Y3CC9ISDdWRwgvSGhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62595/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.65.156/tcp/22473/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22472/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62595/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1722745126446169088}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:62595/lightpush/v1/message. Response content: b'Failed to request a message push: Lightpush request has not been published to any peers. msg_hash: 0x30ff3bb70c0e5992c424935b41bb463fd611afaed9e30ae60fd4ab77c7e485a6'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 948d70ac9a89
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 60a0b490cc4f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-08-04_04-18-42__fdddebb8-4b6e-4fba-be3d-bfbf9c97dab7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-08-04_04-18-42__fdddebb8-4b6e-4fba-be3d-bfbf9c97dab7__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_after_light_push_node_restarts with id: 2024-08-04_04-18-50__4393de4a-7509-4a8f-aa70-047df7a7986e
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-04_04-18-50__4393de4a-7509-4a8f-aa70-047df7a7986e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.182.188
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['64881', '64882', '64883', '64884', '64885']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 64881:64881 -p 64882:64882 -p 64883:64883 -p 64884:64884 -p 64885:64885 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=64883 --rest-port=64881 --tcp-port=64882 --discv5-udp-port=64884 --rest-address=0.0.0.0 --nat=extip:172.18.182.188 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=64885 --metrics-logging=true --lightpush=true --relay=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.182.188 waku 05aa6ae7a40f364b7892c3cb74fda27201bfdd903757a816f9db30573b58917a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 05aa6ae7a40f. Setting up logs at ./log/docker/receiving_node1_2024-08-04_04-18-50__4393de4a-7509-4a8f-aa70-047df7a7986e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 64881
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64881/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64881/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.182.188/tcp/64882/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.182.188/tcp/64883/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QDZdVp9rZfKPjQFJrvpDIqjla2vHQW3xCloitfKaXIrAO82Ji4cN0Z7cYFBbSI5-cwEJa9jyi6GRsd618I1iLp0BgmlkgnY0gmlwhKwStryKbXVsdGlhZGRyc4wACgSsEra8Bv1z3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC_XKDdWRwgv10hXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:81 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-04_04-18-50__4393de4a-7509-4a8f-aa70-047df7a7986e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.65.11
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['45818', '45819', '45820', '45821', '45822']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:428 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:157 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:159 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 45818:45818 -p 45819:45819 -p 45820:45820 -p 45821:45821 -p 45822:45822 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=45820 --rest-port=45818 --tcp-port=45819 --discv5-udp-port=45821 --rest-address=0.0.0.0 --nat=extip:172.18.65.11 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=45822 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QDZdVp9rZfKPjQFJrvpDIqjla2vHQW3xCloitfKaXIrAO82Ji4cN0Z7cYFBbSI5-cwEJa9jyi6GRsd618I1iLp0BgmlkgnY0gmlwhKwStryKbXVsdGlhZGRyc4wACgSsEra8Bv1z3QOCcnOFAAMBAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC_XKDdWRwgv10hXdha3UyCQ --lightpushnode=/ip4/172.18.182.188/tcp/64882/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.65.11 waku 299c526ebf5a64e4971c211890563bad4ad958b2aa9ed3f0edf8ed4d485fb4fc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 299c526ebf5a. Setting up logs at ./log/docker/lightpush_node1_2024-08-04_04-18-50__4393de4a-7509-4a8f-aa70-047df7a7986e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Started container from image wakuorg/nwaku:latest. REST: 45818
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45818/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:274 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:45818/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.65.11/tcp/45819/p2p/16Uiu2HAmC9uVDswFiQg3ACHd4ncfteT57KxwrVc46JX4nuXGoEFD","/ip4/172.18.65.11/tcp/45820/ws/p2p/16Uiu2HAmC9uVDswFiQg3ACHd4ncfteT57KxwrVc46JX4nuXGoEFD"],"enrUri":"enr:-LO4QB_YSbN5iTbRKeJk4cIIdHcsUs0gftk8U6IhltCaw1aIaC_ggwakQiQTwldlwCCJcP4wGIk71XE5xfC_WsyQ0K8BgmlkgnY0gmlwhKwSQQuKbXVsdGlhZGRyc4wACgSsEkELBrL83QOCcnOFAAMBAACJc2VjcDI1NmsxoQL4jKhdJg_Gdsykun4XDRMNoCmPrdKkTGFecAenHuU2bIN0Y3CCsvuDdWRwgrL9hXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45818/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.182.188/tcp/64882/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64881/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:45818/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1722745133558315520}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:45818/lightpush/v1/message. Response content: b'Failed to request a message push: Lightpush request has not been published to any peers. msg_hash: 0x9df3ba65ff2f9f1ae45b867ab26f6b3c9ec5f5d26bc799650f0357688f28582b'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 05aa6ae7a40f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:218 Stopping container with id 299c526ebf5a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:225 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-08-04_04-18-50__4393de4a-7509-4a8f-aa70-047df7a7986e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-08-04_04-18-50__4393de4a-7509-4a8f-aa70-047df7a7986e__wakuorg_nwaku:latest.log