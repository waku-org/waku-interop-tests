[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_single_pubsub_topic[/waku/2/rs/2/1] with id: 2024-08-27_07-07-16__b5d1fa67-4fe3-4950-9a9b-6ffb62a591ed
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-08-27_07-07-16__b5d1fa67-4fe3-4950-9a9b-6ffb62a591ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.159.4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['25016', '25017', '25018', '25019', '25020']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 25016:25016 -p 25017:25017 -p 25018:25018 -p 25019:25019 -p 25020:25020 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25018 --rest-port=25016 --tcp-port=25017 --discv5-udp-port=25019 --rest-address=0.0.0.0 --nat=extip:172.18.159.4 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=4ed9cdac6baef7ac695bd0e67e3dbaeceb4a58a6ebc2c00bed565ddea2f0e098 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25020 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.159.4 waku faf26d775814a3d48f1f8f2503cbc2dac130acad74d8fe6978fc42f316a293cf
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID faf26d775814. Setting up logs at ./log/docker/node1_2024-08-27_07-07-16__b5d1fa67-4fe3-4950-9a9b-6ffb62a591ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 25016
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25016/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25016/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.159.4/tcp/25017/p2p/16Uiu2HAmDFYdAH17szwmpdryhGKLKSspKk1WRpdiaUaYkQMvp7ZX","/ip4/172.18.159.4/tcp/25018/ws/p2p/16Uiu2HAmDFYdAH17szwmpdryhGKLKSspKk1WRpdiaUaYkQMvp7ZX"],"enrUri":"enr:-LO4QCcOpO0VPnMjMv2_lEna0BMCJwPA2XrgrrhIh4jSuvbwUA1c2WYZrU9d94qsU82c7V7rMRFkdxazFZ1nA62sPigBgmlkgnY0gmlwhKwSnwSKbXVsdGlhZGRyc4wACgSsEp8EBmG63QOCcnOFAAIBAAGJc2VjcDI1NmsxoQMI2j1K8NrfLFMJI2QyOHD58wh8KnYvLhrlbL9HJuTYnoN0Y3CCYbmDdWRwgmG7hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-08-27_07-07-16__b5d1fa67-4fe3-4950-9a9b-6ffb62a591ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.48.45
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['30157', '30158', '30159', '30160', '30161']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:431 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 30157:30157 -p 30158:30158 -p 30159:30159 -p 30160:30160 -p 30161:30161 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30159 --rest-port=30157 --tcp-port=30158 --discv5-udp-port=30160 --rest-address=0.0.0.0 --nat=extip:172.18.48.45 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=00a6a58bb0c9bcbae6cdef5f6b2ab1072c8922c7eedcdcd47fff3cb49c7ac50a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30161 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QCcOpO0VPnMjMv2_lEna0BMCJwPA2XrgrrhIh4jSuvbwUA1c2WYZrU9d94qsU82c7V7rMRFkdxazFZ1nA62sPigBgmlkgnY0gmlwhKwSnwSKbXVsdGlhZGRyc4wACgSsEp8EBmG63QOCcnOFAAIBAAGJc2VjcDI1NmsxoQMI2j1K8NrfLFMJI2QyOHD58wh8KnYvLhrlbL9HJuTYnoN0Y3CCYbmDdWRwgmG7hXdha3UyBQ --pubsub-topic=/waku/2/rs/2/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.48.45 waku 793866ed19c58bb477fdfc111e3e8cdf0d106ee0fb8707181c95f995b6ab6655
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 793866ed19c5. Setting up logs at ./log/docker/node2_2024-08-27_07-07-16__b5d1fa67-4fe3-4950-9a9b-6ffb62a591ed__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 30157
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30157/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30157/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.48.45/tcp/30158/p2p/16Uiu2HAm5Ffz9Qp7RRXyLtpqx2M98AZTt4e8KGyFiyLPwtd2K6E6","/ip4/172.18.48.45/tcp/30159/ws/p2p/16Uiu2HAm5Ffz9Qp7RRXyLtpqx2M98AZTt4e8KGyFiyLPwtd2K6E6"],"enrUri":"enr:-LO4QCMzK0QkeFoTrsmvs6B-mnpEWuy-BJmnbd25AGEsgwlqA5J8eulucV6QW1X_pgns5L73ypf1qfnjVjrh3xK6WdoBgmlkgnY0gmlwhKwSMC2KbXVsdGlhZGRyc4wACgSsEjAtBnXP3QOCcnOFAAIBAAGJc2VjcDI1NmsxoQKSBRFrIoPUyQnRTcpFQV4BJw5cgOuYzSamWN3Cl_V0y4N0Y3CCdc6DdWRwgnXQhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30157/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.159.4/tcp/25017/p2p/16Uiu2HAmDFYdAH17szwmpdryhGKLKSspKk1WRpdiaUaYkQMvp7ZX"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25016/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30157/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:25016/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25016/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724742439360645632,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30157/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1724742439360645632,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id faf26d775814
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 793866ed19c5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.