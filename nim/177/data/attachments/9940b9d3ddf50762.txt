[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_relay_and_store with id: 2024-05-06_04-21-30__9a767810-611b-444e-bcf7-fb45391ca869
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-06_04-21-30__9a767810-611b-444e-bcf7-fb45391ca869__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.11.225
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['40055', '40056', '40057', '40058', '40059']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 40055:40055 -p 40056:40056 -p 40057:40057 -p 40058:40058 -p 40059:40059 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40057 --rest-port=40055 --tcp-port=40056 --discv5-udp-port=40058 --rest-address=0.0.0.0 --nat=extip:172.18.11.225 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40059 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.11.225 waku 89b21cf67661f14ba5abd783f22690e5487b38c84785b6da8590dc71d68c080d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 89b21cf67661. Setting up logs at ./log/docker/publishing_node1_2024-05-06_04-21-30__9a767810-611b-444e-bcf7-fb45391ca869__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 40055
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40055/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.11.225/tcp/40056/p2p/16Uiu2HAmVPBb5aGfZiRN4YjgHyzLoVqzRv6tPXaLc3wN9mDqseyK","/ip4/172.18.11.225/tcp/40057/ws/p2p/16Uiu2HAmVPBb5aGfZiRN4YjgHyzLoVqzRv6tPXaLc3wN9mDqseyK"],"enrUri":"enr:-LO4QPO3Q8dFAuI7rU0c6i59Co2BrH3sFhYN0Z67b-YM9LebWqllBvQ9bTkf_4mxihoDnHMUO12seosaR1VDMg9MoNwBgmlkgnY0gmlwhKwSC-GKbXVsdGlhZGRyc4wACgSsEgvhBpx53QOCcnOFAAABAACJc2VjcDI1NmsxoQP4ihdkOG9wfN3gakgvfgiXW6C2OXxXYjkWfS-wm8OtRoN0Y3CCnHiDdWRwgpx6hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-06_04-21-30__9a767810-611b-444e-bcf7-fb45391ca869__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.190.198
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['50883', '50884', '50885', '50886', '50887']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 50883:50883 -p 50884:50884 -p 50885:50885 -p 50886:50886 -p 50887:50887 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50885 --rest-port=50883 --tcp-port=50884 --discv5-udp-port=50886 --rest-address=0.0.0.0 --nat=extip:172.18.190.198 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50887 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QPO3Q8dFAuI7rU0c6i59Co2BrH3sFhYN0Z67b-YM9LebWqllBvQ9bTkf_4mxihoDnHMUO12seosaR1VDMg9MoNwBgmlkgnY0gmlwhKwSC-GKbXVsdGlhZGRyc4wACgSsEgvhBpx53QOCcnOFAAABAACJc2VjcDI1NmsxoQP4ihdkOG9wfN3gakgvfgiXW6C2OXxXYjkWfS-wm8OtRoN0Y3CCnHiDdWRwgpx6hXdha3UyAw --storenode=/ip4/172.18.11.225/tcp/40056/p2p/16Uiu2HAmVPBb5aGfZiRN4YjgHyzLoVqzRv6tPXaLc3wN9mDqseyK --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.190.198 waku 66a7a69a9eab562eb171b6be6db285995a2b4781742150151aecfbab1f8a99fc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 66a7a69a9eab. Setting up logs at ./log/docker/store_node1_2024-05-06_04-21-30__9a767810-611b-444e-bcf7-fb45391ca869__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 50883
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50883/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.190.198/tcp/50884/p2p/16Uiu2HAm3gw3vEjkxBXpPpSCTnGX3WcnXUSsP1siRkzYaraFLTHH","/ip4/172.18.190.198/tcp/50885/ws/p2p/16Uiu2HAm3gw3vEjkxBXpPpSCTnGX3WcnXUSsP1siRkzYaraFLTHH"],"enrUri":"enr:-LO4QK4ff_Sl3DvEcNu0S1ga3QYED4PPg3N7VCkV681G9i6gepfr7-oofqrkHmTrckl5IeQSQxh88K1o39QW2E6VUsYBgmlkgnY0gmlwhKwSvsaKbXVsdGlhZGRyc4wACgSsEr7GBsbF3QOCcnOFAAABAACJc2VjcDI1NmsxoQJ6xj-fEEnifM5oe9MdxlfG6aCiOvaZ1oV2f0Wuj29ckIN0Y3CCxsSDdWRwgsbGhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50883/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.11.225/tcp/40056/p2p/16Uiu2HAmVPBb5aGfZiRN4YjgHyzLoVqzRv6tPXaLc3wN9mDqseyK"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40055/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50883/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:40055/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:40055/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714969302519059712,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 89b21cf67661
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 66a7a69a9eab
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-06_04-21-30__9a767810-611b-444e-bcf7-fb45391ca869__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-06_04-21-30__9a767810-611b-444e-bcf7-fb45391ca869__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_relay_and_store with id: 2024-05-06_04-21-46__ac139eaf-396c-40f5-8187-eed7a3e98e06
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-06_04-21-46__ac139eaf-396c-40f5-8187-eed7a3e98e06__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.234.78
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['13360', '13361', '13362', '13363', '13364']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 13360:13360 -p 13361:13361 -p 13362:13362 -p 13363:13363 -p 13364:13364 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=13362 --rest-port=13360 --tcp-port=13361 --discv5-udp-port=13363 --rest-address=0.0.0.0 --nat=extip:172.18.234.78 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=13364 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.234.78 waku 90284f1857ba52754c639b2297be536b8f7cc7e443667fefb10f780519509437
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 90284f1857ba. Setting up logs at ./log/docker/publishing_node1_2024-05-06_04-21-46__ac139eaf-396c-40f5-8187-eed7a3e98e06__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 13360
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13360/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.234.78/tcp/13361/p2p/16Uiu2HAmQ3evVcpr88qH5mGzUUCTvrMqFLEhqF4m166yD8RqBAe9","/ip4/172.18.234.78/tcp/13362/ws/p2p/16Uiu2HAmQ3evVcpr88qH5mGzUUCTvrMqFLEhqF4m166yD8RqBAe9"],"enrUri":"enr:-LO4QL1pkzf0qUDRdY1pXQdfoGYN-T0n-SiJkQDKGb-X9J5XEotiNj42w63IK3ocKPU0wO-_hRLNtNMGESL5tPpczuUBgmlkgnY0gmlwhKwS6k6KbXVsdGlhZGRyc4wACgSsEupOBjQy3QOCcnOFAAABAACJc2VjcDI1NmsxoQOpPvKy2whEwR6kfihrZTxW1KEDSEuA8JZfw2doJKu1_oN0Y3CCNDGDdWRwgjQzhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-06_04-21-46__ac139eaf-396c-40f5-8187-eed7a3e98e06__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.162.248
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['20973', '20974', '20975', '20976', '20977']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 20973:20973 -p 20974:20974 -p 20975:20975 -p 20976:20976 -p 20977:20977 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20975 --rest-port=20973 --tcp-port=20974 --discv5-udp-port=20976 --rest-address=0.0.0.0 --nat=extip:172.18.162.248 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20977 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QL1pkzf0qUDRdY1pXQdfoGYN-T0n-SiJkQDKGb-X9J5XEotiNj42w63IK3ocKPU0wO-_hRLNtNMGESL5tPpczuUBgmlkgnY0gmlwhKwS6k6KbXVsdGlhZGRyc4wACgSsEupOBjQy3QOCcnOFAAABAACJc2VjcDI1NmsxoQOpPvKy2whEwR6kfihrZTxW1KEDSEuA8JZfw2doJKu1_oN0Y3CCNDGDdWRwgjQzhXdha3UyAw --storenode=/ip4/172.18.234.78/tcp/13361/p2p/16Uiu2HAmQ3evVcpr88qH5mGzUUCTvrMqFLEhqF4m166yD8RqBAe9 --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.162.248 waku 15d338b10a7cb9edbe0a8b739306bd8a7c0046714d8f7f3d73226ba67c1bbf94
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 15d338b10a7c. Setting up logs at ./log/docker/store_node1_2024-05-06_04-21-46__ac139eaf-396c-40f5-8187-eed7a3e98e06__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 20973
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20973/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.162.248/tcp/20974/p2p/16Uiu2HAm7RzkJyu1MAgxNtA6zMaaugkcxAUHv7t8qxMdskUX3Qj7","/ip4/172.18.162.248/tcp/20975/ws/p2p/16Uiu2HAm7RzkJyu1MAgxNtA6zMaaugkcxAUHv7t8qxMdskUX3Qj7"],"enrUri":"enr:-LO4QJxhGTe_0xt8ZtrfshX-YAbnlEEKVXKRKBNiprwIVjh-N-YwmHpjn5UBEGZqtXBpIy4-aOoUXiQHGAA6YgiTC-4BgmlkgnY0gmlwhKwSoviKbXVsdGlhZGRyc4wACgSsEqL4BlHv3QOCcnOFAAABAACJc2VjcDI1NmsxoQKyYXaxMft53LFAjBOLFrSnWkgzTWhoY73hYVWh5HwNloN0Y3CCUe6DdWRwglHwhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20973/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.234.78/tcp/13361/p2p/16Uiu2HAmQ3evVcpr88qH5mGzUUCTvrMqFLEhqF4m166yD8RqBAe9"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13360/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20973/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:13360/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:13360/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714969318618626816,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 90284f1857ba
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id 15d338b10a7c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-06_04-21-46__ac139eaf-396c-40f5-8187-eed7a3e98e06__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-06_04-21-46__ac139eaf-396c-40f5-8187-eed7a3e98e06__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_main_node_relay_and_store__peer_relay_and_store with id: 2024-05-06_04-22-03__bfec1f1c-0b7a-4bc1-baf0-a1c13b92e7b0
[35mDEBUG   [0m src.steps.common:common.py:15 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:26 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-05-06_04-22-03__bfec1f1c-0b7a-4bc1-baf0-a1c13b92e7b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.121.65
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['17585', '17586', '17587', '17588', '17589']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 17585:17585 -p 17586:17586 -p 17587:17587 -p 17588:17588 -p 17589:17589 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17587 --rest-port=17585 --tcp-port=17586 --discv5-udp-port=17588 --rest-address=0.0.0.0 --nat=extip:172.18.121.65 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17589 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.121.65 waku af5e2682a23827b1eb34cdaf2b6eb65aa45549feeefc8934d3c19af4cc2bfe78
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID af5e2682a238. Setting up logs at ./log/docker/publishing_node1_2024-05-06_04-22-03__bfec1f1c-0b7a-4bc1-baf0-a1c13b92e7b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 17585
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17585/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.121.65/tcp/17586/p2p/16Uiu2HAmA6ZM6P1Lmi6tH14huhd4BxRS15qkeiSNYCbAMkBh3Awe","/ip4/172.18.121.65/tcp/17587/ws/p2p/16Uiu2HAmA6ZM6P1Lmi6tH14huhd4BxRS15qkeiSNYCbAMkBh3Awe"],"enrUri":"enr:-LO4QHoiifhp1ioW20qO19dpeHf6s6ZqC1mREFtJiA_T0DznIOV41gwBRXiq1OH-l4BMxaa7MTRNwIsbrM6iChHRPj8BgmlkgnY0gmlwhKwSeUGKbXVsdGlhZGRyc4wACgSsEnlBBkSz3QOCcnOFAAABAACJc2VjcDI1NmsxoQLZ-cTSreYcCHfnky7KlOKLPqVLF4cboPJ6mtYqCGXJdYN0Y3CCRLKDdWRwgkS0hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-05-06_04-22-03__bfec1f1c-0b7a-4bc1-baf0-a1c13b92e7b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.185.87
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['36563', '36564', '36565', '36566', '36567']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:314 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:114 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 36563:36563 -p 36564:36564 -p 36565:36565 -p 36566:36566 -p 36567:36567 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36565 --rest-port=36563 --tcp-port=36564 --discv5-udp-port=36566 --rest-address=0.0.0.0 --nat=extip:172.18.185.87 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36567 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QHoiifhp1ioW20qO19dpeHf6s6ZqC1mREFtJiA_T0DznIOV41gwBRXiq1OH-l4BMxaa7MTRNwIsbrM6iChHRPj8BgmlkgnY0gmlwhKwSeUGKbXVsdGlhZGRyc4wACgSsEnlBBkSz3QOCcnOFAAABAACJc2VjcDI1NmsxoQLZ-cTSreYcCHfnky7KlOKLPqVLF4cboPJ6mtYqCGXJdYN0Y3CCRLKDdWRwgkS0hXdha3UyAw --storenode=/ip4/172.18.121.65/tcp/17586/p2p/16Uiu2HAmA6ZM6P1Lmi6tH14huhd4BxRS15qkeiSNYCbAMkBh3Awe --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.185.87 waku b65d28f2a44744f6747111955c8b7efb76fd0ff2cbccaeabc3531c1ba49c5f8f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID b65d28f2a447. Setting up logs at ./log/docker/store_node1_2024-05-06_04-22-03__bfec1f1c-0b7a-4bc1-baf0-a1c13b92e7b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:120 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 36563
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36563/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.185.87/tcp/36564/p2p/16Uiu2HAmPSJaNNbzramHzsznzJ7erH5jDy9hRHpX8SKYZvUv76fa","/ip4/172.18.185.87/tcp/36565/ws/p2p/16Uiu2HAmPSJaNNbzramHzsznzJ7erH5jDy9hRHpX8SKYZvUv76fa"],"enrUri":"enr:-LO4QJ-919zXHdWTvU4UDpQukzNA9ai-9uxbr5KaHYdqjassJIj7crJMu1qtzkq1vKFgcr5vjWixamN7wxlx4VwO-6sBgmlkgnY0gmlwhKwSuVeKbXVsdGlhZGRyc4wACgSsErlXBo7V3QOCcnOFAAABAACJc2VjcDI1NmsxoQOgMJ0Cdu2yI3qqIgL1G1A2QIAlNHmIeOh-Ya9NeFtN0YN0Y3CCjtSDdWRwgo7WhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:190 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36563/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.121.65/tcp/17586/p2p/16Uiu2HAmA6ZM6P1Lmi6tH14huhd4BxRS15qkeiSNYCbAMkBh3Awe"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17585/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36563/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:120 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:17585/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.store:store.py:151 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:17585/store/v1/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"messages":[{"payload":"U3RvcmUgd29ya3MhIQ==","content_topic":"/myapp/1/latest/proto","version":0,"timestamp":1714969335198064896,"ephemeral":false}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id af5e2682a238
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Stopping container with id b65d28f2a447
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/publishing_node1_2024-05-06_04-22-03__bfec1f1c-0b7a-4bc1-baf0-a1c13b92e7b0__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/store_node1_2024-05-06_04-22-03__bfec1f1c-0b7a-4bc1-baf0-a1c13b92e7b0__harbor.status.im_wakuorg_nwaku:latest.log