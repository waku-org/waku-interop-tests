[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_lightpush with id: 2024-11-04_04-03-48__fe5cf99f-20ed-4ff8-bd21-f38350ea3e44
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-04_04-03-48__fe5cf99f-20ed-4ff8-bd21-f38350ea3e44__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.48.57
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59445', '59446', '59447', '59448', '59449']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59445:59445 -p 59446:59446 -p 59447:59447 -p 59448:59448 -p 59449:59449 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59447 --rest-port=59445 --tcp-port=59446 --discv5-udp-port=59448 --rest-address=0.0.0.0 --nat=extip:172.18.48.57 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b067a702ad8a8462c8d32fbe5ef50ceaf6d96e7cb37eb8f0cfdb2aacbddcfe8f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59449 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.48.57 waku eaf0645168e7ad7df625cf120c48aa2e941adb2979cfc3bb53efd42042e5a5a5
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 27a1f6e44754. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID eaf0645168e7. Setting up logs at ./log/docker/node1_2024-11-04_04-03-48__fe5cf99f-20ed-4ff8-bd21-f38350ea3e44__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 59445
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59445/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59445/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.48.57/tcp/59446/p2p/16Uiu2HAmUr4FqTMGU7eYmfDH8nATdMPSfeBSTbFq7avuMC2118MB","/ip4/172.18.48.57/tcp/59447/ws/p2p/16Uiu2HAmUr4FqTMGU7eYmfDH8nATdMPSfeBSTbFq7avuMC2118MB"],"enrUri":"enr:-L24QCp4obaV8AwB0N00Bqz_OqkX-DXrvYRgNEJgAF7zSfZOKQqAZwb69frL_DQVqGc49SrqCY7QvUcPT24HXrK161YCgmlkgnY0gmlwhKwSMDmKbXVsdGlhZGRyc5YACASsEjA5Bug2AAoErBIwOQboN90DgnJzhQADAQAAiXNlY3AyNTZrMaED8JDL1O1TI_PDiykaBSS-8KDnO_7sg4xwjIB06wfJ1u6DdGNwgug2g3VkcILoOIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-04_04-03-48__fe5cf99f-20ed-4ff8-bd21-f38350ea3e44__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.66.204
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['19579', '19580', '19581', '19582', '19583']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 19579:19579 -p 19580:19580 -p 19581:19581 -p 19582:19582 -p 19583:19583 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19581 --rest-port=19579 --tcp-port=19580 --discv5-udp-port=19582 --rest-address=0.0.0.0 --nat=extip:172.18.66.204 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c18db1d1d9d57446e0814d0af995db1d79c9d66c1fbcafbdebcb7ddaf4d41c8a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19583 --metrics-logging=true --lightpush=false --relay=true --discv5-bootstrap-node=enr:-L24QCp4obaV8AwB0N00Bqz_OqkX-DXrvYRgNEJgAF7zSfZOKQqAZwb69frL_DQVqGc49SrqCY7QvUcPT24HXrK161YCgmlkgnY0gmlwhKwSMDmKbXVsdGlhZGRyc5YACASsEjA5Bug2AAoErBIwOQboN90DgnJzhQADAQAAiXNlY3AyNTZrMaED8JDL1O1TI_PDiykaBSS-8KDnO_7sg4xwjIB06wfJ1u6DdGNwgug2g3VkcILoOIV3YWt1Mgk
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.66.204 waku 9720742eaa1e1add143781fb8e7ef47ed37141b603c4850c6dce60f82fcc1bb5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9720742eaa1e. Setting up logs at ./log/docker/node1_2024-11-04_04-03-48__fe5cf99f-20ed-4ff8-bd21-f38350ea3e44__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 19579
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19579/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19579/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.66.204/tcp/19580/p2p/16Uiu2HAmKaRgqbpbm19kqc56VF1qsTBq3UHT3rGwwnUPttrg4Yyn","/ip4/172.18.66.204/tcp/19581/ws/p2p/16Uiu2HAmKaRgqbpbm19kqc56VF1qsTBq3UHT3rGwwnUPttrg4Yyn"],"enrUri":"enr:-L24QJzHhsjGjxtoul9AfLcfY8qnlu4-BFSuFl4OZ3fzfkdrDmynwXvRXJNq7edwXthDB7fvS7Yq2Ltcf77ARvikDoQCgmlkgnY0gmlwhKwSQsyKbXVsdGlhZGRyc5YACASsEkLMBkx8AAoErBJCzAZMfd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDZtaNmhYfQmnO7un2YxmGRVpyQo9xMfqxN7cGV6eNwgGDdGNwgkx8g3VkcIJMfoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-04_04-03-48__fe5cf99f-20ed-4ff8-bd21-f38350ea3e44__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.190.80
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['22299', '22300', '22301', '22302', '22303']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 22299:22299 -p 22300:22300 -p 22301:22301 -p 22302:22302 -p 22303:22303 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22301 --rest-port=22299 --tcp-port=22300 --discv5-udp-port=22302 --rest-address=0.0.0.0 --nat=extip:172.18.190.80 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b2f82f30eea7d099eecabe3d0be90ebf77d1121e38daa1e9cfc2ee69fc07d44b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22303 --metrics-logging=true --lightpush=true --relay=false --discv5-bootstrap-node=enr:-L24QCp4obaV8AwB0N00Bqz_OqkX-DXrvYRgNEJgAF7zSfZOKQqAZwb69frL_DQVqGc49SrqCY7QvUcPT24HXrK161YCgmlkgnY0gmlwhKwSMDmKbXVsdGlhZGRyc5YACASsEjA5Bug2AAoErBIwOQboN90DgnJzhQADAQAAiXNlY3AyNTZrMaED8JDL1O1TI_PDiykaBSS-8KDnO_7sg4xwjIB06wfJ1u6DdGNwgug2g3VkcILoOIV3YWt1Mgk --lightpushnode=/ip4/172.18.48.57/tcp/59446/p2p/16Uiu2HAmUr4FqTMGU7eYmfDH8nATdMPSfeBSTbFq7avuMC2118MB
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.190.80 waku ee37a634d488a3d12b7566744bb3a395d3238f4f866c0b2337d3ef581a175dc6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ee37a634d488. Setting up logs at ./log/docker/node1_2024-11-04_04-03-48__fe5cf99f-20ed-4ff8-bd21-f38350ea3e44__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 22299
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22299/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:22299/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.190.80/tcp/22300/p2p/16Uiu2HAmA5em3KsANcNqiDZNPxeksCQCyGo6yuj8AdUPfz1Jtviv","/ip4/172.18.190.80/tcp/22301/ws/p2p/16Uiu2HAmA5em3KsANcNqiDZNPxeksCQCyGo6yuj8AdUPfz1Jtviv"],"enrUri":"enr:-L24QK6Fa99tiSpkbSBaMGuO244t-oBQ3EBiGwm8uovr2wQMHtoHhJpGp8Fh77x2k7K-tfXSLuzKHonYihQN7nwGMwwCgmlkgnY0gmlwhKwSvlCKbXVsdGlhZGRyc5YACASsEr5QBlccAAoErBK-UAZXHd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC2b5O80RByKBg40fQmFPD5L48MW7HQbopv-pk1IhfxTuDdGNwglccg3VkcIJXHoV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59445/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19579/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:22299/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1730693034011666944}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59445/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730693034011666944,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19579/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1730693034011666944,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id eaf0645168e7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9720742eaa1e
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container eaf0645168e7. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id ee37a634d488
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 9720742eaa1e. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.