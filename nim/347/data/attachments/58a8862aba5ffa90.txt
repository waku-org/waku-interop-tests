[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-09-06_09-40-02__cce3b76d-fef8-4773-b5ee-460f23bd0d4a
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-09-06_09-40-02__cce3b76d-fef8-4773-b5ee-460f23bd0d4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.193.150
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['61219', '61220', '61221', '61222', '61223']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 61219:61219 -p 61220:61220 -p 61221:61221 -p 61222:61222 -p 61223:61223 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61221 --rest-port=61219 --tcp-port=61220 --discv5-udp-port=61222 --rest-address=0.0.0.0 --nat=extip:172.18.193.150 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bdbe13efc2dec9eaab7df08bbedd831baa9e694efd33f9e6ee0be3e82326b2df --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61223 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.193.150 waku dbe375b212e7f0a62400df2423ddffd409669f59659a6584542f385bc36efc1c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID dbe375b212e7. Setting up logs at ./log/docker/receiving_node1_2024-09-06_09-40-02__cce3b76d-fef8-4773-b5ee-460f23bd0d4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 61219
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61219/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61219/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.193.150/tcp/61220/p2p/16Uiu2HAm6kB5ve2Jn74gNQg7QhuevtWxoXTDaCCjrwMTQVFnBZ9t","/ip4/172.18.193.150/tcp/61221/ws/p2p/16Uiu2HAm6kB5ve2Jn74gNQg7QhuevtWxoXTDaCCjrwMTQVFnBZ9t"],"enrUri":"enr:-LO4QMhgF8HaoViAlqYyC3A38aEJGQq5HsS0sIDp5424ATP3Ym073NTtZKnvRcG_bNJbHJ44t8gVM5se93DYnJJK1uIBgmlkgnY0gmlwhKwSwZaKbXVsdGlhZGRyc4wACgSsEsGWBu8l3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKoLeuzJgDkNgN8N7h61GyVHYOnOWD7RiuYmxJF5iUpI4N0Y3CC7ySDdWRwgu8mhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-09-06_09-40-02__cce3b76d-fef8-4773-b5ee-460f23bd0d4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.181.252
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['41206', '41207', '41208', '41209', '41210']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 41206:41206 -p 41207:41207 -p 41208:41208 -p 41209:41209 -p 41210:41210 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=41208 --rest-port=41206 --tcp-port=41207 --discv5-udp-port=41209 --rest-address=0.0.0.0 --nat=extip:172.18.181.252 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f1e50bbdadfe8dcd66ade9ef91a8e91fcc70bbf415acf5a480fb3efdbf6afab2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=41210 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.181.252 waku 6c2084fa09c0d0efdbbaa64981e032f41457ada0955feb1c3f4b160e9f6bc694
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 6c2084fa09c0. Setting up logs at ./log/docker/receiving_node2_2024-09-06_09-40-02__cce3b76d-fef8-4773-b5ee-460f23bd0d4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 41206
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41206/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41206/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.181.252/tcp/41207/p2p/16Uiu2HAm1eN28s379YnAktCdM5dnyEDurrc4jyPeuB1k6oZGYqbg","/ip4/172.18.181.252/tcp/41208/ws/p2p/16Uiu2HAm1eN28s379YnAktCdM5dnyEDurrc4jyPeuB1k6oZGYqbg"],"enrUri":"enr:-LO4QLCJ5KwrNDUXdTAGID57vQqqFdSUzWjm0sUDPWv20kGmbhKyzf4X5S4-CgzN1L70P_00mJJTAXjmrOdEwzw6AMcBgmlkgnY0gmlwhKwStfyKbXVsdGlhZGRyc4wACgSsErX8BqD43QOCcnOFAAMBAACJc2VjcDI1NmsxoQJcZl12NvDQ-Br6_YkG2btzj_eB1GBVhHGhjAlwOlB4Y4N0Y3CCoPeDdWRwgqD5hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41206/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.193.150/tcp/61220/p2p/16Uiu2HAm6kB5ve2Jn74gNQg7QhuevtWxoXTDaCCjrwMTQVFnBZ9t"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-09-06_09-40-02__cce3b76d-fef8-4773-b5ee-460f23bd0d4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.190.48
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['53638', '53639', '53640', '53641', '53642']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 53638:53638 -p 53639:53639 -p 53640:53640 -p 53641:53641 -p 53642:53642 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53640 --rest-port=53638 --tcp-port=53639 --discv5-udp-port=53641 --rest-address=0.0.0.0 --nat=extip:172.18.190.48 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bcd5ad93d1ad34dc0dd61a835fb614ef0f3fdfaabb7dc2d45ace44ad6e4cdcb7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53642 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QMhgF8HaoViAlqYyC3A38aEJGQq5HsS0sIDp5424ATP3Ym073NTtZKnvRcG_bNJbHJ44t8gVM5se93DYnJJK1uIBgmlkgnY0gmlwhKwSwZaKbXVsdGlhZGRyc4wACgSsEsGWBu8l3QOCcnOFAAMBAACJc2VjcDI1NmsxoQKoLeuzJgDkNgN8N7h61GyVHYOnOWD7RiuYmxJF5iUpI4N0Y3CC7ySDdWRwgu8mhXdha3UyCQ --lightpushnode=/ip4/172.18.193.150/tcp/61220/p2p/16Uiu2HAm6kB5ve2Jn74gNQg7QhuevtWxoXTDaCCjrwMTQVFnBZ9t --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.190.48 waku 1958355e5ddbdb9bf7ad4c53a4891f916189d5f63cdb4bd7c039eec6e155812c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 1958355e5ddb. Setting up logs at ./log/docker/lightpush_node1_2024-09-06_09-40-02__cce3b76d-fef8-4773-b5ee-460f23bd0d4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 53638
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53638/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:53638/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.190.48/tcp/53639/p2p/16Uiu2HAmMegneR8aWDmn5ytqtM3kbC7xYsR3JEZbKyXk7xJCap4c","/ip4/172.18.190.48/tcp/53640/ws/p2p/16Uiu2HAmMegneR8aWDmn5ytqtM3kbC7xYsR3JEZbKyXk7xJCap4c"],"enrUri":"enr:-LO4QODOfIXZA1qIRLQjwlberoIDpxRwpofynr-urrS33YEebjbUIasPO73JhOfbWJP2Jww3GMGGi6GquaCfioFT4lEBgmlkgnY0gmlwhKwSvjCKbXVsdGlhZGRyc4wACgSsEr4wBtGI3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOFpVLwuAySvydSBJx7eDQzDLakhZMba8TsA7dNMA7GpYN0Y3CC0YeDdWRwgtGJhXdha3UyCA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53638/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.193.150/tcp/61220/p2p/16Uiu2HAm6kB5ve2Jn74gNQg7QhuevtWxoXTDaCCjrwMTQVFnBZ9t"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53638/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.181.252/tcp/41207/p2p/16Uiu2HAm1eN28s379YnAktCdM5dnyEDurrc4jyPeuB1k6oZGYqbg"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61219/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41206/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53638/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725615606770019840, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61219/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725615606770019840,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41206/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725615606770019840,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:215 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:53638/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1725615606887164928, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61219/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725615606887164928,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41206/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1725615606887164928,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id dbe375b212e7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 6c2084fa09c0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1958355e5ddb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.