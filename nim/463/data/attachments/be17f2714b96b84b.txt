[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_and_retrieve_duplicate_message with id: 2024-11-25_07-35-28__b1de8799-916d-48c0-ae34-9fcac7980af0
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-25_07-35-28__b1de8799-916d-48c0-ae34-9fcac7980af0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.60.230
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['65130', '65131', '65132', '65133', '65134']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 65130:65130 -p 65131:65131 -p 65132:65132 -p 65133:65133 -p 65134:65134 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=65132 --rest-port=65130 --tcp-port=65131 --discv5-udp-port=65133 --rest-address=0.0.0.0 --nat=extip:172.18.60.230 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c66ccffeebc58e05753c9c60d6a8eca82dd9ec0ca1f7be5becbcfbf855dee1ef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=65134 --metrics-logging=true --lightpush=true --relay=true
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container fa9a2e8e678e. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.60.230 waku c36ab5d716146720b6c6c9c6d0217d3d65c1511564fb43a5336ad520959a44d9
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c36ab5d71614. Setting up logs at ./log/docker/receiving_node1_2024-11-25_07-35-28__b1de8799-916d-48c0-ae34-9fcac7980af0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 65130
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65130/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65130/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.60.230/tcp/65131/p2p/16Uiu2HAkw7GS96iWBWofFMWtMfjdwagatQgZuQzhm3Lsg5xK4CbN","/ip4/172.18.60.230/tcp/65132/ws/p2p/16Uiu2HAkw7GS96iWBWofFMWtMfjdwagatQgZuQzhm3Lsg5xK4CbN"],"enrUri":"enr:-L24QHFlOhtUry97wEMiyCsiO4ZbmzYzcGCvhofNgMgAEnloXMvf9Rp0DjXsuQWrKspw7pCwtZN4G09zieXEmj6XVdwCgmlkgnY0gmlwhKwSPOaKbXVsdGlhZGRyc5YACASsEjzmBv5rAAoErBI85gb-bN0DgnJzhQADAQAAiXNlY3AyNTZrMaECGQBLyNcIBsEL2BlNc1rdh-5fKpL7Erq_xE9rgBKSUc2DdGNwgv5rg3VkcIL-bYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-25_07-35-28__b1de8799-916d-48c0-ae34-9fcac7980af0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.28.242
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['26021', '26022', '26023', '26024', '26025']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 26021:26021 -p 26022:26022 -p 26023:26023 -p 26024:26024 -p 26025:26025 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26023 --rest-port=26021 --tcp-port=26022 --discv5-udp-port=26024 --rest-address=0.0.0.0 --nat=extip:172.18.28.242 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aa79cadd3eeb32d9fbaba4eadb7ed41cfbc9ee41ccdbc6c45bc7ba69c69fb4a9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26025 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.28.242 waku 0fd4c35f9c2250765e54f6660f43f6f1d97fc9475e678e48fbde647e8188d80e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0fd4c35f9c22. Setting up logs at ./log/docker/receiving_node2_2024-11-25_07-35-28__b1de8799-916d-48c0-ae34-9fcac7980af0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 26021
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26021/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26021/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.28.242/tcp/26022/p2p/16Uiu2HAmHsqXhyhEmCTN9GT3ZvCb78D8UGDqzp4Gx59rNizHGwwC","/ip4/172.18.28.242/tcp/26023/ws/p2p/16Uiu2HAmHsqXhyhEmCTN9GT3ZvCb78D8UGDqzp4Gx59rNizHGwwC"],"enrUri":"enr:-L24QAI5sBvlkIKjLBLcmOhVuPDFOLeHu1s1FpnigP9ycd04TtNLuOg71tS2ZQTHqbTw4s7E8mJHSdIdcgJ8fgqBnPkCgmlkgnY0gmlwhKwSHPKKbXVsdGlhZGRyc5YACASsEhzyBmWmAAoErBIc8gZlp90DgnJzhQADAQAAiXNlY3AyNTZrMaEDTZUDDCkfxo2CYNxyl2YaaXRZkPsyWNSbsVnoU7LDMZeDdGNwgmWmg3VkcIJlqIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26021/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.60.230/tcp/65131/p2p/16Uiu2HAkw7GS96iWBWofFMWtMfjdwagatQgZuQzhm3Lsg5xK4CbN"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-25_07-35-28__b1de8799-916d-48c0-ae34-9fcac7980af0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.62.103
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['7488', '7489', '7490', '7491', '7492']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 7488:7488 -p 7489:7489 -p 7490:7490 -p 7491:7491 -p 7492:7492 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7490 --rest-port=7488 --tcp-port=7489 --discv5-udp-port=7491 --rest-address=0.0.0.0 --nat=extip:172.18.62.103 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e0fd8496e8d0dc4efc0502e0fc1e76ebedfc6fd1f1fd65242d27e17be40be332 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7492 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QHFlOhtUry97wEMiyCsiO4ZbmzYzcGCvhofNgMgAEnloXMvf9Rp0DjXsuQWrKspw7pCwtZN4G09zieXEmj6XVdwCgmlkgnY0gmlwhKwSPOaKbXVsdGlhZGRyc5YACASsEjzmBv5rAAoErBI85gb-bN0DgnJzhQADAQAAiXNlY3AyNTZrMaECGQBLyNcIBsEL2BlNc1rdh-5fKpL7Erq_xE9rgBKSUc2DdGNwgv5rg3VkcIL-bYV3YWt1Mgk --lightpushnode=/ip4/172.18.60.230/tcp/65131/p2p/16Uiu2HAkw7GS96iWBWofFMWtMfjdwagatQgZuQzhm3Lsg5xK4CbN --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.62.103 waku 4ced11f2752f85d5d26c6197a9cd73885833a209866838dfd350934d46fc7793
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 4ced11f2752f. Setting up logs at ./log/docker/lightpush_node1_2024-11-25_07-35-28__b1de8799-916d-48c0-ae34-9fcac7980af0__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 7488
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7488/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7488/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.62.103/tcp/7489/p2p/16Uiu2HAmN9CscVFAqpnwquPhvRM1mDi6SH9B8baXAKrn3eEcR6wv","/ip4/172.18.62.103/tcp/7490/ws/p2p/16Uiu2HAmN9CscVFAqpnwquPhvRM1mDi6SH9B8baXAKrn3eEcR6wv"],"enrUri":"enr:-L24QObpfwc3r0pcLEcz4U2ZHJurzDe-PoUmCM0d_JfyNqNyO_VHnJWzGIXMK02Hmdx9unqHkngZLJE84NyKDq8lqpgCgmlkgnY0gmlwhKwSPmeKbXVsdGlhZGRyc5YACASsEj5nBh1BAAoErBI-ZwYdQt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDjPOaxVp1-taWhW532jtoJSOXHL-6UEhwRdTFSSk7F3WDdGNwgh1Bg3VkcIIdQ4V3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7488/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.60.230/tcp/65131/p2p/16Uiu2HAkw7GS96iWBWofFMWtMfjdwagatQgZuQzhm3Lsg5xK4CbN"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7488/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.28.242/tcp/26022/p2p/16Uiu2HAmHsqXhyhEmCTN9GT3ZvCb78D8UGDqzp4Gx59rNizHGwwC"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:65130/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:26021/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7488/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520140391212544}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:65130/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1732520140391212544,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:26021/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1732520140391212544,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7488/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520140391212544}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:7488/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id c36ab5d71614
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 0fd4c35f9c22
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c36ab5d71614. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 4ced11f2752f
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 0fd4c35f9c22. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.