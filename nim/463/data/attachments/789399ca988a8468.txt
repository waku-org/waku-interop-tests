[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-11-25_07-33-56__c8ebc5df-7df2-4c4a-a677-d24006c27e4a
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-25_07-33-56__c8ebc5df-7df2-4c4a-a677-d24006c27e4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.225.213
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['39616', '39617', '39618', '39619', '39620']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 39616:39616 -p 39617:39617 -p 39618:39618 -p 39619:39619 -p 39620:39620 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39618 --rest-port=39616 --tcp-port=39617 --discv5-udp-port=39619 --rest-address=0.0.0.0 --nat=extip:172.18.225.213 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d39c75bcbed283d32d7bf1074e139b2bb7d90811efab9adc0870b62ca8fb5f1c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39620 --metrics-logging=true --lightpush=true --relay=true
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 988644bedd01. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.225.213 waku 70419c089c3830b7c5aba9037f9f0c5a96cdc549374cabd020d727123800394b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 70419c089c38. Setting up logs at ./log/docker/receiving_node1_2024-11-25_07-33-56__c8ebc5df-7df2-4c4a-a677-d24006c27e4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 39616
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39616/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39616/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.225.213/tcp/39617/p2p/16Uiu2HAkzdnigBCi57Zb4igR2ibsWh1BVTAMBasTn1MiGXcDjjw2","/ip4/172.18.225.213/tcp/39618/ws/p2p/16Uiu2HAkzdnigBCi57Zb4igR2ibsWh1BVTAMBasTn1MiGXcDjjw2"],"enrUri":"enr:-L24QDBblDRX7EmPnPVSQkfRUhfhc7MF3paDDy7g7xUfZFG8H7BfhybXKgG6pqlJV1Gj6ucAAcKuXxKsGpG9PK97EWMCgmlkgnY0gmlwhKwS4dWKbXVsdGlhZGRyc5YACASsEuHVBprBAAoErBLh1Qaawt0DgnJzhQADAQAAiXNlY3AyNTZrMaECTWUGSVjuQWFz80ayrmn8uS_EVfuGNw6DOImHdt4HolWDdGNwgprBg3VkcIKaw4V3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-25_07-33-56__c8ebc5df-7df2-4c4a-a677-d24006c27e4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.3.84
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['27885', '27886', '27887', '27888', '27889']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 27885:27885 -p 27886:27886 -p 27887:27887 -p 27888:27888 -p 27889:27889 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=27887 --rest-port=27885 --tcp-port=27886 --discv5-udp-port=27888 --rest-address=0.0.0.0 --nat=extip:172.18.3.84 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e4ab6e0ca6c3a948e9e4a6cba0dab9df7abbfed1c285de727a4ed231c14ab815 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=27889 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.3.84 waku 172c26b4851f844394898f43ade2135f1f60fee016a94c4b81535c696b833d3c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 172c26b4851f. Setting up logs at ./log/docker/receiving_node2_2024-11-25_07-33-56__c8ebc5df-7df2-4c4a-a677-d24006c27e4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 27885
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27885/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27885/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.3.84/tcp/27886/p2p/16Uiu2HAmRmbkmLiP2DGdQeacQxYsfye7wZr8JE6g2HSB8WdEUvis","/ip4/172.18.3.84/tcp/27887/ws/p2p/16Uiu2HAmRmbkmLiP2DGdQeacQxYsfye7wZr8JE6g2HSB8WdEUvis"],"enrUri":"enr:-L24QCkrRhBF0VFJOttEsPjew8ARHhabqy5MP63Xi3bK-J1QdgheThrBdh7EvR3ITKkVezvaCp2VtD8DlOMWf06V1U8CgmlkgnY0gmlwhKwSA1SKbXVsdGlhZGRyc5YACASsEgNUBmzuAAoErBIDVAZs790DgnJzhQADAQAAiXNlY3AyNTZrMaEDwtlyef3aZlRMJftgiPIIQiZIXVpYOEVZG7A9XlBuYziDdGNwgmzug3VkcIJs8IV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27885/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.225.213/tcp/39617/p2p/16Uiu2HAkzdnigBCi57Zb4igR2ibsWh1BVTAMBasTn1MiGXcDjjw2"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-25_07-33-56__c8ebc5df-7df2-4c4a-a677-d24006c27e4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.164.99
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['5294', '5295', '5296', '5297', '5298']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 5294:5294 -p 5295:5295 -p 5296:5296 -p 5297:5297 -p 5298:5298 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5296 --rest-port=5294 --tcp-port=5295 --discv5-udp-port=5297 --rest-address=0.0.0.0 --nat=extip:172.18.164.99 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a14ef3fdf2d9defa8caed1dd40daf03dbfa3bafa4fc1b9b3cdfc7cb3f2478fe0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5298 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QDBblDRX7EmPnPVSQkfRUhfhc7MF3paDDy7g7xUfZFG8H7BfhybXKgG6pqlJV1Gj6ucAAcKuXxKsGpG9PK97EWMCgmlkgnY0gmlwhKwS4dWKbXVsdGlhZGRyc5YACASsEuHVBprBAAoErBLh1Qaawt0DgnJzhQADAQAAiXNlY3AyNTZrMaECTWUGSVjuQWFz80ayrmn8uS_EVfuGNw6DOImHdt4HolWDdGNwgprBg3VkcIKaw4V3YWt1Mgk --lightpushnode=/ip4/172.18.225.213/tcp/39617/p2p/16Uiu2HAkzdnigBCi57Zb4igR2ibsWh1BVTAMBasTn1MiGXcDjjw2 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.164.99 waku 81542daa815508701ea12175ca13d683ca296b329a6b31c249065192717e7151
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 81542daa8155. Setting up logs at ./log/docker/lightpush_node1_2024-11-25_07-33-56__c8ebc5df-7df2-4c4a-a677-d24006c27e4a__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 5294
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5294/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5294/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.164.99/tcp/5295/p2p/16Uiu2HAkzgQt7bDrB2iqBomo6wgrT37fFGDDZp4nvwJ9zFnyf6JP","/ip4/172.18.164.99/tcp/5296/ws/p2p/16Uiu2HAkzgQt7bDrB2iqBomo6wgrT37fFGDDZp4nvwJ9zFnyf6JP"],"enrUri":"enr:-L24QMGUwmdTHsf1Gxp2n8zBL-YDuD6NKOE0oNBI6gSjH6gTbqGi8CiGGRO2qybWqhMh0t1ZTDRzZrkd1Z3nyg12T2ECgmlkgnY0gmlwhKwSpGOKbXVsdGlhZGRyc5YACASsEqRjBhSvAAoErBKkYwYUsN0DgnJzhQADAQAAiXNlY3AyNTZrMaECThETVAUHA3BNNnX5I9i67CZ55PBP-D7DSmnWY0A1MDSDdGNwghSvg3VkcIIUsYV3YWt1Mgg"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.225.213/tcp/39617/p2p/16Uiu2HAkzdnigBCi57Zb4igR2ibsWh1BVTAMBasTn1MiGXcDjjw2"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.3.84/tcp/27886/p2p/16Uiu2HAmRmbkmLiP2DGdQeacQxYsfye7wZr8JE6g2HSB8WdEUvis"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39616/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27885/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520048387689728}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:5294/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520048391683840}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:5294/lightpush/v1/message. Response content: b'Invalid message: Incorrect base64 string'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520048400076800}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:5294/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520048411024896}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:5294/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520048417331712}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:5294/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732520048420775424}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:5294/lightpush/v1/message. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 70419c089c38
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 172c26b4851f
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 70419c089c38. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 81542daa8155
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 172c26b4851f. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.