[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2024-12-04_04-08-24__dd5aa880-58d1-4bb5-b18b-70a670f19ae4
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-04_04-08-24__dd5aa880-58d1-4bb5-b18b-70a670f19ae4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-04_04-08-24__dd5aa880-58d1-4bb5-b18b-70a670f19ae4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-12-04_04-08-24__dd5aa880-58d1-4bb5-b18b-70a670f19ae4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:388 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.177.156
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['7335', '7336', '7337', '7338', '7339']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 7335:7335 -p 7336:7336 -p 7337:7337 -p 7338:7338 -p 7339:7339 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7337 --rest-port=7335 --tcp-port=7336 --discv5-udp-port=7338 --rest-address=0.0.0.0 --nat=extip:172.18.177.156 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=25f976cb436da1cff5d0b4c78a2b5725ff9c2fedf233b49fddb3367b0cffcefe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7339 --metrics-logging=true --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.177.156 waku fae6e4fec33cd93853f252a7a1bd06bf88435a095e1e3b31623c2c635e4be2e0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID fae6e4fec33c. Setting up logs at ./log/docker/node1_2024-12-04_04-08-24__dd5aa880-58d1-4bb5-b18b-70a670f19ae4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 7335
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7335/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7335/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.156/tcp/7336/p2p/16Uiu2HAm7YudWxeJKmTKPiPBfVD5SDgGKSryDzSmUPj4sjjeGC2N","/ip4/172.18.177.156/tcp/7337/ws/p2p/16Uiu2HAm7YudWxeJKmTKPiPBfVD5SDgGKSryDzSmUPj4sjjeGC2N"],"enrUri":"enr:-L24QOGKQ0UeT5Q4OZYyq1ywaa9AK8LF69WbrGK6zZznZt1oNvpxB-cLqL0gTLNcgzKr9V15LEH42yzf9ZcBq9fkc_ACgmlkgnY0gmlwhKwSsZyKbXVsdGlhZGRyc5YACASsErGcBhyoAAoErBKxnAYcqd0DgnJzhQADAQAAiXNlY3AyNTZrMaECtCa-TBoF7hpzFdj4q_BMclc-ARlCJ0O-ug-kbl7xc0ODdGNwghyog3VkcIIcqoV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.108.249
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['9945', '9946', '9947', '9948', '9949']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 9945:9945 -p 9946:9946 -p 9947:9947 -p 9948:9948 -p 9949:9949 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9947 --rest-port=9945 --tcp-port=9946 --discv5-udp-port=9948 --rest-address=0.0.0.0 --nat=extip:172.18.108.249 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1a491f4ba5b3b5e8b5990d03be8c1fcf71d2abe95eeaacdbbfc155d2ae7bb1fe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9949 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QOGKQ0UeT5Q4OZYyq1ywaa9AK8LF69WbrGK6zZznZt1oNvpxB-cLqL0gTLNcgzKr9V15LEH42yzf9ZcBq9fkc_ACgmlkgnY0gmlwhKwSsZyKbXVsdGlhZGRyc5YACASsErGcBhyoAAoErBKxnAYcqd0DgnJzhQADAQAAiXNlY3AyNTZrMaECtCa-TBoF7hpzFdj4q_BMclc-ARlCJ0O-ug-kbl7xc0ODdGNwghyog3VkcIIcqoV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.108.249 waku d725d9eb4d668078d51a1cb98d381764b3cfb84e8bd781ada3268184514f39a5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d725d9eb4d66. Setting up logs at ./log/docker/node2_2024-12-04_04-08-24__dd5aa880-58d1-4bb5-b18b-70a670f19ae4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 9945
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9945/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9945/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.108.249/tcp/9946/p2p/16Uiu2HAmE4ckVdPtF8DYpf6ZcfMqDa6YfPWC2TZc1jPUjtvbdkWH","/ip4/172.18.108.249/tcp/9947/ws/p2p/16Uiu2HAmE4ckVdPtF8DYpf6ZcfMqDa6YfPWC2TZc1jPUjtvbdkWH"],"enrUri":"enr:-L24QM_T7_LYL-Z6ZexPlpLQ_bHH_7vquaGeYDt8-NmGl7elIpx_P28GHKmQD37f4EpAcNTTeVc22ad-qX0U70PbS4wCgmlkgnY0gmlwhKwSbPmKbXVsdGlhZGRyc5YACASsEmz5BibaAAoErBJs-QYm290DgnJzhQADAQAAiXNlY3AyNTZrMaEDFOk0ByrXmua0-mtAYjtyYZAi7etOvOXluMKP5bwPpk6DdGNwgibag3VkcIIm3IV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.154.89
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['25613', '25614', '25615', '25616', '25617']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 25613:25613 -p 25614:25614 -p 25615:25615 -p 25616:25616 -p 25617:25617 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25615 --rest-port=25613 --tcp-port=25614 --discv5-udp-port=25616 --rest-address=0.0.0.0 --nat=extip:172.18.154.89 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d87babff4e0dfccadfb2f330c4beda9dbff037bca7cfe4f8f4b5f341ff7b5acf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25617 --metrics-logging=true --relay=false --storenode=/ip4/172.18.108.249/tcp/9946/p2p/16Uiu2HAmE4ckVdPtF8DYpf6ZcfMqDa6YfPWC2TZc1jPUjtvbdkWH --discv5-bootstrap-node=enr:-L24QM_T7_LYL-Z6ZexPlpLQ_bHH_7vquaGeYDt8-NmGl7elIpx_P28GHKmQD37f4EpAcNTTeVc22ad-qX0U70PbS4wCgmlkgnY0gmlwhKwSbPmKbXVsdGlhZGRyc5YACASsEmz5BibaAAoErBJs-QYm290DgnJzhQADAQAAiXNlY3AyNTZrMaEDFOk0ByrXmua0-mtAYjtyYZAi7etOvOXluMKP5bwPpk6DdGNwgibag3VkcIIm3IV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.154.89 waku 2d1562f6af018b849d8df251f7e2bd599ac87fce12a6696844e92afd2be17d84
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2d1562f6af01. Setting up logs at ./log/docker/node3_2024-12-04_04-08-24__dd5aa880-58d1-4bb5-b18b-70a670f19ae4__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 25613
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25613/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25613/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.154.89/tcp/25614/p2p/16Uiu2HAmVL5aZqkVYhhjsJ16reHpPES4EYuV9o5eZcDFixHR24S6","/ip4/172.18.154.89/tcp/25615/ws/p2p/16Uiu2HAmVL5aZqkVYhhjsJ16reHpPES4EYuV9o5eZcDFixHR24S6"],"enrUri":"enr:-L24QAZOtTUS4N58nYTi5ynhX7Ci27w3aep3v8B7mHRq3l-2QX_76sk2vW6mbgvnRpVSFxUD1F-lGt27qDHjsZx2BAACgmlkgnY0gmlwhKwSmlmKbXVsdGlhZGRyc5YACASsEppZBmQOAAoErBKaWQZkD90DgnJzhQADAQAAiXNlY3AyNTZrMaED976OAs3IQRzzKMx_2d5UY8j3MiI3TzExCavry_q6gwODdGNwgmQOg3VkcIJkEIV3YWt1MgA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:393 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7335/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9945/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7335/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.108.249/tcp/9946/p2p/16Uiu2HAmE4ckVdPtF8DYpf6ZcfMqDa6YfPWC2TZc1jPUjtvbdkWH","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9945/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.177.156/tcp/7336/p2p/16Uiu2HAm7YudWxeJKmTKPiPBfVD5SDgGKSryDzSmUPj4sjjeGC2N","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:398 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7335/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:403 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:25613/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"e2335382707e54a62cdb","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:407 Response for store when ephemeral = true is strPeer wakuorg/nwaku:latest couldn't find any messages. Actual response: {'requestId': 'e2335382707e54a62cdb', 'statusCode': 200, 'statusDesc': 'OK', 'messages': []}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:409 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id fae6e4fec33c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d725d9eb4d66
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container fae6e4fec33c. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 2d1562f6af01
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d725d9eb4d66. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.