2025-02-07 04:07:08.039 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:07:08.039 DEBUG [tests.conftest] Running test: test_store_lightpushed_message with id: 2025-02-07_04-07-08__20491c3c-9be4-48c2-b7f8-132fabe7a5ad
2025-02-07 04:07:08.040 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:07:08.040 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-07 04:07:08.047 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:07:08.047 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-07_04-07-08__20491c3c-9be4-48c2-b7f8-132fabe7a5ad__wakuorg_nwaku:latest.log
2025-02-07 04:07:08.047 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:07:08.047 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:07:08.049 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:07:08.049 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.134.236
2025-02-07 04:07:08.049 DEBUG [src.node.docker_mananger] Generated ports ['61645', '61646', '61647', '61648', '61649']
2025-02-07 04:07:08.049 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:07:08.049 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:07:08.050 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:07:08.050 DEBUG [src.node.docker_mananger] docker run -i -t -p 61645:61645 -p 61646:61646 -p 61647:61647 -p 61648:61648 -p 61649:61649 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61647 --rest-port=61645 --tcp-port=61646 --discv5-udp-port=61648 --rest-address=0.0.0.0 --nat=extip:172.18.134.236 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ed9d6d444b6c626efca7b0dd2bf36e69f0c6bb3d1ae71cadb3ce6cbdbbf97569 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61649 --metrics-logging=true --store=true --relay=true --lightpush=true
2025-02-07 04:07:08.306 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.134.236 waku dbdf73b5c8544c54be66440b29e229ddf8a2e6a088abc6a645a675aa6190a8cf
2025-02-07 04:07:08.358 DEBUG [src.node.docker_mananger] Container started with ID dbdf73b5c854. Setting up logs at ./log/docker/publishing_node1_2025-02-07_04-07-08__20491c3c-9be4-48c2-b7f8-132fabe7a5ad__wakuorg_nwaku:latest.log
2025-02-07 04:07:08.360 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61645
2025-02-07 04:07:08.361 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:07:08.841 ERROR [src.node.docker_mananger] Max retries reached for container fd93eb49e455. Exiting log stream.
2025-02-07 04:07:09.361 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61645/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:09.364 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:07:09.364 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:07:09.364 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61645/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:09.366 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.134.236/tcp/61646/p2p/16Uiu2HAmC6uhN6S6ywAH2tBn2sQADD1sw5bp1k7w7otPXPPzJbQP","/ip4/172.18.134.236/tcp/61647/ws/p2p/16Uiu2HAmC6uhN6S6ywAH2tBn2sQADD1sw5bp1k7w7otPXPPzJbQP"],"enrUri":"enr:-L24QLarj1PhvGL_S7bbxzREZ0o-MqSnZZv0UX_cPIFVn5waMhJL6NbMS4wQaPzRB7_EgaGWXw-8kGYYgKzGRwu2hB8CgmlkgnY0gmlwhKwShuyKbXVsdGlhZGRyc5YACASsEobsBvDOAAoErBKG7Abwz90DgnJzhQADAQAAiXNlY3AyNTZrMaEC98gm5dAIYMGY3QNQySDmJ-hv06KPjwh0LSkMIOm0NYyDdGNwgvDOg3VkcILw0IV3YWt1Mgs"}'
2025-02-07 04:07:09.366 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:07:09.373 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:07:09.373 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node2_2025-02-07_04-07-08__20491c3c-9be4-48c2-b7f8-132fabe7a5ad__wakuorg_nwaku:latest.log
2025-02-07 04:07:09.373 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:07:09.373 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:07:09.375 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:07:09.375 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.228.170
2025-02-07 04:07:09.375 DEBUG [src.node.docker_mananger] Generated ports ['32882', '32883', '32884', '32885', '32886']
2025-02-07 04:07:09.375 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:07:09.375 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:07:09.375 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:07:09.375 DEBUG [src.node.docker_mananger] docker run -i -t -p 32882:32882 -p 32883:32883 -p 32884:32884 -p 32885:32885 -p 32886:32886 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32884 --rest-port=32882 --tcp-port=32883 --discv5-udp-port=32885 --rest-address=0.0.0.0 --nat=extip:172.18.228.170 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0b7b84ddc34777c2d9fcd3c0a01dcd40cfaf73ffc1bed68de05b27cd3b004534 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32886 --metrics-logging=true --store=false --relay=true
2025-02-07 04:07:09.599 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.228.170 waku 0710e20a212f069e7cadade20f7b51e034d5f7f3f477fb8221e9acf34e856e15
2025-02-07 04:07:09.647 DEBUG [src.node.docker_mananger] Container started with ID 0710e20a212f. Setting up logs at ./log/docker/publishing_node2_2025-02-07_04-07-08__20491c3c-9be4-48c2-b7f8-132fabe7a5ad__wakuorg_nwaku:latest.log
2025-02-07 04:07:09.647 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 32882
2025-02-07 04:07:09.648 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:07:10.648 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32882/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:10.651 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:07:10.651 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:07:10.651 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:32882/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:10.653 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.228.170/tcp/32883/p2p/16Uiu2HAm2Tr8PrsJF6kvXXtadsGVNq66EraBoj3tutBsh9a7cxcU","/ip4/172.18.228.170/tcp/32884/ws/p2p/16Uiu2HAm2Tr8PrsJF6kvXXtadsGVNq66EraBoj3tutBsh9a7cxcU"],"enrUri":"enr:-L24QOjBzp9E224TDY9ojkybMZVZXq-AO2ML14teKTXLWVo8Mi_4RNh2zdhoMD0ufjdjFpIOeF6GUXbf-qGXWvtpelUCgmlkgnY0gmlwhKwS5KqKbXVsdGlhZGRyc5YACASsEuSqBoBzAAoErBLkqgaAdN0DgnJzhQADAQAAiXNlY3AyNTZrMaECaJBx3-XgqrpUW7itfihS9D53iHpr6hOXE1gt5nyTzj2DdGNwgoBzg3VkcIKAdYV3YWt1MgE"}'
2025-02-07 04:07:10.653 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:07:10.654 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32882/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.134.236/tcp/61646/p2p/16Uiu2HAmC6uhN6S6ywAH2tBn2sQADD1sw5bp1k7w7otPXPPzJbQP"]'
2025-02-07 04:07:10.694 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:07:10.703 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:07:10.703 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-07_04-07-08__20491c3c-9be4-48c2-b7f8-132fabe7a5ad__wakuorg_nwaku:latest.log
2025-02-07 04:07:10.703 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:07:10.704 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:07:10.705 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:07:10.705 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.222.106
2025-02-07 04:07:10.706 DEBUG [src.node.docker_mananger] Generated ports ['53120', '53121', '53122', '53123', '53124']
2025-02-07 04:07:10.706 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:07:10.706 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:07:10.706 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:07:10.706 DEBUG [src.node.docker_mananger] docker run -i -t -p 53120:53120 -p 53121:53121 -p 53122:53122 -p 53123:53123 -p 53124:53124 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=53122 --rest-port=53120 --tcp-port=53121 --discv5-udp-port=53123 --rest-address=0.0.0.0 --nat=extip:172.18.222.106 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e7a9cbefd2fed11ac8d68ff0ebf22eccd74be716f9feba7e942ddd088328daea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=53124 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QLarj1PhvGL_S7bbxzREZ0o-MqSnZZv0UX_cPIFVn5waMhJL6NbMS4wQaPzRB7_EgaGWXw-8kGYYgKzGRwu2hB8CgmlkgnY0gmlwhKwShuyKbXVsdGlhZGRyc5YACASsEobsBvDOAAoErBKG7Abwz90DgnJzhQADAQAAiXNlY3AyNTZrMaEC98gm5dAIYMGY3QNQySDmJ-hv06KPjwh0LSkMIOm0NYyDdGNwgvDOg3VkcILw0IV3YWt1Mgs --storenode=/ip4/172.18.134.236/tcp/61646/p2p/16Uiu2HAmC6uhN6S6ywAH2tBn2sQADD1sw5bp1k7w7otPXPPzJbQP --store=false --relay=false --lightpush=true --lightpushnode=/ip4/172.18.134.236/tcp/61646/p2p/16Uiu2HAmC6uhN6S6ywAH2tBn2sQADD1sw5bp1k7w7otPXPPzJbQP
2025-02-07 04:07:10.941 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.222.106 waku 31aa04edc231ad896366dfba4fa38e5ff1a15a4250986ebc47f545768013b51a
2025-02-07 04:07:10.992 DEBUG [src.node.docker_mananger] Container started with ID 31aa04edc231. Setting up logs at ./log/docker/store_node1_2025-02-07_04-07-08__20491c3c-9be4-48c2-b7f8-132fabe7a5ad__wakuorg_nwaku:latest.log
2025-02-07 04:07:10.992 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 53120
2025-02-07 04:07:10.992 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:07:11.993 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53120/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:11.996 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:07:11.996 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:07:11.996 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53120/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:11.999 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.222.106/tcp/53121/p2p/16Uiu2HAkupBpE5FKCPqyQFKL1e62uPjCpnGgSBvBfNQA25ENFYG7","/ip4/172.18.222.106/tcp/53122/ws/p2p/16Uiu2HAkupBpE5FKCPqyQFKL1e62uPjCpnGgSBvBfNQA25ENFYG7"],"enrUri":"enr:-L24QNp1xnNfnbKy0RPHiE9uJVm3AKkGs_AhKFa9iNz9BtYWTXGXgVbJwodYyG2gJl4V4dvQGCP8wtKcZBXYJTjZc2wCgmlkgnY0gmlwhKwS3mqKbXVsdGlhZGRyc5YACASsEt5qBs-BAAoErBLeagbPgt0DgnJzhQADAQAAiXNlY3AyNTZrMaECBcSDLEZWt9JamE2wh3Ujm45AmMzPAUzqqzRJGQQ-OuiDdGNwgs-Bg3VkcILPg4V3YWt1Mgg"}'
2025-02-07 04:07:11.999 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:07:11.999 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53120/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.134.236/tcp/61646/p2p/16Uiu2HAmC6uhN6S6ywAH2tBn2sQADD1sw5bp1k7w7otPXPPzJbQP"]'
2025-02-07 04:07:12.034 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:07:12.037 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53120/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.228.170/tcp/32883/p2p/16Uiu2HAm2Tr8PrsJF6kvXXtadsGVNq66EraBoj3tutBsh9a7cxcU"]'
2025-02-07 04:07:12.065 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:07:12.067 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61645/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-07 04:07:12.074 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:07:12.075 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:32882/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-07 04:07:12.082 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:07:12.083 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:53120/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738901232082910208}}'
2025-02-07 04:07:12.093 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:07:12.094 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:07:12.294 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-07 04:07:12.294 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61645/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:12.297 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb5de21958c696438c6dc3e491a3d0942da0137f06e7108aabd5d7bee6fd0965a"}]}'
2025-02-07 04:07:12.298 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-07 04:07:12.298 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:53120/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:07:12.305 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"5554e2e7c5f5d8195348","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0xb5de21958c696438c6dc3e491a3d0942da0137f06e7108aabd5d7bee6fd0965a"}]}'
2025-02-07 04:07:12.307 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:07:12.308 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:07:12.308 DEBUG [src.node.waku_node] Stopping container with id dbdf73b5c854
2025-02-07 04:07:12.898 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:07:12.898 DEBUG [src.node.waku_node] Stopping container with id 0710e20a212f
2025-02-07 04:07:13.710 ERROR [src.node.docker_mananger] Max retries reached for container dbdf73b5c854. Exiting log stream.
2025-02-07 04:07:14.409 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:07:14.409 DEBUG [src.node.waku_node] Stopping container with id 31aa04edc231
2025-02-07 04:07:15.220 ERROR [src.node.docker_mananger] Max retries reached for container 0710e20a212f. Exiting log stream.
2025-02-07 04:07:15.552 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:07:15.554 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:07:15.562 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:07:15.569 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:07:15.576 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
