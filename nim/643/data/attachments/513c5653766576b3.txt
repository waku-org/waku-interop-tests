2025-02-07 04:05:22.128 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:05:22.128 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-07_04-05-22__ca90f066-1264-4fb1-b300-011416db4081
2025-02-07 04:05:22.129 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:05:22.129 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-07 04:05:22.129 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-07 04:05:22.129 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-07 04:05:22.130 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-07 04:05:22.136 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:05:22.137 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-07_04-05-22__ca90f066-1264-4fb1-b300-011416db4081__wakuorg_nwaku:latest.log
2025-02-07 04:05:22.137 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:05:22.137 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:05:22.138 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:05:22.138 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.63.114
2025-02-07 04:05:22.138 DEBUG [src.node.docker_mananger] Generated ports ['54221', '54222', '54223', '54224', '54225']
2025-02-07 04:05:22.139 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:05:22.139 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:05:22.139 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:05:22.139 DEBUG [src.node.docker_mananger] docker run -i -t -p 54221:54221 -p 54222:54222 -p 54223:54223 -p 54224:54224 -p 54225:54225 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54223 --rest-port=54221 --tcp-port=54222 --discv5-udp-port=54224 --rest-address=0.0.0.0 --nat=extip:172.18.63.114 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a47cdb70bf34a5fa7db26c2d50561afefcf48cac9ccbada04dfaebf88577f69b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54225 --metrics-logging=true --lightpush=true --relay=true
2025-02-07 04:05:22.365 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.63.114 waku 6a22844752371c44bdca0f356a8eb69b27082e38c7a302aee63f19a01f2fb1be
2025-02-07 04:05:22.413 DEBUG [src.node.docker_mananger] Container started with ID 6a2284475237. Setting up logs at ./log/docker/receiving_node1_2025-02-07_04-05-22__ca90f066-1264-4fb1-b300-011416db4081__wakuorg_nwaku:latest.log
2025-02-07 04:05:22.414 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54221
2025-02-07 04:05:22.414 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:05:22.912 ERROR [src.node.docker_mananger] Max retries reached for container d059a1452587. Exiting log stream.
2025-02-07 04:05:23.415 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54221/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:23.418 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:05:23.418 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:05:23.418 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54221/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:23.420 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.63.114/tcp/54222/p2p/16Uiu2HAkyYZsmXzxecL1onT1eKTnZK6FcizRrJZAudM77Pw6kgoQ","/ip4/172.18.63.114/tcp/54223/ws/p2p/16Uiu2HAkyYZsmXzxecL1onT1eKTnZK6FcizRrJZAudM77Pw6kgoQ"],"enrUri":"enr:-L24QA_qSTxbRFdrVTeXA7RRgdZ1hDUvkGlyUpAzqeuGruCkdUG2lyzd5jn3DyqTVb58VXR6JuS1C10SNzcP37LXUUwCgmlkgnY0gmlwhKwSP3KKbXVsdGlhZGRyc5YACASsEj9yBtPOAAoErBI_cgbTz90DgnJzhQADAQAAiXNlY3AyNTZrMaECPTLpZLo6O7UDyIZt7QzSYNvLASPytnDtgRaHTl4A10eDdGNwgtPOg3VkcILT0IV3YWt1Mgk"}'
2025-02-07 04:05:23.421 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:05:23.427 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:05:23.427 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-07_04-05-22__ca90f066-1264-4fb1-b300-011416db4081__wakuorg_nwaku:latest.log
2025-02-07 04:05:23.427 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:05:23.427 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:05:23.429 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:05:23.429 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.39.252
2025-02-07 04:05:23.429 DEBUG [src.node.docker_mananger] Generated ports ['20970', '20971', '20972', '20973', '20974']
2025-02-07 04:05:23.429 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:05:23.429 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:05:23.429 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:05:23.430 DEBUG [src.node.docker_mananger] docker run -i -t -p 20970:20970 -p 20971:20971 -p 20972:20972 -p 20973:20973 -p 20974:20974 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20972 --rest-port=20970 --tcp-port=20971 --discv5-udp-port=20973 --rest-address=0.0.0.0 --nat=extip:172.18.39.252 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f9eb9ac1746af13ecbcba3bf6e0faf2eeafaee1a8da2a03d0cdf1e095e4ebbe1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20974 --metrics-logging=true --lightpush=false --relay=true
2025-02-07 04:05:23.649 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.39.252 waku 6b2c570b625f055f9f6e15a3b196fa193ee438d9416e0e2e8dbb819821ed552f
2025-02-07 04:05:23.699 DEBUG [src.node.docker_mananger] Container started with ID 6b2c570b625f. Setting up logs at ./log/docker/receiving_node2_2025-02-07_04-05-22__ca90f066-1264-4fb1-b300-011416db4081__wakuorg_nwaku:latest.log
2025-02-07 04:05:23.699 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20970
2025-02-07 04:05:23.699 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:05:24.700 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20970/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:24.702 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:05:24.703 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:05:24.703 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20970/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:24.705 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.39.252/tcp/20971/p2p/16Uiu2HAm5w5XmYLs7HJTcTrs9BoSCJUpQRNxQog9ZsW3ubNwoJyF","/ip4/172.18.39.252/tcp/20972/ws/p2p/16Uiu2HAm5w5XmYLs7HJTcTrs9BoSCJUpQRNxQog9ZsW3ubNwoJyF"],"enrUri":"enr:-L24QN4nZz_fD0JR75QPifrya9FWBxXiun9XLBRNRhq0591dSs6d-RNQNZd6mrmGbiGR_Y8XtPOR9lELGe8rAAet4boCgmlkgnY0gmlwhKwSJ_yKbXVsdGlhZGRyc5YACASsEif8BlHrAAoErBIn_AZR7N0DgnJzhQADAQAAiXNlY3AyNTZrMaECnB1XnpHSqQreS5esbjTudRJu__LQZXcNr0uvHj8ZeVKDdGNwglHrg3VkcIJR7YV3YWt1MgE"}'
2025-02-07 04:05:24.705 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:05:24.705 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20970/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.63.114/tcp/54222/p2p/16Uiu2HAkyYZsmXzxecL1onT1eKTnZK6FcizRrJZAudM77Pw6kgoQ"]'
2025-02-07 04:05:24.743 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:24.753 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:05:24.753 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-07_04-05-22__ca90f066-1264-4fb1-b300-011416db4081__wakuorg_nwaku:latest.log
2025-02-07 04:05:24.753 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:05:24.754 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:05:24.755 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:05:24.755 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.104.83
2025-02-07 04:05:24.755 DEBUG [src.node.docker_mananger] Generated ports ['37095', '37096', '37097', '37098', '37099']
2025-02-07 04:05:24.755 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:05:24.756 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:05:24.756 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:05:24.756 DEBUG [src.node.docker_mananger] docker run -i -t -p 37095:37095 -p 37096:37096 -p 37097:37097 -p 37098:37098 -p 37099:37099 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=37097 --rest-port=37095 --tcp-port=37096 --discv5-udp-port=37098 --rest-address=0.0.0.0 --nat=extip:172.18.104.83 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3b68fd1a1aaaefceaecfca2f67ddbecb32b44151be19d81d4bced6bffff9ae10 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=37099 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QA_qSTxbRFdrVTeXA7RRgdZ1hDUvkGlyUpAzqeuGruCkdUG2lyzd5jn3DyqTVb58VXR6JuS1C10SNzcP37LXUUwCgmlkgnY0gmlwhKwSP3KKbXVsdGlhZGRyc5YACASsEj9yBtPOAAoErBI_cgbTz90DgnJzhQADAQAAiXNlY3AyNTZrMaECPTLpZLo6O7UDyIZt7QzSYNvLASPytnDtgRaHTl4A10eDdGNwgtPOg3VkcILT0IV3YWt1Mgk --lightpushnode=/ip4/172.18.63.114/tcp/54222/p2p/16Uiu2HAkyYZsmXzxecL1onT1eKTnZK6FcizRrJZAudM77Pw6kgoQ --lightpush=true --relay=false
2025-02-07 04:05:24.985 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.104.83 waku a166b10b3f716c9f5aecb183482b2c2190617ad93993ac60670035f3080ebd72
2025-02-07 04:05:25.036 DEBUG [src.node.docker_mananger] Container started with ID a166b10b3f71. Setting up logs at ./log/docker/lightpush_node1_2025-02-07_04-05-22__ca90f066-1264-4fb1-b300-011416db4081__wakuorg_nwaku:latest.log
2025-02-07 04:05:25.036 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 37095
2025-02-07 04:05:25.036 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:05:26.037 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37095/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:26.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:05:26.041 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:05:26.041 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37095/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:26.043 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.104.83/tcp/37096/p2p/16Uiu2HAmB82PQwK9uvwJR1G4CvenoP8xuLFUB7pSXNwqTWA4FTgs","/ip4/172.18.104.83/tcp/37097/ws/p2p/16Uiu2HAmB82PQwK9uvwJR1G4CvenoP8xuLFUB7pSXNwqTWA4FTgs"],"enrUri":"enr:-L24QAfpSGqyAQnNNaezTmR_N063eWH-m-OcrF-CE6M39pNQelFENjvYZN2YPQ87bV4hs0dTUgdKBYW8VNfmZtsK-mQCgmlkgnY0gmlwhKwSaFOKbXVsdGlhZGRyc5YACASsEmhTBpDoAAoErBJoUwaQ6d0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6TWcXVz3iDr8nFUmwj3S0IlUTdK0hGbD_2RGsKozHPCDdGNwgpDog3VkcIKQ6oV3YWt1Mgg"}'
2025-02-07 04:05:26.044 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:05:26.044 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37095/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.63.114/tcp/54222/p2p/16Uiu2HAkyYZsmXzxecL1onT1eKTnZK6FcizRrJZAudM77Pw6kgoQ"]'
2025-02-07 04:05:26.083 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:26.084 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37095/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.39.252/tcp/20971/p2p/16Uiu2HAm5w5XmYLs7HJTcTrs9BoSCJUpQRNxQog9ZsW3ubNwoJyF"]'
2025-02-07 04:05:26.111 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:26.112 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54221/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:05:26.120 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:26.120 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20970/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:05:26.128 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:26.128 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37095/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1738901126128908032}}'
2025-02-07 04:05:26.138 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:26.139 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-07 04:05:26.639 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54221/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:26.642 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901126128908032,"ephemeral":false}]'
2025-02-07 04:05:26.642 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-07 04:05:31.642 DEBUG [src.steps.metrics] Checking metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.63.114/tcp/54222"} has 1
2025-02-07 04:05:31.646 DEBUG [src.steps.metrics] Found metric: waku_service_peers{protocol="/vac/waku/lightpush/2.0.0-beta1",peerId="/ip4/172.18.63.114/tcp/54222"} with value 1.0
2025-02-07 04:05:31.647 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-07 04:05:31.649 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-07 04:05:31.650 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-07 04:05:31.652 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-07 04:05:31.653 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-07 04:05:31.656 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-07 04:05:31.656 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-07 04:05:31.659 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-07 04:05:31.659 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-07 04:05:31.663 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-07 04:05:31.663 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-07 04:05:31.666 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-07 04:05:31.666 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-07 04:05:31.669 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-07 04:05:31.669 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-07 04:05:31.672 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-07 04:05:31.673 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-07 04:05:31.676 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-07 04:05:31.677 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:05:31.678 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:05:31.678 DEBUG [src.node.waku_node] Stopping container with id 6a2284475237
2025-02-07 04:05:33.208 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:05:33.208 DEBUG [src.node.waku_node] Stopping container with id 6b2c570b625f
2025-02-07 04:05:34.022 ERROR [src.node.docker_mananger] Max retries reached for container 6a2284475237. Exiting log stream.
2025-02-07 04:05:34.669 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:05:34.669 DEBUG [src.node.waku_node] Stopping container with id a166b10b3f71
2025-02-07 04:05:35.482 ERROR [src.node.docker_mananger] Max retries reached for container 6b2c570b625f. Exiting log stream.
2025-02-07 04:05:35.974 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:05:35.976 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:05:35.983 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:05:35.992 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:05:35.999 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
