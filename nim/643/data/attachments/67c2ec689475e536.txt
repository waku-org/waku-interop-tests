2025-02-07 04:04:16.408 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:04:16.409 DEBUG [tests.conftest] Running test: test_cursor_pointing_to_deleted_message with id: 2025-02-07_04-04-16__4e83f7c5-4c2a-4085-85cf-80e9b277b696
2025-02-07 04:04:16.409 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:04:16.409 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-07 04:04:16.410 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-07 04:04:16.416 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:04:16.416 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-07_04-04-16__4e83f7c5-4c2a-4085-85cf-80e9b277b696__wakuorg_nwaku:latest.log
2025-02-07 04:04:16.416 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:04:16.416 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:04:16.418 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:04:16.418 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.238.22
2025-02-07 04:04:16.418 DEBUG [src.node.docker_mananger] Generated ports ['63913', '63914', '63915', '63916', '63917']
2025-02-07 04:04:16.418 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:04:16.418 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:04:16.418 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:04:16.418 DEBUG [src.node.docker_mananger] docker run -i -t -p 63913:63913 -p 63914:63914 -p 63915:63915 -p 63916:63916 -p 63917:63917 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63915 --rest-port=63913 --tcp-port=63914 --discv5-udp-port=63916 --rest-address=0.0.0.0 --nat=extip:172.18.238.22 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b9fbc6caea8b9fbf2a9e5ebda4f8fcf8611abbdcaa23b38f3ef928a26bb3fdae --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63917 --metrics-logging=true --store=true --relay=true
2025-02-07 04:04:16.653 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.238.22 waku 2c13568ed38817646370f43694fbf73cbc119411edad0290d143b9fefc635059
2025-02-07 04:04:16.702 DEBUG [src.node.docker_mananger] Container started with ID 2c13568ed388. Setting up logs at ./log/docker/publishing_node1_2025-02-07_04-04-16__4e83f7c5-4c2a-4085-85cf-80e9b277b696__wakuorg_nwaku:latest.log
2025-02-07 04:04:16.704 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 63913
2025-02-07 04:04:16.704 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:04:17.210 ERROR [src.node.docker_mananger] Max retries reached for container dbcdffa35a8b. Exiting log stream.
2025-02-07 04:04:17.705 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63913/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:17.708 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:04:17.709 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:04:17.709 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63913/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:17.711 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.238.22/tcp/63914/p2p/16Uiu2HAmGEn3HnnaQjriWo2sVEQozMnbnnLmt31GkNbZw4w7kiiu","/ip4/172.18.238.22/tcp/63915/ws/p2p/16Uiu2HAmGEn3HnnaQjriWo2sVEQozMnbnnLmt31GkNbZw4w7kiiu"],"enrUri":"enr:-L24QIgSiMy_8vC3noN0mCMtjtmtg7Sx32rFyHpmm48yQQGOPYgCDyOjFRFk__tUc3axktsczAExjPj4nAMEc8_Yib0CgmlkgnY0gmlwhKwS7haKbXVsdGlhZGRyc5YACASsEu4WBvmqAAoErBLuFgb5q90DgnJzhQADAQAAiXNlY3AyNTZrMaEDNTrjkdv9BGP7VJySqjRxk6LHnqEA1L2Fzt3AYTlqYNqDdGNwgvmqg3VkcIL5rIV3YWt1MgM"}'
2025-02-07 04:04:17.711 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:04:17.718 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:04:17.718 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-07_04-04-16__4e83f7c5-4c2a-4085-85cf-80e9b277b696__wakuorg_nwaku:latest.log
2025-02-07 04:04:17.718 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:04:17.718 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:04:17.719 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:04:17.719 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.157.118
2025-02-07 04:04:17.720 DEBUG [src.node.docker_mananger] Generated ports ['55832', '55833', '55834', '55835', '55836']
2025-02-07 04:04:17.720 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:04:17.720 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:04:17.720 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:04:17.720 DEBUG [src.node.docker_mananger] docker run -i -t -p 55832:55832 -p 55833:55833 -p 55834:55834 -p 55835:55835 -p 55836:55836 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55834 --rest-port=55832 --tcp-port=55833 --discv5-udp-port=55835 --rest-address=0.0.0.0 --nat=extip:172.18.157.118 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d9722e60effba3d83f1f8aac0fb69f9c56c3eebbd67f1663ad6e80da57e9d3f0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55836 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QIgSiMy_8vC3noN0mCMtjtmtg7Sx32rFyHpmm48yQQGOPYgCDyOjFRFk__tUc3axktsczAExjPj4nAMEc8_Yib0CgmlkgnY0gmlwhKwS7haKbXVsdGlhZGRyc5YACASsEu4WBvmqAAoErBLuFgb5q90DgnJzhQADAQAAiXNlY3AyNTZrMaEDNTrjkdv9BGP7VJySqjRxk6LHnqEA1L2Fzt3AYTlqYNqDdGNwgvmqg3VkcIL5rIV3YWt1MgM --storenode=/ip4/172.18.238.22/tcp/63914/p2p/16Uiu2HAmGEn3HnnaQjriWo2sVEQozMnbnnLmt31GkNbZw4w7kiiu --store=true --relay=true
2025-02-07 04:04:17.946 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.157.118 waku b7c9e67a289749f4a044f518ec728abc746c727c73cb79d2bcad52dd87fb983a
2025-02-07 04:04:17.995 DEBUG [src.node.docker_mananger] Container started with ID b7c9e67a2897. Setting up logs at ./log/docker/store_node1_2025-02-07_04-04-16__4e83f7c5-4c2a-4085-85cf-80e9b277b696__wakuorg_nwaku:latest.log
2025-02-07 04:04:17.996 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55832
2025-02-07 04:04:17.997 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:04:18.997 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55832/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:19.000 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:04:19.000 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:04:19.000 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55832/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:19.002 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.157.118/tcp/55833/p2p/16Uiu2HAm3N7Z7nEFiGv7Gof5uzeQjMosNxQJTKLnuoy4uGSCEjeN","/ip4/172.18.157.118/tcp/55834/ws/p2p/16Uiu2HAm3N7Z7nEFiGv7Gof5uzeQjMosNxQJTKLnuoy4uGSCEjeN"],"enrUri":"enr:-L24QFvaqyO8_U83dv5eyxOC2xbq6QhGsfIKqzX4hdeobeM7RImtYUKYJG0LE2O1VupfNxjcka0n8NDGBJBJmYq85IkCgmlkgnY0gmlwhKwSnXaKbXVsdGlhZGRyc5YACASsEp12BtoZAAoErBKddgbaGt0DgnJzhQADAQAAiXNlY3AyNTZrMaECdfQW4_knvqg5FJN9WWn5y1orEAVl4nnJZAzedO-Gy3eDdGNwgtoZg3VkcILaG4V3YWt1MgM"}'
2025-02-07 04:04:19.002 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:04:19.003 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55832/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.238.22/tcp/63914/p2p/16Uiu2HAmGEn3HnnaQjriWo2sVEQozMnbnnLmt31GkNbZw4w7kiiu"]'
2025-02-07 04:04:19.005 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.006 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-07 04:04:19.008 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.008 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55832/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-07 04:04:19.010 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.011 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:19.012 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8w", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:19.018 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.019 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:19.220 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:19.220 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8x", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:19.226 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.226 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:19.427 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:19.428 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8y", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:19.433 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.434 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:19.634 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:19.634 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8z", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:19.641 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.641 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:19.842 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:19.842 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV80", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:19.848 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:19.848 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:20.048 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:20.049 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV81", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:20.058 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:20.058 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:20.259 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:20.260 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV82", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:20.266 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:20.266 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:20.468 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:20.468 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV83", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:20.475 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:20.475 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:20.676 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:20.676 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV84", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:20.681 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:20.682 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:20.883 DEBUG [src.steps.store] Relaying message
2025-02-07 04:04:20.883 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:63913/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV85", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:20.888 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:20.889 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:04:21.090 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:63913/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x28ae13b774ba9e12b761a5ff87b5ceb9379fc4e2c58d482d2a89276cb9e22fde&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:21.093 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:63913/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x28ae13b774ba9e12b761a5ff87b5ceb9379fc4e2c58d482d2a89276cb9e22fde&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found'
2025-02-07 04:04:21.093 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55832/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x28ae13b774ba9e12b761a5ff87b5ceb9379fc4e2c58d482d2a89276cb9e22fde&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:21.096 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:55832/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=0x28ae13b774ba9e12b761a5ff87b5ceb9379fc4e2c58d482d2a89276cb9e22fde&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found'
2025-02-07 04:04:21.098 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:04:21.099 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:04:21.099 DEBUG [src.node.waku_node] Stopping container with id 2c13568ed388
2025-02-07 04:04:22.238 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:22.238 DEBUG [src.node.waku_node] Stopping container with id b7c9e67a2897
2025-02-07 04:04:23.072 ERROR [src.node.docker_mananger] Max retries reached for container 2c13568ed388. Exiting log stream.
2025-02-07 04:04:23.722 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:23.724 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:04:23.736 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:04:23.742 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
