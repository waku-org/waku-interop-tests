2025-02-07 04:03:09.566 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:03:09.566 DEBUG [tests.conftest] Running test: test_msg_stored_when_ephemeral_false with id: 2025-02-07_04-03-09__047af45f-62b0-4819-9c5a-57bd5a57e8a3
2025-02-07 04:03:09.567 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:03:09.567 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-07 04:03:09.567 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-07 04:03:09.573 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:09.573 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-07_04-03-09__047af45f-62b0-4819-9c5a-57bd5a57e8a3__wakuorg_nwaku:latest.log
2025-02-07 04:03:09.579 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:09.579 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-07_04-03-09__047af45f-62b0-4819-9c5a-57bd5a57e8a3__wakuorg_nwaku:latest.log
2025-02-07 04:03:09.584 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:09.584 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node3_2025-02-07_04-03-09__047af45f-62b0-4819-9c5a-57bd5a57e8a3__wakuorg_nwaku:latest.log
2025-02-07 04:03:09.584 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-07 04:03:09.585 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-07 04:03:09.585 DEBUG [tests.e2e.test_e2e] Start 3 nodes
2025-02-07 04:03:09.586 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:09.586 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:09.587 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:09.587 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.154.56
2025-02-07 04:03:09.587 DEBUG [src.node.docker_mananger] Generated ports ['43603', '43604', '43605', '43606', '43607']
2025-02-07 04:03:09.587 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:09.588 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:09.588 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:09.588 DEBUG [src.node.docker_mananger] docker run -i -t -p 43603:43603 -p 43604:43604 -p 43605:43605 -p 43606:43606 -p 43607:43607 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43605 --rest-port=43603 --tcp-port=43604 --discv5-udp-port=43606 --rest-address=0.0.0.0 --nat=extip:172.18.154.56 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ccbcaa29fee70c9ca9a5f6fe0d1c3cb996ddeab4c3cdedc33ef9ebc78ca7c7e7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43607 --metrics-logging=true --relay=true --store=true
2025-02-07 04:03:09.825 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.154.56 waku fb0e7eaaf7e56edce46b1ad1f4ace51e783e789c680c8cdde394f2a4886dab30
2025-02-07 04:03:09.880 DEBUG [src.node.docker_mananger] Container started with ID fb0e7eaaf7e5. Setting up logs at ./log/docker/node1_2025-02-07_04-03-09__047af45f-62b0-4819-9c5a-57bd5a57e8a3__wakuorg_nwaku:latest.log
2025-02-07 04:03:09.882 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 43603
2025-02-07 04:03:09.882 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:10.350 ERROR [src.node.docker_mananger] Max retries reached for container 263de3a7e9ce. Exiting log stream.
2025-02-07 04:03:10.883 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43603/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:10.885 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:10.886 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:10.886 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43603/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:10.888 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.154.56/tcp/43604/p2p/16Uiu2HAm2RjdgR8mUPKtz5XHVNeUsZWR5p62LkDDZpTUKngRbpgq","/ip4/172.18.154.56/tcp/43605/ws/p2p/16Uiu2HAm2RjdgR8mUPKtz5XHVNeUsZWR5p62LkDDZpTUKngRbpgq"],"enrUri":"enr:-L24QJSafyMjnIO570KU4lvo9diery_aTJlJQwZjI8lre8jfZDSfxPpySXxvCZ6mM3dg_KdJMM58MGfOLwonrtAJEi0CgmlkgnY0gmlwhKwSmjiKbXVsdGlhZGRyc5YACASsEpo4BqpUAAoErBKaOAaqVd0DgnJzhQADAQAAiXNlY3AyNTZrMaECaAXwbyWwDRgQy19xFvvLfBHv5ljFgs5CILIzv-WwwhKDdGNwgqpUg3VkcIKqVoV3YWt1MgM"}'
2025-02-07 04:03:10.888 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:10.888 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:10.888 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:10.890 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:10.890 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.211.148
2025-02-07 04:03:10.890 DEBUG [src.node.docker_mananger] Generated ports ['26916', '26917', '26918', '26919', '26920']
2025-02-07 04:03:10.890 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:10.890 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:10.890 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:10.890 DEBUG [src.node.docker_mananger] docker run -i -t -p 26916:26916 -p 26917:26917 -p 26918:26918 -p 26919:26919 -p 26920:26920 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26918 --rest-port=26916 --tcp-port=26917 --discv5-udp-port=26919 --rest-address=0.0.0.0 --nat=extip:172.18.211.148 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dba3c8cb7eb34fd64aca767e621d21ed91b7fbb4416826fabfe4463c9f85e78f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26920 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-L24QJSafyMjnIO570KU4lvo9diery_aTJlJQwZjI8lre8jfZDSfxPpySXxvCZ6mM3dg_KdJMM58MGfOLwonrtAJEi0CgmlkgnY0gmlwhKwSmjiKbXVsdGlhZGRyc5YACASsEpo4BqpUAAoErBKaOAaqVd0DgnJzhQADAQAAiXNlY3AyNTZrMaECaAXwbyWwDRgQy19xFvvLfBHv5ljFgs5CILIzv-WwwhKDdGNwgqpUg3VkcIKqVoV3YWt1MgM
2025-02-07 04:03:11.109 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.211.148 waku 5a3876888603dccf8a94eed13558d781ceb57ebda5e2623564574bd60a51ce14
2025-02-07 04:03:11.158 DEBUG [src.node.docker_mananger] Container started with ID 5a3876888603. Setting up logs at ./log/docker/node2_2025-02-07_04-03-09__047af45f-62b0-4819-9c5a-57bd5a57e8a3__wakuorg_nwaku:latest.log
2025-02-07 04:03:11.159 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 26916
2025-02-07 04:03:11.160 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:12.160 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26916/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:12.163 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:12.164 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:12.164 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26916/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:12.167 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.211.148/tcp/26917/p2p/16Uiu2HAmDmR1c9UKiFb11bAghiVSTqqKczb6zG3s43CN7ZJ1oDVw","/ip4/172.18.211.148/tcp/26918/ws/p2p/16Uiu2HAmDmR1c9UKiFb11bAghiVSTqqKczb6zG3s43CN7ZJ1oDVw"],"enrUri":"enr:-L24QAzMnsuDwEaiNlo9_-pz4jKJz7Sff0v1NFa-8X_vLwPDf6bv3qn44pfv-pBR_2Ow5DZ1Ln33O1qwO20jnYoFNK8CgmlkgnY0gmlwhKwS05SKbXVsdGlhZGRyc5YACASsEtOUBmklAAoErBLTlAZpJt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDEIEOPygGZg2iWmEG5PJpM95wTlU1wAdHdUuBgtwrwQ6DdGNwgmklg3VkcIJpJ4V3YWt1MgM"}'
2025-02-07 04:03:12.168 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:12.169 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:12.169 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:12.172 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:12.173 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.152.241
2025-02-07 04:03:12.174 DEBUG [src.node.docker_mananger] Generated ports ['3495', '3496', '3497', '3498', '3499']
2025-02-07 04:03:12.175 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:12.176 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:12.177 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:12.177 DEBUG [src.node.docker_mananger] docker run -i -t -p 3495:3495 -p 3496:3496 -p 3497:3497 -p 3498:3498 -p 3499:3499 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3497 --rest-port=3495 --tcp-port=3496 --discv5-udp-port=3498 --rest-address=0.0.0.0 --nat=extip:172.18.152.241 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2dba4bb87eaaada4abbd63808fb245aced33be5f594b59a50dead9af0aaed4a3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3499 --metrics-logging=true --relay=false --storenode=/ip4/172.18.211.148/tcp/26917/p2p/16Uiu2HAmDmR1c9UKiFb11bAghiVSTqqKczb6zG3s43CN7ZJ1oDVw --discv5-bootstrap-node=enr:-L24QAzMnsuDwEaiNlo9_-pz4jKJz7Sff0v1NFa-8X_vLwPDf6bv3qn44pfv-pBR_2Ow5DZ1Ln33O1qwO20jnYoFNK8CgmlkgnY0gmlwhKwS05SKbXVsdGlhZGRyc5YACASsEtOUBmklAAoErBLTlAZpJt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDEIEOPygGZg2iWmEG5PJpM95wTlU1wAdHdUuBgtwrwQ6DdGNwgmklg3VkcIJpJ4V3YWt1MgM
2025-02-07 04:03:12.450 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.152.241 waku e9a9fec783137ca2bf65d1d8d6a51a07c5521a1c98be355858f89901590c4746
2025-02-07 04:03:12.499 DEBUG [src.node.docker_mananger] Container started with ID e9a9fec78313. Setting up logs at ./log/docker/node3_2025-02-07_04-03-09__047af45f-62b0-4819-9c5a-57bd5a57e8a3__wakuorg_nwaku:latest.log
2025-02-07 04:03:12.499 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3495
2025-02-07 04:03:12.499 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:13.500 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3495/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:13.503 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:13.503 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:13.503 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3495/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:13.505 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.152.241/tcp/3496/p2p/16Uiu2HAmVTJhHrADsX2f5DkGSbnx97T2aqQ4nXKPNsPMDvUwdPD7","/ip4/172.18.152.241/tcp/3497/ws/p2p/16Uiu2HAmVTJhHrADsX2f5DkGSbnx97T2aqQ4nXKPNsPMDvUwdPD7"],"enrUri":"enr:-L24QHPFR58-ixboIWQSDei5QBVIzniGFtSTUTnIZ7fZuTnDT3gzWeWEhWg5uVUnt7sL3etsuSjR4jbQGTm72CNCDCUCgmlkgnY0gmlwhKwSmPGKbXVsdGlhZGRyc5YACASsEpjxBg2oAAoErBKY8QYNqd0DgnJzhQADAQAAiXNlY3AyNTZrMaED-ZhzXHJA14CLqge5BwbzRpttAsv4fdJ0TDGZ1WoiY_aDdGNwgg2og3VkcIINqoV3YWt1MgA"}'
2025-02-07 04:03:13.505 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:13.506 DEBUG [tests.e2e.test_e2e] Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
2025-02-07 04:03:13.506 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43603/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:03:13.510 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:13.510 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26916/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:03:13.516 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:13.517 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43603/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:13.520 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.211.148/tcp/26917/p2p/16Uiu2HAmDmR1c9UKiFb11bAghiVSTqqKczb6zG3s43CN7ZJ1oDVw","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
2025-02-07 04:03:13.521 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26916/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:13.523 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.18.154.56/tcp/43604/p2p/16Uiu2HAm2RjdgR8mUPKtz5XHVNeUsZWR5p62LkDDZpTUKngRbpgq","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/store-query/3.0.0","connected":true},{"protocol":"/vac/waku/store/2.0.0-beta4","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
2025-02-07 04:03:13.523 DEBUG [src.libs.common] Sleeping for 30 seconds
2025-02-07 04:03:43.524 DEBUG [tests.e2e.test_e2e] Node1 publish message with ephemeral = false
2025-02-07 04:03:43.524 DEBUG [src.steps.store] Relaying message
2025-02-07 04:03:43.525 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43603/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
2025-02-07 04:03:43.531 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:43.531 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-07 04:03:43.731 DEBUG [src.libs.common] Sleeping for 3 seconds
2025-02-07 04:03:46.732 DEBUG [tests.e2e.test_e2e] Check if message is stored 
2025-02-07 04:03:46.732 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-07 04:03:46.733 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3495/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:46.776 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"c8a669239f33544d69db","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x22513defd498eae4f4422bbdbeb1840217551c753223ab3be0a7789f940be0b4"}]}'
2025-02-07 04:03:46.783 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:03:46.784 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:03:46.784 DEBUG [src.node.waku_node] Stopping container with id fb0e7eaaf7e5
2025-02-07 04:03:47.696 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:03:47.696 DEBUG [src.node.waku_node] Stopping container with id 5a3876888603
2025-02-07 04:03:48.469 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:03:48.470 DEBUG [src.node.waku_node] Stopping container with id e9a9fec78313
2025-02-07 04:03:48.511 ERROR [src.node.docker_mananger] Max retries reached for container fb0e7eaaf7e5. Exiting log stream.
2025-02-07 04:03:48.990 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:03:48.992 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:03:49.001 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:03:49.012 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:03:49.016 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
