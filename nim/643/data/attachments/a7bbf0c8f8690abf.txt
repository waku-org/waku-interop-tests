2025-02-07 04:04:08.405 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:04:08.405 DEBUG [tests.conftest] Running test: test_relay_subscribe_to_already_existing_pubsub_topic with id: 2025-02-07_04-04-08__b197b1fd-57fb-4d37-81d3-47b141558001
2025-02-07 04:04:08.405 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:04:08.405 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-07 04:04:08.406 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-07 04:04:08.413 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:04:08.413 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-07_04-04-08__b197b1fd-57fb-4d37-81d3-47b141558001__wakuorg_nwaku:latest.log
2025-02-07 04:04:08.413 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:04:08.413 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:04:08.415 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:04:08.415 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.97.184
2025-02-07 04:04:08.415 DEBUG [src.node.docker_mananger] Generated ports ['34965', '34966', '34967', '34968', '34969']
2025-02-07 04:04:08.415 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:04:08.416 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:04:08.416 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:04:08.416 DEBUG [src.node.docker_mananger] docker run -i -t -p 34965:34965 -p 34966:34966 -p 34967:34967 -p 34968:34968 -p 34969:34969 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34967 --rest-port=34965 --tcp-port=34966 --discv5-udp-port=34968 --rest-address=0.0.0.0 --nat=extip:172.18.97.184 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a530f23dbb11c5235aebdbb25ce3c8dc5f52dea1adbee0c5c2ceb6d5d1c12e2d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34969 --metrics-logging=true --relay=true
2025-02-07 04:04:08.655 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.97.184 waku dc2d78058191e8165eaca7a6a2038fe3947da56b3f9f5dd3c81b49b51feba0ac
2025-02-07 04:04:08.708 DEBUG [src.node.docker_mananger] Container started with ID dc2d78058191. Setting up logs at ./log/docker/node1_2025-02-07_04-04-08__b197b1fd-57fb-4d37-81d3-47b141558001__wakuorg_nwaku:latest.log
2025-02-07 04:04:08.709 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 34965
2025-02-07 04:04:08.712 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:04:09.196 ERROR [src.node.docker_mananger] Max retries reached for container adb3f2a9921e. Exiting log stream.
2025-02-07 04:04:09.712 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34965/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:09.716 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:04:09.716 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:04:09.716 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34965/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:09.718 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.184/tcp/34966/p2p/16Uiu2HAmVjQP2F5JyyhXJK4zQhXLfiEPM2vquekohEjnVKv2qrnC","/ip4/172.18.97.184/tcp/34967/ws/p2p/16Uiu2HAmVjQP2F5JyyhXJK4zQhXLfiEPM2vquekohEjnVKv2qrnC"],"enrUri":"enr:-L24QHg4vlcMa4uKfXbOKW4KiZVVDK5T_CWeyb6Y7qHu4nGNQjia0XG545KZZAsejNfL7VxbOVub4DkWNHVSDJztv2MCgmlkgnY0gmlwhKwSYbiKbXVsdGlhZGRyc5YACASsEmG4BoiWAAoErBJhuAaIl90DgnJzhQADAQAAiXNlY3AyNTZrMaED_bgr8M0FRe3by3lKjsj1m5rWeOtAbu_7Id1FYk8TeFGDdGNwgoiWg3VkcIKImIV3YWt1MgE"}'
2025-02-07 04:04:09.718 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:04:09.725 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:04:09.725 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-07_04-04-08__b197b1fd-57fb-4d37-81d3-47b141558001__wakuorg_nwaku:latest.log
2025-02-07 04:04:09.726 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:04:09.726 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:04:09.727 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:04:09.727 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.67.48
2025-02-07 04:04:09.728 DEBUG [src.node.docker_mananger] Generated ports ['7062', '7063', '7064', '7065', '7066']
2025-02-07 04:04:09.728 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:04:09.728 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:04:09.728 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:04:09.728 DEBUG [src.node.docker_mananger] docker run -i -t -p 7062:7062 -p 7063:7063 -p 7064:7064 -p 7065:7065 -p 7066:7066 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7064 --rest-port=7062 --tcp-port=7063 --discv5-udp-port=7065 --rest-address=0.0.0.0 --nat=extip:172.18.67.48 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bd5ea5dfaff32a4fd8c4c0246c8ae6aedc9e71f4a5a3f9a4f8aae4d1c7bdcc9b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7066 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QHg4vlcMa4uKfXbOKW4KiZVVDK5T_CWeyb6Y7qHu4nGNQjia0XG545KZZAsejNfL7VxbOVub4DkWNHVSDJztv2MCgmlkgnY0gmlwhKwSYbiKbXVsdGlhZGRyc5YACASsEmG4BoiWAAoErBJhuAaIl90DgnJzhQADAQAAiXNlY3AyNTZrMaED_bgr8M0FRe3by3lKjsj1m5rWeOtAbu_7Id1FYk8TeFGDdGNwgoiWg3VkcIKImIV3YWt1MgE
2025-02-07 04:04:09.968 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.67.48 waku e2a7b597b3b20b618393efb6d746bd8142c3991873ddbaaf32b056de9a63e3d2
2025-02-07 04:04:10.018 DEBUG [src.node.docker_mananger] Container started with ID e2a7b597b3b2. Setting up logs at ./log/docker/node2_2025-02-07_04-04-08__b197b1fd-57fb-4d37-81d3-47b141558001__wakuorg_nwaku:latest.log
2025-02-07 04:04:10.019 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 7062
2025-02-07 04:04:10.019 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:04:11.021 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7062/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:11.027 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:04:11.027 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:04:11.027 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7062/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:11.032 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.67.48/tcp/7063/p2p/16Uiu2HAmRkzrvujQcS5LwL64NXBTGBbMTmzhNuEZvcJx9WfPC67c","/ip4/172.18.67.48/tcp/7064/ws/p2p/16Uiu2HAmRkzrvujQcS5LwL64NXBTGBbMTmzhNuEZvcJx9WfPC67c"],"enrUri":"enr:-L24QFu0czFLrlz9FoV1eRQE-5Byx7OM4VW2aZm7Hf9xrozndbqBKwCZP9GK1mPebAaIz12DyUdqLOo2VG1XS1zprOMCgmlkgnY0gmlwhKwSQzCKbXVsdGlhZGRyc5YACASsEkMwBhuXAAoErBJDMAYbmN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwrH-I8jWkKXtn_OpxRBtg94BEi4YFuCjH5IjF7ubhkuDdGNwghuXg3VkcIIbmYV3YWt1MgE"}'
2025-02-07 04:04:11.033 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:04:11.033 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7062/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.97.184/tcp/34966/p2p/16Uiu2HAmVjQP2F5JyyhXJK4zQhXLfiEPM2vquekohEjnVKv2qrnC"]'
2025-02-07 04:04:11.037 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:11.038 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34965/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:04:11.042 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:11.042 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7062/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:04:11.048 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:11.049 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34965/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:11.055 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:11.056 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:04:11.156 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:04:11.156 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34965/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:11.159 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901051049007872,"ephemeral":false}]'
2025-02-07 04:04:11.161 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:04:11.161 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7062/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:11.163 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901051049007872,"ephemeral":false}]'
2025-02-07 04:04:11.165 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34965/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:04:11.168 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:11.168 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:7062/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:04:11.170 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:11.171 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34965/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:11.176 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:11.176 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:04:11.277 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:04:11.277 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34965/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:11.280 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901051171033856,"ephemeral":false}]'
2025-02-07 04:04:11.282 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:04:11.282 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:7062/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:11.284 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901051171033856,"ephemeral":false}]'
2025-02-07 04:04:11.287 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:04:11.288 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:04:11.288 DEBUG [src.node.waku_node] Stopping container with id dc2d78058191
2025-02-07 04:04:12.224 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:12.225 DEBUG [src.node.waku_node] Stopping container with id e2a7b597b3b2
2025-02-07 04:04:13.039 ERROR [src.node.docker_mananger] Max retries reached for container dc2d78058191. Exiting log stream.
2025-02-07 04:04:13.571 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:13.575 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:04:13.579 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:04:13.584 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
