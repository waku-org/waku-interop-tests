2025-02-07 04:03:41.590 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:03:41.592 DEBUG [tests.conftest] Running test: test_publish_with_valid_version with id: 2025-02-07_04-03-41__a26d2730-f062-4716-92a6-da80ed9be400
2025-02-07 04:03:41.592 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:03:41.592 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-07 04:03:41.593 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-07 04:03:41.601 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:41.601 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-07_04-03-41__a26d2730-f062-4716-92a6-da80ed9be400__wakuorg_nwaku:latest.log
2025-02-07 04:03:41.602 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:41.602 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:41.604 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:41.605 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.210.84
2025-02-07 04:03:41.605 DEBUG [src.node.docker_mananger] Generated ports ['3976', '3977', '3978', '3979', '3980']
2025-02-07 04:03:41.606 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:41.607 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:41.607 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:41.608 DEBUG [src.node.docker_mananger] docker run -i -t -p 3976:3976 -p 3977:3977 -p 3978:3978 -p 3979:3979 -p 3980:3980 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3978 --rest-port=3976 --tcp-port=3977 --discv5-udp-port=3979 --rest-address=0.0.0.0 --nat=extip:172.18.210.84 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=066b3702a6ab1e32a726efdb4aa8de71d4729cc20eff1ce1739e7c98eeeab2f1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3980 --metrics-logging=true --relay=true
2025-02-07 04:03:41.840 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.210.84 waku 29bf9ee15a6ef3f56ac05ed281d4f64645ec220aad16698e12c097266124bace
2025-02-07 04:03:41.888 DEBUG [src.node.docker_mananger] Container started with ID 29bf9ee15a6e. Setting up logs at ./log/docker/node1_2025-02-07_04-03-41__a26d2730-f062-4716-92a6-da80ed9be400__wakuorg_nwaku:latest.log
2025-02-07 04:03:41.889 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3976
2025-02-07 04:03:41.889 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:42.446 ERROR [src.node.docker_mananger] Max retries reached for container f408a5e9ab41. Exiting log stream.
2025-02-07 04:03:42.890 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3976/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:42.892 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:42.892 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:42.893 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3976/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:42.895 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.210.84/tcp/3977/p2p/16Uiu2HAmQQHeRbHbd1cjRsy6bQSPV9aTZv4RBJzAzHvmzfbQz4fA","/ip4/172.18.210.84/tcp/3978/ws/p2p/16Uiu2HAmQQHeRbHbd1cjRsy6bQSPV9aTZv4RBJzAzHvmzfbQz4fA"],"enrUri":"enr:-L24QCVUDp1ju2bvPmzyfpJmWb7LtFK0LIapZV_sMCNveI8lWA-eUUNFpgPRa-El14xL1RiF4WVWQX-gM0VS2O05C-kCgmlkgnY0gmlwhKwS0lSKbXVsdGlhZGRyc5YACASsEtJUBg-JAAoErBLSVAYPit0DgnJzhQADAQAAiXNlY3AyNTZrMaEDrogWRKPphQYkuRe_w4CtGEFqcO-zahl4BL3DCSJauKmDdGNwgg-Jg3VkcIIPi4V3YWt1MgE"}'
2025-02-07 04:03:42.895 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:42.901 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:42.901 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-07_04-03-41__a26d2730-f062-4716-92a6-da80ed9be400__wakuorg_nwaku:latest.log
2025-02-07 04:03:42.901 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:42.902 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:42.903 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:42.903 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.227.150
2025-02-07 04:03:42.903 DEBUG [src.node.docker_mananger] Generated ports ['30707', '30708', '30709', '30710', '30711']
2025-02-07 04:03:42.903 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:42.903 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:42.904 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:42.904 DEBUG [src.node.docker_mananger] docker run -i -t -p 30707:30707 -p 30708:30708 -p 30709:30709 -p 30710:30710 -p 30711:30711 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30709 --rest-port=30707 --tcp-port=30708 --discv5-udp-port=30710 --rest-address=0.0.0.0 --nat=extip:172.18.227.150 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fc60e7ce78afd66a23531d30eea11190af36dbed64e44e51f1b3c8b25efafe2b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30711 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QCVUDp1ju2bvPmzyfpJmWb7LtFK0LIapZV_sMCNveI8lWA-eUUNFpgPRa-El14xL1RiF4WVWQX-gM0VS2O05C-kCgmlkgnY0gmlwhKwS0lSKbXVsdGlhZGRyc5YACASsEtJUBg-JAAoErBLSVAYPit0DgnJzhQADAQAAiXNlY3AyNTZrMaEDrogWRKPphQYkuRe_w4CtGEFqcO-zahl4BL3DCSJauKmDdGNwgg-Jg3VkcIIPi4V3YWt1MgE
2025-02-07 04:03:43.128 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.227.150 waku 80414c20a41ed8175a45da78c5150984934fe1dca0bbadba11e75d2fad3f080e
2025-02-07 04:03:43.177 DEBUG [src.node.docker_mananger] Container started with ID 80414c20a41e. Setting up logs at ./log/docker/node2_2025-02-07_04-03-41__a26d2730-f062-4716-92a6-da80ed9be400__wakuorg_nwaku:latest.log
2025-02-07 04:03:43.178 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30707
2025-02-07 04:03:43.178 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:44.178 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30707/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:44.189 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:44.191 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:44.194 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30707/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:44.198 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.227.150/tcp/30708/p2p/16Uiu2HAmAHKNzDC31sM5n97hjfmxGzxLYtGUZ2LVbiBZDgYuv2eB","/ip4/172.18.227.150/tcp/30709/ws/p2p/16Uiu2HAmAHKNzDC31sM5n97hjfmxGzxLYtGUZ2LVbiBZDgYuv2eB"],"enrUri":"enr:-L24QKwOMAIr-chAF4ZGnIgZr3ZYxYHOi5VcEq-hySF1PvVrZFc0zkmoQd-hrW_78Sh3-qRV4n8epIZwPFUko4GH16ACgmlkgnY0gmlwhKwS45aKbXVsdGlhZGRyc5YACASsEuOWBnf0AAoErBLjlgZ39d0DgnJzhQADAQAAiXNlY3AyNTZrMaEC3LtdY-CJ5ankZkL6SxMPspKpAIZwTRJ44Bd9WGoFrziDdGNwgnf0g3VkcIJ39oV3YWt1MgE"}'
2025-02-07 04:03:44.199 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:44.200 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30707/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.210.84/tcp/3977/p2p/16Uiu2HAmQQHeRbHbd1cjRsy6bQSPV9aTZv4RBJzAzHvmzfbQz4fA"]'
2025-02-07 04:03:44.203 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:44.203 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-07 04:03:44.203 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3976/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:03:44.207 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:44.208 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30707/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:03:44.213 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:44.214 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3976/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:03:44.221 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:44.221 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:03:44.321 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:03:44.322 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3976/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:44.324 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901024214829824,"ephemeral":false}]'
2025-02-07 04:03:44.325 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:03:44.325 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30707/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:44.327 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901024214829824,"ephemeral":false}]'
2025-02-07 04:03:44.329 INFO [src.steps.relay] WARM UP successful!!
2025-02-07 04:03:44.330 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3976/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
2025-02-07 04:03:44.335 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:44.335 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:03:44.436 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:03:44.436 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3976/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:44.438 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1738901024330313984,"ephemeral":false}]'
2025-02-07 04:03:44.439 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:03:44.440 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30707/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:44.442 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1738901024330313984,"ephemeral":false}]'
2025-02-07 04:03:44.445 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:03:44.446 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:03:44.446 DEBUG [src.node.waku_node] Stopping container with id 29bf9ee15a6e
2025-02-07 04:03:45.336 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:03:45.337 DEBUG [src.node.waku_node] Stopping container with id 80414c20a41e
2025-02-07 04:03:46.149 ERROR [src.node.docker_mananger] Max retries reached for container 29bf9ee15a6e. Exiting log stream.
2025-02-07 04:03:46.833 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:03:46.834 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:03:46.838 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:03:46.845 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
