2025-02-07 04:03:58.201 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:03:58.201 DEBUG [tests.conftest] Running test: test_filter_update_subscription_add_a_new_pubsub_topic with id: 2025-02-07_04-03-58__1fde1b99-d06d-4c87-a64f-987db9b82922
2025-02-07 04:03:58.201 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:03:58.202 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-07 04:03:58.202 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-07 04:03:58.208 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:58.208 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-07_04-03-58__1fde1b99-d06d-4c87-a64f-987db9b82922__wakuorg_nwaku:latest.log
2025-02-07 04:03:58.208 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:58.208 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:58.209 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:58.210 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.224.96
2025-02-07 04:03:58.210 DEBUG [src.node.docker_mananger] Generated ports ['14156', '14157', '14158', '14159', '14160']
2025-02-07 04:03:58.210 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:58.210 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:58.210 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:58.210 DEBUG [src.node.docker_mananger] docker run -i -t -p 14156:14156 -p 14157:14157 -p 14158:14158 -p 14159:14159 -p 14160:14160 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14158 --rest-port=14156 --tcp-port=14157 --discv5-udp-port=14159 --rest-address=0.0.0.0 --nat=extip:172.18.224.96 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bbe209afba4b8f6345f22bfa6fb7bc3aeac1dcfb003f59a07ca86f5d9a75e411 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14160 --metrics-logging=true --relay=true --filter=true
2025-02-07 04:03:58.441 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.224.96 waku 6f4408a9fefb3384cf3d0187fc5560d5272167b9713eb66793a60dec6228c767
2025-02-07 04:03:58.491 DEBUG [src.node.docker_mananger] Container started with ID 6f4408a9fefb. Setting up logs at ./log/docker/node1_2025-02-07_04-03-58__1fde1b99-d06d-4c87-a64f-987db9b82922__wakuorg_nwaku:latest.log
2025-02-07 04:03:58.492 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 14156
2025-02-07 04:03:58.492 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:59.002 ERROR [src.node.docker_mananger] Max retries reached for container 052004dee267. Exiting log stream.
2025-02-07 04:03:59.494 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14156/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:59.497 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:59.497 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:59.497 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14156/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:59.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.224.96/tcp/14157/p2p/16Uiu2HAkzuhNtFuTa9z6yEougQadxrE4nEwvngU5MWn8TR7MEaSu","/ip4/172.18.224.96/tcp/14158/ws/p2p/16Uiu2HAkzuhNtFuTa9z6yEougQadxrE4nEwvngU5MWn8TR7MEaSu"],"enrUri":"enr:-L24QDLn_CLA9F0ADIc-Uiii1MsrXGe080z7IpMaUFImKCkhfG5VmIeh2xuUnY35oZTc_dAnMWT5SI4h4A9DG5dON5YCgmlkgnY0gmlwhKwS4GCKbXVsdGlhZGRyc5YACASsEuBgBjdNAAoErBLgYAY3Tt0DgnJzhQADAQAAiXNlY3AyNTZrMaECUXhHNKAj_OglR-t9x2YkeqazYuRI10x0z6l6Z9N8BoqDdGNwgjdNg3VkcII3T4V3YWt1MgU"}'
2025-02-07 04:03:59.499 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:59.500 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-07 04:03:59.506 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:59.506 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-07_04-03-58__1fde1b99-d06d-4c87-a64f-987db9b82922__wakuorg_nwaku:latest.log
2025-02-07 04:03:59.506 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:59.506 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:59.508 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:59.508 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.23.175
2025-02-07 04:03:59.508 DEBUG [src.node.docker_mananger] Generated ports ['9925', '9926', '9927', '9928', '9929']
2025-02-07 04:03:59.508 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:59.508 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:59.508 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:59.508 DEBUG [src.node.docker_mananger] docker run -i -t -p 9925:9925 -p 9926:9926 -p 9927:9927 -p 9928:9928 -p 9929:9929 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9927 --rest-port=9925 --tcp-port=9926 --discv5-udp-port=9928 --rest-address=0.0.0.0 --nat=extip:172.18.23.175 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ad68cb1f053e32fca2eeab5ec593abfe5aa1cadbf9a37df23aaf37f29dbeb7c4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9929 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QDLn_CLA9F0ADIc-Uiii1MsrXGe080z7IpMaUFImKCkhfG5VmIeh2xuUnY35oZTc_dAnMWT5SI4h4A9DG5dON5YCgmlkgnY0gmlwhKwS4GCKbXVsdGlhZGRyc5YACASsEuBgBjdNAAoErBLgYAY3Tt0DgnJzhQADAQAAiXNlY3AyNTZrMaECUXhHNKAj_OglR-t9x2YkeqazYuRI10x0z6l6Z9N8BoqDdGNwgjdNg3VkcII3T4V3YWt1MgU --filternode=/ip4/172.18.224.96/tcp/14157/p2p/16Uiu2HAkzuhNtFuTa9z6yEougQadxrE4nEwvngU5MWn8TR7MEaSu
2025-02-07 04:03:59.738 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.23.175 waku ca23d4c147a6d96f33d1ed91dedfe2667a4f35e33a0b7fc505c4ccb3e490b89f
2025-02-07 04:03:59.786 DEBUG [src.node.docker_mananger] Container started with ID ca23d4c147a6. Setting up logs at ./log/docker/node2_2025-02-07_04-03-58__1fde1b99-d06d-4c87-a64f-987db9b82922__wakuorg_nwaku:latest.log
2025-02-07 04:03:59.787 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 9925
2025-02-07 04:03:59.787 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:04:00.787 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9925/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:00.790 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:04:00.790 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:04:00.790 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9925/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:00.793 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.23.175/tcp/9926/p2p/16Uiu2HAmTZw59oanVNBUk2BU2dtHCuQiW1A91S1QtgFgMVKNLBLD","/ip4/172.18.23.175/tcp/9927/ws/p2p/16Uiu2HAmTZw59oanVNBUk2BU2dtHCuQiW1A91S1QtgFgMVKNLBLD"],"enrUri":"enr:-L24QHQgTT63U9rDVTqlxLEAJf9Q5wRCwUkD9yGmf3ySDETyFWZZ2gaCjdHTMnmHNuFSiCtKvVUQCE6VyZ8TE30FChICgmlkgnY0gmlwhKwSF6-KbXVsdGlhZGRyc5YACASsEhevBibGAAoErBIXrwYmx90DgnJzhQADAQAAiXNlY3AyNTZrMaED3ZOxcexLmxBlRm2FTkRkbAcagJrxxHUAETiwAICXaEqDdGNwgibGg3VkcIImyIV3YWt1MgA"}'
2025-02-07 04:04:00.793 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:04:00.793 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9925/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.224.96/tcp/14157/p2p/16Uiu2HAkzuhNtFuTa9z6yEougQadxrE4nEwvngU5MWn8TR7MEaSu"]'
2025-02-07 04:04:00.830 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:00.835 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14156/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:04:00.852 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:00.854 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9925/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ae9944a6-6a4c-4bb3-baac-09e0244f26bb", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-07 04:04:00.864 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"ae9944a6-6a4c-4bb3-baac-09e0244f26bb","statusDesc":"OK"}'
2025-02-07 04:04:00.864 INFO [src.node.api_clients.base_client] curl -v -X PUT "http://127.0.0.1:9925/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto", "/test/2/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1000"}'
2025-02-07 04:04:00.872 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-07 04:04:00.872 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14156/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1000"]'
2025-02-07 04:04:00.875 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:00.875 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14156/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:00.883 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:00.883 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:04:00.983 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:04:00.984 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9925/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:00.986 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738901040875692288,"ephemeral":false}]'
2025-02-07 04:04:00.988 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14156/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:00.992 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:00.992 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:04:01.093 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:04:01.093 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9925/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:01.095 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738901040987960576,"ephemeral":false}]'
2025-02-07 04:04:01.097 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14156/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/2/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:04:01.101 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:01.101 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:04:01.202 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:04:01.202 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9925/filter/v2/messages/%2Ftest%2F2%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:01.204 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/2/waku-filter/proto","version":0,"timestamp":1738901041097083136,"ephemeral":false}]'
2025-02-07 04:04:01.207 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:04:01.208 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:04:01.208 DEBUG [src.node.waku_node] Stopping container with id 6f4408a9fefb
2025-02-07 04:04:02.096 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:02.097 DEBUG [src.node.waku_node] Stopping container with id ca23d4c147a6
2025-02-07 04:04:02.909 ERROR [src.node.docker_mananger] Max retries reached for container 6f4408a9fefb. Exiting log stream.
2025-02-07 04:04:03.597 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:03.600 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:04:03.605 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:04:03.609 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
