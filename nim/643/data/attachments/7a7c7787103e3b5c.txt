2025-02-07 04:04:26.874 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:04:26.875 DEBUG [tests.conftest] Running test: test_lightpush_with_a_single_receiving_node with id: 2025-02-07_04-04-26__2b2876d6-66a2-404f-8077-ea6ccb6ff8c0
2025-02-07 04:04:26.875 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:04:26.875 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-07 04:04:26.882 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:04:26.882 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-07_04-04-26__2b2876d6-66a2-404f-8077-ea6ccb6ff8c0__wakuorg_nwaku:latest.log
2025-02-07 04:04:26.882 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:04:26.883 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:04:26.884 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:04:26.884 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.11.251
2025-02-07 04:04:26.884 DEBUG [src.node.docker_mananger] Generated ports ['3553', '3554', '3555', '3556', '3557']
2025-02-07 04:04:26.884 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:04:26.885 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:04:26.885 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:04:26.885 DEBUG [src.node.docker_mananger] docker run -i -t -p 3553:3553 -p 3554:3554 -p 3555:3555 -p 3556:3556 -p 3557:3557 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3555 --rest-port=3553 --tcp-port=3554 --discv5-udp-port=3556 --rest-address=0.0.0.0 --nat=extip:172.18.11.251 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e426d26a2d0dd096cadd0aaad413e8ba59bd6191e38bcd8fac28f49e510db49a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3557 --metrics-logging=true --lightpush=true --relay=true
2025-02-07 04:04:27.109 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.11.251 waku 2e49bc0e53037ce17d54b0e7ded1970b9e0b22f116f943ff2a33cdf1847b0a94
2025-02-07 04:04:27.162 DEBUG [src.node.docker_mananger] Container started with ID 2e49bc0e5303. Setting up logs at ./log/docker/receiving_node1_2025-02-07_04-04-26__2b2876d6-66a2-404f-8077-ea6ccb6ff8c0__wakuorg_nwaku:latest.log
2025-02-07 04:04:27.163 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3553
2025-02-07 04:04:27.164 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:04:27.675 ERROR [src.node.docker_mananger] Max retries reached for container 05b0fda4784c. Exiting log stream.
2025-02-07 04:04:28.164 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3553/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:28.167 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:04:28.167 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:04:28.168 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3553/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:28.170 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.11.251/tcp/3554/p2p/16Uiu2HAkwDC8GVSUBHNEnvBKwYjgm1yQRYTFx1hVnN4EdgQzEhv2","/ip4/172.18.11.251/tcp/3555/ws/p2p/16Uiu2HAkwDC8GVSUBHNEnvBKwYjgm1yQRYTFx1hVnN4EdgQzEhv2"],"enrUri":"enr:-L24QKHM0oDu33mgmUpr87YiCnB4IYHtqX3uQtR0dW2PN-UqeayUfygj8Hab1sgKl2GUePu9nanISxS3zSFCghV6TvoCgmlkgnY0gmlwhKwSC_uKbXVsdGlhZGRyc5YACASsEgv7Bg3iAAoErBIL-wYN490DgnJzhQADAQAAiXNlY3AyNTZrMaECGoTo3tApbLKgqtIGxgD5iFGu5Yo-3JLaymIONW59TFuDdGNwgg3ig3VkcIIN5IV3YWt1Mgk"}'
2025-02-07 04:04:28.170 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:04:28.177 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:04:28.177 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-07_04-04-26__2b2876d6-66a2-404f-8077-ea6ccb6ff8c0__wakuorg_nwaku:latest.log
2025-02-07 04:04:28.177 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:04:28.177 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:04:28.179 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:04:28.179 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.37.219
2025-02-07 04:04:28.179 DEBUG [src.node.docker_mananger] Generated ports ['2641', '2642', '2643', '2644', '2645']
2025-02-07 04:04:28.179 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:04:28.179 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:04:28.179 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:04:28.179 DEBUG [src.node.docker_mananger] docker run -i -t -p 2641:2641 -p 2642:2642 -p 2643:2643 -p 2644:2644 -p 2645:2645 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2643 --rest-port=2641 --tcp-port=2642 --discv5-udp-port=2644 --rest-address=0.0.0.0 --nat=extip:172.18.37.219 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ddbbdba2bdea0fd6ef86e3ce47e2b4c8b2ccc0b1ae28d493c9dccabadd9b2df0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2645 --metrics-logging=true --discv5-bootstrap-node=enr:-L24QKHM0oDu33mgmUpr87YiCnB4IYHtqX3uQtR0dW2PN-UqeayUfygj8Hab1sgKl2GUePu9nanISxS3zSFCghV6TvoCgmlkgnY0gmlwhKwSC_uKbXVsdGlhZGRyc5YACASsEgv7Bg3iAAoErBIL-wYN490DgnJzhQADAQAAiXNlY3AyNTZrMaECGoTo3tApbLKgqtIGxgD5iFGu5Yo-3JLaymIONW59TFuDdGNwgg3ig3VkcIIN5IV3YWt1Mgk --lightpushnode=/ip4/172.18.11.251/tcp/3554/p2p/16Uiu2HAkwDC8GVSUBHNEnvBKwYjgm1yQRYTFx1hVnN4EdgQzEhv2 --lightpush=true --relay=false
2025-02-07 04:04:28.408 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.37.219 waku a295c9d62db5dd4f45a6cdbe0beb8e1eeeb7178608fde2807cbf580cd8771ff9
2025-02-07 04:04:28.461 DEBUG [src.node.docker_mananger] Container started with ID a295c9d62db5. Setting up logs at ./log/docker/lightpush_node1_2025-02-07_04-04-26__2b2876d6-66a2-404f-8077-ea6ccb6ff8c0__wakuorg_nwaku:latest.log
2025-02-07 04:04:28.462 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 2641
2025-02-07 04:04:28.462 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:04:29.463 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2641/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:29.466 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:04:29.466 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:04:29.467 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2641/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:04:29.469 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.37.219/tcp/2642/p2p/16Uiu2HAkvYht1ScvRLHf9ZesDj7nu91XJUEGfY6h63g1s9YggASQ","/ip4/172.18.37.219/tcp/2643/ws/p2p/16Uiu2HAkvYht1ScvRLHf9ZesDj7nu91XJUEGfY6h63g1s9YggASQ"],"enrUri":"enr:-L24QO6dwmCCH-JHb_5UjplZak96Z2pOYlMjh6pK8Y7voI2GFUPIe3tF44VPGMepbbrFbzJyvj1n18PnqZLoeKwh8sACgmlkgnY0gmlwhKwSJduKbXVsdGlhZGRyc5YACASsEiXbBgpSAAoErBIl2wYKU90DgnJzhQADAQAAiXNlY3AyNTZrMaECEKjmtjCTsMO_nf2nUnsreSPw726cZCIEEp-IGmIW-O2DdGNwggpSg3VkcIIKVIV3YWt1Mgg"}'
2025-02-07 04:04:29.469 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:04:29.470 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2641/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.11.251/tcp/3554/p2p/16Uiu2HAkwDC8GVSUBHNEnvBKwYjgm1yQRYTFx1hVnN4EdgQzEhv2"]'
2025-02-07 04:04:29.506 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:29.508 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3553/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-07 04:04:29.527 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:04:29.530 DEBUG [src.steps.light_push] Lightpushing message
2025-02-07 04:04:29.531 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2641/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738901069530247680}}'
2025-02-07 04:04:29.540 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:2641/lightpush/v1/message. Response content: b'Failed to request a message push: not_published_to_any_peer'
2025-02-07 04:04:29.542 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:04:29.543 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:04:29.543 DEBUG [src.node.waku_node] Stopping container with id 2e49bc0e5303
2025-02-07 04:04:30.649 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:30.649 DEBUG [src.node.waku_node] Stopping container with id a295c9d62db5
2025-02-07 04:04:31.462 ERROR [src.node.docker_mananger] Max retries reached for container 2e49bc0e5303. Exiting log stream.
2025-02-07 04:04:32.166 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:04:32.167 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:04:32.172 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:04:32.176 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
