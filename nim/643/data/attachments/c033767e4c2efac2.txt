2025-02-07 04:05:05.908 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:05:05.908 DEBUG [tests.conftest] Running test: test_2_nodes_different_content_topic_same_shard with id: 2025-02-07_04-05-05__f407cc56-7d90-4b65-80bb-68daf3a7d24b
2025-02-07 04:05:05.908 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:05:05.909 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-07 04:05:05.909 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-07 04:05:05.916 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:05:05.916 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-07_04-05-05__f407cc56-7d90-4b65-80bb-68daf3a7d24b__wakuorg_nwaku:latest.log
2025-02-07 04:05:05.916 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:05:05.916 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:05:05.919 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:05:05.920 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.19.41
2025-02-07 04:05:05.920 DEBUG [src.node.docker_mananger] Generated ports ['29145', '29146', '29147', '29148', '29149']
2025-02-07 04:05:05.920 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:05:05.920 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:05:05.920 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:05:05.920 DEBUG [src.node.docker_mananger] docker run -i -t -p 29145:29145 -p 29146:29146 -p 29147:29147 -p 29148:29148 -p 29149:29149 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29147 --rest-port=29145 --tcp-port=29146 --discv5-udp-port=29148 --rest-address=0.0.0.0 --nat=extip:172.18.19.41 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=e1e2998dd9afa38ca45dfcb55b15fa52ec4cdffecdce66c7ef2abebaa64bc24e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29149 --metrics-logging=true --relay=true --filter=true --content-topic=/newsService/1.0/weekly/protobuf
2025-02-07 04:05:06.153 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.19.41 waku 72ae67445aeba8334dc2854c6855bbe066b1490d78b360d30aee821e180029e2
2025-02-07 04:05:06.207 DEBUG [src.node.docker_mananger] Container started with ID 72ae67445aeb. Setting up logs at ./log/docker/node1_2025-02-07_04-05-05__f407cc56-7d90-4b65-80bb-68daf3a7d24b__wakuorg_nwaku:latest.log
2025-02-07 04:05:06.207 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29145
2025-02-07 04:05:06.207 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:05:06.708 ERROR [src.node.docker_mananger] Max retries reached for container ba581106315d. Exiting log stream.
2025-02-07 04:05:07.208 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29145/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:07.211 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:05:07.211 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:05:07.211 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29145/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:07.213 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.41/tcp/29146/p2p/16Uiu2HAmAt2DZvdniLc6TPZySpJDHMuArfNJ6KkCNPWEsSv4k8y4","/ip4/172.18.19.41/tcp/29147/ws/p2p/16Uiu2HAmAt2DZvdniLc6TPZySpJDHMuArfNJ6KkCNPWEsSv4k8y4"],"enrUri":"enr:-L24QDxfRxoN-t1lzUsclBNi6jNtCTb4HEbaJgCGi-b6G82XaKT4dVv_0wtEqsCYtv_sIo_PSZFsQ-_bk-ynOsnTW9sCgmlkgnY0gmlwhKwSEymKbXVsdGlhZGRyc5YACASsEhMpBnHaAAoErBITKQZx290DgnJzhQACAQAAiXNlY3AyNTZrMaEC5Z9JnIkpQqAgSTpz0Mab3uMg8aJ0D62XW8Si7Da9hveDdGNwgnHag3VkcIJx3IV3YWt1MgU"}'
2025-02-07 04:05:07.214 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:05:07.220 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:05:07.220 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-07_04-05-05__f407cc56-7d90-4b65-80bb-68daf3a7d24b__wakuorg_nwaku:latest.log
2025-02-07 04:05:07.221 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:05:07.221 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:05:07.222 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:05:07.222 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.71.83
2025-02-07 04:05:07.222 DEBUG [src.node.docker_mananger] Generated ports ['5394', '5395', '5396', '5397', '5398']
2025-02-07 04:05:07.223 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:05:07.223 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:05:07.223 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:05:07.223 DEBUG [src.node.docker_mananger] docker run -i -t -p 5394:5394 -p 5395:5395 -p 5396:5396 -p 5397:5397 -p 5398:5398 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=5396 --rest-port=5394 --tcp-port=5395 --discv5-udp-port=5397 --rest-address=0.0.0.0 --nat=extip:172.18.71.83 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=6d2b0cdeb0a48bc407c9ff03fd5f7c6e4a550b52c08ff7b9aceda5774ea76cda --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=5398 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QDxfRxoN-t1lzUsclBNi6jNtCTb4HEbaJgCGi-b6G82XaKT4dVv_0wtEqsCYtv_sIo_PSZFsQ-_bk-ynOsnTW9sCgmlkgnY0gmlwhKwSEymKbXVsdGlhZGRyc5YACASsEhMpBnHaAAoErBITKQZx290DgnJzhQACAQAAiXNlY3AyNTZrMaEC5Z9JnIkpQqAgSTpz0Mab3uMg8aJ0D62XW8Si7Da9hveDdGNwgnHag3VkcIJx3IV3YWt1MgU --content-topic=/newsService/1.0/alerts/xml
2025-02-07 04:05:07.459 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.71.83 waku 8c58ec506f149f99cb267abad99a3409d69c65a8b3d7af9134914974e493911d
2025-02-07 04:05:07.512 DEBUG [src.node.docker_mananger] Container started with ID 8c58ec506f14. Setting up logs at ./log/docker/node2_2025-02-07_04-05-05__f407cc56-7d90-4b65-80bb-68daf3a7d24b__wakuorg_nwaku:latest.log
2025-02-07 04:05:07.513 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 5394
2025-02-07 04:05:07.513 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:05:08.515 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5394/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:08.521 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:05:08.523 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:05:08.524 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5394/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:08.529 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.71.83/tcp/5395/p2p/16Uiu2HAmC5EuHtcoom1ZGpYtajvTRqdJra5GN7ZM4uVRaZhhVEdL","/ip4/172.18.71.83/tcp/5396/ws/p2p/16Uiu2HAmC5EuHtcoom1ZGpYtajvTRqdJra5GN7ZM4uVRaZhhVEdL"],"enrUri":"enr:-L24QDReW2pwpWDwCoVGTFvaEZ_1jM7TgywRaToBc5tSjG-HbiUkvoqykXzCMuVmViC51ZYRjqkIaKlVSLhaOhCsHBoCgmlkgnY0gmlwhKwSR1OKbXVsdGlhZGRyc5YACASsEkdTBhUTAAoErBJHUwYVFN0DgnJzhQACAQAAiXNlY3AyNTZrMaEC91q0ytlfUs8MW0m0SahfsE5xkEFHayy0SQkazj2vtW-DdGNwghUTg3VkcIIVFYV3YWt1MgE"}'
2025-02-07 04:05:08.529 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:05:08.529 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5394/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.19.41/tcp/29146/p2p/16Uiu2HAmAt2DZvdniLc6TPZySpJDHMuArfNJ6KkCNPWEsSv4k8y4"]'
2025-02-07 04:05:08.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:08.533 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29145/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/weekly/protobuf"]'
2025-02-07 04:05:08.535 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:08.535 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:5394/relay/v1/auto/subscriptions" -H "Content-Type: application/json" -d '["/newsService/1.0/alerts/xml"]'
2025-02-07 04:05:08.538 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:08.538 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29145/relay/v1/auto/messages" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/newsService/1.0/weekly/protobuf", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:05:08.543 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:08.544 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:05:08.644 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:08.645 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29145/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:08.647 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/newsService/1.0/weekly/protobuf","version":0,"timestamp":1738901108538706176,"ephemeral":false}]'
2025-02-07 04:05:08.649 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:08.649 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:5394/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:08.651 ERROR [src.node.api_clients.base_client] HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:5394/relay/v1/auto/messages/%2FnewsService%2F1.0%2Fweekly%2Fprotobuf. Response content: b'/newsService/1.0/weekly/protobuf'
2025-02-07 04:05:08.654 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:05:08.655 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:05:08.655 DEBUG [src.node.waku_node] Stopping container with id 72ae67445aeb
2025-02-07 04:05:09.692 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:05:09.692 DEBUG [src.node.waku_node] Stopping container with id 8c58ec506f14
2025-02-07 04:05:10.505 ERROR [src.node.docker_mananger] Max retries reached for container 72ae67445aeb. Exiting log stream.
2025-02-07 04:05:11.191 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:05:11.193 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:05:11.197 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:05:11.202 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
