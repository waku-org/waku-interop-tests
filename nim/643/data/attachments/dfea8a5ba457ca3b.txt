2025-02-07 04:05:00.357 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:05:00.358 DEBUG [tests.conftest] Running test: test_publish_after_node_pauses_and_pauses with id: 2025-02-07_04-05-00__3785abdf-bde4-4223-987a-116c4e194a85
2025-02-07 04:05:00.359 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:05:00.359 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-07 04:05:00.359 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-07 04:05:00.369 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:05:00.369 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-07_04-05-00__3785abdf-bde4-4223-987a-116c4e194a85__wakuorg_nwaku:latest.log
2025-02-07 04:05:00.370 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:05:00.370 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:05:00.372 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:05:00.373 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.250.67
2025-02-07 04:05:00.373 DEBUG [src.node.docker_mananger] Generated ports ['42027', '42028', '42029', '42030', '42031']
2025-02-07 04:05:00.373 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:05:00.373 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:05:00.374 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:05:00.374 DEBUG [src.node.docker_mananger] docker run -i -t -p 42027:42027 -p 42028:42028 -p 42029:42029 -p 42030:42030 -p 42031:42031 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=42029 --rest-port=42027 --tcp-port=42028 --discv5-udp-port=42030 --rest-address=0.0.0.0 --nat=extip:172.18.250.67 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=23b98e0bbe46817cb3c07bf81cd96dd7dabd595bcba1b5ffc9d52df0ff22fd2c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=42031 --metrics-logging=true --relay=true
2025-02-07 04:05:00.607 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.250.67 waku e1326a24fefd84e4f1a74b433ea8bfb980f28da943ccd6798c5a499ff8e1bb35
2025-02-07 04:05:00.655 DEBUG [src.node.docker_mananger] Container started with ID e1326a24fefd. Setting up logs at ./log/docker/node1_2025-02-07_04-05-00__3785abdf-bde4-4223-987a-116c4e194a85__wakuorg_nwaku:latest.log
2025-02-07 04:05:00.657 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 42027
2025-02-07 04:05:00.658 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:05:01.189 ERROR [src.node.docker_mananger] Max retries reached for container 27653ade151c. Exiting log stream.
2025-02-07 04:05:01.658 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42027/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:01.661 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:05:01.661 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:05:01.661 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42027/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:01.663 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.250.67/tcp/42028/p2p/16Uiu2HAmTTXBtAx3jQtc1sdBPXR7HFo7jTbgLNcGih9nMtNnyqkP","/ip4/172.18.250.67/tcp/42029/ws/p2p/16Uiu2HAmTTXBtAx3jQtc1sdBPXR7HFo7jTbgLNcGih9nMtNnyqkP"],"enrUri":"enr:-L24QPfs_Z1xzt-u6eHlUJvt3mKNw8AcrneI5FMTH5O4K1c0cL1Jk0Vd_BVWOuavcKEA5SE6bBR1snBy5ZfmX9UfNegCgmlkgnY0gmlwhKwS-kOKbXVsdGlhZGRyc5YACASsEvpDBqQsAAoErBL6QwakLd0DgnJzhQADAQAAiXNlY3AyNTZrMaED2-8z3n7ghmNXtY9E7R0D973vmBxguzR4M1bC7NfXsQSDdGNwgqQsg3VkcIKkLoV3YWt1MgE"}'
2025-02-07 04:05:01.663 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:05:01.670 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:05:01.670 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-07_04-05-00__3785abdf-bde4-4223-987a-116c4e194a85__wakuorg_nwaku:latest.log
2025-02-07 04:05:01.670 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:05:01.670 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:05:01.671 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:05:01.672 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.52.238
2025-02-07 04:05:01.672 DEBUG [src.node.docker_mananger] Generated ports ['48367', '48368', '48369', '48370', '48371']
2025-02-07 04:05:01.672 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:05:01.672 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:05:01.672 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:05:01.672 DEBUG [src.node.docker_mananger] docker run -i -t -p 48367:48367 -p 48368:48368 -p 48369:48369 -p 48370:48370 -p 48371:48371 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48369 --rest-port=48367 --tcp-port=48368 --discv5-udp-port=48370 --rest-address=0.0.0.0 --nat=extip:172.18.52.238 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aded74dda385a7b8ffe15fc9b3fc2cafc6ac3cd2b8005a52f4b80a5fdaa4fec0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48371 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-L24QPfs_Z1xzt-u6eHlUJvt3mKNw8AcrneI5FMTH5O4K1c0cL1Jk0Vd_BVWOuavcKEA5SE6bBR1snBy5ZfmX9UfNegCgmlkgnY0gmlwhKwS-kOKbXVsdGlhZGRyc5YACASsEvpDBqQsAAoErBL6QwakLd0DgnJzhQADAQAAiXNlY3AyNTZrMaED2-8z3n7ghmNXtY9E7R0D973vmBxguzR4M1bC7NfXsQSDdGNwgqQsg3VkcIKkLoV3YWt1MgE
2025-02-07 04:05:01.900 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.52.238 waku fd7ecbfb12cdeb508a1d2a19d86401368a27c43b0048625dd6d25ed5dda9b6d8
2025-02-07 04:05:01.947 DEBUG [src.node.docker_mananger] Container started with ID fd7ecbfb12cd. Setting up logs at ./log/docker/node2_2025-02-07_04-05-00__3785abdf-bde4-4223-987a-116c4e194a85__wakuorg_nwaku:latest.log
2025-02-07 04:05:01.948 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 48367
2025-02-07 04:05:01.948 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:05:02.949 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:02.956 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:05:02.958 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:05:02.958 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:02.960 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.52.238/tcp/48368/p2p/16Uiu2HAmPVWqRK25LS79TKGJd1LgcFinBXQYut9uuUzzAwNELZVm","/ip4/172.18.52.238/tcp/48369/ws/p2p/16Uiu2HAmPVWqRK25LS79TKGJd1LgcFinBXQYut9uuUzzAwNELZVm"],"enrUri":"enr:-L24QFSRq97jIXUZtBkYohw0tPrbUVTE0RmTZWJOJEGqmLjpA4uAodRhRnlhJvYJ5UklttkfZj-XJz4tDyUL9suIO20CgmlkgnY0gmlwhKwSNO6KbXVsdGlhZGRyc5YACASsEjTuBrzwAAoErBI07ga88d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDoQM3tKapTsub08J_aILyr_Ukrd1WxP2A5rY1WkUR6uyDdGNwgrzwg3VkcIK88oV3YWt1MgE"}'
2025-02-07 04:05:02.961 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:05:02.961 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48367/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.250.67/tcp/42028/p2p/16Uiu2HAmTTXBtAx3jQtc1sdBPXR7HFo7jTbgLNcGih9nMtNnyqkP"]'
2025-02-07 04:05:02.964 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:02.964 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-07 04:05:02.964 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42027/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:05:02.969 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:02.969 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48367/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:05:02.975 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:02.976 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:05:02.982 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:02.982 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:05:03.082 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.083 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.086 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901102976126464,"ephemeral":false}]'
2025-02-07 04:05:03.087 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.088 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.090 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901102976126464,"ephemeral":false}]'
2025-02-07 04:05:03.091 INFO [src.steps.relay] WARM UP successful!!
2025-02-07 04:05:03.092 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:05:03.097 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:03.098 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:05:03.198 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.199 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.201 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901103092888576,"ephemeral":false}]'
2025-02-07 04:05:03.203 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.203 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.207 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901103092888576,"ephemeral":false}]'
2025-02-07 04:05:03.208 DEBUG [src.node.waku_node] Pausing container with id e1326a24fefd
2025-02-07 04:05:03.217 DEBUG [src.node.waku_node] Unpause container with id e1326a24fefd
2025-02-07 04:05:03.226 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTE=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:05:03.230 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:03.231 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:05:03.332 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.332 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.335 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901103225916160,"ephemeral":false}]'
2025-02-07 04:05:03.336 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.337 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.339 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901103225916160,"ephemeral":false}]'
2025-02-07 04:05:03.341 DEBUG [src.node.waku_node] Pausing container with id fd7ecbfb12cd
2025-02-07 04:05:03.350 DEBUG [src.node.waku_node] Unpause container with id fd7ecbfb12cd
2025-02-07 04:05:03.360 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTI=", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:05:03.366 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:05:03.366 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:05:03.466 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.467 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42027/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.470 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901103359906304,"ephemeral":false}]'
2025-02-07 04:05:03.471 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:05:03.471 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48367/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:05:03.474 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738901103359906304,"ephemeral":false}]'
2025-02-07 04:05:03.477 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:05:03.478 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:05:03.478 DEBUG [src.node.waku_node] Stopping container with id e1326a24fefd
2025-02-07 04:05:04.157 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:05:04.157 DEBUG [src.node.waku_node] Stopping container with id fd7ecbfb12cd
2025-02-07 04:05:04.970 ERROR [src.node.docker_mananger] Max retries reached for container e1326a24fefd. Exiting log stream.
2025-02-07 04:05:05.622 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:05:05.624 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:05:05.628 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:05:05.633 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
