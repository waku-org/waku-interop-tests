2025-02-07 04:03:30.754 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-07 04:03:30.754 DEBUG [tests.conftest] Running test: test_filter_unsubscribe_from_single_content_topic with id: 2025-02-07_04-03-30__34e4b034-a332-4e4f-a4ef-203110ebc710
2025-02-07 04:03:30.754 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-07 04:03:30.755 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-07 04:03:30.755 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-07 04:03:30.760 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:30.761 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-07_04-03-30__34e4b034-a332-4e4f-a4ef-203110ebc710__wakuorg_nwaku:latest.log
2025-02-07 04:03:30.761 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:30.761 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:30.762 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:30.762 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.111.96
2025-02-07 04:03:30.762 DEBUG [src.node.docker_mananger] Generated ports ['14651', '14652', '14653', '14654', '14655']
2025-02-07 04:03:30.763 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:30.763 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:30.763 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:30.763 DEBUG [src.node.docker_mananger] docker run -i -t -p 14651:14651 -p 14652:14652 -p 14653:14653 -p 14654:14654 -p 14655:14655 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14653 --rest-port=14651 --tcp-port=14652 --discv5-udp-port=14654 --rest-address=0.0.0.0 --nat=extip:172.18.111.96 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cab4f2ffb2ca9abdf207ee6f87f4b169a65bfba98efdb85c8db7acd7f8faab4e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14655 --metrics-logging=true --relay=true --filter=true
2025-02-07 04:03:30.991 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.111.96 waku ec2e64b6da34709cf091800b5946c1eed59c49b2802f1497c82f1b8f9c28a95a
2025-02-07 04:03:31.040 DEBUG [src.node.docker_mananger] Container started with ID ec2e64b6da34. Setting up logs at ./log/docker/node1_2025-02-07_04-03-30__34e4b034-a332-4e4f-a4ef-203110ebc710__wakuorg_nwaku:latest.log
2025-02-07 04:03:31.040 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 14651
2025-02-07 04:03:31.040 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:31.557 ERROR [src.node.docker_mananger] Max retries reached for container c5321ec1925e. Exiting log stream.
2025-02-07 04:03:32.041 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14651/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:32.043 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:32.044 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:32.044 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14651/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:32.046 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.111.96/tcp/14652/p2p/16Uiu2HAmLFED1CgCTBydEYmLx7CcrqDmBSQgX16BKGEDa2174B5N","/ip4/172.18.111.96/tcp/14653/ws/p2p/16Uiu2HAmLFED1CgCTBydEYmLx7CcrqDmBSQgX16BKGEDa2174B5N"],"enrUri":"enr:-L24QKBrb_KziVtZfq6IQ875QbSbeTWhlLuVS70wz_3hT5R2MMe4r35TdgCysypQ9fpoAGQVdNO25QF0R4721JgyuqYCgmlkgnY0gmlwhKwSb2CKbXVsdGlhZGRyc5YACASsEm9gBjk8AAoErBJvYAY5Pd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDcMc5bNQkIE2UdXcnWZYuncVNa9A5LvbJzOpVPFuJi_2DdGNwgjk8g3VkcII5PoV3YWt1MgU"}'
2025-02-07 04:03:32.046 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:32.047 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-07 04:03:32.052 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-07 04:03:32.052 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-07_04-03-30__34e4b034-a332-4e4f-a4ef-203110ebc710__wakuorg_nwaku:latest.log
2025-02-07 04:03:32.053 DEBUG [src.node.waku_node] Starting Node...
2025-02-07 04:03:32.053 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-07 04:03:32.054 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-07 04:03:32.054 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.79.178
2025-02-07 04:03:32.054 DEBUG [src.node.docker_mananger] Generated ports ['17948', '17949', '17950', '17951', '17952']
2025-02-07 04:03:32.054 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-07 04:03:32.054 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-07 04:03:32.055 DEBUG [src.node.waku_node] Using volumes []
2025-02-07 04:03:32.055 DEBUG [src.node.docker_mananger] docker run -i -t -p 17948:17948 -p 17949:17949 -p 17950:17950 -p 17951:17951 -p 17952:17952 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17950 --rest-port=17948 --tcp-port=17949 --discv5-udp-port=17951 --rest-address=0.0.0.0 --nat=extip:172.18.79.178 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9f44f1c8ee2a45cd519364750fbeeeaa5ec0cbfbb0dc3a92aeade3fe0cd578c9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17952 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-L24QKBrb_KziVtZfq6IQ875QbSbeTWhlLuVS70wz_3hT5R2MMe4r35TdgCysypQ9fpoAGQVdNO25QF0R4721JgyuqYCgmlkgnY0gmlwhKwSb2CKbXVsdGlhZGRyc5YACASsEm9gBjk8AAoErBJvYAY5Pd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDcMc5bNQkIE2UdXcnWZYuncVNa9A5LvbJzOpVPFuJi_2DdGNwgjk8g3VkcII5PoV3YWt1MgU --filternode=/ip4/172.18.111.96/tcp/14652/p2p/16Uiu2HAmLFED1CgCTBydEYmLx7CcrqDmBSQgX16BKGEDa2174B5N
2025-02-07 04:03:32.285 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.79.178 waku c8ddb5b887295f344b7ebe6d92fe3b8cefb9d1e9e76eecf828a03cf4c6cfafb3
2025-02-07 04:03:32.332 DEBUG [src.node.docker_mananger] Container started with ID c8ddb5b88729. Setting up logs at ./log/docker/node2_2025-02-07_04-03-30__34e4b034-a332-4e4f-a4ef-203110ebc710__wakuorg_nwaku:latest.log
2025-02-07 04:03:32.332 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17948
2025-02-07 04:03:32.332 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-07 04:03:33.333 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17948/health" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:33.336 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-07 04:03:33.336 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-07 04:03:33.336 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17948/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:33.338 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.79.178/tcp/17949/p2p/16Uiu2HAmLZY9RFs7PRnp9NTFBxUf8B1SmasBy8fBfB76hnCc6NG1","/ip4/172.18.79.178/tcp/17950/ws/p2p/16Uiu2HAmLZY9RFs7PRnp9NTFBxUf8B1SmasBy8fBfB76hnCc6NG1"],"enrUri":"enr:-L24QN6nxsnULTbjL_3JPxzIHdpmRavUX_PEnYAlOUIuu6qlPLSsdsXvZrSizWgjVUdT6DQ_KzL4m_ydX02ACCD_FLwCgmlkgnY0gmlwhKwST7KKbXVsdGlhZGRyc5YACASsEk-yBkYdAAoErBJPsgZGHt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDdXf2Lr_9B-IQeX8FCRxhc7igjuT5NI8OYH0QpRlsx3KDdGNwgkYdg3VkcIJGH4V3YWt1MgA"}'
2025-02-07 04:03:33.338 INFO [src.node.waku_node] REST service is ready !!
2025-02-07 04:03:33.339 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17948/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.111.96/tcp/14652/p2p/16Uiu2HAmLFED1CgCTBydEYmLx7CcrqDmBSQgX16BKGEDa2174B5N"]'
2025-02-07 04:03:33.375 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:33.375 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-07 04:03:33.376 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14651/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-07 04:03:33.397 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:33.398 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17948/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "75dd3bed-7271-4bd9-acef-1f796ec6d94e", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-07 04:03:33.409 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"75dd3bed-7271-4bd9-acef-1f796ec6d94e","statusDesc":"OK"}'
2025-02-07 04:03:33.410 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14651/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:03:33.417 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:33.417 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:03:33.518 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:03:33.518 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17948/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:33.520 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738901013410102784,"ephemeral":false}]'
2025-02-07 04:03:33.522 INFO [src.node.api_clients.base_client] curl -v -X DELETE "http://127.0.0.1:17948/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-07 04:03:33.529 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
2025-02-07 04:03:33.530 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14651/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-07 04:03:33.533 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-07 04:03:33.533 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-07 04:03:33.633 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
2025-02-07 04:03:33.633 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17948/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-07 04:03:33.636 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:17948/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto. Response content: b'Not subscribed to topic: /test/1/waku-filter/proto'
2025-02-07 04:03:33.638 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-07 04:03:33.639 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-07 04:03:33.639 DEBUG [src.node.waku_node] Stopping container with id ec2e64b6da34
2025-02-07 04:03:34.637 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:03:34.637 DEBUG [src.node.waku_node] Stopping container with id c8ddb5b88729
2025-02-07 04:03:35.449 ERROR [src.node.docker_mananger] Max retries reached for container ec2e64b6da34. Exiting log stream.
2025-02-07 04:03:36.145 DEBUG [src.node.waku_node] Container stopped.
2025-02-07 04:03:36.147 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-07 04:03:36.152 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-07 04:03:36.156 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
