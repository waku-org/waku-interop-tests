[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_update_subscription_refresh_existing with id: 2024-10-10_04-17-33__0061163e-c10c-4132-ba3e-e212153c6fe6
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-10_04-17-33__0061163e-c10c-4132-ba3e-e212153c6fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.28.32
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['41331', '41332', '41333', '41334', '41335']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 41331:41331 -p 41332:41332 -p 41333:41333 -p 41334:41334 -p 41335:41335 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=41333 --rest-port=41331 --tcp-port=41332 --discv5-udp-port=41334 --rest-address=0.0.0.0 --nat=extip:172.18.28.32 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=42227b857c8834aba39cd0a0aa6f6c2c8b687cc1fe8fd051bdfceadbe99e3bc3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=41335 --metrics-logging=true --relay=true --filter=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.28.32 waku c688b615e914178363714fca30a0fe2588c5f90c0d4835def6003ae76bb499ac
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID c688b615e914. Setting up logs at ./log/docker/node1_2024-10-10_04-17-33__0061163e-c10c-4132-ba3e-e212153c6fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 41331
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41331/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41331/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.28.32/tcp/41332/p2p/16Uiu2HAm6vJr9rHyaJ8v371hEzx5cVdZkC6x9yXBL8Soy3U4z1cw","/ip4/172.18.28.32/tcp/41333/ws/p2p/16Uiu2HAm6vJr9rHyaJ8v371hEzx5cVdZkC6x9yXBL8Soy3U4z1cw"],"enrUri":"enr:-LO4QNuIhi3uZC6NcynNfzmo5hiSakN_N2mENHAc_3B2c7SNN_GboqXWYhtdZippk1iRaTZSMsnJPkYx6YxQhP5B2boBgmlkgnY0gmlwhKwSHCCKbXVsdGlhZGRyc4wACgSsEhwgBqF13QOCcnOFAAMBAACJc2VjcDI1NmsxoQKqxoGE5gxf5G4YvMl4Edv2XFBE08034bEnwkj_OLSunIN0Y3CCoXSDdWRwgqF2hXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-10_04-17-33__0061163e-c10c-4132-ba3e-e212153c6fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.245.43
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['2870', '2871', '2872', '2873', '2874']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 2870:2870 -p 2871:2871 -p 2872:2872 -p 2873:2873 -p 2874:2874 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2872 --rest-port=2870 --tcp-port=2871 --discv5-udp-port=2873 --rest-address=0.0.0.0 --nat=extip:172.18.245.43 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3ae0dfab3bb0aef4d7ce0e95c556c37999af5972d5c6eae22e0e6b94e0dfeaf2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2874 --metrics-logging=true --relay=false --discv5-bootstrap-node=enr:-LO4QNuIhi3uZC6NcynNfzmo5hiSakN_N2mENHAc_3B2c7SNN_GboqXWYhtdZippk1iRaTZSMsnJPkYx6YxQhP5B2boBgmlkgnY0gmlwhKwSHCCKbXVsdGlhZGRyc4wACgSsEhwgBqF13QOCcnOFAAMBAACJc2VjcDI1NmsxoQKqxoGE5gxf5G4YvMl4Edv2XFBE08034bEnwkj_OLSunIN0Y3CCoXSDdWRwgqF2hXdha3UyBQ --filternode=/ip4/172.18.28.32/tcp/41332/p2p/16Uiu2HAm6vJr9rHyaJ8v371hEzx5cVdZkC6x9yXBL8Soy3U4z1cw
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.245.43 waku f24d1b19f8d82767237fc2902ee37c5addb1a87f401ccea369b22077e1e81f87
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID f24d1b19f8d8. Setting up logs at ./log/docker/node2_2024-10-10_04-17-33__0061163e-c10c-4132-ba3e-e212153c6fe6__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 2870
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2870/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2870/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.245.43/tcp/2871/p2p/16Uiu2HAmUcjJF3A6cgbdVTsJnDSKTq1P3ZwiCfW4sfZ4BxkG4hKN","/ip4/172.18.245.43/tcp/2872/ws/p2p/16Uiu2HAmUcjJF3A6cgbdVTsJnDSKTq1P3ZwiCfW4sfZ4BxkG4hKN"],"enrUri":"enr:-LO4QEaHZsz5My_8qcTkAZTMzdY7Y2FdlxqHZdGLseNjCfY7cvon4xRSBrSNvnZJ564NWcbm2kiNZGBtv7wVheqBSHgBgmlkgnY0gmlwhKwS9SuKbXVsdGlhZGRyc4wACgSsEvUrBgs43QOCcnOFAAMBAACJc2VjcDI1NmsxoQPtJs8q290EcL9uSbon0MdVFJZunD57N8EptnreclGh0YN0Y3CCCzeDdWRwggs5hXdha3UyAA"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2870/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.28.32/tcp/41332/p2p/16Uiu2HAm6vJr9rHyaJ8v371hEzx5cVdZkC6x9yXBL8Soy3U4z1cw"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41331/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2870/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "f25f642c-e1cd-4278-8998-3bc9abd8974b", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"f25f642c-e1cd-4278-8998-3bc9abd8974b","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X PUT "http://127.0.0.1:2870/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41331/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2870/filter/v2/messages/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1728533856454060288,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id c688b615e914
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id f24d1b19f8d8
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.