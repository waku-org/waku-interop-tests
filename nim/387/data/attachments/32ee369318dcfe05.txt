[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_retrieve_messages_without_subscribing_via_api with id: 2024-10-10_04-28-34__2738f5af-a216-4f95-9e27-bcf4ee3b17ef
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-10_04-28-34__2738f5af-a216-4f95-9e27-bcf4ee3b17ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.93.13
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['46354', '46355', '46356', '46357', '46358']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 46354:46354 -p 46355:46355 -p 46356:46356 -p 46357:46357 -p 46358:46358 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46356 --rest-port=46354 --tcp-port=46355 --discv5-udp-port=46357 --rest-address=0.0.0.0 --nat=extip:172.18.93.13 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=adc5a79211c3be3fe10b5f0be7b405e29f3ecba47da987ffc8cd279cbc205a42 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46358 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.116.177
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['50857', '50858', '50859', '50860', '50861']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 50857:50857 -p 50858:50858 -p 50859:50859 -p 50860:50860 -p 50861:50861 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50859 --rest-port=50857 --tcp-port=50858 --discv5-udp-port=50860 --rest-address=0.0.0.0 --nat=extip:172.18.116.177 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=23babc55ef9adfc994140f9babd213c991e0d6e3ec158eb4ee8d8e51dde45bef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50861 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.116.177 waku 9c4f6190f3b3bc242be62fbfa55d4e78d721b6ed3ec38aa6263e399c690ee21e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 9c4f6190f3b3. Setting up logs at ./log/docker/node1_2024-10-10_04-28-34__2738f5af-a216-4f95-9e27-bcf4ee3b17ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 50857
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50857/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50857/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.116.177/tcp/50858/p2p/16Uiu2HAm3PU7UVGNpT1CgZnFkY53svX8AaMuPtsfg4QkZ9R8apoN","/ip4/172.18.116.177/tcp/50859/ws/p2p/16Uiu2HAm3PU7UVGNpT1CgZnFkY53svX8AaMuPtsfg4QkZ9R8apoN"],"enrUri":"enr:-LO4QMul4gEZE7ZUsA9wqCc9kK5VoVLcroBtTY808GCymHL3ITrijz3Y2pTsWYTifQTbiUz4IbdGOs_NQvH-3w0ABmQBgmlkgnY0gmlwhKwSdLGKbXVsdGlhZGRyc4wACgSsEnSxBsar3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJ2TOpDmHbgJ-_RUg0hxkWdq4tIpGOUpWhjx3GP0EJctYN0Y3CCxqqDdWRwgsashXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-10_04-28-34__2738f5af-a216-4f95-9e27-bcf4ee3b17ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.132.122
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['36220', '36221', '36222', '36223', '36224']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 36220:36220 -p 36221:36221 -p 36222:36222 -p 36223:36223 -p 36224:36224 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=36222 --rest-port=36220 --tcp-port=36221 --discv5-udp-port=36223 --rest-address=0.0.0.0 --nat=extip:172.18.132.122 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=daa9a4f3c5affcd51d5025605ceacc60bada02ff6fd65eac9f1f3dddcbd6cd3a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=36224 --metrics-logging=true --relay=true --discv5-bootstrap-node=enr:-LO4QMul4gEZE7ZUsA9wqCc9kK5VoVLcroBtTY808GCymHL3ITrijz3Y2pTsWYTifQTbiUz4IbdGOs_NQvH-3w0ABmQBgmlkgnY0gmlwhKwSdLGKbXVsdGlhZGRyc4wACgSsEnSxBsar3QOCcnOFAAIBAACJc2VjcDI1NmsxoQJ2TOpDmHbgJ-_RUg0hxkWdq4tIpGOUpWhjx3GP0EJctYN0Y3CCxqqDdWRwgsashXdha3UyBQ --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.132.122 waku 36d86291f4f74c5159ec24f91cdf7e4ab78692ec19eb8b61f3e43d2d50f4d71e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 36d86291f4f7. Setting up logs at ./log/docker/node2_2024-10-10_04-28-34__2738f5af-a216-4f95-9e27-bcf4ee3b17ef__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 36220
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36220/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36220/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.132.122/tcp/36221/p2p/16Uiu2HAmJM8BRAZHCWydHS4izGFQZBbLNLSjCq7dsPyfzwV5UVej","/ip4/172.18.132.122/tcp/36222/ws/p2p/16Uiu2HAmJM8BRAZHCWydHS4izGFQZBbLNLSjCq7dsPyfzwV5UVej"],"enrUri":"enr:-LO4QP3QKmkex80W0OXnnp8w1avVYYO_fywNnqNPIAE8HjLychZTs0rUZrcHigq3sNxrQ1Iq1Irnhg34-ZDDrOPtqcQBgmlkgnY0gmlwhKwShHqKbXVsdGlhZGRyc4wACgSsEoR6Bo1-3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNUkoUpUgwtY2GA7W3XZE6L2P0S9sWWkS3vakISSchydIN0Y3CCjX2DdWRwgo1_hXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36220/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.116.177/tcp/50858/p2p/16Uiu2HAm3PU7UVGNpT1CgZnFkY53svX8AaMuPtsfg4QkZ9R8apoN"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:50857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:50857/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728534518816559104,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36220/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728534518816559104,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 9c4f6190f3b3
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 36d86291f4f7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.