[35mDEBUG   [0m src.postgres_setup:postgres_setup.py:36 Postgres container started
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_on_empty_postgress_db with id: 2024-10-10_04-34-33__ed3bba96-d3a2-4028-a4f7-5f37388ccdaf
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-10-10_04-34-33__ed3bba96-d3a2-4028-a4f7-5f37388ccdaf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.71.27
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['3786', '3787', '3788', '3789', '3790']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 3786:3786 -p 3787:3787 -p 3788:3788 -p 3789:3789 -p 3790:3790 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3788 --rest-port=3786 --tcp-port=3787 --discv5-udp-port=3789 --rest-address=0.0.0.0 --nat=extip:172.18.71.27 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5b01c4f651ac2bdeddfa0c25baa0d28e82df41fedc74c75d31adde591bae03cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3790 --metrics-logging=true --store=true --relay=true --store-message-db-url=postgres://postgres:test123@postgres:5432/postgres
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.71.27 waku 71e86029ec80a9dede018f8fceaa408aaa78e20c2a65e3b2ec11a4b05ae91a0e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 71e86029ec80. Setting up logs at ./log/docker/publishing_node1_2024-10-10_04-34-33__ed3bba96-d3a2-4028-a4f7-5f37388ccdaf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 3786
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3786/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Initializing","protocolsHealth":[]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3786/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Initializing","protocolsHealth":[]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3786/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3786/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.71.27/tcp/3787/p2p/16Uiu2HAm2e9eTn2B7ByP7WmyY1ThDxU5Rzj4L7kN4jes61skM3DU","/ip4/172.18.71.27/tcp/3788/ws/p2p/16Uiu2HAm2e9eTn2B7ByP7WmyY1ThDxU5Rzj4L7kN4jes61skM3DU"],"enrUri":"enr:-LO4QAVqnzmbwMl-aiR92YOf9n2eAW9oHC9x2GCTuu5adAZCT3antVlENV3xItcf000oSlsBDo1-4eY69zhz7vHb6S8BgmlkgnY0gmlwhKwSRxuKbXVsdGlhZGRyc4wACgSsEkcbBg7M3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJrNA-gK98zJKallOpBxT06NslNej1DNOI2GduSzH4rq4N0Y3CCDsuDdWRwgg7NhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-10-10_04-34-33__ed3bba96-d3a2-4028-a4f7-5f37388ccdaf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.135.122
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['57710', '57711', '57712', '57713', '57714']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 57710:57710 -p 57711:57711 -p 57712:57712 -p 57713:57713 -p 57714:57714 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=57712 --rest-port=57710 --tcp-port=57711 --discv5-udp-port=57713 --rest-address=0.0.0.0 --nat=extip:172.18.135.122 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5d17881251d59be20f49b2f6be0d4670a82b7dfc3f9a9dc2ddd5b8036dbc8cdf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=57714 --metrics-logging=true --discv5-bootstrap-node=enr:-LO4QAVqnzmbwMl-aiR92YOf9n2eAW9oHC9x2GCTuu5adAZCT3antVlENV3xItcf000oSlsBDo1-4eY69zhz7vHb6S8BgmlkgnY0gmlwhKwSRxuKbXVsdGlhZGRyc4wACgSsEkcbBg7M3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJrNA-gK98zJKallOpBxT06NslNej1DNOI2GduSzH4rq4N0Y3CCDsuDdWRwgg7NhXdha3UyAw --storenode=/ip4/172.18.71.27/tcp/3787/p2p/16Uiu2HAm2e9eTn2B7ByP7WmyY1ThDxU5Rzj4L7kN4jes61skM3DU --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.135.122 waku 1fc410360ee2467ab55c065bf3248f795d1db08e97d20a68d1e682fa3f9a877a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 1fc410360ee2. Setting up logs at ./log/docker/store_node1_2024-10-10_04-34-33__ed3bba96-d3a2-4028-a4f7-5f37388ccdaf__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 57710
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57710/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57710/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.135.122/tcp/57711/p2p/16Uiu2HAmPdr4zBhJ6QnmWxer34GPUULsFRgfjt8s3VWEJM3qJPkZ","/ip4/172.18.135.122/tcp/57712/ws/p2p/16Uiu2HAmPdr4zBhJ6QnmWxer34GPUULsFRgfjt8s3VWEJM3qJPkZ"],"enrUri":"enr:-LO4QNBXVD26_yltfys9MY1BgzUgMtCiQMlj6B7QIkP_PUuoO35XW63DJcvTqMnR848Or1J7H_0P1913gcEqkoD5qHkBgmlkgnY0gmlwhKwSh3qKbXVsdGlhZGRyc4wACgSsEod6BuFw3QOCcnOFAAMBAACJc2VjcDI1NmsxoQOjJZynE9cqPEhPJPJjLF2OThnw1oETspuG2FXaCu10XoN0Y3CC4W-DdWRwguFxhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57710/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.71.27/tcp/3787/p2p/16Uiu2HAm2e9eTn2B7ByP7WmyY1ThDxU5Rzj4L7kN4jes61skM3DU"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3786/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:57710/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3786/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3786/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"GaHNvqWYoHQRm2CpDzU5kFtOJoValCTILX9CTylvX18="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:57710/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"0f6ee2175fbae68f3d69","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"GaHNvqWYoHQRm2CpDzU5kFtOJoValCTILX9CTylvX18="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 71e86029ec80
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1fc410360ee2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.postgres_setup:postgres_setup.py:44 Postgres container stopped and removed.