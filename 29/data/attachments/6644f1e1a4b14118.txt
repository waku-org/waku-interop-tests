[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_publish_after_node1_restarts with id: 2024-01-18_10-23-56__d9154080-2b1c-4e27-98ce-107b3e7813c1
[35mDEBUG   [0m src.steps.relay:relay.py:23 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:29 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node1_2024-01-18_10-23-56__d9154080-2b1c-4e27-98ce-107b3e7813c1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.160.123
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['11478', '11479', '11480', '11481', '11482']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=11480', '--rest-port=11478', '--tcp-port=11479', '--discv5-udp-port=11481', '--rest-address=0.0.0.0', '--nat=extip:172.18.160.123', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID f5f848da70b0. Setting up logs at ./log/docker/node1_2024-01-18_10-23-56__d9154080-2b1c-4e27-98ce-107b3e7813c1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 11478
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:11478/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QH850MfXs2zL1FZK0pLs8UE3JD9365Un4t-I7xc2ms_SK0wsdPK8m_WGjnlRnNHk8DtVbqWBiWW-0KmjUGS0a4KGAY0cGU0xgmlkgnY0gmlwhKwRAAeKbXVsdGlhZGRyc5gACgR_AAABBizY3QMACgSsEQAHBizY3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCLNeDdWRwgizZhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/11479/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/11480/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.7/tcp/11479/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.7/tcp/11480/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node2_2024-01-18_10-23-56__d9154080-2b1c-4e27-98ce-107b3e7813c1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.116.62
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['63174', '63175', '63176', '63177', '63178']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=63176', '--rest-port=63174', '--tcp-port=63175', '--discv5-udp-port=63177', '--rest-address=0.0.0.0', '--nat=extip:172.18.116.62', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--discv5-bootstrap-node=enr:-Ly4QH850MfXs2zL1FZK0pLs8UE3JD9365Un4t-I7xc2ms_SK0wsdPK8m_WGjnlRnNHk8DtVbqWBiWW-0KmjUGS0a4KGAY0cGU0xgmlkgnY0gmlwhKwRAAeKbXVsdGlhZGRyc5gACgR_AAABBizY3QMACgSsEQAHBizY3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCLNeDdWRwgizZhXdha3UyAQ']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID 336f9e7b2203. Setting up logs at ./log/docker/node2_2024-01-18_10-23-56__d9154080-2b1c-4e27-98ce-107b3e7813c1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 63174
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:63174/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QI5MgtUmK_LkvgQkRdR7z1RpRpcrVtjCiCc8IntdOPnnC0suy6c9N6ZXyt8wKTolCGJsOdEr5zUflgKnNjgqN8OGAY0cGVNdgmlkgnY0gmlwhKwRAAmKbXVsdGlhZGRyc5gACgSsEQAJBvbI3QMACgR_AAABBvbI3QOJc2VjcDI1NmsxoQOu6pdN6zdFCvi8ywoDpqC8k9jErBvikFUZ3i6k19AVYIN0Y3CC9seDdWRwgvbJhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/63175/p2p/16Uiu2HAmQRnmEnu7Rn27Mwqy8wGaR9c6mgq1Hkn7aZrzYoJ6EcLo","/ip4/127.0.0.1/tcp/63176/ws/p2p/16Uiu2HAmQRnmEnu7Rn27Mwqy8wGaR9c6mgq1Hkn7aZrzYoJ6EcLo","/ip4/172.17.0.9/tcp/63175/p2p/16Uiu2HAmQRnmEnu7Rn27Mwqy8wGaR9c6mgq1Hkn7aZrzYoJ6EcLo","/ip4/172.17.0.9/tcp/63176/ws/p2p/16Uiu2HAmQRnmEnu7Rn27Mwqy8wGaR9c6mgq1Hkn7aZrzYoJ6EcLo"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.steps.relay:relay.py:51 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:11478/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:63174/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:11478/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573439435229184}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:11478/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573439435229184}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:63174/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573439435229184}]'
[32mINFO    [0m src.steps.relay:relay.py:63 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:11478/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573439552302080}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:11478/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573439552302080}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:63174/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573439552302080}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:97 Restarting container with id f5f848da70b0
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:11478/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:11478/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QHg_quSNcHDisLhtJ3ak039BgtTS2BJXXCwg7uN-jY1pVCT0lwwt1WMbEoYwJb4yWy0MvsTOb5e2Af9gnj3uqFuGAY0cGWymgmlkgnY0gmlwhKwRAAaKbXVsdGlhZGRyc5gACgR_AAABBizY3QMACgSsEQAGBizY3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCLNeDdWRwgizZhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/11479/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/11480/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.6/tcp/11479/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.6/tcp/11480/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:11478/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:63174/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:11478/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573446846970368}
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:11478/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id f5f848da70b0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id 336f9e7b2203
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node2_2024-01-18_10-23-56__d9154080-2b1c-4e27-98ce-107b3e7813c1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node1_2024-01-18_10-23-56__d9154080-2b1c-4e27-98ce-107b3e7813c1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_publish_after_node1_restarts with id: 2024-01-18_10-24-12__ba8bfbd8-f1c6-4d89-809d-847c0c43d09f
[35mDEBUG   [0m src.steps.relay:relay.py:23 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:29 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node1_2024-01-18_10-24-12__ba8bfbd8-f1c6-4d89-809d-847c0c43d09f__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.148.208
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['16644', '16645', '16646', '16647', '16648']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=16646', '--rest-port=16644', '--tcp-port=16645', '--discv5-udp-port=16647', '--rest-address=0.0.0.0', '--nat=extip:172.18.148.208', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID 2a898f6152dc. Setting up logs at ./log/docker/node1_2024-01-18_10-24-12__ba8bfbd8-f1c6-4d89-809d-847c0c43d09f__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 16644
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:16644/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QJTSSRv_251KjNk0ADGGFBmLlhxGxC-m9Es556aCBEj4TnxYPgXfL8sGdYfpK-z_WTPYwJvGOvBjKQw7dvvTIEuGAY0cGYtHgmlkgnY0gmlwhKwRAASKbXVsdGlhZGRyc5gACgR_AAABBkEG3QMACgSsEQAEBkEG3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCQQWDdWRwgkEHhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/16645/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/16646/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.4/tcp/16645/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.4/tcp/16646/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node2_2024-01-18_10-24-12__ba8bfbd8-f1c6-4d89-809d-847c0c43d09f__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.74.171
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['53206', '53207', '53208', '53209', '53210']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=53208', '--rest-port=53206', '--tcp-port=53207', '--discv5-udp-port=53209', '--rest-address=0.0.0.0', '--nat=extip:172.18.74.171', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--discv5-bootstrap-node=enr:-Ly4QJTSSRv_251KjNk0ADGGFBmLlhxGxC-m9Es556aCBEj4TnxYPgXfL8sGdYfpK-z_WTPYwJvGOvBjKQw7dvvTIEuGAY0cGYtHgmlkgnY0gmlwhKwRAASKbXVsdGlhZGRyc5gACgR_AAABBkEG3QMACgSsEQAEBkEG3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCQQWDdWRwgkEHhXdha3UyAQ']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID 470d180421d3. Setting up logs at ./log/docker/node2_2024-01-18_10-24-12__ba8bfbd8-f1c6-4d89-809d-847c0c43d09f__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 53206
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:53206/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QGvff-iv0CeEf08-lpwrYqW2ht_TX17rARG-rIBNMo44MGnY9wt7GZ_gH-zPIsDgt7lpZxGzNHE3omhj6onouqSGAY0cGZM0gmlkgnY0gmlwhKwRAAeKbXVsdGlhZGRyc5gACgSsEQAHBs_Y3QMACgR_AAABBs_Y3QOJc2VjcDI1NmsxoQN8velZB3AkUj0e1QJ3fIk7fc0isIfaVMijrM1_2X17gYN0Y3CCz9eDdWRwgs_ZhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/53207/p2p/16Uiu2HAmM3vs4GV7yfrnS7KdUNwhdERuqZQqcaLcuuBuJ41hM8xp","/ip4/127.0.0.1/tcp/53208/ws/p2p/16Uiu2HAmM3vs4GV7yfrnS7KdUNwhdERuqZQqcaLcuuBuJ41hM8xp","/ip4/172.17.0.7/tcp/53207/p2p/16Uiu2HAmM3vs4GV7yfrnS7KdUNwhdERuqZQqcaLcuuBuJ41hM8xp","/ip4/172.17.0.7/tcp/53208/ws/p2p/16Uiu2HAmM3vs4GV7yfrnS7KdUNwhdERuqZQqcaLcuuBuJ41hM8xp"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.steps.relay:relay.py:51 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:16644/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:53206/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:16644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573455739141632}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:16644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573455739141632}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:53206/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573455739141632}]'
[32mINFO    [0m src.steps.relay:relay.py:63 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:16644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573455853123072}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:16644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573455853123072}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:53206/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573455853123072}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:97 Restarting container with id 2a898f6152dc
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:16644/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:16644/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:16644/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QLBwoPIVPFSRO238XG0rvUkj2Oe_5Ty-bpqYZPOfDnzZHpwkz-FGXqZUwpZpSlSTZtrepp7rCPOmDuIGDy-P7GmGAY0cGavBgmlkgnY0gmlwhKwRAAOKbXVsdGlhZGRyc5gACgR_AAABBkEG3QMACgSsEQADBkEG3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCQQWDdWRwgkEHhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/16645/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/16646/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.3/tcp/16645/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.3/tcp/16646/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:16644/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:53206/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:16644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573463070239488}
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:16644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id 2a898f6152dc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id 470d180421d3
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node1_2024-01-18_10-24-12__ba8bfbd8-f1c6-4d89-809d-847c0c43d09f__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node2_2024-01-18_10-24-12__ba8bfbd8-f1c6-4d89-809d-847c0c43d09f__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_publish_after_node1_restarts with id: 2024-01-18_10-24-28__51ff5c5e-379e-4d38-a9ff-b83c171ceb0a
[35mDEBUG   [0m src.steps.relay:relay.py:23 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:29 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node1_2024-01-18_10-24-28__51ff5c5e-379e-4d38-a9ff-b83c171ceb0a__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.81.224
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['58916', '58917', '58918', '58919', '58920']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=58918', '--rest-port=58916', '--tcp-port=58917', '--discv5-udp-port=58919', '--rest-address=0.0.0.0', '--nat=extip:172.18.81.224', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID 900af999849f. Setting up logs at ./log/docker/node1_2024-01-18_10-24-28__51ff5c5e-379e-4d38-a9ff-b83c171ceb0a__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 58916
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:58916/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QN-8OPd4CcRuHAsjmy7mZt6nICuXTgXZMGVHvRHp_DkcDYKkhC-xyobYDr6nj8ZAlGDN3wSnGkvyEN_KKo7PwhKGAY0cGc0EgmlkgnY0gmlwhKwRAAiKbXVsdGlhZGRyc5gACgR_AAABBuYm3QMACgSsEQAIBuYm3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC5iWDdWRwguYnhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/58917/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/58918/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.8/tcp/58917/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.8/tcp/58918/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node2_2024-01-18_10-24-28__51ff5c5e-379e-4d38-a9ff-b83c171ceb0a__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.57.112
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['20420', '20421', '20422', '20423', '20424']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=20422', '--rest-port=20420', '--tcp-port=20421', '--discv5-udp-port=20423', '--rest-address=0.0.0.0', '--nat=extip:172.18.57.112', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--discv5-bootstrap-node=enr:-Ly4QN-8OPd4CcRuHAsjmy7mZt6nICuXTgXZMGVHvRHp_DkcDYKkhC-xyobYDr6nj8ZAlGDN3wSnGkvyEN_KKo7PwhKGAY0cGc0EgmlkgnY0gmlwhKwRAAiKbXVsdGlhZGRyc5gACgR_AAABBuYm3QMACgSsEQAIBuYm3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC5iWDdWRwguYnhXdha3UyAQ']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID 0f8e4bdc5a3d. Setting up logs at ./log/docker/node2_2024-01-18_10-24-28__51ff5c5e-379e-4d38-a9ff-b83c171ceb0a__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 20420
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:20420/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QOlEyKKJYFwDqHvlA67-g5G1bYgzB6PYST8wY0b3_b4ICt7oMzNEN7cEz1-0fLIkDC3_zKmJyhCPS7-BLsrk3OSGAY0cGdOjgmlkgnY0gmlwhKwRAAWKbXVsdGlhZGRyc5gACgSsEQAFBk_G3QMACgR_AAABBk_G3QOJc2VjcDI1NmsxoQNMGmLSLlTfg5I6g3vLlSSn_8BxFF1Sv18i5TJxOIG2UIN0Y3CCT8WDdWRwgk_HhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/20421/p2p/16Uiu2HAmHn4fuURH36Mv71Du3RwNks9d4V2YVghhvSNZdd8hvoMh","/ip4/127.0.0.1/tcp/20422/ws/p2p/16Uiu2HAmHn4fuURH36Mv71Du3RwNks9d4V2YVghhvSNZdd8hvoMh","/ip4/172.17.0.5/tcp/20421/p2p/16Uiu2HAmHn4fuURH36Mv71Du3RwNks9d4V2YVghhvSNZdd8hvoMh","/ip4/172.17.0.5/tcp/20422/ws/p2p/16Uiu2HAmHn4fuURH36Mv71Du3RwNks9d4V2YVghhvSNZdd8hvoMh"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.steps.relay:relay.py:51 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:58916/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:20420/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:58916/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573472289943296}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:58916/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573472289943296}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:20420/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573472289943296}]'
[32mINFO    [0m src.steps.relay:relay.py:63 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:58916/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573472406527488}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:58916/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573472406527488}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:20420/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573472406527488}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:97 Restarting container with id 900af999849f
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:58916/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:58916/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QHkmOSIfku8kbU-C_mVVA09WRjpUooA3LmZlEFL74XxZXzu9AL_LVlxrsZYSrevgYWufWXjJg88G5IJR0HjTF-qGAY0cGe_0gmlkgnY0gmlwhKwRAAeKbXVsdGlhZGRyc5gACgR_AAABBuYm3QMACgSsEQAHBuYm3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CC5iWDdWRwguYnhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/58917/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/58918/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.7/tcp/58917/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.7/tcp/58918/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:58916/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:20420/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:58916/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573480476377856}
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:58916/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id 900af999849f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id 0f8e4bdc5a3d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node1_2024-01-18_10-24-28__51ff5c5e-379e-4d38-a9ff-b83c171ceb0a__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node2_2024-01-18_10-24-28__51ff5c5e-379e-4d38-a9ff-b83c171ceb0a__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_publish_after_node1_restarts with id: 2024-01-18_10-24-46__f66e6141-5aa0-4366-9363-118948b41a11
[35mDEBUG   [0m src.steps.relay:relay.py:23 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:29 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node1_2024-01-18_10-24-46__f66e6141-5aa0-4366-9363-118948b41a11__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.179.181
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['57450', '57451', '57452', '57453', '57454']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=57452', '--rest-port=57450', '--tcp-port=57451', '--discv5-udp-port=57453', '--rest-address=0.0.0.0', '--nat=extip:172.18.179.181', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.136.94
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['21962', '21963', '21964', '21965', '21966']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=21964', '--rest-port=21962', '--tcp-port=21963', '--discv5-udp-port=21965', '--rest-address=0.0.0.0', '--nat=extip:172.18.136.94', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID 352a048149aa. Setting up logs at ./log/docker/node1_2024-01-18_10-24-46__f66e6141-5aa0-4366-9363-118948b41a11__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 21962
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:21962/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QMFJ5PWSKE18OmjxRSo7NnAp3_VC7NHfL-mWeBaL4_u2G7YHCRgVtbs2FRDNy6Kkvq4Y7VvVtxey7tZK1fFRuNWGAY0cGhSIgmlkgnY0gmlwhKwRAASKbXVsdGlhZGRyc5gACgR_AAABBlXM3QMACgSsEQAEBlXM3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCVcuDdWRwglXNhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/21963/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/21964/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.4/tcp/21963/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.4/tcp/21964/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node2_2024-01-18_10-24-46__f66e6141-5aa0-4366-9363-118948b41a11__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.132.84
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['24904', '24905', '24906', '24907', '24908']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=24906', '--rest-port=24904', '--tcp-port=24905', '--discv5-udp-port=24907', '--rest-address=0.0.0.0', '--nat=extip:172.18.132.84', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--discv5-bootstrap-node=enr:-Ly4QMFJ5PWSKE18OmjxRSo7NnAp3_VC7NHfL-mWeBaL4_u2G7YHCRgVtbs2FRDNy6Kkvq4Y7VvVtxey7tZK1fFRuNWGAY0cGhSIgmlkgnY0gmlwhKwRAASKbXVsdGlhZGRyc5gACgR_AAABBlXM3QMACgSsEQAEBlXM3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCVcuDdWRwglXNhXdha3UyAQ']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID a4fe4e99b3a1. Setting up logs at ./log/docker/node2_2024-01-18_10-24-46__f66e6141-5aa0-4366-9363-118948b41a11__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 24904
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:24904/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QIuwfupe-Qw-t2jSNACduT5rhaF1fIItFBnULQkKjMnITsuX-iGFh-3gmAkilInHwmz6OCDAURkmlCjLfeQjJMyGAY0cGhrugmlkgnY0gmlwhKwRAAiKbXVsdGlhZGRyc5gACgSsEQAIBmFK3QMACgR_AAABBmFK3QOJc2VjcDI1NmsxoQNA6mrj-wxaTsPWz-Eb1iUIpNU6kGT4K7pETXSDrdMC74N0Y3CCYUmDdWRwgmFLhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/24905/p2p/16Uiu2HAmH2PmE9jSr6ZvdeKHx5zHpmuSpMQGbQ3jYNuqtmb7cjsU","/ip4/127.0.0.1/tcp/24906/ws/p2p/16Uiu2HAmH2PmE9jSr6ZvdeKHx5zHpmuSpMQGbQ3jYNuqtmb7cjsU","/ip4/172.17.0.8/tcp/24905/p2p/16Uiu2HAmH2PmE9jSr6ZvdeKHx5zHpmuSpMQGbQ3jYNuqtmb7cjsU","/ip4/172.17.0.8/tcp/24906/ws/p2p/16Uiu2HAmH2PmE9jSr6ZvdeKHx5zHpmuSpMQGbQ3jYNuqtmb7cjsU"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.steps.relay:relay.py:51 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:21962/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:24904/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:21962/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573490394468096}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:21962/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573490394468096}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:24904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573490394468096}]'
[32mINFO    [0m src.steps.relay:relay.py:63 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:21962/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573490507473920}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:21962/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573490507473920}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:24904/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573490507473920}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:97 Restarting container with id 352a048149aa
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:21962/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:21962/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QDbPNGhmD9mDFz6U_Q92DhtkoHei-NIl72gWRo1pxkF2NYrm8fjpzRVjts3V70H1riRP1vPKsWAOZ0yXX4-Mul-GAY0cGjUJgmlkgnY0gmlwhKwRAAKKbXVsdGlhZGRyc5gACgR_AAABBlXM3QMACgSsEQACBlXM3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCVcuDdWRwglXNhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/21963/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/21964/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.2/tcp/21963/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.2/tcp/21964/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:21962/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:24904/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:21962/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573498143233536}
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:21962/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id 352a048149aa
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id a4fe4e99b3a1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:65 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:66 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node2_2024-01-18_10-24-46__f66e6141-5aa0-4366-9363-118948b41a11__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:28 Attaching file ./log/docker/node1_2024-01-18_10-24-46__f66e6141-5aa0-4366-9363-118948b41a11__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_publish_after_node1_restarts with id: 2024-01-18_10-25-05__f3d1d8f9-8a8a-4951-8ac3-d03043955723
[35mDEBUG   [0m src.steps.relay:relay.py:23 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.relay:relay.py:29 Running fixture setup: setup_main_relay_nodes
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node1_2024-01-18_10-25-05__f3d1d8f9-8a8a-4951-8ac3-d03043955723__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.12.172
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['37002', '37003', '37004', '37005', '37006']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=37004', '--rest-port=37002', '--tcp-port=37003', '--discv5-udp-port=37005', '--rest-address=0.0.0.0', '--nat=extip:172.18.12.172', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID 94bac4f8839a. Setting up logs at ./log/docker/node1_2024-01-18_10-25-05__f3d1d8f9-8a8a-4951-8ac3-d03043955723__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 37002
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:37002/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QB2r2UiQGAMNnzIbfSXEX6_ajN5j3aCZXbcwaK67OgMqcB1GbDCIb2YwTibQCmZTP2L7N69YWOz_IF-PsJfjX3mGAY0cGlosgmlkgnY0gmlwhKwRAAKKbXVsdGlhZGRyc5gACgSsEQACBpCM3QMACgR_AAABBpCM3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCkIuDdWRwgpCNhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/37003/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/37004/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.2/tcp/37003/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.2/tcp/37004/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:21 WakuNode instance initialized with log path ./log/docker/node2_2024-01-18_10-25-05__f3d1d8f9-8a8a-4951-8ac3-d03043955723__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:25 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated random external IP 172.18.148.209
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:66 Generated ports ['4125', '4126', '4127', '4128', '4129']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:42 Starting container with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:43 Using args ['--listen-address=0.0.0.0', '--rest=true', '--rest-admin=true', '--websocket-support=true', '--log-level=DEBUG', '--rest-relay-cache-capacity=100', '--websocket-port=4127', '--rest-port=4125', '--tcp-port=4126', '--discv5-udp-port=4128', '--rest-address=0.0.0.0', '--nat=extip:172.18.148.209', '--peer-exchange=true', '--discv5-discovery=true', '--cluster-id=0', '--min-relay-peers-to-publish=1', '--legacy-filter=false', '--rest-filter-cache-capacity=50', '--relay=true', '--discv5-bootstrap-node=enr:-Ly4QB2r2UiQGAMNnzIbfSXEX6_ajN5j3aCZXbcwaK67OgMqcB1GbDCIb2YwTibQCmZTP2L7N69YWOz_IF-PsJfjX3mGAY0cGlosgmlkgnY0gmlwhKwRAAKKbXVsdGlhZGRyc5gACgSsEQACBpCM3QMACgR_AAABBpCM3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCkIuDdWRwgpCNhXdha3UyAQ']
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 Container started with ID a102611b1718. Setting up logs at ./log/docker/node2_2024-01-18_10-25-05__f3d1d8f9-8a8a-4951-8ac3-d03043955723__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:78 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 4125
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:4125/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QNyDQJkonQPoSam6IhaekouKoXa_avoSxvNfSR-qXH0eSAIcEwp5xinl_Yoz_GEeOHYsaXUa_CxGCVAeNspDXW2GAY0cGl-_gmlkgnY0gmlwhKwRAAOKbXVsdGlhZGRyc5gACgSsEQADBhAf3QMACgR_AAABBhAf3QOJc2VjcDI1NmsxoQNeGtdVztuqD6kIEeTh10K5mVmf70S5GKLqLAF8YVCXCoN0Y3CCEB6DdWRwghAghXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/4126/p2p/16Uiu2HAmJzLQtURLHV5to6EN3iZj8ZMu4wGBXK8LawycnoCnb6ZP","/ip4/127.0.0.1/tcp/4127/ws/p2p/16Uiu2HAmJzLQtURLHV5to6EN3iZj8ZMu4wGBXK8LawycnoCnb6ZP","/ip4/172.17.0.3/tcp/4126/p2p/16Uiu2HAmJzLQtURLHV5to6EN3iZj8ZMu4wGBXK8LawycnoCnb6ZP","/ip4/172.17.0.3/tcp/4127/ws/p2p/16Uiu2HAmJzLQtURLHV5to6EN3iZj8ZMu4wGBXK8LawycnoCnb6ZP"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.steps.relay:relay.py:51 Running fixture setup: subscribe_main_relay_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:37002/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:4125/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:37002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573508054968320}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:37002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573508054968320}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:4125/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573508054968320}]'
[32mINFO    [0m src.steps.relay:relay.py:63 WARM UP successful!!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:37002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573508166161408}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:37002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573508166161408}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:4125/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573508166161408}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:97 Restarting container with id 94bac4f8839a
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:37002/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:37002/debug/v1/info with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QGZL2Egw69mFBBrj-IY8D_rzAEigUvpGkobuxqSM7RaCas3O2zkUoRrXzKKXNsot-9U0t2IRsoqo4vaCEVBFZ0GGAY0cGmqigmlkgnY0gmlwhKwRAAKKbXVsdGlhZGRyc5gACgR_AAABBpCM3QMACgSsEQACBpCM3QOJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCkIuDdWRwgpCNhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/37003/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/127.0.0.1/tcp/37004/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.2/tcp/37003/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.17.0.2/tcp/37004/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:113 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:37002/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:4125/relay/v1/subscriptions with payload: ["/waku/2/rs/0/1"]
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 POST call: http://127.0.0.1:37002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1705573511873459456}
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:33 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_1:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:37002/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573511873459456}]'
[35mDEBUG   [0m src.steps.relay:relay.py:83 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:11 GET call: http://127.0.0.1:4125/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1 with payload: None
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","timestamp":1705573511873459456}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id 94bac4f8839a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:90 Stopping container with id a102611b1718
[35mDEBUG   [0m src.node.waku_node:waku_node.py:93 Container stopped.