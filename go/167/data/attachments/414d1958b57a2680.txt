[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_message_with_both_ephemeral_true_and_false with id: 2024-06-17_13-23-39__32e01de7-a947-4578-b426-fe75996ad6e1
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:27 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-06-17_13-23-39__32e01de7-a947-4578-b426-fe75996ad6e1__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.136.218
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['7972', '7973', '7974', '7975', '7976']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:373 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:120 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:122 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 7972:7972 -p 7973:7973 -p 7974:7974 -p 7975:7975 -p 7976:7976 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7974 --rest-port=7972 --tcp-port=7973 --discv5-udp-port=7975 --rest-address=0.0.0.0 --nat=extip:172.18.136.218 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7976 --metrics-logging=true --store=true --relay=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.136.218 waku 296e7bb5e39ff24602093d0245c5525c5ac71293f843c2b9949f85692b03fe94
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 296e7bb5e39f. Setting up logs at ./log/docker/publishing_node1_2024-06-17_13-23-39__32e01de7-a947-4578-b426-fe75996ad6e1__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:134 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 7972
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7972/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:225 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7972/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.136.218/tcp/7973/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.136.218/tcp/7974/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LO4QAXT9X2cPYPjm_dnofpKEmAwXbh01WMJG5K64mEadngVYeN7PcH56mkbkiIsDMn3jundoBGhPvUF5Dn34PVdJ0EBgmlkgnY0gmlwhKwSiNqKbXVsdGlhZGRyc4wACgSsEojaBh8m3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCHyWDdWRwgh8nhXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:230 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:48 WakuNode instance initialized with log path ./log/docker/store_node1_2024-06-17_13-23-39__32e01de7-a947-4578-b426-fe75996ad6e1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.169.43
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['59792', '59793', '59794', '59795', '59796']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:373 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:120 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:122 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 59792:59792 -p 59793:59793 -p 59794:59794 -p 59795:59795 -p 59796:59796 harbor.status.im/wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=59794 --rest-port=59792 --tcp-port=59793 --discv5-udp-port=59795 --rest-address=0.0.0.0 --nat=extip:172.18.169.43 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --discv5-bootstrap-node=enr:-LO4QAXT9X2cPYPjm_dnofpKEmAwXbh01WMJG5K64mEadngVYeN7PcH56mkbkiIsDMn3jundoBGhPvUF5Dn34PVdJ0EBgmlkgnY0gmlwhKwSiNqKbXVsdGlhZGRyc4wACgSsEojaBh8m3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCHyWDdWRwgh8nhXdha3UyAw --storenode=/ip4/172.18.136.218/tcp/7973/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --store=true --relay=true
[35mDEBUG   [0m src.node.waku_node:waku_node.py:52 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.112.225
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['37080', '37081', '37082', '37083', '37084']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:373 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:120 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:122 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 37080:37080 -p 37081:37081 -p 37082:37082 -p 37083:37083 -p 37084:37084 harbor.status.im/wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=37082 --rest-port=37080 --tcp-port=37081 --discv5-udp-port=37083 --rest-address=0.0.0.0 --nat=extip:172.18.112.225 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --discv5-bootstrap-node=enr:-LO4QAXT9X2cPYPjm_dnofpKEmAwXbh01WMJG5K64mEadngVYeN7PcH56mkbkiIsDMn3jundoBGhPvUF5Dn34PVdJ0EBgmlkgnY0gmlwhKwSiNqKbXVsdGlhZGRyc4wACgSsEojaBh8m3QOCcnOFAAABAACJc2VjcDI1NmsxoQM3Tqpf5eFn4Jztm4gB0Y0JVSJyxyZsW8QR-QU5DZb-PYN0Y3CCHyWDdWRwgh8nhXdha3UyAw --storenode=/ip4/172.18.136.218/tcp/7973/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.112.225 waku bcf314d3082ccd435265f077744af89e5a4a8be50ccc2c6b76a9c005e20a70a5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID bcf314d3082c. Setting up logs at ./log/docker/store_node1_2024-06-17_13-23-39__32e01de7-a947-4578-b426-fe75996ad6e1__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:134 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 37080
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37080/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QC6CmgI3rbHqF9UIBbX2CO90bVBGqQ4Tm1luQCfiitfoKouAPMK6MhyqL6f6emolOMSXbMsuSxq6gjjY7qhFb9iGAZAmXiB_gmlkgnY0gmlwhKwRAAmKbXVsdGlhZGRyc5gACgSsEQAJBpDa3QMACgR_AAABBpDa3QOJc2VjcDI1NmsxoQNwCaQ_-hGYpQg4Kt9tpnNT-mEKMCnyEF8PEs3HX3AJ8IN0Y3CCkNmDdWRwgpDbhXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/37081/p2p/16Uiu2HAmLCLYGLVKvFjmHVbZkP6qCmWLv11Sk7wZ9Mzm4V5gYaP9","/ip4/127.0.0.1/tcp/37082/ws/p2p/16Uiu2HAmLCLYGLVKvFjmHVbZkP6qCmWLv11Sk7wZ9Mzm4V5gYaP9","/ip4/172.17.0.9/tcp/37081/p2p/16Uiu2HAmLCLYGLVKvFjmHVbZkP6qCmWLv11Sk7wZ9Mzm4V5gYaP9","/ip4/172.17.0.9/tcp/37082/ws/p2p/16Uiu2HAmLCLYGLVKvFjmHVbZkP6qCmWLv11Sk7wZ9Mzm4V5gYaP9"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:230 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37080/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.136.218/tcp/7973/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7972/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:37080/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.steps.store:store.py:127 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7972/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.01 seconds
[35mDEBUG   [0m src.steps.store:store.py:127 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7972/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.01 seconds
[35mDEBUG   [0m src.steps.store:store.py:209 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7972/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"6nqbiZyu/QGg/CYkz9Z0koqXIehGh70XrHMWvmttvVw="}]}'
[35mDEBUG   [0m src.steps.store:store.py:209 Checking that peer harbor.status.im/wakuorg/go-waku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37080/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"50b2f7dba5c1afedbdb65a89eb8d3e8c34611501cc9f0c1a9dc1802f8600602a","status_code":200,"status_desc":"OK","messages":[{"message_hash":"6nqbiZyu/QGg/CYkz9Z0koqXIehGh70XrHMWvmttvVw="}]}'
[35mDEBUG   [0m src.steps.store:store.py:127 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7972/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": false}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.01 seconds
[35mDEBUG   [0m src.steps.store:store.py:127 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7972/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.01 seconds
[35mDEBUG   [0m src.steps.store:store.py:209 Checking that peer harbor.status.im/wakuorg/nwaku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7972/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"6nqbiZyu/QGg/CYkz9Z0koqXIehGh70XrHMWvmttvVw="},{"messageHash":"bvCxjFkVmbtVg3p4lFZzZ5w2YofC8OftqddQ4y6BMA8="}]}'
[35mDEBUG   [0m src.steps.store:store.py:209 Checking that peer harbor.status.im/wakuorg/go-waku:latest can find the stored message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:37080/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F0%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"8cc7053cb8f494f8cb205e4353cc8fde4dd9c2c6a20607cc864b02aadabb676e","status_code":200,"status_desc":"OK","messages":[{"message_hash":"6nqbiZyu/QGg/CYkz9Z0koqXIehGh70XrHMWvmttvVw="},{"message_hash":"bvCxjFkVmbtVg3p4lFZzZ5w2YofC8OftqddQ4y6BMA8="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:181 Stopping container with id 296e7bb5e39f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:188 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:181 Stopping container with id bcf314d3082c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:188 Container stopped.