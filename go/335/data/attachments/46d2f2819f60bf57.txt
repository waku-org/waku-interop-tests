[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_message_with_ephemeral_true with id: 2024-11-06_09-04-51__0366ce1b-fb7d-4f3a-a7ac-e7752052398d
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:39 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-11-06_09-04-51__0366ce1b-fb7d-4f3a-a7ac-e7752052398d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.208.137
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['8080', '8081', '8082', '8083', '8084']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 8080:8080 -p 8081:8081 -p 8082:8082 -p 8083:8083 -p 8084:8084 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8082 --rest-port=8080 --tcp-port=8081 --discv5-udp-port=8083 --rest-address=0.0.0.0 --nat=extip:172.18.208.137 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5aeaf6e19dda55afdd61a7dcdda7ed508bc456fad85c9d4249ab3ad76c12ee8a --max-connections=1000 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8084 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.237.107
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['24366', '24367', '24368', '24369', '24370']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 24366:24366 -p 24367:24367 -p 24368:24368 -p 24369:24369 -p 24370:24370 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24368 --rest-port=24366 --tcp-port=24367 --discv5-udp-port=24369 --rest-address=0.0.0.0 --nat=extip:172.18.237.107 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fb5d07e79299bcfd0b6fd9f2ee30e0e01bba23d94d5bfddce9a86646cd9f0e64 --max-connections=1000 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24370 --metrics-logging=true --store=true --relay=true
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 90ff3d099558. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.237.107 waku 3195eaedaf46073638bd8fa36ca62068f0c525fd2ebe855c16c35824ac9c1415
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3195eaedaf46. Setting up logs at ./log/docker/publishing_node1_2024-11-06_09-04-51__0366ce1b-fb7d-4f3a-a7ac-e7752052398d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/nwaku:latest. REST: 24366
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24366/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:278 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24366/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.237.107/tcp/24367/p2p/16Uiu2HAm2WhtWVQLykTQHv44uGGuwGnbsjweEJSQL2DkWe8G7Spt","/ip4/172.18.237.107/tcp/24368/ws/p2p/16Uiu2HAm2WhtWVQLykTQHv44uGGuwGnbsjweEJSQL2DkWe8G7Spt"],"enrUri":"enr:-L24QE1IVRHodfBlSv-7GPaDVm4QlUa5Zpunjpl8wBb0atf-I9qty8sCAJtkBkTG22C1uNAnu7QswRNk0HJxni-sKZQCgmlkgnY0gmlwhKwS7WuKbXVsdGlhZGRyc5YACASsEu1rBl8vAAoErBLtawZfMN0DgnJzhQADAQAAiXNlY3AyNTZrMaECaUve9K5Jv3UuZQ4BI1yYogi66wsJlIa1IOZG8mPD0l2DdGNwgl8vg3VkcIJfMYV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-11-06_09-04-51__0366ce1b-fb7d-4f3a-a7ac-e7752052398d__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.123.71
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['18712', '18713', '18714', '18715', '18716']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 18712:18712 -p 18713:18713 -p 18714:18714 -p 18715:18715 -p 18716:18716 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=18714 --rest-port=18712 --tcp-port=18713 --discv5-udp-port=18715 --rest-address=0.0.0.0 --nat=extip:172.18.123.71 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=52d417d4953f7ffd66fb8c6f7d12b26c0691abfedae31eaf2ffdca5aafdfefad --max-connections=1000 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QE1IVRHodfBlSv-7GPaDVm4QlUa5Zpunjpl8wBb0atf-I9qty8sCAJtkBkTG22C1uNAnu7QswRNk0HJxni-sKZQCgmlkgnY0gmlwhKwS7WuKbXVsdGlhZGRyc5YACASsEu1rBl8vAAoErBLtawZfMN0DgnJzhQADAQAAiXNlY3AyNTZrMaECaUve9K5Jv3UuZQ4BI1yYogi66wsJlIa1IOZG8mPD0l2DdGNwgl8vg3VkcIJfMYV3YWt1MgM --storenode=/ip4/172.18.237.107/tcp/24367/p2p/16Uiu2HAm2WhtWVQLykTQHv44uGGuwGnbsjweEJSQL2DkWe8G7Spt --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.123.71 waku 3904130d87a302ee17b3ee82622515045ee49d1a29101d700c10e427be1177ba
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3904130d87a3. Setting up logs at ./log/docker/store_node1_2024-11-06_09-04-51__0366ce1b-fb7d-4f3a-a7ac-e7752052398d__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/go-waku:latest. REST: 18712
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18712/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QBsTkODAEdhBLS7_vDuGcjQLqcOnTOcFnNjyD77se3zQEvpF34xAMAJHQUTwTFVNWJ1VTqqaINFXewrsWDgZyH-GAZMAuFU8gmlkgnY0gmlwhKwRACmJc2VjcDI1NmsxoQPhDvv-k5R5RyGSGhhZJQKqeEstZq00ExrTlDlaUPmfD4N0Y3CCSRmDdWRwgkkbhXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/18713/p2p/16Uiu2HAmToXLNjKKcKU3ZDZuLx5X6ykMPyq39bEBts31MgYRiAWr","/ip4/127.0.0.1/tcp/18714/ws/p2p/16Uiu2HAmToXLNjKKcKU3ZDZuLx5X6ykMPyq39bEBts31MgYRiAWr","/ip4/172.17.0.41/tcp/18713/p2p/16Uiu2HAmToXLNjKKcKU3ZDZuLx5X6ykMPyq39bEBts31MgYRiAWr","/ip4/172.17.0.41/tcp/18714/ws/p2p/16Uiu2HAmToXLNjKKcKU3ZDZuLx5X6ykMPyq39bEBts31MgYRiAWr"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18712/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.237.107/tcp/24367/p2p/16Uiu2HAm2WhtWVQLykTQHv44uGGuwGnbsjweEJSQL2DkWe8G7Spt", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:24366/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18712/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:24366/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24366/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 3195eaedaf46
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 3904130d87a3
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3195eaedaf46. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.