[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_relay_receiving_node_not_connected_directly_to_lightpushing_node with id: 2024-10-03_03-17-41__78ca9fc6-f2ab-4666-9097-1dd6c369ba87
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-03_03-17-41__78ca9fc6-f2ab-4666-9097-1dd6c369ba87__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-03_03-17-41__78ca9fc6-f2ab-4666-9097-1dd6c369ba87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-10-03_03-17-41__78ca9fc6-f2ab-4666-9097-1dd6c369ba87__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.68.115
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['41210', '41211', '41212', '41213', '41214']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 41210:41210 -p 41211:41211 -p 41212:41212 -p 41213:41213 -p 41214:41214 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=41212 --rest-port=41210 --tcp-port=41211 --discv5-udp-port=41213 --rest-address=0.0.0.0 --nat=extip:172.18.68.115 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e2af77fb1f5c3cecf6ba4b3e0b30ed17fdf6d2097651edae6bbda6b8b8d5b511 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.68.115 waku 39f6d0f3ecb1afdeb2b53ac5e8b4599d3e9d0079f1162423ca07053426937f48
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 39f6d0f3ecb1. Setting up logs at ./log/docker/node1_2024-10-03_03-17-41__78ca9fc6-f2ab-4666-9097-1dd6c369ba87__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/go-waku:latest. REST: 41210
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41210/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QKPh8uUwbrS-cS6KCkNEyV7mzG6lTo54R257RH4A0jaOY0B2ua60-tQhY2jz8g7e04b_lNcTABJJFfj-6GvGBDGGAZJQYiJvgmlkgnY0gmlwhKwRAAeJc2VjcDI1NmsxoQN4pIGZ1wkklMzdFhIag8-S5IpLLW7A75ZNQmdR4rZbv4N0Y3CCoPuDdWRwgqD9hXdha3UyCQ","listenAddresses":["/ip4/127.0.0.1/tcp/41211/p2p/16Uiu2HAmLmvmJ7UooNcfBFubuEtWi5ABQnVa7e3kpmY1vbipezsG","/ip4/127.0.0.1/tcp/41212/ws/p2p/16Uiu2HAmLmvmJ7UooNcfBFubuEtWi5ABQnVa7e3kpmY1vbipezsG","/ip4/172.17.0.7/tcp/41211/p2p/16Uiu2HAmLmvmJ7UooNcfBFubuEtWi5ABQnVa7e3kpmY1vbipezsG","/ip4/172.17.0.7/tcp/41212/ws/p2p/16Uiu2HAmLmvmJ7UooNcfBFubuEtWi5ABQnVa7e3kpmY1vbipezsG"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.90.32
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['47844', '47845', '47846', '47847', '47848']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 47844:47844 -p 47845:47845 -p 47846:47846 -p 47847:47847 -p 47848:47848 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47846 --rest-port=47844 --tcp-port=47845 --discv5-udp-port=47847 --rest-address=0.0.0.0 --nat=extip:172.18.90.32 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4488ea45abdc2cce4a3d29129a229ce7cbcd4e5c507934bdb2a0ddb1ace7a9bc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47848 --metrics-logging=true --lightpush=true --relay=true --discv5-bootstrap-node=enr:-Ji4QKPh8uUwbrS-cS6KCkNEyV7mzG6lTo54R257RH4A0jaOY0B2ua60-tQhY2jz8g7e04b_lNcTABJJFfj-6GvGBDGGAZJQYiJvgmlkgnY0gmlwhKwRAAeJc2VjcDI1NmsxoQN4pIGZ1wkklMzdFhIag8-S5IpLLW7A75ZNQmdR4rZbv4N0Y3CCoPuDdWRwgqD9hXdha3UyCQ --lightpushnode=/ip4/172.18.68.115/tcp/41211/p2p/16Uiu2HAmLmvmJ7UooNcfBFubuEtWi5ABQnVa7e3kpmY1vbipezsG
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.90.32 waku f0269cc34388d635ea87251102c21f4384e8ae3c1228356574ec48ae661f2fc3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID f0269cc34388. Setting up logs at ./log/docker/node2_2024-10-03_03-17-41__78ca9fc6-f2ab-4666-9097-1dd6c369ba87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 47844
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47844/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47844/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.90.32/tcp/47845/p2p/16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q","/ip4/172.18.90.32/tcp/47846/ws/p2p/16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q"],"enrUri":"enr:-LO4QL4PRaO2kx6fqGgU-an59SFjvn3kdHrne5k-gi0c6iexOYRRV0b6Mso81xeoiW7KkLnS-IYxBQoH2J4V_K7bsrUBgmlkgnY0gmlwhKwSWiCKbXVsdGlhZGRyc4wACgSsElogBrrm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLjaScTD0bEqwTFTo6w2nFgmgXZ92pq-zFUd9j_GnEbVoN0Y3CCuuWDdWRwgrrnhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.216.56
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['43979', '43980', '43981', '43982', '43983']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 43979:43979 -p 43980:43980 -p 43981:43981 -p 43982:43982 -p 43983:43983 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=43981 --rest-port=43979 --tcp-port=43980 --discv5-udp-port=43982 --rest-address=0.0.0.0 --nat=extip:172.18.216.56 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=00bf4c6baffcbd4a07aedaa34db6eaaec8b6aa4546fdac20ed5f87db2f14faea --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-LO4QL4PRaO2kx6fqGgU-an59SFjvn3kdHrne5k-gi0c6iexOYRRV0b6Mso81xeoiW7KkLnS-IYxBQoH2J4V_K7bsrUBgmlkgnY0gmlwhKwSWiCKbXVsdGlhZGRyc4wACgSsElogBrrm3QOCcnOFAAMBAACJc2VjcDI1NmsxoQLjaScTD0bEqwTFTo6w2nFgmgXZ92pq-zFUd9j_GnEbVoN0Y3CCuuWDdWRwgrrnhXdha3UyCQ
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.216.56 waku 00021bb6e192b56762efd6bb2a2a9b97fca464f86373fe158095d406bae8e2bd
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 00021bb6e192. Setting up logs at ./log/docker/node3_2024-10-03_03-17-41__78ca9fc6-f2ab-4666-9097-1dd6c369ba87__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/go-waku:latest. REST: 43979
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43979/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QMXMTdD9rP8C62xDYHQoi_tOoF92ADO69SfF-whV8u-ldrmFdzgObxCB5hMZK7SAfis6pXpzLq6UnApsqsvze7iGAZJQYi0ggmlkgnY0gmlwhKwRAAWJc2VjcDI1NmsxoQPNoovHM8KNn71g3IZqRQY9-BucipP5a1kyV7pIS7IFToN0Y3CCq8yDdWRwgqvOhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/43980/p2p/16Uiu2HAmSVhghD4StmBvDG48bbGUgympBtxDxpLxiMyWg7SmWNsX","/ip4/127.0.0.1/tcp/43981/ws/p2p/16Uiu2HAmSVhghD4StmBvDG48bbGUgympBtxDxpLxiMyWg7SmWNsX","/ip4/172.17.0.5/tcp/43980/p2p/16Uiu2HAmSVhghD4StmBvDG48bbGUgympBtxDxpLxiMyWg7SmWNsX","/ip4/172.17.0.5/tcp/43981/ws/p2p/16Uiu2HAmSVhghD4StmBvDG48bbGUgympBtxDxpLxiMyWg7SmWNsX"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41210/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:47844/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43979/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41210/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41210/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41210/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:41210/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"id":"16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q","multiaddrs":["/ip4/172.18.90.32/tcp/47845/p2p/16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q","/ip4/172.18.90.32/tcp/47846/ws/p2p/16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q"],"protocols":["/vac/waku/lightpush/2.0.0-beta1","/vac/waku/relay/2.0.0"],"connected":true,"pubsubTopics":["/waku/2/rs/3/0","/waku/2/rs/3/1"]}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47844/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.17.0.7/tcp/41211/p2p/16Uiu2HAmLmvmJ7UooNcfBFubuEtWi5ABQnVa7e3kpmY1vbipezsG","protocols":[{"protocol":"/vac/waku/relay/2.0.0","connected":true},{"protocol":"/vac/waku/lightpush/2.0.0-beta1","connected":true},{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"Discv5"}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43979/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"id":"16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q","multiaddrs":["/ip4/172.18.90.32/tcp/47845/p2p/16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q","/ip4/172.18.90.32/tcp/47846/ws/p2p/16Uiu2HAmAjPXQ55VWitbvBXGFs9rq9hPwNkaZKpFiemQfMiyYw8q"],"protocols":["/vac/waku/lightpush/2.0.0-beta1","/vac/waku/relay/2.0.0"],"connected":false,"pubsubTopics":["/waku/2/rs/3/0"]}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:120 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:41210/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": 1727925498416285184}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:124 Checking that peer NODE_1:wakuorg/go-waku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43979/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1727925498416285184,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 39f6d0f3ecb1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id f0269cc34388
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 00021bb6e192
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.