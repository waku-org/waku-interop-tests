2025-02-09 03:08:39.236 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-09 03:08:39.236 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-09_03-08-39__1bf015c3-67a3-473b-a953-615af6c8a7bb
2025-02-09 03:08:39.237 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-09 03:08:39.237 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-09 03:08:39.237 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-09 03:08:39.243 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-09 03:08:39.244 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-09_03-08-39__1bf015c3-67a3-473b-a953-615af6c8a7bb__wakuorg_nwaku:latest.log
2025-02-09 03:08:39.244 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 03:08:39.244 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 03:08:39.245 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 03:08:39.245 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.254.41
2025-02-09 03:08:39.245 DEBUG [src.node.docker_mananger] Generated ports ['2611', '2612', '2613', '2614', '2615']
2025-02-09 03:08:39.246 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 03:08:39.246 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 03:08:39.246 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 03:08:39.246 DEBUG [src.node.docker_mananger] docker run -i -t -p 2611:2611 -p 2612:2612 -p 2613:2613 -p 2614:2614 -p 2615:2615 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2613 --rest-port=2611 --tcp-port=2612 --discv5-udp-port=2614 --rest-address=0.0.0.0 --nat=extip:172.18.254.41 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d8ae9f4d47bdf4e9dbdb96eefb6afaee2cd7ede80cec4631a3ac01497f1eccfc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2615 --metrics-logging=true --relay=true
2025-02-09 03:08:39.484 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.254.41 waku cba534dce639307f77db0dedcdf8bec2aa987585d0104cdd91a09cab88f3ecdd
2025-02-09 03:08:39.539 DEBUG [src.node.docker_mananger] Container started with ID cba534dce639. Setting up logs at ./log/docker/node1_2025-02-09_03-08-39__1bf015c3-67a3-473b-a953-615af6c8a7bb__wakuorg_nwaku:latest.log
2025-02-09 03:08:39.541 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 2611
2025-02-09 03:08:39.541 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 03:08:40.031 ERROR [src.node.docker_mananger] Max retries reached for container bf91dd426ba7. Exiting log stream.
2025-02-09 03:08:40.541 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2611/health" -H "Content-Type: application/json" -d 'None'
2025-02-09 03:08:40.544 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-09 03:08:40.544 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-09 03:08:40.544 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2611/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 03:08:40.547 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.254.41/tcp/2612/p2p/16Uiu2HAmCqM6e9YaNCksMMdogCaoFo66E4oVcqEtAEzR1BY45MNV","/ip4/172.18.254.41/tcp/2613/ws/p2p/16Uiu2HAmCqM6e9YaNCksMMdogCaoFo66E4oVcqEtAEzR1BY45MNV"],"enrUri":"enr:-L24QAGwZz5xVSfKtyGOi6FuiyDefcN4g7SaBWgzT8Nuls6fHOoZlS3DujLenYNjpneiV8QeTM-x-iBfniBpqdBC8xcCgmlkgnY0gmlwhKwS_imKbXVsdGlhZGRyc5YACASsEv4pBgo0AAoErBL-KQYKNd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAqdEbV5Pmm5H1OXaX0MhwOOarAJmYMHgeGmUOILaxl6DdGNwggo0g3VkcIIKNoV3YWt1MgE"}'
2025-02-09 03:08:40.547 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 03:08:40.553 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-09 03:08:40.553 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-09_03-08-39__1bf015c3-67a3-473b-a953-615af6c8a7bb__wakuorg_go-waku:latest.log
2025-02-09 03:08:40.554 DEBUG [src.node.waku_node] Starting Node...
2025-02-09 03:08:40.554 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-09 03:08:40.555 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-09 03:08:40.555 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.161.247
2025-02-09 03:08:40.555 DEBUG [src.node.docker_mananger] Generated ports ['29493', '29494', '29495', '29496', '29497']
2025-02-09 03:08:40.555 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-09 03:08:40.555 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-09 03:08:40.556 DEBUG [src.node.waku_node] Using volumes []
2025-02-09 03:08:40.556 DEBUG [src.node.docker_mananger] docker run -i -t -p 29493:29493 -p 29494:29494 -p 29495:29495 -p 29496:29496 -p 29497:29497 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=29495 --rest-port=29493 --tcp-port=29494 --discv5-udp-port=29496 --rest-address=0.0.0.0 --nat=extip:172.18.161.247 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=586feddb4a4bb85b1ab36ea42bb398c8eefccd74b15d2c9caa7a3ab3a7f17e03 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QAGwZz5xVSfKtyGOi6FuiyDefcN4g7SaBWgzT8Nuls6fHOoZlS3DujLenYNjpneiV8QeTM-x-iBfniBpqdBC8xcCgmlkgnY0gmlwhKwS_imKbXVsdGlhZGRyc5YACASsEv4pBgo0AAoErBL-KQYKNd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAqdEbV5Pmm5H1OXaX0MhwOOarAJmYMHgeGmUOILaxl6DdGNwggo0g3VkcIIKNoV3YWt1MgE
2025-02-09 03:08:40.799 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.161.247 waku 3f2986abaa4f0bda6eee3d5b44f0a0922c77cad1373dff8e20113084ad39d0e0
2025-02-09 03:08:40.854 DEBUG [src.node.docker_mananger] Container started with ID 3f2986abaa4f. Setting up logs at ./log/docker/node2_2025-02-09_03-08-39__1bf015c3-67a3-473b-a953-615af6c8a7bb__wakuorg_go-waku:latest.log
2025-02-09 03:08:40.856 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 29493
2025-02-09 03:08:40.856 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-09 03:08:41.856 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29493/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-09 03:08:41.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QAORfaLpUjTBhynsL5Ab9a1Kn3O5rrY22FQabN1mm_K-Cxt15FFUdIAzfkN54ZATjGu-GKPbE97wfSeYNf6LMNWGAZTorj4NgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaED311KP-dyMcQSkz2vs12NQPk4JAdd3R8s6_4vwrtbfcaDdGNwgnM2g3VkcIJzOIV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/29494/p2p/16Uiu2HAmTgump1RP6GviDmiPTYAxjGVsMGMSPdny8yrPXHtpJmEm","/ip4/127.0.0.1/tcp/29495/ws/p2p/16Uiu2HAmTgump1RP6GviDmiPTYAxjGVsMGMSPdny8yrPXHtpJmEm","/ip4/172.17.0.3/tcp/29494/p2p/16Uiu2HAmTgump1RP6GviDmiPTYAxjGVsMGMSPdny8yrPXHtpJmEm","/ip4/172.17.0.3/tcp/29495/ws/p2p/16Uiu2HAmTgump1RP6GviDmiPTYAxjGVsMGMSPdny8yrPXHtpJmEm"]}'
2025-02-09 03:08:41.859 INFO [src.node.waku_node] REST service is ready !!
2025-02-09 03:08:41.860 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29493/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.254.41/tcp/2612/p2p/16Uiu2HAmCqM6e9YaNCksMMdogCaoFo66E4oVcqEtAEzR1BY45MNV", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-09 03:08:41.881 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-09 03:08:41.882 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-09 03:08:41.883 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 03:08:41.906 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 03:08:41.907 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29493/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-09 03:08:41.909 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-09 03:08:41.912 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 03:08:41.923 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 03:08:41.924 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 03:08:42.024 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 03:08:42.024 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 03:08:42.027 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739070521911774976,"ephemeral":false}]'
2025-02-09 03:08:42.028 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-09 03:08:42.029 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29493/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 03:08:42.030 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-09 03:08:43.031 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-09 03:08:43.036 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-09 03:08:43.036 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-09 03:08:43.137 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-09 03:08:43.137 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 03:08:43.140 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739070523031536640,"ephemeral":false}]'
2025-02-09 03:08:43.141 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-09 03:08:43.141 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29493/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-09 03:08:43.143 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739070523031536640,"ephemeral":false}]'
2025-02-09 03:08:43.144 INFO [src.steps.relay] WARM UP successful!!
2025-02-09 03:08:43.145 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-09 03:08:43.146 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-09 03:08:43.148 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 03:08:43.149 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-09 03:08:43.149 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-09 03:08:43.151 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 03:08:43.151 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-09 03:08:43.152 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-09 03:08:43.154 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 03:08:43.154 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-09 03:08:43.154 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-09 03:08:43.157 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 03:08:43.157 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-09 03:08:43.157 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-09 03:08:43.159 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:2611/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-09 03:08:43.161 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-09 03:08:43.162 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-09 03:08:43.162 DEBUG [src.node.waku_node] Stopping container with id cba534dce639
2025-02-09 03:08:43.748 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 03:08:43.748 DEBUG [src.node.waku_node] Stopping container with id 3f2986abaa4f
2025-02-09 03:08:44.251 DEBUG [src.node.waku_node] Container stopped.
2025-02-09 03:08:44.254 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-09 03:08:44.260 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-09 03:08:44.262 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
