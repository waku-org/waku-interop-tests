[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_different_shard with id: 2024-11-07_11-53-08__405b24a8-9ed3-4b50-97f5-f2df25211831
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-07_11-53-08__405b24a8-9ed3-4b50-97f5-f2df25211831__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.134.219
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59551', '59552', '59553', '59554', '59555']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59551:59551 -p 59552:59552 -p 59553:59553 -p 59554:59554 -p 59555:59555 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59553 --rest-port=59551 --tcp-port=59552 --discv5-udp-port=59554 --rest-address=0.0.0.0 --nat=extip:172.18.134.219 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=79aacdea10d8daee0fa96ddd6e065c90ef9deddf9c0fc6183cf6fbd8f3f8faea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59555 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.134.219 waku 9cdeb64c027d9d6014d783fddef02d98b7a01553f303962ad50e8f89ab988ef5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 9cdeb64c027d. Setting up logs at ./log/docker/node1_2024-11-07_11-53-08__405b24a8-9ed3-4b50-97f5-f2df25211831__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 59551
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 63aebf6f78a2. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59551/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59551/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.134.219/tcp/59552/p2p/16Uiu2HAkwvTAYKenXXE9qbU6925yKpb6EPL3FShrKTXaaizCygjL","/ip4/172.18.134.219/tcp/59553/ws/p2p/16Uiu2HAkwvTAYKenXXE9qbU6925yKpb6EPL3FShrKTXaaizCygjL"],"enrUri":"enr:-L24QM9PwQZDV666Qo8M4faQoctxqf5dK9O4y9YyRYbQ1Lm7HeE1IMxWvjxBl0-YXyUmr4CNH1-KBTYvr_oucDmckjoCgmlkgnY0gmlwhKwShtuKbXVsdGlhZGRyc5YACASsEobbBuigAAoErBKG2wbood0DgnJzhQACAQAAiXNlY3AyNTZrMaECJRa6SbFm38nlCb0o5tlkmB9Osn9Y919Wz3wmUetMEuODdGNwguigg3VkcILoooV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-07_11-53-08__405b24a8-9ed3-4b50-97f5-f2df25211831__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.134.132
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29709', '29710', '29711', '29712', '29713']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29709:29709 -p 29710:29710 -p 29711:29711 -p 29712:29712 -p 29713:29713 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=29711 --rest-port=29709 --tcp-port=29710 --discv5-udp-port=29712 --rest-address=0.0.0.0 --nat=extip:172.18.134.132 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=6aa223a094ccfbba270c6f0a2316ecf793b2175bd2c2a76fcb6a4380df7eee4e --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QM9PwQZDV666Qo8M4faQoctxqf5dK9O4y9YyRYbQ1Lm7HeE1IMxWvjxBl0-YXyUmr4CNH1-KBTYvr_oucDmckjoCgmlkgnY0gmlwhKwShtuKbXVsdGlhZGRyc5YACASsEobbBuigAAoErBKG2wbood0DgnJzhQACAQAAiXNlY3AyNTZrMaECJRa6SbFm38nlCb0o5tlkmB9Osn9Y919Wz3wmUetMEuODdGNwguigg3VkcILoooV3YWt1MgU --pubsub-topic=/waku/2/rs/4/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.134.132 waku 4c8894fb86b6a39707472b748f7f754dd6b16467e266a21b55bb914d2c616066
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 4c8894fb86b6. Setting up logs at ./log/docker/node2_2024-11-07_11-53-08__405b24a8-9ed3-4b50-97f5-f2df25211831__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 29709
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29709/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QPKsShabL6irPxyN3Od6Y_a8o9h_MRiUyw7zFcbEHWicPe71lOMIsLDRIHZkHR8XbuOWZuETVaJlhNao2_B97MSGAZMGeKYDgmlkgnY0gmlwhKwRAAaCcnOFAAQBAAGJc2VjcDI1NmsxoQM-bS9DBnLJflspWD5x8WR3bwcvF6Erwnj3m1DU9gGIpYN0Y3CCdA6DdWRwgnQQhXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/29710/p2p/16Uiu2HAmGrgC3r1RQnWeQSFWkqbD9Jw1ZbJzLp2kuUBev8kox7FA","/ip4/127.0.0.1/tcp/29711/ws/p2p/16Uiu2HAmGrgC3r1RQnWeQSFWkqbD9Jw1ZbJzLp2kuUBev8kox7FA","/ip4/172.17.0.6/tcp/29710/p2p/16Uiu2HAmGrgC3r1RQnWeQSFWkqbD9Jw1ZbJzLp2kuUBev8kox7FA","/ip4/172.17.0.6/tcp/29711/ws/p2p/16Uiu2HAmGrgC3r1RQnWeQSFWkqbD9Jw1ZbJzLp2kuUBev8kox7FA"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29709/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.134.219/tcp/59552/p2p/16Uiu2HAkwvTAYKenXXE9qbU6925yKpb6EPL3FShrKTXaaizCygjL", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59551/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29709/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59551/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59551/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1730980391494208768,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29709/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:29709/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b'no subscription found for pubsubTopic'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 9cdeb64c027d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 4c8894fb86b6
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 9cdeb64c027d. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.