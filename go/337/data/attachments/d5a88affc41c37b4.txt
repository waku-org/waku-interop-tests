[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_store_node_restarts with id: 2024-11-06_12-53-31__8b391cd2-8208-425d-a2af-d8806ce7b655
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:39 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-11-06_12-53-31__8b391cd2-8208-425d-a2af-d8806ce7b655__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.147.183
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['33212', '33213', '33214', '33215', '33216']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 33212:33212 -p 33213:33213 -p 33214:33214 -p 33215:33215 -p 33216:33216 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33214 --rest-port=33212 --tcp-port=33213 --discv5-udp-port=33215 --rest-address=0.0.0.0 --nat=extip:172.18.147.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=03ac2bc969adb3e7c724b7a8cdf384afa3bd749fe402ce2c174b4c690bd0bfdb --max-connections=1000 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33216 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.147.183 waku 980b5ac59bc07bcbf85325a6788495592c36314dd6eb7f2302cf8565e7e7562c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 980b5ac59bc0. Setting up logs at ./log/docker/publishing_node1_2024-11-06_12-53-31__8b391cd2-8208-425d-a2af-d8806ce7b655__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/nwaku:latest. REST: 33212
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 88bbdaefffda. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33212/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:278 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33212/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.147.183/tcp/33213/p2p/16Uiu2HAmVEFKcbECGmfhugpoiP3Zcd5h4Dq34vHppJNGFX3JDtYF","/ip4/172.18.147.183/tcp/33214/ws/p2p/16Uiu2HAmVEFKcbECGmfhugpoiP3Zcd5h4Dq34vHppJNGFX3JDtYF"],"enrUri":"enr:-L24QBhKv7dIfX9Bi-V8gEZVgnpa_s--kcc2dLAVaTLorWytEx8U7SiK1g_BynNt6YmrzptsmBZWH_gHPQiXhYGMVP8CgmlkgnY0gmlwhKwSk7eKbXVsdGlhZGRyc5YACASsEpO3BoG9AAoErBKTtwaBvt0DgnJzhQADAQAAiXNlY3AyNTZrMaED9kAV3ZvXd07Vd9va6QtWWXckB8OXJwTji4WvyDYgc_CDdGNwgoG9g3VkcIKBv4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-11-06_12-53-31__8b391cd2-8208-425d-a2af-d8806ce7b655__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.117.189
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['2883', '2884', '2885', '2886', '2887']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 2883:2883 -p 2884:2884 -p 2885:2885 -p 2886:2886 -p 2887:2887 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=2885 --rest-port=2883 --tcp-port=2884 --discv5-udp-port=2886 --rest-address=0.0.0.0 --nat=extip:172.18.117.189 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6dd7edcdb6ba9bdbce0bff1a0ae046aac6d60eabdea8634da36bc3f06fa8badb --max-connections=1000 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QBhKv7dIfX9Bi-V8gEZVgnpa_s--kcc2dLAVaTLorWytEx8U7SiK1g_BynNt6YmrzptsmBZWH_gHPQiXhYGMVP8CgmlkgnY0gmlwhKwSk7eKbXVsdGlhZGRyc5YACASsEpO3BoG9AAoErBKTtwaBvt0DgnJzhQADAQAAiXNlY3AyNTZrMaED9kAV3ZvXd07Vd9va6QtWWXckB8OXJwTji4WvyDYgc_CDdGNwgoG9g3VkcIKBv4V3YWt1MgM --storenode=/ip4/172.18.147.183/tcp/33213/p2p/16Uiu2HAmVEFKcbECGmfhugpoiP3Zcd5h4Dq34vHppJNGFX3JDtYF --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.117.189 waku 2f6ebaae75dacd119787b59ecadf02ae27978e7d597537ddd724f444b8f925af
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 2f6ebaae75da. Setting up logs at ./log/docker/store_node1_2024-11-06_12-53-31__8b391cd2-8208-425d-a2af-d8806ce7b655__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/go-waku:latest. REST: 2883
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2883/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QPMLVHblIezsnZnHfDflHKn79KWjluI8syh7ojyUNbjoCbMtx7UCDGk6A0KeoYykePqq_u6dapWTkx_KGtQOrG-GAZMBiZPTgmlkgnY0gmlwhKwRAAmJc2VjcDI1NmsxoQJiAFTXE7UvIraVLwTIpA7jzAO9zcYSGlAJ52bk0opIroN0Y3CCC0SDdWRwggtGhXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/2884/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o","/ip4/127.0.0.1/tcp/2885/ws/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o","/ip4/172.17.0.9/tcp/2884/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o","/ip4/172.17.0.9/tcp/2885/ws/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2883/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.147.183/tcp/33213/p2p/16Uiu2HAmVEFKcbECGmfhugpoiP3Zcd5h4Dq34vHppJNGFX3JDtYF", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33212/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2883/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33212/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33212/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"sWwWQvhzLUN9VOMf6I3GlJoeptzW+ZCQaHq81rOp+38="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2883/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"502b99f766751f23efe97bde775d16296c2e11ff0493ea0cbca004a7c8d23680","status_code":200,"status_desc":"OK","messages":[{"message_hash":"sWwWQvhzLUN9VOMf6I3GlJoeptzW+ZCQaHq81rOp+38="}]}'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:245 Restarting container with id 2f6ebaae75da
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2883/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2883/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QPNTnh6aahvPrRsHG6oe_M9N4fHpYKZ8E354XfQZkBN5FkTBo-OyUNkGYx3Wexkow6rAEKVlTGH6JvJgikCVOSOGAZMBiaUjgmlkgnY0gmlwhKwRAAmJc2VjcDI1NmsxoQJiAFTXE7UvIraVLwTIpA7jzAO9zcYSGlAJ52bk0opIroN0Y3CCC0SDdWRwggtGhXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/2884/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o","/ip4/127.0.0.1/tcp/2885/ws/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o","/ip4/172.17.0.9/tcp/2884/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o","/ip4/172.17.0.9/tcp/2885/ws/p2p/16Uiu2HAm22EE9VfWWKazBJMj5XYtubDy11MaEBVUYwiA4LxhfK5o"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2883/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33212/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33212/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"sWwWQvhzLUN9VOMf6I3GlJoeptzW+ZCQaHq81rOp+38="},{"messageHash":"ecUE3xn7WqqDvYVGEgVpwGkUiQd6LEbFrBsb0xQixTI="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2883/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"5279c2278c94261cc440cfe2af43f4185afbc47f1670ad897725ba11bf57ef77","status_code":200,"status_desc":"OK","messages":[{"message_hash":"sWwWQvhzLUN9VOMf6I3GlJoeptzW+ZCQaHq81rOp+38="},{"message_hash":"ecUE3xn7WqqDvYVGEgVpwGkUiQd6LEbFrBsb0xQixTI="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33212/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"sWwWQvhzLUN9VOMf6I3GlJoeptzW+ZCQaHq81rOp+38="},{"messageHash":"ecUE3xn7WqqDvYVGEgVpwGkUiQd6LEbFrBsb0xQixTI="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2883/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"ba085f5ba365afd2a3759cf45b3c488638ec543507fb3e7c96c354713f324c64","status_code":200,"status_desc":"OK","messages":[{"message_hash":"sWwWQvhzLUN9VOMf6I3GlJoeptzW+ZCQaHq81rOp+38="},{"message_hash":"ecUE3xn7WqqDvYVGEgVpwGkUiQd6LEbFrBsb0xQixTI="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 980b5ac59bc0
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 2f6ebaae75da
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 980b5ac59bc0. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.