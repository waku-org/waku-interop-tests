[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_different_shard with id: 2024-10-05_03-24-46__db4ff6ce-1629-4745-beeb-e0d8499a4a96
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-10-05_03-24-46__db4ff6ce-1629-4745-beeb-e0d8499a4a96__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.177.131
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['33952', '33953', '33954', '33955', '33956']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 33952:33952 -p 33953:33953 -p 33954:33954 -p 33955:33955 -p 33956:33956 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33954 --rest-port=33952 --tcp-port=33953 --discv5-udp-port=33955 --rest-address=0.0.0.0 --nat=extip:172.18.177.131 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=b9d2317ba65e0cddda5c3f5dfafcae4b19f9e32fd2af45e55dfdf28dad244466 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33956 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.177.131 waku b8781dda72f764dc27792532c029c303231fa9ffb9fca9f5cce7e18879035ace
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID b8781dda72f7. Setting up logs at ./log/docker/node1_2024-10-05_03-24-46__db4ff6ce-1629-4745-beeb-e0d8499a4a96__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 33952
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33952/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33952/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.131/tcp/33953/p2p/16Uiu2HAm5MiRxLazNHjcUwYFozzHVh4aQJbp2wcm3gyh1ZgkyvW2","/ip4/172.18.177.131/tcp/33954/ws/p2p/16Uiu2HAm5MiRxLazNHjcUwYFozzHVh4aQJbp2wcm3gyh1ZgkyvW2"],"enrUri":"enr:-LO4QGa-phlJ5Qgtt8Vs26aqxHlXpAOhDvT9gC1pzg8s2V0BVEwWPnFyF10OexNDr21OtEJudIhLhmyXa2RQrtUak2IBgmlkgnY0gmlwhKwSsYOKbXVsdGlhZGRyc4wACgSsErGDBoSi3QOCcnOFAAIBAACJc2VjcDI1NmsxoQKTkVFERYjLPRSoIdhR9sXviz8Odf9gPBGpfT8HrFNA14N0Y3CChKGDdWRwgoSjhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-10-05_03-24-46__db4ff6ce-1629-4745-beeb-e0d8499a4a96__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.63.88
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['40216', '40217', '40218', '40219', '40220']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 40216:40216 -p 40217:40217 -p 40218:40218 -p 40219:40219 -p 40220:40220 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=40218 --rest-port=40216 --tcp-port=40217 --discv5-udp-port=40219 --rest-address=0.0.0.0 --nat=extip:172.18.63.88 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=28f11cda19a7cfdb06bdeefbf7118cbc6ec76aea3404afc07ef171e6bb4cdc4b --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-LO4QGa-phlJ5Qgtt8Vs26aqxHlXpAOhDvT9gC1pzg8s2V0BVEwWPnFyF10OexNDr21OtEJudIhLhmyXa2RQrtUak2IBgmlkgnY0gmlwhKwSsYOKbXVsdGlhZGRyc4wACgSsErGDBoSi3QOCcnOFAAIBAACJc2VjcDI1NmsxoQKTkVFERYjLPRSoIdhR9sXviz8Odf9gPBGpfT8HrFNA14N0Y3CChKGDdWRwgoSjhXdha3UyBQ --pubsub-topic=/waku/2/rs/4/1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.122.36
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['19121', '19122', '19123', '19124', '19125']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 19121:19121 -p 19122:19122 -p 19123:19123 -p 19124:19124 -p 19125:19125 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=19123 --rest-port=19121 --tcp-port=19122 --discv5-udp-port=19124 --rest-address=0.0.0.0 --nat=extip:172.18.122.36 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=2b8c422adeb1afbb90236482f08c90a50583d8cf3eaa5ce1ec8d394b10f56eeb --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-LO4QGa-phlJ5Qgtt8Vs26aqxHlXpAOhDvT9gC1pzg8s2V0BVEwWPnFyF10OexNDr21OtEJudIhLhmyXa2RQrtUak2IBgmlkgnY0gmlwhKwSsYOKbXVsdGlhZGRyc4wACgSsErGDBoSi3QOCcnOFAAIBAACJc2VjcDI1NmsxoQKTkVFERYjLPRSoIdhR9sXviz8Odf9gPBGpfT8HrFNA14N0Y3CChKGDdWRwgoSjhXdha3UyBQ --pubsub-topic=/waku/2/rs/4/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.122.36 waku 00a39b10ce2ee545952a77eae9b996e5513dc25793ba4f30fd2879a9b65f2376
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 00a39b10ce2e. Setting up logs at ./log/docker/node2_2024-10-05_03-24-46__db4ff6ce-1629-4745-beeb-e0d8499a4a96__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/go-waku:latest. REST: 19121
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19121/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QLX1k5MFs_PEvhP8jHNGSoJRR5Sg6xAD6oeh1IR1pgSnGkRVuNEO95K8TGyM_SH70RLAmCXcDRuh9ccj7lm6xuaGAZJatWJxgmlkgnY0gmlwhKwRAAeCcnOFAAQBAAGJc2VjcDI1NmsxoQJBGmigdHlBbdYVp1j2m7nXk6Zq8oWwfQ9IqRl-MUWRuoN0Y3CCSrKDdWRwgkq0hXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/19122/p2p/16Uiu2HAkyooqTi5uKL7KMYQaHdGURpxZHZcdCWCJJ5ryatSaVCSu","/ip4/127.0.0.1/tcp/19123/ws/p2p/16Uiu2HAkyooqTi5uKL7KMYQaHdGURpxZHZcdCWCJJ5ryatSaVCSu","/ip4/172.17.0.7/tcp/19122/p2p/16Uiu2HAkyooqTi5uKL7KMYQaHdGURpxZHZcdCWCJJ5ryatSaVCSu","/ip4/172.17.0.7/tcp/19123/ws/p2p/16Uiu2HAkyooqTi5uKL7KMYQaHdGURpxZHZcdCWCJJ5ryatSaVCSu"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19121/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.177.131/tcp/33953/p2p/16Uiu2HAm5MiRxLazNHjcUwYFozzHVh4aQJbp2wcm3gyh1ZgkyvW2", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33952/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19121/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:33952/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:33952/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1728098690721444096,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19121/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:19121/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b'no subscription found for pubsubTopic'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id b8781dda72f7
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 00a39b10ce2e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.