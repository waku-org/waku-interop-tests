[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-11-07_12-02-05__bce995ad-ac63-436c-943b-3e8214de4db5
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-07_12-02-05__bce995ad-ac63-436c-943b-3e8214de4db5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.205.102
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['7493', '7494', '7495', '7496', '7497']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 7493:7493 -p 7494:7494 -p 7495:7495 -p 7496:7496 -p 7497:7497 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=7495 --rest-port=7493 --tcp-port=7494 --discv5-udp-port=7496 --rest-address=0.0.0.0 --nat=extip:172.18.205.102 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8ea7431abedef035d4f71857abdecea1f661ecf8dd1b63ba514d5abe4fd13fb2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=7497 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.205.102 waku 804081c9e03fd342688f997fbbd356724088e2449de1857e53c1ff3178d1950f
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 713321ac528e. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 804081c9e03f. Setting up logs at ./log/docker/receiving_node1_2024-11-07_12-02-05__bce995ad-ac63-436c-943b-3e8214de4db5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 7493
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7493/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7493/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.205.102/tcp/7494/p2p/16Uiu2HAkwHK6zL7JvW6KWhXesg22USyQFyNQnsZukKjKJ1dNZ3mq","/ip4/172.18.205.102/tcp/7495/ws/p2p/16Uiu2HAkwHK6zL7JvW6KWhXesg22USyQFyNQnsZukKjKJ1dNZ3mq"],"enrUri":"enr:-L24QO1IAgVGs6gnckqHavZBBUC4xi9DpAd2IuH-dADWaQWXaPI6DP7SCAXKb1VwJ2qUleywRv6KNkKGBXYg4LBl4lgCgmlkgnY0gmlwhKwSzWaKbXVsdGlhZGRyc5YACASsEs1mBh1GAAoErBLNZgYdR90DgnJzhQADAQAAiXNlY3AyNTZrMaECG5MfdVxRQ9d8UxQTKpiZbWYFGo-pKv54u_L_XLS2TsCDdGNwgh1Gg3VkcIIdSIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-07_12-02-05__bce995ad-ac63-436c-943b-3e8214de4db5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.166.77
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['51120', '51121', '51122', '51123', '51124']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 51120:51120 -p 51121:51121 -p 51122:51122 -p 51123:51123 -p 51124:51124 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51122 --rest-port=51120 --tcp-port=51121 --discv5-udp-port=51123 --rest-address=0.0.0.0 --nat=extip:172.18.166.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ff3ac24bb77e1e3dfcad3e3bb90766cde4c1d2aa1a7dbae9c4ad18b5fe6c90f4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51124 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.166.77 waku dfd3ad35a9041ba6ebfa88bd5458280fe6ef2f8d695e2440a7ba2d00a98ded8a
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID dfd3ad35a904. Setting up logs at ./log/docker/receiving_node2_2024-11-07_12-02-05__bce995ad-ac63-436c-943b-3e8214de4db5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 51120
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51120/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:51120/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.166.77/tcp/51121/p2p/16Uiu2HAkzuirkjiRt9aJbDUEnHc6rpf15Zy5qJ5v2vwjiwSZYDp3","/ip4/172.18.166.77/tcp/51122/ws/p2p/16Uiu2HAkzuirkjiRt9aJbDUEnHc6rpf15Zy5qJ5v2vwjiwSZYDp3"],"enrUri":"enr:-L24QHqLc7XAfV1wQFjhcVtNtuI_PUpX0Pem_7T4LSTnnPs-HsJwRzCT_YIMh4FxB92q-ZwZ_oiGN0VRhjiHeElWuAcCgmlkgnY0gmlwhKwSpk2KbXVsdGlhZGRyc5YACASsEqZNBsexAAoErBKmTQbHst0DgnJzhQADAQAAiXNlY3AyNTZrMaECUXnzwgjU2LZ_gXtQwkwnZ6WIumDNkLvYbFWBP5-Rg9CDdGNwgsexg3VkcILHs4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51120/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.205.102/tcp/7494/p2p/16Uiu2HAkwHK6zL7JvW6KWhXesg22USyQFyNQnsZukKjKJ1dNZ3mq"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-07_12-02-05__bce995ad-ac63-436c-943b-3e8214de4db5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.90.47
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['8395', '8396', '8397', '8398', '8399']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 8395:8395 -p 8396:8396 -p 8397:8397 -p 8398:8398 -p 8399:8399 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=8397 --rest-port=8395 --tcp-port=8396 --discv5-udp-port=8398 --rest-address=0.0.0.0 --nat=extip:172.18.90.47 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4afbaed9b1a62cb25aeb0e9b63636e042bd0b8fbdcf7c317eae35b5208b411e5 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QO1IAgVGs6gnckqHavZBBUC4xi9DpAd2IuH-dADWaQWXaPI6DP7SCAXKb1VwJ2qUleywRv6KNkKGBXYg4LBl4lgCgmlkgnY0gmlwhKwSzWaKbXVsdGlhZGRyc5YACASsEs1mBh1GAAoErBLNZgYdR90DgnJzhQADAQAAiXNlY3AyNTZrMaECG5MfdVxRQ9d8UxQTKpiZbWYFGo-pKv54u_L_XLS2TsCDdGNwgh1Gg3VkcIIdSIV3YWt1Mgk --lightpushnode=/ip4/172.18.205.102/tcp/7494/p2p/16Uiu2HAkwHK6zL7JvW6KWhXesg22USyQFyNQnsZukKjKJ1dNZ3mq --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.90.47 waku 28466696ef4bff28721897423d59ddeb5bb42cc16aea44b5240752dd89827117
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 28466696ef4b. Setting up logs at ./log/docker/lightpush_node1_2024-11-07_12-02-05__bce995ad-ac63-436c-943b-3e8214de4db5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 8395
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8395/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QIx88ZljkjoMUV2Y6l1WBHxVEUOxGxSzsYiTn0RnjIzba_NTDEnoTI_gWB_UH8IncXe5_QkX7bwIdkYMptJzMJuGAZMGgOAIgmlkgnY0gmlwhKwRAAmJc2VjcDI1NmsxoQIwec0MkGG7rrvSiOin1jIrSwSN91dtRh-c43g3SI-rRoN0Y3CCIMyDdWRwgiDOhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/8396/p2p/16Uiu2HAkxguGfXsPH1pAswbica8XMjuegDGFYDg7n2swegZMdhed","/ip4/127.0.0.1/tcp/8397/ws/p2p/16Uiu2HAkxguGfXsPH1pAswbica8XMjuegDGFYDg7n2swegZMdhed","/ip4/172.17.0.9/tcp/8396/p2p/16Uiu2HAkxguGfXsPH1pAswbica8XMjuegDGFYDg7n2swegZMdhed","/ip4/172.17.0.9/tcp/8397/ws/p2p/16Uiu2HAkxguGfXsPH1pAswbica8XMjuegDGFYDg7n2swegZMdhed"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.205.102/tcp/7494/p2p/16Uiu2HAkwHK6zL7JvW6KWhXesg22USyQFyNQnsZukKjKJ1dNZ3mq", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.166.77/tcp/51121/p2p/16Uiu2HAkzuirkjiRt9aJbDUEnHc6rpf15Zy5qJ5v2vwjiwSZYDp3", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7493/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:51120/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730980930708174336}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:8395/lightpush/v1/message. Response content: b'missing Payload field'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730980930711900416}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:8395/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730980930714970880}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:8395/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730980930717815808}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:8395/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730980930719942656}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:8395/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8395/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1730980930721976576}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:8395/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 804081c9e03f
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id dfd3ad35a904
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 804081c9e03f. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 28466696ef4b
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container dfd3ad35a904. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.