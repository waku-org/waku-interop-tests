2025-02-15 03:08:00.900 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 03:08:00.900 DEBUG [tests.conftest] Running test: test_passing_cursor_of_non_existing_message_from_the_store with id: 2025-02-15_03-08-00__cadbb22d-2a85-43c6-95d2-8a9f2efa503c
2025-02-15 03:08:00.901 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 03:08:00.901 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-15 03:08:00.901 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-15 03:08:00.909 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 03:08:00.909 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-15_03-08-00__cadbb22d-2a85-43c6-95d2-8a9f2efa503c__wakuorg_nwaku:latest.log
2025-02-15 03:08:00.909 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:08:00.909 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:08:00.910 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:08:00.911 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.100.52
2025-02-15 03:08:00.911 DEBUG [src.node.docker_mananger] Generated ports ['61025', '61026', '61027', '61028', '61029']
2025-02-15 03:08:00.911 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:08:00.911 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:08:00.911 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:08:00.911 DEBUG [src.node.docker_mananger] docker run -i -t -p 61025:61025 -p 61026:61026 -p 61027:61027 -p 61028:61028 -p 61029:61029 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61027 --rest-port=61025 --tcp-port=61026 --discv5-udp-port=61028 --rest-address=0.0.0.0 --nat=extip:172.18.100.52 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2c979ddc3eba0e152ee9eeafe440bc1a5f3efebadb9830cb8ca5ee4826bcecbf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61029 --metrics-logging=true --store=true --relay=true
2025-02-15 03:08:01.140 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.100.52 waku 5d7227ec231a66c2c55680428113e763d2ebd6246bfdd41cb51e806d9a8376f6
2025-02-15 03:08:01.181 ERROR [src.node.docker_mananger] Max retries reached for container d6cc1aaa276e. Exiting log stream.
2025-02-15 03:08:01.192 DEBUG [src.node.docker_mananger] Container started with ID 5d7227ec231a. Setting up logs at ./log/docker/publishing_node1_2025-02-15_03-08-00__cadbb22d-2a85-43c6-95d2-8a9f2efa503c__wakuorg_nwaku:latest.log
2025-02-15 03:08:01.193 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61025
2025-02-15 03:08:01.194 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:08:01.719 ERROR [src.node.docker_mananger] Max retries reached for container dceb6590fecc. Exiting log stream.
2025-02-15 03:08:02.194 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61025/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:08:02.197 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 03:08:02.197 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 03:08:02.197 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61025/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:08:02.199 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.100.52/tcp/61026/p2p/16Uiu2HAkx6J5S6peKbLsrY4fozZoaharmkFrSqdwNQCivJkgUGFY","/ip4/172.18.100.52/tcp/61027/ws/p2p/16Uiu2HAkx6J5S6peKbLsrY4fozZoaharmkFrSqdwNQCivJkgUGFY"],"enrUri":"enr:-L24QN_Y7oMFvYPS9uDHnSHemw5UqbDBIMe72DzszmmLZzY9SvMhTjkoh6Vzb-N2Jy4P1bH2gmcT9Y4h7JUCJTByiA0CgmlkgnY0gmlwhKwSZDSKbXVsdGlhZGRyc5YACASsEmQ0Bu5iAAoErBJkNAbuY90DgnJzhQADAQAAiXNlY3AyNTZrMaECJ5xCh3rd36PsJdrBnpGegeR7w2LMqBZhNVkTCnCPy6-DdGNwgu5ig3VkcILuZIV3YWt1MgM"}'
2025-02-15 03:08:02.200 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:08:02.207 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-15 03:08:02.207 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-15_03-08-00__cadbb22d-2a85-43c6-95d2-8a9f2efa503c__wakuorg_go-waku:latest.log
2025-02-15 03:08:02.207 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:08:02.207 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:08:02.208 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:08:02.209 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.216.73
2025-02-15 03:08:02.209 DEBUG [src.node.docker_mananger] Generated ports ['22842', '22843', '22844', '22845', '22846']
2025-02-15 03:08:02.209 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:08:02.209 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:08:02.209 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:08:02.209 DEBUG [src.node.docker_mananger] docker run -i -t -p 22842:22842 -p 22843:22843 -p 22844:22844 -p 22845:22845 -p 22846:22846 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=22844 --rest-port=22842 --tcp-port=22843 --discv5-udp-port=22845 --rest-address=0.0.0.0 --nat=extip:172.18.216.73 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e0d3a54bd20db3ad7dfff5adae3ba96bbedb6abaadbdbca2995fa2f06a7b5b7c --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QN_Y7oMFvYPS9uDHnSHemw5UqbDBIMe72DzszmmLZzY9SvMhTjkoh6Vzb-N2Jy4P1bH2gmcT9Y4h7JUCJTByiA0CgmlkgnY0gmlwhKwSZDSKbXVsdGlhZGRyc5YACASsEmQ0Bu5iAAoErBJkNAbuY90DgnJzhQADAQAAiXNlY3AyNTZrMaECJ5xCh3rd36PsJdrBnpGegeR7w2LMqBZhNVkTCnCPy6-DdGNwgu5ig3VkcILuZIV3YWt1MgM --storenode=/ip4/172.18.100.52/tcp/61026/p2p/16Uiu2HAkx6J5S6peKbLsrY4fozZoaharmkFrSqdwNQCivJkgUGFY --store=true --relay=true
2025-02-15 03:08:02.440 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.216.73 waku 919903730ff8448a86ee8b3b1bce547721f91a512d43dd2aeb8e15c5f54eebd3
2025-02-15 03:08:02.494 DEBUG [src.node.docker_mananger] Container started with ID 919903730ff8. Setting up logs at ./log/docker/store_node1_2025-02-15_03-08-00__cadbb22d-2a85-43c6-95d2-8a9f2efa503c__wakuorg_go-waku:latest.log
2025-02-15 03:08:02.494 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 22842
2025-02-15 03:08:02.494 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:08:03.495 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22842/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:08:03.497 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QDcvd3QuJvsAa6c3hAPB1vpuoV_Xcx8lpIih2_PyyQXJcDsVERuGs-sCZjdJPMUasyiOuMvMFA5YJ95Frjbc4GCGAZUHk9A-gmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECWwEZ9fOAZTly_K259Ug68SHafm4iVL8Uqr-LEgbgaOSDdGNwglk7g3VkcIJZPYV3YWt1MgM","listenAddresses":["/ip4/127.0.0.1/tcp/22843/p2p/16Uiu2HAm1Yv47tgcnwsSweupCX5Cv9NdX7N2Dtnat4sKUio64TqM","/ip4/127.0.0.1/tcp/22844/ws/p2p/16Uiu2HAm1Yv47tgcnwsSweupCX5Cv9NdX7N2Dtnat4sKUio64TqM","/ip4/172.17.0.3/tcp/22843/p2p/16Uiu2HAm1Yv47tgcnwsSweupCX5Cv9NdX7N2Dtnat4sKUio64TqM","/ip4/172.17.0.3/tcp/22844/ws/p2p/16Uiu2HAm1Yv47tgcnwsSweupCX5Cv9NdX7N2Dtnat4sKUio64TqM"]}'
2025-02-15 03:08:03.498 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:08:03.498 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22842/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.100.52/tcp/61026/p2p/16Uiu2HAkx6J5S6peKbLsrY4fozZoaharmkFrSqdwNQCivJkgUGFY", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-15 03:08:03.515 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-15 03:08:03.517 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61025/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 03:08:03.540 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:08:03.540 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22842/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 03:08:03.543 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-15 03:08:03.546 DEBUG [src.steps.store] Relaying message
2025-02-15 03:08:03.546 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61025/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8w", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 03:08:03.557 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:08:03.558 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-15 03:08:03.758 DEBUG [src.steps.store] Relaying message
2025-02-15 03:08:03.759 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61025/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8x", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 03:08:03.764 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:08:03.764 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-15 03:08:03.965 DEBUG [src.steps.store] Relaying message
2025-02-15 03:08:03.965 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61025/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8y", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 03:08:03.971 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:08:03.971 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-15 03:08:04.171 DEBUG [src.steps.store] Relaying message
2025-02-15 03:08:04.172 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61025/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "TWVzc2FnZV8z", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 03:08:04.177 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:08:04.177 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-15 03:08:04.378 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61025/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&cursor=0xa01cc36440d48f531291d0ecb3919ad5d65c3550b8a2256719e5fcbe6a947b63&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:08:04.381 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:61025/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&cursor=0xa01cc36440d48f531291d0ecb3919ad5d65c3550b8a2256719e5fcbe6a947b63&pageSize=100&ascending=true. Response content: b'error in handleSelfStoreRequest: BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found'
2025-02-15 03:08:04.382 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22842/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=oBzDZEDUj1MSkdDss5Ga1dZcNVC4oiVnGeX8vmqUe2M%3D&pageSize=100&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:08:04.387 ERROR [src.node.api_clients.base_client] HTTP error occurred: 500 Server Error: Internal Server Error for url: http://127.0.0.1:22842/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&cursor=oBzDZEDUj1MSkdDss5Ga1dZcNVC4oiVnGeX8vmqUe2M%3D&pageSize=100&ascending=true. Response content: b'{"messages":null,"error_message":"300 - BAD_RESPONSE: archive error: DIRVER_ERROR: cursor not found"}'
2025-02-15 03:08:04.390 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 03:08:04.391 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 03:08:04.391 DEBUG [src.node.waku_node] Stopping container with id 5d7227ec231a
2025-02-15 03:08:04.945 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:08:04.947 DEBUG [src.node.waku_node] Stopping container with id 919903730ff8
2025-02-15 03:08:05.460 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:08:05.461 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 03:08:05.470 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 03:08:05.474 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
