2025-02-15 03:09:21.609 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 03:09:21.609 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_only_relay with id: 2025-02-15_03-09-21__2951714c-ef75-4b21-b595-09c75d07d7a3
2025-02-15 03:09:21.609 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 03:09:21.609 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-15 03:09:21.617 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 03:09:21.617 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-15_03-09-21__2951714c-ef75-4b21-b595-09c75d07d7a3__wakuorg_nwaku:latest.log
2025-02-15 03:09:21.617 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:09:21.617 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:09:21.619 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:09:21.619 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.128.247
2025-02-15 03:09:21.619 DEBUG [src.node.docker_mananger] Generated ports ['22122', '22123', '22124', '22125', '22126']
2025-02-15 03:09:21.619 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:09:21.619 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:09:21.619 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:09:21.620 DEBUG [src.node.docker_mananger] docker run -i -t -p 22122:22122 -p 22123:22123 -p 22124:22124 -p 22125:22125 -p 22126:22126 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22124 --rest-port=22122 --tcp-port=22123 --discv5-udp-port=22125 --rest-address=0.0.0.0 --nat=extip:172.18.128.247 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a4d7cce5ecabd0ddcb8b9e2ebb0faff007c988c92ca56c92e9d1dd0c807a7fc5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22126 --metrics-logging=true --lightpush=false --relay=true
2025-02-15 03:09:21.857 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.128.247 waku bf2b59fcd84656aa169764ae575142d4040b90da5a34bc32f6ec8e6d8c94109d
2025-02-15 03:09:21.916 DEBUG [src.node.docker_mananger] Container started with ID bf2b59fcd846. Setting up logs at ./log/docker/receiving_node1_2025-02-15_03-09-21__2951714c-ef75-4b21-b595-09c75d07d7a3__wakuorg_nwaku:latest.log
2025-02-15 03:09:21.916 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22122
2025-02-15 03:09:21.918 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:09:22.416 ERROR [src.node.docker_mananger] Max retries reached for container a1e4b961d794. Exiting log stream.
2025-02-15 03:09:22.918 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22122/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:22.921 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 03:09:22.921 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 03:09:22.922 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22122/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:22.924 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.128.247/tcp/22123/p2p/16Uiu2HAmLAX5EZkZ2sXVZqqrXviVZCzDSxrK3EWAY91d7WGRtXmS","/ip4/172.18.128.247/tcp/22124/ws/p2p/16Uiu2HAmLAX5EZkZ2sXVZqqrXviVZCzDSxrK3EWAY91d7WGRtXmS"],"enrUri":"enr:-L24QIfqBLxhgyJTf1Zuoq3dP6NnNxkhSkGs7gx11nC-R0XoM26GxBv62Pf0ullslPLPoD2myGnlNuXJA2-M5UT_qKQCgmlkgnY0gmlwhKwSgPeKbXVsdGlhZGRyc5YACASsEoD3BlZrAAoErBKA9wZWbN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDb5JkCTH-EK4s-965iQFImIIgPgaERCDGFvBpAKo6qGGDdGNwglZrg3VkcIJWbYV3YWt1MgE"}'
2025-02-15 03:09:22.924 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:09:22.924 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22122/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 03:09:22.942 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:09:22.949 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-15 03:09:22.949 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-15_03-09-21__2951714c-ef75-4b21-b595-09c75d07d7a3__wakuorg_go-waku:latest.log
2025-02-15 03:09:22.949 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:09:22.950 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:09:22.951 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:09:22.951 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.98.103
2025-02-15 03:09:22.951 DEBUG [src.node.docker_mananger] Generated ports ['39943', '39944', '39945', '39946', '39947']
2025-02-15 03:09:22.951 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:09:22.952 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:09:22.952 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:09:22.952 DEBUG [src.node.docker_mananger] docker run -i -t -p 39943:39943 -p 39944:39944 -p 39945:39945 -p 39946:39946 -p 39947:39947 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=39945 --rest-port=39943 --tcp-port=39944 --discv5-udp-port=39946 --rest-address=0.0.0.0 --nat=extip:172.18.98.103 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=67e53ceedc4eff12bdec2912d2fffb37130f1563c41abdaae1d55764a3fdd761 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QIfqBLxhgyJTf1Zuoq3dP6NnNxkhSkGs7gx11nC-R0XoM26GxBv62Pf0ullslPLPoD2myGnlNuXJA2-M5UT_qKQCgmlkgnY0gmlwhKwSgPeKbXVsdGlhZGRyc5YACASsEoD3BlZrAAoErBKA9wZWbN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDb5JkCTH-EK4s-965iQFImIIgPgaERCDGFvBpAKo6qGGDdGNwglZrg3VkcIJWbYV3YWt1MgE --lightpushnode=/ip4/172.18.128.247/tcp/22123/p2p/16Uiu2HAmLAX5EZkZ2sXVZqqrXviVZCzDSxrK3EWAY91d7WGRtXmS --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-15 03:09:23.188 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.98.103 waku a7d5d2fc961005f628b0a8257dcf007b50a05b317deceb383594e6dad5d29f71
2025-02-15 03:09:23.248 DEBUG [src.node.docker_mananger] Container started with ID a7d5d2fc9610. Setting up logs at ./log/docker/lightpush_node1_2025-02-15_03-09-21__2951714c-ef75-4b21-b595-09c75d07d7a3__wakuorg_go-waku:latest.log
2025-02-15 03:09:23.250 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 39943
2025-02-15 03:09:23.250 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:09:24.250 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39943/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:24.258 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QO93W_bLoH8_iNvrsK0k-lP-Mk_0N2YIUBc__vUK_G07NkttuoRwhD4uSXbx0oXZJ7AIt7MMpKSoTfvzuXh1vjGGAZUHlQukgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQJ8yChcqFv5KCXnQ41plk-ZW2X-8hWOauy17XRB7lyItoN0Y3CCnAiDdWRwgpwKhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/39944/p2p/16Uiu2HAm3pmZ9CAPdQEcLGE7LTaFLmhoZrd8Wf6PnBZ4jKptQfy7","/ip4/127.0.0.1/tcp/39945/ws/p2p/16Uiu2HAm3pmZ9CAPdQEcLGE7LTaFLmhoZrd8Wf6PnBZ4jKptQfy7","/ip4/172.17.0.3/tcp/39944/p2p/16Uiu2HAm3pmZ9CAPdQEcLGE7LTaFLmhoZrd8Wf6PnBZ4jKptQfy7","/ip4/172.17.0.3/tcp/39945/ws/p2p/16Uiu2HAm3pmZ9CAPdQEcLGE7LTaFLmhoZrd8Wf6PnBZ4jKptQfy7"]}'
2025-02-15 03:09:24.259 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:09:24.259 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39943/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.128.247/tcp/22123/p2p/16Uiu2HAmLAX5EZkZ2sXVZqqrXviVZCzDSxrK3EWAY91d7WGRtXmS", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-15 03:09:24.261 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-15 03:09:24.262 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39943/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739588964262112000}}'
2025-02-15 03:09:24.265 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:39943/lightpush/v1/message. Response content: b'lightpush error'
2025-02-15 03:09:24.268 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 03:09:24.269 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 03:09:24.269 DEBUG [src.node.waku_node] Stopping container with id bf2b59fcd846
2025-02-15 03:09:24.876 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:09:24.876 DEBUG [src.node.waku_node] Stopping container with id a7d5d2fc9610
2025-02-15 03:09:25.689 ERROR [src.node.docker_mananger] Max retries reached for container bf2b59fcd846. Exiting log stream.
2025-02-15 03:09:25.758 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:09:25.759 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 03:09:25.764 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 03:09:25.767 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
