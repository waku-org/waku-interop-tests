2025-02-15 03:09:04.071 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 03:09:04.071 DEBUG [tests.conftest] Running test: test_2_receiving_nodes__relay_node1_forwards_lightpushed_message_to_relay_node2 with id: 2025-02-15_03-09-04__7d8885ba-8de4-4ac1-bfc9-aed6c9420fa6
2025-02-15 03:09:04.072 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 03:09:04.072 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-15 03:09:04.079 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 03:09:04.079 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-15_03-09-04__7d8885ba-8de4-4ac1-bfc9-aed6c9420fa6__wakuorg_nwaku:latest.log
2025-02-15 03:09:04.079 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:09:04.079 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:09:04.080 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:09:04.081 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.173.123
2025-02-15 03:09:04.081 DEBUG [src.node.docker_mananger] Generated ports ['31693', '31694', '31695', '31696', '31697']
2025-02-15 03:09:04.081 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:09:04.081 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:09:04.081 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:09:04.081 DEBUG [src.node.docker_mananger] docker run -i -t -p 31693:31693 -p 31694:31694 -p 31695:31695 -p 31696:31696 -p 31697:31697 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=31695 --rest-port=31693 --tcp-port=31694 --discv5-udp-port=31696 --rest-address=0.0.0.0 --nat=extip:172.18.173.123 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6a8d317a146e88157b15f023edefebceeccf9b08ffcf80bbb8abd128d1b3e6a0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=31697 --metrics-logging=true --lightpush=true --relay=true
2025-02-15 03:09:04.315 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.173.123 waku 817227a93740c04e99ca32a91d993329bed6dfb6e4d84f73f133906a2eb4ed94
2025-02-15 03:09:04.367 DEBUG [src.node.docker_mananger] Container started with ID 817227a93740. Setting up logs at ./log/docker/receiving_node1_2025-02-15_03-09-04__7d8885ba-8de4-4ac1-bfc9-aed6c9420fa6__wakuorg_nwaku:latest.log
2025-02-15 03:09:04.367 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 31693
2025-02-15 03:09:04.367 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:09:04.379 ERROR [src.node.docker_mananger] Max retries reached for container d33c7a8f2d07. Exiting log stream.
2025-02-15 03:09:04.870 ERROR [src.node.docker_mananger] Max retries reached for container 7d452e50af16. Exiting log stream.
2025-02-15 03:09:05.368 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31693/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:05.371 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 03:09:05.371 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 03:09:05.371 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31693/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:05.373 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.173.123/tcp/31694/p2p/16Uiu2HAmCGbooTb9cFncvcfAWGgyceJp5kGhLDhJprdUwQUE2kvV","/ip4/172.18.173.123/tcp/31695/ws/p2p/16Uiu2HAmCGbooTb9cFncvcfAWGgyceJp5kGhLDhJprdUwQUE2kvV"],"enrUri":"enr:-L24QEOUvmD3kRSuMc4Jz28XJpEoxwaOua-UDQWDAFkGvwKvHlLBg3RDmPiDZSVmU5ACXOSZv_Ted7BEB9bYaMjb57kCgmlkgnY0gmlwhKwSrXuKbXVsdGlhZGRyc5YACASsEq17BnvOAAoErBKtewZ7z90DgnJzhQADAQAAiXNlY3AyNTZrMaEC-kO7nQlbLdEX7nYKHZVfXZpic-zgCG11dmhfYRrigsKDdGNwgnvOg3VkcIJ70IV3YWt1Mgk"}'
2025-02-15 03:09:05.374 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:09:05.380 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 03:09:05.381 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-15_03-09-04__7d8885ba-8de4-4ac1-bfc9-aed6c9420fa6__wakuorg_nwaku:latest.log
2025-02-15 03:09:05.381 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:09:05.381 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:09:05.382 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:09:05.382 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.135.139
2025-02-15 03:09:05.383 DEBUG [src.node.docker_mananger] Generated ports ['60488', '60489', '60490', '60491', '60492']
2025-02-15 03:09:05.383 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:09:05.383 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:09:05.383 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:09:05.383 DEBUG [src.node.docker_mananger] docker run -i -t -p 60488:60488 -p 60489:60489 -p 60490:60490 -p 60491:60491 -p 60492:60492 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60490 --rest-port=60488 --tcp-port=60489 --discv5-udp-port=60491 --rest-address=0.0.0.0 --nat=extip:172.18.135.139 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d3cdbeab7de193ad2c6a9d3bbdbcaf6fea9dcc3b30ee605f5ac1b48ca75daaaa --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60492 --metrics-logging=true --lightpush=false --relay=true
2025-02-15 03:09:05.621 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.135.139 waku b170b114f6dc946ccbc17aa9748dcba50443f483d61d08ff529e4427b943ed46
2025-02-15 03:09:05.672 DEBUG [src.node.docker_mananger] Container started with ID b170b114f6dc. Setting up logs at ./log/docker/receiving_node2_2025-02-15_03-09-04__7d8885ba-8de4-4ac1-bfc9-aed6c9420fa6__wakuorg_nwaku:latest.log
2025-02-15 03:09:05.673 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60488
2025-02-15 03:09:05.673 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:09:06.673 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60488/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:06.676 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 03:09:06.676 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 03:09:06.677 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60488/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:06.679 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.135.139/tcp/60489/p2p/16Uiu2HAmB6au2z5xJpj68SEEyGowskk7KbN6ynfb3iQgP64XMgHy","/ip4/172.18.135.139/tcp/60490/ws/p2p/16Uiu2HAmB6au2z5xJpj68SEEyGowskk7KbN6ynfb3iQgP64XMgHy"],"enrUri":"enr:-L24QEqO3YKL3fIQCbLM5jTNAm_JRsO19YwzJw6ws7xOkUNzJIz54Wu3rZuqniJAZl1z7rBsgMq5Y_3c2hT3mKf8QJUCgmlkgnY0gmlwhKwSh4uKbXVsdGlhZGRyc5YACASsEoeLBuxJAAoErBKHiwbsSt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6Nc1i9Wj13v7BmysTf1HQbfSzG5VHge3NPA8fjRsD3SDdGNwguxJg3VkcILsS4V3YWt1MgE"}'
2025-02-15 03:09:06.679 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:09:06.679 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60488/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.173.123/tcp/31694/p2p/16Uiu2HAmCGbooTb9cFncvcfAWGgyceJp5kGhLDhJprdUwQUE2kvV"]'
2025-02-15 03:09:06.725 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:09:06.732 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-15 03:09:06.732 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-15_03-09-04__7d8885ba-8de4-4ac1-bfc9-aed6c9420fa6__wakuorg_go-waku:latest.log
2025-02-15 03:09:06.733 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:09:06.733 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:09:06.734 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:09:06.734 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.185.26
2025-02-15 03:09:06.735 DEBUG [src.node.docker_mananger] Generated ports ['21694', '21695', '21696', '21697', '21698']
2025-02-15 03:09:06.735 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:09:06.735 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:09:06.735 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:09:06.735 DEBUG [src.node.docker_mananger] docker run -i -t -p 21694:21694 -p 21695:21695 -p 21696:21696 -p 21697:21697 -p 21698:21698 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=21696 --rest-port=21694 --tcp-port=21695 --discv5-udp-port=21697 --rest-address=0.0.0.0 --nat=extip:172.18.185.26 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9852005edc3c30e8efcb658dc6bdef40adf70aa5e39fdc850f95ffbbf4f2eaf1 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QEOUvmD3kRSuMc4Jz28XJpEoxwaOua-UDQWDAFkGvwKvHlLBg3RDmPiDZSVmU5ACXOSZv_Ted7BEB9bYaMjb57kCgmlkgnY0gmlwhKwSrXuKbXVsdGlhZGRyc5YACASsEq17BnvOAAoErBKtewZ7z90DgnJzhQADAQAAiXNlY3AyNTZrMaEC-kO7nQlbLdEX7nYKHZVfXZpic-zgCG11dmhfYRrigsKDdGNwgnvOg3VkcIJ70IV3YWt1Mgk --lightpushnode=/ip4/172.18.173.123/tcp/31694/p2p/16Uiu2HAmCGbooTb9cFncvcfAWGgyceJp5kGhLDhJprdUwQUE2kvV --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-15 03:09:06.981 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.185.26 waku 20628295cdf5c8b1c97b18cf4b384feba11b0014293dcc9cd219fbf35f0b8d89
2025-02-15 03:09:07.030 DEBUG [src.node.docker_mananger] Container started with ID 20628295cdf5. Setting up logs at ./log/docker/lightpush_node1_2025-02-15_03-09-04__7d8885ba-8de4-4ac1-bfc9-aed6c9420fa6__wakuorg_go-waku:latest.log
2025-02-15 03:09:07.031 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 21694
2025-02-15 03:09:07.031 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:09:08.032 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21694/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:08.034 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QAGZYcXWc0uXjq1e149v3YFBi1rfP56VGuOwu3XK7jfZdOBfhrathTvBwuA-w7bzoZm0YKQeR2w_z4K7lU_1vmCGAZUHlMxWgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQPQIEm3t-0hXeMymqMKJIbiUt6a59myM6wfOiNo9PZOGYN0Y3CCVL-DdWRwglTBhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/21695/p2p/16Uiu2HAmSfRhywQDqs2ZW7TjfE9U5PW4ErAsJNrwAmiFAvcWbX5z","/ip4/127.0.0.1/tcp/21696/ws/p2p/16Uiu2HAmSfRhywQDqs2ZW7TjfE9U5PW4ErAsJNrwAmiFAvcWbX5z","/ip4/172.17.0.4/tcp/21695/p2p/16Uiu2HAmSfRhywQDqs2ZW7TjfE9U5PW4ErAsJNrwAmiFAvcWbX5z","/ip4/172.17.0.4/tcp/21696/ws/p2p/16Uiu2HAmSfRhywQDqs2ZW7TjfE9U5PW4ErAsJNrwAmiFAvcWbX5z"]}'
2025-02-15 03:09:08.035 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:09:08.035 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21694/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.173.123/tcp/31694/p2p/16Uiu2HAmCGbooTb9cFncvcfAWGgyceJp5kGhLDhJprdUwQUE2kvV", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-15 03:09:08.037 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-15 03:09:08.037 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21694/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.135.139/tcp/60489/p2p/16Uiu2HAmB6au2z5xJpj68SEEyGowskk7KbN6ynfb3iQgP64XMgHy", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-15 03:09:08.053 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-15 03:09:08.055 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:31693/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 03:09:08.060 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:09:08.061 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60488/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-15 03:09:08.065 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:09:08.066 DEBUG [src.steps.light_push] Lightpushing message
2025-02-15 03:09:08.066 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21694/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739588948065978880}}'
2025-02-15 03:09:08.072 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-15 03:09:08.074 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 03:09:08.175 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-15 03:09:08.175 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:31693/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:08.178 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739588948065978880,"ephemeral":false}]'
2025-02-15 03:09:08.179 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-15 03:09:08.179 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60488/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:09:08.182 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739588948065978880,"ephemeral":false}]'
2025-02-15 03:09:08.184 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 03:09:08.185 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 03:09:08.185 DEBUG [src.node.waku_node] Stopping container with id 817227a93740
2025-02-15 03:09:08.776 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:09:08.777 DEBUG [src.node.waku_node] Stopping container with id b170b114f6dc
2025-02-15 03:09:09.589 ERROR [src.node.docker_mananger] Max retries reached for container 817227a93740. Exiting log stream.
2025-02-15 03:09:10.292 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:09:10.292 DEBUG [src.node.waku_node] Stopping container with id 20628295cdf5
2025-02-15 03:09:10.797 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:09:10.798 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 03:09:10.812 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 03:09:10.823 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 03:09:10.825 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
