2025-02-15 03:06:38.408 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-15 03:06:38.409 DEBUG [tests.conftest] Running test: test_publish_with_no_timestamp with id: 2025-02-15_03-06-38__02ae09de-1f77-4e12-9dd0-c5db2563d91e
2025-02-15 03:06:38.409 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-15 03:06:38.409 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-15 03:06:38.409 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-15 03:06:38.415 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-15 03:06:38.416 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-15_03-06-38__02ae09de-1f77-4e12-9dd0-c5db2563d91e__wakuorg_nwaku:latest.log
2025-02-15 03:06:38.416 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:06:38.416 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:06:38.417 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:06:38.417 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.21.80
2025-02-15 03:06:38.418 DEBUG [src.node.docker_mananger] Generated ports ['55469', '55470', '55471', '55472', '55473']
2025-02-15 03:06:38.418 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:06:38.418 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:06:38.418 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:06:38.418 DEBUG [src.node.docker_mananger] docker run -i -t -p 55469:55469 -p 55470:55470 -p 55471:55471 -p 55472:55472 -p 55473:55473 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55471 --rest-port=55469 --tcp-port=55470 --discv5-udp-port=55472 --rest-address=0.0.0.0 --nat=extip:172.18.21.80 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=077fb4a734b29b21ab7df4eae2cecf1abed8874877758dfcec3ee88ae691c96a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55473 --metrics-logging=true --relay=true
2025-02-15 03:06:38.646 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.21.80 waku 6a34478211e0d0a001406feb1bc07ad352a330646e6b7ceb66ba5d1cabf04add
2025-02-15 03:06:38.695 DEBUG [src.node.docker_mananger] Container started with ID 6a34478211e0. Setting up logs at ./log/docker/node1_2025-02-15_03-06-38__02ae09de-1f77-4e12-9dd0-c5db2563d91e__wakuorg_nwaku:latest.log
2025-02-15 03:06:38.697 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55469
2025-02-15 03:06:38.697 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:06:38.736 ERROR [src.node.docker_mananger] Max retries reached for container b97dd37404f7. Exiting log stream.
2025-02-15 03:06:39.194 ERROR [src.node.docker_mananger] Max retries reached for container 2315eec1cd60. Exiting log stream.
2025-02-15 03:06:39.697 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55469/health" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:39.700 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-15 03:06:39.701 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-15 03:06:39.701 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55469/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:39.703 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.21.80/tcp/55470/p2p/16Uiu2HAm7gf2dXjV6JYStykU7tj56Zb2XeDxhqimXB2JwQ3ZEG6C","/ip4/172.18.21.80/tcp/55471/ws/p2p/16Uiu2HAm7gf2dXjV6JYStykU7tj56Zb2XeDxhqimXB2JwQ3ZEG6C"],"enrUri":"enr:-L24QIM7DjIeR6Q6Kug_E31ig8jSCuNq1KY_lD5KM3Fw6rrMMBlfAjPi_iVHIlhJYyBVBQBowanJI1O9F2tuJ7gr2fQCgmlkgnY0gmlwhKwSFVCKbXVsdGlhZGRyc5YACASsEhVQBtiuAAoErBIVUAbYr90DgnJzhQADAQAAiXNlY3AyNTZrMaECtiLhPmLJcfsfMZUo9Xka9AM4u2NN-SeTHVCWYCYZkVGDdGNwgtiug3VkcILYsIV3YWt1MgE"}'
2025-02-15 03:06:39.703 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:06:39.709 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-15 03:06:39.709 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-15_03-06-38__02ae09de-1f77-4e12-9dd0-c5db2563d91e__wakuorg_go-waku:latest.log
2025-02-15 03:06:39.709 DEBUG [src.node.waku_node] Starting Node...
2025-02-15 03:06:39.709 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-15 03:06:39.711 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-15 03:06:39.711 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.170.132
2025-02-15 03:06:39.711 DEBUG [src.node.docker_mananger] Generated ports ['17312', '17313', '17314', '17315', '17316']
2025-02-15 03:06:39.711 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-15 03:06:39.711 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-15 03:06:39.711 DEBUG [src.node.waku_node] Using volumes []
2025-02-15 03:06:39.712 DEBUG [src.node.docker_mananger] docker run -i -t -p 17312:17312 -p 17313:17313 -p 17314:17314 -p 17315:17315 -p 17316:17316 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=17314 --rest-port=17312 --tcp-port=17313 --discv5-udp-port=17315 --rest-address=0.0.0.0 --nat=extip:172.18.170.132 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a63c1d65daca19c9fb7ae2613acba8caf1fcbafe6bef415ddaeebe2642cfc1bb --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QIM7DjIeR6Q6Kug_E31ig8jSCuNq1KY_lD5KM3Fw6rrMMBlfAjPi_iVHIlhJYyBVBQBowanJI1O9F2tuJ7gr2fQCgmlkgnY0gmlwhKwSFVCKbXVsdGlhZGRyc5YACASsEhVQBtiuAAoErBIVUAbYr90DgnJzhQADAQAAiXNlY3AyNTZrMaECtiLhPmLJcfsfMZUo9Xka9AM4u2NN-SeTHVCWYCYZkVGDdGNwgtiug3VkcILYsIV3YWt1MgE
2025-02-15 03:06:39.941 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.170.132 waku ad1b8c06e72dbddc786085146802cdd6251f311e47f1c3ecc3001986eb7d80ff
2025-02-15 03:06:39.990 DEBUG [src.node.docker_mananger] Container started with ID ad1b8c06e72d. Setting up logs at ./log/docker/node2_2025-02-15_03-06-38__02ae09de-1f77-4e12-9dd0-c5db2563d91e__wakuorg_go-waku:latest.log
2025-02-15 03:06:39.991 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 17312
2025-02-15 03:06:39.992 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-15 03:06:40.992 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17312/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:40.995 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QCM_oSSw8V-Gc0fjDDb5qNImST20yRVSkOafYfECOKKwLj_1HcrUmwtNhNbtFKNzStuyIoyWWqEs4BTnYb74cpiGAZUHko3ygmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaED6iIzhwtITrGi0XXCgsHp8JNHFTk1EjkziRZdEKTydb6DdGNwgkOhg3VkcIJDo4V3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/17313/p2p/16Uiu2HAmUQwzwCyx2f4p1vKLQveLTxiwLPF1wQsJpU7AYHJVyfk9","/ip4/127.0.0.1/tcp/17314/ws/p2p/16Uiu2HAmUQwzwCyx2f4p1vKLQveLTxiwLPF1wQsJpU7AYHJVyfk9","/ip4/172.17.0.3/tcp/17313/p2p/16Uiu2HAmUQwzwCyx2f4p1vKLQveLTxiwLPF1wQsJpU7AYHJVyfk9","/ip4/172.17.0.3/tcp/17314/ws/p2p/16Uiu2HAmUQwzwCyx2f4p1vKLQveLTxiwLPF1wQsJpU7AYHJVyfk9"]}'
2025-02-15 03:06:40.995 INFO [src.node.waku_node] REST service is ready !!
2025-02-15 03:06:40.996 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17312/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.21.80/tcp/55470/p2p/16Uiu2HAm7gf2dXjV6JYStykU7tj56Zb2XeDxhqimXB2JwQ3ZEG6C", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-15 03:06:41.013 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-15 03:06:41.014 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-15 03:06:41.014 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55469/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 03:06:41.036 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:06:41.036 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17312/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-15 03:06:41.038 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-15 03:06:41.040 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 03:06:41.049 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:06:41.049 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 03:06:41.149 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 03:06:41.149 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:41.152 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739588801040212480,"ephemeral":false}]'
2025-02-15 03:06:41.154 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-15 03:06:41.154 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17312/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:41.155 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-15 03:06:42.156 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-15 03:06:42.161 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:06:42.162 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 03:06:42.262 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 03:06:42.262 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:42.265 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739588802156680704,"ephemeral":false}]'
2025-02-15 03:06:42.266 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-15 03:06:42.266 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17312/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:42.268 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739588802156680704,"ephemeral":false}]'
2025-02-15 03:06:42.269 INFO [src.steps.relay] WARM UP successful!!
2025-02-15 03:06:42.270 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto"}'
2025-02-15 03:06:42.275 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-15 03:06:42.275 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-15 03:06:42.375 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-15 03:06:42.375 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:42.378 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739588802272443648,"ephemeral":false}]'
2025-02-15 03:06:42.379 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-15 03:06:42.379 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17312/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-15 03:06:42.381 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739588802272443648,"ephemeral":false}]'
2025-02-15 03:06:42.384 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-15 03:06:42.385 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-15 03:06:42.385 DEBUG [src.node.waku_node] Stopping container with id 6a34478211e0
2025-02-15 03:06:42.937 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:06:42.938 DEBUG [src.node.waku_node] Stopping container with id ad1b8c06e72d
2025-02-15 03:06:43.409 DEBUG [src.node.waku_node] Container stopped.
2025-02-15 03:06:43.410 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-15 03:06:43.420 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-15 03:06:43.424 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
