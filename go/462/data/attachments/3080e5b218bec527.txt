2025-02-11 09:57:03.995 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 09:57:03.996 DEBUG [tests.conftest] Running test: test_filter_get_message_with_valid_timestamps with id: 2025-02-11_09-57-03__39a10b58-4f43-468b-8dba-36db8fcb71fa
2025-02-11 09:57:03.996 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 09:57:03.996 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 09:57:03.997 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-11 09:57:04.005 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 09:57:04.005 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_09-57-03__39a10b58-4f43-468b-8dba-36db8fcb71fa__wakuorg_nwaku:latest.log
2025-02-11 09:57:04.005 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:57:04.006 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:57:04.076 DEBUG [src.node.docker_mananger] Network waku created
2025-02-11 09:57:04.076 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.19.77
2025-02-11 09:57:04.076 DEBUG [src.node.docker_mananger] Generated ports ['3955', '3956', '3957', '3958', '3959']
2025-02-11 09:57:04.077 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:57:04.077 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:57:04.077 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:57:04.077 DEBUG [src.node.docker_mananger] docker run -i -t -p 3955:3955 -p 3956:3956 -p 3957:3957 -p 3958:3958 -p 3959:3959 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3957 --rest-port=3955 --tcp-port=3956 --discv5-udp-port=3958 --rest-address=0.0.0.0 --nat=extip:172.18.19.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d45f231d09d21ec02d7d38eedebbcce3dabafc290797dbc2dc132200d2810b0a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3959 --metrics-logging=true --relay=true --filter=true
2025-02-11 09:57:06.558 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.19.77 waku e39b2e60ad78230614261b63cfd5488e7f71f765751bcccfa0a8a8fa9249e431
2025-02-11 09:57:06.631 DEBUG [src.node.docker_mananger] Container started with ID e39b2e60ad78. Setting up logs at ./log/docker/node1_2025-02-11_09-57-03__39a10b58-4f43-468b-8dba-36db8fcb71fa__wakuorg_nwaku:latest.log
2025-02-11 09:57:06.632 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3955
2025-02-11 09:57:06.632 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:57:07.633 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3955/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:07.636 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 09:57:07.636 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 09:57:07.636 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3955/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:07.639 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.19.77/tcp/3956/p2p/16Uiu2HAm4n2iGhcm9XRiAK7JF7DBqR4BoVr11KJ5d1qKNHLq5MRr","/ip4/172.18.19.77/tcp/3957/ws/p2p/16Uiu2HAm4n2iGhcm9XRiAK7JF7DBqR4BoVr11KJ5d1qKNHLq5MRr"],"enrUri":"enr:-L24QDry-B3NzCSnvGLgNhrrg8UQzFNrefE-HMFOZEtH7pk7aAXxlA5X6aA9s7oNcFHQE-UDQHvv8gduTrrnfBdkbN0CgmlkgnY0gmlwhKwSE02KbXVsdGlhZGRyc5YACASsEhNNBg90AAoErBITTQYPdd0DgnJzhQADAQAAiXNlY3AyNTZrMaECivA9nijhvcTVUDnph-zmz6ygRJmTR5Fm-HsTX8HU9XGDdGNwgg90g3VkcIIPdoV3YWt1MgU"}'
2025-02-11 09:57:07.639 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:57:07.639 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-11 09:57:07.646 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 09:57:07.646 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_09-57-03__39a10b58-4f43-468b-8dba-36db8fcb71fa__wakuorg_go-waku:latest.log
2025-02-11 09:57:07.646 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:57:07.646 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:57:07.648 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:57:07.648 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.104.138
2025-02-11 09:57:07.648 DEBUG [src.node.docker_mananger] Generated ports ['29926', '29927', '29928', '29929', '29930']
2025-02-11 09:57:07.648 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:57:07.648 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:57:07.648 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:57:07.648 DEBUG [src.node.docker_mananger] docker run -i -t -p 29926:29926 -p 29927:29927 -p 29928:29928 -p 29929:29929 -p 29930:29930 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=29928 --rest-port=29926 --tcp-port=29927 --discv5-udp-port=29929 --rest-address=0.0.0.0 --nat=extip:172.18.104.138 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5f9a49f0706c67217cf67e5e9cb3efc13c7be9e46a6ddcdc55aefadfbb6f2d5b --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QDry-B3NzCSnvGLgNhrrg8UQzFNrefE-HMFOZEtH7pk7aAXxlA5X6aA9s7oNcFHQE-UDQHvv8gduTrrnfBdkbN0CgmlkgnY0gmlwhKwSE02KbXVsdGlhZGRyc5YACASsEhNNBg90AAoErBITTQYPdd0DgnJzhQADAQAAiXNlY3AyNTZrMaECivA9nijhvcTVUDnph-zmz6ygRJmTR5Fm-HsTX8HU9XGDdGNwgg90g3VkcIIPdoV3YWt1MgU --filternode=/ip4/172.18.19.77/tcp/3956/p2p/16Uiu2HAm4n2iGhcm9XRiAK7JF7DBqR4BoVr11KJ5d1qKNHLq5MRr --pubsub-topic=/waku/2/rs/3/1
2025-02-11 09:57:10.417 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.104.138 waku 2a0edb730fcce49a5b2a7b7a92572eb36ebcd20819f58570aa89f95f66742324
2025-02-11 09:57:10.473 DEBUG [src.node.docker_mananger] Container started with ID 2a0edb730fcc. Setting up logs at ./log/docker/node2_2025-02-11_09-57-03__39a10b58-4f43-468b-8dba-36db8fcb71fa__wakuorg_go-waku:latest.log
2025-02-11 09:57:10.474 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 29926
2025-02-11 09:57:10.474 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:57:11.475 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:11.477 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QLEYPOzevMEsqaqdjd-jFOeWvImiTeKxkmt2R01dhinLGJvDTtodr32rFaT9A9VNEeVDFEqc5bQs6J17H5znZg6GAZT0cPLBgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQOhJwIbnanimUyJx9V7s4MBvTrtpUcYk1OtXLWu_VRvGoN0Y3CCdOeDdWRwgnTphXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/29927/p2p/16Uiu2HAmPW4VKQg6ZR9o9V7aGue8srvEFjUxMsQatVwL2iFbEAd7","/ip4/127.0.0.1/tcp/29928/ws/p2p/16Uiu2HAmPW4VKQg6ZR9o9V7aGue8srvEFjUxMsQatVwL2iFbEAd7","/ip4/172.17.0.3/tcp/29927/p2p/16Uiu2HAmPW4VKQg6ZR9o9V7aGue8srvEFjUxMsQatVwL2iFbEAd7","/ip4/172.17.0.3/tcp/29928/ws/p2p/16Uiu2HAmPW4VKQg6ZR9o9V7aGue8srvEFjUxMsQatVwL2iFbEAd7"]}'
2025-02-11 09:57:11.478 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:57:11.478 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29926/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.19.77/tcp/3956/p2p/16Uiu2HAm4n2iGhcm9XRiAK7JF7DBqR4BoVr11KJ5d1qKNHLq5MRr", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 09:57:11.480 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:57:11.481 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-11 09:57:11.481 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:57:11.484 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:11.484 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29926/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "8fd58322-884c-4c34-986c-a5b136ae8146", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 09:57:11.489 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"8fd58322-884c-4c34-986c-a5b136ae8146","statusDesc":"OK"}'
2025-02-11 09:57:11.491 DEBUG [tests.filter.test_get_messages] Running test with timestamp Now
2025-02-11 09:57:11.491 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:11.498 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:11.499 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:11.599 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:11.599 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:11.601 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739267823430666240,"ephemeral":false}]'
2025-02-11 09:57:11.603 DEBUG [tests.filter.test_get_messages] Running test with timestamp Far future
2025-02-11 09:57:11.604 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:11.611 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:11.611 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:11.711 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:11.712 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:11.714 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":2054627823430650112,"ephemeral":false}]'
2025-02-11 09:57:11.715 DEBUG [tests.filter.test_get_messages] Running test with timestamp Recent past
2025-02-11 09:57:11.716 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:11.723 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:11.723 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:11.823 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:11.824 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:11.826 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739264223430650112,"ephemeral":false}]'
2025-02-11 09:57:11.828 DEBUG [tests.filter.test_get_messages] Running test with timestamp Near future
2025-02-11 09:57:11.828 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:11.835 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:11.835 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:11.935 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:11.936 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:11.938 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739271423430650112,"ephemeral":false}]'
2025-02-11 09:57:11.940 DEBUG [tests.filter.test_get_messages] Running test with timestamp Positive number
2025-02-11 09:57:11.940 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:11.947 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:11.947 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:12.048 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:12.048 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:12.050 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1,"ephemeral":false}]'
2025-02-11 09:57:12.052 DEBUG [tests.filter.test_get_messages] Running test with timestamp Negative number
2025-02-11 09:57:12.053 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:12.060 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:12.060 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:12.160 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:12.161 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:12.163 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":-1,"ephemeral":false}]'
2025-02-11 09:57:12.165 DEBUG [tests.filter.test_get_messages] Running test with timestamp DST change
2025-02-11 09:57:12.165 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3955/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:12.172 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:12.173 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:12.273 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:12.274 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29926/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:12.276 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1583632800000000000,"ephemeral":false}]'
2025-02-11 09:57:12.279 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 09:57:12.280 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 09:57:12.280 DEBUG [src.node.waku_node] Stopping container with id e39b2e60ad78
2025-02-11 09:57:13.135 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:57:13.136 DEBUG [src.node.waku_node] Stopping container with id 2a0edb730fcc
2025-02-11 09:57:13.667 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:57:13.668 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 09:57:13.675 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 09:57:13.679 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
