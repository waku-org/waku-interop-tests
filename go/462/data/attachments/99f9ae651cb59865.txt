2025-02-11 09:57:16.856 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 09:57:16.856 DEBUG [tests.conftest] Running test: test_publish_and_retrieve_duplicate_message with id: 2025-02-11_09-57-16__39ba0293-c6f2-42d4-a64d-d667eac000ea
2025-02-11 09:57:16.857 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 09:57:16.857 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 09:57:16.857 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 09:57:16.864 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 09:57:16.864 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_09-57-16__39ba0293-c6f2-42d4-a64d-d667eac000ea__wakuorg_nwaku:latest.log
2025-02-11 09:57:16.864 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:57:16.864 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:57:16.866 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:57:16.866 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.23.16
2025-02-11 09:57:16.866 DEBUG [src.node.docker_mananger] Generated ports ['34353', '34354', '34355', '34356', '34357']
2025-02-11 09:57:16.866 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:57:16.866 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:57:16.867 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:57:16.867 DEBUG [src.node.docker_mananger] docker run -i -t -p 34353:34353 -p 34354:34354 -p 34355:34355 -p 34356:34356 -p 34357:34357 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=34355 --rest-port=34353 --tcp-port=34354 --discv5-udp-port=34356 --rest-address=0.0.0.0 --nat=extip:172.18.23.16 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=82f69e5eab468fde9daee9e07aaaf1a9d2c536ea79bcfff4d8f1c80b822e1f9e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=34357 --metrics-logging=true --relay=true
2025-02-11 09:57:17.098 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.23.16 waku 883979272ba269c830441e41245734bdae39de3b4b2d5e28ff4f368286aa5970
2025-02-11 09:57:17.127 ERROR [src.node.docker_mananger] Max retries reached for container f2f05224be4d. Exiting log stream.
2025-02-11 09:57:17.153 DEBUG [src.node.docker_mananger] Container started with ID 883979272ba2. Setting up logs at ./log/docker/node1_2025-02-11_09-57-16__39ba0293-c6f2-42d4-a64d-d667eac000ea__wakuorg_nwaku:latest.log
2025-02-11 09:57:17.155 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 34353
2025-02-11 09:57:17.155 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:57:17.655 ERROR [src.node.docker_mananger] Max retries reached for container db5fc9a79afb. Exiting log stream.
2025-02-11 09:57:18.155 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34353/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:18.158 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 09:57:18.159 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 09:57:18.159 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34353/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:18.161 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.23.16/tcp/34354/p2p/16Uiu2HAmF3cCoaJDXHAhDo1mqxURpo2yZfeXAv74Hqia3KQ1jtyf","/ip4/172.18.23.16/tcp/34355/ws/p2p/16Uiu2HAmF3cCoaJDXHAhDo1mqxURpo2yZfeXAv74Hqia3KQ1jtyf"],"enrUri":"enr:-L24QCu4p9VIi13sfU21GRZvaCuNWVOtfuuty_1mvt-zTwCUDCy6IN9aNcRpioqc9xMTH5noOAQolgtW3i9xKFw0oogCgmlkgnY0gmlwhKwSFxCKbXVsdGlhZGRyc5YACASsEhcQBoYyAAoErBIXEAaGM90DgnJzhQADAQAAiXNlY3AyNTZrMaEDI4KxCT9jVs_W7H1JI64PxwZfEeRv6TpBBsZ-KOg9x3KDdGNwgoYyg3VkcIKGNIV3YWt1MgE"}'
2025-02-11 09:57:18.161 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:57:18.168 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 09:57:18.168 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_09-57-16__39ba0293-c6f2-42d4-a64d-d667eac000ea__wakuorg_go-waku:latest.log
2025-02-11 09:57:18.168 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:57:18.168 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:57:18.170 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:57:18.170 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.109.21
2025-02-11 09:57:18.170 DEBUG [src.node.docker_mananger] Generated ports ['44825', '44826', '44827', '44828', '44829']
2025-02-11 09:57:18.170 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:57:18.170 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:57:18.170 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:57:18.170 DEBUG [src.node.docker_mananger] docker run -i -t -p 44825:44825 -p 44826:44826 -p 44827:44827 -p 44828:44828 -p 44829:44829 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=44827 --rest-port=44825 --tcp-port=44826 --discv5-udp-port=44828 --rest-address=0.0.0.0 --nat=extip:172.18.109.21 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=82b3df2a1b9a3d46daddb35ccb64bb3daea4baca5accd7d9677ffb4ee537ee6e --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QCu4p9VIi13sfU21GRZvaCuNWVOtfuuty_1mvt-zTwCUDCy6IN9aNcRpioqc9xMTH5noOAQolgtW3i9xKFw0oogCgmlkgnY0gmlwhKwSFxCKbXVsdGlhZGRyc5YACASsEhcQBoYyAAoErBIXEAaGM90DgnJzhQADAQAAiXNlY3AyNTZrMaEDI4KxCT9jVs_W7H1JI64PxwZfEeRv6TpBBsZ-KOg9x3KDdGNwgoYyg3VkcIKGNIV3YWt1MgE
2025-02-11 09:57:18.415 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.109.21 waku 37cef7ca0e9cb1cf19230adad346f5f38fd9d38c5cfb8dcf411fae059e6866e6
2025-02-11 09:57:18.465 DEBUG [src.node.docker_mananger] Container started with ID 37cef7ca0e9c. Setting up logs at ./log/docker/node2_2025-02-11_09-57-16__39ba0293-c6f2-42d4-a64d-d667eac000ea__wakuorg_go-waku:latest.log
2025-02-11 09:57:18.466 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 44825
2025-02-11 09:57:18.467 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:57:19.467 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44825/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:19.470 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QOc0kuG12I07sdNUHMndUZ_y-Ss-FzM-oM9rsLxYqkFgExOxCXMXUyiBdoAb2mZoEuvrcyzj7lHJb66A3oJfkWqGAZT0cRIBgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDQ32BxElpz1-xsU1sAWJbmP5w0x5sjiRMjW6Algo81nCDdGNwgq8ag3VkcIKvHIV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/44826/p2p/16Uiu2HAmHCSfYP9rEvJ55bwy1GWC9ccuurJ3ZWVcFnLvtFRYhTew","/ip4/127.0.0.1/tcp/44827/ws/p2p/16Uiu2HAmHCSfYP9rEvJ55bwy1GWC9ccuurJ3ZWVcFnLvtFRYhTew","/ip4/172.17.0.3/tcp/44826/p2p/16Uiu2HAmHCSfYP9rEvJ55bwy1GWC9ccuurJ3ZWVcFnLvtFRYhTew","/ip4/172.17.0.3/tcp/44827/ws/p2p/16Uiu2HAmHCSfYP9rEvJ55bwy1GWC9ccuurJ3ZWVcFnLvtFRYhTew"]}'
2025-02-11 09:57:19.471 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:57:19.471 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44825/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.23.16/tcp/34354/p2p/16Uiu2HAmF3cCoaJDXHAhDo1mqxURpo2yZfeXAv74Hqia3KQ1jtyf", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 09:57:19.489 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:57:19.490 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 09:57:19.490 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34353/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:57:19.514 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:19.514 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44825/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:57:19.517 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-11 09:57:19.519 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:19.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:19.533 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:19.633 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:57:19.633 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:19.636 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267839518908672,"ephemeral":false}]'
2025-02-11 09:57:19.638 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:19.638 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44825/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:19.640 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:57:20.641 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:20.646 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:20.646 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:20.747 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:57:20.747 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:20.750 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267840641190400,"ephemeral":false}]'
2025-02-11 09:57:20.752 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:20.752 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44825/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:20.754 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267840641190400,"ephemeral":false}]'
2025-02-11 09:57:20.755 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 09:57:20.756 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:20.761 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:20.761 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:20.862 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:57:20.862 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:20.865 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267840756710656,"ephemeral":false}]'
2025-02-11 09:57:20.867 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:20.867 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44825/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:20.868 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267840756710656,"ephemeral":false}]'
2025-02-11 09:57:20.870 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:57:20.873 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:57:20.873 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:57:20.974 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:57:20.974 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34353/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:20.977 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267840756710656,"ephemeral":false}]'
2025-02-11 09:57:20.978 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:57:20.979 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44825/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:57:20.980 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:57:20.983 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 09:57:20.984 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 09:57:20.984 DEBUG [src.node.waku_node] Stopping container with id 883979272ba2
2025-02-11 09:57:21.636 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:57:21.636 DEBUG [src.node.waku_node] Stopping container with id 37cef7ca0e9c
2025-02-11 09:57:22.134 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:57:22.136 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 09:57:22.143 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 09:57:22.146 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
