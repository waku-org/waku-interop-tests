2025-02-11 09:56:52.687 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 09:56:52.689 DEBUG [tests.conftest] Running test: test_filter_works_with_static_sharding with id: 2025-02-11_09-56-52__015eb796-81f0-43e0-81fd-6676f45fcd5b
2025-02-11 09:56:52.689 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 09:56:52.689 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 09:56:52.690 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-11 09:56:52.699 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 09:56:52.699 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_09-56-52__015eb796-81f0-43e0-81fd-6676f45fcd5b__wakuorg_nwaku:latest.log
2025-02-11 09:56:52.700 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:56:52.700 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:56:52.701 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:56:52.701 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.138.166
2025-02-11 09:56:52.701 DEBUG [src.node.docker_mananger] Generated ports ['24718', '24719', '24720', '24721', '24722']
2025-02-11 09:56:52.702 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2025-02-11 09:56:52.702 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:56:52.702 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:56:52.702 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:56:52.702 DEBUG [src.node.docker_mananger] docker run -i -t -p 24718:24718 -p 24719:24719 -p 24720:24720 -p 24721:24721 -p 24722:24722 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24720 --rest-port=24718 --tcp-port=24719 --discv5-udp-port=24721 --rest-address=0.0.0.0 --nat=extip:172.18.138.166 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=f3b6ed17fab7d5714c2fc1aebdf544fcd3bbfb48e6dc5edb42fcfa8eed8465a8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24722 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
2025-02-11 09:56:52.929 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.138.166 waku 76e9e8fbbd733ca3552bc752be28c49a88119b832cd3bb293aafbf373cc6c240
2025-02-11 09:56:52.967 ERROR [src.node.docker_mananger] Max retries reached for container ddcc39583a14. Exiting log stream.
2025-02-11 09:56:52.972 DEBUG [src.node.docker_mananger] Container started with ID 76e9e8fbbd73. Setting up logs at ./log/docker/node1_2025-02-11_09-56-52__015eb796-81f0-43e0-81fd-6676f45fcd5b__wakuorg_nwaku:latest.log
2025-02-11 09:56:52.973 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24718
2025-02-11 09:56:52.973 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:56:53.504 ERROR [src.node.docker_mananger] Max retries reached for container 14ac4eca3d7d. Exiting log stream.
2025-02-11 09:56:53.974 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24718/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:53.977 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 09:56:53.977 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 09:56:53.977 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24718/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:53.979 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.138.166/tcp/24719/p2p/16Uiu2HAmQcyDUKvhRanUEd6wdES56iE1WpHBizJWabzrHGAm4SaR","/ip4/172.18.138.166/tcp/24720/ws/p2p/16Uiu2HAmQcyDUKvhRanUEd6wdES56iE1WpHBizJWabzrHGAm4SaR"],"enrUri":"enr:-L24QI5SnLYEFOvcjMvgxRgAmS_ttCQDQz7DrGeXJd4sdKN6SpNBl7cf1-wV5W9qCTJ3bp9HGRYG7a2Qcf3YAao6Bv4CgmlkgnY0gmlwhKwSiqaKbXVsdGlhZGRyc5YACASsEoqmBmCPAAoErBKKpgZgkN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDscfMYvaFnaIExO7fwQTCv-PFpLOKo0lG1CFiOzEQ4K6DdGNwgmCPg3VkcIJgkYV3YWt1MgU"}'
2025-02-11 09:56:53.979 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:56:53.986 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 09:56:53.986 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_09-56-52__015eb796-81f0-43e0-81fd-6676f45fcd5b__wakuorg_go-waku:latest.log
2025-02-11 09:56:53.986 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:56:53.986 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:56:53.987 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:56:53.987 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.192.38
2025-02-11 09:56:53.988 DEBUG [src.node.docker_mananger] Generated ports ['40549', '40550', '40551', '40552', '40553']
2025-02-11 09:56:53.988 DEBUG [src.node.waku_node] Cluster id was resolved to: 2
2025-02-11 09:56:53.988 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:56:53.988 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:56:53.988 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:56:53.988 DEBUG [src.node.docker_mananger] docker run -i -t -p 40549:40549 -p 40550:40550 -p 40551:40551 -p 40552:40552 -p 40553:40553 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=40551 --rest-port=40549 --tcp-port=40550 --discv5-udp-port=40552 --rest-address=0.0.0.0 --nat=extip:172.18.192.38 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=365db842fdbf34d6a1fa8d7de6ad22df2edcfbb96a4b8d286f2bb54fe0aafcf8 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QI5SnLYEFOvcjMvgxRgAmS_ttCQDQz7DrGeXJd4sdKN6SpNBl7cf1-wV5W9qCTJ3bp9HGRYG7a2Qcf3YAao6Bv4CgmlkgnY0gmlwhKwSiqaKbXVsdGlhZGRyc5YACASsEoqmBmCPAAoErBKKpgZgkN0DgnJzhQACAQAAiXNlY3AyNTZrMaEDscfMYvaFnaIExO7fwQTCv-PFpLOKo0lG1CFiOzEQ4K6DdGNwgmCPg3VkcIJgkYV3YWt1MgU --filternode=/ip4/172.18.138.166/tcp/24719/p2p/16Uiu2HAmQcyDUKvhRanUEd6wdES56iE1WpHBizJWabzrHGAm4SaR --pubsub-topic=/waku/2/rs/3/1
2025-02-11 09:56:54.219 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.192.38 waku 366322bb0d571430b1b78c458f3ada8b7250811aab9c27460f449d50a948dcfc
2025-02-11 09:56:54.275 DEBUG [src.node.docker_mananger] Container started with ID 366322bb0d57. Setting up logs at ./log/docker/node2_2025-02-11_09-56-52__015eb796-81f0-43e0-81fd-6676f45fcd5b__wakuorg_go-waku:latest.log
2025-02-11 09:56:54.275 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 40549
2025-02-11 09:56:54.275 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:56:55.276 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40549/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:55.278 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QPV6Vrl2neaORQUvEg58Ml1ArqwZx6Tz1htdTVtSdslQCFyFvNB5V0PeFXgT90a-Dgw8AGHMbxCO6chKnFGzzV6GAZT0cLN6gmlkgnY0gmlwhKwRAAOCcnOFAAIBAAGJc2VjcDI1NmsxoQJZ3_id9F01OX21J3V66ARpKNFSQzl36TiEK7IG1jMJNoN0Y3CCnmaDdWRwgp5ohXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/40550/p2p/16Uiu2HAm1UWM3K4uNhh5VXVisFR6M25sstzH1FkSaLyENzziz1wb","/ip4/127.0.0.1/tcp/40551/ws/p2p/16Uiu2HAm1UWM3K4uNhh5VXVisFR6M25sstzH1FkSaLyENzziz1wb","/ip4/172.17.0.3/tcp/40550/p2p/16Uiu2HAm1UWM3K4uNhh5VXVisFR6M25sstzH1FkSaLyENzziz1wb","/ip4/172.17.0.3/tcp/40551/ws/p2p/16Uiu2HAm1UWM3K4uNhh5VXVisFR6M25sstzH1FkSaLyENzziz1wb"]}'
2025-02-11 09:56:55.278 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:56:55.279 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40549/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.138.166/tcp/24719/p2p/16Uiu2HAmQcyDUKvhRanUEd6wdES56iE1WpHBizJWabzrHGAm4SaR", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 09:56:55.280 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:56:55.281 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24718/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
2025-02-11 09:56:55.284 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:56:55.284 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40549/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1aa0d65a-b4c7-4f87-acb5-a938e061ab34", "contentFilters": ["/myapp/1/latest/proto"], "pubsubTopic": "/waku/2/rs/2/0"}'
2025-02-11 09:56:55.289 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"1aa0d65a-b4c7-4f87-acb5-a938e061ab34","statusDesc":"OK"}'
2025-02-11 09:56:55.291 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24718/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:56:55.298 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:56:55.298 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:56:55.398 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:56:55.399 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40549/filter/v2/messages/%2Fwaku%2F2%2Frs%2F2%2F0/%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:55.401 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739267815290971392,"ephemeral":false}]'
2025-02-11 09:56:55.404 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 09:56:55.405 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 09:56:55.405 DEBUG [src.node.waku_node] Stopping container with id 76e9e8fbbd73
2025-02-11 09:56:55.990 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:56:55.990 DEBUG [src.node.waku_node] Stopping container with id 366322bb0d57
2025-02-11 09:56:56.803 ERROR [src.node.docker_mananger] Max retries reached for container 76e9e8fbbd73. Exiting log stream.
2025-02-11 09:56:56.817 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:56:56.818 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 09:56:56.822 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 09:56:56.824 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
