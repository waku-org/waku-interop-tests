2025-02-11 09:58:38.446 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 09:58:38.446 DEBUG [tests.conftest] Running test: test_publish_with_valid_version with id: 2025-02-11_09-58-38__c70fd60e-d4f7-4cf1-ac1e-867d292c48c6
2025-02-11 09:58:38.447 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 09:58:38.447 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 09:58:38.447 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 09:58:38.454 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 09:58:38.454 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_09-58-38__c70fd60e-d4f7-4cf1-ac1e-867d292c48c6__wakuorg_nwaku:latest.log
2025-02-11 09:58:38.454 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:58:38.455 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:58:38.456 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:58:38.456 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.10.190
2025-02-11 09:58:38.456 DEBUG [src.node.docker_mananger] Generated ports ['47702', '47703', '47704', '47705', '47706']
2025-02-11 09:58:38.457 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:58:38.457 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:58:38.457 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:58:38.457 DEBUG [src.node.docker_mananger] docker run -i -t -p 47702:47702 -p 47703:47703 -p 47704:47704 -p 47705:47705 -p 47706:47706 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47704 --rest-port=47702 --tcp-port=47703 --discv5-udp-port=47705 --rest-address=0.0.0.0 --nat=extip:172.18.10.190 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=958e66da1deaed4e1c0e04b2be2fb97750881ee7e21e61c8c150308c53fafbdb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47706 --metrics-logging=true --relay=true
2025-02-11 09:58:38.701 ERROR [src.node.docker_mananger] Max retries reached for container 49d8dd30f796. Exiting log stream.
2025-02-11 09:58:38.710 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.10.190 waku e847d26b62a5da1f98d32abb8e8a072fcfca96228e598f86239e341013ad93c4
2025-02-11 09:58:38.759 DEBUG [src.node.docker_mananger] Container started with ID e847d26b62a5. Setting up logs at ./log/docker/node1_2025-02-11_09-58-38__c70fd60e-d4f7-4cf1-ac1e-867d292c48c6__wakuorg_nwaku:latest.log
2025-02-11 09:58:38.760 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47702
2025-02-11 09:58:38.760 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:58:39.254 ERROR [src.node.docker_mananger] Max retries reached for container e991a1f41b0a. Exiting log stream.
2025-02-11 09:58:39.761 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47702/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:39.764 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 09:58:39.764 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 09:58:39.764 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47702/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:39.766 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.10.190/tcp/47703/p2p/16Uiu2HAmGGkcD6Lb5J25woi3C44i95LozC5JNv1i7XwegVZ1jUEe","/ip4/172.18.10.190/tcp/47704/ws/p2p/16Uiu2HAmGGkcD6Lb5J25woi3C44i95LozC5JNv1i7XwegVZ1jUEe"],"enrUri":"enr:-L24QCFA34lJMpuHs5-q9TuJNPUsQGFIxUScogkL4Adj88C1GvgFBWaqIYVNK1sOFEYGRZelOoWdjUEnZJoSgZc_lpMCgmlkgnY0gmlwhKwSCr6KbXVsdGlhZGRyc5YACASsEgq-BrpXAAoErBIKvga6WN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDNbxuT_lqz2qb0lz_Qfg73DtNLsyHUgyY0TqV1aTUxfODdGNwgrpXg3VkcIK6WYV3YWt1MgE"}'
2025-02-11 09:58:39.767 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:58:39.773 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 09:58:39.773 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_09-58-38__c70fd60e-d4f7-4cf1-ac1e-867d292c48c6__wakuorg_go-waku:latest.log
2025-02-11 09:58:39.773 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:58:39.773 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:58:39.775 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:58:39.775 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.199.102
2025-02-11 09:58:39.775 DEBUG [src.node.docker_mananger] Generated ports ['34551', '34552', '34553', '34554', '34555']
2025-02-11 09:58:39.775 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:58:39.776 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:58:39.776 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:58:39.776 DEBUG [src.node.docker_mananger] docker run -i -t -p 34551:34551 -p 34552:34552 -p 34553:34553 -p 34554:34554 -p 34555:34555 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=34553 --rest-port=34551 --tcp-port=34552 --discv5-udp-port=34554 --rest-address=0.0.0.0 --nat=extip:172.18.199.102 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dbcac5c12e64908ef7805b6b6ee6fdda2c6bdd7e9881df81db6a99804cf09d7c --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QCFA34lJMpuHs5-q9TuJNPUsQGFIxUScogkL4Adj88C1GvgFBWaqIYVNK1sOFEYGRZelOoWdjUEnZJoSgZc_lpMCgmlkgnY0gmlwhKwSCr6KbXVsdGlhZGRyc5YACASsEgq-BrpXAAoErBIKvga6WN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDNbxuT_lqz2qb0lz_Qfg73DtNLsyHUgyY0TqV1aTUxfODdGNwgrpXg3VkcIK6WYV3YWt1MgE
2025-02-11 09:58:40.013 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.199.102 waku 9159de19c47b5200c020621623ffb9eafc6152acbf04657eee9078413de1fd61
2025-02-11 09:58:40.061 DEBUG [src.node.docker_mananger] Container started with ID 9159de19c47b. Setting up logs at ./log/docker/node2_2025-02-11_09-58-38__c70fd60e-d4f7-4cf1-ac1e-867d292c48c6__wakuorg_go-waku:latest.log
2025-02-11 09:58:40.062 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 34551
2025-02-11 09:58:40.062 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:58:41.062 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34551/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:41.065 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QOg-wcuVDj3vzvlspyhg5hcQrk5ZWPOsD2j-Nv__HqroVo2BIMTcBGnCwz9PqEQK2PWt9XU0xGzoL3cEELHm9v-GAZT0clC-gmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECbr4_wDjLHvJKLvXA5nba50KBog487HpdGIvtG6nX0liDdGNwgob4g3VkcIKG-oV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/34552/p2p/16Uiu2HAm2sy5ph15ibvc2Lz7DLdQSzpb4qygEZLwEukFDv1dFAns","/ip4/127.0.0.1/tcp/34553/ws/p2p/16Uiu2HAm2sy5ph15ibvc2Lz7DLdQSzpb4qygEZLwEukFDv1dFAns","/ip4/172.17.0.3/tcp/34552/p2p/16Uiu2HAm2sy5ph15ibvc2Lz7DLdQSzpb4qygEZLwEukFDv1dFAns","/ip4/172.17.0.3/tcp/34553/ws/p2p/16Uiu2HAm2sy5ph15ibvc2Lz7DLdQSzpb4qygEZLwEukFDv1dFAns"]}'
2025-02-11 09:58:41.066 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:58:41.066 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34551/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.10.190/tcp/47703/p2p/16Uiu2HAmGGkcD6Lb5J25woi3C44i95LozC5JNv1i7XwegVZ1jUEe", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 09:58:41.082 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:58:41.084 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 09:58:41.084 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47702/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:58:41.106 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:58:41.106 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:34551/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:58:41.109 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-11 09:58:41.110 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47702/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:58:41.119 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:58:41.119 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:58:41.220 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:58:41.220 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47702/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:41.223 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267921110057728,"ephemeral":false}]'
2025-02-11 09:58:41.224 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:58:41.224 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34551/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:41.226 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:58:42.227 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47702/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:58:42.232 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:58:42.232 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:58:42.333 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:58:42.333 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47702/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:42.335 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267922227234816,"ephemeral":false}]'
2025-02-11 09:58:42.337 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:58:42.337 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34551/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:42.339 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267922227234816,"ephemeral":false}]'
2025-02-11 09:58:42.340 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 09:58:42.341 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47702/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "version": 10}'
2025-02-11 09:58:42.345 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:58:42.345 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:58:42.446 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:58:42.446 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47702/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:42.449 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1739267922341452032,"ephemeral":false}]'
2025-02-11 09:58:42.450 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:58:42.450 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:34551/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:58:42.452 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":10,"timestamp":1739267922341452032,"ephemeral":false}]'
2025-02-11 09:58:42.455 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 09:58:42.456 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 09:58:42.456 DEBUG [src.node.waku_node] Stopping container with id e847d26b62a5
2025-02-11 09:58:43.037 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:58:43.037 DEBUG [src.node.waku_node] Stopping container with id 9159de19c47b
2025-02-11 09:58:43.540 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:58:43.542 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 09:58:43.553 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 09:58:43.558 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
