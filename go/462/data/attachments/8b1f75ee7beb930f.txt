2025-02-11 09:56:49.888 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 09:56:49.888 DEBUG [tests.conftest] Running test: test_filter_get_message_after_node1_restarts with id: 2025-02-11_09-56-49__73529064-00e6-48b5-8e49-e458386520b4
2025-02-11 09:56:49.888 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 09:56:49.889 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-11 09:56:49.889 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-11 09:56:49.894 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 09:56:49.895 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_09-56-49__73529064-00e6-48b5-8e49-e458386520b4__wakuorg_nwaku:latest.log
2025-02-11 09:56:49.895 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:56:49.895 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:56:49.896 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:56:49.896 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.56.254
2025-02-11 09:56:49.896 DEBUG [src.node.docker_mananger] Generated ports ['59159', '59160', '59161', '59162', '59163']
2025-02-11 09:56:49.897 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:56:49.897 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:56:49.897 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:56:49.897 DEBUG [src.node.docker_mananger] docker run -i -t -p 59159:59159 -p 59160:59160 -p 59161:59161 -p 59162:59162 -p 59163:59163 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59161 --rest-port=59159 --tcp-port=59160 --discv5-udp-port=59162 --rest-address=0.0.0.0 --nat=extip:172.18.56.254 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b2bf7c5edab7e8fcfe49f1fcf03a87f3eec962a4bcbc1c8fc69eb69dda35fa2b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59163 --metrics-logging=true --relay=true --filter=true
2025-02-11 09:56:49.934 ERROR [src.node.docker_mananger] Max retries reached for container ee0f0c698213. Exiting log stream.
2025-02-11 09:56:50.111 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.56.254 waku 1a750a03591d60e464cbacfe1aaf1c235cd492ff1dc9d6623fa27193951f8f1e
2025-02-11 09:56:50.159 DEBUG [src.node.docker_mananger] Container started with ID 1a750a03591d. Setting up logs at ./log/docker/node1_2025-02-11_09-56-49__73529064-00e6-48b5-8e49-e458386520b4__wakuorg_nwaku:latest.log
2025-02-11 09:56:50.159 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59159
2025-02-11 09:56:50.159 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:56:50.694 ERROR [src.node.docker_mananger] Max retries reached for container 22e9a5462b5f. Exiting log stream.
2025-02-11 09:56:51.161 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59159/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:51.163 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 09:56:51.164 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 09:56:51.164 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59159/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:51.166 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.56.254/tcp/59160/p2p/16Uiu2HAm4r7yCTGRusbnhsJ1obAuqcTcFQDjta5Xg814wKQgt7qV","/ip4/172.18.56.254/tcp/59161/ws/p2p/16Uiu2HAm4r7yCTGRusbnhsJ1obAuqcTcFQDjta5Xg814wKQgt7qV"],"enrUri":"enr:-L24QD_nOoHkF16MFWFYJfsz2xhLw4c1iu7gFI6DtFT9jraGT_nw9TVgYF5LKzpioFDuu4fbpV2un_FO6e2CzL6Sq7YCgmlkgnY0gmlwhKwSOP6KbXVsdGlhZGRyc5YACASsEjj-BucYAAoErBI4_gbnGd0DgnJzhQADAQAAiXNlY3AyNTZrMaECi_yCKWz9Mh88Xa3WRnX5w0Z1pA5GbH9K-ScXiA41nRyDdGNwgucYg3VkcILnGoV3YWt1MgU"}'
2025-02-11 09:56:51.166 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:56:51.167 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-11 09:56:51.172 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 09:56:51.172 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_09-56-49__73529064-00e6-48b5-8e49-e458386520b4__wakuorg_go-waku:latest.log
2025-02-11 09:56:51.172 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:56:51.172 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:56:51.174 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:56:51.174 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.199.233
2025-02-11 09:56:51.174 DEBUG [src.node.docker_mananger] Generated ports ['26030', '26031', '26032', '26033', '26034']
2025-02-11 09:56:51.174 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:56:51.174 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:56:51.174 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:56:51.175 DEBUG [src.node.docker_mananger] docker run -i -t -p 26030:26030 -p 26031:26031 -p 26032:26032 -p 26033:26033 -p 26034:26034 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=26032 --rest-port=26030 --tcp-port=26031 --discv5-udp-port=26033 --rest-address=0.0.0.0 --nat=extip:172.18.199.233 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=035c9bba69d428bbf99035ab022723e1a6df85ec2bff3dadcfbe697e4f14e3df --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QD_nOoHkF16MFWFYJfsz2xhLw4c1iu7gFI6DtFT9jraGT_nw9TVgYF5LKzpioFDuu4fbpV2un_FO6e2CzL6Sq7YCgmlkgnY0gmlwhKwSOP6KbXVsdGlhZGRyc5YACASsEjj-BucYAAoErBI4_gbnGd0DgnJzhQADAQAAiXNlY3AyNTZrMaECi_yCKWz9Mh88Xa3WRnX5w0Z1pA5GbH9K-ScXiA41nRyDdGNwgucYg3VkcILnGoV3YWt1MgU --filternode=/ip4/172.18.56.254/tcp/59160/p2p/16Uiu2HAm4r7yCTGRusbnhsJ1obAuqcTcFQDjta5Xg814wKQgt7qV --pubsub-topic=/waku/2/rs/3/1
2025-02-11 09:56:51.405 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.199.233 waku 61df664619284fd2537fc332a606580277603a3c9756633c4ad78e29eb82af82
2025-02-11 09:56:51.461 DEBUG [src.node.docker_mananger] Container started with ID 61df66461928. Setting up logs at ./log/docker/node2_2025-02-11_09-56-49__73529064-00e6-48b5-8e49-e458386520b4__wakuorg_go-waku:latest.log
2025-02-11 09:56:51.462 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 26030
2025-02-11 09:56:51.462 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:56:52.463 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26030/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:52.465 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QJhVgPn9LIQKvvNb0UWNYWStDRK1F34ZO6qkT1njdQzJMnptNXRfNuLm1gT0U2MBP0J3qR5MeHQP2WkgS25JeFSGAZT0cKh8gmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQKMdLMIcOlOpmy3MQ1a3ox_-pGUPWYr2qloZlrxMCnem4N0Y3CCZa-DdWRwgmWxhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/26031/p2p/16Uiu2HAm4sxGT48eRM4tuKVX6NFZreLa9Pg3X8gCTopaoruiQ7Sr","/ip4/127.0.0.1/tcp/26032/ws/p2p/16Uiu2HAm4sxGT48eRM4tuKVX6NFZreLa9Pg3X8gCTopaoruiQ7Sr","/ip4/172.17.0.3/tcp/26031/p2p/16Uiu2HAm4sxGT48eRM4tuKVX6NFZreLa9Pg3X8gCTopaoruiQ7Sr","/ip4/172.17.0.3/tcp/26032/ws/p2p/16Uiu2HAm4sxGT48eRM4tuKVX6NFZreLa9Pg3X8gCTopaoruiQ7Sr"]}'
2025-02-11 09:56:52.465 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:56:52.466 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26030/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.56.254/tcp/59160/p2p/16Uiu2HAm4r7yCTGRusbnhsJ1obAuqcTcFQDjta5Xg814wKQgt7qV", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 09:56:52.467 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:56:52.468 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-11 09:56:52.468 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59159/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:56:52.471 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:56:52.471 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26030/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "751294a5-94da-4add-829c-81e180945e6b", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 09:56:52.477 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"751294a5-94da-4add-829c-81e180945e6b","statusDesc":"OK"}'
2025-02-11 09:56:52.478 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59159/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:56:52.485 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:56:52.485 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:56:52.586 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:56:52.586 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26030/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:52.588 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739267812478824960,"ephemeral":false}]'
2025-02-11 09:56:52.589 DEBUG [src.node.waku_node] Restarting container with id 1a750a03591d
2025-02-11 09:56:53.405 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59159/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:53.508 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59159/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:53.511 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 09:56:53.511 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 09:56:53.511 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59159/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:53.513 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.56.254/tcp/59160/p2p/16Uiu2HAm4r7yCTGRusbnhsJ1obAuqcTcFQDjta5Xg814wKQgt7qV","/ip4/172.18.56.254/tcp/59161/ws/p2p/16Uiu2HAm4r7yCTGRusbnhsJ1obAuqcTcFQDjta5Xg814wKQgt7qV"],"enrUri":"enr:-L24QD_nOoHkF16MFWFYJfsz2xhLw4c1iu7gFI6DtFT9jraGT_nw9TVgYF5LKzpioFDuu4fbpV2un_FO6e2CzL6Sq7YCgmlkgnY0gmlwhKwSOP6KbXVsdGlhZGRyc5YACASsEjj-BucYAAoErBI4_gbnGd0DgnJzhQADAQAAiXNlY3AyNTZrMaECi_yCKWz9Mh88Xa3WRnX5w0Z1pA5GbH9K-ScXiA41nRyDdGNwgucYg3VkcILnGoV3YWt1MgU"}'
2025-02-11 09:56:53.513 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:56:53.513 DEBUG [src.libs.common] Sleeping for 2 seconds
2025-02-11 09:56:55.514 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59159/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:56:55.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:56:55.532 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26030/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "459e6f16-305f-4202-9dd4-db38081e16b2", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-11 09:56:55.555 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"459e6f16-305f-4202-9dd4-db38081e16b2","statusDesc":"OK"}'
2025-02-11 09:56:55.556 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59159/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:56:55.564 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:56:55.565 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:56:55.665 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:56:55.665 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26030/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:56:55.667 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739267815556535552,"ephemeral":false}]'
2025-02-11 09:56:55.671 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 09:56:55.672 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 09:56:55.672 DEBUG [src.node.waku_node] Stopping container with id 1a750a03591d
2025-02-11 09:56:57.007 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:56:57.010 DEBUG [src.node.waku_node] Stopping container with id 61df66461928
2025-02-11 09:56:57.494 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:56:57.495 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 09:56:57.512 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 09:56:57.515 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
