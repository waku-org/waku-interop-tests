2025-02-11 09:59:09.935 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 09:59:09.935 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-11_09-59-09__619473ac-8787-434e-83ad-5408df692766
2025-02-11 09:59:09.936 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 09:59:09.937 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 09:59:09.938 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 09:59:09.946 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 09:59:09.947 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_09-59-09__619473ac-8787-434e-83ad-5408df692766__wakuorg_nwaku:latest.log
2025-02-11 09:59:09.947 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:59:09.947 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:59:09.950 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:59:09.951 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.15.47
2025-02-11 09:59:09.951 DEBUG [src.node.docker_mananger] Generated ports ['24915', '24916', '24917', '24918', '24919']
2025-02-11 09:59:09.951 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:59:09.951 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:59:09.952 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:59:09.952 DEBUG [src.node.docker_mananger] docker run -i -t -p 24915:24915 -p 24916:24916 -p 24917:24917 -p 24918:24918 -p 24919:24919 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24917 --rest-port=24915 --tcp-port=24916 --discv5-udp-port=24918 --rest-address=0.0.0.0 --nat=extip:172.18.15.47 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eeebf14bacfafcd5df1c7e9a85f7c90b40088fe9a1f575e38ede6cebe2151ca1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24919 --metrics-logging=true --relay=true
2025-02-11 09:59:10.180 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.15.47 waku 1e2856870d89a58d68c7cc81ef1a1f0ce331c693b5222c181664b38ae3d8d6a6
2025-02-11 09:59:10.229 DEBUG [src.node.docker_mananger] Container started with ID 1e2856870d89. Setting up logs at ./log/docker/node1_2025-02-11_09-59-09__619473ac-8787-434e-83ad-5408df692766__wakuorg_nwaku:latest.log
2025-02-11 09:59:10.231 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24915
2025-02-11 09:59:10.231 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:59:10.767 ERROR [src.node.docker_mananger] Max retries reached for container bb2add30cbc0. Exiting log stream.
2025-02-11 09:59:11.231 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24915/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:59:11.234 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 09:59:11.234 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 09:59:11.235 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24915/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:59:11.237 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.15.47/tcp/24916/p2p/16Uiu2HAkx4k3mk3MwE2MVMwFwMgxSdyQnU3jhkPMTUbzx4rmXxoA","/ip4/172.18.15.47/tcp/24917/ws/p2p/16Uiu2HAkx4k3mk3MwE2MVMwFwMgxSdyQnU3jhkPMTUbzx4rmXxoA"],"enrUri":"enr:-L24QPYSRtXYre5GoZrQiFF8HGFMOm7FzU_erY3DPohjW5JmI-9o3gdqMXSauD6x4ognJd-Wz17XyI9HBmGfBugap6MCgmlkgnY0gmlwhKwSDy-KbXVsdGlhZGRyc5YACASsEg8vBmFUAAoErBIPLwZhVd0DgnJzhQADAQAAiXNlY3AyNTZrMaECJzZ2065wy5RBudbl42l6br-kXFT5jBL-qV9laneMbYGDdGNwgmFUg3VkcIJhVoV3YWt1MgE"}'
2025-02-11 09:59:11.237 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:59:11.243 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 09:59:11.243 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_09-59-09__619473ac-8787-434e-83ad-5408df692766__wakuorg_go-waku:latest.log
2025-02-11 09:59:11.243 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 09:59:11.243 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 09:59:11.245 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 09:59:11.245 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.240.49
2025-02-11 09:59:11.245 DEBUG [src.node.docker_mananger] Generated ports ['35469', '35470', '35471', '35472', '35473']
2025-02-11 09:59:11.245 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 09:59:11.245 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 09:59:11.245 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 09:59:11.245 DEBUG [src.node.docker_mananger] docker run -i -t -p 35469:35469 -p 35470:35470 -p 35471:35471 -p 35472:35472 -p 35473:35473 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=35471 --rest-port=35469 --tcp-port=35470 --discv5-udp-port=35472 --rest-address=0.0.0.0 --nat=extip:172.18.240.49 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=11b5778ff8f4da1edc813c97dc267a9091bfb21cbc23e7141694efeff1dd8a24 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QPYSRtXYre5GoZrQiFF8HGFMOm7FzU_erY3DPohjW5JmI-9o3gdqMXSauD6x4ognJd-Wz17XyI9HBmGfBugap6MCgmlkgnY0gmlwhKwSDy-KbXVsdGlhZGRyc5YACASsEg8vBmFUAAoErBIPLwZhVd0DgnJzhQADAQAAiXNlY3AyNTZrMaECJzZ2065wy5RBudbl42l6br-kXFT5jBL-qV9laneMbYGDdGNwgmFUg3VkcIJhVoV3YWt1MgE
2025-02-11 09:59:11.473 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.240.49 waku e7d7aaf6c4851fa031fa4f92eab72077531a53e1d95a571c24241e147ef34985
2025-02-11 09:59:11.527 DEBUG [src.node.docker_mananger] Container started with ID e7d7aaf6c485. Setting up logs at ./log/docker/node2_2025-02-11_09-59-09__619473ac-8787-434e-83ad-5408df692766__wakuorg_go-waku:latest.log
2025-02-11 09:59:11.528 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 35469
2025-02-11 09:59:11.528 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 09:59:12.530 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35469/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:59:12.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QDh8MqC-0Iew-MAniB1iyr5rsCFK1Oqwdtp-ji53zBTxevYktQtS-cNviyXIpUDGnhXhAZxwHSzbTFhw95p64oqGAZT0csuigmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEC0Fs-GLmzFlALU_ozi8pWxWSK1JPd7Iv_50uxBg9w5UWDdGNwgoqOg3VkcIKKkIV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/35470/p2p/16Uiu2HAm9T1UbGtHPRWboi5xDNu5N2Lf6cxryDJxwTGnYZMVrdHn","/ip4/127.0.0.1/tcp/35471/ws/p2p/16Uiu2HAm9T1UbGtHPRWboi5xDNu5N2Lf6cxryDJxwTGnYZMVrdHn","/ip4/172.17.0.3/tcp/35470/p2p/16Uiu2HAm9T1UbGtHPRWboi5xDNu5N2Lf6cxryDJxwTGnYZMVrdHn","/ip4/172.17.0.3/tcp/35471/ws/p2p/16Uiu2HAm9T1UbGtHPRWboi5xDNu5N2Lf6cxryDJxwTGnYZMVrdHn"]}'
2025-02-11 09:59:12.533 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 09:59:12.533 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35469/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.15.47/tcp/24916/p2p/16Uiu2HAkx4k3mk3MwE2MVMwFwMgxSdyQnU3jhkPMTUbzx4rmXxoA", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 09:59:12.550 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:59:12.551 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 09:59:12.552 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:59:12.573 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:59:12.573 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35469/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 09:59:12.575 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-11 09:59:12.576 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:12.581 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:59:12.581 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:59:12.682 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:59:12.682 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:59:12.685 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267952576673280,"ephemeral":false}]'
2025-02-11 09:59:12.686 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:59:12.686 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:59:12.688 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 09:59:13.689 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.694 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 09:59:13.694 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 09:59:13.794 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 09:59:13.795 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:59:13.797 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267953689275136,"ephemeral":false}]'
2025-02-11 09:59:13.799 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 09:59:13.799 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35469/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 09:59:13.800 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739267953689275136,"ephemeral":false}]'
2025-02-11 09:59:13.802 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 09:59:13.803 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-11 09:59:13.803 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.806 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 09:59:13.807 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-11 09:59:13.807 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.810 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 09:59:13.810 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-11 09:59:13.811 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.813 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 09:59:13.814 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-11 09:59:13.814 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.817 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 09:59:13.817 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-11 09:59:13.818 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.820 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 09:59:13.821 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-11 09:59:13.821 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.824 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 09:59:13.824 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-11 09:59:13.825 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 09:59:13.827 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:24915/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 09:59:13.829 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 09:59:13.830 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 09:59:13.830 DEBUG [src.node.waku_node] Stopping container with id 1e2856870d89
2025-02-11 09:59:14.399 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:59:14.400 DEBUG [src.node.waku_node] Stopping container with id e7d7aaf6c485
2025-02-11 09:59:14.905 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 09:59:14.907 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 09:59:14.913 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 09:59:14.916 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
