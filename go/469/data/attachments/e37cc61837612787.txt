2025-02-17 03:11:53.201 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 03:11:53.201 DEBUG [tests.conftest] Running test: test_light_push_with_valid_version with id: 2025-02-17_03-11-53__b17146f7-68f9-449b-908e-22bf1d58563e
2025-02-17 03:11:53.201 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 03:11:53.201 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-17 03:11:53.208 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 03:11:53.208 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-17_03-11-53__b17146f7-68f9-449b-908e-22bf1d58563e__wakuorg_nwaku:latest.log
2025-02-17 03:11:53.208 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:11:53.208 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:11:53.209 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:11:53.210 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.1.233
2025-02-17 03:11:53.210 DEBUG [src.node.docker_mananger] Generated ports ['22968', '22969', '22970', '22971', '22972']
2025-02-17 03:11:53.210 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:11:53.210 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:11:53.210 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:11:53.210 DEBUG [src.node.docker_mananger] docker run -i -t -p 22968:22968 -p 22969:22969 -p 22970:22970 -p 22971:22971 -p 22972:22972 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=22970 --rest-port=22968 --tcp-port=22969 --discv5-udp-port=22971 --rest-address=0.0.0.0 --nat=extip:172.18.1.233 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c9fd2bae9ce3ed80131b4d85444bca5cf6e06c51efcb3bdcc96e65bf8daab53b --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=22972 --metrics-logging=true --lightpush=true --relay=true
2025-02-17 03:11:53.429 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.1.233 waku 1c1383c98b243f59e0e6c6b90b287451c6ac2ca65439b76e83c54451a08e5dff
2025-02-17 03:11:53.479 DEBUG [src.node.docker_mananger] Container started with ID 1c1383c98b24. Setting up logs at ./log/docker/receiving_node1_2025-02-17_03-11-53__b17146f7-68f9-449b-908e-22bf1d58563e__wakuorg_nwaku:latest.log
2025-02-17 03:11:53.479 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 22968
2025-02-17 03:11:53.479 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:11:53.490 ERROR [src.node.docker_mananger] Max retries reached for container cd6b416440fd. Exiting log stream.
2025-02-17 03:11:53.998 ERROR [src.node.docker_mananger] Max retries reached for container 6d882e797352. Exiting log stream.
2025-02-17 03:11:54.482 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22968/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:11:54.485 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 03:11:54.485 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 03:11:54.486 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22968/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:11:54.488 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.1.233/tcp/22969/p2p/16Uiu2HAm8rsqoxdWhNwqCgiNKffWia7nMRU6bsxx5kzZC5rWe7is","/ip4/172.18.1.233/tcp/22970/ws/p2p/16Uiu2HAm8rsqoxdWhNwqCgiNKffWia7nMRU6bsxx5kzZC5rWe7is"],"enrUri":"enr:-L24QEKw8klMlv50rPXsUE2OFpq8FbDPGlUos_INGRDpgDW3FJGjjLCu7LElOvtpYE7XVhx3csCvyHBiCaPk1JLUQrECgmlkgnY0gmlwhKwSAemKbXVsdGlhZGRyc5YACASsEgHpBlm5AAoErBIB6QZZut0DgnJzhQADAQAAiXNlY3AyNTZrMaECx5zc8w_ZCu7-r6-6f9GXj-J86-aDXVGdmo328vqiEQyDdGNwglm5g3VkcIJZu4V3YWt1Mgk"}'
2025-02-17 03:11:54.488 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:11:54.495 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 03:11:54.495 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-17_03-11-53__b17146f7-68f9-449b-908e-22bf1d58563e__wakuorg_nwaku:latest.log
2025-02-17 03:11:54.495 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:11:54.495 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:11:54.496 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:11:54.496 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.76.203
2025-02-17 03:11:54.497 DEBUG [src.node.docker_mananger] Generated ports ['33923', '33924', '33925', '33926', '33927']
2025-02-17 03:11:54.497 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:11:54.497 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:11:54.497 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:11:54.497 DEBUG [src.node.docker_mananger] docker run -i -t -p 33923:33923 -p 33924:33924 -p 33925:33925 -p 33926:33926 -p 33927:33927 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=33925 --rest-port=33923 --tcp-port=33924 --discv5-udp-port=33926 --rest-address=0.0.0.0 --nat=extip:172.18.76.203 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dfd011f84daac7b296ddbcebf7be68f7d1a8a386ccab4c90be5cd677760cbccd --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=33927 --metrics-logging=true --lightpush=false --relay=true
2025-02-17 03:11:54.725 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.76.203 waku 4cc66867b89b330bfbfe67c2c17a09bedb1a26936f06c69bda29c0da0ef66f15
2025-02-17 03:11:54.771 DEBUG [src.node.docker_mananger] Container started with ID 4cc66867b89b. Setting up logs at ./log/docker/receiving_node2_2025-02-17_03-11-53__b17146f7-68f9-449b-908e-22bf1d58563e__wakuorg_nwaku:latest.log
2025-02-17 03:11:54.772 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 33923
2025-02-17 03:11:54.773 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:11:55.773 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33923/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:11:55.776 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 03:11:55.776 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 03:11:55.776 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33923/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:11:55.778 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.76.203/tcp/33924/p2p/16Uiu2HAmGrh152ZzXqYf6jv4vckaghszjXtkQ927XeZHc7dBBn2F","/ip4/172.18.76.203/tcp/33925/ws/p2p/16Uiu2HAmGrh152ZzXqYf6jv4vckaghszjXtkQ927XeZHc7dBBn2F"],"enrUri":"enr:-L24QDhJpPhp-PbcLplKsVuLArDae4aT3Oqt4G93BaXAOn2-Gh5z5qMoyC8Kk-Yz0BtcCZYTy8_Y3HDZWGcxsECyBcgCgmlkgnY0gmlwhKwSTMuKbXVsdGlhZGRyc5YACASsEkzLBoSEAAoErBJMywaEhd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDPm4Z7RFStang6_61JjJaVShoFNCr2O3r5ix51T7Zy0yDdGNwgoSEg3VkcIKEhoV3YWt1MgE"}'
2025-02-17 03:11:55.779 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:11:55.779 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33923/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.1.233/tcp/22969/p2p/16Uiu2HAm8rsqoxdWhNwqCgiNKffWia7nMRU6bsxx5kzZC5rWe7is"]'
2025-02-17 03:11:55.820 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:11:55.829 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-17 03:11:55.829 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-17_03-11-53__b17146f7-68f9-449b-908e-22bf1d58563e__wakuorg_go-waku:latest.log
2025-02-17 03:11:55.829 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:11:55.830 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:11:55.831 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:11:55.831 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.188.80
2025-02-17 03:11:55.831 DEBUG [src.node.docker_mananger] Generated ports ['9509', '9510', '9511', '9512', '9513']
2025-02-17 03:11:55.832 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:11:55.832 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:11:55.832 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:11:55.832 DEBUG [src.node.docker_mananger] docker run -i -t -p 9509:9509 -p 9510:9510 -p 9511:9511 -p 9512:9512 -p 9513:9513 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=9511 --rest-port=9509 --tcp-port=9510 --discv5-udp-port=9512 --rest-address=0.0.0.0 --nat=extip:172.18.188.80 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=affb0868183ade5900bb3a49fbaa411f4709eba89bfbdfc11b4ddabcbbf9f1a5 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QEKw8klMlv50rPXsUE2OFpq8FbDPGlUos_INGRDpgDW3FJGjjLCu7LElOvtpYE7XVhx3csCvyHBiCaPk1JLUQrECgmlkgnY0gmlwhKwSAemKbXVsdGlhZGRyc5YACASsEgHpBlm5AAoErBIB6QZZut0DgnJzhQADAQAAiXNlY3AyNTZrMaECx5zc8w_ZCu7-r6-6f9GXj-J86-aDXVGdmo328vqiEQyDdGNwglm5g3VkcIJZu4V3YWt1Mgk --lightpushnode=/ip4/172.18.1.233/tcp/22969/p2p/16Uiu2HAm8rsqoxdWhNwqCgiNKffWia7nMRU6bsxx5kzZC5rWe7is --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-17 03:11:56.070 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.188.80 waku 60491b112fc19d911755d45e3d755b62374ca3a0f2c929101fd2fb5e75d8c422
2025-02-17 03:11:56.127 DEBUG [src.node.docker_mananger] Container started with ID 60491b112fc1. Setting up logs at ./log/docker/lightpush_node1_2025-02-17_03-11-53__b17146f7-68f9-449b-908e-22bf1d58563e__wakuorg_go-waku:latest.log
2025-02-17 03:11:56.128 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 9509
2025-02-17 03:11:56.128 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:11:57.129 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:9509/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:11:57.131 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QF1wGSJOH2ArPLTQIqWMpKtxdyy92isiKA-kQuxr7rI0aIqUx_UpYs_HKmHyvj-IjuNHqNQV30OXtB-glcZPa_2GAZUR5BjWgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQLs27l7QsGJdVuItRsmYcv3rdokB8HRL72MUqeR26hbdIN0Y3CCJSaDdWRwgiUohXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/9510/p2p/16Uiu2HAmBNGXEpkt2oed17zQMwbgDo1N9JDYoRV1Hc1cGZ1xkKZ5","/ip4/127.0.0.1/tcp/9511/ws/p2p/16Uiu2HAmBNGXEpkt2oed17zQMwbgDo1N9JDYoRV1Hc1cGZ1xkKZ5","/ip4/172.17.0.4/tcp/9510/p2p/16Uiu2HAmBNGXEpkt2oed17zQMwbgDo1N9JDYoRV1Hc1cGZ1xkKZ5","/ip4/172.17.0.4/tcp/9511/ws/p2p/16Uiu2HAmBNGXEpkt2oed17zQMwbgDo1N9JDYoRV1Hc1cGZ1xkKZ5"]}'
2025-02-17 03:11:57.132 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:11:57.132 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9509/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.1.233/tcp/22969/p2p/16Uiu2HAm8rsqoxdWhNwqCgiNKffWia7nMRU6bsxx5kzZC5rWe7is", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-17 03:11:57.134 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:11:57.134 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9509/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.76.203/tcp/33924/p2p/16Uiu2HAmGrh152ZzXqYf6jv4vckaghszjXtkQ927XeZHc7dBBn2F", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-17 03:11:57.154 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:11:57.154 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:22968/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 03:11:57.160 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:11:57.160 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:33923/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 03:11:57.165 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:11:57.166 DEBUG [src.steps.light_push] Lightpushing message
2025-02-17 03:11:57.166 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:9509/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739761917166405376, "version": 10}}'
2025-02-17 03:11:57.173 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-17 03:11:57.174 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 03:11:57.274 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 03:11:57.274 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:22968/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:11:57.277 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":10,"timestamp":1739761917166405376,"ephemeral":false,"proof":""}]'
2025-02-17 03:11:57.279 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 03:11:57.279 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:33923/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:11:57.281 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":10,"timestamp":1739761917166405376,"ephemeral":false,"proof":""}]'
2025-02-17 03:11:57.284 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 03:11:57.285 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 03:11:57.285 DEBUG [src.node.waku_node] Stopping container with id 1c1383c98b24
2025-02-17 03:11:57.851 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:11:57.851 DEBUG [src.node.waku_node] Stopping container with id 4cc66867b89b
2025-02-17 03:11:58.663 ERROR [src.node.docker_mananger] Max retries reached for container 1c1383c98b24. Exiting log stream.
2025-02-17 03:11:59.287 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:11:59.287 DEBUG [src.node.waku_node] Stopping container with id 60491b112fc1
2025-02-17 03:11:59.774 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:11:59.776 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 03:11:59.783 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 03:11:59.790 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 03:11:59.792 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
