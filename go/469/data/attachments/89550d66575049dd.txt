2025-02-17 03:09:30.317 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 03:09:30.317 DEBUG [tests.conftest] Running test: test_get_store_message_with_meta with id: 2025-02-17_03-09-30__fdaf63ab-e93e-4fb9-978a-1582a64361fa
2025-02-17 03:09:30.317 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 03:09:30.318 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-17 03:09:30.318 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-17 03:09:30.325 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 03:09:30.325 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-17_03-09-30__fdaf63ab-e93e-4fb9-978a-1582a64361fa__wakuorg_nwaku:latest.log
2025-02-17 03:09:30.326 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:09:30.326 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:09:30.327 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:09:30.327 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.52.72
2025-02-17 03:09:30.327 DEBUG [src.node.docker_mananger] Generated ports ['10037', '10038', '10039', '10040', '10041']
2025-02-17 03:09:30.328 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:09:30.328 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:09:30.328 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:09:30.328 DEBUG [src.node.docker_mananger] docker run -i -t -p 10037:10037 -p 10038:10038 -p 10039:10039 -p 10040:10040 -p 10041:10041 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10039 --rest-port=10037 --tcp-port=10038 --discv5-udp-port=10040 --rest-address=0.0.0.0 --nat=extip:172.18.52.72 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=badd55f5c33b0813afa41dd893baadf21e7ce7e5c0dfdeb310ea4a728e175e39 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10041 --metrics-logging=true --store=true --relay=true
2025-02-17 03:09:30.561 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.52.72 waku 00df73696c1dea837a3b679f05748e7f0f619e60517c5106b39b2a47be8d1c7f
2025-02-17 03:09:30.617 DEBUG [src.node.docker_mananger] Container started with ID 00df73696c1d. Setting up logs at ./log/docker/publishing_node1_2025-02-17_03-09-30__fdaf63ab-e93e-4fb9-978a-1582a64361fa__wakuorg_nwaku:latest.log
2025-02-17 03:09:30.618 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10037
2025-02-17 03:09:30.618 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:09:31.103 ERROR [src.node.docker_mananger] Max retries reached for container 62c35e9fe421. Exiting log stream.
2025-02-17 03:09:31.619 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10037/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:09:31.621 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 03:09:31.622 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 03:09:31.622 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10037/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:09:31.624 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.52.72/tcp/10038/p2p/16Uiu2HAmLMaZDpUsVE3r5q8P88wfvMHjZ7xET8aTAJca4SAhwyfc","/ip4/172.18.52.72/tcp/10039/ws/p2p/16Uiu2HAmLMaZDpUsVE3r5q8P88wfvMHjZ7xET8aTAJca4SAhwyfc"],"enrUri":"enr:-L24QJ6BQQicjoVRv2GMdUtHfqBQoxkzXcS32Q6jP0nKcNG1JJfe61NLXG3ZsvM-sYzK_Yy2aaDoQ3A1JDz6yUJhNikCgmlkgnY0gmlwhKwSNEiKbXVsdGlhZGRyc5YACASsEjRIBic2AAoErBI0SAYnN90DgnJzhQADAQAAiXNlY3AyNTZrMaEDcme3plp-Synhung2VSkszgl0D20Yiu1WQfXFJQJuEO-DdGNwgic2g3VkcIInOIV3YWt1MgM"}'
2025-02-17 03:09:31.624 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:09:31.631 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-17 03:09:31.631 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-17_03-09-30__fdaf63ab-e93e-4fb9-978a-1582a64361fa__wakuorg_go-waku:latest.log
2025-02-17 03:09:31.631 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:09:31.631 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:09:31.632 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:09:31.633 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.168.166
2025-02-17 03:09:31.633 DEBUG [src.node.docker_mananger] Generated ports ['24443', '24444', '24445', '24446', '24447']
2025-02-17 03:09:31.633 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:09:31.633 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:09:31.633 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:09:31.633 DEBUG [src.node.docker_mananger] docker run -i -t -p 24443:24443 -p 24444:24444 -p 24445:24445 -p 24446:24446 -p 24447:24447 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=24445 --rest-port=24443 --tcp-port=24444 --discv5-udp-port=24446 --rest-address=0.0.0.0 --nat=extip:172.18.168.166 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=daeeeef09d38bca2c34f0b7a58af6ed92f5dbe354859c62c4d36136acdb5cf6f --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QJ6BQQicjoVRv2GMdUtHfqBQoxkzXcS32Q6jP0nKcNG1JJfe61NLXG3ZsvM-sYzK_Yy2aaDoQ3A1JDz6yUJhNikCgmlkgnY0gmlwhKwSNEiKbXVsdGlhZGRyc5YACASsEjRIBic2AAoErBI0SAYnN90DgnJzhQADAQAAiXNlY3AyNTZrMaEDcme3plp-Synhung2VSkszgl0D20Yiu1WQfXFJQJuEO-DdGNwgic2g3VkcIInOIV3YWt1MgM --storenode=/ip4/172.18.52.72/tcp/10038/p2p/16Uiu2HAmLMaZDpUsVE3r5q8P88wfvMHjZ7xET8aTAJca4SAhwyfc --store=true --relay=true
2025-02-17 03:09:31.866 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.168.166 waku e726353684f31a682c3ee39e987c74c182d7e787f29b8c57268f90e27b2fcfc1
2025-02-17 03:09:31.921 DEBUG [src.node.docker_mananger] Container started with ID e726353684f3. Setting up logs at ./log/docker/store_node1_2025-02-17_03-09-30__fdaf63ab-e93e-4fb9-978a-1582a64361fa__wakuorg_go-waku:latest.log
2025-02-17 03:09:31.922 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 24443
2025-02-17 03:09:31.922 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:09:32.924 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24443/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:09:32.927 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QJLiFnc3bWp2X-zCZp_CGDOvV0qe6UywbuxW42AD-fPjPrf5m3QohAIXEOszlZxb_qMG6bp9y3b_HVWKq0VmiWuGAZUR4eWOgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDMuEMb2IDExOYhadowMjTCPT8-hcZjsIGSf30CojfiAaDdGNwgl98g3VkcIJffoV3YWt1MgM","listenAddresses":["/ip4/127.0.0.1/tcp/24444/p2p/16Uiu2HAmG5bmbF33pajEes2uG94o36HqeWZwiLoePkW8JGyMRazy","/ip4/127.0.0.1/tcp/24445/ws/p2p/16Uiu2HAmG5bmbF33pajEes2uG94o36HqeWZwiLoePkW8JGyMRazy","/ip4/172.17.0.3/tcp/24444/p2p/16Uiu2HAmG5bmbF33pajEes2uG94o36HqeWZwiLoePkW8JGyMRazy","/ip4/172.17.0.3/tcp/24445/ws/p2p/16Uiu2HAmG5bmbF33pajEes2uG94o36HqeWZwiLoePkW8JGyMRazy"]}'
2025-02-17 03:09:32.927 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:09:32.928 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24443/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.52.72/tcp/10038/p2p/16Uiu2HAmLMaZDpUsVE3r5q8P88wfvMHjZ7xET8aTAJca4SAhwyfc", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-17 03:09:32.944 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:09:32.945 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10037/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 03:09:32.965 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:09:32.966 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24443/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 03:09:32.968 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-17 03:09:32.971 DEBUG [src.steps.store] Relaying message
2025-02-17 03:09:32.971 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10037/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)', "meta": "U3RvcmUgd29ya3MhIQ=="}'
2025-02-17 03:09:32.984 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:09:32.984 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-17 03:09:33.185 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-17 03:09:33.185 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10037/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:09:33.188 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x24b1f2e21139a16ae13561613d7fd43c29ba6e9deef91a0c7f4a2f1bb79e422d"}]}'
2025-02-17 03:09:33.189 DEBUG [src.steps.store] Checking that peer wakuorg/go-waku:latest can find the stored messages
2025-02-17 03:09:33.189 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24443/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:09:33.194 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"request_id":"7a1ef27af42a181a077f0051b30648326690f9ae671b21229ca9408ce1c3b481","status_code":200,"status_desc":"OK","messages":[{"message_hash":"JLHy4hE5oWrhNWFhPX/UPCm6bp3u+RoMf0ovG7eeQi0="}]}'
2025-02-17 03:09:33.196 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 03:09:33.197 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 03:09:33.197 DEBUG [src.node.waku_node] Stopping container with id 00df73696c1d
2025-02-17 03:09:33.780 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:09:33.781 DEBUG [src.node.waku_node] Stopping container with id e726353684f3
2025-02-17 03:09:34.428 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:09:34.429 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 03:09:34.443 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 03:09:34.447 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
