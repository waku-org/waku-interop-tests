2025-02-17 03:08:09.152 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 03:08:09.152 DEBUG [tests.conftest] Running test: test_filter_get_message_after_node_pauses_and_pauses with id: 2025-02-17_03-08-09__7655a203-1753-4e43-a437-277989a8d36e
2025-02-17 03:08:09.153 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 03:08:09.153 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-17 03:08:09.153 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-17 03:08:09.159 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 03:08:09.160 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_03-08-09__7655a203-1753-4e43-a437-277989a8d36e__wakuorg_nwaku:latest.log
2025-02-17 03:08:09.160 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:08:09.160 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:08:09.161 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:08:09.161 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.43.207
2025-02-17 03:08:09.162 DEBUG [src.node.docker_mananger] Generated ports ['3941', '3942', '3943', '3944', '3945']
2025-02-17 03:08:09.162 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:08:09.162 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:08:09.162 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:08:09.162 DEBUG [src.node.docker_mananger] docker run -i -t -p 3941:3941 -p 3942:3942 -p 3943:3943 -p 3944:3944 -p 3945:3945 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3943 --rest-port=3941 --tcp-port=3942 --discv5-udp-port=3944 --rest-address=0.0.0.0 --nat=extip:172.18.43.207 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3f164d8ae7aaa660cd3147ff12a3aeeb6ec9fa17cb6a5b3f1348daabdeae3ccc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3945 --metrics-logging=true --relay=true --filter=true
2025-02-17 03:08:09.390 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.43.207 waku 075e6830ae1c64361d61b559e5d5b130449ab40987e478d77e0a11cb5f722a9a
2025-02-17 03:08:09.439 DEBUG [src.node.docker_mananger] Container started with ID 075e6830ae1c. Setting up logs at ./log/docker/node1_2025-02-17_03-08-09__7655a203-1753-4e43-a437-277989a8d36e__wakuorg_nwaku:latest.log
2025-02-17 03:08:09.439 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 3941
2025-02-17 03:08:09.440 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:08:09.462 ERROR [src.node.docker_mananger] Max retries reached for container 8f9b80672e5d. Exiting log stream.
2025-02-17 03:08:09.955 ERROR [src.node.docker_mananger] Max retries reached for container aed3f3086115. Exiting log stream.
2025-02-17 03:08:10.441 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3941/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:10.444 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 03:08:10.444 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 03:08:10.444 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3941/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:10.446 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.43.207/tcp/3942/p2p/16Uiu2HAkvy2ByABeVQ6D3T5sQAzcyEB9LRecAJ4KP6P7bogcBfBx","/ip4/172.18.43.207/tcp/3943/ws/p2p/16Uiu2HAkvy2ByABeVQ6D3T5sQAzcyEB9LRecAJ4KP6P7bogcBfBx"],"enrUri":"enr:-L24QFMhxVqhQZBLant3GK3ePwIfxndpYilm1vMVA7gzzAbPMAcuQGVulM7_jDiaehYWky_CcOUW6Z-FFakxeFjZsAYCgmlkgnY0gmlwhKwSK8-KbXVsdGlhZGRyc5YACASsEivPBg9mAAoErBIrzwYPZ90DgnJzhQADAQAAiXNlY3AyNTZrMaECFuOLHu4yONjV3FXWvSfSKzr2Ey91DNPPdHR7pXrJunODdGNwgg9mg3VkcIIPaIV3YWt1MgU"}'
2025-02-17 03:08:10.447 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:08:10.447 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-17 03:08:10.454 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-17 03:08:10.454 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_03-08-09__7655a203-1753-4e43-a437-277989a8d36e__wakuorg_go-waku:latest.log
2025-02-17 03:08:10.454 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:08:10.454 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:08:10.455 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:08:10.456 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.60.13
2025-02-17 03:08:10.456 DEBUG [src.node.docker_mananger] Generated ports ['6876', '6877', '6878', '6879', '6880']
2025-02-17 03:08:10.456 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:08:10.456 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:08:10.456 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:08:10.456 DEBUG [src.node.docker_mananger] docker run -i -t -p 6876:6876 -p 6877:6877 -p 6878:6878 -p 6879:6879 -p 6880:6880 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=6878 --rest-port=6876 --tcp-port=6877 --discv5-udp-port=6879 --rest-address=0.0.0.0 --nat=extip:172.18.60.13 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f582d5c5a1e6eec1bfcfa0be71bcce5de8b22bc33b5daf9cdb55cdf6a8d986ce --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QFMhxVqhQZBLant3GK3ePwIfxndpYilm1vMVA7gzzAbPMAcuQGVulM7_jDiaehYWky_CcOUW6Z-FFakxeFjZsAYCgmlkgnY0gmlwhKwSK8-KbXVsdGlhZGRyc5YACASsEivPBg9mAAoErBIrzwYPZ90DgnJzhQADAQAAiXNlY3AyNTZrMaECFuOLHu4yONjV3FXWvSfSKzr2Ey91DNPPdHR7pXrJunODdGNwgg9mg3VkcIIPaIV3YWt1MgU --filternode=/ip4/172.18.43.207/tcp/3942/p2p/16Uiu2HAkvy2ByABeVQ6D3T5sQAzcyEB9LRecAJ4KP6P7bogcBfBx --pubsub-topic=/waku/2/rs/3/1
2025-02-17 03:08:10.680 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.60.13 waku 16a94461390cdc11656651180fcec43692e0e0f8b99e661327026660e4803fb1
2025-02-17 03:08:10.732 DEBUG [src.node.docker_mananger] Container started with ID 16a94461390c. Setting up logs at ./log/docker/node2_2025-02-17_03-08-09__7655a203-1753-4e43-a437-277989a8d36e__wakuorg_go-waku:latest.log
2025-02-17 03:08:10.732 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 6876
2025-02-17 03:08:10.733 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:08:11.733 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6876/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:11.735 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QDPKjOb7kcVn2IT0y0Vvq9puqDBXupwWNjhQYPBV_jTFZLWSCX0Kwf_4i5JkU27OhZZNi3aBCMmNxOxVN_ggNn-GAZUR4KhogmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQIaO3_txhxUNWzDBQ2GzMoghZy0YJypwvyOez8Np3cA_4N0Y3CCGt2DdWRwghrfhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/6877/p2p/16Uiu2HAkwC5Cfn1miv3CdQA2aYgyTLxsXYup9mysCmcmxeSgbYsp","/ip4/127.0.0.1/tcp/6878/ws/p2p/16Uiu2HAkwC5Cfn1miv3CdQA2aYgyTLxsXYup9mysCmcmxeSgbYsp","/ip4/172.17.0.3/tcp/6877/p2p/16Uiu2HAkwC5Cfn1miv3CdQA2aYgyTLxsXYup9mysCmcmxeSgbYsp","/ip4/172.17.0.3/tcp/6878/ws/p2p/16Uiu2HAkwC5Cfn1miv3CdQA2aYgyTLxsXYup9mysCmcmxeSgbYsp"]}'
2025-02-17 03:08:11.736 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:08:11.736 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6876/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.43.207/tcp/3942/p2p/16Uiu2HAkvy2ByABeVQ6D3T5sQAzcyEB9LRecAJ4KP6P7bogcBfBx", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-17 03:08:11.738 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:08:11.738 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-17 03:08:11.739 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3941/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 03:08:11.742 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:08:11.742 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:6876/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "36bda5d1-f071-431b-8e55-99b0fbe744a7", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-17 03:08:11.747 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"36bda5d1-f071-431b-8e55-99b0fbe744a7","statusDesc":"OK"}'
2025-02-17 03:08:11.749 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3941/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:08:11.756 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:08:11.756 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 03:08:11.856 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-17 03:08:11.857 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6876/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:11.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739761691749586688,"ephemeral":false}]'
2025-02-17 03:08:11.861 DEBUG [src.node.waku_node] Pausing container with id 075e6830ae1c
2025-02-17 03:08:11.870 DEBUG [src.node.waku_node] Unpause container with id 075e6830ae1c
2025-02-17 03:08:11.878 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3941/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:08:11.885 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:08:11.885 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 03:08:11.986 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-17 03:08:11.986 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6876/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:11.988 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739761691878487808,"ephemeral":false}]'
2025-02-17 03:08:11.990 DEBUG [src.node.waku_node] Pausing container with id 16a94461390c
2025-02-17 03:08:11.999 DEBUG [src.node.waku_node] Unpause container with id 16a94461390c
2025-02-17 03:08:12.007 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3941/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTI=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:08:12.014 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:08:12.015 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 03:08:12.115 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-17 03:08:12.116 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:6876/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:12.118 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TTI=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739761692007485184,"ephemeral":false}]'
2025-02-17 03:08:12.121 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 03:08:12.122 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 03:08:12.122 DEBUG [src.node.waku_node] Stopping container with id 075e6830ae1c
2025-02-17 03:08:12.663 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:08:12.663 DEBUG [src.node.waku_node] Stopping container with id 16a94461390c
2025-02-17 03:08:13.238 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:08:13.239 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 03:08:13.251 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 03:08:13.254 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
