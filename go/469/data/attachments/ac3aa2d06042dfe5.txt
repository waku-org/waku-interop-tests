2025-02-17 03:08:18.878 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 03:08:18.879 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_full with id: 2025-02-17_03-08-18__78c23e55-b2e0-4fca-a24d-d0f45cbf21c1
2025-02-17 03:08:18.879 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 03:08:18.879 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-17 03:08:18.885 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 03:08:18.886 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-17_03-08-18__78c23e55-b2e0-4fca-a24d-d0f45cbf21c1__wakuorg_nwaku:latest.log
2025-02-17 03:08:18.886 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:08:18.886 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:08:18.887 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:08:18.887 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.120.6
2025-02-17 03:08:18.887 DEBUG [src.node.docker_mananger] Generated ports ['47135', '47136', '47137', '47138', '47139']
2025-02-17 03:08:18.888 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:08:18.888 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:08:18.888 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:08:18.888 DEBUG [src.node.docker_mananger] docker run -i -t -p 47135:47135 -p 47136:47136 -p 47137:47137 -p 47138:47138 -p 47139:47139 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=47137 --rest-port=47135 --tcp-port=47136 --discv5-udp-port=47138 --rest-address=0.0.0.0 --nat=extip:172.18.120.6 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3ceedf2d11ec6ab1a7abc3feb0c2bd64267dcbe4cb7a780aadaaebffafd56ba0 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=47139 --metrics-logging=true --lightpush=true --relay=true --filter=true
2025-02-17 03:08:19.113 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.120.6 waku cd16973c8d1acec40605e36ca1208130fe4cac4e32a5c8c7a6996c695807c920
2025-02-17 03:08:19.165 DEBUG [src.node.docker_mananger] Container started with ID cd16973c8d1a. Setting up logs at ./log/docker/receiving_node1_2025-02-17_03-08-18__78c23e55-b2e0-4fca-a24d-d0f45cbf21c1__wakuorg_nwaku:latest.log
2025-02-17 03:08:19.166 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 47135
2025-02-17 03:08:19.166 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:08:19.181 ERROR [src.node.docker_mananger] Max retries reached for container 1fd4bd7b1347. Exiting log stream.
2025-02-17 03:08:19.685 ERROR [src.node.docker_mananger] Max retries reached for container b50931cff2fb. Exiting log stream.
2025-02-17 03:08:20.166 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47135/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:20.169 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 03:08:20.169 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 03:08:20.170 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47135/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:20.172 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.120.6/tcp/47136/p2p/16Uiu2HAmVjcCPtGsidpjGFLP4mmUBY6JrV1ozJujU6aze9KVQvbe","/ip4/172.18.120.6/tcp/47137/ws/p2p/16Uiu2HAmVjcCPtGsidpjGFLP4mmUBY6JrV1ozJujU6aze9KVQvbe"],"enrUri":"enr:-L24QDQw9y_Hz6asulx8gHKvG-lGvKaGljvfurO-IcBoL0szLzIDX60vDAjXfAsKVXl6fLFELyu_82TgkgpgKblgHa0CgmlkgnY0gmlwhKwSeAaKbXVsdGlhZGRyc5YACASsEngGBrggAAoErBJ4Bga4Id0DgnJzhQADAQAAiXNlY3AyNTZrMaED_cWIbTk-XlkwD07G2TLoNC7DEk-XnV0OsCqdekGuomWDdGNwgrggg3VkcIK4IoV3YWt1Mg0"}'
2025-02-17 03:08:20.172 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:08:20.178 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 03:08:20.178 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-17_03-08-18__78c23e55-b2e0-4fca-a24d-d0f45cbf21c1__wakuorg_nwaku:latest.log
2025-02-17 03:08:20.178 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:08:20.179 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:08:20.180 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:08:20.180 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.166.91
2025-02-17 03:08:20.180 DEBUG [src.node.docker_mananger] Generated ports ['17925', '17926', '17927', '17928', '17929']
2025-02-17 03:08:20.180 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:08:20.180 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:08:20.180 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:08:20.180 DEBUG [src.node.docker_mananger] docker run -i -t -p 17925:17925 -p 17926:17926 -p 17927:17927 -p 17928:17928 -p 17929:17929 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=17927 --rest-port=17925 --tcp-port=17926 --discv5-udp-port=17928 --rest-address=0.0.0.0 --nat=extip:172.18.166.91 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=059bbdf3e6c49ecd2fba0edf6e368dffe663a0ca5c6386ff4cc6bfd59ae8ebe7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=17929 --metrics-logging=true --lightpush=false --relay=true
2025-02-17 03:08:20.413 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.166.91 waku 2f6e222de005292e758b2919dba533454a6dfc7d75cf0db42338ce5f2a186cf3
2025-02-17 03:08:20.465 DEBUG [src.node.docker_mananger] Container started with ID 2f6e222de005. Setting up logs at ./log/docker/receiving_node2_2025-02-17_03-08-18__78c23e55-b2e0-4fca-a24d-d0f45cbf21c1__wakuorg_nwaku:latest.log
2025-02-17 03:08:20.466 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 17925
2025-02-17 03:08:20.466 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:08:21.467 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17925/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:21.469 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 03:08:21.470 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 03:08:21.470 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17925/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:21.472 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.166.91/tcp/17926/p2p/16Uiu2HAkx6FuSj4vyjWcP7PtN3U4AoZ4LtJLCVNfckWyGPswUbz9","/ip4/172.18.166.91/tcp/17927/ws/p2p/16Uiu2HAkx6FuSj4vyjWcP7PtN3U4AoZ4LtJLCVNfckWyGPswUbz9"],"enrUri":"enr:-L24QGWfQcvv82PuSnNtEKfIu1exDNoMBfDXCMBEkz0j2-PDb-qTypY_Zwo48l4ncFKfrwtVwJ_WoRlcDSL_rgVz5rsCgmlkgnY0gmlwhKwSpluKbXVsdGlhZGRyc5YACASsEqZbBkYGAAoErBKmWwZGB90DgnJzhQADAQAAiXNlY3AyNTZrMaECJ5nNwX3-Sk1Sj84bvUIkfsFXor3jM6Hc1DFVb30yfZKDdGNwgkYGg3VkcIJGCIV3YWt1MgE"}'
2025-02-17 03:08:21.472 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:08:21.473 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17925/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.120.6/tcp/47136/p2p/16Uiu2HAmVjcCPtGsidpjGFLP4mmUBY6JrV1ozJujU6aze9KVQvbe"]'
2025-02-17 03:08:21.512 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:08:21.520 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-17 03:08:21.520 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-17_03-08-18__78c23e55-b2e0-4fca-a24d-d0f45cbf21c1__wakuorg_go-waku:latest.log
2025-02-17 03:08:21.520 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:08:21.520 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:08:21.521 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:08:21.522 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.28.254
2025-02-17 03:08:21.522 DEBUG [src.node.docker_mananger] Generated ports ['62903', '62904', '62905', '62906', '62907']
2025-02-17 03:08:21.522 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:08:21.522 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:08:21.522 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:08:21.522 DEBUG [src.node.docker_mananger] docker run -i -t -p 62903:62903 -p 62904:62904 -p 62905:62905 -p 62906:62906 -p 62907:62907 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=62905 --rest-port=62903 --tcp-port=62904 --discv5-udp-port=62906 --rest-address=0.0.0.0 --nat=extip:172.18.28.254 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=93becb5d3cb2b83eb5ddee69f6b7cbbbbde48fb2aaae01f2cee078dbe41c3fc5 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QDQw9y_Hz6asulx8gHKvG-lGvKaGljvfurO-IcBoL0szLzIDX60vDAjXfAsKVXl6fLFELyu_82TgkgpgKblgHa0CgmlkgnY0gmlwhKwSeAaKbXVsdGlhZGRyc5YACASsEngGBrggAAoErBJ4Bga4Id0DgnJzhQADAQAAiXNlY3AyNTZrMaED_cWIbTk-XlkwD07G2TLoNC7DEk-XnV0OsCqdekGuomWDdGNwgrggg3VkcIK4IoV3YWt1Mg0 --lightpushnode=/ip4/172.18.120.6/tcp/47136/p2p/16Uiu2HAmVjcCPtGsidpjGFLP4mmUBY6JrV1ozJujU6aze9KVQvbe --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-17 03:08:21.781 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.28.254 waku fa7a0390bea73b195486262fdd8940eb65896522cb7e05b3664eb8a9fbd3c461
2025-02-17 03:08:21.834 DEBUG [src.node.docker_mananger] Container started with ID fa7a0390bea7. Setting up logs at ./log/docker/lightpush_node1_2025-02-17_03-08-18__78c23e55-b2e0-4fca-a24d-d0f45cbf21c1__wakuorg_go-waku:latest.log
2025-02-17 03:08:21.835 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 62903
2025-02-17 03:08:21.836 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:08:22.836 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62903/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:22.839 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QAV6luqyKCyN-Qpdx_xisl2i1TEutmxylVh4B9gZns7CPpt9b2PV0p-JsET8pDNCcAy_Cv3QndHWjCY2XE0vm0WGAZUR4NPDgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQO2I6m1gFGBzsZeVL11q0MhKMIMnuFw2BONpASpW3PVQIN0Y3CC9biDdWRwgvW6hXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/62904/p2p/16Uiu2HAmQuz6J468GP5wZ81rG2sHfky5DbJyg5LU8eEgAWrzqQoh","/ip4/127.0.0.1/tcp/62905/ws/p2p/16Uiu2HAmQuz6J468GP5wZ81rG2sHfky5DbJyg5LU8eEgAWrzqQoh","/ip4/172.17.0.4/tcp/62904/p2p/16Uiu2HAmQuz6J468GP5wZ81rG2sHfky5DbJyg5LU8eEgAWrzqQoh","/ip4/172.17.0.4/tcp/62905/ws/p2p/16Uiu2HAmQuz6J468GP5wZ81rG2sHfky5DbJyg5LU8eEgAWrzqQoh"]}'
2025-02-17 03:08:22.839 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:08:22.839 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62903/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.120.6/tcp/47136/p2p/16Uiu2HAmVjcCPtGsidpjGFLP4mmUBY6JrV1ozJujU6aze9KVQvbe", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-17 03:08:22.841 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:08:22.841 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62903/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.166.91/tcp/17926/p2p/16Uiu2HAkx6FuSj4vyjWcP7PtN3U4AoZ4LtJLCVNfckWyGPswUbz9", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-17 03:08:22.857 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:08:22.859 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:47135/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 03:08:22.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:08:22.864 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:17925/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-17 03:08:22.867 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:08:22.868 DEBUG [src.steps.light_push] Lightpushing message
2025-02-17 03:08:22.868 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62903/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739761702868434432}}'
2025-02-17 03:08:22.875 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-17 03:08:22.877 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 03:08:22.977 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 03:08:22.977 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:47135/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:22.980 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739761702868434432,"ephemeral":false,"proof":""}]'
2025-02-17 03:08:22.982 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-17 03:08:22.982 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:17925/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:08:22.984 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739761702868434432,"ephemeral":false,"proof":""}]'
2025-02-17 03:08:22.986 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 03:08:22.987 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 03:08:22.987 DEBUG [src.node.waku_node] Stopping container with id cd16973c8d1a
2025-02-17 03:08:23.561 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:08:23.561 DEBUG [src.node.waku_node] Stopping container with id 2f6e222de005
2025-02-17 03:08:24.373 ERROR [src.node.docker_mananger] Max retries reached for container cd16973c8d1a. Exiting log stream.
2025-02-17 03:08:25.071 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:08:25.071 DEBUG [src.node.waku_node] Stopping container with id fa7a0390bea7
2025-02-17 03:08:25.548 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:08:25.551 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 03:08:25.558 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 03:08:25.564 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 03:08:25.568 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
