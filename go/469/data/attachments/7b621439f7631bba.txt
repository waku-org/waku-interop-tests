2025-02-17 03:10:54.515 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-17 03:10:54.515 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-17_03-10-54__a89efb53-e521-4efe-af92-e1bb1e295984
2025-02-17 03:10:54.515 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-17 03:10:54.516 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-17 03:10:54.516 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-17 03:10:54.522 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-17 03:10:54.522 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-17_03-10-54__a89efb53-e521-4efe-af92-e1bb1e295984__wakuorg_nwaku:latest.log
2025-02-17 03:10:54.522 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:10:54.522 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:10:54.524 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:10:54.524 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.252.1
2025-02-17 03:10:54.524 DEBUG [src.node.docker_mananger] Generated ports ['19336', '19337', '19338', '19339', '19340']
2025-02-17 03:10:54.524 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:10:54.524 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:10:54.524 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:10:54.524 DEBUG [src.node.docker_mananger] docker run -i -t -p 19336:19336 -p 19337:19337 -p 19338:19338 -p 19339:19339 -p 19340:19340 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19338 --rest-port=19336 --tcp-port=19337 --discv5-udp-port=19339 --rest-address=0.0.0.0 --nat=extip:172.18.252.1 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1a79b081d5ddcaa86f967056d1d2e4a4e682e6dfcded77cdee7341411e2bbec5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19340 --metrics-logging=true --relay=true
2025-02-17 03:10:54.747 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.252.1 waku 12ac0d0a16dcb79ddb5f0a5597767acba83f29491df182e975132acd9c313bc8
2025-02-17 03:10:54.799 DEBUG [src.node.docker_mananger] Container started with ID 12ac0d0a16dc. Setting up logs at ./log/docker/node1_2025-02-17_03-10-54__a89efb53-e521-4efe-af92-e1bb1e295984__wakuorg_nwaku:latest.log
2025-02-17 03:10:54.799 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 19336
2025-02-17 03:10:54.799 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:10:55.306 ERROR [src.node.docker_mananger] Max retries reached for container 91ac3c205163. Exiting log stream.
2025-02-17 03:10:55.800 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19336/health" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:10:55.802 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-17 03:10:55.802 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-17 03:10:55.803 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19336/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:10:55.805 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.252.1/tcp/19337/p2p/16Uiu2HAm4UujaD6cpEG7qLyGpqmESfyLKgarQEq7NyvV6UxpZvb9","/ip4/172.18.252.1/tcp/19338/ws/p2p/16Uiu2HAm4UujaD6cpEG7qLyGpqmESfyLKgarQEq7NyvV6UxpZvb9"],"enrUri":"enr:-L24QAstmG_AmByf8Pgr_xK1pA4CD9EdL1nxcWAE_y6cTYQ1YkhrwfU8g8HxtuUTmA20rQAxZ2u4ssNnVKwFkHZLQvECgmlkgnY0gmlwhKwS_AGKbXVsdGlhZGRyc5YACASsEvwBBkuJAAoErBL8AQZLit0DgnJzhQADAQAAiXNlY3AyNTZrMaECho16Nov8K0n5xgBkOq5h1DCdPuCtCqIckEX2LRJu08CDdGNwgkuJg3VkcIJLi4V3YWt1MgE"}'
2025-02-17 03:10:55.805 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:10:55.811 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-17 03:10:55.811 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-17_03-10-54__a89efb53-e521-4efe-af92-e1bb1e295984__wakuorg_go-waku:latest.log
2025-02-17 03:10:55.811 DEBUG [src.node.waku_node] Starting Node...
2025-02-17 03:10:55.812 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-17 03:10:55.813 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-17 03:10:55.813 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.130.185
2025-02-17 03:10:55.813 DEBUG [src.node.docker_mananger] Generated ports ['15504', '15505', '15506', '15507', '15508']
2025-02-17 03:10:55.813 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-17 03:10:55.814 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-17 03:10:55.814 DEBUG [src.node.waku_node] Using volumes []
2025-02-17 03:10:55.814 DEBUG [src.node.docker_mananger] docker run -i -t -p 15504:15504 -p 15505:15505 -p 15506:15506 -p 15507:15507 -p 15508:15508 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=15506 --rest-port=15504 --tcp-port=15505 --discv5-udp-port=15507 --rest-address=0.0.0.0 --nat=extip:172.18.130.185 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=22ccadda5c759eeb3fc9082fd2197ed9b26b08f9b889984cc6acca2a2b6f777e --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QAstmG_AmByf8Pgr_xK1pA4CD9EdL1nxcWAE_y6cTYQ1YkhrwfU8g8HxtuUTmA20rQAxZ2u4ssNnVKwFkHZLQvECgmlkgnY0gmlwhKwS_AGKbXVsdGlhZGRyc5YACASsEvwBBkuJAAoErBL8AQZLit0DgnJzhQADAQAAiXNlY3AyNTZrMaECho16Nov8K0n5xgBkOq5h1DCdPuCtCqIckEX2LRJu08CDdGNwgkuJg3VkcIJLi4V3YWt1MgE
2025-02-17 03:10:56.046 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.130.185 waku 63c14ff943d8612ae3e07a39956dc4d17f437c29490b97076ac73e72abc6b514
2025-02-17 03:10:56.097 DEBUG [src.node.docker_mananger] Container started with ID 63c14ff943d8. Setting up logs at ./log/docker/node2_2025-02-17_03-10-54__a89efb53-e521-4efe-af92-e1bb1e295984__wakuorg_go-waku:latest.log
2025-02-17 03:10:56.099 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 15504
2025-02-17 03:10:56.099 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-17 03:10:57.100 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15504/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:10:57.102 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QNIG6AQEePrr5UFhksa_hIPjJ7rfinayQ1VUgC5QQ5FWc79W39wcj7LOPzNNOXOVFT6QRSPQM2selWfD59V2XqWGAZUR4y5agmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDzHfziSV-c12WBWgRwjfmBk1QHQVslQMhJICK6EJO-SaDdGNwgjyRg3VkcII8k4V3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/15505/p2p/16Uiu2HAmSR9c8aqrpUiGu4XDDjXehaSGUconPkas2LWB2eoK4i2H","/ip4/127.0.0.1/tcp/15506/ws/p2p/16Uiu2HAmSR9c8aqrpUiGu4XDDjXehaSGUconPkas2LWB2eoK4i2H","/ip4/172.17.0.3/tcp/15505/p2p/16Uiu2HAmSR9c8aqrpUiGu4XDDjXehaSGUconPkas2LWB2eoK4i2H","/ip4/172.17.0.3/tcp/15506/ws/p2p/16Uiu2HAmSR9c8aqrpUiGu4XDDjXehaSGUconPkas2LWB2eoK4i2H"]}'
2025-02-17 03:10:57.103 INFO [src.node.waku_node] REST service is ready !!
2025-02-17 03:10:57.103 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15504/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.252.1/tcp/19337/p2p/16Uiu2HAm4UujaD6cpEG7qLyGpqmESfyLKgarQEq7NyvV6UxpZvb9", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-17 03:10:57.119 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:10:57.120 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-17 03:10:57.121 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 03:10:57.142 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:10:57.142 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15504/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-17 03:10:57.145 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-17 03:10:57.147 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:57.154 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:10:57.154 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 03:10:57.255 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 03:10:57.255 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:10:57.257 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739761857147261952,"ephemeral":false,"proof":""}]'
2025-02-17 03:10:57.259 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-17 03:10:57.259 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15504/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:10:57.260 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-17 03:10:58.261 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.266 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-17 03:10:58.266 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-17 03:10:58.366 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-17 03:10:58.366 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:10:58.369 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739761858261423872,"ephemeral":false,"proof":""}]'
2025-02-17 03:10:58.370 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-17 03:10:58.370 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15504/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-17 03:10:58.372 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739761858261423872,"ephemeral":false}]'
2025-02-17 03:10:58.373 INFO [src.steps.relay] WARM UP successful!!
2025-02-17 03:10:58.374 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-17 03:10:58.374 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.377 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 03:10:58.377 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-17 03:10:58.378 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.380 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 03:10:58.381 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-17 03:10:58.381 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.383 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 03:10:58.384 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-17 03:10:58.384 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.386 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 03:10:58.387 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-17 03:10:58.387 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.389 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 03:10:58.390 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-17 03:10:58.390 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.393 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 03:10:58.393 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-17 03:10:58.394 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-17 03:10:58.396 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:19336/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data: '
2025-02-17 03:10:58.398 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-17 03:10:58.399 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-17 03:10:58.400 DEBUG [src.node.waku_node] Stopping container with id 12ac0d0a16dc
2025-02-17 03:10:58.941 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:10:58.943 DEBUG [src.node.waku_node] Stopping container with id 63c14ff943d8
2025-02-17 03:10:59.417 DEBUG [src.node.waku_node] Container stopped.
2025-02-17 03:10:59.418 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-17 03:10:59.431 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-17 03:10:59.435 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
