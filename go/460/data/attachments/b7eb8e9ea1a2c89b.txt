2025-02-10 03:10:16.064 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-10 03:10:16.065 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-10_03-10-16__73572164-e7f7-4b6d-8684-d6a9b2cc3ac3
2025-02-10 03:10:16.065 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-10 03:10:16.065 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-10 03:10:16.065 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-10 03:10:16.066 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-10 03:10:16.066 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-10 03:10:16.072 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 03:10:16.072 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-10_03-10-16__73572164-e7f7-4b6d-8684-d6a9b2cc3ac3__wakuorg_nwaku:latest.log
2025-02-10 03:10:16.073 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 03:10:16.073 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 03:10:16.074 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 03:10:16.074 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.9.223
2025-02-10 03:10:16.074 DEBUG [src.node.docker_mananger] Generated ports ['51186', '51187', '51188', '51189', '51190']
2025-02-10 03:10:16.074 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 03:10:16.075 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 03:10:16.075 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 03:10:16.075 DEBUG [src.node.docker_mananger] docker run -i -t -p 51186:51186 -p 51187:51187 -p 51188:51188 -p 51189:51189 -p 51190:51190 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51188 --rest-port=51186 --tcp-port=51187 --discv5-udp-port=51189 --rest-address=0.0.0.0 --nat=extip:172.18.9.223 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5f1ebbeb1cefcad2b8cc56d2d72afd5babaef543449bdb3689a7eb3dfd71f2f1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51190 --metrics-logging=true --lightpush=true --relay=true
2025-02-10 03:10:16.319 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.9.223 waku cb2f8609b43eba2ae2bac49fc0bfb8f77fd6f7692aaa0bcb07f3d0b0536e15b5
2025-02-10 03:10:16.356 ERROR [src.node.docker_mananger] Max retries reached for container 0ae6b655536d. Exiting log stream.
2025-02-10 03:10:16.365 DEBUG [src.node.docker_mananger] Container started with ID cb2f8609b43e. Setting up logs at ./log/docker/receiving_node1_2025-02-10_03-10-16__73572164-e7f7-4b6d-8684-d6a9b2cc3ac3__wakuorg_nwaku:latest.log
2025-02-10 03:10:16.365 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 51186
2025-02-10 03:10:16.365 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 03:10:16.872 ERROR [src.node.docker_mananger] Max retries reached for container 936a2dcd34d5. Exiting log stream.
2025-02-10 03:10:17.366 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51186/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 03:10:17.369 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 03:10:17.369 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 03:10:17.369 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51186/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 03:10:17.371 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.9.223/tcp/51187/p2p/16Uiu2HAmCMpZLZRiKUHrnvVoJEQLSwDUjZxbcdMvDXrLx5N9Z55a","/ip4/172.18.9.223/tcp/51188/ws/p2p/16Uiu2HAmCMpZLZRiKUHrnvVoJEQLSwDUjZxbcdMvDXrLx5N9Z55a"],"enrUri":"enr:-L24QBLydwZJ0YB2OsYIacJCqKqsfgWtmmNaz9RGZ2Qe-sOWZH9vgGhoRKD1SOhYSWHFX2IC_8CxjP2JdVP4vi5YlNsCgmlkgnY0gmlwhKwSCd-KbXVsdGlhZGRyc5YACASsEgnfBsfzAAoErBIJ3wbH9N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-5oN2Kr3rE6s5bviA0ahmijzrU_QLwNhKYwmk7bVOLmDdGNwgsfzg3VkcILH9YV3YWt1Mgk"}'
2025-02-10 03:10:17.371 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 03:10:17.378 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-10 03:10:17.378 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-10_03-10-16__73572164-e7f7-4b6d-8684-d6a9b2cc3ac3__wakuorg_nwaku:latest.log
2025-02-10 03:10:17.378 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 03:10:17.378 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 03:10:17.380 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 03:10:17.380 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.132.77
2025-02-10 03:10:17.380 DEBUG [src.node.docker_mananger] Generated ports ['11531', '11532', '11533', '11534', '11535']
2025-02-10 03:10:17.380 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 03:10:17.380 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 03:10:17.380 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 03:10:17.380 DEBUG [src.node.docker_mananger] docker run -i -t -p 11531:11531 -p 11532:11532 -p 11533:11533 -p 11534:11534 -p 11535:11535 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11533 --rest-port=11531 --tcp-port=11532 --discv5-udp-port=11534 --rest-address=0.0.0.0 --nat=extip:172.18.132.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=184d01f9a9b338db482c85864e70e5fab3298deb0f9aeabb1fcf5b8157df4440 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11535 --metrics-logging=true --lightpush=false --relay=true
2025-02-10 03:10:17.601 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.132.77 waku fab546339084c80af0fb282d0c145f7df6f442e6765b48816985dc5536adbb6c
2025-02-10 03:10:17.649 DEBUG [src.node.docker_mananger] Container started with ID fab546339084. Setting up logs at ./log/docker/receiving_node2_2025-02-10_03-10-16__73572164-e7f7-4b6d-8684-d6a9b2cc3ac3__wakuorg_nwaku:latest.log
2025-02-10 03:10:17.650 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 11531
2025-02-10 03:10:17.651 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 03:10:18.651 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11531/health" -H "Content-Type: application/json" -d 'None'
2025-02-10 03:10:18.653 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-10 03:10:18.654 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-10 03:10:18.654 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:11531/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 03:10:18.656 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.132.77/tcp/11532/p2p/16Uiu2HAmG9P6woQwdqEQZ7AtE3VqUb7Ma34iKBSAvHVrCuGvrgd5","/ip4/172.18.132.77/tcp/11533/ws/p2p/16Uiu2HAmG9P6woQwdqEQZ7AtE3VqUb7Ma34iKBSAvHVrCuGvrgd5"],"enrUri":"enr:-L24QEFPelWFyArlDf7j8jlcD1pZcDiYzHztUhdfS0WUJR96RIxE9XsLZ44ApXUnUBDP5Vq5ZphIeX_6BLuHKOGa1sECgmlkgnY0gmlwhKwShE2KbXVsdGlhZGRyc5YACASsEoRNBi0MAAoErBKETQYtDd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDM9kMy0mRhgkMjCeDixoL5KB11m_vw80gTiRZmtoBXICDdGNwgi0Mg3VkcIItDoV3YWt1MgE"}'
2025-02-10 03:10:18.656 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 03:10:18.657 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11531/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.9.223/tcp/51187/p2p/16Uiu2HAmCMpZLZRiKUHrnvVoJEQLSwDUjZxbcdMvDXrLx5N9Z55a"]'
2025-02-10 03:10:18.700 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 03:10:18.707 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-10 03:10:18.707 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-10_03-10-16__73572164-e7f7-4b6d-8684-d6a9b2cc3ac3__wakuorg_go-waku:latest.log
2025-02-10 03:10:18.707 DEBUG [src.node.waku_node] Starting Node...
2025-02-10 03:10:18.707 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-10 03:10:18.714 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-10 03:10:18.715 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.130.21
2025-02-10 03:10:18.717 DEBUG [src.node.docker_mananger] Generated ports ['3459', '3460', '3461', '3462', '3463']
2025-02-10 03:10:18.718 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-10 03:10:18.719 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-10 03:10:18.719 DEBUG [src.node.waku_node] Using volumes []
2025-02-10 03:10:18.720 DEBUG [src.node.docker_mananger] docker run -i -t -p 3459:3459 -p 3460:3460 -p 3461:3461 -p 3462:3462 -p 3463:3463 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=3461 --rest-port=3459 --tcp-port=3460 --discv5-udp-port=3462 --rest-address=0.0.0.0 --nat=extip:172.18.130.21 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e945ca6c975fb783cbfc4981faf40fdc0cf6eba38c59e7f898aa64d97bfedcdd --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QBLydwZJ0YB2OsYIacJCqKqsfgWtmmNaz9RGZ2Qe-sOWZH9vgGhoRKD1SOhYSWHFX2IC_8CxjP2JdVP4vi5YlNsCgmlkgnY0gmlwhKwSCd-KbXVsdGlhZGRyc5YACASsEgnfBsfzAAoErBIJ3wbH9N0DgnJzhQADAQAAiXNlY3AyNTZrMaEC-5oN2Kr3rE6s5bviA0ahmijzrU_QLwNhKYwmk7bVOLmDdGNwgsfzg3VkcILH9YV3YWt1Mgk --lightpushnode=/ip4/172.18.9.223/tcp/51187/p2p/16Uiu2HAmCMpZLZRiKUHrnvVoJEQLSwDUjZxbcdMvDXrLx5N9Z55a --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-10 03:10:18.952 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.130.21 waku 2e1557c63ec8daf8de804b689c9d1b042747eebedbfa91ee5f805444b6137206
2025-02-10 03:10:19.007 DEBUG [src.node.docker_mananger] Container started with ID 2e1557c63ec8. Setting up logs at ./log/docker/lightpush_node1_2025-02-10_03-10-16__73572164-e7f7-4b6d-8684-d6a9b2cc3ac3__wakuorg_go-waku:latest.log
2025-02-10 03:10:19.008 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 3459
2025-02-10 03:10:19.009 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-10 03:10:20.010 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:3459/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-10 03:10:20.013 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QAr9_PnjsOyaHvNyPp8-YvRNMA4sc50S8R9ayDHDClgBcGvVn40OZp2bxsggUuxlwhWFMdGwbq9StiPex9XSQAiGAZTt1hl3gmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQKomp3HA-47TLdd5hlMKh3DHlASitZsFZy6ujsapaD-J4N0Y3CCDYSDdWRwgg2GhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/3460/p2p/16Uiu2HAm6mqDXAd1yNLE1BiAX8BREiUBEFTVGciFjverzhBmoBgz","/ip4/127.0.0.1/tcp/3461/ws/p2p/16Uiu2HAm6mqDXAd1yNLE1BiAX8BREiUBEFTVGciFjverzhBmoBgz","/ip4/172.17.0.4/tcp/3460/p2p/16Uiu2HAm6mqDXAd1yNLE1BiAX8BREiUBEFTVGciFjverzhBmoBgz","/ip4/172.17.0.4/tcp/3461/ws/p2p/16Uiu2HAm6mqDXAd1yNLE1BiAX8BREiUBEFTVGciFjverzhBmoBgz"]}'
2025-02-10 03:10:20.013 INFO [src.node.waku_node] REST service is ready !!
2025-02-10 03:10:20.013 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3459/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.9.223/tcp/51187/p2p/16Uiu2HAmCMpZLZRiKUHrnvVoJEQLSwDUjZxbcdMvDXrLx5N9Z55a", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-10 03:10:20.015 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-10 03:10:20.016 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3459/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.132.77/tcp/11532/p2p/16Uiu2HAmG9P6woQwdqEQZ7AtE3VqUb7Ma34iKBSAvHVrCuGvrgd5", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-10 03:10:20.034 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-10 03:10:20.035 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:51186/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 03:10:20.041 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 03:10:20.042 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:11531/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-10 03:10:20.049 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-10 03:10:20.051 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:3459/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1739157020051629824}}'
2025-02-10 03:10:20.062 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-10 03:10:20.062 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-10 03:10:20.562 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51186/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-10 03:10:20.565 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739157020051629824,"ephemeral":false}]'
2025-02-10 03:10:20.565 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-10 03:10:25.566 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-10 03:10:25.570 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-10 03:10:25.570 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-10 03:10:25.573 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-10 03:10:25.574 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-10 03:10:25.577 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-10 03:10:25.577 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-10 03:10:25.580 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-10 03:10:25.580 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-10 03:10:25.583 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-10 03:10:25.583 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-10 03:10:25.586 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-10 03:10:25.586 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-10 03:10:25.589 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-10 03:10:25.591 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-10 03:10:25.592 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-10 03:10:25.592 DEBUG [src.node.waku_node] Stopping container with id cb2f8609b43e
2025-02-10 03:10:26.132 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 03:10:26.132 DEBUG [src.node.waku_node] Stopping container with id fab546339084
2025-02-10 03:10:26.944 ERROR [src.node.docker_mananger] Max retries reached for container cb2f8609b43e. Exiting log stream.
2025-02-10 03:10:27.621 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 03:10:27.621 DEBUG [src.node.waku_node] Stopping container with id 2e1557c63ec8
2025-02-10 03:10:28.106 DEBUG [src.node.waku_node] Container stopped.
2025-02-10 03:10:28.108 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-10 03:10:28.116 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 03:10:28.122 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-10 03:10:28.125 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
