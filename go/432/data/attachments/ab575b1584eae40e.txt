[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2025-01-15_03-03-53__b30848f6-3670-4453-877d-ea46c545262d
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-01-15_03-03-53__b30848f6-3670-4453-877d-ea46c545262d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.228.89
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['46440', '46441', '46442', '46443', '46444']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 46440:46440 -p 46441:46441 -p 46442:46442 -p 46443:46443 -p 46444:46444 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46442 --rest-port=46440 --tcp-port=46441 --discv5-udp-port=46443 --rest-address=0.0.0.0 --nat=extip:172.18.228.89 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b8e4bfaeee5ff6c6c4c058a8cbdfd85dbb9a51e0bb2eff45be8deca4c01e0dcf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46444 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.228.89 waku ffa1223530ab51d2c50b40607f0e35905b7d31922ed4efe5c82d89a26346b542
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ffa1223530ab. Setting up logs at ./log/docker/receiving_node1_2025-01-15_03-03-53__b30848f6-3670-4453-877d-ea46c545262d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 46440
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 03440d69967f. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46440/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46440/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.228.89/tcp/46441/p2p/16Uiu2HAmBiKtRrc4zEXsSSpb9hkx7qyF15jtXnuvpXmKy8T2yaBS","/ip4/172.18.228.89/tcp/46442/ws/p2p/16Uiu2HAmBiKtRrc4zEXsSSpb9hkx7qyF15jtXnuvpXmKy8T2yaBS"],"enrUri":"enr:-L24QGnH1qdkG3l5f3d1PfsmQEZ1NpnIXeFYtZLy04ThlS7ta2kuwAWPGgqcpa6h-SX1ZIA5j4jz9SEcbFzNXsMppqoCgmlkgnY0gmlwhKwS5FmKbXVsdGlhZGRyc5YACASsEuRZBrVpAAoErBLkWQa1at0DgnJzhQADAQAAiXNlY3AyNTZrMaEC8f8lW6xojXtMU3m_Lql40SVzcdMagyGm-epmgo7wzdGDdGNwgrVpg3VkcIK1a4V3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-01-15_03-03-53__b30848f6-3670-4453-877d-ea46c545262d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.197.153
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20864', '20865', '20866', '20867', '20868']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20864:20864 -p 20865:20865 -p 20866:20866 -p 20867:20867 -p 20868:20868 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20866 --rest-port=20864 --tcp-port=20865 --discv5-udp-port=20867 --rest-address=0.0.0.0 --nat=extip:172.18.197.153 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3ca4f6161bde8436f7b6fecceee0a2e92bfa1fdf79ed8c2d6b796b4cc651fcfc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20868 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.197.153 waku 0df5e07970dd67c6f59f9cba852ba1e1dcd5c7e442a0e8e693929436314a4b0d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 0df5e07970dd. Setting up logs at ./log/docker/receiving_node2_2025-01-15_03-03-53__b30848f6-3670-4453-877d-ea46c545262d__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 20864
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20864/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20864/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.197.153/tcp/20865/p2p/16Uiu2HAky5pHvyZ7sVEfENNz4XEwvUBWM8DhbXZhrHchfzGpqwSe","/ip4/172.18.197.153/tcp/20866/ws/p2p/16Uiu2HAky5pHvyZ7sVEfENNz4XEwvUBWM8DhbXZhrHchfzGpqwSe"],"enrUri":"enr:-L24QIncnRYMI-xBsQRKUvE_q2kT_pJTp7IULKE1wXpA2_jeH8l080s9iDbh1twU2ZNiqNx8-LpBK73kRneews59RFcCgmlkgnY0gmlwhKwSxZmKbXVsdGlhZGRyc5YACASsEsWZBlGBAAoErBLFmQZRgt0DgnJzhQADAQAAiXNlY3AyNTZrMaECNliH3y2zo19cpPyY--cDyikVuD35a26iwZAexm8vLneDdGNwglGBg3VkcIJRg4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20864/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.228.89/tcp/46441/p2p/16Uiu2HAmBiKtRrc4zEXsSSpb9hkx7qyF15jtXnuvpXmKy8T2yaBS"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-01-15_03-03-53__b30848f6-3670-4453-877d-ea46c545262d__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.76.34
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['43335', '43336', '43337', '43338', '43339']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 43335:43335 -p 43336:43336 -p 43337:43337 -p 43338:43338 -p 43339:43339 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=43337 --rest-port=43335 --tcp-port=43336 --discv5-udp-port=43338 --rest-address=0.0.0.0 --nat=extip:172.18.76.34 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=6acdf0832b9a4dfee7f79e6811dab2d7b3e6a8d6e9e60feaef3ef6a2daeb369f --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QGnH1qdkG3l5f3d1PfsmQEZ1NpnIXeFYtZLy04ThlS7ta2kuwAWPGgqcpa6h-SX1ZIA5j4jz9SEcbFzNXsMppqoCgmlkgnY0gmlwhKwS5FmKbXVsdGlhZGRyc5YACASsEuRZBrVpAAoErBLkWQa1at0DgnJzhQADAQAAiXNlY3AyNTZrMaEC8f8lW6xojXtMU3m_Lql40SVzcdMagyGm-epmgo7wzdGDdGNwgrVpg3VkcIK1a4V3YWt1Mgk --lightpushnode=/ip4/172.18.228.89/tcp/46441/p2p/16Uiu2HAmBiKtRrc4zEXsSSpb9hkx7qyF15jtXnuvpXmKy8T2yaBS --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.76.34 waku 08540394bf5877a614ef9e029d76e2922e8efdf3dabd140fe0ac45a5ecbac041
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 08540394bf58. Setting up logs at ./log/docker/lightpush_node1_2025-01-15_03-03-53__b30848f6-3670-4453-877d-ea46c545262d__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/go-waku:latest. REST: 43335
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:43335/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QEzk1r2PvMRv-ZManN3l3opjCxiEqsbOucvnFFm1IiS3N7fAAWxQibXSXjOci4oBKQSyNwJ0D1N3Ci9-BPOgsPGGAZRn6umtgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQLhodt-RCwR052BQXVtTcuxTQmg82Ax5X8YTp5oDIko3YN0Y3CCqUiDdWRwgqlKhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/43336/p2p/16Uiu2HAmAcSroc8AnQtPSkrD4qzSDqVXzJGCbZoCgPyChxkvZfGp","/ip4/127.0.0.1/tcp/43337/ws/p2p/16Uiu2HAmAcSroc8AnQtPSkrD4qzSDqVXzJGCbZoCgPyChxkvZfGp","/ip4/172.17.0.4/tcp/43336/p2p/16Uiu2HAmAcSroc8AnQtPSkrD4qzSDqVXzJGCbZoCgPyChxkvZfGp","/ip4/172.17.0.4/tcp/43337/ws/p2p/16Uiu2HAmAcSroc8AnQtPSkrD4qzSDqVXzJGCbZoCgPyChxkvZfGp"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43335/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.228.89/tcp/46441/p2p/16Uiu2HAmBiKtRrc4zEXsSSpb9hkx7qyF15jtXnuvpXmKy8T2yaBS", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43335/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.197.153/tcp/20865/p2p/16Uiu2HAky5pHvyZ7sVEfENNz4XEwvUBWM8DhbXZhrHchfzGpqwSe", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:46440/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20864/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43335/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1736910237115535360, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46440/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1736910237115535360,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20864/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1736910237115535360,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:43335/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1736910237234039040, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:46440/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1736910237234039040,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20864/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1736910237234039040,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id ffa1223530ab
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 0df5e07970dd
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ffa1223530ab. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 08540394bf58
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.