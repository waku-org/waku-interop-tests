[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_filter_subscribe_to_pubsub_topics_from_multiple_clusters with id: 2024-11-22_03-27-59__6904b3f2-2715-470b-b168-e347f3f77044
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:34 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-22_03-27-59__6904b3f2-2715-470b-b168-e347f3f77044__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.139.251
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['11907', '11908', '11909', '11910', '11911']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 11907:11907 -p 11908:11908 -p 11909:11909 -p 11910:11910 -p 11911:11911 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=11909 --rest-port=11907 --tcp-port=11908 --discv5-udp-port=11910 --rest-address=0.0.0.0 --nat=extip:172.18.139.251 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fecfdbf49a802b4fbfb8ea6ffe5bb1c5e44693e3eada9eddf77929fb8f8ccfea --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=11911 --metrics-logging=true --relay=true --filter=true
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container e68cfa4fba73. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.139.251 waku b48dfea5b1cc84bf3c1c47fce64976a4448215a20f4aa5c84002647426f64623
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b48dfea5b1cc. Setting up logs at ./log/docker/node1_2024-11-22_03-27-59__6904b3f2-2715-470b-b168-e347f3f77044__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 11907
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11907/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:11907/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.139.251/tcp/11908/p2p/16Uiu2HAm9UdfM3eZy3de1vdhWka2kwy65g86zCxEx5jqsDR2veNC","/ip4/172.18.139.251/tcp/11909/ws/p2p/16Uiu2HAm9UdfM3eZy3de1vdhWka2kwy65g86zCxEx5jqsDR2veNC"],"enrUri":"enr:-L24QNoKtFNJe0ueFOorE_ooauHMkSJPNbkKtHwn5s-K7SSFP_etwDvWPzKDYl0dSWSFtUtmYgtt68JXGSJy6adbuTwCgmlkgnY0gmlwhKwSi_uKbXVsdGlhZGRyc5YACASsEov7Bi6EAAoErBKL-wYuhd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC0MW9BX3MPH_ke-3RbKqwXR3eq9O0YfV3npRYN7VSTVmDdGNwgi6Eg3VkcIIuhoV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:39 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-22_03-27-59__6904b3f2-2715-470b-b168-e347f3f77044__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.111.73
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['49177', '49178', '49179', '49180', '49181']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 49177:49177 -p 49178:49178 -p 49179:49179 -p 49180:49180 -p 49181:49181 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=49179 --rest-port=49177 --tcp-port=49178 --discv5-udp-port=49180 --rest-address=0.0.0.0 --nat=extip:172.18.111.73 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bfb5cd1ba688af64cb9fda317dfcc55cecd0f71239cdcef24bf9f6bfcaffbdd5 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QNoKtFNJe0ueFOorE_ooauHMkSJPNbkKtHwn5s-K7SSFP_etwDvWPzKDYl0dSWSFtUtmYgtt68JXGSJy6adbuTwCgmlkgnY0gmlwhKwSi_uKbXVsdGlhZGRyc5YACASsEov7Bi6EAAoErBKL-wYuhd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC0MW9BX3MPH_ke-3RbKqwXR3eq9O0YfV3npRYN7VSTVmDdGNwgi6Eg3VkcIIuhoV3YWt1MgU --filternode=/ip4/172.18.139.251/tcp/11908/p2p/16Uiu2HAm9UdfM3eZy3de1vdhWka2kwy65g86zCxEx5jqsDR2veNC
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.111.73 waku b028afd8103bf3cd528c0f552628ddc7e7e9be9c9dd62f9320ff44714a722bb8
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b028afd8103b. Setting up logs at ./log/docker/node2_2024-11-22_03-27-59__6904b3f2-2715-470b-b168-e347f3f77044__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 49177
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49177/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QOClRb9vK0dwE_Cj8D0cRX2xSlT0wJUpQo0sJwneR5-JRSz2L7Ak5n1vcr16ClU2Co9y3aDNWoSEuQ3qjKDopICGAZNR6ZS8gmlkgnY0gmlwhKwRAAiCcnODAAMAiXNlY3AyNTZrMaED02w-y556OkbJ6YW7217_eb82zXPhV0SkY68TqGX6X8-DdGNwgsAag3VkcILAHIV3YWt1MoA","listenAddresses":["/ip4/127.0.0.1/tcp/49178/p2p/16Uiu2HAmStJ7C2ZHr8oAu9qL4rL7VcjgD5TPQqx9RyuJDuaWwd9G","/ip4/127.0.0.1/tcp/49179/ws/p2p/16Uiu2HAmStJ7C2ZHr8oAu9qL4rL7VcjgD5TPQqx9RyuJDuaWwd9G","/ip4/172.17.0.8/tcp/49178/p2p/16Uiu2HAmStJ7C2ZHr8oAu9qL4rL7VcjgD5TPQqx9RyuJDuaWwd9G","/ip4/172.17.0.8/tcp/49179/ws/p2p/16Uiu2HAmStJ7C2ZHr8oAu9qL4rL7VcjgD5TPQqx9RyuJDuaWwd9G"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.139.251/tcp/11908/p2p/16Uiu2HAm9UdfM3eZy3de1vdhWka2kwy65g86zCxEx5jqsDR2veNC", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[35mDEBUG   [0m tests.filter.test_subscribe_create:test_subscribe_create.py:41 Running test with pubsub topic: /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11907/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "94931b18-dd2e-4b8e-8659-8968029bcb22", "contentFilters": ["/waku/2/rs/3/1"], "pubsubTopic": "/waku/2/rs/3/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"94931b18-dd2e-4b8e-8659-8968029bcb22","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11907/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/waku/2/rs/3/1", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49177/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[]'
[1m[31mERROR   [0m tests.filter.test_subscribe_create:test_subscribe_create.py:47 PubsubTopic /waku/2/rs/3/1 failed: Peer NODE_2:wakuorg/go-waku:latest couldn't find any messages
[35mDEBUG   [0m tests.filter.test_subscribe_create:test_subscribe_create.py:41 Running test with pubsub topic: /waku/2/rs/2/2
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11907/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/2"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "76ecf28c-7084-4046-b126-48a5784452e7", "contentFilters": ["/waku/2/rs/2/2"], "pubsubTopic": "/waku/2/rs/2/2"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "76ecf28c-7084-4046-b126-48a5784452e7", "contentFilters": ["/waku/2/rs/2/2"], "pubsubTopic": "/waku/2/rs/2/2"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "76ecf28c-7084-4046-b126-48a5784452e7", "contentFilters": ["/waku/2/rs/2/2"], "pubsubTopic": "/waku/2/rs/2/2"}'
[1m[31mERROR   [0m tests.filter.test_subscribe_create:test_subscribe_create.py:47 PubsubTopic /waku/2/rs/2/2 failed: HTTPConnectionPool(host='127.0.0.1', port=49177): Read timed out. (read timeout=20)
[35mDEBUG   [0m tests.filter.test_subscribe_create:test_subscribe_create.py:41 Running test with pubsub topic: /waku/2/rs/3/9
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11907/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/9"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1de0bb67-28de-47dd-b911-a887634cf802", "contentFilters": ["/waku/2/rs/3/9"], "pubsubTopic": "/waku/2/rs/3/9"}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:49177/filter/v2/subscriptions. Response content: b'{"requestId":"1de0bb67-28de-47dd-b911-a887634cf802","statusDesc":"subscription failed"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1de0bb67-28de-47dd-b911-a887634cf802", "contentFilters": ["/waku/2/rs/3/9"], "pubsubTopic": "/waku/2/rs/3/9"}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:49177/filter/v2/subscriptions. Response content: b'{"requestId":"1de0bb67-28de-47dd-b911-a887634cf802","statusDesc":"subscription failed"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1de0bb67-28de-47dd-b911-a887634cf802", "contentFilters": ["/waku/2/rs/3/9"], "pubsubTopic": "/waku/2/rs/3/9"}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:49177/filter/v2/subscriptions. Response content: b'{"requestId":"1de0bb67-28de-47dd-b911-a887634cf802","statusDesc":"subscription failed"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:49177/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "1de0bb67-28de-47dd-b911-a887634cf802", "contentFilters": ["/waku/2/rs/3/9"], "pubsubTopic": "/waku/2/rs/3/9"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"1de0bb67-28de-47dd-b911-a887634cf802","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:11907/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F9" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/waku/2/rs/3/9", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:98 Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:49177/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F9/%2Fwaku%2F2%2Frs%2F3%2F9" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[]'
[1m[31mERROR   [0m tests.filter.test_subscribe_create:test_subscribe_create.py:47 PubsubTopic /waku/2/rs/3/9 failed: Peer NODE_2:wakuorg/go-waku:latest couldn't find any messages
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id b48dfea5b1cc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id b028afd8103b
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b48dfea5b1cc. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.