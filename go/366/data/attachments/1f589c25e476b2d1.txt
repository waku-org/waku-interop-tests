[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_lightpush_with_a_single_receiving_node with id: 2024-11-21_03-46-22__d015390b-d3e4-446b-a72e-6b0bb298858c
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-21_03-46-22__d015390b-d3e4-446b-a72e-6b0bb298858c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.250.81
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['39446', '39447', '39448', '39449', '39450']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 39446:39446 -p 39447:39447 -p 39448:39448 -p 39449:39449 -p 39450:39450 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39448 --rest-port=39446 --tcp-port=39447 --discv5-udp-port=39449 --rest-address=0.0.0.0 --nat=extip:172.18.250.81 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=adba59fadee59b8426eb5f84f649afa2fabbcd1fb5b4e5cf5bb6d7e691605b5f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39450 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.250.81 waku ff8deafa8c8a37d1f152576ade22a2378fb2a674412368a4c61b423070094cfb
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ff8deafa8c8a. Setting up logs at ./log/docker/receiving_node1_2024-11-21_03-46-22__d015390b-d3e4-446b-a72e-6b0bb298858c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 39446
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3fc4fe68df8a. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39446/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:39446/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.250.81/tcp/39447/p2p/16Uiu2HAmNNEWndaLH3B5Gb6yVWy8iKDqDYPusfV27edQc22j9vvR","/ip4/172.18.250.81/tcp/39448/ws/p2p/16Uiu2HAmNNEWndaLH3B5Gb6yVWy8iKDqDYPusfV27edQc22j9vvR"],"enrUri":"enr:-L24QGT1aUn9ps6bva_sGHSv8LpZyId3bEXW5sxUJLYq8MPDYX8oBcFQDS0zKtqJMks4km2XsblPtIVX9yP0d6M2FJ8CgmlkgnY0gmlwhKwS-lGKbXVsdGlhZGRyc5YACASsEvpRBpoXAAoErBL6UQaaGN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDkEoCsSp6vS77WSZNNoExVBGEF9Pz-dIAAxE2rYqp-M6DdGNwgpoXg3VkcIKaGYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-21_03-46-22__d015390b-d3e4-446b-a72e-6b0bb298858c__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.2.56
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['61228', '61229', '61230', '61231', '61232']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 61228:61228 -p 61229:61229 -p 61230:61230 -p 61231:61231 -p 61232:61232 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=61230 --rest-port=61228 --tcp-port=61229 --discv5-udp-port=61231 --rest-address=0.0.0.0 --nat=extip:172.18.2.56 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f2dee7dd7dcb8dd5b5ebc7c85ee06f31cac9603600afda805cbe989c4e21a4bf --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QGT1aUn9ps6bva_sGHSv8LpZyId3bEXW5sxUJLYq8MPDYX8oBcFQDS0zKtqJMks4km2XsblPtIVX9yP0d6M2FJ8CgmlkgnY0gmlwhKwS-lGKbXVsdGlhZGRyc5YACASsEvpRBpoXAAoErBL6UQaaGN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDkEoCsSp6vS77WSZNNoExVBGEF9Pz-dIAAxE2rYqp-M6DdGNwgpoXg3VkcIKaGYV3YWt1Mgk --lightpushnode=/ip4/172.18.250.81/tcp/39447/p2p/16Uiu2HAmNNEWndaLH3B5Gb6yVWy8iKDqDYPusfV27edQc22j9vvR --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.2.56 waku 4e852d64968229f879836d4a60b4db4df8be45cb875d8a94425879f804d0ef93
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 4e852d649682. Setting up logs at ./log/docker/lightpush_node1_2024-11-21_03-46-22__d015390b-d3e4-446b-a72e-6b0bb298858c__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 61228
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:61228/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QITZVZHKKvMrlMMzLzxez1X0VFI0fKays4Fd4AV5-qnpaD0Bmh_0pPjFObsn1vINoS0gismZyRtjLsoakud7G8mGAZNM1AkfgmlkgnY0gmlwhKwRAAiCcnODAAMAiXNlY3AyNTZrMaED5tqPiuvJjunCpmehw-C620Ek__5uH3TuXplCdAVa766DdGNwgu8tg3VkcILvL4V3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/61229/p2p/16Uiu2HAmUC9RA73VfLKQdn1x9sAerYmSVM1DqmsVJhGBzbcDxLDK","/ip4/127.0.0.1/tcp/61230/ws/p2p/16Uiu2HAmUC9RA73VfLKQdn1x9sAerYmSVM1DqmsVJhGBzbcDxLDK","/ip4/172.17.0.8/tcp/61229/p2p/16Uiu2HAmUC9RA73VfLKQdn1x9sAerYmSVM1DqmsVJhGBzbcDxLDK","/ip4/172.17.0.8/tcp/61230/ws/p2p/16Uiu2HAmUC9RA73VfLKQdn1x9sAerYmSVM1DqmsVJhGBzbcDxLDK"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61228/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.250.81/tcp/39447/p2p/16Uiu2HAmNNEWndaLH3B5Gb6yVWy8iKDqDYPusfV27edQc22j9vvR", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:39446/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:61228/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732160785849207808}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:61228/lightpush/v1/message. Response content: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id ff8deafa8c8a
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 4e852d649682
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ff8deafa8c8a. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-21_03-46-22__d015390b-d3e4-446b-a72e-6b0bb298858c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-21_03-46-22__d015390b-d3e4-446b-a72e-6b0bb298858c__wakuorg_go-waku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_lightpush_with_a_single_receiving_node with id: 2024-11-21_03-46-29__2ffac2ff-a0ca-4035-a55f-5d31ff104e07
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-21_03-46-29__2ffac2ff-a0ca-4035-a55f-5d31ff104e07__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.108.12
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['4151', '4152', '4153', '4154', '4155']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 4151:4151 -p 4152:4152 -p 4153:4153 -p 4154:4154 -p 4155:4155 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4153 --rest-port=4151 --tcp-port=4152 --discv5-udp-port=4154 --rest-address=0.0.0.0 --nat=extip:172.18.108.12 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fc5cb4b2d8cfadf9c78f6a5ea348b55f5bbd1264fdca0e1bdfd0cca0229de0fe --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4155 --metrics-logging=true --lightpush=true --relay=true
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 4e852d649682. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.108.12 waku 6bcd2d6bd762026ee9d42206a0c7e8b8627793f3a07294e0efad026aa43d5604
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 6bcd2d6bd762. Setting up logs at ./log/docker/receiving_node1_2024-11-21_03-46-29__2ffac2ff-a0ca-4035-a55f-5d31ff104e07__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 4151
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4151/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4151/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.108.12/tcp/4152/p2p/16Uiu2HAmUZUavvCWnmPhp42c3y8yjCMSML7crifGwSfG88fH9Hgr","/ip4/172.18.108.12/tcp/4153/ws/p2p/16Uiu2HAmUZUavvCWnmPhp42c3y8yjCMSML7crifGwSfG88fH9Hgr"],"enrUri":"enr:-L24QMPOd4hbj-oXvgqlPbXrWiyHsurwiZHUhIUdYLgNHE5RWDWxURfyur9VGWbebXlkpSQen2RXVAjlof_Qy9YOUCECgmlkgnY0gmlwhKwSbAyKbXVsdGlhZGRyc5YACASsEmwMBhA4AAoErBJsDAYQOd0DgnJzhQADAQAAiXNlY3AyNTZrMaED7FFufJ9lEIsJg5tKFZrZjstPMGEUD3TdeC5pyepFl4eDdGNwghA4g3VkcIIQOoV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-21_03-46-29__2ffac2ff-a0ca-4035-a55f-5d31ff104e07__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.66.37
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59113', '59114', '59115', '59116', '59117']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59113:59113 -p 59114:59114 -p 59115:59115 -p 59116:59116 -p 59117:59117 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=59115 --rest-port=59113 --tcp-port=59114 --discv5-udp-port=59116 --rest-address=0.0.0.0 --nat=extip:172.18.66.37 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7eb93fa7bc42ccdef3a7caadefeaa92a41f13bd38cdbfe8bc93113dfa1e0a1c7 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QMPOd4hbj-oXvgqlPbXrWiyHsurwiZHUhIUdYLgNHE5RWDWxURfyur9VGWbebXlkpSQen2RXVAjlof_Qy9YOUCECgmlkgnY0gmlwhKwSbAyKbXVsdGlhZGRyc5YACASsEmwMBhA4AAoErBJsDAYQOd0DgnJzhQADAQAAiXNlY3AyNTZrMaED7FFufJ9lEIsJg5tKFZrZjstPMGEUD3TdeC5pyepFl4eDdGNwghA4g3VkcIIQOoV3YWt1Mgk --lightpushnode=/ip4/172.18.108.12/tcp/4152/p2p/16Uiu2HAmUZUavvCWnmPhp42c3y8yjCMSML7crifGwSfG88fH9Hgr --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.66.37 waku f8b84acc8de360f966b774c59c9c07d7ad8a588be2d0c0dcc2f50d0faf460edc
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f8b84acc8de3. Setting up logs at ./log/docker/lightpush_node1_2024-11-21_03-46-29__2ffac2ff-a0ca-4035-a55f-5d31ff104e07__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 59113
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59113/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QKY4SDHXf_IUosrvwpPtJf3aPbAFTuwMUngoGO7TRb4qac2h79WsHTJ41GOE0U24c08rHr5znp4k5YobGUUAqqqGAZNM1CU7gmlkgnY0gmlwhKwRAAiCcnODAAMAiXNlY3AyNTZrMaECZIuD5BGMRAIUnjF1PlIhNGqhSKqbZ5vLMEXNnQCzzWiDdGNwgubqg3VkcILm7IV3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/59114/p2p/16Uiu2HAm2CA8wZizJ6LJzpzyB8ViHJgcVGmfmnPNyCnX5eAjbEN3","/ip4/127.0.0.1/tcp/59115/ws/p2p/16Uiu2HAm2CA8wZizJ6LJzpzyB8ViHJgcVGmfmnPNyCnX5eAjbEN3","/ip4/172.17.0.8/tcp/59114/p2p/16Uiu2HAm2CA8wZizJ6LJzpzyB8ViHJgcVGmfmnPNyCnX5eAjbEN3","/ip4/172.17.0.8/tcp/59115/ws/p2p/16Uiu2HAm2CA8wZizJ6LJzpzyB8ViHJgcVGmfmnPNyCnX5eAjbEN3"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59113/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.108.12/tcp/4152/p2p/16Uiu2HAmUZUavvCWnmPhp42c3y8yjCMSML7crifGwSfG88fH9Hgr", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4151/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59113/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732160793007038976}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:59113/lightpush/v1/message. Response content: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 6bcd2d6bd762
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id f8b84acc8de3
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 6bcd2d6bd762. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-21_03-46-29__2ffac2ff-a0ca-4035-a55f-5d31ff104e07__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-21_03-46-29__2ffac2ff-a0ca-4035-a55f-5d31ff104e07__wakuorg_go-waku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_lightpush_with_a_single_receiving_node with id: 2024-11-21_03-46-35__bb4f7c0b-89db-4b39-834c-ca01d86cf5b9
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-21_03-46-35__bb4f7c0b-89db-4b39-834c-ca01d86cf5b9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.57.209
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3453', '3454', '3455', '3456', '3457']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3453:3453 -p 3454:3454 -p 3455:3455 -p 3456:3456 -p 3457:3457 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=3455 --rest-port=3453 --tcp-port=3454 --discv5-udp-port=3456 --rest-address=0.0.0.0 --nat=extip:172.18.57.209 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e1fa0bc33503bf800da05b213d3ce7ce485c9994dee73c5cfd3c9a0d0fcddba8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=3457 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.57.209 waku f8d34b383edf21536ac7c4751872402d598368d9c654709772cc4db494bd71d6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f8d34b383edf. Setting up logs at ./log/docker/receiving_node1_2024-11-21_03-46-35__bb4f7c0b-89db-4b39-834c-ca01d86cf5b9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 3453
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f8b84acc8de3. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3453/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3453/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.57.209/tcp/3454/p2p/16Uiu2HAmFHXBCjsRadmF3T6nMGbWvNCJn1xa3RhyA4wgjcZWMJx2","/ip4/172.18.57.209/tcp/3455/ws/p2p/16Uiu2HAmFHXBCjsRadmF3T6nMGbWvNCJn1xa3RhyA4wgjcZWMJx2"],"enrUri":"enr:-L24QFh1I8wRmxfL3eYNvG1nUmuumpXIhbfjfZbklClUdKvbf8STUsbBI_ri5e8g6aIIziJsInV110dakzZruBxAFoYCgmlkgnY0gmlwhKwSOdGKbXVsdGlhZGRyc5YACASsEjnRBg1-AAoErBI50QYNf90DgnJzhQADAQAAiXNlY3AyNTZrMaEDJxMjXfuOEcn3mw-59rltYpxtO2tSPc7HBDJe-7VcEIuDdGNwgg1-g3VkcIINgIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-21_03-46-35__bb4f7c0b-89db-4b39-834c-ca01d86cf5b9__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.76.124
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['4050', '4051', '4052', '4053', '4054']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 4050:4050 -p 4051:4051 -p 4052:4052 -p 4053:4053 -p 4054:4054 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=4052 --rest-port=4050 --tcp-port=4051 --discv5-udp-port=4053 --rest-address=0.0.0.0 --nat=extip:172.18.76.124 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cda32d9acfdedae6de9b9fcb8adf8a09cad5ad9b1edeabfdde9cee17df50fd5f --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QFh1I8wRmxfL3eYNvG1nUmuumpXIhbfjfZbklClUdKvbf8STUsbBI_ri5e8g6aIIziJsInV110dakzZruBxAFoYCgmlkgnY0gmlwhKwSOdGKbXVsdGlhZGRyc5YACASsEjnRBg1-AAoErBI50QYNf90DgnJzhQADAQAAiXNlY3AyNTZrMaEDJxMjXfuOEcn3mw-59rltYpxtO2tSPc7HBDJe-7VcEIuDdGNwgg1-g3VkcIINgIV3YWt1Mgk --lightpushnode=/ip4/172.18.57.209/tcp/3454/p2p/16Uiu2HAmFHXBCjsRadmF3T6nMGbWvNCJn1xa3RhyA4wgjcZWMJx2 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.76.124 waku f771d90e01822aa15ee8e733246f6b73f541c99ba8ba40f30a3b841e328db8cd
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f771d90e0182. Setting up logs at ./log/docker/lightpush_node1_2024-11-21_03-46-35__bb4f7c0b-89db-4b39-834c-ca01d86cf5b9__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 4050
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4050/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QH6KTKkbvIurzLVbkk-WyQb4OAvA9ferZO0Ob7swfXZpKCMsZG8Kx9orHc7xYADiSiogmzINMXKb1AXuR_ndrr2GAZNM1D3ngmlkgnY0gmlwhKwRAASCcnODAAMAiXNlY3AyNTZrMaECubflRYCVBjwfbhc40Ixjt5KJVDegah6xpZ6RXKS5rd6DdGNwgg_Tg3VkcIIP1YV3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/4051/p2p/16Uiu2HAm7ve3QV7KUZoGRAgMFU9S29sKUXtycBNoG9ABiQbWsSQ5","/ip4/127.0.0.1/tcp/4052/ws/p2p/16Uiu2HAm7ve3QV7KUZoGRAgMFU9S29sKUXtycBNoG9ABiQbWsSQ5","/ip4/172.17.0.4/tcp/4051/p2p/16Uiu2HAm7ve3QV7KUZoGRAgMFU9S29sKUXtycBNoG9ABiQbWsSQ5","/ip4/172.17.0.4/tcp/4052/ws/p2p/16Uiu2HAm7ve3QV7KUZoGRAgMFU9S29sKUXtycBNoG9ABiQbWsSQ5"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4050/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.57.209/tcp/3454/p2p/16Uiu2HAmFHXBCjsRadmF3T6nMGbWvNCJn1xa3RhyA4wgjcZWMJx2", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3453/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4050/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732160799356013568}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:4050/lightpush/v1/message. Response content: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id f8d34b383edf
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id f771d90e0182
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f8d34b383edf. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-21_03-46-35__bb4f7c0b-89db-4b39-834c-ca01d86cf5b9__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-21_03-46-35__bb4f7c0b-89db-4b39-834c-ca01d86cf5b9__wakuorg_go-waku:latest.log