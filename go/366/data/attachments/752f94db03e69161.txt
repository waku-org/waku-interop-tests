[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_after_light_push_node_restarts with id: 2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.182.60
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['62293', '62294', '62295', '62296', '62297']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 62293:62293 -p 62294:62294 -p 62295:62295 -p 62296:62296 -p 62297:62297 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62295 --rest-port=62293 --tcp-port=62294 --discv5-udp-port=62296 --rest-address=0.0.0.0 --nat=extip:172.18.182.60 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8818f530fa8bccaa4a8e6eef74abddc9c148f636ca82f24b0adccdedbcaedf3f --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62297 --metrics-logging=true --lightpush=true --relay=true
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 4a10bc7d59e2. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.182.60 waku 6cbb7fb9225c6a6f38489a79c0951b8954527eacc4fc6ae591a15d7637eef195
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 6cbb7fb9225c. Setting up logs at ./log/docker/receiving_node1_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 62293
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62293/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62293/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.182.60/tcp/62294/p2p/16Uiu2HAmPiwXRHTyJESpky7zLRX3ywu4KNeghjGQEa2ntCH5aBFV","/ip4/172.18.182.60/tcp/62295/ws/p2p/16Uiu2HAmPiwXRHTyJESpky7zLRX3ywu4KNeghjGQEa2ntCH5aBFV"],"enrUri":"enr:-L24QFOVICnA7gxCkChD8uPOp6Awm6_JzDddBkr2QWNGEk1EHkNAdqLnMAOxc0QGcq3Z2JGw_hS9d7wysCjXhIiAuQcCgmlkgnY0gmlwhKwStjyKbXVsdGlhZGRyc5YACASsErY8BvNWAAoErBK2PAbzV90DgnJzhQADAQAAiXNlY3AyNTZrMaEDpHOvTnxBdgSFXHNj-6MVW5ev4m1u0rOsh7i26RXcs1iDdGNwgvNWg3VkcILzWIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.220.211
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59157', '59158', '59159', '59160', '59161']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59157:59157 -p 59158:59158 -p 59159:59159 -p 59160:59160 -p 59161:59161 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59159 --rest-port=59157 --tcp-port=59158 --discv5-udp-port=59160 --rest-address=0.0.0.0 --nat=extip:172.18.220.211 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e6155bdeeb4cb87f838e0d5dceca4ad84ea142acbfa6b8c308b1d3c4d41aad4d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59161 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.220.211 waku 1959a4841b47395b68960574e984b50e8470abe302bac03fc17242b667764c02
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 1959a4841b47. Setting up logs at ./log/docker/receiving_node2_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 59157
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59157/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59157/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.220.211/tcp/59158/p2p/16Uiu2HAmNH8n2ZyMcj3rXGHSJLdMP4VsoWLXD5QoupqVGNign812","/ip4/172.18.220.211/tcp/59159/ws/p2p/16Uiu2HAmNH8n2ZyMcj3rXGHSJLdMP4VsoWLXD5QoupqVGNign812"],"enrUri":"enr:-L24QFiqtAMaSfV-aBCD9C5iWm8wgqO0GJ8nMOnfesyZMu76ReZCHXR2wjUHT1dp7LgxjPXkXqRDz_xPRtkML2RnTNoCgmlkgnY0gmlwhKwS3NOKbXVsdGlhZGRyc5YACASsEtzTBucWAAoErBLc0wbnF90DgnJzhQADAQAAiXNlY3AyNTZrMaEDjvueji2L_5kNXRaBSHHdosT4Z3XuA5bcZoy0v2igYdWDdGNwgucWg3VkcILnGIV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59157/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.182.60/tcp/62294/p2p/16Uiu2HAmPiwXRHTyJESpky7zLRX3ywu4KNeghjGQEa2ntCH5aBFV"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.84.140
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['44531', '44532', '44533', '44534', '44535']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 44531:44531 -p 44532:44532 -p 44533:44533 -p 44534:44534 -p 44535:44535 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=44533 --rest-port=44531 --tcp-port=44532 --discv5-udp-port=44534 --rest-address=0.0.0.0 --nat=extip:172.18.84.140 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=778ec9a884ebdcc5b0cf19ed5daafaeaeb6b4049eacc1ef9fd7b7e06beff1ded --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QFOVICnA7gxCkChD8uPOp6Awm6_JzDddBkr2QWNGEk1EHkNAdqLnMAOxc0QGcq3Z2JGw_hS9d7wysCjXhIiAuQcCgmlkgnY0gmlwhKwStjyKbXVsdGlhZGRyc5YACASsErY8BvNWAAoErBK2PAbzV90DgnJzhQADAQAAiXNlY3AyNTZrMaEDpHOvTnxBdgSFXHNj-6MVW5ev4m1u0rOsh7i26RXcs1iDdGNwgvNWg3VkcILzWIV3YWt1Mgk --lightpushnode=/ip4/172.18.182.60/tcp/62294/p2p/16Uiu2HAmPiwXRHTyJESpky7zLRX3ywu4KNeghjGQEa2ntCH5aBFV --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.84.140 waku 35bcfb48b95c0abbcd08a31d08362f2523a616cb7d3a69047533d8a0c264a7a6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 35bcfb48b95c. Setting up logs at ./log/docker/lightpush_node1_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 44531
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:44531/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QBSqSyLGLc0W4V4sE375Sy9EyDcE7_A8TQ46cIhKdEobeW6Ho-v0-BwqGl2wCHQXo03do_3Dclh_GTskjSgcyjeGAZNM0lGOgmlkgnY0gmlwhKwRAASCcnODAAMAiXNlY3AyNTZrMaECrK_8uwMKHLoyBCTuanFYLgZTmO1umDCcdPHPzH0ssiGDdGNwgq30g3VkcIKt9oV3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/44532/p2p/16Uiu2HAm73mkLa1VnZ2CZa52hTv9xirrYYCMxVxfgneTsE1XHoPE","/ip4/127.0.0.1/tcp/44533/ws/p2p/16Uiu2HAm73mkLa1VnZ2CZa52hTv9xirrYYCMxVxfgneTsE1XHoPE","/ip4/172.17.0.4/tcp/44532/p2p/16Uiu2HAm73mkLa1VnZ2CZa52hTv9xirrYYCMxVxfgneTsE1XHoPE","/ip4/172.17.0.4/tcp/44533/ws/p2p/16Uiu2HAm73mkLa1VnZ2CZa52hTv9xirrYYCMxVxfgneTsE1XHoPE"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44531/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.182.60/tcp/62294/p2p/16Uiu2HAmPiwXRHTyJESpky7zLRX3ywu4KNeghjGQEa2ntCH5aBFV", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44531/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.220.211/tcp/59158/p2p/16Uiu2HAmNH8n2ZyMcj3rXGHSJLdMP4VsoWLXD5QoupqVGNign812", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62293/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59157/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:44531/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732160673270127360}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:44531/lightpush/v1/message. Response content: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 6cbb7fb9225c
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 1959a4841b47
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 6cbb7fb9225c. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 35bcfb48b95c
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 1959a4841b47. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node2_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-21_03-44-27__80cb2361-4f29-47a4-a4c9-a71d8a0f2ef5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_after_light_push_node_restarts with id: 2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.8.114
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29550', '29551', '29552', '29553', '29554']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29550:29550 -p 29551:29551 -p 29552:29552 -p 29553:29553 -p 29554:29554 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29552 --rest-port=29550 --tcp-port=29551 --discv5-udp-port=29553 --rest-address=0.0.0.0 --nat=extip:172.18.8.114 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3f84a87cc4b5a2f189b4fcafc73fc6a43e0c9dcf18f08a05ac15a8c0afedb74a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29554 --metrics-logging=true --lightpush=true --relay=true
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 35bcfb48b95c. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.8.114 waku 02b1ad8de0bcb8fbaf25f09eb738b444ebce67d2f8d66be613e0708560fb98ac
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 02b1ad8de0bc. Setting up logs at ./log/docker/receiving_node1_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 29550
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29550/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29550/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.8.114/tcp/29551/p2p/16Uiu2HAmAf6SURaQ3188ERQnq3pAQYgH7cgVYRdv4tRuJxG7kiYp","/ip4/172.18.8.114/tcp/29552/ws/p2p/16Uiu2HAmAf6SURaQ3188ERQnq3pAQYgH7cgVYRdv4tRuJxG7kiYp"],"enrUri":"enr:-L24QM4daZSD2KpUOVHTD4PSmEMDVgjA-TcEBRGe3aXFFoBbAnw5QQI4p-xdM_txsrnfZM-YNW78emXE4mUAfmDnY8kCgmlkgnY0gmlwhKwSCHKKbXVsdGlhZGRyc5YACASsEghyBnNvAAoErBIIcgZzcN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4k-C7M1bLCHsN6EvvxSlAydAyzcusDG4Luh0XrH5e7GDdGNwgnNvg3VkcIJzcYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.106.42
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['30028', '30029', '30030', '30031', '30032']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 30028:30028 -p 30029:30029 -p 30030:30030 -p 30031:30031 -p 30032:30032 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30030 --rest-port=30028 --tcp-port=30029 --discv5-udp-port=30031 --rest-address=0.0.0.0 --nat=extip:172.18.106.42 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bdcbc692bcdacdfa336e998d1daceee43bfdfd45a026fd2f2ef2beea7c4ef6ab --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30032 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.106.42 waku 42890c75030f0a3a3b099e8ff0a464cee9f7b5a809e2cc8c461fa27ef957a66f
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 42890c75030f. Setting up logs at ./log/docker/receiving_node2_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 30028
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30028/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:30028/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.106.42/tcp/30029/p2p/16Uiu2HAm1zVXQopGyfc9cg58c9xdAyjusmwU5ZBWCNTgpcpbbABV","/ip4/172.18.106.42/tcp/30030/ws/p2p/16Uiu2HAm1zVXQopGyfc9cg58c9xdAyjusmwU5ZBWCNTgpcpbbABV"],"enrUri":"enr:-L24QN6SbLD79jepqW5gDYchGMrOsLVmVP3rOKBG56JlRAOjM_7mMCcn03oAStoZPYW4iwjb-zc8D0NBaa1Mx2RaLasCgmlkgnY0gmlwhKwSaiqKbXVsdGlhZGRyc5YACASsEmoqBnVNAAoErBJqKgZ1Tt0DgnJzhQADAQAAiXNlY3AyNTZrMaECYY53hvGnQsUsP0RAWQ32fQJ-hsCAuLpMk1GXVmwSNbSDdGNwgnVNg3VkcIJ1T4V3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30028/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.8.114/tcp/29551/p2p/16Uiu2HAmAf6SURaQ3188ERQnq3pAQYgH7cgVYRdv4tRuJxG7kiYp"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.89.52
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['62051', '62052', '62053', '62054', '62055']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 62051:62051 -p 62052:62052 -p 62053:62053 -p 62054:62054 -p 62055:62055 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=62053 --rest-port=62051 --tcp-port=62052 --discv5-udp-port=62054 --rest-address=0.0.0.0 --nat=extip:172.18.89.52 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=82ee20ee8ff8ef5dde0fbfb65de6f88e4ecc0b17a8e3d2801df3dae5fcbe22d2 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QM4daZSD2KpUOVHTD4PSmEMDVgjA-TcEBRGe3aXFFoBbAnw5QQI4p-xdM_txsrnfZM-YNW78emXE4mUAfmDnY8kCgmlkgnY0gmlwhKwSCHKKbXVsdGlhZGRyc5YACASsEghyBnNvAAoErBIIcgZzcN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC4k-C7M1bLCHsN6EvvxSlAydAyzcusDG4Luh0XrH5e7GDdGNwgnNvg3VkcIJzcYV3YWt1Mgk --lightpushnode=/ip4/172.18.8.114/tcp/29551/p2p/16Uiu2HAmAf6SURaQ3188ERQnq3pAQYgH7cgVYRdv4tRuJxG7kiYp --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.89.52 waku 90aa3c069ab67b4aef2c2ab32328f0cdccab388fb619add5068c765edd2b09b6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 90aa3c069ab6. Setting up logs at ./log/docker/lightpush_node1_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 62051
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62051/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QDqUGuUUSJm4UIb3_8XPMhAUqDg5bHxgBV-jMwbe55ezO83poG6UMsCxq79381KuIqS1quDVmlJ6_g4nL9y0i-GGAZNM0noNgmlkgnY0gmlwhKwRAAKCcnODAAMAiXNlY3AyNTZrMaECaqnvRSUOMPy5KWYiUKFOzVLph34dPBbC_7Nk28OaFxODdGNwgvJkg3VkcILyZoV3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/62052/p2p/16Uiu2HAm2c3VCcor6tYrUs9bQFAQN5VHwfNMiszsK2v6tiQE8zPC","/ip4/127.0.0.1/tcp/62053/ws/p2p/16Uiu2HAm2c3VCcor6tYrUs9bQFAQN5VHwfNMiszsK2v6tiQE8zPC","/ip4/172.17.0.2/tcp/62052/p2p/16Uiu2HAm2c3VCcor6tYrUs9bQFAQN5VHwfNMiszsK2v6tiQE8zPC","/ip4/172.17.0.2/tcp/62053/ws/p2p/16Uiu2HAm2c3VCcor6tYrUs9bQFAQN5VHwfNMiszsK2v6tiQE8zPC"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62051/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.8.114/tcp/29551/p2p/16Uiu2HAmAf6SURaQ3188ERQnq3pAQYgH7cgVYRdv4tRuJxG7kiYp", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62051/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.106.42/tcp/30029/p2p/16Uiu2HAm1zVXQopGyfc9cg58c9xdAyjusmwU5ZBWCNTgpcpbbABV", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29550/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:30028/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62051/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732160683775439872}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:62051/lightpush/v1/message. Response content: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 02b1ad8de0bc
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 42890c75030f
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 02b1ad8de0bc. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 90aa3c069ab6
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 42890c75030f. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node2_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-21_03-44-38__529f5731-f282-4601-a1a0-f1f7c662707f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_after_light_push_node_restarts with id: 2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.66.57
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['15769', '15770', '15771', '15772', '15773']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 15769:15769 -p 15770:15770 -p 15771:15771 -p 15772:15772 -p 15773:15773 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15771 --rest-port=15769 --tcp-port=15770 --discv5-udp-port=15772 --rest-address=0.0.0.0 --nat=extip:172.18.66.57 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ae2ec4ffb41a30c08f8fc74fe87524706ccd3cd01f3c513206038edbee4fc0b1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15773 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.66.57 waku 572433c23f131f86249bbcdbaf557db91af272fa065b2478735d1ba50baa477d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 572433c23f13. Setting up logs at ./log/docker/receiving_node1_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 15769
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 90aa3c069ab6. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15769/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15769/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.66.57/tcp/15770/p2p/16Uiu2HAmPmcP45qf1ZdcBAmENd4cYvs9i3t5HDb3txVMQvn2TKu3","/ip4/172.18.66.57/tcp/15771/ws/p2p/16Uiu2HAmPmcP45qf1ZdcBAmENd4cYvs9i3t5HDb3txVMQvn2TKu3"],"enrUri":"enr:-L24QI6wFQI95wIEMr7OQumy1klEg8DcSfpsK4W0qnNuWxz6U75Kx3gSo5jOyxx1DkMp0KHcDgNGfp3DS5-i3OgVuzkCgmlkgnY0gmlwhKwSQjmKbXVsdGlhZGRyc5YACASsEkI5Bj2aAAoErBJCOQY9m90DgnJzhQADAQAAiXNlY3AyNTZrMaEDpSLH4DiL2RMhwcG5TxjM5LsVdqQBIK2vGlF2eF7aN1KDdGNwgj2ag3VkcII9nIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.251.168
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29307', '29308', '29309', '29310', '29311']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29307:29307 -p 29308:29308 -p 29309:29309 -p 29310:29310 -p 29311:29311 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29309 --rest-port=29307 --tcp-port=29308 --discv5-udp-port=29310 --rest-address=0.0.0.0 --nat=extip:172.18.251.168 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fc90a0e519f4f3c2ef05ed7afd7f8dd6de6c35572d3d170dfde95a9ead7cae57 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29311 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.251.168 waku f1ebf5b7cb07a5bac5e76656681a6c7ffeea46d0ab9d8dea4de62c403b8fabb1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID f1ebf5b7cb07. Setting up logs at ./log/docker/receiving_node2_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 29307
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29307/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29307/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.251.168/tcp/29308/p2p/16Uiu2HAmNN5KtMKqDvdEfqozmWozwL78zuReevY9rtWE2rxgTMcD","/ip4/172.18.251.168/tcp/29309/ws/p2p/16Uiu2HAmNN5KtMKqDvdEfqozmWozwL78zuReevY9rtWE2rxgTMcD"],"enrUri":"enr:-L24QNV4TrLvEBZXLuKeeC6Gkr7acnuUB6D8MtW4otMPbRqMHtL7xlXGCd4yJ7JE93WwEnihaFnahLQ7L91tGMaq1vkCgmlkgnY0gmlwhKwS-6iKbXVsdGlhZGRyc5YACASsEvuoBnJ8AAoErBL7qAZyfd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDkD-fJUAoT4tR4K6XMVp2sPfTddillxrJ7wZoVwhnSWqDdGNwgnJ8g3VkcIJyfoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29307/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.66.57/tcp/15770/p2p/16Uiu2HAmPmcP45qf1ZdcBAmENd4cYvs9i3t5HDb3txVMQvn2TKu3"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.149.48
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['64730', '64731', '64732', '64733', '64734']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 64730:64730 -p 64731:64731 -p 64732:64732 -p 64733:64733 -p 64734:64734 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=64732 --rest-port=64730 --tcp-port=64731 --discv5-udp-port=64733 --rest-address=0.0.0.0 --nat=extip:172.18.149.48 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4b2dff47b29355ee854b8b0ae065e7cb5afecf6fe99399c9ffae5e99433b14bc --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QI6wFQI95wIEMr7OQumy1klEg8DcSfpsK4W0qnNuWxz6U75Kx3gSo5jOyxx1DkMp0KHcDgNGfp3DS5-i3OgVuzkCgmlkgnY0gmlwhKwSQjmKbXVsdGlhZGRyc5YACASsEkI5Bj2aAAoErBJCOQY9m90DgnJzhQADAQAAiXNlY3AyNTZrMaEDpSLH4DiL2RMhwcG5TxjM5LsVdqQBIK2vGlF2eF7aN1KDdGNwgj2ag3VkcII9nIV3YWt1Mgk --lightpushnode=/ip4/172.18.66.57/tcp/15770/p2p/16Uiu2HAmPmcP45qf1ZdcBAmENd4cYvs9i3t5HDb3txVMQvn2TKu3 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.149.48 waku 41fba26d88e496b102cbb59dd0dac09205298c4c668eedd6761f9b1d1ca6b8e2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 41fba26d88e4. Setting up logs at ./log/docker/lightpush_node1_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 64730
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64730/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QPUi6Y6xpMqyIWCiX-Sd4-KR0-tQbC3zJOAyNi5PV22Xa8kdXG9WWzv6oc4-g3GsI0NkrAgjXi42pfXkobo7o_WGAZNM0qcogmlkgnY0gmlwhKwRAASCcnODAAMAiXNlY3AyNTZrMaEDHXC744i02T8z_nQnHnLujuIkiwHYg7TCFnmeHnju_PaDdGNwgvzbg3VkcIL83YV3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/64731/p2p/16Uiu2HAmEdusnEVWeSafB8rFTyDFPNZkk1GDpVU39oCRPx2M3dc9","/ip4/127.0.0.1/tcp/64732/ws/p2p/16Uiu2HAmEdusnEVWeSafB8rFTyDFPNZkk1GDpVU39oCRPx2M3dc9","/ip4/172.17.0.4/tcp/64731/p2p/16Uiu2HAmEdusnEVWeSafB8rFTyDFPNZkk1GDpVU39oCRPx2M3dc9","/ip4/172.17.0.4/tcp/64732/ws/p2p/16Uiu2HAmEdusnEVWeSafB8rFTyDFPNZkk1GDpVU39oCRPx2M3dc9"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64730/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.66.57/tcp/15770/p2p/16Uiu2HAmPmcP45qf1ZdcBAmENd4cYvs9i3t5HDb3txVMQvn2TKu3", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64730/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.251.168/tcp/29308/p2p/16Uiu2HAmNN5KtMKqDvdEfqozmWozwL78zuReevY9rtWE2rxgTMcD", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15769/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29307/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64730/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732160695232251904}}'
[1m[31mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:64730/lightpush/v1/message. Response content: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 572433c23f13
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id f1ebf5b7cb07
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 572433c23f13. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 41fba26d88e4
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container f1ebf5b7cb07. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node2_2024-11-21_03-44-49__ad6c63fe-4304-46c9-a277-4d9cce664bf5__wakuorg_nwaku:latest.log