[35mDEBUG   [0m tests.conftest:conftest.py:43 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:49 Running test: test_filter_get_message_after_node2_restarts with id: 2024-03-28_03-10-13__003bcbae-a631-4895-ba22-7c801c052f0d
[35mDEBUG   [0m src.steps.filter:filter.py:27 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.filter:filter.py:33 Running fixture setup: setup_main_relay_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node1_2024-03-28_03-10-13__003bcbae-a631-4895-ba22-7c801c052f0d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.98.207
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['60329', '60330', '60331', '60332', '60333']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:279 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 60329:60329 -p 60330:60330 -p 60331:60331 -p 60332:60332 -p 60333:60333 harbor.status.im/wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60331 --rest-port=60329 --tcp-port=60330 --discv5-udp-port=60332 --rest-address=0.0.0.0 --nat=extip:172.18.98.207 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60333 --metrics-logging=true --relay=true --filter=true --nodekey=30348dd51465150e04a5d9d932c72864c8967f806cce60b5d26afeca1e77eb68
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.98.207 waku 241f5c9897974735a4fc28996c8c954b02d862609404d1d23939f805a007463e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 241f5c989797. Setting up logs at ./log/docker/node1_2024-03-28_03-10-13__003bcbae-a631-4895-ba22-7c801c052f0d__harbor.status.im_wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/nwaku:latest. REST: 60329
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:60329/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.98.207/tcp/60330/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip","/ip4/172.18.98.207/tcp/60331/ws/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip"],"enrUri":"enr:-LG4QJ7Pn5PwD7tKRQE-v_oxOlt6g0cW_up0sWyc5YSCVuM2CmeoFXnYYuINSqGUCXwHcp_NNvulPKLtmvbNqkpQZj8BgmlkgnY0gmlwhKwSYs-KbXVsdGlhZGRyc4wACgSsEmLPBuur3QOCcnODAAAAiXNlY3AyNTZrMaEDN06qX-XhZ-Cc7ZuIAdGNCVUicscmbFvEEfkFOQ2W_j2DdGNwguuqg3VkcILrrIV3YWt1MgU"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:38 Running fixture setup: setup_main_filter_node
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image harbor.status.im/wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:50 WakuNode instance initialized with log path ./log/docker/node2_2024-03-28_03-10-13__003bcbae-a631-4895-ba22-7c801c052f0d__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:54 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.83.143
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['33807', '33808', '33809', '33810', '33811']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:279 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:115 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 33807:33807 -p 33808:33808 -p 33809:33809 -p 33810:33810 -p 33811:33811 harbor.status.im/wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=33809 --rest-port=33807 --tcp-port=33808 --discv5-udp-port=33810 --rest-address=0.0.0.0 --nat=extip:172.18.83.143 --peer-exchange=true --discv5-discovery=true --cluster-id=0 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --relay=false --discv5-bootstrap-node=enr:-LG4QJ7Pn5PwD7tKRQE-v_oxOlt6g0cW_up0sWyc5YSCVuM2CmeoFXnYYuINSqGUCXwHcp_NNvulPKLtmvbNqkpQZj8BgmlkgnY0gmlwhKwSYs-KbXVsdGlhZGRyc4wACgSsEmLPBuur3QOCcnODAAAAiXNlY3AyNTZrMaEDN06qX-XhZ-Cc7ZuIAdGNCVUicscmbFvEEfkFOQ2W_j2DdGNwguuqg3VkcILrrIV3YWt1MgU --filternode=/ip4/172.18.98.207/tcp/60330/p2p/16Uiu2HAmGNtM2rQ8abySFNhqPDFY4cmfAEpfo9Z9fD3NekoFR2ip
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.83.143 waku 78e0911188a44a7ccd6fb8b3284c5d73d6b658e7fd4a49e669e0b2fd1cb7956d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 78e0911188a4. Setting up logs at ./log/docker/node2_2024-03-28_03-10-13__003bcbae-a631-4895-ba22-7c801c052f0d__harbor.status.im_wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:121 Started container from image harbor.status.im/wakuorg/go-waku:latest. REST: 33807
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:33807/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QNgAG4qnwmDRsr_mouHmMbHtHu2KHPr-Eb2sQb8pQO1ZE6n_04bpQmQLt2SPH5faro-5Oxpj7TXRODhvecuR1MGGAY6DCWu-gmlkgnY0gmlwhKwRAAWKbXVsdGlhZGRyc5gACgR_AAABBoQR3QMACgSsEQAFBoQR3QOJc2VjcDI1NmsxoQIdSdtaenGim1YmjWVAmhhXJE3OlAYI8HBrGJutfLIaCYN0Y3CChBCDdWRwgoQShXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/33808/p2p/16Uiu2HAkwQ184hzQWoW6TyBXVfbZivE6ooWqSSzbeCJee239fteC","/ip4/127.0.0.1/tcp/33809/ws/p2p/16Uiu2HAkwQ184hzQWoW6TyBXVfbZivE6ooWqSSzbeCJee239fteC","/ip4/172.17.0.5/tcp/33808/p2p/16Uiu2HAkwQ184hzQWoW6TyBXVfbZivE6ooWqSSzbeCJee239fteC","/ip4/172.17.0.5/tcp/33809/ws/p2p/16Uiu2HAkwQ184hzQWoW6TyBXVfbZivE6ooWqSSzbeCJee239fteC"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.steps.filter:filter.py:45 Running fixture setup: subscribe_main_nodes
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:60329/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:33807/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "dc500ed7-40a0-4711-909d-8b46f2f86572", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"dc500ed7-40a0-4711-909d-8b46f2f86572","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:60329/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:33807/filter/v2/messages/%2Fwaku%2F2%2Frs%2F0%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1711595419154584832,"ephemeral":false}]'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:175 Restarting container with id 78e0911188a4
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:33807/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:33807/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"enrUri":"enr:-Ly4QM9rsCEmBo8XBgA2cCpqJ57fFiPdZ27_ELFbmjicjZnjVTKNCptgCJfJJW5TXcwrdesmyYvv8ksyEyfrx0P8KeuGAY6DCX3FgmlkgnY0gmlwhKwRAAWKbXVsdGlhZGRyc5gACgSsEQAFBoQR3QMACgR_AAABBoQR3QOJc2VjcDI1NmsxoQKHax97fppiMXGk038nY5Dmp7aAvtp9Mfrn5JvuD4T04oN0Y3CChBCDdWRwgoQShXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/33808/p2p/16Uiu2HAm4YHkzYwy62hG4P2Mc9N3SMvXE8TzxiEMU2Ktnka3bUyP","/ip4/127.0.0.1/tcp/33809/ws/p2p/16Uiu2HAm4YHkzYwy62hG4P2Mc9N3SMvXE8TzxiEMU2Ktnka3bUyP","/ip4/172.17.0.5/tcp/33808/p2p/16Uiu2HAm4YHkzYwy62hG4P2Mc9N3SMvXE8TzxiEMU2Ktnka3bUyP","/ip4/172.17.0.5/tcp/33809/ws/p2p/16Uiu2HAm4YHkzYwy62hG4P2Mc9N3SMvXE8TzxiEMU2Ktnka3bUyP"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:191 REST service is ready !!
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:60329/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/0/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:33807/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "02409394-7801-4b26-ade3-634dc6b263cd", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/0/1"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'{"requestId":"02409394-7801-4b26-ade3-634dc6b263cd","statusDesc":"OK"}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X POST "http://127.0.0.1:60329/relay/v1/messages/%2Fwaku%2F2%2Frs%2F0%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.filter:filter.py:94 Checking that peer NODE_2:harbor.status.im/wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:38 curl -v -X GET "http://127.0.0.1:33807/filter/v2/messages/%2Fwaku%2F2%2Frs%2F0%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:23 Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1711595428475693312,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:75 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 241f5c989797
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:168 Stopping container with id 78e0911188a4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:171 Container stopped.