2025-02-06 03:06:13.600 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-06 03:06:13.600 DEBUG [tests.conftest] Running test: test_publish_with_payload_less_than_150_kb with id: 2025-02-06_03-06-13__c284a016-3993-4c4d-a974-8993179117ee
2025-02-06 03:06:13.600 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-06 03:06:13.601 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-06 03:06:13.601 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-06 03:06:13.607 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-06 03:06:13.607 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-06_03-06-13__c284a016-3993-4c4d-a974-8993179117ee__wakuorg_nwaku:latest.log
2025-02-06 03:06:13.607 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 03:06:13.608 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 03:06:13.609 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 03:06:13.609 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.62.220
2025-02-06 03:06:13.609 DEBUG [src.node.docker_mananger] Generated ports ['59737', '59738', '59739', '59740', '59741']
2025-02-06 03:06:13.609 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 03:06:13.609 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 03:06:13.610 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 03:06:13.610 DEBUG [src.node.docker_mananger] docker run -i -t -p 59737:59737 -p 59738:59738 -p 59739:59739 -p 59740:59740 -p 59741:59741 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59739 --rest-port=59737 --tcp-port=59738 --discv5-udp-port=59740 --rest-address=0.0.0.0 --nat=extip:172.18.62.220 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=abafa6bcaafc87aadb5f3c39cbae4d9c43d9efbdbebd2c3ae899b365845aaace --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59741 --metrics-logging=true --relay=true
2025-02-06 03:06:13.847 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.62.220 waku 4614a9ef64c3d040040c2cc35fef98f7e4628d7f019c04f9d85351fc8482a21d
2025-02-06 03:06:13.894 DEBUG [src.node.docker_mananger] Container started with ID 4614a9ef64c3. Setting up logs at ./log/docker/node1_2025-02-06_03-06-13__c284a016-3993-4c4d-a974-8993179117ee__wakuorg_nwaku:latest.log
2025-02-06 03:06:13.895 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59737
2025-02-06 03:06:13.895 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 03:06:14.384 ERROR [src.node.docker_mananger] Max retries reached for container 97ea2a8a529d. Exiting log stream.
2025-02-06 03:06:14.895 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59737/health" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:14.898 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-06 03:06:14.898 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-06 03:06:14.898 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59737/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:14.900 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.62.220/tcp/59738/p2p/16Uiu2HAkuVyfbMHyvLQ2433qqHmNeex4b8NqLu2zb3Z67wdpWT5J","/ip4/172.18.62.220/tcp/59739/ws/p2p/16Uiu2HAkuVyfbMHyvLQ2433qqHmNeex4b8NqLu2zb3Z67wdpWT5J"],"enrUri":"enr:-L24QLaIX-cnSjWEAPvS6nI_RqnmhkH0pRomwwhJaRlgeBMnAQNbSNvNUjiko80fh3xWT1Ru7mrPYiAFfz4d6Lv9pmgCgmlkgnY0gmlwhKwSPtyKbXVsdGlhZGRyc5YACASsEj7cBulaAAoErBI-3AbpW90DgnJzhQADAQAAiXNlY3AyNTZrMaECARpSMqO2bZZ436VWc1GToT5aRtVC0cXIGXVLRkhguxmDdGNwgulag3VkcILpXIV3YWt1MgE"}'
2025-02-06 03:06:14.901 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 03:06:14.907 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-06 03:06:14.907 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-06_03-06-13__c284a016-3993-4c4d-a974-8993179117ee__wakuorg_go-waku:latest.log
2025-02-06 03:06:14.907 DEBUG [src.node.waku_node] Starting Node...
2025-02-06 03:06:14.907 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-06 03:06:14.908 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-06 03:06:14.909 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.1.13
2025-02-06 03:06:14.909 DEBUG [src.node.docker_mananger] Generated ports ['62644', '62645', '62646', '62647', '62648']
2025-02-06 03:06:14.909 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-06 03:06:14.909 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-06 03:06:14.909 DEBUG [src.node.waku_node] Using volumes []
2025-02-06 03:06:14.909 DEBUG [src.node.docker_mananger] docker run -i -t -p 62644:62644 -p 62645:62645 -p 62646:62646 -p 62647:62647 -p 62648:62648 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=62646 --rest-port=62644 --tcp-port=62645 --discv5-udp-port=62647 --rest-address=0.0.0.0 --nat=extip:172.18.1.13 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=97d1fc3bd483dbd53f80c09efc131fdbed7fcbabce5cc8ccddb41521146857ad --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QLaIX-cnSjWEAPvS6nI_RqnmhkH0pRomwwhJaRlgeBMnAQNbSNvNUjiko80fh3xWT1Ru7mrPYiAFfz4d6Lv9pmgCgmlkgnY0gmlwhKwSPtyKbXVsdGlhZGRyc5YACASsEj7cBulaAAoErBI-3AbpW90DgnJzhQADAQAAiXNlY3AyNTZrMaECARpSMqO2bZZ436VWc1GToT5aRtVC0cXIGXVLRkhguxmDdGNwgulag3VkcILpXIV3YWt1MgE
2025-02-06 03:06:15.147 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.1.13 waku 24d937eb4ec9a10084fda7f2bfba288cd636892a9f42c91e9d33b56c7f166ddc
2025-02-06 03:06:15.199 DEBUG [src.node.docker_mananger] Container started with ID 24d937eb4ec9. Setting up logs at ./log/docker/node2_2025-02-06_03-06-13__c284a016-3993-4c4d-a974-8993179117ee__wakuorg_go-waku:latest.log
2025-02-06 03:06:15.200 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 62644
2025-02-06 03:06:15.201 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-06 03:06:16.201 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62644/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:16.205 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QBc77xYAQ91GpvowfFZFE0QjMmz25Fd4hJHW7Xj5Bvv0KyqDJ5sTG--sStFH235OwnXrrzjezDwlnTYiyLSr4Z2GAZTZOPEdgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECqFISEHVgvDja4RmmX0ex8fW-DK14RFr3upsoPJfNiiiDdGNwgvS1g3VkcIL0t4V3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/62645/p2p/16Uiu2HAm6kj4FVJaQ92H4YKR33hqZavCieqNbSczRemLjnkVgFQ3","/ip4/127.0.0.1/tcp/62646/ws/p2p/16Uiu2HAm6kj4FVJaQ92H4YKR33hqZavCieqNbSczRemLjnkVgFQ3","/ip4/172.17.0.3/tcp/62645/p2p/16Uiu2HAm6kj4FVJaQ92H4YKR33hqZavCieqNbSczRemLjnkVgFQ3","/ip4/172.17.0.3/tcp/62646/ws/p2p/16Uiu2HAm6kj4FVJaQ92H4YKR33hqZavCieqNbSczRemLjnkVgFQ3"]}'
2025-02-06 03:06:16.205 INFO [src.node.waku_node] REST service is ready !!
2025-02-06 03:06:16.206 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62644/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.62.220/tcp/59738/p2p/16Uiu2HAkuVyfbMHyvLQ2433qqHmNeex4b8NqLu2zb3Z67wdpWT5J", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-06 03:06:16.223 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-06 03:06:16.224 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-06 03:06:16.224 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59737/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 03:06:16.247 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 03:06:16.247 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:62644/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-06 03:06:16.250 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-06 03:06:16.251 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59737/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 03:06:16.264 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 03:06:16.264 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 03:06:16.365 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 03:06:16.365 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59737/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:16.367 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738811176251348992,"ephemeral":false}]'
2025-02-06 03:06:16.369 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 03:06:16.369 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:16.371 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-06 03:06:17.372 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59737/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-06 03:06:17.377 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 03:06:17.377 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-06 03:06:17.478 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 03:06:17.478 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59737/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:17.481 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738811177372301312,"ephemeral":false}]'
2025-02-06 03:06:17.482 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 03:06:17.483 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:17.484 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738811177372301312,"ephemeral":false}]'
2025-02-06 03:06:17.486 INFO [src.steps.relay] WARM UP successful!!
2025-02-06 03:06:17.486 DEBUG [tests.relay.test_publish] Running test with payload length of 102400 bytes
2025-02-06 03:06:17.489 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-06 03:06:17.507 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-06 03:06:17.507 DEBUG [src.libs.common] Sleeping for 2 seconds
2025-02-06 03:06:19.508 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-06 03:06:19.508 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59737/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:19.512 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-06 03:06:19.514 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-06 03:06:19.514 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:62644/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-06 03:06:19.518 INFO [src.node.api_clients.base_client] Log line was discarded because it's longer than max_log_line_length=5000
2025-02-06 03:06:19.522 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-06 03:06:19.523 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-06 03:06:19.523 DEBUG [src.node.waku_node] Stopping container with id 4614a9ef64c3
2025-02-06 03:06:20.396 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 03:06:20.396 DEBUG [src.node.waku_node] Stopping container with id 24d937eb4ec9
2025-02-06 03:06:20.911 DEBUG [src.node.waku_node] Container stopped.
2025-02-06 03:06:20.913 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-06 03:06:20.924 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-06 03:06:20.927 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
