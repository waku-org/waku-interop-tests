[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-08-20_07-58-49__1a54d915-fbe6-4e06-b4ca-7986df407d99
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:27 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-08-20_07-58-49__1a54d915-fbe6-4e06-b4ca-7986df407d99__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.81.223
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['8615', '8616', '8617', '8618', '8619']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 8615:8615 -p 8616:8616 -p 8617:8617 -p 8618:8618 -p 8619:8619 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8617 --rest-port=8615 --tcp-port=8616 --discv5-udp-port=8618 --rest-address=0.0.0.0 --nat=extip:172.18.81.223 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ec896a843965cba1f75c89c1e1be9dfda5bb55c8c966addcaeb04f11331a31a8 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8619 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.81.223 waku a5752283726461f6ddb95e455d5552605ddf381e4958fab6f458d86383412502
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a57522837264. Setting up logs at ./log/docker/receiving_node1_2024-08-20_07-58-49__1a54d915-fbe6-4e06-b4ca-7986df407d99__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 8615
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8615/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8615/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.81.223/tcp/8616/p2p/16Uiu2HAmHdJt6mBVcYLuf1y5bSheG8rFPqi5ZLPgiYaCa7JuU2eq","/ip4/172.18.81.223/tcp/8617/ws/p2p/16Uiu2HAmHdJt6mBVcYLuf1y5bSheG8rFPqi5ZLPgiYaCa7JuU2eq"],"enrUri":"enr:-LO4QNKG3t2dV89pNo4fjPd7XXX0m9Ez5TMHv5zKiML3SWD8Oiv-lWzfsm2pr_PltYkGMjLS7V0eL0F4QwE7wRB2CLsBgmlkgnY0gmlwhKwSUd-KbXVsdGlhZGRyc4wACgSsElHfBiGp3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNJ3DnwNRBZihQk3pht6x_1OUL76tqfS1TfCjDiFrPnzoN0Y3CCIaiDdWRwgiGqhXdha3UyCQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-08-20_07-58-49__1a54d915-fbe6-4e06-b4ca-7986df407d99__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.147.108
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['63403', '63404', '63405', '63406', '63407']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 63403:63403 -p 63404:63404 -p 63405:63405 -p 63406:63406 -p 63407:63407 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=63405 --rest-port=63403 --tcp-port=63404 --discv5-udp-port=63406 --rest-address=0.0.0.0 --nat=extip:172.18.147.108 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9c5e4f9da0b45e4cc1bf96682f6289a601f1c1950a142595c4fabee5bd01a818 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=63407 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.147.108 waku a0cb7cf48a39e90dd3c5f90eb0ac5c2f6becce2c1698f261cd046e0f5811fd82
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID a0cb7cf48a39. Setting up logs at ./log/docker/receiving_node2_2024-08-20_07-58-49__1a54d915-fbe6-4e06-b4ca-7986df407d99__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/nwaku:latest. REST: 63403
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63403/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:276 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:63403/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.147.108/tcp/63404/p2p/16Uiu2HAm3QhWJP941SpLsgaBYmz974Q21HthVcW5DdJkhu9tCmRL","/ip4/172.18.147.108/tcp/63405/ws/p2p/16Uiu2HAm3QhWJP941SpLsgaBYmz974Q21HthVcW5DdJkhu9tCmRL"],"enrUri":"enr:-LO4QPvkah--In6KCxDHjknfnHERCzSujHfCuUhCS3h_UlKwIdTaaTQ2jua9AKNKPGWHyZ3zcquSx3kViLYxK3GJk_oBgmlkgnY0gmlwhKwSk2yKbXVsdGlhZGRyc4wACgSsEpNsBvet3QOCcnOFAAMBAACJc2VjcDI1NmsxoQJ2naPZYB7uhBuZOkij15OGtcnTBFLoJgBen9Qs7FXMm4N0Y3CC96yDdWRwgveuhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63403/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.81.223/tcp/8616/p2p/16Uiu2HAmHdJt6mBVcYLuf1y5bSheG8rFPqi5ZLPgiYaCa7JuU2eq"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:17 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:84 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-08-20_07-58-49__1a54d915-fbe6-4e06-b4ca-7986df407d99__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:88 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:20 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:23 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:80 Generated random external IP 172.18.225.156
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:73 Generated ports ['48804', '48805', '48806', '48807', '48808']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:430 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:162 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:164 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:47 docker run -i -t -p 48804:48804 -p 48805:48805 -p 48806:48806 -p 48807:48807 -p 48808:48808 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=48806 --rest-port=48804 --tcp-port=48805 --discv5-udp-port=48807 --rest-address=0.0.0.0 --nat=extip:172.18.225.156 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d6f187ac7efd1907bf5ff721b7fecd5f0dcc98fbcbfa06a3e20ee3d606ca4a56 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-LO4QNKG3t2dV89pNo4fjPd7XXX0m9Ez5TMHv5zKiML3SWD8Oiv-lWzfsm2pr_PltYkGMjLS7V0eL0F4QwE7wRB2CLsBgmlkgnY0gmlwhKwSUd-KbXVsdGlhZGRyc4wACgSsElHfBiGp3QOCcnOFAAMBAACJc2VjcDI1NmsxoQNJ3DnwNRBZihQk3pht6x_1OUL76tqfS1TfCjDiFrPnzoN0Y3CCIaiDdWRwgiGqhXdha3UyCQ --lightpushnode=/ip4/172.18.81.223/tcp/8616/p2p/16Uiu2HAmHdJt6mBVcYLuf1y5bSheG8rFPqi5ZLPgiYaCa7JuU2eq --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:53 docker network connect --ip 172.18.225.156 waku 3e05d5749a9d84945fa46b50b05b1a791be7a800e164b6d5db9a17bfa175a433
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:56 Container started with ID 3e05d5749a9d. Setting up logs at ./log/docker/lightpush_node1_2024-08-20_07-58-49__1a54d915-fbe6-4e06-b4ca-7986df407d99__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:176 Started container from image wakuorg/go-waku:latest. REST: 48804
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48804/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QNqFpEgar_AzS9kuxnKUfhShgptt1R4kaocWrB8SCDFYYfTEPz3GIZ0m5Wznc3L9nWnSs3CU5UIyAwvPTXlbmfKGAZFuy8REgmlkgnY0gmlwhKwRAA6Jc2VjcDI1NmsxoQIaezI3abpae6uqKTDPptklNNNsJnipiPc2fAN5RReLb4N0Y3CCvqWDdWRwgr6nhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/48805/p2p/16Uiu2HAkwD3Y1WJzBgKSXaB33VyaBBP6T5A7HS8fTJGcimVvMSa2","/ip4/127.0.0.1/tcp/48806/ws/p2p/16Uiu2HAkwD3Y1WJzBgKSXaB33VyaBBP6T5A7HS8fTJGcimVvMSa2","/ip4/172.17.0.14/tcp/48805/p2p/16Uiu2HAkwD3Y1WJzBgKSXaB33VyaBBP6T5A7HS8fTJGcimVvMSa2","/ip4/172.17.0.14/tcp/48806/ws/p2p/16Uiu2HAkwD3Y1WJzBgKSXaB33VyaBBP6T5A7HS8fTJGcimVvMSa2"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:281 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.81.223/tcp/8616/p2p/16Uiu2HAmHdJt6mBVcYLuf1y5bSheG8rFPqi5ZLPgiYaCa7JuU2eq", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.147.108/tcp/63404/p2p/16Uiu2HAm3QhWJP941SpLsgaBYmz974Q21HthVcW5DdJkhu9tCmRL", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8615/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:63403/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724140734617126400}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:48804/lightpush/v1/message. Response content: b'missing Payload field'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724140734620247552}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:48804/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724140734622489600}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:48804/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724140734624973568}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:48804/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724140734627645184}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:48804/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48804/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1724140734630742784}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:48804/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id a57522837264
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id a0cb7cf48a39
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:220 Stopping container with id 3e05d5749a9d
[35mDEBUG   [0m src.node.waku_node:waku_node.py:227 Container stopped.