[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_message_relayed_while_store_node_is_stopped_without_removing with id: 2024-12-29_18-50-15__8a68dcb2-c62d-460e-bf66-161698c77fc5
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-12-29_18-50-15__8a68dcb2-c62d-460e-bf66-161698c77fc5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.174.207
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['32547', '32548', '32549', '32550', '32551']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 32547:32547 -p 32548:32548 -p 32549:32549 -p 32550:32550 -p 32551:32551 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=32549 --rest-port=32547 --tcp-port=32548 --discv5-udp-port=32550 --rest-address=0.0.0.0 --nat=extip:172.18.174.207 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b2bab94d7b01cdfac9bab1e3dde8b8735fd7aa2ff3d59ee50ffb9d4db01c57fc --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=32551 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.174.207 waku 7c2af3f9da34a6c5319c4fbb38ce8ed355ad466f24949d7334316992e622f5be
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 30ceb79a2d47. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 7c2af3f9da34. Setting up logs at ./log/docker/publishing_node1_2024-12-29_18-50-15__8a68dcb2-c62d-460e-bf66-161698c77fc5__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 32547
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ec1b53c8f995. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32547/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32547/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.174.207/tcp/32548/p2p/16Uiu2HAmBdmXoAJtMeq9TPeKVngrMhQfVqu2QFLSMJ8CQ3ynquUh","/ip4/172.18.174.207/tcp/32549/ws/p2p/16Uiu2HAmBdmXoAJtMeq9TPeKVngrMhQfVqu2QFLSMJ8CQ3ynquUh"],"enrUri":"enr:-L24QAEX_EEAkT4lsamRiJJM6rBMc-M9SdsyZXpSdlXT5t1GALEtVkYt3FIhdix-5Lats6w_vF_RadFsME6suWpW148CgmlkgnY0gmlwhKwSrs-KbXVsdGlhZGRyc5YACASsEq7PBn8kAAoErBKuzwZ_Jd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC8NQ86hVdtGp8Vnw7foYXe8_vl3yb97lx4nOkWzSKEuaDdGNwgn8kg3VkcIJ_JoV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-12-29_18-50-15__8a68dcb2-c62d-460e-bf66-161698c77fc5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.248.182
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['31074', '31075', '31076', '31077', '31078']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 31074:31074 -p 31075:31075 -p 31076:31076 -p 31077:31077 -p 31078:31078 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=31076 --rest-port=31074 --tcp-port=31075 --discv5-udp-port=31077 --rest-address=0.0.0.0 --nat=extip:172.18.248.182 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7bfbcebad03afadf51b60ca0f7cecbd8eb34dc6cf1e56aac1bfaadd4bec58e20 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QAEX_EEAkT4lsamRiJJM6rBMc-M9SdsyZXpSdlXT5t1GALEtVkYt3FIhdix-5Lats6w_vF_RadFsME6suWpW148CgmlkgnY0gmlwhKwSrs-KbXVsdGlhZGRyc5YACASsEq7PBn8kAAoErBKuzwZ_Jd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC8NQ86hVdtGp8Vnw7foYXe8_vl3yb97lx4nOkWzSKEuaDdGNwgn8kg3VkcIJ_JoV3YWt1MgM --storenode=/ip4/172.18.174.207/tcp/32548/p2p/16Uiu2HAmBdmXoAJtMeq9TPeKVngrMhQfVqu2QFLSMJ8CQ3ynquUh --store=false --relay=false --pubsub-topic=/waku/2/rs/3/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.248.182 waku dc9e708b8309461641c70ffb66768494b79495f42f0b9fe36cc8155203145596
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID dc9e708b8309. Setting up logs at ./log/docker/store_node1_2024-12-29_18-50-15__8a68dcb2-c62d-460e-bf66-161698c77fc5__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/go-waku:latest. REST: 31074
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31074/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QAyrDt687xa5m3_hHHKmckGF6sfcKvLcwrJNNJh201gYXTFnTMI1I4I8zjddVvy781wKIvq6mE4pxZNWGd3nTH2GAZQTwTY8gmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQImf4zz4aIlzDHHbno-svogOf_knRkwMUN5kEzhrg38ZoN0Y3CCeWODdWRwgnllhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/31075/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo","/ip4/127.0.0.1/tcp/31076/ws/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo","/ip4/172.17.0.3/tcp/31075/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo","/ip4/172.17.0.3/tcp/31076/ws/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:31074/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.174.207/tcp/32548/p2p/16Uiu2HAmBdmXoAJtMeq9TPeKVngrMhQfVqu2QFLSMJ8CQ3ynquUh", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32547/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32547/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0AqOO8GjuMIQe8KvsOeqhQ5kFPICjp+uq/qbLcAnyr8="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31074/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"84a6c0b70ccf35e9dc2c0ede5f3225f60b787731edf858b666c87510fe4989e2","status_code":200,"status_desc":"OK","messages":[{"message_hash":"0AqOO8GjuMIQe8KvsOeqhQ5kFPICjp+uq/qbLcAnyr8="}]}'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:32547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31074/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31074/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QNZIe87uIR5wc3An0uI2pJ4dnA_y-6n-fxnY6l17nSlYZHDw0LyqZHK5jMebRLdVgM2_5mZi_5Iio6COclDwvUyGAZQTwUIkgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQImf4zz4aIlzDHHbno-svogOf_knRkwMUN5kEzhrg38ZoN0Y3CCeWODdWRwgnllhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/31075/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo","/ip4/127.0.0.1/tcp/31076/ws/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo","/ip4/172.17.0.3/tcp/31075/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo","/ip4/172.17.0.3/tcp/31076/ws/p2p/16Uiu2HAkx1xH8WN6UUiXJ2ycK4V73DvuPsaKJptr653oZH7JXGfo"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:32547/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0AqOO8GjuMIQe8KvsOeqhQ5kFPICjp+uq/qbLcAnyr8="},{"messageHash":"5tHB1O+Fbgjc57sH6qAH2tbusqXVLdZRZiBaQspv+Ow="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:31074/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"9d16868c77a0e12271d0f9215a9dc3139040b6d76ac23e828869adadff1b27b5","status_code":200,"status_desc":"OK","messages":[{"message_hash":"0AqOO8GjuMIQe8KvsOeqhQ5kFPICjp+uq/qbLcAnyr8="},{"message_hash":"5tHB1O+Fbgjc57sH6qAH2tbusqXVLdZRZiBaQspv+Ow="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 7c2af3f9da34
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id dc9e708b8309
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 7c2af3f9da34. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.