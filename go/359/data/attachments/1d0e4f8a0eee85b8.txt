[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2024-11-16_03-17-03__fb6a2d09-b952-4c88-9d7a-7b330badff09
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-11-16_03-17-03__fb6a2d09-b952-4c88-9d7a-7b330badff09__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-11-16_03-17-03__fb6a2d09-b952-4c88-9d7a-7b330badff09__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-11-16_03-17-03__fb6a2d09-b952-4c88-9d7a-7b330badff09__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:382 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.79.199
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['56676', '56677', '56678', '56679', '56680']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 56676:56676 -p 56677:56677 -p 56678:56678 -p 56679:56679 -p 56680:56680 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=56678 --rest-port=56676 --tcp-port=56677 --discv5-udp-port=56679 --rest-address=0.0.0.0 --nat=extip:172.18.79.199 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=498f2ee523e8b0678d22cbd7f6aff9bf80bb2b6f1f7ba0685b9fa54beaeebc6e --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.79.199 waku c88ddfcff44e7de418bc98cbdb5f8aac0b82afb3773802fff14645bb84bd0e8b
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c88ddfcff44e. Setting up logs at ./log/docker/node1_2024-11-16_03-17-03__fb6a2d09-b952-4c88-9d7a-7b330badff09__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 56676
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56676/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QDxMV60WvW96dy9JICkwulRzUxYI-59d9Br8tHO9TCtaMyOKv1_KCmimPLD4CLZ5y-7Puz44w8uay9_UTLAtUqSGAZMy-WHygmlkgnY0gmlwhKwRAAKJc2VjcDI1NmsxoQO69SENQhv2XUEJKnHKy3JsoEvFmz2SZgCeFJhjqQo2iIN0Y3CC3WWDdWRwgt1nhXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/56677/p2p/16Uiu2HAmREnyYyLn52bUgCvZUcyCFqyjEFYZjiQRsCgsJmK5Vq2o","/ip4/127.0.0.1/tcp/56678/ws/p2p/16Uiu2HAmREnyYyLn52bUgCvZUcyCFqyjEFYZjiQRsCgsJmK5Vq2o","/ip4/172.17.0.2/tcp/56677/p2p/16Uiu2HAmREnyYyLn52bUgCvZUcyCFqyjEFYZjiQRsCgsJmK5Vq2o","/ip4/172.17.0.2/tcp/56678/ws/p2p/16Uiu2HAmREnyYyLn52bUgCvZUcyCFqyjEFYZjiQRsCgsJmK5Vq2o"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.95.5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['28596', '28597', '28598', '28599', '28600']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 28596:28596 -p 28597:28597 -p 28598:28598 -p 28599:28599 -p 28600:28600 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=28598 --rest-port=28596 --tcp-port=28597 --discv5-udp-port=28599 --rest-address=0.0.0.0 --nat=extip:172.18.95.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c649dcf52ccc2b8e0fdcaed9df05d1d7f0a399bbe1b3fb7f2b53cfbee646ac82 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=28600 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-Ji4QDxMV60WvW96dy9JICkwulRzUxYI-59d9Br8tHO9TCtaMyOKv1_KCmimPLD4CLZ5y-7Puz44w8uay9_UTLAtUqSGAZMy-WHygmlkgnY0gmlwhKwRAAKJc2VjcDI1NmsxoQO69SENQhv2XUEJKnHKy3JsoEvFmz2SZgCeFJhjqQo2iIN0Y3CC3WWDdWRwgt1nhXdha3UyAw
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.95.5 waku c53ec6ee9ac8ef7f6c1b4a3405f27674503f4da8cd7fba30d1b6ef8c521f830d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c53ec6ee9ac8. Setting up logs at ./log/docker/node2_2024-11-16_03-17-03__fb6a2d09-b952-4c88-9d7a-7b330badff09__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 28596
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:28596/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:28596/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.95.5/tcp/28597/p2p/16Uiu2HAmGK1dvpuJvRnmXXh1pu6ydEiahcb3khcYvikYoLcYyzg7","/ip4/172.18.95.5/tcp/28598/ws/p2p/16Uiu2HAmGK1dvpuJvRnmXXh1pu6ydEiahcb3khcYvikYoLcYyzg7"],"enrUri":"enr:-L24QBWbO9Bx6Qa5N_YS6Si9_Vc0VE85Zkj5SpcDMNbPP9RFYkfbl6901DbNUZFNYpa5GqSL3AUW1d2f_88n1pBs4QACgmlkgnY0gmlwhKwSXwWKbXVsdGlhZGRyc5YACASsEl8FBm-1AAoErBJfBQZvtt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDNlCWK5QkGOCby-jPf0xRfigQjgrCYxzbbxEyys9wSzCDdGNwgm-1g3VkcIJvt4V3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.204.213
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['7703', '7704', '7705', '7706', '7707']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 7703:7703 -p 7704:7704 -p 7705:7705 -p 7706:7706 -p 7707:7707 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=7705 --rest-port=7703 --tcp-port=7704 --discv5-udp-port=7706 --rest-address=0.0.0.0 --nat=extip:172.18.204.213 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=42aa4c2bca9a022cdbaf1dda4f44c2dcf5f1ae5d1de9191d241dbf59e88face9 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --storenode=/ip4/172.18.95.5/tcp/28597/p2p/16Uiu2HAmGK1dvpuJvRnmXXh1pu6ydEiahcb3khcYvikYoLcYyzg7 --discv5-bootstrap-node=enr:-L24QBWbO9Bx6Qa5N_YS6Si9_Vc0VE85Zkj5SpcDMNbPP9RFYkfbl6901DbNUZFNYpa5GqSL3AUW1d2f_88n1pBs4QACgmlkgnY0gmlwhKwSXwWKbXVsdGlhZGRyc5YACASsEl8FBm-1AAoErBJfBQZvtt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDNlCWK5QkGOCby-jPf0xRfigQjgrCYxzbbxEyys9wSzCDdGNwgm-1g3VkcIJvt4V3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.204.213 waku abd1fe70cf7dd9a629ff716ab2c15c11f9829f0ed429ad7a1adac7452740df72
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID abd1fe70cf7d. Setting up logs at ./log/docker/node3_2024-11-16_03-17-03__fb6a2d09-b952-4c88-9d7a-7b330badff09__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 7703
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7703/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QLRLBQjaAFqORY4ClZtiWY1Z1-_n5iN2Cg8YC4BYOTbHMYQr3HPYEWWdhOBUAPtedomX3JZ7PwaU8zEnCqNPDYSGAZMy-W8cgmlkgnY0gmlwhKwRAASJc2VjcDI1NmsxoQJHdxD6pJF1mgZJbrFf9Ch4k4rlJAjRIipoMNxLHSOMIoN0Y3CCHhiDdWRwgh4ahXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/7704/p2p/16Uiu2HAkzEeEFxyXjCU4VKpdJdZTbVXX18VhjsYvGVzuSYff47o7","/ip4/127.0.0.1/tcp/7705/ws/p2p/16Uiu2HAkzEeEFxyXjCU4VKpdJdZTbVXX18VhjsYvGVzuSYff47o7","/ip4/172.17.0.4/tcp/7704/p2p/16Uiu2HAkzEeEFxyXjCU4VKpdJdZTbVXX18VhjsYvGVzuSYff47o7","/ip4/172.17.0.4/tcp/7705/ws/p2p/16Uiu2HAkzEeEFxyXjCU4VKpdJdZTbVXX18VhjsYvGVzuSYff47o7"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:387 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:56676/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:28596/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:56676/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"id":"16Uiu2HAmGK1dvpuJvRnmXXh1pu6ydEiahcb3khcYvikYoLcYyzg7","multiaddrs":["/ip4/172.18.95.5/tcp/28597/p2p/16Uiu2HAmGK1dvpuJvRnmXXh1pu6ydEiahcb3khcYvikYoLcYyzg7","/ip4/172.18.95.5/tcp/28598/ws/p2p/16Uiu2HAmGK1dvpuJvRnmXXh1pu6ydEiahcb3khcYvikYoLcYyzg7"],"protocols":["/vac/waku/relay/2.0.0","/vac/waku/store-query/3.0.0","/vac/waku/store/2.0.0-beta4"],"connected":false,"pubsubTopics":[]}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:28596/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.17.0.4/tcp/7704/p2p/16Uiu2HAkzEeEFxyXjCU4VKpdJdZTbVXX18VhjsYvGVzuSYff47o7","protocols":[{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:392 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:56676/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:397 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7703/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&contentTopics=%2Ftest%2F1%2Fwaku-filter%2Fproto&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"9216a83bb437a20ed76014270ac8692b0ffab875a4c6171371ec60c0da44fb34","status_code":200,"status_desc":"OK"}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:401 Response for store when ephemeral = true is strPeer wakuorg/go-waku:latest couldn't find any messages. Actual response: {'request_id': '9216a83bb437a20ed76014270ac8692b0ffab875a4c6171371ec60c0da44fb34', 'status_code': 200, 'status_desc': 'OK'}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:403 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id c88ddfcff44e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id c53ec6ee9ac8
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c88ddfcff44e. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id abd1fe70cf7d
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container c53ec6ee9ac8. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.