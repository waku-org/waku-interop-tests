[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_store_lightpushed_message with id: 2024-10-26_03-21-57__2edf9c98-9560-42fa-8193-95172ea81b87
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-10-26_03-21-57__2edf9c98-9560-42fa-8193-95172ea81b87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.12.35
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['9145', '9146', '9147', '9148', '9149']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 9145:9145 -p 9146:9146 -p 9147:9147 -p 9148:9148 -p 9149:9149 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=9147 --rest-port=9145 --tcp-port=9146 --discv5-udp-port=9148 --rest-address=0.0.0.0 --nat=extip:172.18.12.35 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=9d84ed6e02afa0ecb6cad5b2bc705cbdb62a0053b8ae388fafe05dd8fcdc734d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=9149 --metrics-logging=true --store=true --relay=true --lightpush=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.12.35 waku 5597a76ebcbbf136a28ad63baad48501b08e3ef77457eef9a9b22523a11c1622
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 5597a76ebcbb. Setting up logs at ./log/docker/publishing_node1_2024-10-26_03-21-57__2edf9c98-9560-42fa-8193-95172ea81b87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 9145
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a661918c3452. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9145/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9145/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.12.35/tcp/9146/p2p/16Uiu2HAkuioHgEvG1o61ZJr5gEadf3dcrQLEwYqsvaMh9pTcLN6F","/ip4/172.18.12.35/tcp/9147/ws/p2p/16Uiu2HAkuioHgEvG1o61ZJr5gEadf3dcrQLEwYqsvaMh9pTcLN6F"],"enrUri":"enr:-LO4QDjpK0iU1Vw28nNLUPve9QApLSK0z97anWAq6jjt_KULXEz9xyRxOaweLy7JkKT_sgyxqnR6gDPbo6OXu-12i0sBgmlkgnY0gmlwhKwSDCOKbXVsdGlhZGRyc4wACgSsEgwjBiO73QOCcnOFAAMBAACJc2VjcDI1NmsxoQIEYyMnnQ4WAcfoPVCJ_mQ2pp9wTuR_LUaCXFy0CDQXTIN0Y3CCI7qDdWRwgiO8hXdha3UyCw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node2_2024-10-26_03-21-57__2edf9c98-9560-42fa-8193-95172ea81b87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.117.231
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['15313', '15314', '15315', '15316', '15317']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 15313:15313 -p 15314:15314 -p 15315:15315 -p 15316:15316 -p 15317:15317 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15315 --rest-port=15313 --tcp-port=15314 --discv5-udp-port=15316 --rest-address=0.0.0.0 --nat=extip:172.18.117.231 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ce36fbea16fb62da7ce15a33d81a344425af7fc772445d918bd9eb9b7c6c70d4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15317 --metrics-logging=true --store=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.117.231 waku 1eaaed3d9fa9fcf675d5737230f0c657316f24a552e2e3338a831b191fcbf01d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 1eaaed3d9fa9. Setting up logs at ./log/docker/publishing_node2_2024-10-26_03-21-57__2edf9c98-9560-42fa-8193-95172ea81b87__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 15313
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15313/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:15313/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.117.231/tcp/15314/p2p/16Uiu2HAmEmPA57PEsBf862wgjU2z1iqhAh6iSg2ZTvdtPzyb7GTo","/ip4/172.18.117.231/tcp/15315/ws/p2p/16Uiu2HAmEmPA57PEsBf862wgjU2z1iqhAh6iSg2ZTvdtPzyb7GTo"],"enrUri":"enr:-LO4QCGm_SDjmThF_bxjSTFwW2hsAKZE0di2aIJp-W08IH2BIUVrlO5JRtigsFSbI3rONdpuRFq2p1ohFLbP4lVg73gBgmlkgnY0gmlwhKwSdeeKbXVsdGlhZGRyc4wACgSsEnXnBjvT3QOCcnOFAAMBAACJc2VjcDI1NmsxoQMfWqVs4CTRuHl0LVsPb-9MRkZOB2VOK9m0Pn_lGV2pfoN0Y3CCO9KDdWRwgjvUhXdha3UyAQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15313/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.12.35/tcp/9146/p2p/16Uiu2HAkuioHgEvG1o61ZJr5gEadf3dcrQLEwYqsvaMh9pTcLN6F"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-10-26_03-21-57__2edf9c98-9560-42fa-8193-95172ea81b87__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.165.38
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['64871', '64872', '64873', '64874', '64875']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 64871:64871 -p 64872:64872 -p 64873:64873 -p 64874:64874 -p 64875:64875 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=64873 --rest-port=64871 --tcp-port=64872 --discv5-udp-port=64874 --rest-address=0.0.0.0 --nat=extip:172.18.165.38 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=0ed4bb4b0cfe0f9554cac155ce3a85fecfda8d34360352e3f52d9977e3eaaf0e --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-LO4QDjpK0iU1Vw28nNLUPve9QApLSK0z97anWAq6jjt_KULXEz9xyRxOaweLy7JkKT_sgyxqnR6gDPbo6OXu-12i0sBgmlkgnY0gmlwhKwSDCOKbXVsdGlhZGRyc4wACgSsEgwjBiO73QOCcnOFAAMBAACJc2VjcDI1NmsxoQIEYyMnnQ4WAcfoPVCJ_mQ2pp9wTuR_LUaCXFy0CDQXTIN0Y3CCI7qDdWRwgiO8hXdha3UyCw --storenode=/ip4/172.18.12.35/tcp/9146/p2p/16Uiu2HAkuioHgEvG1o61ZJr5gEadf3dcrQLEwYqsvaMh9pTcLN6F --store=false --relay=false --lightpush=true --lightpushnode=/ip4/172.18.12.35/tcp/9146/p2p/16Uiu2HAkuioHgEvG1o61ZJr5gEadf3dcrQLEwYqsvaMh9pTcLN6F
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.165.38 waku 3896998a2fd5b8a38faf1fb199a29b5fa433204a093aefc64514a917843274c4
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3896998a2fd5. Setting up logs at ./log/docker/store_node1_2024-10-26_03-21-57__2edf9c98-9560-42fa-8193-95172ea81b87__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/go-waku:latest. REST: 64871
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64871/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QDv1QpGVSxPvotQeZJOAbe9da2H_lhkGPwEY-x01WoguFUXTwJ3OFiszvU6xZQuwEi77LQKt4KD2rw1h1TWk1tqGAZLG2F_qgmlkgnY0gmlwhKwRAAmJc2VjcDI1NmsxoQKmopz6ZV6R4IOSShcmMF6YrbtR-tt8byEpDEknhmM2S4N0Y3CC_WiDdWRwgv1qhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/64872/p2p/16Uiu2HAm6e9URzjj9G4PzosTPHeorcgqBbyr3yT8cXuu81fxXR3Q","/ip4/127.0.0.1/tcp/64873/ws/p2p/16Uiu2HAm6e9URzjj9G4PzosTPHeorcgqBbyr3yT8cXuu81fxXR3Q","/ip4/172.17.0.9/tcp/64872/p2p/16Uiu2HAm6e9URzjj9G4PzosTPHeorcgqBbyr3yT8cXuu81fxXR3Q","/ip4/172.17.0.9/tcp/64873/ws/p2p/16Uiu2HAm6e9URzjj9G4PzosTPHeorcgqBbyr3yT8cXuu81fxXR3Q"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64871/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.12.35/tcp/9146/p2p/16Uiu2HAkuioHgEvG1o61ZJr5gEadf3dcrQLEwYqsvaMh9pTcLN6F", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64871/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.117.231/tcp/15314/p2p/16Uiu2HAmEmPA57PEsBf862wgjU2z1iqhAh6iSg2ZTvdtPzyb7GTo", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:9145/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:15313/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:64871/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1729912923158057472}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:9145/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"hHPIryHCwwwDrk+sHjOlnlmViYHnpaU8At9BZ3kYoWQ="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:64871/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"cee9e420e1d7be9cba49d46d4401eb5e8883416cd929af0c5b07c1a6c95bc176","status_code":200,"status_desc":"OK","messages":[{"message_hash":"hHPIryHCwwwDrk+sHjOlnlmViYHnpaU8At9BZ3kYoWQ="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 5597a76ebcbb
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 1eaaed3d9fa9
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 5597a76ebcbb. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 3896998a2fd5
[1m[31mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 1eaaed3d9fa9. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.