2025-02-12 03:06:50.467 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 03:06:50.468 DEBUG [tests.conftest] Running test: test_publish_with_no_timestamp with id: 2025-02-12_03-06-50__ef82b210-20d4-4fe7-ae47-4a109b27a425
2025-02-12 03:06:50.468 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 03:06:50.468 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-12 03:06:50.468 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-12 03:06:50.474 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 03:06:50.474 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-12_03-06-50__ef82b210-20d4-4fe7-ae47-4a109b27a425__wakuorg_nwaku:latest.log
2025-02-12 03:06:50.475 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 03:06:50.475 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 03:06:50.476 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 03:06:50.476 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.129.130
2025-02-12 03:06:50.476 DEBUG [src.node.docker_mananger] Generated ports ['54192', '54193', '54194', '54195', '54196']
2025-02-12 03:06:50.476 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 03:06:50.477 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 03:06:50.477 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 03:06:50.477 DEBUG [src.node.docker_mananger] docker run -i -t -p 54192:54192 -p 54193:54193 -p 54194:54194 -p 54195:54195 -p 54196:54196 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54194 --rest-port=54192 --tcp-port=54193 --discv5-udp-port=54195 --rest-address=0.0.0.0 --nat=extip:172.18.129.130 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=11f12fda2ec2e1402d7eea23c6369fea03abe7cd2d6bf0f89bd730c08ee6c1da --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54196 --metrics-logging=true --relay=true
2025-02-12 03:06:50.718 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.129.130 waku 3f7001f3283b8f11d764fc7f92d9df60f31959c95188cebc56fc88d68b7a61e2
2025-02-12 03:06:50.755 ERROR [src.node.docker_mananger] Max retries reached for container 5fd8ed6ab9d9. Exiting log stream.
2025-02-12 03:06:50.762 DEBUG [src.node.docker_mananger] Container started with ID 3f7001f3283b. Setting up logs at ./log/docker/node1_2025-02-12_03-06-50__ef82b210-20d4-4fe7-ae47-4a109b27a425__wakuorg_nwaku:latest.log
2025-02-12 03:06:50.763 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54192
2025-02-12 03:06:50.763 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 03:06:51.270 ERROR [src.node.docker_mananger] Max retries reached for container 527554c6eb5b. Exiting log stream.
2025-02-12 03:06:51.764 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54192/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:51.766 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 03:06:51.767 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 03:06:51.767 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54192/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:51.769 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.129.130/tcp/54193/p2p/16Uiu2HAm6myfidozXPp77GeiQTsHHdvXieAWGWeHphP2e4tRaznd","/ip4/172.18.129.130/tcp/54194/ws/p2p/16Uiu2HAm6myfidozXPp77GeiQTsHHdvXieAWGWeHphP2e4tRaznd"],"enrUri":"enr:-L24QGdvDZaEjZx3d4BOrRHDAyHob79lyIidADyfYGNfTNdgBrJKWDj9_K42LADWzA6g81H-sZokqmUVK42FtdqCP7cCgmlkgnY0gmlwhKwSgYKKbXVsdGlhZGRyc5YACASsEoGCBtOxAAoErBKBggbTst0DgnJzhQADAQAAiXNlY3AyNTZrMaECqKQsNAYz8h1tbYFB5Ih7T81WP89UoGG-o9ozf0PKKyKDdGNwgtOxg3VkcILTs4V3YWt1MgE"}'
2025-02-12 03:06:51.769 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 03:06:51.775 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-12 03:06:51.775 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-12_03-06-50__ef82b210-20d4-4fe7-ae47-4a109b27a425__wakuorg_go-waku:latest.log
2025-02-12 03:06:51.775 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 03:06:51.775 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 03:06:51.777 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 03:06:51.777 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.11.221
2025-02-12 03:06:51.777 DEBUG [src.node.docker_mananger] Generated ports ['54608', '54609', '54610', '54611', '54612']
2025-02-12 03:06:51.777 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 03:06:51.777 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 03:06:51.777 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 03:06:51.777 DEBUG [src.node.docker_mananger] docker run -i -t -p 54608:54608 -p 54609:54609 -p 54610:54610 -p 54611:54611 -p 54612:54612 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=54610 --rest-port=54608 --tcp-port=54609 --discv5-udp-port=54611 --rest-address=0.0.0.0 --nat=extip:172.18.11.221 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=779ebfbd2d1dccd88fd29ceb8e9a72559300eb8aebc84ce951f55f5d7bf3ea5c --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QGdvDZaEjZx3d4BOrRHDAyHob79lyIidADyfYGNfTNdgBrJKWDj9_K42LADWzA6g81H-sZokqmUVK42FtdqCP7cCgmlkgnY0gmlwhKwSgYKKbXVsdGlhZGRyc5YACASsEoGCBtOxAAoErBKBggbTst0DgnJzhQADAQAAiXNlY3AyNTZrMaECqKQsNAYz8h1tbYFB5Ih7T81WP89UoGG-o9ozf0PKKyKDdGNwgtOxg3VkcILTs4V3YWt1MgE
2025-02-12 03:06:52.000 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.11.221 waku 05bbd038d9d4d79289499628d0ad3c3ace7b239a32ba18a96bf22b16cde4c195
2025-02-12 03:06:52.063 DEBUG [src.node.docker_mananger] Container started with ID 05bbd038d9d4. Setting up logs at ./log/docker/node2_2025-02-12_03-06-50__ef82b210-20d4-4fe7-ae47-4a109b27a425__wakuorg_go-waku:latest.log
2025-02-12 03:06:52.064 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 54608
2025-02-12 03:06:52.065 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 03:06:53.065 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54608/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:53.068 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QA5u4Mm75m91pCmhFphWqID_YgFADXCW1w6iZ5kDil8KNJAH6mT2faWC9S4G2WE5FsZRKKiOr3tnmT62l4empouGAZT4H6kOgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEC3HhmyDwD4B_357T2k-znyOeejLrEK5-w-beRz3VQ_HuDdGNwgtVRg3VkcILVU4V3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/54609/p2p/16Uiu2HAmAGJA557ytyz8Ld6rKo1bewmc85krxCr7UW4tYz4Cu8gz","/ip4/127.0.0.1/tcp/54610/ws/p2p/16Uiu2HAmAGJA557ytyz8Ld6rKo1bewmc85krxCr7UW4tYz4Cu8gz","/ip4/172.17.0.3/tcp/54609/p2p/16Uiu2HAmAGJA557ytyz8Ld6rKo1bewmc85krxCr7UW4tYz4Cu8gz","/ip4/172.17.0.3/tcp/54610/ws/p2p/16Uiu2HAmAGJA557ytyz8Ld6rKo1bewmc85krxCr7UW4tYz4Cu8gz"]}'
2025-02-12 03:06:53.068 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 03:06:53.069 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54608/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.129.130/tcp/54193/p2p/16Uiu2HAm6myfidozXPp77GeiQTsHHdvXieAWGWeHphP2e4tRaznd", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-12 03:06:53.085 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-12 03:06:53.086 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-12 03:06:53.087 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54192/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 03:06:53.111 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:06:53.112 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54608/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-12 03:06:53.114 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-12 03:06:53.115 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:06:53.128 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:06:53.128 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 03:06:53.229 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 03:06:53.229 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:53.231 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739329613115705600,"ephemeral":false}]'
2025-02-12 03:06:53.233 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-12 03:06:53.233 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54608/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:53.235 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-12 03:06:54.236 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:06:54.240 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:06:54.241 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 03:06:54.341 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 03:06:54.341 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:54.343 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739329614235881984,"ephemeral":false}]'
2025-02-12 03:06:54.345 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-12 03:06:54.345 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54608/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:54.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739329614235881984,"ephemeral":false}]'
2025-02-12 03:06:54.348 INFO [src.steps.relay] WARM UP successful!!
2025-02-12 03:06:54.349 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto"}'
2025-02-12 03:06:54.353 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:06:54.354 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 03:06:54.454 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-12 03:06:54.454 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:54.456 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739329614351516160,"ephemeral":false}]'
2025-02-12 03:06:54.458 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-12 03:06:54.458 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54608/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:06:54.459 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739329614351516160,"ephemeral":false}]'
2025-02-12 03:06:54.462 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 03:06:54.463 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 03:06:54.463 DEBUG [src.node.waku_node] Stopping container with id 3f7001f3283b
2025-02-12 03:06:55.002 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 03:06:55.002 DEBUG [src.node.waku_node] Stopping container with id 05bbd038d9d4
2025-02-12 03:06:55.487 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 03:06:55.489 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 03:06:55.495 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 03:06:55.498 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
