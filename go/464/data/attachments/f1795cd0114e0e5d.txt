2025-02-12 03:10:10.568 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 03:10:10.569 DEBUG [tests.conftest] Running test: test_store_with_not_valid_content_topic with id: 2025-02-12_03-10-10__acbbd94f-1d82-4c75-8aec-45fc0f1d3aa4
2025-02-12 03:10:10.569 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 03:10:10.570 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-12 03:10:10.571 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-12 03:10:10.577 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 03:10:10.577 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-12_03-10-10__acbbd94f-1d82-4c75-8aec-45fc0f1d3aa4__wakuorg_nwaku:latest.log
2025-02-12 03:10:10.578 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 03:10:10.578 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 03:10:10.579 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 03:10:10.579 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.134.195
2025-02-12 03:10:10.579 DEBUG [src.node.docker_mananger] Generated ports ['25547', '25548', '25549', '25550', '25551']
2025-02-12 03:10:10.579 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 03:10:10.579 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 03:10:10.580 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 03:10:10.580 DEBUG [src.node.docker_mananger] docker run -i -t -p 25547:25547 -p 25548:25548 -p 25549:25549 -p 25550:25550 -p 25551:25551 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=25549 --rest-port=25547 --tcp-port=25548 --discv5-udp-port=25550 --rest-address=0.0.0.0 --nat=extip:172.18.134.195 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2d2010a0b13a5a7d524ddfdbb52590d8aa792e7aea2af12eb6585bcb250ef086 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=25551 --metrics-logging=true --store=true --relay=true
2025-02-12 03:10:10.684 ERROR [src.node.docker_mananger] Max retries reached for container 1e6b313d4efd. Exiting log stream.
2025-02-12 03:10:10.807 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.134.195 waku ec04f5d5d5a4bde6ee4b40a5238e0a3f73b20a07a3079c9158e982623e830c5c
2025-02-12 03:10:10.861 DEBUG [src.node.docker_mananger] Container started with ID ec04f5d5d5a4. Setting up logs at ./log/docker/publishing_node1_2025-02-12_03-10-10__acbbd94f-1d82-4c75-8aec-45fc0f1d3aa4__wakuorg_nwaku:latest.log
2025-02-12 03:10:10.863 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 25547
2025-02-12 03:10:10.865 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 03:10:11.381 ERROR [src.node.docker_mananger] Max retries reached for container 10da3218c0c0. Exiting log stream.
2025-02-12 03:10:11.865 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25547/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:10:11.868 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 03:10:11.868 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 03:10:11.868 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25547/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:10:11.870 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.134.195/tcp/25548/p2p/16Uiu2HAmPMnLJ5WLoVC98PqWCfxfEB3DAUMP57J9gCo6TgT3PgBU","/ip4/172.18.134.195/tcp/25549/ws/p2p/16Uiu2HAmPMnLJ5WLoVC98PqWCfxfEB3DAUMP57J9gCo6TgT3PgBU"],"enrUri":"enr:-L24QGLQtzmomDGHB-rZa8sb3OD9vd0jLfomV3kx6cDN0cGqWY6ooxoJh3y3p3bygn9Wl9UA8aHQPDT1aL3rhuPjND8CgmlkgnY0gmlwhKwShsOKbXVsdGlhZGRyc5YACASsEobDBmPMAAoErBKGwwZjzd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDnwgYN9zkqH3CFoF47Ln75xGA-UscikSRSzO0J4ZNSGuDdGNwgmPMg3VkcIJjzoV3YWt1MgM"}'
2025-02-12 03:10:11.870 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 03:10:11.877 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-12 03:10:11.877 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-12_03-10-10__acbbd94f-1d82-4c75-8aec-45fc0f1d3aa4__wakuorg_go-waku:latest.log
2025-02-12 03:10:11.877 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 03:10:11.877 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 03:10:11.878 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 03:10:11.879 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.0.107
2025-02-12 03:10:11.879 DEBUG [src.node.docker_mananger] Generated ports ['23338', '23339', '23340', '23341', '23342']
2025-02-12 03:10:11.879 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 03:10:11.879 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 03:10:11.879 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 03:10:11.879 DEBUG [src.node.docker_mananger] docker run -i -t -p 23338:23338 -p 23339:23339 -p 23340:23340 -p 23341:23341 -p 23342:23342 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=23340 --rest-port=23338 --tcp-port=23339 --discv5-udp-port=23341 --rest-address=0.0.0.0 --nat=extip:172.18.0.107 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=01040d65facecff73854bbe4d2ce00dddeec6abc6adffa5dee8d623cceac3edf --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QGLQtzmomDGHB-rZa8sb3OD9vd0jLfomV3kx6cDN0cGqWY6ooxoJh3y3p3bygn9Wl9UA8aHQPDT1aL3rhuPjND8CgmlkgnY0gmlwhKwShsOKbXVsdGlhZGRyc5YACASsEobDBmPMAAoErBKGwwZjzd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDnwgYN9zkqH3CFoF47Ln75xGA-UscikSRSzO0J4ZNSGuDdGNwgmPMg3VkcIJjzoV3YWt1MgM --storenode=/ip4/172.18.134.195/tcp/25548/p2p/16Uiu2HAmPMnLJ5WLoVC98PqWCfxfEB3DAUMP57J9gCo6TgT3PgBU --store=true --relay=true
2025-02-12 03:10:12.114 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.0.107 waku 6da1c5bb60a0529eb2b0ce8e30fabf70c630247d2931965598351c603bc7d3fd
2025-02-12 03:10:12.168 DEBUG [src.node.docker_mananger] Container started with ID 6da1c5bb60a0. Setting up logs at ./log/docker/store_node1_2025-02-12_03-10-10__acbbd94f-1d82-4c75-8aec-45fc0f1d3aa4__wakuorg_go-waku:latest.log
2025-02-12 03:10:12.169 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 23338
2025-02-12 03:10:12.170 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 03:10:13.170 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23338/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:10:13.173 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QCF5dTJl91jR-8pvAuwZKyLGxa48PhoE79WG9cpXUoDGYxrFWbpp_SH3Qa2SJuKTNqCvOsW2J5oEGisruXQzLcyGAZT4IrbIgmlkgnY0gmlwhKwRAAaCcnODAAMAiXNlY3AyNTZrMaECQZvQGS74BKQDRbf95RO2UKBm5Ft-Gmm_mJo7Z69neuaDdGNwglsrg3VkcIJbLYV3YWt1MgM","listenAddresses":["/ip4/127.0.0.1/tcp/23339/p2p/16Uiu2HAkyqnHK72B6c9wDzQAPNWGSaqgofrYRHFgPyQRJKBH6Nkm","/ip4/127.0.0.1/tcp/23340/ws/p2p/16Uiu2HAkyqnHK72B6c9wDzQAPNWGSaqgofrYRHFgPyQRJKBH6Nkm","/ip4/172.17.0.6/tcp/23339/p2p/16Uiu2HAkyqnHK72B6c9wDzQAPNWGSaqgofrYRHFgPyQRJKBH6Nkm","/ip4/172.17.0.6/tcp/23340/ws/p2p/16Uiu2HAkyqnHK72B6c9wDzQAPNWGSaqgofrYRHFgPyQRJKBH6Nkm"]}'
2025-02-12 03:10:13.174 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 03:10:13.174 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23338/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.134.195/tcp/25548/p2p/16Uiu2HAmPMnLJ5WLoVC98PqWCfxfEB3DAUMP57J9gCo6TgT3PgBU", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-12 03:10:13.190 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-12 03:10:13.191 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 03:10:13.213 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:13.214 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23338/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 03:10:13.216 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-12 03:10:13.219 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:13.220 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:13.230 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:13.230 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:13.431 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:13.432 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/waku/2/content/test.js", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:13.437 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:13.437 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:13.638 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:13.638 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/22/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:13.643 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:13.643 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:13.844 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:13.844 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/toychat/2/huilong/proto", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:13.849 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:13.849 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:14.050 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:14.050 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/statusim/1/community/cbor", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:14.056 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:14.056 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:14.257 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:14.257 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/27/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:14.262 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:14.262 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:14.463 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:14.463 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/29/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:14.468 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:14.468 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:14.669 DEBUG [src.steps.store] Relaying message
2025-02-12 03:10:14.669 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:25547/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/app/20/sometopic/someencoding", "timestamp": '$(date +%s%N)'}'
2025-02-12 03:10:14.674 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:10:14.675 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-12 03:10:14.876 DEBUG [tests.store.test_topics] trying to find stored messages with wrong content_topic =##
2025-02-12 03:10:14.876 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:25547/store/v3/messages?includeData=true&contentTopics=%23%23&pageSize=20&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:10:14.879 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[]}'
2025-02-12 03:10:14.879 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23338/store/v3/messages?includeData=true&contentTopics=%23%23&pageSize=20&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:10:14.881 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:23338/store/v3/messages?includeData=true&contentTopics=%23%23&pageSize=20&ascending=true. Response content: b'{"status_code":400,"status_desc":"pubsubTopic and contentTopics are required"}'
2025-02-12 03:10:14.909 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 03:10:14.910 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 03:10:14.910 DEBUG [src.node.waku_node] Stopping container with id ec04f5d5d5a4
2025-02-12 03:10:16.433 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 03:10:16.434 DEBUG [src.node.waku_node] Stopping container with id 6da1c5bb60a0
2025-02-12 03:10:16.958 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 03:10:16.959 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 03:10:16.967 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 03:10:16.971 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
