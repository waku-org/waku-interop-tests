2025-02-12 03:09:46.797 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-12 03:09:46.798 DEBUG [tests.conftest] Running test: test_light_push_with_valid_meta with id: 2025-02-12_03-09-46__577e1aeb-80cd-4c8b-b286-cdecf8496bfe
2025-02-12 03:09:46.798 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-12 03:09:46.798 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-12 03:09:46.804 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 03:09:46.804 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-12_03-09-46__577e1aeb-80cd-4c8b-b286-cdecf8496bfe__wakuorg_nwaku:latest.log
2025-02-12 03:09:46.804 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 03:09:46.805 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 03:09:46.806 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 03:09:46.806 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.201.124
2025-02-12 03:09:46.806 DEBUG [src.node.docker_mananger] Generated ports ['23192', '23193', '23194', '23195', '23196']
2025-02-12 03:09:46.807 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 03:09:46.807 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 03:09:46.807 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 03:09:46.807 DEBUG [src.node.docker_mananger] docker run -i -t -p 23192:23192 -p 23193:23193 -p 23194:23194 -p 23195:23195 -p 23196:23196 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=23194 --rest-port=23192 --tcp-port=23193 --discv5-udp-port=23195 --rest-address=0.0.0.0 --nat=extip:172.18.201.124 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=2199d7e27b29ebae1bece7354800fcf14ce138aeab1fcb1bbf9d4a1cd3dcd9e3 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=23196 --metrics-logging=true --lightpush=true --relay=true
2025-02-12 03:09:47.026 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.201.124 waku b0a9a38ac6865e74bdb54c20d6da6f6a2e87aeef966e4114a81e7862cb59ec13
2025-02-12 03:09:47.071 DEBUG [src.node.docker_mananger] Container started with ID b0a9a38ac686. Setting up logs at ./log/docker/receiving_node1_2025-02-12_03-09-46__577e1aeb-80cd-4c8b-b286-cdecf8496bfe__wakuorg_nwaku:latest.log
2025-02-12 03:09:47.071 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 23192
2025-02-12 03:09:47.073 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 03:09:47.087 ERROR [src.node.docker_mananger] Max retries reached for container 72e6e17b4900. Exiting log stream.
2025-02-12 03:09:47.596 ERROR [src.node.docker_mananger] Max retries reached for container 725bd5769e97. Exiting log stream.
2025-02-12 03:09:48.073 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23192/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:09:48.076 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 03:09:48.076 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 03:09:48.077 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23192/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:09:48.079 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.201.124/tcp/23193/p2p/16Uiu2HAmMRBf3ydi37568ecNuyg5Tyzcgv2LaGyyf3ozeZSBcqcf","/ip4/172.18.201.124/tcp/23194/ws/p2p/16Uiu2HAmMRBf3ydi37568ecNuyg5Tyzcgv2LaGyyf3ozeZSBcqcf"],"enrUri":"enr:-L24QMd1H2TTGj6WjRDF8u0s_E915CAHVln0emQJ_JcTFRjAS_kWBbJwetKSf3mr6BNksofyHRHDyHV-OwPR-vk_3UoCgmlkgnY0gmlwhKwSyXyKbXVsdGlhZGRyc5YACASsEsl8BlqZAAoErBLJfAZamt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDgi_VxBHXp96uskEjSY9skYSJLIvsYll8KM7sYyBl2wyDdGNwglqZg3VkcIJam4V3YWt1Mgk"}'
2025-02-12 03:09:48.079 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 03:09:48.086 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-12 03:09:48.086 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-12_03-09-46__577e1aeb-80cd-4c8b-b286-cdecf8496bfe__wakuorg_nwaku:latest.log
2025-02-12 03:09:48.086 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 03:09:48.086 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 03:09:48.087 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 03:09:48.087 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.126.7
2025-02-12 03:09:48.088 DEBUG [src.node.docker_mananger] Generated ports ['55878', '55879', '55880', '55881', '55882']
2025-02-12 03:09:48.088 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 03:09:48.088 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 03:09:48.088 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 03:09:48.088 DEBUG [src.node.docker_mananger] docker run -i -t -p 55878:55878 -p 55879:55879 -p 55880:55880 -p 55881:55881 -p 55882:55882 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=55880 --rest-port=55878 --tcp-port=55879 --discv5-udp-port=55881 --rest-address=0.0.0.0 --nat=extip:172.18.126.7 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e3126fa1b53c573db5dcadc94adff33afaab8fafdbc7d8d7d217bec128acd914 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=55882 --metrics-logging=true --lightpush=false --relay=true
2025-02-12 03:09:48.321 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.126.7 waku cb98fd6864ff156406e8309b42f1c8989490789f6ea9e4e0263234eeb7a86bb9
2025-02-12 03:09:48.371 DEBUG [src.node.docker_mananger] Container started with ID cb98fd6864ff. Setting up logs at ./log/docker/receiving_node2_2025-02-12_03-09-46__577e1aeb-80cd-4c8b-b286-cdecf8496bfe__wakuorg_nwaku:latest.log
2025-02-12 03:09:48.371 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 55878
2025-02-12 03:09:48.372 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 03:09:49.372 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55878/health" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:09:49.375 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-12 03:09:49.375 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-12 03:09:49.375 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55878/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:09:49.378 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.126.7/tcp/55879/p2p/16Uiu2HAm8ceAaGWB7dSCFrFvakW8ewEhPtnNVSm27rJaKwt9m6tA","/ip4/172.18.126.7/tcp/55880/ws/p2p/16Uiu2HAm8ceAaGWB7dSCFrFvakW8ewEhPtnNVSm27rJaKwt9m6tA"],"enrUri":"enr:-L24QGy8l4l8d3kxqihssHqOQV8gyq-EryfMv6EA9VSHn7RgNuIHMP5TdhV46h265eWvWbbGrSj7ODySCK9bFyOE09ECgmlkgnY0gmlwhKwSfgeKbXVsdGlhZGRyc5YACASsEn4HBtpHAAoErBJ-BwbaSN0DgnJzhQADAQAAiXNlY3AyNTZrMaECw_dEiHRtZ6QWu8HpZj7RS57Vvpc8nzHLluK4a4tscQuDdGNwgtpHg3VkcILaSYV3YWt1MgE"}'
2025-02-12 03:09:49.378 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 03:09:49.378 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55878/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.201.124/tcp/23193/p2p/16Uiu2HAmMRBf3ydi37568ecNuyg5Tyzcgv2LaGyyf3ozeZSBcqcf"]'
2025-02-12 03:09:49.417 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:09:49.427 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-12 03:09:49.428 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-12_03-09-46__577e1aeb-80cd-4c8b-b286-cdecf8496bfe__wakuorg_go-waku:latest.log
2025-02-12 03:09:49.428 DEBUG [src.node.waku_node] Starting Node...
2025-02-12 03:09:49.428 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-12 03:09:49.430 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-12 03:09:49.430 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.89.234
2025-02-12 03:09:49.430 DEBUG [src.node.docker_mananger] Generated ports ['42242', '42243', '42244', '42245', '42246']
2025-02-12 03:09:49.430 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-12 03:09:49.430 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-12 03:09:49.430 DEBUG [src.node.waku_node] Using volumes []
2025-02-12 03:09:49.431 DEBUG [src.node.docker_mananger] docker run -i -t -p 42242:42242 -p 42243:42243 -p 42244:42244 -p 42245:42245 -p 42246:42246 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=42244 --rest-port=42242 --tcp-port=42243 --discv5-udp-port=42245 --rest-address=0.0.0.0 --nat=extip:172.18.89.234 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=12ca195fcc61e3e6ca6ebfd99ffb24a5cdd6a5ad7fad24a9501fcaebcbbdfa7b --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QMd1H2TTGj6WjRDF8u0s_E915CAHVln0emQJ_JcTFRjAS_kWBbJwetKSf3mr6BNksofyHRHDyHV-OwPR-vk_3UoCgmlkgnY0gmlwhKwSyXyKbXVsdGlhZGRyc5YACASsEsl8BlqZAAoErBLJfAZamt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDgi_VxBHXp96uskEjSY9skYSJLIvsYll8KM7sYyBl2wyDdGNwglqZg3VkcIJam4V3YWt1Mgk --lightpushnode=/ip4/172.18.201.124/tcp/23193/p2p/16Uiu2HAmMRBf3ydi37568ecNuyg5Tyzcgv2LaGyyf3ozeZSBcqcf --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-12 03:09:49.667 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.89.234 waku 4716b1419fbe4112485a216c88625c3636609ff6312e4b0cd0bdfde4a3e7eded
2025-02-12 03:09:49.728 DEBUG [src.node.docker_mananger] Container started with ID 4716b1419fbe. Setting up logs at ./log/docker/lightpush_node1_2025-02-12_03-09-46__577e1aeb-80cd-4c8b-b286-cdecf8496bfe__wakuorg_go-waku:latest.log
2025-02-12 03:09:49.729 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 42242
2025-02-12 03:09:49.729 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-12 03:09:50.730 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:42242/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:09:50.733 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QDPj8eCLfTMm88C8C3Yvkn9jkJeT3SojPfbdLOeeBMAAEoUmouY3xL6FjL4rfCt8Gv5r_vpQNjQiB3a-GeIc5QuGAZT4Il8UgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQL3Zv7U4m0yN6fNMh6qXztXUqFv6tPlK5GQhoT8fnLvToN0Y3CCpQODdWRwgqUFhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/42243/p2p/16Uiu2HAmC5Rmg1bwpTD4HJWgZa5Tidvsmaoe1GSggNns3XbnoTq7","/ip4/127.0.0.1/tcp/42244/ws/p2p/16Uiu2HAmC5Rmg1bwpTD4HJWgZa5Tidvsmaoe1GSggNns3XbnoTq7","/ip4/172.17.0.4/tcp/42243/p2p/16Uiu2HAmC5Rmg1bwpTD4HJWgZa5Tidvsmaoe1GSggNns3XbnoTq7","/ip4/172.17.0.4/tcp/42244/ws/p2p/16Uiu2HAmC5Rmg1bwpTD4HJWgZa5Tidvsmaoe1GSggNns3XbnoTq7"]}'
2025-02-12 03:09:50.733 INFO [src.node.waku_node] REST service is ready !!
2025-02-12 03:09:50.734 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42242/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.201.124/tcp/23193/p2p/16Uiu2HAmMRBf3ydi37568ecNuyg5Tyzcgv2LaGyyf3ozeZSBcqcf", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-12 03:09:50.735 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-12 03:09:50.736 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42242/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.126.7/tcp/55879/p2p/16Uiu2HAm8ceAaGWB7dSCFrFvakW8ewEhPtnNVSm27rJaKwt9m6tA", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-12 03:09:50.751 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-12 03:09:50.752 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:23192/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 03:09:50.758 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:09:50.759 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55878/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-12 03:09:50.763 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-12 03:09:50.765 DEBUG [src.steps.light_push] Lightpushing message
2025-02-12 03:09:50.765 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:42242/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739329790764966912, "meta": "TGlnaHQgcHVzaCB3b3JrcyEh"}}'
2025-02-12 03:09:50.772 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-12 03:09:50.773 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-12 03:09:50.873 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-12 03:09:50.873 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:23192/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:09:50.876 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739329790764966912,"meta":"TGlnaHQgcHVzaCB3b3JrcyEh","ephemeral":false}]'
2025-02-12 03:09:50.878 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-12 03:09:50.878 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55878/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-12 03:09:50.880 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739329790764966912,"meta":"TGlnaHQgcHVzaCB3b3JrcyEh","ephemeral":false}]'
2025-02-12 03:09:50.883 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-12 03:09:50.884 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-12 03:09:50.884 DEBUG [src.node.waku_node] Stopping container with id b0a9a38ac686
2025-02-12 03:09:51.457 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 03:09:51.458 DEBUG [src.node.waku_node] Stopping container with id cb98fd6864ff
2025-02-12 03:09:52.270 ERROR [src.node.docker_mananger] Max retries reached for container b0a9a38ac686. Exiting log stream.
2025-02-12 03:09:52.971 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 03:09:52.971 DEBUG [src.node.waku_node] Stopping container with id 4716b1419fbe
2025-02-12 03:09:53.462 DEBUG [src.node.waku_node] Container stopped.
2025-02-12 03:09:53.465 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-12 03:09:53.471 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 03:09:53.478 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-12 03:09:53.482 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
