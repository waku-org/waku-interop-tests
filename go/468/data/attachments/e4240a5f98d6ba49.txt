2025-02-16 03:13:08.286 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 03:13:08.286 DEBUG [tests.conftest] Running test: test_store_with_peerAddr with id: 2025-02-16_03-13-08__ae4620a3-a076-4272-8caf-b9b7709ef052
2025-02-16 03:13:08.286 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 03:13:08.287 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-16 03:13:08.287 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-16 03:13:08.295 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 03:13:08.295 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-16_03-13-08__ae4620a3-a076-4272-8caf-b9b7709ef052__wakuorg_nwaku:latest.log
2025-02-16 03:13:08.296 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 03:13:08.296 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 03:13:08.297 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 03:13:08.298 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.209.123
2025-02-16 03:13:08.298 DEBUG [src.node.docker_mananger] Generated ports ['30824', '30825', '30826', '30827', '30828']
2025-02-16 03:13:08.298 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 03:13:08.298 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 03:13:08.298 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 03:13:08.298 DEBUG [src.node.docker_mananger] docker run -i -t -p 30824:30824 -p 30825:30825 -p 30826:30826 -p 30827:30827 -p 30828:30828 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=30826 --rest-port=30824 --tcp-port=30825 --discv5-udp-port=30827 --rest-address=0.0.0.0 --nat=extip:172.18.209.123 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ceaccc27bab8cdaa2219cd2d31c6fbbdcb0aa11f757a2929bf2bffea538c1fcf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=30828 --metrics-logging=true --store=true --relay=true
2025-02-16 03:13:08.419 ERROR [src.node.docker_mananger] Max retries reached for container d91cca4d679e. Exiting log stream.
2025-02-16 03:13:08.580 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.209.123 waku 43f1c0d47c68efab447d22d543f1c0a8df88f95bfa567a43fea45e4483c59296
2025-02-16 03:13:08.638 DEBUG [src.node.docker_mananger] Container started with ID 43f1c0d47c68. Setting up logs at ./log/docker/publishing_node1_2025-02-16_03-13-08__ae4620a3-a076-4272-8caf-b9b7709ef052__wakuorg_nwaku:latest.log
2025-02-16 03:13:08.641 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 30824
2025-02-16 03:13:08.641 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 03:13:09.087 ERROR [src.node.docker_mananger] Max retries reached for container 54ee0a081490. Exiting log stream.
2025-02-16 03:13:09.641 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30824/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:09.646 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 03:13:09.646 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 03:13:09.646 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:30824/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:09.649 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.209.123/tcp/30825/p2p/16Uiu2HAmSqa4TW1X4Zacp2cV6mfixtMjWCs6peJ86rnDYiTvN58h","/ip4/172.18.209.123/tcp/30826/ws/p2p/16Uiu2HAmSqa4TW1X4Zacp2cV6mfixtMjWCs6peJ86rnDYiTvN58h"],"enrUri":"enr:-L24QOurkJSV6K9x1S2V3cX6DyCUC2qx9v04o4TWpz5t3fmtDxFV7SJdg1eGzkg4UXNOsKR1InCirz_iwcs1DKY4fewCgmlkgnY0gmlwhKwS0XuKbXVsdGlhZGRyc5YACASsEtF7BnhpAAoErBLRewZ4at0DgnJzhQADAQAAiXNlY3AyNTZrMaED0rmKdJCDhS9VkdOOt8UcsVjO7sxPezkSZUhCF8EoweaDdGNwgnhpg3VkcIJ4a4V3YWt1MgM"}'
2025-02-16 03:13:09.649 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 03:13:09.658 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-16 03:13:09.658 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-16_03-13-08__ae4620a3-a076-4272-8caf-b9b7709ef052__wakuorg_go-waku:latest.log
2025-02-16 03:13:09.658 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 03:13:09.659 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 03:13:09.660 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 03:13:09.661 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.89.27
2025-02-16 03:13:09.661 DEBUG [src.node.docker_mananger] Generated ports ['60532', '60533', '60534', '60535', '60536']
2025-02-16 03:13:09.661 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 03:13:09.661 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 03:13:09.661 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 03:13:09.661 DEBUG [src.node.docker_mananger] docker run -i -t -p 60532:60532 -p 60533:60533 -p 60534:60534 -p 60535:60535 -p 60536:60536 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=60534 --rest-port=60532 --tcp-port=60533 --discv5-udp-port=60535 --rest-address=0.0.0.0 --nat=extip:172.18.89.27 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aff8e74cddf377b03ead0f08f9bb0aa5db500b97ededda7cfdaa5be81fcefe9f --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QOurkJSV6K9x1S2V3cX6DyCUC2qx9v04o4TWpz5t3fmtDxFV7SJdg1eGzkg4UXNOsKR1InCirz_iwcs1DKY4fewCgmlkgnY0gmlwhKwS0XuKbXVsdGlhZGRyc5YACASsEtF7BnhpAAoErBLRewZ4at0DgnJzhQADAQAAiXNlY3AyNTZrMaED0rmKdJCDhS9VkdOOt8UcsVjO7sxPezkSZUhCF8EoweaDdGNwgnhpg3VkcIJ4a4V3YWt1MgM --storenode=/ip4/172.18.209.123/tcp/30825/p2p/16Uiu2HAmSqa4TW1X4Zacp2cV6mfixtMjWCs6peJ86rnDYiTvN58h --store=true --relay=true
2025-02-16 03:13:09.951 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.89.27 waku 579953a6b6c6fe97c753743079b0c1eaeaf26d61207f45ae764248101dd5663a
2025-02-16 03:13:10.009 DEBUG [src.node.docker_mananger] Container started with ID 579953a6b6c6. Setting up logs at ./log/docker/store_node1_2025-02-16_03-13-08__ae4620a3-a076-4272-8caf-b9b7709ef052__wakuorg_go-waku:latest.log
2025-02-16 03:13:10.010 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 60532
2025-02-16 03:13:10.010 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 03:13:11.011 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60532/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:11.015 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QH5SfI5awDyru3Wgxjdgjg808Iz8bSv6mivtGzqkW-lKXk3EE26Bkbr_1NdjwHAfr_I4QnRjzLY4QF2WCnYygAyGAZUMvt16gmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDhAEV12yBiK7ThgXHovB8IXrzJqCXimVL0jTxlJWp8YGDdGNwgux1g3VkcILsd4V3YWt1MgM","listenAddresses":["/ip4/127.0.0.1/tcp/60533/p2p/16Uiu2HAmMYH8J7axJBus3nhX5ypnM4Bj89x18vtMXTDscthV594L","/ip4/127.0.0.1/tcp/60534/ws/p2p/16Uiu2HAmMYH8J7axJBus3nhX5ypnM4Bj89x18vtMXTDscthV594L","/ip4/172.17.0.3/tcp/60533/p2p/16Uiu2HAmMYH8J7axJBus3nhX5ypnM4Bj89x18vtMXTDscthV594L","/ip4/172.17.0.3/tcp/60534/ws/p2p/16Uiu2HAmMYH8J7axJBus3nhX5ypnM4Bj89x18vtMXTDscthV594L"]}'
2025-02-16 03:13:11.016 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 03:13:11.016 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60532/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.209.123/tcp/30825/p2p/16Uiu2HAmSqa4TW1X4Zacp2cV6mfixtMjWCs6peJ86rnDYiTvN58h", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-16 03:13:11.036 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-16 03:13:11.037 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30824/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 03:13:11.061 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 03:13:11.061 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60532/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 03:13:11.068 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-16 03:13:11.070 DEBUG [src.steps.store] Relaying message
2025-02-16 03:13:11.072 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:30824/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 03:13:11.087 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 03:13:11.087 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-16 03:13:11.289 DEBUG [src.steps.store] Checking that peer wakuorg/go-waku:latest can find the stored messages
2025-02-16 03:13:11.289 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60532/store/v3/messages?peerAddr=%2Fip4%2F172.18.209.123%2Ftcp%2F30825%2Fp2p%2F16Uiu2HAmSqa4TW1X4Zacp2cV6mfixtMjWCs6peJ86rnDYiTvN58h&pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:11.297 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"request_id":"a3745c4925913c601ffe57d9e6c69ff32a62525a8f187db0bbcc29563da0a7d1","status_code":200,"status_desc":"OK","messages":[{"message_hash":"2WwzYVhyuRX9x6WEeiS9G4X5hDHffsB194D/QKH0mPs="}]}'
2025-02-16 03:13:11.300 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 03:13:11.301 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 03:13:11.301 DEBUG [src.node.waku_node] Stopping container with id 43f1c0d47c68
2025-02-16 03:13:11.969 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 03:13:11.969 DEBUG [src.node.waku_node] Stopping container with id 579953a6b6c6
2025-02-16 03:13:12.694 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 03:13:12.697 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 03:13:12.714 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 03:13:12.719 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
