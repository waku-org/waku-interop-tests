2025-02-16 03:11:15.311 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 03:11:15.312 DEBUG [tests.conftest] Running test: test_message_relayed_while_store_node_is_paused with id: 2025-02-16_03-11-15__40045b42-3bd8-4e0a-846e-728d83dbf255
2025-02-16 03:11:15.312 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 03:11:15.312 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-16 03:11:15.313 DEBUG [src.steps.store] Running fixture setup: node_setup
2025-02-16 03:11:15.319 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 03:11:15.319 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/publishing_node1_2025-02-16_03-11-15__40045b42-3bd8-4e0a-846e-728d83dbf255__wakuorg_nwaku:latest.log
2025-02-16 03:11:15.319 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 03:11:15.319 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 03:11:15.321 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 03:11:15.321 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.177.217
2025-02-16 03:11:15.321 DEBUG [src.node.docker_mananger] Generated ports ['10091', '10092', '10093', '10094', '10095']
2025-02-16 03:11:15.321 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 03:11:15.321 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 03:11:15.321 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 03:11:15.322 DEBUG [src.node.docker_mananger] docker run -i -t -p 10091:10091 -p 10092:10092 -p 10093:10093 -p 10094:10094 -p 10095:10095 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10093 --rest-port=10091 --tcp-port=10092 --discv5-udp-port=10094 --rest-address=0.0.0.0 --nat=extip:172.18.177.217 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a3935dffec5b5bc8ab9f944f5dbaddcbc096819ff5dcced5cf16417c7bef83c1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10095 --metrics-logging=true --store=true --relay=true
2025-02-16 03:11:15.531 ERROR [src.node.docker_mananger] Max retries reached for container 9ee2246c1476. Exiting log stream.
2025-02-16 03:11:15.549 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.177.217 waku 83c55c42b2fa51200f7627fffa21ca54c5c9f4980343590fb7ae728486b53a1f
2025-02-16 03:11:15.601 DEBUG [src.node.docker_mananger] Container started with ID 83c55c42b2fa. Setting up logs at ./log/docker/publishing_node1_2025-02-16_03-11-15__40045b42-3bd8-4e0a-846e-728d83dbf255__wakuorg_nwaku:latest.log
2025-02-16 03:11:15.603 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10091
2025-02-16 03:11:15.603 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 03:11:16.095 ERROR [src.node.docker_mananger] Max retries reached for container c0e89cc0a6b7. Exiting log stream.
2025-02-16 03:11:16.605 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10091/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:16.608 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 03:11:16.608 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 03:11:16.609 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10091/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:16.611 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.177.217/tcp/10092/p2p/16Uiu2HAmPdgiv6uo9jaT2aJr5HyYpsjqpjUSw8HbydabhGYpcpmh","/ip4/172.18.177.217/tcp/10093/ws/p2p/16Uiu2HAmPdgiv6uo9jaT2aJr5HyYpsjqpjUSw8HbydabhGYpcpmh"],"enrUri":"enr:-L24QIQbCfjMjUoAsVTd3Yp05tqZaI4G1MQr2UKKULdPMHy_JLnR1KBg5wtUGzgL9d_XwJvPf6PrSrihi-dC3ESm5gkCgmlkgnY0gmlwhKwSsdmKbXVsdGlhZGRyc5YACASsErHZBidsAAoErBKx2QYnbd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDoxsLWK8dWMTYEtTgrSvWNlQzVRCxbwx0grg3N1CxmUSDdGNwgidsg3VkcIInboV3YWt1MgM"}'
2025-02-16 03:11:16.611 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 03:11:16.618 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-16 03:11:16.618 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/store_node1_2025-02-16_03-11-15__40045b42-3bd8-4e0a-846e-728d83dbf255__wakuorg_go-waku:latest.log
2025-02-16 03:11:16.618 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 03:11:16.618 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 03:11:16.619 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 03:11:16.619 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.245.78
2025-02-16 03:11:16.620 DEBUG [src.node.docker_mananger] Generated ports ['57706', '57707', '57708', '57709', '57710']
2025-02-16 03:11:16.620 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 03:11:16.620 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 03:11:16.620 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 03:11:16.620 DEBUG [src.node.docker_mananger] docker run -i -t -p 57706:57706 -p 57707:57707 -p 57708:57708 -p 57709:57709 -p 57710:57710 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=57708 --rest-port=57706 --tcp-port=57707 --discv5-udp-port=57709 --rest-address=0.0.0.0 --nat=extip:172.18.245.78 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5d4be3cf8fb92af6ebf5f97babb7b6c9eb1115de4fccbe98fc8a19de491b5f7b --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QIQbCfjMjUoAsVTd3Yp05tqZaI4G1MQr2UKKULdPMHy_JLnR1KBg5wtUGzgL9d_XwJvPf6PrSrihi-dC3ESm5gkCgmlkgnY0gmlwhKwSsdmKbXVsdGlhZGRyc5YACASsErHZBidsAAoErBKx2QYnbd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDoxsLWK8dWMTYEtTgrSvWNlQzVRCxbwx0grg3N1CxmUSDdGNwgidsg3VkcIInboV3YWt1MgM --storenode=/ip4/172.18.177.217/tcp/10092/p2p/16Uiu2HAmPdgiv6uo9jaT2aJr5HyYpsjqpjUSw8HbydabhGYpcpmh --store=true --relay=true
2025-02-16 03:11:16.854 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.245.78 waku a1dea718cadea8907583811d0c0b174ca67cca78a410643a573b02922612fb28
2025-02-16 03:11:16.905 DEBUG [src.node.docker_mananger] Container started with ID a1dea718cade. Setting up logs at ./log/docker/store_node1_2025-02-16_03-11-15__40045b42-3bd8-4e0a-846e-728d83dbf255__wakuorg_go-waku:latest.log
2025-02-16 03:11:16.907 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 57706
2025-02-16 03:11:16.907 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 03:11:17.907 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57706/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:17.910 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QFV0MKceIAjyGR02JmXtFzW3hZnJIWPphC8rg9RFrkwHVdlpDyoDNx7p7BFbpEweWI1iH5Xi-kki30vVOl83NO2GAZUMvSOtgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDLivWvWMyJFXyroI0QhxlNpR0yQN9GYup-kRA00rwli6DdGNwguFrg3VkcILhbYV3YWt1MgM","listenAddresses":["/ip4/127.0.0.1/tcp/57707/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF","/ip4/127.0.0.1/tcp/57708/ws/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF","/ip4/172.17.0.3/tcp/57707/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF","/ip4/172.17.0.3/tcp/57708/ws/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF"]}'
2025-02-16 03:11:17.910 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 03:11:17.911 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57706/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.177.217/tcp/10092/p2p/16Uiu2HAmPdgiv6uo9jaT2aJr5HyYpsjqpjUSw8HbydabhGYpcpmh", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-16 03:11:17.926 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-16 03:11:17.928 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10091/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 03:11:17.952 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 03:11:17.952 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:57706/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-16 03:11:17.955 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-16 03:11:17.958 DEBUG [src.steps.store] Relaying message
2025-02-16 03:11:17.959 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10091/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 03:11:17.971 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 03:11:17.971 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-16 03:11:18.171 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-16 03:11:18.172 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10091/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:18.175 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x7845899f1a3b90c7734a3cbff161596aa50835f6530edbfc212019a7fa572838"}]}'
2025-02-16 03:11:18.175 DEBUG [src.steps.store] Checking that peer wakuorg/go-waku:latest can find the stored messages
2025-02-16 03:11:18.176 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57706/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:18.181 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"request_id":"7b434c7bb9b13111226593b7f4fd2fd4e78bb2a6fd89bb3e1342bfea31f078fc","status_code":200,"status_desc":"OK","messages":[{"message_hash":"eEWJnxo7kMdzSjy/8WFZaqUINfZTDtv8ISAZp/pXKDg="}]}'
2025-02-16 03:11:18.182 DEBUG [src.node.waku_node] Pausing container with id a1dea718cade
2025-02-16 03:11:18.191 DEBUG [src.steps.store] Relaying message
2025-02-16 03:11:18.191 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10091/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 03:11:18.196 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 03:11:18.196 DEBUG [src.libs.common] Sleeping for 0.2 seconds
2025-02-16 03:11:18.397 DEBUG [src.node.waku_node] Unpause container with id a1dea718cade
2025-02-16 03:11:18.406 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57706/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:18.408 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QD_EGk2RyssOhm1SZ-odSha3nRUY5VsXUo1ZXNDnwQMXUfMxeJIFKGrljy5fALXXt2vJT0RIDY-OlnVmLFUQ6xyGAZUMvSOugmlkgnY0gmlwhKwRAAOCcnOFAAMBAACJc2VjcDI1NmsxoQMuK9a9YzIkVfKugjRCHGU2lHTJA30Zi6n6REDTSvCWLoN0Y3CC4WuDdWRwguFthXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/57707/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF","/ip4/127.0.0.1/tcp/57708/ws/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF","/ip4/172.17.0.3/tcp/57707/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF","/ip4/172.17.0.3/tcp/57708/ws/p2p/16Uiu2HAmFmDsm8yc1BJA8M3AW8JWif9VT6VJ3TQPVfbxSA3Ec9DF"]}'
2025-02-16 03:11:18.408 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 03:11:18.409 DEBUG [src.steps.store] Checking that peer wakuorg/nwaku:latest can find the stored messages
2025-02-16 03:11:18.409 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10091/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:18.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x7845899f1a3b90c7734a3cbff161596aa50835f6530edbfc212019a7fa572838"},{"messageHash":"0xa04deab19796555d2394e246525899125dae0fad41ff39982a6c9e2282f813a0"}]}'
2025-02-16 03:11:18.412 DEBUG [src.steps.store] Checking that peer wakuorg/go-waku:latest can find the stored messages
2025-02-16 03:11:18.412 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57706/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:18.417 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"request_id":"071c94a1b8d01381f87679f6c08af7a54f0368d09228569175cbd7ea1e29857b","status_code":200,"status_desc":"OK","messages":[{"message_hash":"eEWJnxo7kMdzSjy/8WFZaqUINfZTDtv8ISAZp/pXKDg="},{"message_hash":"oE3qsZeWVV0jlOJGUliZEl2uD61B/zmYKmyeIoL4E6A="}]}'
2025-02-16 03:11:18.418 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10091/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:18.421 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"0x7845899f1a3b90c7734a3cbff161596aa50835f6530edbfc212019a7fa572838"},{"messageHash":"0xa04deab19796555d2394e246525899125dae0fad41ff39982a6c9e2282f813a0"}]}'
2025-02-16 03:11:18.421 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:57706/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:11:18.543 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"request_id":"0129a861b1eadc924bdf8e2b1cba88482f5f6d4e300e5ee30e40cff96640d2cb","status_code":200,"status_desc":"OK","messages":[{"message_hash":"eEWJnxo7kMdzSjy/8WFZaqUINfZTDtv8ISAZp/pXKDg="},{"message_hash":"oE3qsZeWVV0jlOJGUliZEl2uD61B/zmYKmyeIoL4E6A="}]}'
2025-02-16 03:11:18.545 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 03:11:18.546 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 03:11:18.546 DEBUG [src.node.waku_node] Stopping container with id 83c55c42b2fa
2025-02-16 03:11:19.115 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 03:11:19.115 DEBUG [src.node.waku_node] Stopping container with id a1dea718cade
2025-02-16 03:11:19.612 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 03:11:19.614 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 03:11:19.623 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 03:11:19.627 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
