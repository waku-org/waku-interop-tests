2025-02-16 03:13:09.350 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-16 03:13:09.350 DEBUG [tests.conftest] Running test: test_single_pubsub_topic[/waku/2/rs/999/999] with id: 2025-02-16_03-13-09__ffe7c008-885a-47e1-9f1c-c2f583ce8478
2025-02-16 03:13:09.351 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-16 03:13:09.351 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-16 03:13:09.351 DEBUG [src.steps.sharding] Running fixture setup: sharding_setup
2025-02-16 03:13:09.358 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-16 03:13:09.358 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-16_03-13-09__ffe7c008-885a-47e1-9f1c-c2f583ce8478__wakuorg_nwaku:latest.log
2025-02-16 03:13:09.358 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 03:13:09.358 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 03:13:09.360 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 03:13:09.360 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.245.202
2025-02-16 03:13:09.360 DEBUG [src.node.docker_mananger] Generated ports ['50305', '50306', '50307', '50308', '50309']
2025-02-16 03:13:09.360 DEBUG [src.node.waku_node] Cluster id was resolved to: 999
2025-02-16 03:13:09.360 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 03:13:09.361 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 03:13:09.361 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 03:13:09.361 DEBUG [src.node.docker_mananger] docker run -i -t -p 50305:50305 -p 50306:50306 -p 50307:50307 -p 50308:50308 -p 50309:50309 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=50307 --rest-port=50305 --tcp-port=50306 --discv5-udp-port=50308 --rest-address=0.0.0.0 --nat=extip:172.18.245.202 --peer-exchange=true --discv5-discovery=true --cluster-id=999 --nodekey=6ed56f3bc87cabb339b4ff31edeb27bbee3cc578d9bdaa96abf34c1eac54be7a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=50309 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/999/999
2025-02-16 03:13:09.583 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.245.202 waku d5780cf0191e48362ecc28a34f71433c64a14292dc8d241bfef9b6186283f3b4
2025-02-16 03:13:09.627 ERROR [src.node.docker_mananger] Max retries reached for container a3899ddd79b5. Exiting log stream.
2025-02-16 03:13:09.636 DEBUG [src.node.docker_mananger] Container started with ID d5780cf0191e. Setting up logs at ./log/docker/node1_2025-02-16_03-13-09__ffe7c008-885a-47e1-9f1c-c2f583ce8478__wakuorg_nwaku:latest.log
2025-02-16 03:13:09.636 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 50305
2025-02-16 03:13:09.637 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 03:13:10.150 ERROR [src.node.docker_mananger] Max retries reached for container 67931446a1e7. Exiting log stream.
2025-02-16 03:13:10.637 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50305/health" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:10.640 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-16 03:13:10.640 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-16 03:13:10.640 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50305/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:10.643 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.245.202/tcp/50306/p2p/16Uiu2HAmLXDB7oHMC5LA9xGvS7SN16VskFUQ3jswbEUsYkG7yeL1","/ip4/172.18.245.202/tcp/50307/ws/p2p/16Uiu2HAmLXDB7oHMC5LA9xGvS7SN16VskFUQ3jswbEUsYkG7yeL1"],"enrUri":"enr:-L24QGSiQOcl_etlVHJ1CcjlduQv8t3xBq7pP2RkuT7db783LXDgInNSpsXNMvserXjeFJc11_Orzp5XqNlyhFZdKyACgmlkgnY0gmlwhKwS9cqKbXVsdGlhZGRyc5YACASsEvXKBsSCAAoErBL1ygbEg90DgnJzhQPnAQPniXNlY3AyNTZrMaEDdN9Zi5HwJfjWromgdZXRD39XIRCWjbAe3LCgx1DH_EKDdGNwgsSCg3VkcILEhIV3YWt1MgU"}'
2025-02-16 03:13:10.643 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 03:13:10.649 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-16 03:13:10.649 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-16_03-13-09__ffe7c008-885a-47e1-9f1c-c2f583ce8478__wakuorg_go-waku:latest.log
2025-02-16 03:13:10.649 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 03:13:10.649 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 03:13:10.651 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 03:13:10.651 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.176.30
2025-02-16 03:13:10.651 DEBUG [src.node.docker_mananger] Generated ports ['39072', '39073', '39074', '39075', '39076']
2025-02-16 03:13:10.651 DEBUG [src.node.waku_node] Cluster id was resolved to: 999
2025-02-16 03:13:10.651 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 03:13:10.651 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 03:13:10.651 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 03:13:10.652 DEBUG [src.node.docker_mananger] docker run -i -t -p 39072:39072 -p 39073:39073 -p 39074:39074 -p 39075:39075 -p 39076:39076 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=39074 --rest-port=39072 --tcp-port=39073 --discv5-udp-port=39075 --rest-address=0.0.0.0 --nat=extip:172.18.176.30 --peer-exchange=true --discv5-discovery=true --cluster-id=999 --nodekey=bcdff3d0b656aaacdee3271a3da87af8b17baf1e620a28972afdb5bd5613b4c6 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QGSiQOcl_etlVHJ1CcjlduQv8t3xBq7pP2RkuT7db783LXDgInNSpsXNMvserXjeFJc11_Orzp5XqNlyhFZdKyACgmlkgnY0gmlwhKwS9cqKbXVsdGlhZGRyc5YACASsEvXKBsSCAAoErBL1ygbEg90DgnJzhQPnAQPniXNlY3AyNTZrMaEDdN9Zi5HwJfjWromgdZXRD39XIRCWjbAe3LCgx1DH_EKDdGNwgsSCg3VkcILEhIV3YWt1MgU --pubsub-topic=/waku/2/rs/999/999
2025-02-16 03:13:10.848 DEBUG [src.node.waku_node] Starting Node...
2025-02-16 03:13:10.849 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-16 03:13:10.850 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-16 03:13:10.850 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.126.165
2025-02-16 03:13:10.850 DEBUG [src.node.docker_mananger] Generated ports ['43429', '43430', '43431', '43432', '43433']
2025-02-16 03:13:10.851 DEBUG [src.node.waku_node] Cluster id was resolved to: 999
2025-02-16 03:13:10.851 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-16 03:13:10.851 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-16 03:13:10.851 DEBUG [src.node.waku_node] Using volumes []
2025-02-16 03:13:10.851 DEBUG [src.node.docker_mananger] docker run -i -t -p 43429:43429 -p 43430:43430 -p 43431:43431 -p 43432:43432 -p 43433:43433 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=43431 --rest-port=43429 --tcp-port=43430 --discv5-udp-port=43432 --rest-address=0.0.0.0 --nat=extip:172.18.126.165 --peer-exchange=true --discv5-discovery=true --cluster-id=999 --nodekey=abb2d4bf5ad8229c64a0e4fa432dde8c9496a22bc7ac795809beacc9cfff7776 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QGSiQOcl_etlVHJ1CcjlduQv8t3xBq7pP2RkuT7db783LXDgInNSpsXNMvserXjeFJc11_Orzp5XqNlyhFZdKyACgmlkgnY0gmlwhKwS9cqKbXVsdGlhZGRyc5YACASsEvXKBsSCAAoErBL1ygbEg90DgnJzhQPnAQPniXNlY3AyNTZrMaEDdN9Zi5HwJfjWromgdZXRD39XIRCWjbAe3LCgx1DH_EKDdGNwgsSCg3VkcILEhIV3YWt1MgU --pubsub-topic=/waku/2/rs/999/999
2025-02-16 03:13:11.074 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.126.165 waku a12af0b23c0356e0e42d473b14c51236e04c043ea4aec6257a3c35685669265c
2025-02-16 03:13:11.129 DEBUG [src.node.docker_mananger] Container started with ID a12af0b23c03. Setting up logs at ./log/docker/node2_2025-02-16_03-13-09__ffe7c008-885a-47e1-9f1c-c2f583ce8478__wakuorg_go-waku:latest.log
2025-02-16 03:13:11.130 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 43429
2025-02-16 03:13:11.130 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-16 03:13:12.131 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43429/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:12.133 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QIp1HxtW-yVaM4Dj-DIH__SKkLlpEOGgDeWzuw8KWtvAM_3qX8qZ6Suz55NJH4FOySfSnlo30Je3oeZxe0W11uKGAZUMvuHRgmlkgnY0gmlwhKwRAAOCcnOFA-cBA-eJc2VjcDI1NmsxoQOqvBJNR79UK3UvAINcz8oEhIeIvnSSXRj-B-OqfnA3QYN0Y3CCqaaDdWRwgqmohXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/43430/p2p/16Uiu2HAmQ9TzQj6MYzAaBQGnBsnYqjrFzcgFbvyJ4ChqAhAxniT2","/ip4/127.0.0.1/tcp/43431/ws/p2p/16Uiu2HAmQ9TzQj6MYzAaBQGnBsnYqjrFzcgFbvyJ4ChqAhAxniT2","/ip4/172.17.0.3/tcp/43430/p2p/16Uiu2HAmQ9TzQj6MYzAaBQGnBsnYqjrFzcgFbvyJ4ChqAhAxniT2","/ip4/172.17.0.3/tcp/43431/ws/p2p/16Uiu2HAmQ9TzQj6MYzAaBQGnBsnYqjrFzcgFbvyJ4ChqAhAxniT2"]}'
2025-02-16 03:13:12.133 INFO [src.node.waku_node] REST service is ready !!
2025-02-16 03:13:12.134 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43429/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.245.202/tcp/50306/p2p/16Uiu2HAmLXDB7oHMC5LA9xGvS7SN16VskFUQ3jswbEUsYkG7yeL1", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-16 03:13:12.136 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-16 03:13:12.136 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50305/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/999/999"]'
2025-02-16 03:13:12.139 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 03:13:12.139 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43429/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/999/999"]'
2025-02-16 03:13:12.140 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-16 03:13:12.141 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:50305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F999%2F999" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
2025-02-16 03:13:12.146 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-16 03:13:12.146 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-16 03:13:12.246 DEBUG [src.steps.sharding] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-16 03:13:12.246 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:50305/relay/v1/messages/%2Fwaku%2F2%2Frs%2F999%2F999" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:12.249 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739675592141419520,"ephemeral":false,"proof":""}]'
2025-02-16 03:13:12.250 DEBUG [src.steps.sharding] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-16 03:13:12.251 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43429/relay/v1/messages/%2Fwaku%2F2%2Frs%2F999%2F999" -H "Content-Type: application/json" -d 'None'
2025-02-16 03:13:12.252 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739675592141419520,"ephemeral":false}]'
2025-02-16 03:13:12.255 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-16 03:13:12.256 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-16 03:13:12.256 DEBUG [src.node.waku_node] Stopping container with id d5780cf0191e
2025-02-16 03:13:12.840 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 03:13:12.840 DEBUG [src.node.waku_node] Stopping container with id a12af0b23c03
2025-02-16 03:13:13.591 DEBUG [src.node.waku_node] Container stopped.
2025-02-16 03:13:13.592 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-16 03:13:13.597 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-16 03:13:13.600 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
