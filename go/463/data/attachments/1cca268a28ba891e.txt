2025-02-11 14:56:17.106 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 14:56:17.106 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-11_14-56-17__cfdd3695-bd84-46a5-8a1d-30f52b8b351c
2025-02-11 14:56:17.107 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 14:56:17.107 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 14:56:17.107 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 14:56:17.113 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 14:56:17.113 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_14-56-17__cfdd3695-bd84-46a5-8a1d-30f52b8b351c__wakuorg_nwaku:latest.log
2025-02-11 14:56:17.113 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:56:17.113 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:56:17.115 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:56:17.115 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.214.51
2025-02-11 14:56:17.115 DEBUG [src.node.docker_mananger] Generated ports ['40726', '40727', '40728', '40729', '40730']
2025-02-11 14:56:17.115 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:56:17.115 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:56:17.115 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:56:17.116 DEBUG [src.node.docker_mananger] docker run -i -t -p 40726:40726 -p 40727:40727 -p 40728:40728 -p 40729:40729 -p 40730:40730 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=40728 --rest-port=40726 --tcp-port=40727 --discv5-udp-port=40729 --rest-address=0.0.0.0 --nat=extip:172.18.214.51 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ac03dfad7194eee76e20cfd9c41c6f5d9e17fbfd846eeedbedb4cfada5c3dcef --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=40730 --metrics-logging=true --relay=true
2025-02-11 14:56:17.354 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.214.51 waku 35cc1808c4c1368c67444fda450c619a3bc39ba28dff714b2d19239403dadb37
2025-02-11 14:56:17.406 DEBUG [src.node.docker_mananger] Container started with ID 35cc1808c4c1. Setting up logs at ./log/docker/node1_2025-02-11_14-56-17__cfdd3695-bd84-46a5-8a1d-30f52b8b351c__wakuorg_nwaku:latest.log
2025-02-11 14:56:17.407 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 40726
2025-02-11 14:56:17.407 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:56:17.877 ERROR [src.node.docker_mananger] Max retries reached for container 545d2572cc99. Exiting log stream.
2025-02-11 14:56:18.407 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40726/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:18.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 14:56:18.410 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 14:56:18.410 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40726/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:18.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.51/tcp/40727/p2p/16Uiu2HAmFLbh8N4dK8E9vuiEkY2WqSydHhmANZu5wStHESp5FKaZ","/ip4/172.18.214.51/tcp/40728/ws/p2p/16Uiu2HAmFLbh8N4dK8E9vuiEkY2WqSydHhmANZu5wStHESp5FKaZ"],"enrUri":"enr:-L24QEntPGOz9C920MkVWcx9k8KpreaNlhXET8_j53CwfIb3E0My-MSbZtG-GAjbSAM9ABlnVcCrUYVUIqfb6m4yjMoCgmlkgnY0gmlwhKwS1jOKbXVsdGlhZGRyc5YACASsEtYzBp8XAAoErBLWMwafGN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDJ9z8nPpvkDQ0_UmC8ppyMK13fvU5kCsBy9zOcUEopbKDdGNwgp8Xg3VkcIKfGYV3YWt1MgE"}'
2025-02-11 14:56:18.412 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:56:18.418 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 14:56:18.418 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_14-56-17__cfdd3695-bd84-46a5-8a1d-30f52b8b351c__wakuorg_go-waku:latest.log
2025-02-11 14:56:18.419 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:56:18.419 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:56:18.420 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:56:18.420 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.150.7
2025-02-11 14:56:18.420 DEBUG [src.node.docker_mananger] Generated ports ['18437', '18438', '18439', '18440', '18441']
2025-02-11 14:56:18.420 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:56:18.420 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:56:18.421 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:56:18.421 DEBUG [src.node.docker_mananger] docker run -i -t -p 18437:18437 -p 18438:18438 -p 18439:18439 -p 18440:18440 -p 18441:18441 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=18439 --rest-port=18437 --tcp-port=18438 --discv5-udp-port=18440 --rest-address=0.0.0.0 --nat=extip:172.18.150.7 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ee2d659aeeecda384fc1c26dca2e2fc9a83cfebe9d1eddcdc87ac0ad1c0b7a89 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QEntPGOz9C920MkVWcx9k8KpreaNlhXET8_j53CwfIb3E0My-MSbZtG-GAjbSAM9ABlnVcCrUYVUIqfb6m4yjMoCgmlkgnY0gmlwhKwS1jOKbXVsdGlhZGRyc5YACASsEtYzBp8XAAoErBLWMwafGN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDJ9z8nPpvkDQ0_UmC8ppyMK13fvU5kCsBy9zOcUEopbKDdGNwgp8Xg3VkcIKfGYV3YWt1MgE
2025-02-11 14:56:18.642 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.150.7 waku d1d1285e6c65e62c6a2a155c1a9ed966e165285697a9f6d1e01d2e57c753942d
2025-02-11 14:56:18.699 DEBUG [src.node.docker_mananger] Container started with ID d1d1285e6c65. Setting up logs at ./log/docker/node2_2025-02-11_14-56-17__cfdd3695-bd84-46a5-8a1d-30f52b8b351c__wakuorg_go-waku:latest.log
2025-02-11 14:56:18.699 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 18437
2025-02-11 14:56:18.699 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:56:19.700 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18437/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:19.703 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QIWgKekl1sk-Y-2deEjhgzHK66Ai8MEmm2REm9_zxWQ8HYq6qgSAntGrWx0XavR8v9oa54mLIkxBdGDJ76P-JECGAZT1gtD-gmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECCmdr5wbq3c2BcuUXAyMJClbENfMSMgs_HxuYglnaxlqDdGNwgkgGg3VkcIJICIV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/18438/p2p/16Uiu2HAkv8HXKDPNDZCJ29XVEiUC2mjJednN25HpvcLdrHvhiaF3","/ip4/127.0.0.1/tcp/18439/ws/p2p/16Uiu2HAkv8HXKDPNDZCJ29XVEiUC2mjJednN25HpvcLdrHvhiaF3","/ip4/172.17.0.3/tcp/18438/p2p/16Uiu2HAkv8HXKDPNDZCJ29XVEiUC2mjJednN25HpvcLdrHvhiaF3","/ip4/172.17.0.3/tcp/18439/ws/p2p/16Uiu2HAkv8HXKDPNDZCJ29XVEiUC2mjJednN25HpvcLdrHvhiaF3"]}'
2025-02-11 14:56:19.703 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:56:19.703 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18437/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.214.51/tcp/40727/p2p/16Uiu2HAmFLbh8N4dK8E9vuiEkY2WqSydHhmANZu5wStHESp5FKaZ", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 14:56:19.720 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 14:56:19.723 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 14:56:19.723 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 14:56:19.746 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 14:56:19.746 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18437/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 14:56:19.748 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-11 14:56:19.749 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 14:56:19.753 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 14:56:19.754 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 14:56:19.854 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 14:56:19.854 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:19.856 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739285779749391360,"ephemeral":false}]'
2025-02-11 14:56:19.858 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 14:56:19.858 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18437/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:19.860 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 14:56:20.861 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 14:56:20.865 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 14:56:20.866 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 14:56:20.966 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 14:56:20.966 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:20.968 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739285780860902144,"ephemeral":false}]'
2025-02-11 14:56:20.970 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 14:56:20.970 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18437/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:20.972 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739285780860902144,"ephemeral":false}]'
2025-02-11 14:56:20.973 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 14:56:20.974 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-11 14:56:20.974 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-11 14:56:20.977 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 14:56:20.977 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-11 14:56:20.977 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-11 14:56:20.980 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 14:56:20.980 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-11 14:56:20.980 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-11 14:56:20.982 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 14:56:20.982 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-11 14:56:20.983 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-11 14:56:20.985 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 14:56:20.985 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-11 14:56:20.985 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-11 14:56:20.987 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:40726/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-11 14:56:20.989 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 14:56:20.990 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 14:56:20.990 DEBUG [src.node.waku_node] Stopping container with id 35cc1808c4c1
2025-02-11 14:56:21.547 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:56:21.547 DEBUG [src.node.waku_node] Stopping container with id d1d1285e6c65
2025-02-11 14:56:22.024 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:56:22.026 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 14:56:22.033 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 14:56:22.036 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
