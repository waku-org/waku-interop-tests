2025-02-11 14:57:00.807 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 14:57:00.808 DEBUG [tests.conftest] Running test: test_lightpush_with_a_single_receiving_node with id: 2025-02-11_14-57-00__a04eebcd-c5e9-43cd-b296-1059944dacdb
2025-02-11 14:57:00.808 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 14:57:00.808 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 14:57:00.814 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 14:57:00.815 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_14-57-00__a04eebcd-c5e9-43cd-b296-1059944dacdb__wakuorg_nwaku:latest.log
2025-02-11 14:57:00.815 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:57:00.815 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:57:00.816 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:57:00.816 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.4.164
2025-02-11 14:57:00.817 DEBUG [src.node.docker_mananger] Generated ports ['10643', '10644', '10645', '10646', '10647']
2025-02-11 14:57:00.817 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:57:00.817 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:57:00.817 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:57:00.817 DEBUG [src.node.docker_mananger] docker run -i -t -p 10643:10643 -p 10644:10644 -p 10645:10645 -p 10646:10646 -p 10647:10647 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=10645 --rest-port=10643 --tcp-port=10644 --discv5-udp-port=10646 --rest-address=0.0.0.0 --nat=extip:172.18.4.164 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3c2ac2f3d2792c4fddede7b2ef0d0abc8f2cdd0c525ccf89fbdbb1d5eab02f65 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=10647 --metrics-logging=true --lightpush=true --relay=true
2025-02-11 14:57:01.043 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.4.164 waku 34db88d9aea3b679e201d463bc7f191da434783ac340ec5db11ad9c08eefdb53
2025-02-11 14:57:01.091 DEBUG [src.node.docker_mananger] Container started with ID 34db88d9aea3. Setting up logs at ./log/docker/receiving_node1_2025-02-11_14-57-00__a04eebcd-c5e9-43cd-b296-1059944dacdb__wakuorg_nwaku:latest.log
2025-02-11 14:57:01.091 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 10643
2025-02-11 14:57:01.093 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:57:01.109 ERROR [src.node.docker_mananger] Max retries reached for container 596c961e9b84. Exiting log stream.
2025-02-11 14:57:01.596 ERROR [src.node.docker_mananger] Max retries reached for container 90bf736977b6. Exiting log stream.
2025-02-11 14:57:02.094 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10643/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:57:02.097 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 14:57:02.097 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 14:57:02.097 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:10643/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:57:02.099 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.4.164/tcp/10644/p2p/16Uiu2HAmUE3XEqhFycNyX57GBZ1TG6Cu8zNNWurVxMSXkCqiw9Gx","/ip4/172.18.4.164/tcp/10645/ws/p2p/16Uiu2HAmUE3XEqhFycNyX57GBZ1TG6Cu8zNNWurVxMSXkCqiw9Gx"],"enrUri":"enr:-L24QBMB_90OCwviTR9uv3MLzvfO-9ipRMBNRFgbIhgK0im9AMkBj6Hn9prnOuu0JSA_HD4gRnuW2PdKjetDUwFOHTECgmlkgnY0gmlwhKwSBKSKbXVsdGlhZGRyc5YACASsEgSkBimUAAoErBIEpAYpld0DgnJzhQADAQAAiXNlY3AyNTZrMaED51cOgf349QCI6yytBgSNcCJ2dSMLe-_kxF6fjOSKTv2DdGNwgimUg3VkcIIploV3YWt1Mgk"}'
2025-02-11 14:57:02.100 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:57:02.106 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 14:57:02.106 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_14-57-00__a04eebcd-c5e9-43cd-b296-1059944dacdb__wakuorg_go-waku:latest.log
2025-02-11 14:57:02.106 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:57:02.106 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:57:02.108 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:57:02.108 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.92.183
2025-02-11 14:57:02.108 DEBUG [src.node.docker_mananger] Generated ports ['19933', '19934', '19935', '19936', '19937']
2025-02-11 14:57:02.108 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:57:02.108 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:57:02.108 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:57:02.108 DEBUG [src.node.docker_mananger] docker run -i -t -p 19933:19933 -p 19934:19934 -p 19935:19935 -p 19936:19936 -p 19937:19937 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=19935 --rest-port=19933 --tcp-port=19934 --discv5-udp-port=19936 --rest-address=0.0.0.0 --nat=extip:172.18.92.183 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b8ebeede5fc8cae9f2c2f137641f4ebdf4783bbebddbba8dded728e7c3e8df9a --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QBMB_90OCwviTR9uv3MLzvfO-9ipRMBNRFgbIhgK0im9AMkBj6Hn9prnOuu0JSA_HD4gRnuW2PdKjetDUwFOHTECgmlkgnY0gmlwhKwSBKSKbXVsdGlhZGRyc5YACASsEgSkBimUAAoErBIEpAYpld0DgnJzhQADAQAAiXNlY3AyNTZrMaED51cOgf349QCI6yytBgSNcCJ2dSMLe-_kxF6fjOSKTv2DdGNwgimUg3VkcIIploV3YWt1Mgk --lightpushnode=/ip4/172.18.4.164/tcp/10644/p2p/16Uiu2HAmUE3XEqhFycNyX57GBZ1TG6Cu8zNNWurVxMSXkCqiw9Gx --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-11 14:57:02.337 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.92.183 waku 7055e51e971223ea63878291de5e008ff374756402a02df2be14517a82c7e9dc
2025-02-11 14:57:02.395 DEBUG [src.node.docker_mananger] Container started with ID 7055e51e9712. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_14-57-00__a04eebcd-c5e9-43cd-b296-1059944dacdb__wakuorg_go-waku:latest.log
2025-02-11 14:57:02.396 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 19933
2025-02-11 14:57:02.398 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:57:03.398 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19933/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:57:03.400 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QO95gh9VWIIvKhmc15ACaahQmRM5cB3je9vASQukIMWpBncI2FjtnUkdBL_SGtcoBQ_ea1nXANujscGM7zQPfiiGAZT1g3uwgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQIXBSlPj9bPf4WtpfrEegaFF2lE1FuCYz95vihTdFlLCoN0Y3CCTd6DdWRwgk3ghXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/19934/p2p/16Uiu2HAkvyXvRAHGUQYkwLL8W6Q1FuZGf6dR5WTmVi6jLN6ukY4h","/ip4/127.0.0.1/tcp/19935/ws/p2p/16Uiu2HAkvyXvRAHGUQYkwLL8W6Q1FuZGf6dR5WTmVi6jLN6ukY4h","/ip4/172.17.0.3/tcp/19934/p2p/16Uiu2HAkvyXvRAHGUQYkwLL8W6Q1FuZGf6dR5WTmVi6jLN6ukY4h","/ip4/172.17.0.3/tcp/19935/ws/p2p/16Uiu2HAkvyXvRAHGUQYkwLL8W6Q1FuZGf6dR5WTmVi6jLN6ukY4h"]}'
2025-02-11 14:57:03.401 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:57:03.401 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19933/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.4.164/tcp/10644/p2p/16Uiu2HAmUE3XEqhFycNyX57GBZ1TG6Cu8zNNWurVxMSXkCqiw9Gx", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 14:57:03.403 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 14:57:03.403 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:10643/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 14:57:03.406 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 14:57:03.406 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 14:57:03.406 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19933/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739285823406743552}}'
2025-02-11 14:57:03.411 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:19933/lightpush/v1/message. Response content: b'lightpush errornot_published_to_any_peer'
2025-02-11 14:57:03.414 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 14:57:03.415 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 14:57:03.415 DEBUG [src.node.waku_node] Stopping container with id 34db88d9aea3
2025-02-11 14:57:04.024 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:57:04.024 DEBUG [src.node.waku_node] Stopping container with id 7055e51e9712
2025-02-11 14:57:04.839 ERROR [src.node.docker_mananger] Max retries reached for container 34db88d9aea3. Exiting log stream.
2025-02-11 14:57:04.891 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:57:04.892 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 14:57:04.897 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 14:57:04.900 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
