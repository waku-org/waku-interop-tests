2025-02-11 14:56:40.573 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 14:56:40.573 DEBUG [tests.conftest] Running test: test_light_push_with_invalid_pubsub_topics with id: 2025-02-11_14-56-40__159ca1ed-a184-4c5a-abd1-f6188c59abe7
2025-02-11 14:56:40.574 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 14:56:40.574 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 14:56:40.580 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 14:56:40.580 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_14-56-40__159ca1ed-a184-4c5a-abd1-f6188c59abe7__wakuorg_nwaku:latest.log
2025-02-11 14:56:40.580 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:56:40.580 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:56:40.582 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:56:40.582 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.191.224
2025-02-11 14:56:40.582 DEBUG [src.node.docker_mananger] Generated ports ['20304', '20305', '20306', '20307', '20308']
2025-02-11 14:56:40.582 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:56:40.582 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:56:40.582 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:56:40.582 DEBUG [src.node.docker_mananger] docker run -i -t -p 20304:20304 -p 20305:20305 -p 20306:20306 -p 20307:20307 -p 20308:20308 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20306 --rest-port=20304 --tcp-port=20305 --discv5-udp-port=20307 --rest-address=0.0.0.0 --nat=extip:172.18.191.224 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=79faaf7ad2f92711f480dcbaebefff29ff86bd0fdcb3dfc5ebdc2afdd8166b9a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20308 --metrics-logging=true --lightpush=true --relay=true
2025-02-11 14:56:40.810 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.191.224 waku a3ddf6ff96504f1e74f3a5bb620ddea2e1b05f995a494babd23dbe252a9dd243
2025-02-11 14:56:40.830 ERROR [src.node.docker_mananger] Max retries reached for container 511f559eddec. Exiting log stream.
2025-02-11 14:56:40.859 DEBUG [src.node.docker_mananger] Container started with ID a3ddf6ff9650. Setting up logs at ./log/docker/receiving_node1_2025-02-11_14-56-40__159ca1ed-a184-4c5a-abd1-f6188c59abe7__wakuorg_nwaku:latest.log
2025-02-11 14:56:40.860 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20304
2025-02-11 14:56:40.860 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:56:41.376 ERROR [src.node.docker_mananger] Max retries reached for container 2675f87ea660. Exiting log stream.
2025-02-11 14:56:41.860 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20304/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:41.863 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 14:56:41.863 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 14:56:41.864 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20304/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:41.866 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.191.224/tcp/20305/p2p/16Uiu2HAmTuDX6DRCHdsYPnEFyeY19n9z7uMM83p5npFN82H9GJrG","/ip4/172.18.191.224/tcp/20306/ws/p2p/16Uiu2HAmTuDX6DRCHdsYPnEFyeY19n9z7uMM83p5npFN82H9GJrG"],"enrUri":"enr:-L24QMOeVZ8Ku90vbXoGoUlE4DZCl-qiIZKKd8rrX7HPcEBaeMy6yMd5iWWG-a31AmLo0FE8dvd12AVDuHLKPTrrUPwCgmlkgnY0gmlwhKwSv-CKbXVsdGlhZGRyc5YACASsEr_gBk9RAAoErBK_4AZPUt0DgnJzhQADAQAAiXNlY3AyNTZrMaED4oRTT70MyIixVaicjROt0b3aTDnarH6M1DlL1f--yiWDdGNwgk9Rg3VkcIJPU4V3YWt1Mgk"}'
2025-02-11 14:56:41.866 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:56:41.872 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 14:56:41.873 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-11_14-56-40__159ca1ed-a184-4c5a-abd1-f6188c59abe7__wakuorg_nwaku:latest.log
2025-02-11 14:56:41.873 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:56:41.873 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:56:41.874 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:56:41.874 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.168.239
2025-02-11 14:56:41.875 DEBUG [src.node.docker_mananger] Generated ports ['44433', '44434', '44435', '44436', '44437']
2025-02-11 14:56:41.875 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:56:41.875 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:56:41.875 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:56:41.875 DEBUG [src.node.docker_mananger] docker run -i -t -p 44433:44433 -p 44434:44434 -p 44435:44435 -p 44436:44436 -p 44437:44437 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44435 --rest-port=44433 --tcp-port=44434 --discv5-udp-port=44436 --rest-address=0.0.0.0 --nat=extip:172.18.168.239 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=f648fedbf15390f97ffdf54efc2efec32584eeabd4988731e7b0ad35cecf32ee --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44437 --metrics-logging=true --lightpush=false --relay=true
2025-02-11 14:56:42.106 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.168.239 waku c3459922e9245d2a54b8840cbdcff0602d5eb35eab06331f57e9dad061b3a0ce
2025-02-11 14:56:42.157 DEBUG [src.node.docker_mananger] Container started with ID c3459922e924. Setting up logs at ./log/docker/receiving_node2_2025-02-11_14-56-40__159ca1ed-a184-4c5a-abd1-f6188c59abe7__wakuorg_nwaku:latest.log
2025-02-11 14:56:42.158 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44433
2025-02-11 14:56:42.158 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:56:43.158 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44433/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:43.161 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 14:56:43.161 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 14:56:43.162 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44433/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:43.164 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.168.239/tcp/44434/p2p/16Uiu2HAm2Vkc18jZqer7JQbx2r7EQGdhpo5dsUVV9Qnk6q3HgaAu","/ip4/172.18.168.239/tcp/44435/ws/p2p/16Uiu2HAm2Vkc18jZqer7JQbx2r7EQGdhpo5dsUVV9Qnk6q3HgaAu"],"enrUri":"enr:-L24QBE6qHrfI0-JQdxl7UPjt0NS2uIw5He5Nmlbo4y5Yh1JF6ApXlqvmn8icGH5-CQFEF9i4H73i0wxfY1SIma-UiACgmlkgnY0gmlwhKwSqO-KbXVsdGlhZGRyc5YACASsEqjvBq2SAAoErBKo7watk90DgnJzhQADAQAAiXNlY3AyNTZrMaECaQ1cRZ6rHcskhc3XxQS-kYUG3xabF8U6NTHNpz9SBbqDdGNwgq2Sg3VkcIKtlIV3YWt1MgE"}'
2025-02-11 14:56:43.164 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:56:43.164 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44433/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.191.224/tcp/20305/p2p/16Uiu2HAmTuDX6DRCHdsYPnEFyeY19n9z7uMM83p5npFN82H9GJrG"]'
2025-02-11 14:56:43.201 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 14:56:43.211 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 14:56:43.211 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_14-56-40__159ca1ed-a184-4c5a-abd1-f6188c59abe7__wakuorg_go-waku:latest.log
2025-02-11 14:56:43.211 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:56:43.211 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:56:43.212 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:56:43.213 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.3.205
2025-02-11 14:56:43.213 DEBUG [src.node.docker_mananger] Generated ports ['36294', '36295', '36296', '36297', '36298']
2025-02-11 14:56:43.213 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:56:43.213 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:56:43.213 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:56:43.213 DEBUG [src.node.docker_mananger] docker run -i -t -p 36294:36294 -p 36295:36295 -p 36296:36296 -p 36297:36297 -p 36298:36298 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=36296 --rest-port=36294 --tcp-port=36295 --discv5-udp-port=36297 --rest-address=0.0.0.0 --nat=extip:172.18.3.205 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=57296acd4cf9433c69dce3af697d3f8cccc338aafa8b61db086e13facbc6bd39 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QMOeVZ8Ku90vbXoGoUlE4DZCl-qiIZKKd8rrX7HPcEBaeMy6yMd5iWWG-a31AmLo0FE8dvd12AVDuHLKPTrrUPwCgmlkgnY0gmlwhKwSv-CKbXVsdGlhZGRyc5YACASsEr_gBk9RAAoErBK_4AZPUt0DgnJzhQADAQAAiXNlY3AyNTZrMaED4oRTT70MyIixVaicjROt0b3aTDnarH6M1DlL1f--yiWDdGNwgk9Rg3VkcIJPU4V3YWt1Mgk --lightpushnode=/ip4/172.18.191.224/tcp/20305/p2p/16Uiu2HAmTuDX6DRCHdsYPnEFyeY19n9z7uMM83p5npFN82H9GJrG --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-11 14:56:43.454 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.3.205 waku 4542ac2375e85191057f7efa13f72ce75a121df1876d1f3ad69f129f0f7ef224
2025-02-11 14:56:43.510 DEBUG [src.node.docker_mananger] Container started with ID 4542ac2375e8. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_14-56-40__159ca1ed-a184-4c5a-abd1-f6188c59abe7__wakuorg_go-waku:latest.log
2025-02-11 14:56:43.510 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 36294
2025-02-11 14:56:43.510 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:56:44.511 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:36294/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:56:44.513 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QMOLx2SGzeeteup1ryx1yHz5FAyxVxxiLelgTlWXDeDGP04F_jzs2LZLlqDR2bsrN73NqR0TsqdxPWvtLpzMj0uGAZT1gzHvgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQOepMuj8JrQScL7XlZyeWf_hW0LrcSZh8IyXoVxTqSRRIN0Y3CCjceDdWRwgo3JhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/36295/p2p/16Uiu2HAmPLGWhPhqtWseJC8kdievCC28rGxrej7zzATNjK3rvfkP","/ip4/127.0.0.1/tcp/36296/ws/p2p/16Uiu2HAmPLGWhPhqtWseJC8kdievCC28rGxrej7zzATNjK3rvfkP","/ip4/172.17.0.4/tcp/36295/p2p/16Uiu2HAmPLGWhPhqtWseJC8kdievCC28rGxrej7zzATNjK3rvfkP","/ip4/172.17.0.4/tcp/36296/ws/p2p/16Uiu2HAmPLGWhPhqtWseJC8kdievCC28rGxrej7zzATNjK3rvfkP"]}'
2025-02-11 14:56:44.514 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:56:44.514 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36294/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.191.224/tcp/20305/p2p/16Uiu2HAmTuDX6DRCHdsYPnEFyeY19n9z7uMM83p5npFN82H9GJrG", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 14:56:44.516 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 14:56:44.516 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36294/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.168.239/tcp/44434/p2p/16Uiu2HAm2Vkc18jZqer7JQbx2r7EQGdhpo5dsUVV9Qnk6q3HgaAu", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 14:56:44.532 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 14:56:44.533 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20304/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 14:56:44.540 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 14:56:44.540 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44433/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-11 14:56:44.544 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 14:56:44.544 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'A dictionary', 'value': {'key': 'YWFh'}}
2025-02-11 14:56:44.545 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 14:56:44.545 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": {"key": "YWFh"}, "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739285804545353984}}'
2025-02-11 14:56:44.547 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36294/lightpush/v1/message. Response content: b''
2025-02-11 14:56:44.547 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'An integer', 'value': 1234567890}
2025-02-11 14:56:44.548 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 14:56:44.548 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": 1234567890, "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739285804548426752}}'
2025-02-11 14:56:44.550 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36294/lightpush/v1/message. Response content: b''
2025-02-11 14:56:44.550 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'A list', 'value': ['YWFh']}
2025-02-11 14:56:44.551 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 14:56:44.551 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": ["YWFh"], "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739285804551343360}}'
2025-02-11 14:56:44.552 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36294/lightpush/v1/message. Response content: b''
2025-02-11 14:56:44.553 DEBUG [tests.light_push.test_publish] Running test with pubsub topic {'description': 'A bool', 'value': True}
2025-02-11 14:56:44.554 DEBUG [src.steps.light_push] Lightpushing message
2025-02-11 14:56:44.554 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:36294/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": true, "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739285804554021376}}'
2025-02-11 14:56:44.555 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:36294/lightpush/v1/message. Response content: b''
2025-02-11 14:56:44.557 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 14:56:44.558 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 14:56:44.559 DEBUG [src.node.waku_node] Stopping container with id a3ddf6ff9650
2025-02-11 14:56:45.163 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:56:45.163 DEBUG [src.node.waku_node] Stopping container with id c3459922e924
2025-02-11 14:56:45.976 ERROR [src.node.docker_mananger] Max retries reached for container a3ddf6ff9650. Exiting log stream.
2025-02-11 14:56:46.676 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:56:46.676 DEBUG [src.node.waku_node] Stopping container with id 4542ac2375e8
2025-02-11 14:56:47.175 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:56:47.175 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 14:56:47.182 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 14:56:47.190 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 14:56:47.193 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
