2025-02-11 14:57:30.984 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 14:57:30.984 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_only_filter with id: 2025-02-11_14-57-30__f20cf2ff-0987-4233-87fb-10453a8c3689
2025-02-11 14:57:30.985 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 14:57:30.985 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-11 14:57:30.992 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 14:57:30.992 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-11_14-57-30__f20cf2ff-0987-4233-87fb-10453a8c3689__wakuorg_nwaku:latest.log
2025-02-11 14:57:30.992 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:57:30.992 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:57:30.994 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:57:30.994 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.173.77
2025-02-11 14:57:30.994 DEBUG [src.node.docker_mananger] Generated ports ['1324', '1325', '1326', '1327', '1328']
2025-02-11 14:57:30.994 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:57:30.994 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:57:30.994 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:57:30.995 DEBUG [src.node.docker_mananger] docker run -i -t -p 1324:1324 -p 1325:1325 -p 1326:1326 -p 1327:1327 -p 1328:1328 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=1326 --rest-port=1324 --tcp-port=1325 --discv5-udp-port=1327 --rest-address=0.0.0.0 --nat=extip:172.18.173.77 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=efa1af586dfedf1cf0dffe8f26d3ef490b610de7d2ee1f17d1ebabb1ebb6ef14 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=1328 --metrics-logging=true --lightpush=false --relay=false --filter=true
2025-02-11 14:57:31.236 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.173.77 waku 0fe2bcd9892c09a39cc654e9597350e3f3a4080b93703db6c10ea4852843dd15
2025-02-11 14:57:31.259 ERROR [src.node.docker_mananger] Max retries reached for container 093edaaafd80. Exiting log stream.
2025-02-11 14:57:31.278 DEBUG [src.node.docker_mananger] Container started with ID 0fe2bcd9892c. Setting up logs at ./log/docker/receiving_node1_2025-02-11_14-57-30__f20cf2ff-0987-4233-87fb-10453a8c3689__wakuorg_nwaku:latest.log
2025-02-11 14:57:31.279 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 1324
2025-02-11 14:57:31.279 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:57:31.790 ERROR [src.node.docker_mananger] Max retries reached for container 8de8c00f307f. Exiting log stream.
2025-02-11 14:57:32.279 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1324/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:57:32.282 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 14:57:32.282 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 14:57:32.283 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:1324/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:57:32.284 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.173.77/tcp/1325/p2p/16Uiu2HAm2kcCc58T5WU6a3YhSFBrHEATJt2vc5ypZk6nH7inqF2A","/ip4/172.18.173.77/tcp/1326/ws/p2p/16Uiu2HAm2kcCc58T5WU6a3YhSFBrHEATJt2vc5ypZk6nH7inqF2A"],"enrUri":"enr:-L24QGAKr4_qeL70B1ViU167MHu07G_bVCGGFguuyQ-TVqsrGcjavNpuepthijrDlF3XKv-HpSVOF7eNRZSqUlyOoAYCgmlkgnY0gmlwhKwSrU2KbXVsdGlhZGRyc5YACASsEq1NBgUtAAoErBKtTQYFLt0DgnJzhQADAQAAiXNlY3AyNTZrMaECbNuSIKM9-CsrFZNFxko_dPzEQPYv6IptEwsMhkRx2quDdGNwggUtg3VkcIIFL4V3YWt1MgQ"}'
2025-02-11 14:57:32.285 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:57:32.291 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 14:57:32.291 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-11_14-57-30__f20cf2ff-0987-4233-87fb-10453a8c3689__wakuorg_go-waku:latest.log
2025-02-11 14:57:32.292 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 14:57:32.292 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 14:57:32.293 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 14:57:32.293 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.8.142
2025-02-11 14:57:32.293 DEBUG [src.node.docker_mananger] Generated ports ['59417', '59418', '59419', '59420', '59421']
2025-02-11 14:57:32.293 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 14:57:32.293 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 14:57:32.294 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 14:57:32.294 DEBUG [src.node.docker_mananger] docker run -i -t -p 59417:59417 -p 59418:59418 -p 59419:59419 -p 59420:59420 -p 59421:59421 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=59419 --rest-port=59417 --tcp-port=59418 --discv5-udp-port=59420 --rest-address=0.0.0.0 --nat=extip:172.18.8.142 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c67d8cbc88fe1ef08d59b6470a59daa7d16a26db70bccddefe768904dd46fb81 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QGAKr4_qeL70B1ViU167MHu07G_bVCGGFguuyQ-TVqsrGcjavNpuepthijrDlF3XKv-HpSVOF7eNRZSqUlyOoAYCgmlkgnY0gmlwhKwSrU2KbXVsdGlhZGRyc5YACASsEq1NBgUtAAoErBKtTQYFLt0DgnJzhQADAQAAiXNlY3AyNTZrMaECbNuSIKM9-CsrFZNFxko_dPzEQPYv6IptEwsMhkRx2quDdGNwggUtg3VkcIIFL4V3YWt1MgQ --lightpushnode=/ip4/172.18.173.77/tcp/1325/p2p/16Uiu2HAm2kcCc58T5WU6a3YhSFBrHEATJt2vc5ypZk6nH7inqF2A --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-11 14:57:32.521 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.8.142 waku 7f4d8273e7fcf0c907b6572879094c0c637a3a3f57f61bd17c902b612fc59e5d
2025-02-11 14:57:32.572 DEBUG [src.node.docker_mananger] Container started with ID 7f4d8273e7fc. Setting up logs at ./log/docker/lightpush_node1_2025-02-11_14-57-30__f20cf2ff-0987-4233-87fb-10453a8c3689__wakuorg_go-waku:latest.log
2025-02-11 14:57:32.574 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 59417
2025-02-11 14:57:32.574 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 14:57:33.574 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59417/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 14:57:33.577 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QIuQlGaVrHf2FuLKG_H__QCopMYtWvHXUoGeeeOxn2tDF4TNjHZB-lpEybMMIV-b2hDMan5XeYZMw4DTZ21_nWKGAZT1g_GXgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQKfQgibxUYAKL1oV03nvu1e565l7y6TIPt2eFe37TycEYN0Y3CC6BqDdWRwgugchXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/59418/p2p/16Uiu2HAm69MCovNFFBjt3bNZsvhnZyFi2ufpY3ih7FsD3m5tF6si","/ip4/127.0.0.1/tcp/59419/ws/p2p/16Uiu2HAm69MCovNFFBjt3bNZsvhnZyFi2ufpY3ih7FsD3m5tF6si","/ip4/172.17.0.3/tcp/59418/p2p/16Uiu2HAm69MCovNFFBjt3bNZsvhnZyFi2ufpY3ih7FsD3m5tF6si","/ip4/172.17.0.3/tcp/59419/ws/p2p/16Uiu2HAm69MCovNFFBjt3bNZsvhnZyFi2ufpY3ih7FsD3m5tF6si"]}'
2025-02-11 14:57:33.577 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 14:57:33.577 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59417/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.173.77/tcp/1325/p2p/16Uiu2HAm2kcCc58T5WU6a3YhSFBrHEATJt2vc5ypZk6nH7inqF2A", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 14:57:33.579 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 14:57:33.580 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59417/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739285853580330752}}'
2025-02-11 14:57:33.584 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:59417/lightpush/v1/message. Response content: b'lightpush error'
2025-02-11 14:57:33.586 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 14:57:33.587 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 14:57:33.587 DEBUG [src.node.waku_node] Stopping container with id 0fe2bcd9892c
2025-02-11 14:57:34.200 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:57:34.200 DEBUG [src.node.waku_node] Stopping container with id 7f4d8273e7fc
2025-02-11 14:57:35.014 ERROR [src.node.docker_mananger] Max retries reached for container 0fe2bcd9892c. Exiting log stream.
2025-02-11 14:57:35.081 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 14:57:35.082 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 14:57:35.085 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 14:57:35.088 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
