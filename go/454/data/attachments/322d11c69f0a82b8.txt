2025-02-04 17:24:37.439 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-04 17:24:37.439 DEBUG [tests.conftest] Running test: test_filter_get_message_after_node_pauses_and_pauses with id: 2025-02-04_17-24-37__27d0f1c2-b0aa-4fdc-b2df-31ca48a91189
2025-02-04 17:24:37.439 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-04 17:24:37.440 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-04 17:24:37.440 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-04 17:24:37.446 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-04 17:24:37.446 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-04_17-24-37__27d0f1c2-b0aa-4fdc-b2df-31ca48a91189__wakuorg_nwaku:latest.log
2025-02-04 17:24:37.446 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:24:37.447 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:24:37.448 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:24:37.448 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.20.150
2025-02-04 17:24:37.448 DEBUG [src.node.docker_mananger] Generated ports ['39652', '39653', '39654', '39655', '39656']
2025-02-04 17:24:37.448 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:24:37.449 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:24:37.449 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:24:37.449 DEBUG [src.node.docker_mananger] docker run -i -t -p 39652:39652 -p 39653:39653 -p 39654:39654 -p 39655:39655 -p 39656:39656 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=39654 --rest-port=39652 --tcp-port=39653 --discv5-udp-port=39655 --rest-address=0.0.0.0 --nat=extip:172.18.20.150 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ad7dcad0af7a4aa0defe9f30fbb7972ee2ab0711ffc6e46ede2a49a26b9f9e8d --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=39656 --metrics-logging=true --relay=true --filter=true
2025-02-04 17:24:37.684 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.20.150 waku 5146024876e76442c34aa0b9ca83b9c8c637c2ea09ca05de83c84b1783cf28aa
2025-02-04 17:24:37.707 ERROR [src.node.docker_mananger] Max retries reached for container 60bce74b1e12. Exiting log stream.
2025-02-04 17:24:37.734 DEBUG [src.node.docker_mananger] Container started with ID 5146024876e7. Setting up logs at ./log/docker/node1_2025-02-04_17-24-37__27d0f1c2-b0aa-4fdc-b2df-31ca48a91189__wakuorg_nwaku:latest.log
2025-02-04 17:24:37.736 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 39652
2025-02-04 17:24:37.736 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:24:38.244 ERROR [src.node.docker_mananger] Max retries reached for container b2f22c170112. Exiting log stream.
2025-02-04 17:24:38.736 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39652/health" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:24:38.739 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-04 17:24:38.740 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-04 17:24:38.740 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:39652/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:24:38.742 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.20.150/tcp/39653/p2p/16Uiu2HAkwfrE3ZFHXrJX7UqfhLtGbPg9H7GZ4kb6wzhnCxRD6pYd","/ip4/172.18.20.150/tcp/39654/ws/p2p/16Uiu2HAkwfrE3ZFHXrJX7UqfhLtGbPg9H7GZ4kb6wzhnCxRD6pYd"],"enrUri":"enr:-L24QCx2dqLOkYk23_J3KUluYva9zJTSXVpByLizDAcxH4krOKEZ6Dt2-tEUFLTOtBWn93guUdlw4pfTXeyCodmLOZ0CgmlkgnY0gmlwhKwSFJaKbXVsdGlhZGRyc5YACASsEhSWBprlAAoErBIUlgaa5t0DgnJzhQADAQAAiXNlY3AyNTZrMaECIVkXDSp-7CWYM4KN-68IXN6ARtOKMthHL-6abhnMI46DdGNwgprlg3VkcIKa54V3YWt1MgU"}'
2025-02-04 17:24:38.742 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:24:38.743 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-04 17:24:38.749 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-04 17:24:38.749 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-04_17-24-37__27d0f1c2-b0aa-4fdc-b2df-31ca48a91189__wakuorg_go-waku:latest.log
2025-02-04 17:24:38.749 DEBUG [src.node.waku_node] Starting Node...
2025-02-04 17:24:38.749 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-04 17:24:38.751 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-04 17:24:38.751 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.236.12
2025-02-04 17:24:38.751 DEBUG [src.node.docker_mananger] Generated ports ['59915', '59916', '59917', '59918', '59919']
2025-02-04 17:24:38.751 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-04 17:24:38.751 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-04 17:24:38.751 DEBUG [src.node.waku_node] Using volumes []
2025-02-04 17:24:38.752 DEBUG [src.node.docker_mananger] docker run -i -t -p 59915:59915 -p 59916:59916 -p 59917:59917 -p 59918:59918 -p 59919:59919 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=59917 --rest-port=59915 --tcp-port=59916 --discv5-udp-port=59918 --rest-address=0.0.0.0 --nat=extip:172.18.236.12 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e88c9de3efc7e02f1accbcb05a7e7e6ea74ee55a9aadd0ae5cd2fa7e801f6d76 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QCx2dqLOkYk23_J3KUluYva9zJTSXVpByLizDAcxH4krOKEZ6Dt2-tEUFLTOtBWn93guUdlw4pfTXeyCodmLOZ0CgmlkgnY0gmlwhKwSFJaKbXVsdGlhZGRyc5YACASsEhSWBprlAAoErBIUlgaa5t0DgnJzhQADAQAAiXNlY3AyNTZrMaECIVkXDSp-7CWYM4KN-68IXN6ARtOKMthHL-6abhnMI46DdGNwgprlg3VkcIKa54V3YWt1MgU --filternode=/ip4/172.18.20.150/tcp/39653/p2p/16Uiu2HAkwfrE3ZFHXrJX7UqfhLtGbPg9H7GZ4kb6wzhnCxRD6pYd --pubsub-topic=/waku/2/rs/3/1
2025-02-04 17:24:38.984 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.236.12 waku 40a961b8c3ca7c8bc697c2d6675c7000a1fa275a6580c070a065aec9f51278ab
2025-02-04 17:24:39.034 DEBUG [src.node.docker_mananger] Container started with ID 40a961b8c3ca. Setting up logs at ./log/docker/node2_2025-02-04_17-24-37__27d0f1c2-b0aa-4fdc-b2df-31ca48a91189__wakuorg_go-waku:latest.log
2025-02-04 17:24:39.036 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 59915
2025-02-04 17:24:39.036 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-04 17:24:40.037 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59915/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:24:40.039 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QPQ4ewhNzuv3z2j_5x3Lbxs2ckhZONN1TrvT8nQbpI2ZSHZOL-7jMYvHQMovVCtBMLVWgr-uovjkQ6b_tSovQsmGAZTR_hv2gmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQOQQeqSUAXCj6B-W3G0Rz0_BSLbdPPD5tNEhJTWRWrI-YN0Y3CC6gyDdWRwguoOhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/59916/p2p/16Uiu2HAmNN7MbCgkhTxGsqqcxXpzAx8zUG6CCY79UzBYqP4KCVya","/ip4/127.0.0.1/tcp/59917/ws/p2p/16Uiu2HAmNN7MbCgkhTxGsqqcxXpzAx8zUG6CCY79UzBYqP4KCVya","/ip4/172.17.0.3/tcp/59916/p2p/16Uiu2HAmNN7MbCgkhTxGsqqcxXpzAx8zUG6CCY79UzBYqP4KCVya","/ip4/172.17.0.3/tcp/59917/ws/p2p/16Uiu2HAmNN7MbCgkhTxGsqqcxXpzAx8zUG6CCY79UzBYqP4KCVya"]}'
2025-02-04 17:24:40.040 INFO [src.node.waku_node] REST service is ready !!
2025-02-04 17:24:40.040 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59915/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.20.150/tcp/39653/p2p/16Uiu2HAkwfrE3ZFHXrJX7UqfhLtGbPg9H7GZ4kb6wzhnCxRD6pYd", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-04 17:24:40.042 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-04 17:24:40.043 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-04 17:24:40.043 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39652/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-04 17:24:40.046 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:24:40.046 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59915/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "d0697293-6666-4ce6-8087-11baaf0ed2c5", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-04 17:24:40.052 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"d0697293-6666-4ce6-8087-11baaf0ed2c5","statusDesc":"OK"}'
2025-02-04 17:24:40.053 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39652/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:24:40.061 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:24:40.061 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:24:40.161 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-04 17:24:40.162 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59915/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:24:40.164 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1738689880053873664,"ephemeral":false}]'
2025-02-04 17:24:40.166 DEBUG [src.node.waku_node] Pausing container with id 5146024876e7
2025-02-04 17:24:40.175 DEBUG [src.node.waku_node] Unpause container with id 5146024876e7
2025-02-04 17:24:40.183 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:39652/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "TTE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-04 17:24:40.188 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-04 17:24:40.188 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-04 17:24:40.288 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-04 17:24:40.289 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59915/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-04 17:24:40.291 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[]'
2025-02-04 17:24:40.330 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-04 17:24:40.331 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-04 17:24:40.332 DEBUG [src.node.waku_node] Stopping container with id 5146024876e7
2025-02-04 17:24:40.860 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:24:40.861 DEBUG [src.node.waku_node] Stopping container with id 40a961b8c3ca
2025-02-04 17:24:41.649 DEBUG [src.node.waku_node] Container stopped.
2025-02-04 17:24:41.650 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-04 17:24:41.656 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:24:41.658 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-04 17:24:41.659 DEBUG [tests.conftest] Running fixture teardown: attach_logs_on_fail
2025-02-04 17:24:41.659 DEBUG [tests.conftest] Test failed, attempting to attach logs to the allure reports
2025-02-04 17:24:41.659 DEBUG [src.libs.common] Attaching file ./log/docker/node1_2025-02-04_17-24-37__27d0f1c2-b0aa-4fdc-b2df-31ca48a91189__wakuorg_nwaku:latest.log
2025-02-04 17:24:41.660 DEBUG [src.libs.common] Attaching file ./log/docker/node2_2025-02-04_17-24-37__27d0f1c2-b0aa-4fdc-b2df-31ca48a91189__wakuorg_go-waku:latest.log
