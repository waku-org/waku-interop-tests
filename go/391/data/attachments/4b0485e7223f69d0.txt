[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_msg_not_stored_when_ephemeral_true with id: 2024-12-12_03-19-20__be704b3c-f1d7-448b-8440-8ed359403321
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.filter:filter.py:28 Running fixture setup: filter_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-12-12_03-19-20__be704b3c-f1d7-448b-8440-8ed359403321__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-12-12_03-19-20__be704b3c-f1d7-448b-8440-8ed359403321__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node3_2024-12-12_03-19-20__be704b3c-f1d7-448b-8440-8ed359403321__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:388 Start 3 nodes 
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.160.129
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['3982', '3983', '3984', '3985', '3986']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 3982:3982 -p 3983:3983 -p 3984:3984 -p 3985:3985 -p 3986:3986 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=3984 --rest-port=3982 --tcp-port=3983 --discv5-udp-port=3985 --rest-address=0.0.0.0 --nat=extip:172.18.160.129 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b40e46e01a543dd1ba7b87bed7699de5aaeb7ad952fcd6bdc92f13c858d42881 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --store=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.160.129 waku 09220e41b1347095754c296b6e07f58f6f041ed4eec5d69065f99fe03fb306a5
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 09220e41b134. Setting up logs at ./log/docker/node1_2024-12-12_03-19-20__be704b3c-f1d7-448b-8440-8ed359403321__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/go-waku:latest. REST: 3982
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container de07ada1af44. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3982/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QGWxkX12jV9Mu3rxNFaHEJkqfawTlxuZUq3KOYgnmbeTJBqs9asxzxB48_KkVlAeUiE0Tl7vrtPY7lvzPQ7vSJeGAZO44Mz-gmlkgnY0gmlwhKwRAAWCcnODAAMAiXNlY3AyNTZrMaECkEvjwNN16wBAXqCun_kYJxPlv4gLZ7jO4MI-WafW4k6DdGNwgg-Pg3VkcIIPkYV3YWt1MgM","listenAddresses":["/ip4/127.0.0.1/tcp/3983/p2p/16Uiu2HAm58wogZSWUs872iwwLNNSgxdmq5PzXtsnB2m55K2bjby7","/ip4/127.0.0.1/tcp/3984/ws/p2p/16Uiu2HAm58wogZSWUs872iwwLNNSgxdmq5PzXtsnB2m55K2bjby7","/ip4/172.17.0.5/tcp/3983/p2p/16Uiu2HAm58wogZSWUs872iwwLNNSgxdmq5PzXtsnB2m55K2bjby7","/ip4/172.17.0.5/tcp/3984/ws/p2p/16Uiu2HAm58wogZSWUs872iwwLNNSgxdmq5PzXtsnB2m55K2bjby7"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.119.136
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['19469', '19470', '19471', '19472', '19473']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 19469:19469 -p 19470:19470 -p 19471:19471 -p 19472:19472 -p 19473:19473 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=19471 --rest-port=19469 --tcp-port=19470 --discv5-udp-port=19472 --rest-address=0.0.0.0 --nat=extip:172.18.119.136 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=1ab2b8be41eaa8f14d7fdeaa2ea8fb475cc3d5a1aeb10dbd3dcfc1e0b4b9f6ec --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=19473 --metrics-logging=true --store=true --relay=true --discv5-bootstrap-node=enr:-J-4QGWxkX12jV9Mu3rxNFaHEJkqfawTlxuZUq3KOYgnmbeTJBqs9asxzxB48_KkVlAeUiE0Tl7vrtPY7lvzPQ7vSJeGAZO44Mz-gmlkgnY0gmlwhKwRAAWCcnODAAMAiXNlY3AyNTZrMaECkEvjwNN16wBAXqCun_kYJxPlv4gLZ7jO4MI-WafW4k6DdGNwgg-Pg3VkcIIPkYV3YWt1MgM
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.119.136 waku d151c3b539944b21acca1d8ec43e5181bb6a83c299a1326ce70e7caae90dd683
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d151c3b53994. Setting up logs at ./log/docker/node2_2024-12-12_03-19-20__be704b3c-f1d7-448b-8440-8ed359403321__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/nwaku:latest. REST: 19469
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19469/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19469/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.119.136/tcp/19470/p2p/16Uiu2HAmDg4qiTe6tScQzMVCSjkMmSN3wf7vAWwCWvzo2MUeu3Vb","/ip4/172.18.119.136/tcp/19471/ws/p2p/16Uiu2HAmDg4qiTe6tScQzMVCSjkMmSN3wf7vAWwCWvzo2MUeu3Vb"],"enrUri":"enr:-L24QI--9dNtS3D6OLLcUPAeK62HAjl-RyFym0vRhcwqpW-DDxNkEe_eZVmW5Wxz1kOQrw_Z9D0iat3ZAFA0d2UuhSMCgmlkgnY0gmlwhKwSd4iKbXVsdGlhZGRyc5YACASsEneIBkwOAAoErBJ3iAZMD90DgnJzhQADAQAAiXNlY3AyNTZrMaEDDyJYPrTZ8NazpKrsD8SvtU4vtZOZYbDK3D2pKG2tB5KDdGNwgkwOg3VkcIJMEIV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.213.209
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['47962', '47963', '47964', '47965', '47966']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:439 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:168 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:170 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 47962:47962 -p 47963:47963 -p 47964:47964 -p 47965:47965 -p 47966:47966 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=47964 --rest-port=47962 --tcp-port=47963 --discv5-udp-port=47965 --rest-address=0.0.0.0 --nat=extip:172.18.213.209 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ea86a86b55c1dbd0bb71f751abd0c4f412f6b19aeaefa25dfdde7330ffca6b8f --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --storenode=/ip4/172.18.119.136/tcp/19470/p2p/16Uiu2HAmDg4qiTe6tScQzMVCSjkMmSN3wf7vAWwCWvzo2MUeu3Vb --discv5-bootstrap-node=enr:-L24QI--9dNtS3D6OLLcUPAeK62HAjl-RyFym0vRhcwqpW-DDxNkEe_eZVmW5Wxz1kOQrw_Z9D0iat3ZAFA0d2UuhSMCgmlkgnY0gmlwhKwSd4iKbXVsdGlhZGRyc5YACASsEneIBkwOAAoErBJ3iAZMD90DgnJzhQADAQAAiXNlY3AyNTZrMaEDDyJYPrTZ8NazpKrsD8SvtU4vtZOZYbDK3D2pKG2tB5KDdGNwgkwOg3VkcIJMEIV3YWt1MgM --pubsub-topic=/waku/2/rs/3/1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.213.209 waku d43782c9bd52d87e2e5ea95b32d7d976e90af16772e32307ec711e9846e2030d
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID d43782c9bd52. Setting up logs at ./log/docker/node3_2024-12-12_03-19-20__be704b3c-f1d7-448b-8440-8ed359403321__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:182 Started container from image wakuorg/go-waku:latest. REST: 47962
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47962/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QFDzF99SvhKjbAcFP38_SPqv1mhVExjqdIzrhbVCCeF9VbfRrVatoBBsBcxMwNwbw_2GoKdhm-uV9vg_5D5e9WWGAZO44NgKgmlkgnY0gmlwhKwRABGCcnOFAAMBAAGJc2VjcDI1NmsxoQKhjT5ic67oRVKF4FTQEstBtx11l87MChnq54ZeRnvGP4N0Y3CCu1uDdWRwgrtdhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/47963/p2p/16Uiu2HAm6JJY3H113VdDPz77RzVdF4YKaPmAaGuDBiGF3Xg85HvE","/ip4/127.0.0.1/tcp/47964/ws/p2p/16Uiu2HAm6JJY3H113VdDPz77RzVdF4YKaPmAaGuDBiGF3Xg85HvE","/ip4/172.17.0.17/tcp/47963/p2p/16Uiu2HAm6JJY3H113VdDPz77RzVdF4YKaPmAaGuDBiGF3Xg85HvE","/ip4/172.17.0.17/tcp/47964/ws/p2p/16Uiu2HAm6JJY3H113VdDPz77RzVdF4YKaPmAaGuDBiGF3Xg85HvE"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:287 REST service is ready !!
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:393 Subscribe node1 ,2 to pubtopic /waku/2/rs/3/1
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3982/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:19469/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:3982/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"id":"16Uiu2HAmDg4qiTe6tScQzMVCSjkMmSN3wf7vAWwCWvzo2MUeu3Vb","multiaddrs":["/ip4/172.18.119.136/tcp/19471/ws/p2p/16Uiu2HAmDg4qiTe6tScQzMVCSjkMmSN3wf7vAWwCWvzo2MUeu3Vb","/ip4/172.18.119.136/tcp/19470/p2p/16Uiu2HAmDg4qiTe6tScQzMVCSjkMmSN3wf7vAWwCWvzo2MUeu3Vb"],"protocols":null,"connected":false,"pubsubTopics":[]}]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:19469/admin/v1/peers" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"multiaddr":"/ip4/172.17.0.17/tcp/47963/p2p/16Uiu2HAm6JJY3H113VdDPz77RzVdF4YKaPmAaGuDBiGF3Xg85HvE","protocols":[{"protocol":"/vac/waku/peer-exchange/2.0.0-alpha1","connected":true}],"origin":"UnknownOrigin"}]'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 30 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:398 Node1 publish message with flag ephemeral = True
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:3982/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)', "ephemeral": true}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 3 seconds
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:403 Node3 makes store request to get messages
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:47962/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F1&contentTopics=%2Ftest%2F1%2Fwaku-filter%2Fproto&pageSize=50&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"7481771de3fe1a13d784837d426000710e620dffb3ee110a803becf23b0188af","status_code":200,"status_desc":"OK"}'
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:407 Response for store when ephemeral = true is strPeer wakuorg/go-waku:latest couldn't find any messages. Actual response: {'request_id': '7481771de3fe1a13d784837d426000710e620dffb3ee110a803becf23b0188af', 'status_code': 200, 'status_desc': 'OK'}
[35mDEBUG   [0m tests.e2e.test_e2e:test_e2e.py:409 Message isn't stored as ephemeral = True
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id 09220e41b134
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d151c3b53994
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 09220e41b134. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:226 Stopping container with id d43782c9bd52
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container d151c3b53994. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:233 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.