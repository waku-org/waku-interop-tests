2025-02-14 03:10:08.456 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:10:08.458 DEBUG [tests.conftest] Running test: test_light_push_with_valid_meta with id: 2025-02-14_03-10-08__09d8db81-820d-4a42-8176-8a922c7ad001
2025-02-14 03:10:08.459 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:10:08.459 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-14 03:10:08.467 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:10:08.467 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-14_03-10-08__09d8db81-820d-4a42-8176-8a922c7ad001__wakuorg_nwaku:latest.log
2025-02-14 03:10:08.467 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:10:08.467 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:10:08.469 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:10:08.469 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.63.116
2025-02-14 03:10:08.469 DEBUG [src.node.docker_mananger] Generated ports ['51895', '51896', '51897', '51898', '51899']
2025-02-14 03:10:08.469 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:10:08.469 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:10:08.470 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:10:08.470 DEBUG [src.node.docker_mananger] docker run -i -t -p 51895:51895 -p 51896:51896 -p 51897:51897 -p 51898:51898 -p 51899:51899 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=51897 --rest-port=51895 --tcp-port=51896 --discv5-udp-port=51898 --rest-address=0.0.0.0 --nat=extip:172.18.63.116 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cacece1ce724574c7afdb76a15b10ac76e0ce1af637a140d35edcc5ceb4a2405 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=51899 --metrics-logging=true --lightpush=true --relay=true
2025-02-14 03:10:08.699 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.63.116 waku bc606555ebbd8c545ea979c62a8edd7e838eb5d931d1cf5353b76bd2346d1503
2025-02-14 03:10:08.718 ERROR [src.node.docker_mananger] Max retries reached for container bf3c1dd7f313. Exiting log stream.
2025-02-14 03:10:08.756 DEBUG [src.node.docker_mananger] Container started with ID bc606555ebbd. Setting up logs at ./log/docker/receiving_node1_2025-02-14_03-10-08__09d8db81-820d-4a42-8176-8a922c7ad001__wakuorg_nwaku:latest.log
2025-02-14 03:10:08.756 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 51895
2025-02-14 03:10:08.757 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:10:09.271 ERROR [src.node.docker_mananger] Max retries reached for container d32eaa308b33. Exiting log stream.
2025-02-14 03:10:09.758 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51895/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:10:09.761 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:10:09.761 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:10:09.761 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51895/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:10:09.763 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.63.116/tcp/51896/p2p/16Uiu2HAm992e3frqMfwGnMtoCRPLFiobh5thUzBpb2wXuNBqumW3","/ip4/172.18.63.116/tcp/51897/ws/p2p/16Uiu2HAm992e3frqMfwGnMtoCRPLFiobh5thUzBpb2wXuNBqumW3"],"enrUri":"enr:-L24QMPv41fJreTlM9tFdqUDZJn9oxItDGCu9o8FrPU_I_UlAl1lgpYKxvzWPd0_H8j7z9f8mGm2balcfFdyOy4sNMACgmlkgnY0gmlwhKwSP3SKbXVsdGlhZGRyc5YACASsEj90Bsq4AAoErBI_dAbKud0DgnJzhQADAQAAiXNlY3AyNTZrMaECy8AaYEHtjCQbcLYIoJytf9LEs6ANwF3pNAs-_jFW52SDdGNwgsq4g3VkcILKuoV3YWt1Mgk"}'
2025-02-14 03:10:09.764 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:10:09.771 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:10:09.771 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-14_03-10-08__09d8db81-820d-4a42-8176-8a922c7ad001__wakuorg_nwaku:latest.log
2025-02-14 03:10:09.771 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:10:09.771 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:10:09.772 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:10:09.773 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.138.204
2025-02-14 03:10:09.773 DEBUG [src.node.docker_mananger] Generated ports ['60889', '60890', '60891', '60892', '60893']
2025-02-14 03:10:09.773 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:10:09.773 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:10:09.773 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:10:09.773 DEBUG [src.node.docker_mananger] docker run -i -t -p 60889:60889 -p 60890:60890 -p 60891:60891 -p 60892:60892 -p 60893:60893 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=60891 --rest-port=60889 --tcp-port=60890 --discv5-udp-port=60892 --rest-address=0.0.0.0 --nat=extip:172.18.138.204 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cbb764adf2dd16e1feb6a5f7acff177ec0bf7a5488d5fa9ab254203e069c011c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=60893 --metrics-logging=true --lightpush=false --relay=true
2025-02-14 03:10:09.998 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.138.204 waku 661f33721c183d4410d596ccd15b3ca5cc8e8b33d122a381090b89cda6c840a8
2025-02-14 03:10:10.046 DEBUG [src.node.docker_mananger] Container started with ID 661f33721c18. Setting up logs at ./log/docker/receiving_node2_2025-02-14_03-10-08__09d8db81-820d-4a42-8176-8a922c7ad001__wakuorg_nwaku:latest.log
2025-02-14 03:10:10.047 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 60889
2025-02-14 03:10:10.047 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:10:11.047 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60889/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:10:11.050 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:10:11.050 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:10:11.050 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60889/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:10:11.053 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.138.204/tcp/60890/p2p/16Uiu2HAm2kJWpLKNEMUS49kkL25ZAdfCxkpNzNiDJkAwcZ3ZVRVR","/ip4/172.18.138.204/tcp/60891/ws/p2p/16Uiu2HAm2kJWpLKNEMUS49kkL25ZAdfCxkpNzNiDJkAwcZ3ZVRVR"],"enrUri":"enr:-L24QC9p4cvJXqum_mgbnjkz16PxasRwQW7kmPcROfzsWo-SLk52_GHQpLJOC1HXRWog6-cURKwN9B2LZ0JcFt0xAdICgmlkgnY0gmlwhKwSisyKbXVsdGlhZGRyc5YACASsEorMBu3aAAoErBKKzAbt290DgnJzhQADAQAAiXNlY3AyNTZrMaECbMeSu5ozRiDfoG7WbKrWlGuvpV5BTwkcoNM8HaaNVvCDdGNwgu3ag3VkcILt3IV3YWt1MgE"}'
2025-02-14 03:10:11.053 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:10:11.053 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60889/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.63.116/tcp/51896/p2p/16Uiu2HAm992e3frqMfwGnMtoCRPLFiobh5thUzBpb2wXuNBqumW3"]'
2025-02-14 03:10:11.093 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:10:11.101 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:10:11.102 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-14_03-10-08__09d8db81-820d-4a42-8176-8a922c7ad001__wakuorg_go-waku:latest.log
2025-02-14 03:10:11.102 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:10:11.102 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:10:11.104 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:10:11.104 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.19.150
2025-02-14 03:10:11.104 DEBUG [src.node.docker_mananger] Generated ports ['41233', '41234', '41235', '41236', '41237']
2025-02-14 03:10:11.104 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:10:11.104 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:10:11.104 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:10:11.104 DEBUG [src.node.docker_mananger] docker run -i -t -p 41233:41233 -p 41234:41234 -p 41235:41235 -p 41236:41236 -p 41237:41237 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=41235 --rest-port=41233 --tcp-port=41234 --discv5-udp-port=41236 --rest-address=0.0.0.0 --nat=extip:172.18.19.150 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=45dea4a4f717dfeccaa7c24e1cec5f6d07e0bb4c093fd5ad61212847ef384d7d --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QMPv41fJreTlM9tFdqUDZJn9oxItDGCu9o8FrPU_I_UlAl1lgpYKxvzWPd0_H8j7z9f8mGm2balcfFdyOy4sNMACgmlkgnY0gmlwhKwSP3SKbXVsdGlhZGRyc5YACASsEj90Bsq4AAoErBI_dAbKud0DgnJzhQADAQAAiXNlY3AyNTZrMaECy8AaYEHtjCQbcLYIoJytf9LEs6ANwF3pNAs-_jFW52SDdGNwgsq4g3VkcILKuoV3YWt1Mgk --lightpushnode=/ip4/172.18.63.116/tcp/51896/p2p/16Uiu2HAm992e3frqMfwGnMtoCRPLFiobh5thUzBpb2wXuNBqumW3 --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-14 03:10:11.347 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.19.150 waku 1fd7c4ac4928e3635c529d3a22f7fe3b4df8503f99c985c297a3c5a8376eba78
2025-02-14 03:10:11.402 DEBUG [src.node.docker_mananger] Container started with ID 1fd7c4ac4928. Setting up logs at ./log/docker/lightpush_node1_2025-02-14_03-10-08__09d8db81-820d-4a42-8176-8a922c7ad001__wakuorg_go-waku:latest.log
2025-02-14 03:10:11.403 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 41233
2025-02-14 03:10:11.403 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:10:12.404 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:41233/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:10:12.406 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QDjxKuel3rPrNRgDhX3ZxnfjXiosE2AHDcJVYLU3x-xidaPw-00jW72cAMN1K0iQq2cppAC0bBHCz7mQXHV1zmKGAZUCb2vAgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQPWBguJYFBiCcDfGt6eRsrW7vNcO8mnzcJznH_ZTaTgOIN0Y3CCoRKDdWRwgqEUhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/41234/p2p/16Uiu2HAmT4SwifF86e5bZJGpSasUbaLThe1hhfuEZf56pK2q21o5","/ip4/127.0.0.1/tcp/41235/ws/p2p/16Uiu2HAmT4SwifF86e5bZJGpSasUbaLThe1hhfuEZf56pK2q21o5","/ip4/172.17.0.4/tcp/41234/p2p/16Uiu2HAmT4SwifF86e5bZJGpSasUbaLThe1hhfuEZf56pK2q21o5","/ip4/172.17.0.4/tcp/41235/ws/p2p/16Uiu2HAmT4SwifF86e5bZJGpSasUbaLThe1hhfuEZf56pK2q21o5"]}'
2025-02-14 03:10:12.407 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:10:12.407 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41233/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.63.116/tcp/51896/p2p/16Uiu2HAm992e3frqMfwGnMtoCRPLFiobh5thUzBpb2wXuNBqumW3", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:10:12.409 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:10:12.409 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41233/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.138.204/tcp/60890/p2p/16Uiu2HAm2kJWpLKNEMUS49kkL25ZAdfCxkpNzNiDJkAwcZ3ZVRVR", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:10:12.426 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:10:12.427 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:51895/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-14 03:10:12.432 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:10:12.433 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:60889/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-14 03:10:12.437 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:10:12.439 DEBUG [src.steps.light_push] Lightpushing message
2025-02-14 03:10:12.439 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:41233/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739502612439000576, "meta": "TGlnaHQgcHVzaCB3b3JrcyEh"}}'
2025-02-14 03:10:12.447 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-14 03:10:12.448 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:10:12.548 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-14 03:10:12.548 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:51895/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:10:12.551 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739502612439000576,"meta":"TGlnaHQgcHVzaCB3b3JrcyEh","ephemeral":false}]'
2025-02-14 03:10:12.553 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-14 03:10:12.553 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:60889/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:10:12.555 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1739502612439000576,"meta":"TGlnaHQgcHVzaCB3b3JrcyEh","ephemeral":false}]'
2025-02-14 03:10:12.558 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:10:12.560 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:10:12.560 DEBUG [src.node.waku_node] Stopping container with id bc606555ebbd
2025-02-14 03:10:13.178 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:10:13.179 DEBUG [src.node.waku_node] Stopping container with id 661f33721c18
2025-02-14 03:10:13.991 ERROR [src.node.docker_mananger] Max retries reached for container bc606555ebbd. Exiting log stream.
2025-02-14 03:10:14.728 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:10:14.729 DEBUG [src.node.waku_node] Stopping container with id 1fd7c4ac4928
2025-02-14 03:10:15.212 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:10:15.213 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:10:15.221 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:10:15.228 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:10:15.230 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
