2025-02-14 03:07:51.051 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:07:51.052 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-14_03-07-51__5d37e2cc-fe91-42fe-9a5b-e9f57ff807c8
2025-02-14 03:07:51.052 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:07:51.052 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-14 03:07:51.053 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-14 03:07:51.053 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 03:07:51.053 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-14 03:07:51.060 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:07:51.060 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-14_03-07-51__5d37e2cc-fe91-42fe-9a5b-e9f57ff807c8__wakuorg_nwaku:latest.log
2025-02-14 03:07:51.060 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:51.060 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:51.062 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:51.062 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.77.150
2025-02-14 03:07:51.062 DEBUG [src.node.docker_mananger] Generated ports ['21226', '21227', '21228', '21229', '21230']
2025-02-14 03:07:51.062 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:51.062 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:51.062 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:51.062 DEBUG [src.node.docker_mananger] docker run -i -t -p 21226:21226 -p 21227:21227 -p 21228:21228 -p 21229:21229 -p 21230:21230 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21228 --rest-port=21226 --tcp-port=21227 --discv5-udp-port=21229 --rest-address=0.0.0.0 --nat=extip:172.18.77.150 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cff3bc65c0affe6c8ca73eff8744df0aa969f1fc5e99efe1ed4fbaefae16f2b2 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21230 --metrics-logging=true --lightpush=true --relay=true
2025-02-14 03:07:51.276 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.77.150 waku 10bcf6cb579756342ef49c09f5121180f471f146207523f86160aa3cdc6e67d8
2025-02-14 03:07:51.325 DEBUG [src.node.docker_mananger] Container started with ID 10bcf6cb5797. Setting up logs at ./log/docker/receiving_node1_2025-02-14_03-07-51__5d37e2cc-fe91-42fe-9a5b-e9f57ff807c8__wakuorg_nwaku:latest.log
2025-02-14 03:07:51.325 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 21226
2025-02-14 03:07:51.325 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:51.373 ERROR [src.node.docker_mananger] Max retries reached for container e792647ffb68. Exiting log stream.
2025-02-14 03:07:51.855 ERROR [src.node.docker_mananger] Max retries reached for container 7e0a9f1a4c91. Exiting log stream.
2025-02-14 03:07:52.327 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21226/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:52.330 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:07:52.330 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:07:52.330 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21226/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:52.332 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.77.150/tcp/21227/p2p/16Uiu2HAm4t2L79xJwWKMrdNJsQDaycP3egJ1prGqnxUs2dnEXTwp","/ip4/172.18.77.150/tcp/21228/ws/p2p/16Uiu2HAm4t2L79xJwWKMrdNJsQDaycP3egJ1prGqnxUs2dnEXTwp"],"enrUri":"enr:-L24QHSD-y-VomxpA-EPZ3GsjU9JpC-My5i6pqY0Oz-D4vCVNLQSlQeHBLV-uFTHxMStvXBDtSy_YtUHaGfJJU5M3KcCgmlkgnY0gmlwhKwSTZaKbXVsdGlhZGRyc5YACASsEk2WBlLrAAoErBJNlgZS7N0DgnJzhQADAQAAiXNlY3AyNTZrMaECjHlLH7qIaSU47GK2gRXYoiFY9Ev8KOjzjawmIpDlqTODdGNwglLrg3VkcIJS7YV3YWt1Mgk"}'
2025-02-14 03:07:52.332 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:52.339 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:07:52.339 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-14_03-07-51__5d37e2cc-fe91-42fe-9a5b-e9f57ff807c8__wakuorg_nwaku:latest.log
2025-02-14 03:07:52.339 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:52.339 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:52.340 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:52.341 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.215.253
2025-02-14 03:07:52.341 DEBUG [src.node.docker_mananger] Generated ports ['29866', '29867', '29868', '29869', '29870']
2025-02-14 03:07:52.341 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:52.341 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:52.341 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:52.341 DEBUG [src.node.docker_mananger] docker run -i -t -p 29866:29866 -p 29867:29867 -p 29868:29868 -p 29869:29869 -p 29870:29870 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=29868 --rest-port=29866 --tcp-port=29867 --discv5-udp-port=29869 --rest-address=0.0.0.0 --nat=extip:172.18.215.253 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=a10db7eb4e1f8153dd474699bd5e1ab0ffaefd707ea0da20feea7ba8ebbb0da4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=29870 --metrics-logging=true --lightpush=false --relay=true
2025-02-14 03:07:52.564 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.215.253 waku 4e0d79c0bcc0a19ddd7bc457639f1967c707d63572f472ace9358a6e4036d5bd
2025-02-14 03:07:52.613 DEBUG [src.node.docker_mananger] Container started with ID 4e0d79c0bcc0. Setting up logs at ./log/docker/receiving_node2_2025-02-14_03-07-51__5d37e2cc-fe91-42fe-9a5b-e9f57ff807c8__wakuorg_nwaku:latest.log
2025-02-14 03:07:52.613 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 29866
2025-02-14 03:07:52.614 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:53.615 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29866/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:53.617 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:07:53.618 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:07:53.618 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:29866/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:53.620 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.215.253/tcp/29867/p2p/16Uiu2HAmCttmWezc9TKiUyZwEadWkD1NEJRhdunRA1Wto5c5f2dS","/ip4/172.18.215.253/tcp/29868/ws/p2p/16Uiu2HAmCttmWezc9TKiUyZwEadWkD1NEJRhdunRA1Wto5c5f2dS"],"enrUri":"enr:-L24QK9qynXoTlWB7zzn_g0gZNHJd4-PCPMG9WtEKG0GBNIBQ_jGbSG0vqB00qCXssHpxiPcXnNoogP5VFYxcgBUvucCgmlkgnY0gmlwhKwS1_2KbXVsdGlhZGRyc5YACASsEtf9BnSrAAoErBLX_QZ0rN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDA4_RvqRFVBwTILkxky0Pt-7xaUxg_fIEDdGEVJCpaXWDdGNwgnSrg3VkcIJ0rYV3YWt1MgE"}'
2025-02-14 03:07:53.620 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:53.620 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29866/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.77.150/tcp/21227/p2p/16Uiu2HAm4t2L79xJwWKMrdNJsQDaycP3egJ1prGqnxUs2dnEXTwp"]'
2025-02-14 03:07:53.659 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:53.668 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:07:53.669 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-14_03-07-51__5d37e2cc-fe91-42fe-9a5b-e9f57ff807c8__wakuorg_go-waku:latest.log
2025-02-14 03:07:53.669 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:53.669 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:53.676 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:53.677 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.207.238
2025-02-14 03:07:53.677 DEBUG [src.node.docker_mananger] Generated ports ['35720', '35721', '35722', '35723', '35724']
2025-02-14 03:07:53.677 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:53.677 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:53.677 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:53.677 DEBUG [src.node.docker_mananger] docker run -i -t -p 35720:35720 -p 35721:35721 -p 35722:35722 -p 35723:35723 -p 35724:35724 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=35722 --rest-port=35720 --tcp-port=35721 --discv5-udp-port=35723 --rest-address=0.0.0.0 --nat=extip:172.18.207.238 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3f00e21b70bdce815fb4bab3152f32a5f0eb8be0433e2bd36a5b157714297a9a --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QHSD-y-VomxpA-EPZ3GsjU9JpC-My5i6pqY0Oz-D4vCVNLQSlQeHBLV-uFTHxMStvXBDtSy_YtUHaGfJJU5M3KcCgmlkgnY0gmlwhKwSTZaKbXVsdGlhZGRyc5YACASsEk2WBlLrAAoErBJNlgZS7N0DgnJzhQADAQAAiXNlY3AyNTZrMaECjHlLH7qIaSU47GK2gRXYoiFY9Ev8KOjzjawmIpDlqTODdGNwglLrg3VkcIJS7YV3YWt1Mgk --lightpushnode=/ip4/172.18.77.150/tcp/21227/p2p/16Uiu2HAm4t2L79xJwWKMrdNJsQDaycP3egJ1prGqnxUs2dnEXTwp --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-14 03:07:53.915 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.207.238 waku 9e989d468f72a3adcd100b5973707cf6303e7468e8a4cb44f6ebfdbfd50ef876
2025-02-14 03:07:53.969 DEBUG [src.node.docker_mananger] Container started with ID 9e989d468f72. Setting up logs at ./log/docker/lightpush_node1_2025-02-14_03-07-51__5d37e2cc-fe91-42fe-9a5b-e9f57ff807c8__wakuorg_go-waku:latest.log
2025-02-14 03:07:53.970 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 35720
2025-02-14 03:07:53.970 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:54.971 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:35720/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:54.973 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QCoBj15A8l3BCtEiEc3vfJH1dK_qPC916wMAO8jyip8FeyAjGwjfLn3KmW5_QLOnsQmSzy09nRe_DOrMHJXeEKiGAZUCbVLogmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQIlxwJFKuFF9MDEqpfv7Xt3DDOzfJN6GoVbPuVjroLOQoN0Y3CCi4mDdWRwgouLhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/35721/p2p/16Uiu2HAkwy94yH4R7mY3xYJD3J5y3LRJc2bqM719MjoCPm4cVh6H","/ip4/127.0.0.1/tcp/35722/ws/p2p/16Uiu2HAkwy94yH4R7mY3xYJD3J5y3LRJc2bqM719MjoCPm4cVh6H","/ip4/172.17.0.4/tcp/35721/p2p/16Uiu2HAkwy94yH4R7mY3xYJD3J5y3LRJc2bqM719MjoCPm4cVh6H","/ip4/172.17.0.4/tcp/35722/ws/p2p/16Uiu2HAkwy94yH4R7mY3xYJD3J5y3LRJc2bqM719MjoCPm4cVh6H"]}'
2025-02-14 03:07:54.974 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:54.974 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35720/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.77.150/tcp/21227/p2p/16Uiu2HAm4t2L79xJwWKMrdNJsQDaycP3egJ1prGqnxUs2dnEXTwp", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:07:54.976 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:54.976 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35720/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.215.253/tcp/29867/p2p/16Uiu2HAmCttmWezc9TKiUyZwEadWkD1NEJRhdunRA1Wto5c5f2dS", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:07:54.990 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:54.992 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:21226/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:55.002 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:55.002 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:29866/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:55.008 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:55.009 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:35720/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1739502475009446400}}'
2025-02-14 03:07:55.016 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-14 03:07:55.017 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-14 03:07:55.517 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:21226/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:55.520 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502475009446400,"ephemeral":false}]'
2025-02-14 03:07:55.520 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-14 03:08:00.521 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-14 03:08:00.524 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-14 03:08:00.525 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-14 03:08:00.528 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-14 03:08:00.528 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-14 03:08:00.531 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-14 03:08:00.531 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-14 03:08:00.534 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-14 03:08:00.534 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-14 03:08:00.537 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-14 03:08:00.537 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-14 03:08:00.540 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-14 03:08:00.541 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-14 03:08:00.543 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-14 03:08:00.545 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:08:00.546 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:08:00.546 DEBUG [src.node.waku_node] Stopping container with id 10bcf6cb5797
2025-02-14 03:08:01.102 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:08:01.102 DEBUG [src.node.waku_node] Stopping container with id 4e0d79c0bcc0
2025-02-14 03:08:01.914 ERROR [src.node.docker_mananger] Max retries reached for container 10bcf6cb5797. Exiting log stream.
2025-02-14 03:08:02.598 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:08:02.598 DEBUG [src.node.waku_node] Stopping container with id 9e989d468f72
2025-02-14 03:08:03.080 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:08:03.082 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:08:03.090 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:08:03.097 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:08:03.100 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
