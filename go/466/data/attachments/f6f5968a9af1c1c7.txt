2025-02-14 03:07:13.153 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:07:13.153 DEBUG [tests.conftest] Running test: test_filter_subscribe_to_pubsub_topics_from_multiple_clusters with id: 2025-02-14_03-07-13__f7714305-7a4b-4752-a47c-9fad9d41a327
2025-02-14 03:07:13.154 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:07:13.154 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-14 03:07:13.154 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-14 03:07:13.160 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:07:13.160 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_03-07-13__f7714305-7a4b-4752-a47c-9fad9d41a327__wakuorg_nwaku:latest.log
2025-02-14 03:07:13.160 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:13.160 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:13.161 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:13.161 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.107.221
2025-02-14 03:07:13.162 DEBUG [src.node.docker_mananger] Generated ports ['43200', '43201', '43202', '43203', '43204']
2025-02-14 03:07:13.162 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:13.162 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:13.162 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:13.162 DEBUG [src.node.docker_mananger] docker run -i -t -p 43200:43200 -p 43201:43201 -p 43202:43202 -p 43203:43203 -p 43204:43204 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=43202 --rest-port=43200 --tcp-port=43201 --discv5-udp-port=43203 --rest-address=0.0.0.0 --nat=extip:172.18.107.221 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5334bf9ec9d2da828db5485cbf6ebae3da3f1e2bdcbb6c6d80dc0dfacabc8658 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=43204 --metrics-logging=true --relay=true --filter=true
2025-02-14 03:07:13.389 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.107.221 waku 0cc9dd2de63ceaff36732a44e2762fc7341c97df7dc8b38c204728fe92f95357
2025-02-14 03:07:13.442 DEBUG [src.node.docker_mananger] Container started with ID 0cc9dd2de63c. Setting up logs at ./log/docker/node1_2025-02-14_03-07-13__f7714305-7a4b-4752-a47c-9fad9d41a327__wakuorg_nwaku:latest.log
2025-02-14 03:07:13.442 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 43200
2025-02-14 03:07:13.444 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:13.960 ERROR [src.node.docker_mananger] Max retries reached for container 04b2de1f4f00. Exiting log stream.
2025-02-14 03:07:14.444 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43200/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:14.447 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:07:14.447 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:07:14.448 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43200/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:14.450 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.107.221/tcp/43201/p2p/16Uiu2HAmRg9oRfqFg8VjZmvDPPrKVLcumowNa92WkQtofgBcfahm","/ip4/172.18.107.221/tcp/43202/ws/p2p/16Uiu2HAmRg9oRfqFg8VjZmvDPPrKVLcumowNa92WkQtofgBcfahm"],"enrUri":"enr:-L24QPvwzA6QisXduqRzgKcowAO65lRbrThwjV2hY44GQg_9BIbQcdtwrJtHotdGygOxfnGIks6Bumb9K_KIDuKhY2sCgmlkgnY0gmlwhKwSa92KbXVsdGlhZGRyc5YACASsEmvdBqjBAAoErBJr3Qaowt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwXQyW3N-4agb5RI97FbmO8BLcbp6UBgMw5w1pqZUYQCDdGNwgqjBg3VkcIKow4V3YWt1MgU"}'
2025-02-14 03:07:14.450 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:14.450 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-14 03:07:14.456 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:07:14.456 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-14_03-07-13__f7714305-7a4b-4752-a47c-9fad9d41a327__wakuorg_go-waku:latest.log
2025-02-14 03:07:14.457 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:14.457 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:14.458 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:14.458 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.205.193
2025-02-14 03:07:14.458 DEBUG [src.node.docker_mananger] Generated ports ['2964', '2965', '2966', '2967', '2968']
2025-02-14 03:07:14.458 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:14.459 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:14.459 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:14.459 DEBUG [src.node.docker_mananger] docker run -i -t -p 2964:2964 -p 2965:2965 -p 2966:2966 -p 2967:2967 -p 2968:2968 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=2966 --rest-port=2964 --tcp-port=2965 --discv5-udp-port=2967 --rest-address=0.0.0.0 --nat=extip:172.18.205.193 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fc146ee4d64fb04a30aeef5849dce70dbdeed3e8fff2493dcbdabcac2570a7bb --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QPvwzA6QisXduqRzgKcowAO65lRbrThwjV2hY44GQg_9BIbQcdtwrJtHotdGygOxfnGIks6Bumb9K_KIDuKhY2sCgmlkgnY0gmlwhKwSa92KbXVsdGlhZGRyc5YACASsEmvdBqjBAAoErBJr3Qaowt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDwXQyW3N-4agb5RI97FbmO8BLcbp6UBgMw5w1pqZUYQCDdGNwgqjBg3VkcIKow4V3YWt1MgU --filternode=/ip4/172.18.107.221/tcp/43201/p2p/16Uiu2HAmRg9oRfqFg8VjZmvDPPrKVLcumowNa92WkQtofgBcfahm --pubsub-topic=/waku/2/rs/3/1
2025-02-14 03:07:14.687 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.205.193 waku 242991d6262bdcab01018c7031659ce14c327afe5c6e931bc9f70af65523f199
2025-02-14 03:07:14.740 DEBUG [src.node.docker_mananger] Container started with ID 242991d6262b. Setting up logs at ./log/docker/node2_2025-02-14_03-07-13__f7714305-7a4b-4752-a47c-9fad9d41a327__wakuorg_go-waku:latest.log
2025-02-14 03:07:14.740 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 2964
2025-02-14 03:07:14.741 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:15.741 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2964/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:15.744 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QKbe9PdY3ZCRs5cnL96AiVykyam8l9VQqZgxfdF0kxYEYpitJbx0QYd7ZMrzrTDCYGOsGXB-NIijgBs79yx7rJWGAZUCbLmngmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQMvhhLmb_X96w9gnwXQYi4RCGhIwskaUYc5KHvqxHjVwIN0Y3CCC5WDdWRwgguXhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/2965/p2p/16Uiu2HAmFrW64GrDzaJcLrz8aerdftJpb76sewUYparS4E3Dgdg3","/ip4/127.0.0.1/tcp/2966/ws/p2p/16Uiu2HAmFrW64GrDzaJcLrz8aerdftJpb76sewUYparS4E3Dgdg3","/ip4/172.17.0.3/tcp/2965/p2p/16Uiu2HAmFrW64GrDzaJcLrz8aerdftJpb76sewUYparS4E3Dgdg3","/ip4/172.17.0.3/tcp/2966/ws/p2p/16Uiu2HAmFrW64GrDzaJcLrz8aerdftJpb76sewUYparS4E3Dgdg3"]}'
2025-02-14 03:07:15.744 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:15.745 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2964/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.107.221/tcp/43201/p2p/16Uiu2HAmRg9oRfqFg8VjZmvDPPrKVLcumowNa92WkQtofgBcfahm", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:07:15.747 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:15.748 DEBUG [tests.filter.test_subscribe_create] Running test with pubsub topic: /waku/2/rs/3/1
2025-02-14 03:07:15.748 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43200/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:15.751 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:15.751 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2964/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "2b6ce161-be4a-4439-afa8-6863c04eab18", "contentFilters": ["/waku/2/rs/3/1"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-14 03:07:15.757 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"2b6ce161-be4a-4439-afa8-6863c04eab18","statusDesc":"OK"}'
2025-02-14 03:07:15.758 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43200/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/waku/2/rs/3/1", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:15.765 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:15.765 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:15.866 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:15.866 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2964/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:15.868 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/waku/2/rs/3/1","version":0,"timestamp":1739502435758597888,"ephemeral":false}]'
2025-02-14 03:07:15.870 DEBUG [tests.filter.test_subscribe_create] Running test with pubsub topic: /waku/2/rs/2/2
2025-02-14 03:07:15.870 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43200/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/2"]'
2025-02-14 03:07:15.873 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:15.873 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2964/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ffe32d8a-ef9c-47f6-b871-8b266f4894ad", "contentFilters": ["/waku/2/rs/2/2"], "pubsubTopic": "/waku/2/rs/2/2"}'
2025-02-14 03:07:36.928 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2964/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ffe32d8a-ef9c-47f6-b871-8b266f4894ad", "contentFilters": ["/waku/2/rs/2/2"], "pubsubTopic": "/waku/2/rs/2/2"}'
2025-02-14 03:07:57.935 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2964/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "ffe32d8a-ef9c-47f6-b871-8b266f4894ad", "contentFilters": ["/waku/2/rs/2/2"], "pubsubTopic": "/waku/2/rs/2/2"}'
2025-02-14 03:08:17.943 ERROR [tests.filter.test_subscribe_create] PubsubTopic /waku/2/rs/2/2 failed: HTTPConnectionPool(host='127.0.0.1', port=2964): Read timed out. (read timeout=20)
2025-02-14 03:08:17.943 DEBUG [tests.filter.test_subscribe_create] Running test with pubsub topic: /waku/2/rs/3/9
2025-02-14 03:08:17.943 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43200/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/9"]'
2025-02-14 03:08:17.947 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:08:17.948 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2964/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "898a0405-4855-4e89-ab88-d681eb36c6a1", "contentFilters": ["/waku/2/rs/3/9"], "pubsubTopic": "/waku/2/rs/3/9"}'
2025-02-14 03:08:22.368 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"898a0405-4855-4e89-ab88-d681eb36c6a1","statusDesc":"OK"}'
2025-02-14 03:08:22.369 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43200/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F9" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/waku/2/rs/3/9", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:08:22.378 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:08:22.378 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:08:22.479 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:08:22.479 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2964/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F9/%2Fwaku%2F2%2Frs%2F3%2F9" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:08:22.481 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/waku/2/rs/3/9","version":0,"timestamp":1739502502369440768,"ephemeral":false}]'
2025-02-14 03:08:22.536 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:08:22.537 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:08:22.537 DEBUG [src.node.waku_node] Stopping container with id 0cc9dd2de63c
2025-02-14 03:08:23.040 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:08:23.040 DEBUG [src.node.waku_node] Stopping container with id 242991d6262b
2025-02-14 03:08:23.892 ERROR [src.node.docker_mananger] Max retries reached for container 0cc9dd2de63c. Exiting log stream.
2025-02-14 03:08:33.518 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:08:33.520 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:08:33.545 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:08:33.549 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
