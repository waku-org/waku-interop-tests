2025-02-14 03:07:23.459 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:07:23.460 DEBUG [tests.conftest] Running test: test_relay_subscribe_to_already_existing_pubsub_topic with id: 2025-02-14_03-07-23__176f405f-e61d-4ea7-9d61-14729177f79b
2025-02-14 03:07:23.461 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:07:23.461 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 03:07:23.463 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-14 03:07:23.470 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:07:23.470 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_03-07-23__176f405f-e61d-4ea7-9d61-14729177f79b__wakuorg_nwaku:latest.log
2025-02-14 03:07:23.470 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:23.470 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:23.472 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:23.472 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.44.154
2025-02-14 03:07:23.472 DEBUG [src.node.docker_mananger] Generated ports ['54102', '54103', '54104', '54105', '54106']
2025-02-14 03:07:23.472 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:23.472 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:23.472 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:23.473 DEBUG [src.node.docker_mananger] docker run -i -t -p 54102:54102 -p 54103:54103 -p 54104:54104 -p 54105:54105 -p 54106:54106 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=54104 --rest-port=54102 --tcp-port=54103 --discv5-udp-port=54105 --rest-address=0.0.0.0 --nat=extip:172.18.44.154 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fcf20c74cbeb4bc8c4404c135fb8d6f94ec1d5a9cfae9bedee04add77d0bcf36 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=54106 --metrics-logging=true --relay=true
2025-02-14 03:07:23.707 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.44.154 waku ca8fc13f1c4ed211612ba767227157e2d31b40d1b369db28a3fa134161da5493
2025-02-14 03:07:23.738 ERROR [src.node.docker_mananger] Max retries reached for container af3d20f2ccec. Exiting log stream.
2025-02-14 03:07:23.759 DEBUG [src.node.docker_mananger] Container started with ID ca8fc13f1c4e. Setting up logs at ./log/docker/node1_2025-02-14_03-07-23__176f405f-e61d-4ea7-9d61-14729177f79b__wakuorg_nwaku:latest.log
2025-02-14 03:07:23.760 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 54102
2025-02-14 03:07:23.761 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:24.275 ERROR [src.node.docker_mananger] Max retries reached for container f86a58186b1d. Exiting log stream.
2025-02-14 03:07:24.761 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54102/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:24.764 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:07:24.764 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:07:24.764 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54102/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:24.766 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.44.154/tcp/54103/p2p/16Uiu2HAkxaEzmMaXJZNw1cUqQvymgah3yUvCE55TYqAucxgZfsgC","/ip4/172.18.44.154/tcp/54104/ws/p2p/16Uiu2HAkxaEzmMaXJZNw1cUqQvymgah3yUvCE55TYqAucxgZfsgC"],"enrUri":"enr:-L24QOGghHP3GRSLv0RO-BozHsarFFwJbD78Eqyjh-zUL5apLw1x19dDz7cSqJSVkcyJatx4EqsQ5SzFxxST3udl8a0CgmlkgnY0gmlwhKwSLJqKbXVsdGlhZGRyc5YACASsEiyaBtNXAAoErBIsmgbTWN0DgnJzhQADAQAAiXNlY3AyNTZrMaECLsUKF3QWezwXGTWoo4yml2ieRzt5ceXifZkKfUqCRnmDdGNwgtNXg3VkcILTWYV3YWt1MgE"}'
2025-02-14 03:07:24.766 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:24.773 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:07:24.773 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-14_03-07-23__176f405f-e61d-4ea7-9d61-14729177f79b__wakuorg_go-waku:latest.log
2025-02-14 03:07:24.773 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:24.773 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:24.775 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:24.775 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.140.79
2025-02-14 03:07:24.775 DEBUG [src.node.docker_mananger] Generated ports ['14593', '14594', '14595', '14596', '14597']
2025-02-14 03:07:24.775 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:24.775 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:24.775 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:24.775 DEBUG [src.node.docker_mananger] docker run -i -t -p 14593:14593 -p 14594:14594 -p 14595:14595 -p 14596:14596 -p 14597:14597 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=14595 --rest-port=14593 --tcp-port=14594 --discv5-udp-port=14596 --rest-address=0.0.0.0 --nat=extip:172.18.140.79 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=998a8bbb9190fae5fab00845d1df5c3e09df7e75bbd1d5b8b3847d6e9303eef8 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QOGghHP3GRSLv0RO-BozHsarFFwJbD78Eqyjh-zUL5apLw1x19dDz7cSqJSVkcyJatx4EqsQ5SzFxxST3udl8a0CgmlkgnY0gmlwhKwSLJqKbXVsdGlhZGRyc5YACASsEiyaBtNXAAoErBIsmgbTWN0DgnJzhQADAQAAiXNlY3AyNTZrMaECLsUKF3QWezwXGTWoo4yml2ieRzt5ceXifZkKfUqCRnmDdGNwgtNXg3VkcILTWYV3YWt1MgE
2025-02-14 03:07:25.024 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.140.79 waku 218f92a422fb47c3ee74598b2d5772afdfa340abfa2c8771024954419a4dce4f
2025-02-14 03:07:25.080 DEBUG [src.node.docker_mananger] Container started with ID 218f92a422fb. Setting up logs at ./log/docker/node2_2025-02-14_03-07-23__176f405f-e61d-4ea7-9d61-14729177f79b__wakuorg_go-waku:latest.log
2025-02-14 03:07:25.081 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 14593
2025-02-14 03:07:25.081 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:26.081 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14593/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:26.084 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QLh0dUZ6n3GBTpf4t-2Ae_hpKtqXBc53GYhKacMody-uAPIFRcQYsu36xQSma3CsqedO4jVSmzsAexL3XsMhI-6GAZUCbOIOgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECDCrOVmQf5FvQI2EsBjIc5yCu-k7dvRzsVPz2_8Bzbf6DdGNwgjkCg3VkcII5BIV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/14594/p2p/16Uiu2HAkvFAjJit79mYTBXaFqV2JaFHSt5bCZDAKbr6QiPXM3G7w","/ip4/127.0.0.1/tcp/14595/ws/p2p/16Uiu2HAkvFAjJit79mYTBXaFqV2JaFHSt5bCZDAKbr6QiPXM3G7w","/ip4/172.17.0.3/tcp/14594/p2p/16Uiu2HAkvFAjJit79mYTBXaFqV2JaFHSt5bCZDAKbr6QiPXM3G7w","/ip4/172.17.0.3/tcp/14595/ws/p2p/16Uiu2HAkvFAjJit79mYTBXaFqV2JaFHSt5bCZDAKbr6QiPXM3G7w"]}'
2025-02-14 03:07:26.085 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:26.085 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14593/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.44.154/tcp/54103/p2p/16Uiu2HAkxaEzmMaXJZNw1cUqQvymgah3yUvCE55TYqAucxgZfsgC", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:07:26.107 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:26.108 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54102/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:26.130 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:26.131 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14593/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:26.133 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-14 03:07:26.135 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54102/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:26.144 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:26.144 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:26.244 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:26.244 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54102/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:26.247 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502446134844928,"ephemeral":false}]'
2025-02-14 03:07:26.249 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:26.249 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14593/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:26.251 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:27.252 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54102/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:27.256 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:27.257 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:27.357 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:27.357 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54102/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:27.360 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502447251808000,"ephemeral":false}]'
2025-02-14 03:07:27.361 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:27.362 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14593/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:27.363 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502447251808000,"ephemeral":false}]'
2025-02-14 03:07:27.365 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54102/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:27.367 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:27.367 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:14593/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:27.369 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-14 03:07:27.369 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:54102/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:27.373 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:27.373 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:27.474 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:27.474 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:54102/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:27.476 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502447369529856,"ephemeral":false}]'
2025-02-14 03:07:27.478 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:27.478 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:14593/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:27.479 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502447369529856,"ephemeral":false}]'
2025-02-14 03:07:27.482 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:07:27.483 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:07:27.484 DEBUG [src.node.waku_node] Stopping container with id ca8fc13f1c4e
2025-02-14 03:07:28.071 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:07:28.071 DEBUG [src.node.waku_node] Stopping container with id 218f92a422fb
2025-02-14 03:07:28.599 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:07:28.601 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:07:28.608 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:07:28.611 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
