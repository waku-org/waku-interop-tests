2025-02-14 03:07:10.103 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:07:10.104 DEBUG [tests.conftest] Running test: test_publish_with_no_timestamp with id: 2025-02-14_03-07-10__1bac7704-c050-423c-b9e4-4bf029869b23
2025-02-14 03:07:10.104 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:07:10.104 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 03:07:10.104 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-14 03:07:10.111 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:07:10.111 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_03-07-10__1bac7704-c050-423c-b9e4-4bf029869b23__wakuorg_nwaku:latest.log
2025-02-14 03:07:10.111 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:10.111 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:10.112 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:10.113 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.10.122
2025-02-14 03:07:10.113 DEBUG [src.node.docker_mananger] Generated ports ['44489', '44490', '44491', '44492', '44493']
2025-02-14 03:07:10.113 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:10.113 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:10.113 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:10.113 DEBUG [src.node.docker_mananger] docker run -i -t -p 44489:44489 -p 44490:44490 -p 44491:44491 -p 44492:44492 -p 44493:44493 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=44491 --rest-port=44489 --tcp-port=44490 --discv5-udp-port=44492 --rest-address=0.0.0.0 --nat=extip:172.18.10.122 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=58dc46abe485cf98f2efa092d60f456760f5452cf82b4b136093f48ee05bda4a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=44493 --metrics-logging=true --relay=true
2025-02-14 03:07:10.346 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.10.122 waku 19afd7ee27494b91b764df173f9d44704c6c20c76e9acd2b8d730ef51b787944
2025-02-14 03:07:10.391 DEBUG [src.node.docker_mananger] Container started with ID 19afd7ee2749. Setting up logs at ./log/docker/node1_2025-02-14_03-07-10__1bac7704-c050-423c-b9e4-4bf029869b23__wakuorg_nwaku:latest.log
2025-02-14 03:07:10.392 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 44489
2025-02-14 03:07:10.393 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:10.408 ERROR [src.node.docker_mananger] Max retries reached for container fda801de00a4. Exiting log stream.
2025-02-14 03:07:10.889 ERROR [src.node.docker_mananger] Max retries reached for container 294545658a4f. Exiting log stream.
2025-02-14 03:07:11.393 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44489/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:11.396 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:07:11.396 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:07:11.396 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44489/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:11.398 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.10.122/tcp/44490/p2p/16Uiu2HAmBeAypxc1bo2BCo6EUhM48NmvX3NdeGFD7rXDdjWfEN3t","/ip4/172.18.10.122/tcp/44491/ws/p2p/16Uiu2HAmBeAypxc1bo2BCo6EUhM48NmvX3NdeGFD7rXDdjWfEN3t"],"enrUri":"enr:-L24QBT6gUUg9AZR2bw3gLP4aeTUpLAhgdHuPwxLmQ6xVma3CisjrgD_cpYxIxJ5vPUkq4VK0Nd6aU7mNgJT4uucz8sCgmlkgnY0gmlwhKwSCnqKbXVsdGlhZGRyc5YACASsEgp6Bq3KAAoErBIKegaty90DgnJzhQADAQAAiXNlY3AyNTZrMaEC8O7AaPEBzBCjdJ5D77y78MmRI7vTXtZlXZAiWt0juKODdGNwgq3Kg3VkcIKtzIV3YWt1MgE"}'
2025-02-14 03:07:11.398 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:11.404 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:07:11.405 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-14_03-07-10__1bac7704-c050-423c-b9e4-4bf029869b23__wakuorg_go-waku:latest.log
2025-02-14 03:07:11.405 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:11.405 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:11.406 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:11.406 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.142.86
2025-02-14 03:07:11.406 DEBUG [src.node.docker_mananger] Generated ports ['13371', '13372', '13373', '13374', '13375']
2025-02-14 03:07:11.407 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:11.407 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:11.407 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:11.407 DEBUG [src.node.docker_mananger] docker run -i -t -p 13371:13371 -p 13372:13372 -p 13373:13373 -p 13374:13374 -p 13375:13375 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=13373 --rest-port=13371 --tcp-port=13372 --discv5-udp-port=13374 --rest-address=0.0.0.0 --nat=extip:172.18.142.86 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bedcc3fccccf6f4fdd3a62fdcff4a2cd7271e0a52cf7dc4f77a05b8d09f6d5db --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QBT6gUUg9AZR2bw3gLP4aeTUpLAhgdHuPwxLmQ6xVma3CisjrgD_cpYxIxJ5vPUkq4VK0Nd6aU7mNgJT4uucz8sCgmlkgnY0gmlwhKwSCnqKbXVsdGlhZGRyc5YACASsEgp6Bq3KAAoErBIKegaty90DgnJzhQADAQAAiXNlY3AyNTZrMaEC8O7AaPEBzBCjdJ5D77y78MmRI7vTXtZlXZAiWt0juKODdGNwgq3Kg3VkcIKtzIV3YWt1MgE
2025-02-14 03:07:11.638 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.142.86 waku 0b7c68c572164c18aa9da64c978a79498e6b0b7a4ad412526f1516fe4560379f
2025-02-14 03:07:11.689 DEBUG [src.node.docker_mananger] Container started with ID 0b7c68c57216. Setting up logs at ./log/docker/node2_2025-02-14_03-07-10__1bac7704-c050-423c-b9e4-4bf029869b23__wakuorg_go-waku:latest.log
2025-02-14 03:07:11.690 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 13371
2025-02-14 03:07:11.690 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:12.690 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13371/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:12.693 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QAgld_T1x0R0VgS8ZqghV70X74iYO2xWZFuQsEovkGdVRJAQOU7Z9iZPRWc2G3hwa1ycusm1RVNMsYYLOpOBk2-GAZUCbK3JgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaED96gBN_PIoyeq0gpEV9AuM7Nda-gJEwzu0p-PAFjFnNWDdGNwgjQ8g3VkcII0PoV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/13372/p2p/16Uiu2HAmVKjdrZ344x6YycfAH2DEuED4qD4LXFNwuHoFYUS8P85r","/ip4/127.0.0.1/tcp/13373/ws/p2p/16Uiu2HAmVKjdrZ344x6YycfAH2DEuED4qD4LXFNwuHoFYUS8P85r","/ip4/172.17.0.3/tcp/13372/p2p/16Uiu2HAmVKjdrZ344x6YycfAH2DEuED4qD4LXFNwuHoFYUS8P85r","/ip4/172.17.0.3/tcp/13373/ws/p2p/16Uiu2HAmVKjdrZ344x6YycfAH2DEuED4qD4LXFNwuHoFYUS8P85r"]}'
2025-02-14 03:07:12.693 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:12.694 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13371/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.10.122/tcp/44490/p2p/16Uiu2HAmBeAypxc1bo2BCo6EUhM48NmvX3NdeGFD7rXDdjWfEN3t", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:07:12.710 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:12.711 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-14 03:07:12.712 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44489/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:12.734 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:12.734 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:13371/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:12.737 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-14 03:07:12.739 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44489/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:12.750 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:12.750 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:12.851 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:12.851 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44489/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:12.853 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502432738865920,"ephemeral":false}]'
2025-02-14 03:07:12.855 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:12.855 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13371/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:12.857 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:13.858 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44489/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:13.862 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:13.863 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:13.963 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:13.963 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44489/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:13.966 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502433857904384,"ephemeral":false}]'
2025-02-14 03:07:13.967 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:13.968 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13371/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:13.969 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502433857904384,"ephemeral":false}]'
2025-02-14 03:07:13.971 INFO [src.steps.relay] WARM UP successful!!
2025-02-14 03:07:13.972 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:44489/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto"}'
2025-02-14 03:07:13.976 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:13.976 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:14.077 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:14.077 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:44489/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:14.079 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502433974112000,"ephemeral":false}]'
2025-02-14 03:07:14.081 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:14.081 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:13371/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:14.083 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502433974112000,"ephemeral":false}]'
2025-02-14 03:07:14.086 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:07:14.087 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:07:14.087 DEBUG [src.node.waku_node] Stopping container with id 19afd7ee2749
2025-02-14 03:07:14.632 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:07:14.632 DEBUG [src.node.waku_node] Stopping container with id 0b7c68c57216
2025-02-14 03:07:15.140 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:07:15.141 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:07:15.148 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:07:15.152 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
