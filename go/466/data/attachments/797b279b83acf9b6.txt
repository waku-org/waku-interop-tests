2025-02-14 03:05:47.388 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:05:47.388 DEBUG [tests.conftest] Running test: test_light_push_with_invalid_payloads with id: 2025-02-14_03-05-47__f2ab01d1-c78a-4b64-9688-636cd33b0283
2025-02-14 03:05:47.389 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:05:47.389 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-14 03:05:47.395 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:05:47.395 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-14_03-05-47__f2ab01d1-c78a-4b64-9688-636cd33b0283__wakuorg_nwaku:latest.log
2025-02-14 03:05:47.395 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:05:47.396 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:05:47.397 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:05:47.397 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.214.60
2025-02-14 03:05:47.397 DEBUG [src.node.docker_mananger] Generated ports ['15142', '15143', '15144', '15145', '15146']
2025-02-14 03:05:47.397 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:05:47.398 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:05:47.398 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:05:47.398 DEBUG [src.node.docker_mananger] docker run -i -t -p 15142:15142 -p 15143:15143 -p 15144:15144 -p 15145:15145 -p 15146:15146 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=15144 --rest-port=15142 --tcp-port=15143 --discv5-udp-port=15145 --rest-address=0.0.0.0 --nat=extip:172.18.214.60 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=abe232bec630dcb9cfe9de0aee0ad23fff55a36e2dba7bbbd6a5725a5940dc9e --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=15146 --metrics-logging=true --lightpush=true --relay=true
2025-02-14 03:05:47.632 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.214.60 waku 3f583722546872d0eddae6272dda6a45a4063111f474111c4a59f1a79e94263c
2025-02-14 03:05:47.683 DEBUG [src.node.docker_mananger] Container started with ID 3f5837225468. Setting up logs at ./log/docker/receiving_node1_2025-02-14_03-05-47__f2ab01d1-c78a-4b64-9688-636cd33b0283__wakuorg_nwaku:latest.log
2025-02-14 03:05:47.683 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 15142
2025-02-14 03:05:47.684 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:05:48.160 ERROR [src.node.docker_mananger] Max retries reached for container eeb1c3645b7c. Exiting log stream.
2025-02-14 03:05:48.685 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15142/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:48.688 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:05:48.688 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:05:48.688 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:15142/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:48.691 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.214.60/tcp/15143/p2p/16Uiu2HAmCp8rvv7tF72g83PvpwEcRf7Sksn5yGKBWzvqo3DzcYcr","/ip4/172.18.214.60/tcp/15144/ws/p2p/16Uiu2HAmCp8rvv7tF72g83PvpwEcRf7Sksn5yGKBWzvqo3DzcYcr"],"enrUri":"enr:-L24QO6l7QmmlqUbqT3iWN7ZOK7IZGBbyxV3zbtotom3ulxWY0_A-iPTWNFy9IHgVWnkfGMuT-YnicMzcGButnEI76ACgmlkgnY0gmlwhKwS1jyKbXVsdGlhZGRyc5YACASsEtY8BjsnAAoErBLWPAY7KN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAlfZyrQJgEB8iaU0g8SDB6_jNM30tdG_MCO-ofJj7IODdGNwgjsng3VkcII7KYV3YWt1Mgk"}'
2025-02-14 03:05:48.691 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:05:48.697 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:05:48.697 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-14_03-05-47__f2ab01d1-c78a-4b64-9688-636cd33b0283__wakuorg_nwaku:latest.log
2025-02-14 03:05:48.698 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:05:48.698 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:05:48.699 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:05:48.699 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.29.224
2025-02-14 03:05:48.699 DEBUG [src.node.docker_mananger] Generated ports ['18960', '18961', '18962', '18963', '18964']
2025-02-14 03:05:48.699 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:05:48.699 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:05:48.700 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:05:48.700 DEBUG [src.node.docker_mananger] docker run -i -t -p 18960:18960 -p 18961:18961 -p 18962:18962 -p 18963:18963 -p 18964:18964 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=18962 --rest-port=18960 --tcp-port=18961 --discv5-udp-port=18963 --rest-address=0.0.0.0 --nat=extip:172.18.29.224 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5f9ad39fbd2acff2c0ceb1d714c6364feaead6afad71b5d46665a4eee285c8cf --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=18964 --metrics-logging=true --lightpush=false --relay=true
2025-02-14 03:05:48.927 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.29.224 waku c2bc16eb0d077cdf67df67664d6e0742464f12714a052a5d3873cecb406abe2a
2025-02-14 03:05:48.979 DEBUG [src.node.docker_mananger] Container started with ID c2bc16eb0d07. Setting up logs at ./log/docker/receiving_node2_2025-02-14_03-05-47__f2ab01d1-c78a-4b64-9688-636cd33b0283__wakuorg_nwaku:latest.log
2025-02-14 03:05:48.980 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 18960
2025-02-14 03:05:48.980 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:05:49.981 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18960/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:49.984 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:05:49.984 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:05:49.984 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:18960/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:49.986 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.29.224/tcp/18961/p2p/16Uiu2HAmBTue3QWSeRvgyButqF3U2q9Weahq98AgyEk7gbFc7fW8","/ip4/172.18.29.224/tcp/18962/ws/p2p/16Uiu2HAmBTue3QWSeRvgyButqF3U2q9Weahq98AgyEk7gbFc7fW8"],"enrUri":"enr:-L24QIaKQjq2dqp-qOXxUxqMONrfMv7m2JrRjaQtKRjQ1ZKTOaKwhJ2V79dwOSyJqhPPveXyrv9RjRx59IpSQdZykYUCgmlkgnY0gmlwhKwSHeCKbXVsdGlhZGRyc5YACASsEh3gBkoRAAoErBId4AZKEt0DgnJzhQADAQAAiXNlY3AyNTZrMaEC7k2Y5N1-bzK4qJboTH4vyQF7nfaCi4wP9adNAS4dpNGDdGNwgkoRg3VkcIJKE4V3YWt1MgE"}'
2025-02-14 03:05:49.987 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:05:49.987 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18960/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.214.60/tcp/15143/p2p/16Uiu2HAmCp8rvv7tF72g83PvpwEcRf7Sksn5yGKBWzvqo3DzcYcr"]'
2025-02-14 03:05:50.027 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:05:50.036 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:05:50.036 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-14_03-05-47__f2ab01d1-c78a-4b64-9688-636cd33b0283__wakuorg_go-waku:latest.log
2025-02-14 03:05:50.037 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:05:50.037 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:05:50.038 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:05:50.038 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.151.162
2025-02-14 03:05:50.038 DEBUG [src.node.docker_mananger] Generated ports ['55443', '55444', '55445', '55446', '55447']
2025-02-14 03:05:50.039 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:05:50.039 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:05:50.039 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:05:50.039 DEBUG [src.node.docker_mananger] docker run -i -t -p 55443:55443 -p 55444:55444 -p 55445:55445 -p 55446:55446 -p 55447:55447 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=55445 --rest-port=55443 --tcp-port=55444 --discv5-udp-port=55446 --rest-address=0.0.0.0 --nat=extip:172.18.151.162 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b41f1eb4c1cb1ea2c7e29068cc058ed3da07ac0583acbe03cd64cc65bb91df0e --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QO6l7QmmlqUbqT3iWN7ZOK7IZGBbyxV3zbtotom3ulxWY0_A-iPTWNFy9IHgVWnkfGMuT-YnicMzcGButnEI76ACgmlkgnY0gmlwhKwS1jyKbXVsdGlhZGRyc5YACASsEtY8BjsnAAoErBLWPAY7KN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDAlfZyrQJgEB8iaU0g8SDB6_jNM30tdG_MCO-ofJj7IODdGNwgjsng3VkcII7KYV3YWt1Mgk --lightpushnode=/ip4/172.18.214.60/tcp/15143/p2p/16Uiu2HAmCp8rvv7tF72g83PvpwEcRf7Sksn5yGKBWzvqo3DzcYcr --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-14 03:05:50.275 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.151.162 waku 360c603cec0dbdc646d137c7b97baa34473537064433e891b989fafa302c2c72
2025-02-14 03:05:50.326 DEBUG [src.node.docker_mananger] Container started with ID 360c603cec0d. Setting up logs at ./log/docker/lightpush_node1_2025-02-14_03-05-47__f2ab01d1-c78a-4b64-9688-636cd33b0283__wakuorg_go-waku:latest.log
2025-02-14 03:05:50.328 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 55443
2025-02-14 03:05:50.328 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:05:51.328 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55443/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:51.331 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QF_dEDPNVK9eRgHsujWax4hwqJzckGQSAGRAgSp2cqysYMDy6TEXu8qY2ZXuzZcHy1xvHzEAk7_ZBd1yvewBy8uGAZUCa2_zgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQNCpJwp9WctGBq0ORN1g6_eRW_3j1h70cvcpjVNFaQL2YN0Y3CC2JSDdWRwgtiWhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/55444/p2p/16Uiu2HAmH98qi5C82jEzyxCkAEMyCu9KTw68oW4MHYZTi2NGzLoA","/ip4/127.0.0.1/tcp/55445/ws/p2p/16Uiu2HAmH98qi5C82jEzyxCkAEMyCu9KTw68oW4MHYZTi2NGzLoA","/ip4/172.17.0.4/tcp/55444/p2p/16Uiu2HAmH98qi5C82jEzyxCkAEMyCu9KTw68oW4MHYZTi2NGzLoA","/ip4/172.17.0.4/tcp/55445/ws/p2p/16Uiu2HAmH98qi5C82jEzyxCkAEMyCu9KTw68oW4MHYZTi2NGzLoA"]}'
2025-02-14 03:05:51.331 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:05:51.331 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.214.60/tcp/15143/p2p/16Uiu2HAmCp8rvv7tF72g83PvpwEcRf7Sksn5yGKBWzvqo3DzcYcr", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:05:51.333 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:05:51.333 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.29.224/tcp/18961/p2p/16Uiu2HAmBTue3QWSeRvgyButqF3U2q9Weahq98AgyEk7gbFc7fW8", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:05:51.349 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:05:51.350 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:15142/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-14 03:05:51.356 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:05:51.357 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:18960/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-14 03:05:51.360 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:05:51.361 DEBUG [tests.light_push.test_publish] Running test with payload Empty string
2025-02-14 03:05:51.362 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739502351361969664}}'
2025-02-14 03:05:51.363 ERROR [src.node.api_clients.base_client] HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:55443/lightpush/v1/message. Response content: b'missing Payload field'
2025-02-14 03:05:51.364 DEBUG [tests.light_push.test_publish] Running test with payload Unecoded text
2025-02-14 03:05:51.364 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739502351364352768}}'
2025-02-14 03:05:51.365 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55443/lightpush/v1/message. Response content: b''
2025-02-14 03:05:51.366 DEBUG [tests.light_push.test_publish] Running test with payload A dictionary
2025-02-14 03:05:51.366 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739502351366406656}}'
2025-02-14 03:05:51.367 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55443/lightpush/v1/message. Response content: b''
2025-02-14 03:05:51.368 DEBUG [tests.light_push.test_publish] Running test with payload An integer
2025-02-14 03:05:51.368 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739502351368492544}}'
2025-02-14 03:05:51.370 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55443/lightpush/v1/message. Response content: b''
2025-02-14 03:05:51.370 DEBUG [tests.light_push.test_publish] Running test with payload A list
2025-02-14 03:05:51.370 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739502351370812928}}'
2025-02-14 03:05:51.372 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55443/lightpush/v1/message. Response content: b''
2025-02-14 03:05:51.372 DEBUG [tests.light_push.test_publish] Running test with payload A bool
2025-02-14 03:05:51.372 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55443/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1739502351372858112}}'
2025-02-14 03:05:51.374 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:55443/lightpush/v1/message. Response content: b''
2025-02-14 03:05:51.376 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:05:51.377 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:05:51.377 DEBUG [src.node.waku_node] Stopping container with id 3f5837225468
2025-02-14 03:05:51.976 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:05:51.978 DEBUG [src.node.waku_node] Stopping container with id c2bc16eb0d07
2025-02-14 03:05:52.809 ERROR [src.node.docker_mananger] Max retries reached for container 3f5837225468. Exiting log stream.
2025-02-14 03:05:53.473 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:05:53.473 DEBUG [src.node.waku_node] Stopping container with id 360c603cec0d
2025-02-14 03:05:53.951 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:05:53.951 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:05:53.965 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:05:53.972 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:05:53.974 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
