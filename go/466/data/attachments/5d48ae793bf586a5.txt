2025-02-14 03:05:00.946 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:05:00.946 DEBUG [tests.conftest] Running test: test_relay with id: 2025-02-14_03-05-00__3a4a4470-2fe0-48d0-b55f-c1392f6bf0dc
2025-02-14 03:05:00.946 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:05:00.947 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-14 03:05:00.947 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-14 03:05:00.947 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 03:05:00.947 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-14 03:05:00.956 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:05:00.957 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_03-05-00__3a4a4470-2fe0-48d0-b55f-c1392f6bf0dc__wakuorg_nwaku:latest.log
2025-02-14 03:05:00.957 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:05:00.957 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:05:01.030 DEBUG [src.node.docker_mananger] Network waku created
2025-02-14 03:05:01.030 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.101.226
2025-02-14 03:05:01.031 DEBUG [src.node.docker_mananger] Generated ports ['38654', '38655', '38656', '38657', '38658']
2025-02-14 03:05:01.031 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:05:01.031 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:05:01.031 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:05:01.031 DEBUG [src.node.docker_mananger] docker run -i -t -p 38654:38654 -p 38655:38655 -p 38656:38656 -p 38657:38657 -p 38658:38658 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=38656 --rest-port=38654 --tcp-port=38655 --discv5-udp-port=38657 --rest-address=0.0.0.0 --nat=extip:172.18.101.226 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cf4277f3d4bac82fa0da5cf74ebc312aacc2efd2fe1c2c949c2bf7bf90fdf989 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=38658 --metrics-logging=true --relay=true
2025-02-14 03:05:05.360 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.101.226 waku 7bd2e38e7ee8c42b04037da928fa4a3e7b6f651eec235df37e369907a9436c18
2025-02-14 03:05:05.408 DEBUG [src.node.docker_mananger] Container started with ID 7bd2e38e7ee8. Setting up logs at ./log/docker/node1_2025-02-14_03-05-00__3a4a4470-2fe0-48d0-b55f-c1392f6bf0dc__wakuorg_nwaku:latest.log
2025-02-14 03:05:05.408 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 38654
2025-02-14 03:05:05.409 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:05:06.409 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38654/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:06.412 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:05:06.412 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:05:06.413 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38654/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:06.415 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.101.226/tcp/38655/p2p/16Uiu2HAkvTvEMfvBEoShqvTFTHbmwHy7iejcPPKQnCL5JUz1hKmK","/ip4/172.18.101.226/tcp/38656/ws/p2p/16Uiu2HAkvTvEMfvBEoShqvTFTHbmwHy7iejcPPKQnCL5JUz1hKmK"],"enrUri":"enr:-L24QBYVDxyxjCYdJO6THdtjl0im-bwsQ0m9JnpcOB-bcDRTdQxykjwNM1W-9e5vIUxFXtZ5Dd51qFo8O1fa_JN1Tu4CgmlkgnY0gmlwhKwSZeKKbXVsdGlhZGRyc5YACASsEmXiBpb_AAoErBJl4gaXAN0DgnJzhQADAQAAiXNlY3AyNTZrMaECD272Wh59M6tfLqy-embsmyr67w2Y7WcGHPL37JpRLrKDdGNwgpb_g3VkcIKXAYV3YWt1MgE"}'
2025-02-14 03:05:06.415 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:05:06.422 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:05:06.422 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_03-05-00__3a4a4470-2fe0-48d0-b55f-c1392f6bf0dc__wakuorg_go-waku:latest.log
2025-02-14 03:05:06.422 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:05:06.422 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:05:06.424 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:05:06.424 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.40.10
2025-02-14 03:05:06.424 DEBUG [src.node.docker_mananger] Generated ports ['27754', '27755', '27756', '27757', '27758']
2025-02-14 03:05:06.424 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:05:06.425 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:05:06.425 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:05:06.425 DEBUG [src.node.docker_mananger] docker run -i -t -p 27754:27754 -p 27755:27755 -p 27756:27756 -p 27757:27757 -p 27758:27758 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=27756 --rest-port=27754 --tcp-port=27755 --discv5-udp-port=27757 --rest-address=0.0.0.0 --nat=extip:172.18.40.10 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=3ef8cab1eaa9e5c5a9abc2850e491c4dfc02da56cb6eac3be5e67ca0699eb97e --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QBYVDxyxjCYdJO6THdtjl0im-bwsQ0m9JnpcOB-bcDRTdQxykjwNM1W-9e5vIUxFXtZ5Dd51qFo8O1fa_JN1Tu4CgmlkgnY0gmlwhKwSZeKKbXVsdGlhZGRyc5YACASsEmXiBpb_AAoErBJl4gaXAN0DgnJzhQADAQAAiXNlY3AyNTZrMaECD272Wh59M6tfLqy-embsmyr67w2Y7WcGHPL37JpRLrKDdGNwgpb_g3VkcIKXAYV3YWt1MgE
2025-02-14 03:05:09.166 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.40.10 waku 66517dddbfb52bb9c145267a695dbfea9188d0b88e911149b887adc3a3177620
2025-02-14 03:05:09.221 DEBUG [src.node.docker_mananger] Container started with ID 66517dddbfb5. Setting up logs at ./log/docker/node1_2025-02-14_03-05-00__3a4a4470-2fe0-48d0-b55f-c1392f6bf0dc__wakuorg_go-waku:latest.log
2025-02-14 03:05:09.221 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 27754
2025-02-14 03:05:09.223 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:05:10.223 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27754/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:10.226 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QEOd15wLZKjM2ksIOoBI9on7k-ani8SN0oM_n7gpZbwXZRh1uOQTE3bkbwkrTG8CB7sEX3_Itg4FZSsqkM_dtB6GAZUCas9dgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECvQyU4D1ESMc7V1ROUiYb22GyMyVb7DdUvOb0N11kCfKDdGNwgmxrg3VkcIJsbYV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/27755/p2p/16Uiu2HAm89eAMRqBogyn9F5H8bPYMhLPJVhfvJiwgzFLvKn6pnXB","/ip4/127.0.0.1/tcp/27756/ws/p2p/16Uiu2HAm89eAMRqBogyn9F5H8bPYMhLPJVhfvJiwgzFLvKn6pnXB","/ip4/172.17.0.3/tcp/27755/p2p/16Uiu2HAm89eAMRqBogyn9F5H8bPYMhLPJVhfvJiwgzFLvKn6pnXB","/ip4/172.17.0.3/tcp/27756/ws/p2p/16Uiu2HAm89eAMRqBogyn9F5H8bPYMhLPJVhfvJiwgzFLvKn6pnXB"]}'
2025-02-14 03:05:10.226 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:05:10.227 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38654/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:05:10.245 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:05:10.246 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:27754/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:05:10.249 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-14 03:05:10.250 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38654/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:05:10.263 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:05:10.263 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:05:10.364 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:05:10.364 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38654/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:10.367 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502310250170880,"ephemeral":false}]'
2025-02-14 03:05:10.369 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:05:10.369 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27754/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:10.371 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:05:11.373 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:38654/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:05:11.377 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:05:11.378 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:05:11.478 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:05:11.478 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:38654/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:11.481 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502311372735744,"ephemeral":false}]'
2025-02-14 03:05:11.483 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:05:11.483 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:27754/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:05:11.484 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502311372735744,"ephemeral":false}]'
2025-02-14 03:05:11.487 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:05:11.488 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:05:11.489 DEBUG [src.node.waku_node] Stopping container with id 7bd2e38e7ee8
2025-02-14 03:05:12.087 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:05:12.088 DEBUG [src.node.waku_node] Stopping container with id 66517dddbfb5
2025-02-14 03:05:12.613 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:05:12.616 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:05:12.625 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:05:12.628 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
