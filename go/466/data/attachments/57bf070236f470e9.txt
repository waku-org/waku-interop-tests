2025-02-14 03:07:30.650 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-14 03:07:30.651 DEBUG [tests.conftest] Running test: test_publish_with_invalid_content_topics with id: 2025-02-14_03-07-30__2556bdfe-26f6-435f-aebe-29782093c84f
2025-02-14 03:07:30.651 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-14 03:07:30.651 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-14 03:07:30.652 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-14 03:07:30.661 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-14 03:07:30.661 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-14_03-07-30__2556bdfe-26f6-435f-aebe-29782093c84f__wakuorg_nwaku:latest.log
2025-02-14 03:07:30.662 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:30.662 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:30.664 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:30.665 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.155.49
2025-02-14 03:07:30.665 DEBUG [src.node.docker_mananger] Generated ports ['61318', '61319', '61320', '61321', '61322']
2025-02-14 03:07:30.666 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:30.667 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:30.667 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:30.667 DEBUG [src.node.docker_mananger] docker run -i -t -p 61318:61318 -p 61319:61319 -p 61320:61320 -p 61321:61321 -p 61322:61322 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=61320 --rest-port=61318 --tcp-port=61319 --discv5-udp-port=61321 --rest-address=0.0.0.0 --nat=extip:172.18.155.49 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eccbbcb9a7dc01aabcd06fa1c8fe0b5e42854ab4a7efbcf25a213f5ba8caf5ba --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=61322 --metrics-logging=true --relay=true
2025-02-14 03:07:30.901 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.155.49 waku dceea18d29f7ab6f7562a78ee6d3f14cb95db26397d69788edac824568338900
2025-02-14 03:07:30.948 DEBUG [src.node.docker_mananger] Container started with ID dceea18d29f7. Setting up logs at ./log/docker/node1_2025-02-14_03-07-30__2556bdfe-26f6-435f-aebe-29782093c84f__wakuorg_nwaku:latest.log
2025-02-14 03:07:30.949 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 61318
2025-02-14 03:07:30.949 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:31.481 ERROR [src.node.docker_mananger] Max retries reached for container 035eb2937e8a. Exiting log stream.
2025-02-14 03:07:31.949 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61318/health" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:31.952 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-14 03:07:31.953 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-14 03:07:31.953 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61318/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:31.955 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.155.49/tcp/61319/p2p/16Uiu2HAm5CNhufGtC8Y6yAgyrdfyxsK4JYWXZ3sfth2PRhfg6RDU","/ip4/172.18.155.49/tcp/61320/ws/p2p/16Uiu2HAm5CNhufGtC8Y6yAgyrdfyxsK4JYWXZ3sfth2PRhfg6RDU"],"enrUri":"enr:-L24QNha_Q_7h_kngO6E32FhZZCswdimLHc6THrWwezh-K4pQdVJvN-Qu8QDrbcos7POStaYsox5SheOh_6aDG3_1P0CgmlkgnY0gmlwhKwSmzGKbXVsdGlhZGRyc5YACASsEpsxBu-HAAoErBKbMQbviN0DgnJzhQADAQAAiXNlY3AyNTZrMaECkSzJgDLBFHt-jF3iiBwn8Gq9W5dY4Q0LYvU-nhiJciuDdGNwgu-Hg3VkcILviYV3YWt1MgE"}'
2025-02-14 03:07:31.955 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:31.961 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-14 03:07:31.961 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-14_03-07-30__2556bdfe-26f6-435f-aebe-29782093c84f__wakuorg_go-waku:latest.log
2025-02-14 03:07:31.962 DEBUG [src.node.waku_node] Starting Node...
2025-02-14 03:07:31.962 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-14 03:07:31.963 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-14 03:07:31.963 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.9.1
2025-02-14 03:07:31.963 DEBUG [src.node.docker_mananger] Generated ports ['37539', '37540', '37541', '37542', '37543']
2025-02-14 03:07:31.963 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-14 03:07:31.964 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-14 03:07:31.964 DEBUG [src.node.waku_node] Using volumes []
2025-02-14 03:07:31.964 DEBUG [src.node.docker_mananger] docker run -i -t -p 37539:37539 -p 37540:37540 -p 37541:37541 -p 37542:37542 -p 37543:37543 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=37541 --rest-port=37539 --tcp-port=37540 --discv5-udp-port=37542 --rest-address=0.0.0.0 --nat=extip:172.18.9.1 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4663b5b08feb34d47d36c8ff748cbfe32cad90800c7f97908db4cac94b3dbcdd --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QNha_Q_7h_kngO6E32FhZZCswdimLHc6THrWwezh-K4pQdVJvN-Qu8QDrbcos7POStaYsox5SheOh_6aDG3_1P0CgmlkgnY0gmlwhKwSmzGKbXVsdGlhZGRyc5YACASsEpsxBu-HAAoErBKbMQbviN0DgnJzhQADAQAAiXNlY3AyNTZrMaECkSzJgDLBFHt-jF3iiBwn8Gq9W5dY4Q0LYvU-nhiJciuDdGNwgu-Hg3VkcILviYV3YWt1MgE
2025-02-14 03:07:32.190 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.9.1 waku 0ef339569bc07f2e10beeb1f2958fcf4ec8eb0ad4bdef422f36fdc5fe96f8b1b
2025-02-14 03:07:32.244 DEBUG [src.node.docker_mananger] Container started with ID 0ef339569bc0. Setting up logs at ./log/docker/node2_2025-02-14_03-07-30__2556bdfe-26f6-435f-aebe-29782093c84f__wakuorg_go-waku:latest.log
2025-02-14 03:07:32.246 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 37539
2025-02-14 03:07:32.246 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-14 03:07:33.246 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37539/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:33.249 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QIJOAJh81VgBmvre1ZtTM00jDJ90EYCGHCx4kTl5SRjYN9TR6lX-ogxY2X3c6T1yM-Kw7M8bsJYkfEa5_hwYdSyGAZUCbP4PgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECjlEzqlsaGRNnLPeQ-UTFdQCfiG69Xmh4Nc53EsiSxFSDdGNwgpKkg3VkcIKSpoV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/37540/p2p/16Uiu2HAm51DgsyRTXwEjvmLKcSyoXRQ5yXiLJaz8oK3qLtqLPpDZ","/ip4/127.0.0.1/tcp/37541/ws/p2p/16Uiu2HAm51DgsyRTXwEjvmLKcSyoXRQ5yXiLJaz8oK3qLtqLPpDZ","/ip4/172.17.0.3/tcp/37540/p2p/16Uiu2HAm51DgsyRTXwEjvmLKcSyoXRQ5yXiLJaz8oK3qLtqLPpDZ","/ip4/172.17.0.3/tcp/37541/ws/p2p/16Uiu2HAm51DgsyRTXwEjvmLKcSyoXRQ5yXiLJaz8oK3qLtqLPpDZ"]}'
2025-02-14 03:07:33.250 INFO [src.node.waku_node] REST service is ready !!
2025-02-14 03:07:33.250 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37539/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.155.49/tcp/61319/p2p/16Uiu2HAm5CNhufGtC8Y6yAgyrdfyxsK4JYWXZ3sfth2PRhfg6RDU", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-14 03:07:33.267 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:33.268 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-14 03:07:33.268 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:33.289 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:33.290 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:37539/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-14 03:07:33.292 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-14 03:07:33.293 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:33.307 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:33.307 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:33.408 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:33.408 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:33.410 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502453293640448,"ephemeral":false}]'
2025-02-14 03:07:33.412 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:33.412 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37539/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:33.414 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-14 03:07:34.415 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:34.420 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-14 03:07:34.420 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-14 03:07:34.520 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-14 03:07:34.520 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:34.523 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502454414759680,"ephemeral":false}]'
2025-02-14 03:07:34.524 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-14 03:07:34.524 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:37539/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-14 03:07:34.526 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739502454414759680,"ephemeral":false}]'
2025-02-14 03:07:34.527 INFO [src.steps.relay] WARM UP successful!!
2025-02-14 03:07:34.528 DEBUG [tests.relay.test_publish] Running test with contetn topic Empty string
2025-02-14 03:07:34.528 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "", "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:34.531 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-14 03:07:34.531 DEBUG [tests.relay.test_publish] Running test with contetn topic A dictionary
2025-02-14 03:07:34.531 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": {"key": "YWFh"}, "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:34.534 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-14 03:07:34.534 DEBUG [tests.relay.test_publish] Running test with contetn topic An integer
2025-02-14 03:07:34.534 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": 1234567890, "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:34.536 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-14 03:07:34.537 DEBUG [tests.relay.test_publish] Running test with contetn topic A list
2025-02-14 03:07:34.537 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": ["YWFh"], "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:34.539 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-14 03:07:34.539 DEBUG [tests.relay.test_publish] Running test with contetn topic A bool
2025-02-14 03:07:34.540 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": true, "timestamp": '$(date +%s%N)'}'
2025-02-14 03:07:34.542 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:61318/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-14 03:07:34.544 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-14 03:07:34.545 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-14 03:07:34.545 DEBUG [src.node.waku_node] Stopping container with id dceea18d29f7
2025-02-14 03:07:35.112 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:07:35.112 DEBUG [src.node.waku_node] Stopping container with id 0ef339569bc0
2025-02-14 03:07:35.596 DEBUG [src.node.waku_node] Container stopped.
2025-02-14 03:07:35.597 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-14 03:07:35.604 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-14 03:07:35.608 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
