{"uid":"7bbfd39c80b38707","name":"test_filter_works_with_static_sharding","fullName":"tests.sharding.test_filter.TestFilterStaticSharding#test_filter_works_with_static_sharding","historyId":"afae3d866d7a1521f4498a67a21af305","time":{"start":1738154483701,"stop":1738154486319,"duration":2618},"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:24257/filter/v2/subscriptions with response: b'{\"requestId\":\"14225f89-68ca-4db2-b306-3906901b921b\",\"statusDesc\":\"subscription failed\"}'","statusTrace":"src/node/api_clients/base_client.py:14: in make_request\n    response.raise_for_status()\n/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/site-packages/requests/models.py:1021: in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nE   requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: http://127.0.0.1:24257/filter/v2/subscriptions\n\nDuring handling of the above exception, another exception occurred:\ntests/sharding/test_filter.py:17: in test_filter_works_with_static_sharding\n    self.subscribe_filter_node(self.node2, content_topics=[self.test_content_topic], pubsub_topic=self.test_pubsub_topic)\nsrc/steps/sharding.py:128: in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\nsrc/node/waku_node.py:358: in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\nsrc/node/api_clients/rest.py:68: in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\nsrc/node/api_clients/rest.py:16: in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\nsrc/node/api_clients/base_client.py:17: in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\nE   Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:24257/filter/v2/subscriptions with response: b'{\"requestId\":\"14225f89-68ca-4db2-b306-3906901b921b\",\"statusDesc\":\"subscription failed\"}'","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":2,"retriesStatusChange":false,"beforeStages":[{"name":"set_allure_env_variables","time":{"start":1738154286430,"stop":1738154286430,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"attach_logs_on_fail","time":{"start":1738154483699,"stop":1738154483699,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_id","time":{"start":1738154483699,"stop":1738154483699,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_setup","time":{"start":1738154483699,"stop":1738154483700,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"close_open_nodes","time":{"start":1738154483699,"stop":1738154483699,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"check_waku_log_errors","time":{"start":1738154483699,"stop":1738154483699,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"relay_setup","time":{"start":1738154483700,"stop":1738154483700,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"common_setup","time":{"start":1738154483700,"stop":1738154483700,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"sharding_setup","time":{"start":1738154483700,"stop":1738154483700,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:24257/filter/v2/subscriptions with response: b'{\"requestId\":\"14225f89-68ca-4db2-b306-3906901b921b\",\"statusDesc\":\"subscription failed\"}'","statusTrace":"src/node/api_clients/base_client.py:14: in make_request\n    response.raise_for_status()\n/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/site-packages/requests/models.py:1021: in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nE   requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: http://127.0.0.1:24257/filter/v2/subscriptions\n\nDuring handling of the above exception, another exception occurred:\ntests/sharding/test_filter.py:17: in test_filter_works_with_static_sharding\n    self.subscribe_filter_node(self.node2, content_topics=[self.test_content_topic], pubsub_topic=self.test_pubsub_topic)\nsrc/steps/sharding.py:128: in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\nsrc/node/waku_node.py:358: in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\nsrc/node/api_clients/rest.py:68: in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\nsrc/node/api_clients/rest.py:16: in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\nsrc/node/api_clients/base_client.py:17: in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\nE   Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:24257/filter/v2/subscriptions with response: b'{\"requestId\":\"14225f89-68ca-4db2-b306-3906901b921b\",\"statusDesc\":\"subscription failed\"}'","steps":[{"name":"setup_first_relay_node_with_filter","time":{"start":1738154483701,"stop":1738154484994,"duration":1293},"status":"passed","steps":[{"name":"setup_first_relay_node","time":{"start":1738154483701,"stop":1738154484994,"duration":1293},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"filter","value":"'true'"},{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"setup_second_node_as_filter","time":{"start":1738154484994,"stop":1738154486305,"duration":1311},"status":"passed","steps":[{"name":"add_node_peer","time":{"start":1738154486303,"stop":1738154486305,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"args","value":"(<tests.sharding.test_filter.TestFilterStaticSharding object at 0x7faa0d6eb650>, <src.node.waku_node.WakuNode object at 0x7faa0d3439b0>, ['/ip4/172.18.65.154/tcp/36033/p2p/16Uiu2HAmS6g7Uqg5tGaqy2HEMcN1zYqE3TAttaebG6HpQ1CVRFnC'])"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"subscribe_first_relay_node","time":{"start":1738154486306,"stop":1738154486308,"duration":2},"status":"passed","steps":[{"name":"subscribe_relay_node","time":{"start":1738154486306,"stop":1738154486308,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"node","value":"<src.node.waku_node.WakuNode object at 0x7faa0d0a92b0>"},{"name":"content_topics","value":"None"},{"name":"pubsub_topics","value":"['/waku/2/rs/2/0']"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"content_topics","value":"None"},{"name":"pubsub_topics","value":"['/waku/2/rs/2/0']"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"subscribe_filter_node","time":{"start":1738154486308,"stop":1738154486318,"duration":10},"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:24257/filter/v2/subscriptions with response: b'{\"requestId\":\"14225f89-68ca-4db2-b306-3906901b921b\",\"statusDesc\":\"subscription failed\"}'\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/steps/sharding.py\", line 128, in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/waku_node.py\", line 358, in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/rest.py\", line 68, in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/rest.py\", line 16, in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/base_client.py\", line 17, in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\n","steps":[],"attachments":[],"parameters":[{"name":"node","value":"<src.node.waku_node.WakuNode object at 0x7faa0d3439b0>"},{"name":"content_topics","value":"['/myapp/1/latest/proto']"},{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"a48a5ebe0ca9a78f","name":"log","source":"a48a5ebe0ca9a78f.txt","type":"text/plain","size":33598}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":7,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"test_setup::0","time":{"start":1738154486350,"stop":1738154486350,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"close_open_nodes::0","time":{"start":1738154486351,"stop":1738154487786,"duration":1435},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"check_waku_log_errors::0","time":{"start":1738154487787,"stop":1738154487794,"duration":7},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"attach_logs_on_fail::0","time":{"start":1738154487795,"stop":1738154487796,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"432ad806b60a92d6","name":"node1_2025-01-29_12-41-23__d38a9b7a-8d5c-4bc5-9d9b-829587bd8a82__wakuorg_nwaku:latest.log","source":"432ad806b60a92d6.txt","type":"text/plain","size":111314},{"uid":"e49076c5a8b0116d","name":"node2_2025-01-29_12-41-23__d38a9b7a-8d5c-4bc5-9d9b-829587bd8a82__wakuorg_go-waku:latest.log","source":"e49076c5a8b0116d.txt","type":"text/plain","size":57897}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"set_allure_env_variables::0","time":{"start":1738154527023,"stop":1738154527023,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.sharding"},{"name":"suite","value":"test_filter"},{"name":"subSuite","value":"TestFilterStaticSharding"},{"name":"host","value":"fv-az1922-669"},{"name":"thread","value":"2031-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.sharding.test_filter"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"240abce09e093c92","status":"broken","statusDetails":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:32037/filter/v2/subscriptions with response: b'{\"requestId\":\"5947a824-87b3-4acd-af23-74e25b0079ed\",\"statusDesc\":\"subscription failed\"}'","time":{"start":1738154479591,"stop":1738154482199,"duration":2608}},{"uid":"2665955f39ecc039","status":"broken","statusDetails":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:23555/filter/v2/subscriptions with response: b'{\"requestId\":\"29711cba-79ab-4665-bdaa-f33ddb12a708\",\"statusDesc\":\"subscription failed\"}'","time":{"start":1738154475504,"stop":1738154478107,"duration":2603}}],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":71,"unknown":0,"total":73},"items":[{"uid":"14287cba5e9f9287","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/446//#testresult/14287cba5e9f9287","status":"broken","statusDetails":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions with response: b'{\"requestId\":\"4ec768ac-952a-4aef-877a-08154c7bd467\",\"statusDesc\":\"subscription failed\"}'","time":{"start":1738120010151,"stop":1738120012761,"duration":2610}},{"uid":"a0a224834e2d9d2f","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/445//#testresult/a0a224834e2d9d2f","status":"passed","time":{"start":1738033439623,"stop":1738033442329,"duration":2706}},{"uid":"257a598527ee6db3","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/444//#testresult/257a598527ee6db3","status":"passed","time":{"start":1737947152919,"stop":1737947155626,"duration":2707}},{"uid":"71a52028394e140d","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/443//#testresult/71a52028394e140d","status":"passed","time":{"start":1737860712796,"stop":1737860715501,"duration":2705}},{"uid":"a6cde88db095ea29","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/442//#testresult/a6cde88db095ea29","status":"passed","time":{"start":1737774187122,"stop":1737774189839,"duration":2717}},{"uid":"18d270c7643f6c94","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/441//#testresult/18d270c7643f6c94","status":"passed","time":{"start":1737687877507,"stop":1737687880213,"duration":2706}},{"uid":"efce234f3276ecbc","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/440//#testresult/efce234f3276ecbc","status":"passed","time":{"start":1737601463232,"stop":1737601465925,"duration":2693}},{"uid":"36a7f9c3703b2e51","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/439//#testresult/36a7f9c3703b2e51","status":"passed","time":{"start":1737515147410,"stop":1737515150106,"duration":2696}},{"uid":"35ae1018a5d4630b","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/438//#testresult/35ae1018a5d4630b","status":"passed","time":{"start":1737428652784,"stop":1737428655477,"duration":2693}},{"uid":"3e4551f5b590dc68","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/437//#testresult/3e4551f5b590dc68","status":"passed","time":{"start":1737342351866,"stop":1737342354567,"duration":2701}},{"uid":"35e67014129caa7c","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/436//#testresult/35e67014129caa7c","status":"passed","time":{"start":1737256018010,"stop":1737256020714,"duration":2704}},{"uid":"aed5362b1b1be318","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/435//#testresult/aed5362b1b1be318","status":"passed","time":{"start":1737169447422,"stop":1737169450126,"duration":2704}},{"uid":"d952e830e639a29b","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/434//#testresult/d952e830e639a29b","status":"passed","time":{"start":1737083140164,"stop":1737083142887,"duration":2723}},{"uid":"edc29485bf31f334","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/433//#testresult/edc29485bf31f334","status":"passed","time":{"start":1736996655702,"stop":1736996658405,"duration":2703}},{"uid":"914fc7b920f78994","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/432//#testresult/914fc7b920f78994","status":"passed","time":{"start":1736910300394,"stop":1736910303088,"duration":2694}},{"uid":"69d7794bdda3a71c","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/431//#testresult/69d7794bdda3a71c","status":"passed","time":{"start":1736823843918,"stop":1736823846659,"duration":2741}},{"uid":"15b4f3059a9b7db6","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/430//#testresult/15b4f3059a9b7db6","status":"passed","time":{"start":1736737871193,"stop":1736737873904,"duration":2711}},{"uid":"e44bf3dfa1e2d196","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/429//#testresult/e44bf3dfa1e2d196","status":"passed","time":{"start":1736651521825,"stop":1736651524518,"duration":2693}},{"uid":"b4f554ee60a4d4ae","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/428//#testresult/b4f554ee60a4d4ae","status":"passed","time":{"start":1736564856217,"stop":1736564858937,"duration":2720}},{"uid":"6f5db0f151af57c9","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/427//#testresult/6f5db0f151af57c9","status":"passed","time":{"start":1736478570940,"stop":1736478573658,"duration":2718}}]},"tags":[]},"source":"7bbfd39c80b38707.json","parameterValues":[]}