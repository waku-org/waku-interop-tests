{"uid":"de8a31d1e507d3ac","name":"test_filter_works_with_static_sharding","fullName":"tests.sharding.test_filter.TestFilterStaticSharding#test_filter_works_with_static_sharding","historyId":"afae3d866d7a1521f4498a67a21af305","time":{"start":1732074617357,"stop":1732074620728,"duration":3371},"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:50661/filter/v2/subscriptions with response: b'{\"requestId\":\"b4b89240-3a31-4424-b342-008792a286eb\",\"statusDesc\":\"subscription failed\"}'","statusTrace":"src/node/api_clients/base_client.py:14: in make_request\n    response.raise_for_status()\n/opt/hostedtoolcache/Python/3.12.7/x64/lib/python3.12/site-packages/requests/models.py:1021: in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nE   requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: http://127.0.0.1:50661/filter/v2/subscriptions\n\nDuring handling of the above exception, another exception occurred:\ntests/sharding/test_filter.py:17: in test_filter_works_with_static_sharding\n    self.subscribe_filter_node(self.node2, content_topics=[self.test_content_topic], pubsub_topic=self.test_pubsub_topic)\nsrc/steps/sharding.py:128: in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\nsrc/node/waku_node.py:355: in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\nsrc/node/api_clients/rest.py:68: in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\nsrc/node/api_clients/rest.py:16: in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\nsrc/node/api_clients/base_client.py:17: in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\nE   Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:50661/filter/v2/subscriptions with response: b'{\"requestId\":\"b4b89240-3a31-4424-b342-008792a286eb\",\"statusDesc\":\"subscription failed\"}'","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":2,"retriesStatusChange":false,"beforeStages":[{"name":"set_allure_env_variables","time":{"start":1732072261581,"stop":1732072261581,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"check_waku_log_errors","time":{"start":1732074617355,"stop":1732074617355,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"attach_logs_on_fail","time":{"start":1732074617355,"stop":1732074617355,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_id","time":{"start":1732074617356,"stop":1732074617356,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"sharding_setup","time":{"start":1732074617356,"stop":1732074617356,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"close_open_nodes","time":{"start":1732074617356,"stop":1732074617356,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"common_setup","time":{"start":1732074617356,"stop":1732074617356,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"relay_setup","time":{"start":1732074617356,"stop":1732074617356,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_setup","time":{"start":1732074617356,"stop":1732074617356,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:50661/filter/v2/subscriptions with response: b'{\"requestId\":\"b4b89240-3a31-4424-b342-008792a286eb\",\"statusDesc\":\"subscription failed\"}'","statusTrace":"src/node/api_clients/base_client.py:14: in make_request\n    response.raise_for_status()\n/opt/hostedtoolcache/Python/3.12.7/x64/lib/python3.12/site-packages/requests/models.py:1021: in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nE   requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: http://127.0.0.1:50661/filter/v2/subscriptions\n\nDuring handling of the above exception, another exception occurred:\ntests/sharding/test_filter.py:17: in test_filter_works_with_static_sharding\n    self.subscribe_filter_node(self.node2, content_topics=[self.test_content_topic], pubsub_topic=self.test_pubsub_topic)\nsrc/steps/sharding.py:128: in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\nsrc/node/waku_node.py:355: in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\nsrc/node/api_clients/rest.py:68: in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\nsrc/node/api_clients/rest.py:16: in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\nsrc/node/api_clients/base_client.py:17: in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\nE   Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:50661/filter/v2/subscriptions with response: b'{\"requestId\":\"b4b89240-3a31-4424-b342-008792a286eb\",\"statusDesc\":\"subscription failed\"}'","steps":[{"name":"setup_first_relay_node_with_filter","time":{"start":1732074617357,"stop":1732074618934,"duration":1577},"status":"passed","steps":[{"name":"setup_first_relay_node","time":{"start":1732074617357,"stop":1732074618934,"duration":1577},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"filter","value":"'true'"},{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"setup_second_node_as_filter","time":{"start":1732074618934,"stop":1732074620694,"duration":1760},"status":"passed","steps":[{"name":"add_node_peer","time":{"start":1732074620683,"stop":1732074620694,"duration":11},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"args","value":"(<tests.sharding.test_filter.TestFilterStaticSharding object at 0x7f7ec1bd1340>, <src.node.waku_node.WakuNode object at 0x7f7ec04e75c0>, ['/ip4/172.18.55.220/tcp/21159/p2p/16Uiu2HAky3kLyLZJib3VUDWSRbaHMXSXP2PtDCuMhrnPFxgZCbDz'])"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"subscribe_first_relay_node","time":{"start":1732074620694,"stop":1732074620716,"duration":22},"status":"passed","steps":[{"name":"subscribe_relay_node","time":{"start":1732074620694,"stop":1732074620716,"duration":22},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"node","value":"<src.node.waku_node.WakuNode object at 0x7f7ec1788530>"},{"name":"content_topics","value":"None"},{"name":"pubsub_topics","value":"['/waku/2/rs/2/0']"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"content_topics","value":"None"},{"name":"pubsub_topics","value":"['/waku/2/rs/2/0']"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"subscribe_filter_node","time":{"start":1732074620717,"stop":1732074620727,"duration":10},"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:50661/filter/v2/subscriptions with response: b'{\"requestId\":\"b4b89240-3a31-4424-b342-008792a286eb\",\"statusDesc\":\"subscription failed\"}'\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.7/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/steps/sharding.py\", line 128, in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/waku_node.py\", line 355, in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/rest.py\", line 68, in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/rest.py\", line 16, in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/base_client.py\", line 17, in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\n","steps":[],"attachments":[],"parameters":[{"name":"node","value":"<src.node.waku_node.WakuNode object at 0x7f7ec04e75c0>"},{"name":"content_topics","value":"['/myapp/1/latest/proto']"},{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"e12cc71e12284c09","name":"log","source":"e12cc71e12284c09.txt","type":"text/plain","size":33461}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":7,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"test_setup::0","time":{"start":1732074620776,"stop":1732074620788,"duration":12},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"close_open_nodes::0","time":{"start":1732074620788,"stop":1732074626549,"duration":5761},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"check_waku_log_errors::0","time":{"start":1732074626550,"stop":1732074626567,"duration":17},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"attach_logs_on_fail::0","time":{"start":1732074626568,"stop":1732074626577,"duration":9},"status":"passed","steps":[],"attachments":[{"uid":"7b7f4cc7cdb04c0","name":"node1_2024-11-20_03-50-17__b1f849dd-70bc-42a1-9d7b-ab5bdb49789d__wakuorg_nwaku:latest.log","source":"7b7f4cc7cdb04c0.txt","type":"text/plain","size":121028},{"uid":"4d9e61667aa7125","name":"node2_2024-11-20_03-50-17__b1f849dd-70bc-42a1-9d7b-ab5bdb49789d__wakuorg_go-waku:latest.log","source":"4d9e61667aa7125.txt","type":"text/plain","size":123868}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"set_allure_env_variables::0","time":{"start":1732075071665,"stop":1732075071665,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.sharding"},{"name":"suite","value":"test_filter"},{"name":"subSuite","value":"TestFilterStaticSharding"},{"name":"host","value":"fv-az1249-58"},{"name":"thread","value":"2155-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.sharding.test_filter"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"df4dae896ca5b312","status":"broken","statusDetails":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:60468/filter/v2/subscriptions with response: b'{\"requestId\":\"3dbcd489-d4f9-4da9-ad0d-ad4ed6d0a521\",\"statusDesc\":\"subscription failed\"}'","time":{"start":1732074609354,"stop":1732074612542,"duration":3188}},{"uid":"5cbeeec8588d1ecf","status":"broken","statusDetails":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:36905/filter/v2/subscriptions with response: b'{\"requestId\":\"4c7e3596-3f04-400a-98d3-f675517ae359\",\"statusDesc\":\"subscription failed\"}'","time":{"start":1732074601586,"stop":1732074605252,"duration":3666}}],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":3,"skipped":0,"passed":285,"unknown":0,"total":288},"items":[{"uid":"8027f4b9f461d919","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/364//#testresult/8027f4b9f461d919","status":"broken","statusDetails":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:21911/filter/v2/subscriptions with response: b'{\"requestId\":\"a690e282-423f-48fe-8ec7-4f829842a1e0\",\"statusDesc\":\"subscription failed\"}'","time":{"start":1731988311303,"stop":1731988315377,"duration":4074}},{"uid":"fac705ebaf3c6153","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/363//#testresult/fac705ebaf3c6153","status":"passed","time":{"start":1731926898177,"stop":1731926901580,"duration":3403}},{"uid":"c1b7cae9bac84eff","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/362//#testresult/c1b7cae9bac84eff","status":"passed","time":{"start":1731924829573,"stop":1731924841815,"duration":12242}},{"uid":"51fa6dda7ee5be88","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/361//#testresult/51fa6dda7ee5be88","status":"passed","time":{"start":1731900532981,"stop":1731900536069,"duration":3088}},{"uid":"43111473f694ddb0","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/360//#testresult/43111473f694ddb0","status":"passed","time":{"start":1731814149062,"stop":1731814152195,"duration":3133}},{"uid":"d2d16cf8f9e1be1f","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/359//#testresult/d2d16cf8f9e1be1f","status":"passed","time":{"start":1731727557264,"stop":1731727560588,"duration":3324}},{"uid":"a9523f1ba5ef9893","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/358//#testresult/a9523f1ba5ef9893","status":"passed","time":{"start":1731641213249,"stop":1731641216248,"duration":2999}},{"uid":"502b4bbb08b6bc8a","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/357//#testresult/502b4bbb08b6bc8a","status":"passed","time":{"start":1731554497284,"stop":1731554500492,"duration":3208}},{"uid":"b1bf277e9fb12006","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/356//#testresult/b1bf277e9fb12006","status":"passed","time":{"start":1731468009001,"stop":1731468012539,"duration":3538}},{"uid":"9eb1f5b95f661f82","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/355//#testresult/9eb1f5b95f661f82","status":"passed","time":{"start":1731381460697,"stop":1731381472952,"duration":12255}},{"uid":"8dd094aa5709e6be","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/354//#testresult/8dd094aa5709e6be","status":"passed","time":{"start":1731295295130,"stop":1731295298487,"duration":3357}},{"uid":"69092e8d0fd26bb4","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/353//#testresult/69092e8d0fd26bb4","status":"passed","time":{"start":1731223588511,"stop":1731223591532,"duration":3021}},{"uid":"f331d57187217d6e","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/352//#testresult/f331d57187217d6e","status":"passed","time":{"start":1731208818841,"stop":1731208822513,"duration":3672}},{"uid":"af4c1a7f6f96f7f1","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/351//#testresult/af4c1a7f6f96f7f1","status":"passed","time":{"start":1731122242495,"stop":1731122246058,"duration":3563}},{"uid":"605b63b05fa33710","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/350//#testresult/605b63b05fa33710","status":"passed","time":{"start":1731035897337,"stop":1731035900795,"duration":3458}},{"uid":"85dd2005614deb78","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/349//#testresult/85dd2005614deb78","status":"passed","time":{"start":1730991322073,"stop":1730991325335,"duration":3262}},{"uid":"b983e5c8502cd277","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/348//#testresult/b983e5c8502cd277","status":"passed","time":{"start":1730983353869,"stop":1730983356850,"duration":2981}},{"uid":"7a5a8bf2f0fd1ba8","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/347//#testresult/7a5a8bf2f0fd1ba8","status":"passed","time":{"start":1730981262145,"stop":1730981274731,"duration":12586}},{"uid":"2fb1e680888ec1c","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/346//#testresult/2fb1e680888ec1c","status":"passed","time":{"start":1730980228263,"stop":1730980231570,"duration":3307}},{"uid":"19011d8acb86f2de","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/345//#testresult/19011d8acb86f2de","status":"passed","time":{"start":1730980289283,"stop":1730980292532,"duration":3249}}]},"tags":[]},"source":"de8a31d1e507d3ac.json","parameterValues":[]}