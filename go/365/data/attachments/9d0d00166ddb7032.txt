[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_invalid_payloads with id: 2024-11-20_03-41-08__39aee511-7c80-479c-85d4-00178a319b15
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-20_03-41-08__39aee511-7c80-479c-85d4-00178a319b15__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.181.7
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['24390', '24391', '24392', '24393', '24394']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 24390:24390 -p 24391:24391 -p 24392:24392 -p 24393:24393 -p 24394:24394 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24392 --rest-port=24390 --tcp-port=24391 --discv5-udp-port=24393 --rest-address=0.0.0.0 --nat=extip:172.18.181.7 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ad7a9f2bdfa6bf4c4cede44712db2f8cc4650ffbdbf19e8ebddba7d2b3edacc4 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24394 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.181.7 waku cae44fa79280c000bf9619b2cd65d275f612f03be7afe30f8e03e168ef4fa292
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 832f1ed629ac. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID cae44fa79280. Setting up logs at ./log/docker/receiving_node1_2024-11-20_03-41-08__39aee511-7c80-479c-85d4-00178a319b15__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 24390
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24390/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:24390/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.181.7/tcp/24391/p2p/16Uiu2HAmErumEitroky94wqg1GXPxLhsQ4zpLr1w1RBs66U3i4M1","/ip4/172.18.181.7/tcp/24392/ws/p2p/16Uiu2HAmErumEitroky94wqg1GXPxLhsQ4zpLr1w1RBs66U3i4M1"],"enrUri":"enr:-L24QJj44KcDW-vV9PCSsfHPPjsuE2WyOMLtbppept6lERq6cgOWWSAQY0YE-uXm1szSSqqB4yfUh70esGamOJJPXJUCgmlkgnY0gmlwhKwStQeKbXVsdGlhZGRyc5YACASsErUHBl9HAAoErBK1BwZfSN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIMUoKnjq31i6s7_sSgJmZgXoG0jeOZXOTOmv0bEsCByDdGNwgl9Hg3VkcIJfSYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-20_03-41-08__39aee511-7c80-479c-85d4-00178a319b15__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.97.2
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20986', '20987', '20988', '20989', '20990']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20986:20986 -p 20987:20987 -p 20988:20988 -p 20989:20989 -p 20990:20990 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20988 --rest-port=20986 --tcp-port=20987 --discv5-udp-port=20989 --rest-address=0.0.0.0 --nat=extip:172.18.97.2 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=eb08f0ffe0ef4ecbd190bb49bd2e032e545b7aaea1ebc42ad8e39f52b47afc40 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20990 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.97.2 waku 3dc03e80345491e3c99bc368407f5c1e1c3065d4878e18bc715b471bf2048149
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 3dc03e803454. Setting up logs at ./log/docker/receiving_node2_2024-11-20_03-41-08__39aee511-7c80-479c-85d4-00178a319b15__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 20986
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20986/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20986/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.97.2/tcp/20987/p2p/16Uiu2HAmLmSYbk7pty8CGVsVgmBMkLMbkT1f9NZ98Vn5hhin6i3z","/ip4/172.18.97.2/tcp/20988/ws/p2p/16Uiu2HAmLmSYbk7pty8CGVsVgmBMkLMbkT1f9NZ98Vn5hhin6i3z"],"enrUri":"enr:-L24QHi7n_A8GZsynopCHshYGF7xLPbz_4SW_LZeuejcPq0BSLvKjJB0PuMCSVwO6VoB4LkCmatpkgLBqvrIvCUaVT0CgmlkgnY0gmlwhKwSYQKKbXVsdGlhZGRyc5YACASsEmECBlH7AAoErBJhAgZR_N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeISZWwvZvQD5mfJ7v9LJZZ6EJAwAq49_J7Hy9wepXKmDdGNwglH7g3VkcIJR_YV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20986/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.181.7/tcp/24391/p2p/16Uiu2HAmErumEitroky94wqg1GXPxLhsQ4zpLr1w1RBs66U3i4M1"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-20_03-41-08__39aee511-7c80-479c-85d4-00178a319b15__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.6.155
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['29226', '29227', '29228', '29229', '29230']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 29226:29226 -p 29227:29227 -p 29228:29228 -p 29229:29229 -p 29230:29230 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=29228 --rest-port=29226 --tcp-port=29227 --discv5-udp-port=29229 --rest-address=0.0.0.0 --nat=extip:172.18.6.155 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fff7ee2a2df87c4bcf1acfce2cfae5779e41db022f8fd3f9763fb4ac4b9accdb --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QJj44KcDW-vV9PCSsfHPPjsuE2WyOMLtbppept6lERq6cgOWWSAQY0YE-uXm1szSSqqB4yfUh70esGamOJJPXJUCgmlkgnY0gmlwhKwStQeKbXVsdGlhZGRyc5YACASsErUHBl9HAAoErBK1BwZfSN0DgnJzhQADAQAAiXNlY3AyNTZrMaEDIMUoKnjq31i6s7_sSgJmZgXoG0jeOZXOTOmv0bEsCByDdGNwgl9Hg3VkcIJfSYV3YWt1Mgk --lightpushnode=/ip4/172.18.181.7/tcp/24391/p2p/16Uiu2HAmErumEitroky94wqg1GXPxLhsQ4zpLr1w1RBs66U3i4M1 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.6.155 waku bea6451bc1eceeacb875f60e9d39b2a3215f1e60954f255dfd60e7b57911fba0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID bea6451bc1ec. Setting up logs at ./log/docker/lightpush_node1_2024-11-20_03-41-08__39aee511-7c80-479c-85d4-00178a319b15__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 29226
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:29226/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QGeeKG-e0-xfxHnyZI2pMWu5nybo_pKvQCbAUli-XpSLI5WnvnmY8_uc3IF7cjrXe2qcbhJOUIvh7oL10xp8vjuGAZNHqOiigmlkgnY0gmlwhKwRAAqCcnODAAMAiXNlY3AyNTZrMaEDNSzosHRQloAtu8quySzxzBRjurgT9-Fgww8LmvBmN0KDdGNwgnIrg3VkcIJyLYV3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/29227/p2p/16Uiu2HAmGEZgBM2oL7jaKUDiRWN3cmiSweLwE6yamvi35BCvgoJh","/ip4/127.0.0.1/tcp/29228/ws/p2p/16Uiu2HAmGEZgBM2oL7jaKUDiRWN3cmiSweLwE6yamvi35BCvgoJh","/ip4/172.17.0.10/tcp/29227/p2p/16Uiu2HAmGEZgBM2oL7jaKUDiRWN3cmiSweLwE6yamvi35BCvgoJh","/ip4/172.17.0.10/tcp/29228/ws/p2p/16Uiu2HAmGEZgBM2oL7jaKUDiRWN3cmiSweLwE6yamvi35BCvgoJh"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.181.7/tcp/24391/p2p/16Uiu2HAmErumEitroky94wqg1GXPxLhsQ4zpLr1w1RBs66U3i4M1", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.97.2/tcp/20987/p2p/16Uiu2HAmLmSYbk7pty8CGVsVgmBMkLMbkT1f9NZ98Vn5hhin6i3z", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:24390/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20986/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Empty string
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074073325160448}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:29226/lightpush/v1/message. Response content: b'missing Payload field'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload Unecoded text
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "Hello World!", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074073329777408}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:29226/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A dictionary
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": {"key": "YWFh"}, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074073332977920}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:29226/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload An integer
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": 1234567890, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074073337072128}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:29226/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A list
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": ["YWFh"], "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074073340957440}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:29226/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:35 Running test with payload A bool
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:29226/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": true, "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074073345115136}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:29226/lightpush/v1/message. Response content: b''
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id cae44fa79280
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 3dc03e803454
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container cae44fa79280. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id bea6451bc1ec
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 3dc03e803454. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.