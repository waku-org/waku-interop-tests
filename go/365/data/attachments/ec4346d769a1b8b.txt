[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.68.229
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['59909', '59910', '59911', '59912', '59913']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 59909:59909 -p 59910:59910 -p 59911:59911 -p 59912:59912 -p 59913:59913 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59911 --rest-port=59909 --tcp-port=59910 --discv5-udp-port=59912 --rest-address=0.0.0.0 --nat=extip:172.18.68.229 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4c20d2fbff43ecf4aa8af633cab9fbb610df9a85ede132eb5af5a46e3ecfbd41 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59913 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.68.229 waku 702519a4ee8ec2cb87213d12cab494247cea837e07b71438a76b55abf31be179
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 69aa78010ec0. Exiting log stream.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 702519a4ee8e. Setting up logs at ./log/docker/receiving_node1_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 59909
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59909/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:59909/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.68.229/tcp/59910/p2p/16Uiu2HAm47mSnZSPFR7zCjU3WR2mqfVqvqTZbo4nMGhpoMsfXvg6","/ip4/172.18.68.229/tcp/59911/ws/p2p/16Uiu2HAm47mSnZSPFR7zCjU3WR2mqfVqvqTZbo4nMGhpoMsfXvg6"],"enrUri":"enr:-L24QBWwUNGwHNCKMCSHTuY84rptdipjIJYU5iszTbj66wfKZrvS2nBgrHJdKCegKe9YQHce6XZYhd0I_8w720nOOhgCgmlkgnY0gmlwhKwSROWKbXVsdGlhZGRyc5YACASsEkTlBuoGAAoErBJE5QbqB90DgnJzhQADAQAAiXNlY3AyNTZrMaECgSLoUs9lfZjw6LCjoVj2DE9jSnZc1oHPdIoOwCVzZp-DdGNwguoGg3VkcILqCIV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.193.142
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['4931', '4932', '4933', '4934', '4935']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 4931:4931 -p 4932:4932 -p 4933:4933 -p 4934:4934 -p 4935:4935 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=4933 --rest-port=4931 --tcp-port=4932 --discv5-udp-port=4934 --rest-address=0.0.0.0 --nat=extip:172.18.193.142 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bef9a1ba6f1e1bf4bdfd4a1bd3adbf0fdc1babb854f10ea2e43cbd5c68ffdbeb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=4935 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.193.142 waku 5ece073cbc4015f4fbbaf62237c6ba15769826ca9b169fbdd91ad544d11ee4d1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 5ece073cbc40. Setting up logs at ./log/docker/receiving_node2_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 4931
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4931/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:4931/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.193.142/tcp/4932/p2p/16Uiu2HAmDZaHusDpfT6ConYoSKZjnmHovcbCpWzbZAovKbKDRzyZ","/ip4/172.18.193.142/tcp/4933/ws/p2p/16Uiu2HAmDZaHusDpfT6ConYoSKZjnmHovcbCpWzbZAovKbKDRzyZ"],"enrUri":"enr:-L24QKQ6nYdzjPZ4FyIoJQrPMYnU1iuq2g81d9teTl6sb1-LPUcWBz31QlVvE_00pDHXB7XQy0ncbvxhv_We9_sDkbkCgmlkgnY0gmlwhKwSwY6KbXVsdGlhZGRyc5YACASsEsGOBhNEAAoErBLBjgYTRd0DgnJzhQADAQAAiXNlY3AyNTZrMaEDDXiUhKP7eGUzitzxS1wmovKYQ-x1WrGxE6xL9Ot-5hSDdGNwghNEg3VkcIITRoV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4931/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.68.229/tcp/59910/p2p/16Uiu2HAm47mSnZSPFR7zCjU3WR2mqfVqvqTZbo4nMGhpoMsfXvg6"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.157.166
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['52886', '52887', '52888', '52889', '52890']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 52886:52886 -p 52887:52887 -p 52888:52888 -p 52889:52889 -p 52890:52890 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=52888 --rest-port=52886 --tcp-port=52887 --discv5-udp-port=52889 --rest-address=0.0.0.0 --nat=extip:172.18.157.166 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cd47bcab3ffca81cef312d3d4e71ed2fcb2cf4208bbfe81eaeb201cea34fee2c --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QBWwUNGwHNCKMCSHTuY84rptdipjIJYU5iszTbj66wfKZrvS2nBgrHJdKCegKe9YQHce6XZYhd0I_8w720nOOhgCgmlkgnY0gmlwhKwSROWKbXVsdGlhZGRyc5YACASsEkTlBuoGAAoErBJE5QbqB90DgnJzhQADAQAAiXNlY3AyNTZrMaECgSLoUs9lfZjw6LCjoVj2DE9jSnZc1oHPdIoOwCVzZp-DdGNwguoGg3VkcILqCIV3YWt1Mgk --lightpushnode=/ip4/172.18.68.229/tcp/59910/p2p/16Uiu2HAm47mSnZSPFR7zCjU3WR2mqfVqvqTZbo4nMGhpoMsfXvg6 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.172.226
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['5059', '5060', '5061', '5062', '5063']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 5059:5059 -p 5060:5060 -p 5061:5061 -p 5062:5062 -p 5063:5063 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=5061 --rest-port=5059 --tcp-port=5060 --discv5-udp-port=5062 --rest-address=0.0.0.0 --nat=extip:172.18.172.226 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=d8ddafa5b3dab548663dcb86648b0afe98f2bdafbef99ad7af928a0001283f3a --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QBWwUNGwHNCKMCSHTuY84rptdipjIJYU5iszTbj66wfKZrvS2nBgrHJdKCegKe9YQHce6XZYhd0I_8w720nOOhgCgmlkgnY0gmlwhKwSROWKbXVsdGlhZGRyc5YACASsEkTlBuoGAAoErBJE5QbqB90DgnJzhQADAQAAiXNlY3AyNTZrMaECgSLoUs9lfZjw6LCjoVj2DE9jSnZc1oHPdIoOwCVzZp-DdGNwguoGg3VkcILqCIV3YWt1Mgk --lightpushnode=/ip4/172.18.68.229/tcp/59910/p2p/16Uiu2HAm47mSnZSPFR7zCjU3WR2mqfVqvqTZbo4nMGhpoMsfXvg6 --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.172.226 waku ad2d61b2abb4d08481103d4b79584268f4c4ead7999dd8a6ea8883db1e249a52
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID ad2d61b2abb4. Setting up logs at ./log/docker/lightpush_node1_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 5059
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:5059/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QCud_o89bFbm4IR-RvkT2tIiQxLz4BgZom3NVCmHg4KrPA0KPv9kbh4VI4QG0fR2_smbbprfkb2-89Oba3bql6WGAZNHq9cjgmlkgnY0gmlwhKwRAAqCcnODAAMAiXNlY3AyNTZrMaECHWXw4rlr48YAfZk8bRPOzrPB8wYTXlM0PS0hUAjXHduDdGNwghPEg3VkcIITxoV3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/5060/p2p/16Uiu2HAkwQRxeq493SjzgSwtEHdts8DJbVvRctdJmLjDz4tu8Cpr","/ip4/127.0.0.1/tcp/5061/ws/p2p/16Uiu2HAkwQRxeq493SjzgSwtEHdts8DJbVvRctdJmLjDz4tu8Cpr","/ip4/172.17.0.10/tcp/5060/p2p/16Uiu2HAkwQRxeq493SjzgSwtEHdts8DJbVvRctdJmLjDz4tu8Cpr","/ip4/172.17.0.10/tcp/5061/ws/p2p/16Uiu2HAkwQRxeq493SjzgSwtEHdts8DJbVvRctdJmLjDz4tu8Cpr"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5059/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.68.229/tcp/59910/p2p/16Uiu2HAm47mSnZSPFR7zCjU3WR2mqfVqvqTZbo4nMGhpoMsfXvg6", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5059/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.193.142/tcp/4932/p2p/16Uiu2HAmDZaHusDpfT6ConYoSKZjnmHovcbCpWzbZAovKbKDRzyZ", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:59909/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:4931/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5059/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074265447164928, "ephemeral": true}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:5059/lightpush/v1/message. Response content: b'lightpush error'
[31m[1mERROR   [0m tests.light_push.test_publish:test_publish.py:218 Light push message with Ephemeral True failed: Error: 503 Server Error: Service Unavailable for url: http://127.0.0.1:5059/lightpush/v1/message with response: b'lightpush error'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:5059/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074265463755008, "ephemeral": false}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:5059/lightpush/v1/message. Response content: b'lightpush error'
[31m[1mERROR   [0m tests.light_push.test_publish:test_publish.py:218 Light push message with Ephemeral False failed: Error: 503 Server Error: Service Unavailable for url: http://127.0.0.1:5059/lightpush/v1/message with response: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 702519a4ee8e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 5ece073cbc40
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 702519a4ee8e. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id ad2d61b2abb4
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 5ece073cbc40. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node2_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-20_03-44-19__5cef5419-d708-4b56-ba0c-71da3487e8f8__wakuorg_nwaku:latest.log
[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.94.199
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['14470', '14471', '14472', '14473', '14474']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 14470:14470 -p 14471:14471 -p 14472:14472 -p 14473:14473 -p 14474:14474 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=14472 --rest-port=14470 --tcp-port=14471 --discv5-udp-port=14473 --rest-address=0.0.0.0 --nat=extip:172.18.94.199 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e053da88dc2b15904b7ce0bccae2bb4fadbdc3fb78a2bab73c010babaa3a70c9 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=14474 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.94.199 waku b6f4572ccfa5ecfdea696fe805927d3d1a8221eb1fe8be4ba19c1693d80504c6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID b6f4572ccfa5. Setting up logs at ./log/docker/receiving_node1_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 14470
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container ad2d61b2abb4. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14470/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:14470/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.94.199/tcp/14471/p2p/16Uiu2HAmU1rL9JVZi5t6L1gZZaUGQnjYU3s86GmCvSxyXy1fvDWh","/ip4/172.18.94.199/tcp/14472/ws/p2p/16Uiu2HAmU1rL9JVZi5t6L1gZZaUGQnjYU3s86GmCvSxyXy1fvDWh"],"enrUri":"enr:-L24QFqScdX4MmFm1nOsPx_6NOkWuYAkWIZwWfx23idAlRw7P4kfkw2vV50lADjR50t8NxOduqSffucKBeMgCUNJBUwCgmlkgnY0gmlwhKwSXseKbXVsdGlhZGRyc5YACASsEl7HBjiHAAoErBJexwY4iN0DgnJzhQADAQAAiXNlY3AyNTZrMaED5Ddu06qMAI8-8rZMdrVJ4hjpFW-xvf0g6M1a6IY2ohKDdGNwgjiHg3VkcII4iYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.247.107
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['8947', '8948', '8949', '8950', '8951']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 8947:8947 -p 8948:8948 -p 8949:8949 -p 8950:8950 -p 8951:8951 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=8949 --rest-port=8947 --tcp-port=8948 --discv5-udp-port=8950 --rest-address=0.0.0.0 --nat=extip:172.18.247.107 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=aa33ebe33ee33fbbbefd3daf6d3e1d9cc12ccac6b58a6a9355987c5a05e18982 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=8951 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.247.107 waku 35d46b78f408aab123e0085fee3451db674b86ceed36f9b15986bbb84cfa921e
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 35d46b78f408. Setting up logs at ./log/docker/receiving_node2_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 8947
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8947/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:8947/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.247.107/tcp/8948/p2p/16Uiu2HAmLrq97QGH9USk9NgnS1LL2Z2EZ93NJTtZ1fQjcBhqJ74C","/ip4/172.18.247.107/tcp/8949/ws/p2p/16Uiu2HAmLrq97QGH9USk9NgnS1LL2Z2EZ93NJTtZ1fQjcBhqJ74C"],"enrUri":"enr:-L24QEpkKZM2lpo8DSEvV330qcyj8ZUbhGNvS_6tW_bH-aTJRohl_sUelM005oaja2T403I6gJEt4QXB9nJ4Y5GETHACgmlkgnY0gmlwhKwS92uKbXVsdGlhZGRyc5YACASsEvdrBiL0AAoErBL3awYi9d0DgnJzhQADAQAAiXNlY3AyNTZrMaEDeeYNJkC5sc-FEr0QrhBLbUTbsK4k4FxHwOW34VtbJjmDdGNwgiL0g3VkcIIi9oV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8947/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.94.199/tcp/14471/p2p/16Uiu2HAmU1rL9JVZi5t6L1gZZaUGQnjYU3s86GmCvSxyXy1fvDWh"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.9.141
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['7280', '7281', '7282', '7283', '7284']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 7280:7280 -p 7281:7281 -p 7282:7282 -p 7283:7283 -p 7284:7284 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=7282 --rest-port=7280 --tcp-port=7281 --discv5-udp-port=7283 --rest-address=0.0.0.0 --nat=extip:172.18.9.141 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e5e3beb3f2efeef33ed5fd64d4ab8c81b8e47b3f72e6df17cde6abd6eae9bba7 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QFqScdX4MmFm1nOsPx_6NOkWuYAkWIZwWfx23idAlRw7P4kfkw2vV50lADjR50t8NxOduqSffucKBeMgCUNJBUwCgmlkgnY0gmlwhKwSXseKbXVsdGlhZGRyc5YACASsEl7HBjiHAAoErBJexwY4iN0DgnJzhQADAQAAiXNlY3AyNTZrMaED5Ddu06qMAI8-8rZMdrVJ4hjpFW-xvf0g6M1a6IY2ohKDdGNwgjiHg3VkcII4iYV3YWt1Mgk --lightpushnode=/ip4/172.18.94.199/tcp/14471/p2p/16Uiu2HAmU1rL9JVZi5t6L1gZZaUGQnjYU3s86GmCvSxyXy1fvDWh --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.9.141 waku 24fe1795ffc1ee433a431cb1b08219988fb00874f9c355bedc11a8e6ad5d6b79
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 24fe1795ffc1. Setting up logs at ./log/docker/lightpush_node1_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 7280
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:7280/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QOqwo3XwXlH776KCMUd0G7nuTngO1eojyrT-ul3x-USpQb3VOZPZnHm6J7OuwCGkgry3l9rteTK3_dEkk0_n3AOGAZNHrAg4gmlkgnY0gmlwhKwRAAuCcnODAAMAiXNlY3AyNTZrMaEDBnfcrRdMasEOLKb1vXuY8rBIUQZg0KOgkiZdwHy-m2yDdGNwghxxg3VkcIIcc4V3YWt1Mgg","listenAddresses":["/ip4/127.0.0.1/tcp/7281/p2p/16Uiu2HAmD6EoYrZGqK7WrZhBmHM7GY7zvtGRYsTq6JCPAFFDEG4T","/ip4/127.0.0.1/tcp/7282/ws/p2p/16Uiu2HAmD6EoYrZGqK7WrZhBmHM7GY7zvtGRYsTq6JCPAFFDEG4T","/ip4/172.17.0.11/tcp/7281/p2p/16Uiu2HAmD6EoYrZGqK7WrZhBmHM7GY7zvtGRYsTq6JCPAFFDEG4T","/ip4/172.17.0.11/tcp/7282/ws/p2p/16Uiu2HAmD6EoYrZGqK7WrZhBmHM7GY7zvtGRYsTq6JCPAFFDEG4T"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7280/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.94.199/tcp/14471/p2p/16Uiu2HAmU1rL9JVZi5t6L1gZZaUGQnjYU3s86GmCvSxyXy1fvDWh", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7280/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.247.107/tcp/8948/p2p/16Uiu2HAmLrq97QGH9USk9NgnS1LL2Z2EZ93NJTtZ1fQjcBhqJ74C", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:14470/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:8947/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7280/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074278031037952, "ephemeral": true}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:7280/lightpush/v1/message. Response content: b'lightpush error'
[31m[1mERROR   [0m tests.light_push.test_publish:test_publish.py:218 Light push message with Ephemeral True failed: Error: 503 Server Error: Service Unavailable for url: http://127.0.0.1:7280/lightpush/v1/message with response: b'lightpush error'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:7280/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1732074278050719744, "ephemeral": false}}'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 503 Server Error: Service Unavailable for url: http://127.0.0.1:7280/lightpush/v1/message. Response content: b'lightpush error'
[31m[1mERROR   [0m tests.light_push.test_publish:test_publish.py:218 Light push message with Ephemeral False failed: Error: 503 Server Error: Service Unavailable for url: http://127.0.0.1:7280/lightpush/v1/message with response: b'lightpush error'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id b6f4572ccfa5
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 35d46b78f408
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container b6f4572ccfa5. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 24fe1795ffc1
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 35d46b78f408. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m tests.conftest:conftest.py:73 Running fixture teardown: attach_logs_on_fail
[35mDEBUG   [0m tests.conftest:conftest.py:74 Test failed, attempting to attach logs to the allure reports
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/lightpush_node1_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node2_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.libs.common:common.py:30 Attaching file ./log/docker/receiving_node1_2024-11-20_03-44-32__6519f38a-fc65-42b0-94b3-913884e6c672__wakuorg_nwaku:latest.log