[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_store_node_restarts with id: 2024-11-06_10-17-05__d4478629-810b-45e0-9bb2-8aece9232300
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:39 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-11-06_10-17-05__d4478629-810b-45e0-9bb2-8aece9232300__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.3.208
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20690', '20691', '20692', '20693', '20694']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20690:20690 -p 20691:20691 -p 20692:20692 -p 20693:20693 -p 20694:20694 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20692 --rest-port=20690 --tcp-port=20691 --discv5-udp-port=20693 --rest-address=0.0.0.0 --nat=extip:172.18.3.208 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c7bfd1d0ee6fe5add6465af15cdd8f4b0aca2e0eabcdb7ac5f42bef43ddf04cd --max-connections=1000 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20694 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.3.208 waku 6c6de9b9b7655048a3f45a8461c31e117ef894ba87c303c17247f3d35c4e3439
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 6c6de9b9b765. Setting up logs at ./log/docker/publishing_node1_2024-11-06_10-17-05__d4478629-810b-45e0-9bb2-8aece9232300__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/nwaku:latest. REST: 20690
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 37d97d6e9811. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20690/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:278 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20690/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.3.208/tcp/20691/p2p/16Uiu2HAmNCmLz7qV6gEkkdAbZpvgVgjikGno2sUVTAV6DQeSSPvg","/ip4/172.18.3.208/tcp/20692/ws/p2p/16Uiu2HAmNCmLz7qV6gEkkdAbZpvgVgjikGno2sUVTAV6DQeSSPvg"],"enrUri":"enr:-L24QL5siZpsUxMQHdLkDtX-Z9oseSy2KW50uWy2cK_u7CzMPTjJyTOhpeRoAQXGCCphmyvizBKTOx8g-4rNmY5-9WUCgmlkgnY0gmlwhKwSA9CKbXVsdGlhZGRyc5YACASsEgPQBlDTAAoErBID0AZQ1N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDjd0QKojHEdlP3RSjtnTRuYozijTTd3hv6xdkwQA2oJmDdGNwglDTg3VkcIJQ1YV3YWt1MgM"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-11-06_10-17-05__d4478629-810b-45e0-9bb2-8aece9232300__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.124.128
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['18131', '18132', '18133', '18134', '18135']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:435 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:164 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:166 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 18131:18131 -p 18132:18132 -p 18133:18133 -p 18134:18134 -p 18135:18135 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=18133 --rest-port=18131 --tcp-port=18132 --discv5-udp-port=18134 --rest-address=0.0.0.0 --nat=extip:172.18.124.128 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=bcceb09df89cd5dcc4dce032aaecc1cbed8b3dfb2ddd05ddfb7843bbfdef7ce2 --max-connections=1000 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QL5siZpsUxMQHdLkDtX-Z9oseSy2KW50uWy2cK_u7CzMPTjJyTOhpeRoAQXGCCphmyvizBKTOx8g-4rNmY5-9WUCgmlkgnY0gmlwhKwSA9CKbXVsdGlhZGRyc5YACASsEgPQBlDTAAoErBID0AZQ1N0DgnJzhQADAQAAiXNlY3AyNTZrMaEDjd0QKojHEdlP3RSjtnTRuYozijTTd3hv6xdkwQA2oJmDdGNwglDTg3VkcIJQ1YV3YWt1MgM --storenode=/ip4/172.18.3.208/tcp/20691/p2p/16Uiu2HAmNCmLz7qV6gEkkdAbZpvgVgjikGno2sUVTAV6DQeSSPvg --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.124.128 waku 8022a8a7ac75250b77eef4734150f0d8a6e16839c26cf273d47694110a74997c
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 8022a8a7ac75. Setting up logs at ./log/docker/store_node1_2024-11-06_10-17-05__d4478629-810b-45e0-9bb2-8aece9232300__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:178 Started container from image wakuorg/go-waku:latest. REST: 18131
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18131/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QDJqJctAWaB9_Gk2pLHRmSrg08QNJ0qhIvILOPtu9a_BG61PK6clR0YurEQ5cfWSZZcCj780LnsLlimg1TwWqMiGAZMA-l1bgmlkgnY0gmlwhKwRAAOJc2VjcDI1NmsxoQJv7rhyxs78au61ZI2oF_MWexvSoyA4aIgC6fyH6xsHcoN0Y3CCRtSDdWRwgkbWhXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/18132/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5","/ip4/127.0.0.1/tcp/18133/ws/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5","/ip4/172.17.0.3/tcp/18132/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5","/ip4/172.17.0.3/tcp/18133/ws/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18131/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.3.208/tcp/20691/p2p/16Uiu2HAmNCmLz7qV6gEkkdAbZpvgVgjikGno2sUVTAV6DQeSSPvg", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20690/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18131/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20690/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20690/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"YH+XDn6NuXc3F5r413Fxejl+B3mJrBpwcZfRuIhd5ew="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18131/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"adc942e814b667b02a1d36573756bdf325ad3d3b8ef8945ca7d8b4e0e83a5bdf","status_code":200,"status_desc":"OK","messages":[{"message_hash":"YH+XDn6NuXc3F5r413Fxejl+B3mJrBpwcZfRuIhd5ew="}]}'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:245 Restarting container with id 8022a8a7ac75
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18131/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18131/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QDeYv4JYK9SLyumQRxa8pY4WVBUSfZrK48ptkDENlHghMqwwXEqD9Qhqt0GB44juzN-fQNFX0pCr4atHo6GJZsSGAZMA-nCkgmlkgnY0gmlwhKwRAAOJc2VjcDI1NmsxoQJv7rhyxs78au61ZI2oF_MWexvSoyA4aIgC6fyH6xsHcoN0Y3CCRtSDdWRwgkbWhXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/18132/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5","/ip4/127.0.0.1/tcp/18133/ws/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5","/ip4/172.17.0.3/tcp/18132/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5","/ip4/172.17.0.3/tcp/18133/ws/p2p/16Uiu2HAm2xcMqYTf8BRwzjFSVbGMsxUynfS7gni1ZK4BnRf5WxS5"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:283 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:18131/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20690/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20690/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"YH+XDn6NuXc3F5r413Fxejl+B3mJrBpwcZfRuIhd5ew="},{"messageHash":"2mXxEv5t/fJOd9XnR2/g31/PXh6DtWjx5bPpkIaYZ0g="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18131/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"2998f2e7781a34140c4bbc50277e260efb39b71f8ae7a448a2c303837ebe36c4","status_code":200,"status_desc":"OK","messages":[{"message_hash":"YH+XDn6NuXc3F5r413Fxejl+B3mJrBpwcZfRuIhd5ew="},{"message_hash":"2mXxEv5t/fJOd9XnR2/g31/PXh6DtWjx5bPpkIaYZ0g="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20690/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"YH+XDn6NuXc3F5r413Fxejl+B3mJrBpwcZfRuIhd5ew="},{"messageHash":"2mXxEv5t/fJOd9XnR2/g31/PXh6DtWjx5bPpkIaYZ0g="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:18131/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"33402218160d508dd822ffb33f99bda33c189895eb2e000f34ee602e2fdaa1a0","status_code":200,"status_desc":"OK","messages":[{"message_hash":"YH+XDn6NuXc3F5r413Fxejl+B3mJrBpwcZfRuIhd5ew="},{"message_hash":"2mXxEv5t/fJOd9XnR2/g31/PXh6DtWjx5bPpkIaYZ0g="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 6c6de9b9b765
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:222 Stopping container with id 8022a8a7ac75
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 6c6de9b9b765. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:229 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.