2025-02-08 03:04:25.448 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 03:04:25.450 DEBUG [tests.conftest] Running test: test_main_node_only_lightpush__peer_full with id: 2025-02-08_03-04-25__6ab1418d-9615-41b4-9685-462209d9301a
2025-02-08 03:04:25.450 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 03:04:25.450 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-08 03:04:25.458 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 03:04:25.458 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-08_03-04-25__6ab1418d-9615-41b4-9685-462209d9301a__wakuorg_nwaku:latest.log
2025-02-08 03:04:25.458 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 03:04:25.458 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 03:04:25.460 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 03:04:25.460 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.232.15
2025-02-08 03:04:25.460 DEBUG [src.node.docker_mananger] Generated ports ['12268', '12269', '12270', '12271', '12272']
2025-02-08 03:04:25.460 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 03:04:25.460 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 03:04:25.460 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 03:04:25.461 DEBUG [src.node.docker_mananger] docker run -i -t -p 12268:12268 -p 12269:12269 -p 12270:12270 -p 12271:12271 -p 12272:12272 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=12270 --rest-port=12268 --tcp-port=12269 --discv5-udp-port=12271 --rest-address=0.0.0.0 --nat=extip:172.18.232.15 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=fb275a0f1c534e69e9fef1504d22afc8b7df41ef2cfac20ccd318efefd9d58f1 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=12272 --metrics-logging=true --lightpush=true --relay=true --filter=true
2025-02-08 03:04:25.689 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.232.15 waku 3083f49e7a7115eda92494a09e29030d3241d689f1d470ae572f6ced4e334e2e
2025-02-08 03:04:25.737 ERROR [src.node.docker_mananger] Max retries reached for container 3a49b8e3f1a5. Exiting log stream.
2025-02-08 03:04:25.737 DEBUG [src.node.docker_mananger] Container started with ID 3083f49e7a71. Setting up logs at ./log/docker/receiving_node1_2025-02-08_03-04-25__6ab1418d-9615-41b4-9685-462209d9301a__wakuorg_nwaku:latest.log
2025-02-08 03:04:25.738 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 12268
2025-02-08 03:04:25.739 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 03:04:26.264 ERROR [src.node.docker_mananger] Max retries reached for container 1692cb247251. Exiting log stream.
2025-02-08 03:04:26.739 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12268/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:04:26.742 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 03:04:26.742 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 03:04:26.742 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12268/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:04:26.744 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.232.15/tcp/12269/p2p/16Uiu2HAkzZRYTBCm2atrPp81Prmo5Jg9238mSSeetACgWMLCccAQ","/ip4/172.18.232.15/tcp/12270/ws/p2p/16Uiu2HAkzZRYTBCm2atrPp81Prmo5Jg9238mSSeetACgWMLCccAQ"],"enrUri":"enr:-L24QJEq6dQLXbEspYgBE52DIfXsXrlU1Vw0w2boRvoXNH90JBQtvfY984_cY-6CKz1iuyJ2ZwHYfAzAImDuk_4o0vcCgmlkgnY0gmlwhKwS6A-KbXVsdGlhZGRyc5YACASsEugPBi_tAAoErBLoDwYv7t0DgnJzhQADAQAAiXNlY3AyNTZrMaECTEbB2ZR1OitctP5puHnEPUackWEt2N0e5Bzlk4CgapWDdGNwgi_tg3VkcIIv74V3YWt1Mg0"}'
2025-02-08 03:04:26.745 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 03:04:26.751 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 03:04:26.751 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-08_03-04-25__6ab1418d-9615-41b4-9685-462209d9301a__wakuorg_nwaku:latest.log
2025-02-08 03:04:26.751 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 03:04:26.751 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 03:04:26.753 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 03:04:26.753 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.34.41
2025-02-08 03:04:26.753 DEBUG [src.node.docker_mananger] Generated ports ['26129', '26130', '26131', '26132', '26133']
2025-02-08 03:04:26.753 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 03:04:26.754 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 03:04:26.754 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 03:04:26.754 DEBUG [src.node.docker_mananger] docker run -i -t -p 26129:26129 -p 26130:26130 -p 26131:26131 -p 26132:26132 -p 26133:26133 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=26131 --rest-port=26129 --tcp-port=26130 --discv5-udp-port=26132 --rest-address=0.0.0.0 --nat=extip:172.18.34.41 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c12bcee7b41ee03dcccade9e18609b4efe58b5ccca3e0a3f5ebfa8dbe4ff700a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=26133 --metrics-logging=true --lightpush=false --relay=true
2025-02-08 03:04:26.973 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.34.41 waku 2877d910128e834c8288e8a88fdb12b0c06f70ba1d172d8ee5fd8702af1a1044
2025-02-08 03:04:27.024 DEBUG [src.node.docker_mananger] Container started with ID 2877d910128e. Setting up logs at ./log/docker/receiving_node2_2025-02-08_03-04-25__6ab1418d-9615-41b4-9685-462209d9301a__wakuorg_nwaku:latest.log
2025-02-08 03:04:27.024 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 26129
2025-02-08 03:04:27.024 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 03:04:28.025 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26129/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:04:28.028 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 03:04:28.028 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 03:04:28.028 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26129/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:04:28.030 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.34.41/tcp/26130/p2p/16Uiu2HAmGawMHJkFyJTMSyS98hxs1tHJ4W7Eyfmk3vedTNTRnfQ7","/ip4/172.18.34.41/tcp/26131/ws/p2p/16Uiu2HAmGawMHJkFyJTMSyS98hxs1tHJ4W7Eyfmk3vedTNTRnfQ7"],"enrUri":"enr:-L24QET6vAkQz7FJEVR4YXiWhhf_fM2g6SF4i3xLy7Rkab3KdXDZMo5PiVSKc-uMqSxO5QyKyrsBLPuAHGoQez0nKEcCgmlkgnY0gmlwhKwSIimKbXVsdGlhZGRyc5YACASsEiIpBmYSAAoErBIiKQZmE90DgnJzhQADAQAAiXNlY3AyNTZrMaEDOmUIPoLxHWDDaD1_Lj8ZwyiwijItFzbWewrXt39PS5yDdGNwgmYSg3VkcIJmFIV3YWt1MgE"}'
2025-02-08 03:04:28.030 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 03:04:28.031 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26129/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.232.15/tcp/12269/p2p/16Uiu2HAkzZRYTBCm2atrPp81Prmo5Jg9238mSSeetACgWMLCccAQ"]'
2025-02-08 03:04:28.071 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 03:04:28.079 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-08 03:04:28.080 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-08_03-04-25__6ab1418d-9615-41b4-9685-462209d9301a__wakuorg_go-waku:latest.log
2025-02-08 03:04:28.080 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 03:04:28.080 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 03:04:28.081 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 03:04:28.081 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.74.71
2025-02-08 03:04:28.082 DEBUG [src.node.docker_mananger] Generated ports ['2374', '2375', '2376', '2377', '2378']
2025-02-08 03:04:28.082 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 03:04:28.082 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 03:04:28.082 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 03:04:28.082 DEBUG [src.node.docker_mananger] docker run -i -t -p 2374:2374 -p 2375:2375 -p 2376:2376 -p 2377:2377 -p 2378:2378 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=2376 --rest-port=2374 --tcp-port=2375 --discv5-udp-port=2377 --rest-address=0.0.0.0 --nat=extip:172.18.74.71 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e3fb61e74d5caec4bd4322eacc0a7ff2aed8a67d1f79086ad84544fdbd823bbb --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QJEq6dQLXbEspYgBE52DIfXsXrlU1Vw0w2boRvoXNH90JBQtvfY984_cY-6CKz1iuyJ2ZwHYfAzAImDuk_4o0vcCgmlkgnY0gmlwhKwS6A-KbXVsdGlhZGRyc5YACASsEugPBi_tAAoErBLoDwYv7t0DgnJzhQADAQAAiXNlY3AyNTZrMaECTEbB2ZR1OitctP5puHnEPUackWEt2N0e5Bzlk4CgapWDdGNwgi_tg3VkcIIv74V3YWt1Mg0 --lightpushnode=/ip4/172.18.232.15/tcp/12269/p2p/16Uiu2HAkzZRYTBCm2atrPp81Prmo5Jg9238mSSeetACgWMLCccAQ --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-08 03:04:28.324 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.74.71 waku 9a15141057898af3d239b44c75a6e079fc2f8abac628eb02816b1602a9bf0167
2025-02-08 03:04:28.381 DEBUG [src.node.docker_mananger] Container started with ID 9a1514105789. Setting up logs at ./log/docker/lightpush_node1_2025-02-08_03-04-25__6ab1418d-9615-41b4-9685-462209d9301a__wakuorg_go-waku:latest.log
2025-02-08 03:04:28.382 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 2374
2025-02-08 03:04:28.382 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 03:04:29.382 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:2374/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:04:29.385 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QPpHnbonz_DLy8AkZlEllRVV_fDdaAmQZeLVq4_GlfO9NKwI5Uh6wq2l1DBeWbpim5slfXtWWTxLo2Jwddu-EUSGAZTjhAfWgmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQN4vUI6sG9A_2HxrksGrgQUkHggRjik1AD2Xl_tYWwPpoN0Y3CCCUeDdWRwgglJhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/2375/p2p/16Uiu2HAmLnJez6Y8LDhvkhH9tidiNWLBPaYHTSrVvr4bEFU5LmLH","/ip4/127.0.0.1/tcp/2376/ws/p2p/16Uiu2HAmLnJez6Y8LDhvkhH9tidiNWLBPaYHTSrVvr4bEFU5LmLH","/ip4/172.17.0.4/tcp/2375/p2p/16Uiu2HAmLnJez6Y8LDhvkhH9tidiNWLBPaYHTSrVvr4bEFU5LmLH","/ip4/172.17.0.4/tcp/2376/ws/p2p/16Uiu2HAmLnJez6Y8LDhvkhH9tidiNWLBPaYHTSrVvr4bEFU5LmLH"]}'
2025-02-08 03:04:29.385 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 03:04:29.385 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2374/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.232.15/tcp/12269/p2p/16Uiu2HAkzZRYTBCm2atrPp81Prmo5Jg9238mSSeetACgWMLCccAQ", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-08 03:04:29.387 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-08 03:04:29.388 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2374/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.34.41/tcp/26130/p2p/16Uiu2HAmGawMHJkFyJTMSyS98hxs1tHJ4W7Eyfmk3vedTNTRnfQ7", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-08 03:04:29.403 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-08 03:04:29.404 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12268/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 03:04:29.409 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 03:04:29.410 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:26129/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
2025-02-08 03:04:29.415 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 03:04:29.416 DEBUG [src.steps.light_push] Lightpushing message
2025-02-08 03:04:29.416 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:2374/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1738983869416456704}}'
2025-02-08 03:04:29.424 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-08 03:04:29.424 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-08 03:04:29.525 DEBUG [src.steps.light_push] Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
2025-02-08 03:04:29.525 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12268/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:04:29.527 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738983869416456704,"ephemeral":false}]'
2025-02-08 03:04:29.529 DEBUG [src.steps.light_push] Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
2025-02-08 03:04:29.529 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:26129/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:04:29.531 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1738983869416456704,"ephemeral":false}]'
2025-02-08 03:04:29.534 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 03:04:29.535 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 03:04:29.535 DEBUG [src.node.waku_node] Stopping container with id 3083f49e7a71
2025-02-08 03:04:30.110 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 03:04:30.110 DEBUG [src.node.waku_node] Stopping container with id 2877d910128e
2025-02-08 03:04:30.922 ERROR [src.node.docker_mananger] Max retries reached for container 3083f49e7a71. Exiting log stream.
2025-02-08 03:04:31.609 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 03:04:31.609 DEBUG [src.node.waku_node] Stopping container with id 9a1514105789
2025-02-08 03:04:32.101 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 03:04:32.102 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 03:04:32.110 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 03:04:32.121 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 03:04:32.124 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
