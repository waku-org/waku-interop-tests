2025-02-08 03:06:53.166 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-08 03:06:53.166 DEBUG [tests.conftest] Running test: test_metrics_after_light_push with id: 2025-02-08_03-06-53__86984fb1-32bb-4056-a70b-98dc77e689f8
2025-02-08 03:06:53.167 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-08 03:06:53.167 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-08 03:06:53.167 DEBUG [src.steps.light_push] Running fixture setup: light_push_setup
2025-02-08 03:06:53.167 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-08 03:06:53.168 DEBUG [src.steps.store] Running fixture setup: store_setup
2025-02-08 03:06:53.174 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 03:06:53.174 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node1_2025-02-08_03-06-53__86984fb1-32bb-4056-a70b-98dc77e689f8__wakuorg_nwaku:latest.log
2025-02-08 03:06:53.174 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 03:06:53.174 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 03:06:53.176 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 03:06:53.176 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.239.129
2025-02-08 03:06:53.176 DEBUG [src.node.docker_mananger] Generated ports ['49800', '49801', '49802', '49803', '49804']
2025-02-08 03:06:53.176 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 03:06:53.176 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 03:06:53.176 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 03:06:53.177 DEBUG [src.node.docker_mananger] docker run -i -t -p 49800:49800 -p 49801:49801 -p 49802:49802 -p 49803:49803 -p 49804:49804 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=49802 --rest-port=49800 --tcp-port=49801 --discv5-udp-port=49803 --rest-address=0.0.0.0 --nat=extip:172.18.239.129 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=b5937bc0d4747d5dcdadff2ae8edbcd290e4b1bdeeb89921c3584ae28f0c2aca --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=49804 --metrics-logging=true --lightpush=true --relay=true
2025-02-08 03:06:53.399 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.239.129 waku 7fb3c0a72cce221db86d8be8a239ee911796e547a4ac3b60990bfeb61fef86ec
2025-02-08 03:06:53.445 DEBUG [src.node.docker_mananger] Container started with ID 7fb3c0a72cce. Setting up logs at ./log/docker/receiving_node1_2025-02-08_03-06-53__86984fb1-32bb-4056-a70b-98dc77e689f8__wakuorg_nwaku:latest.log
2025-02-08 03:06:53.445 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 49800
2025-02-08 03:06:53.446 ERROR [src.node.docker_mananger] Max retries reached for container d7ae383c5c65. Exiting log stream.
2025-02-08 03:06:53.447 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 03:06:53.962 ERROR [src.node.docker_mananger] Max retries reached for container cc54290fa754. Exiting log stream.
2025-02-08 03:06:54.448 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49800/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:06:54.451 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 03:06:54.451 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 03:06:54.451 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49800/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:06:54.453 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.239.129/tcp/49801/p2p/16Uiu2HAmPuGxnCPaPzwByQska4P5c8S9NxQKd9a7auddNSzFzWEw","/ip4/172.18.239.129/tcp/49802/ws/p2p/16Uiu2HAmPuGxnCPaPzwByQska4P5c8S9NxQKd9a7auddNSzFzWEw"],"enrUri":"enr:-L24QNHzuOEnts5rjO9vvR4BPFb4L0A9lbtN0pbPBCwmgtxsCB6eSi4im64_gn_jipD2GELm5B-FvpjlcGi7oWmlq9QCgmlkgnY0gmlwhKwS74GKbXVsdGlhZGRyc5YACASsEu-BBsKJAAoErBLvgQbCit0DgnJzhQADAQAAiXNlY3AyNTZrMaEDpxl4fKStay279mMOE9Da9W2nMJwi-I25PMuYkbqkl2SDdGNwgsKJg3VkcILCi4V3YWt1Mgk"}'
2025-02-08 03:06:54.453 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 03:06:54.460 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-08 03:06:54.460 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/receiving_node2_2025-02-08_03-06-53__86984fb1-32bb-4056-a70b-98dc77e689f8__wakuorg_nwaku:latest.log
2025-02-08 03:06:54.460 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 03:06:54.460 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 03:06:54.462 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 03:06:54.462 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.167.226
2025-02-08 03:06:54.462 DEBUG [src.node.docker_mananger] Generated ports ['24103', '24104', '24105', '24106', '24107']
2025-02-08 03:06:54.462 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 03:06:54.462 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 03:06:54.462 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 03:06:54.462 DEBUG [src.node.docker_mananger] docker run -i -t -p 24103:24103 -p 24104:24104 -p 24105:24105 -p 24106:24106 -p 24107:24107 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=24105 --rest-port=24103 --tcp-port=24104 --discv5-udp-port=24106 --rest-address=0.0.0.0 --nat=extip:172.18.167.226 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=cede8f2aa4ceee5306cc548f5c730db3b5df3bde1aef978e119bd6f1688af68a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=24107 --metrics-logging=true --lightpush=false --relay=true
2025-02-08 03:06:54.701 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.167.226 waku a00a5037c03866e7b0201a9629f83f3c202d60c7cb8d6211d5a52c95b190e7a6
2025-02-08 03:06:54.751 DEBUG [src.node.docker_mananger] Container started with ID a00a5037c038. Setting up logs at ./log/docker/receiving_node2_2025-02-08_03-06-53__86984fb1-32bb-4056-a70b-98dc77e689f8__wakuorg_nwaku:latest.log
2025-02-08 03:06:54.751 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 24103
2025-02-08 03:06:54.752 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 03:06:55.753 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24103/health" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:06:55.755 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-08 03:06:55.755 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-08 03:06:55.756 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:24103/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:06:55.758 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.167.226/tcp/24104/p2p/16Uiu2HAmB5mff23AF4MN59PRRYkJBhQ63EsHWLMYkYAX5BE48oZS","/ip4/172.18.167.226/tcp/24105/ws/p2p/16Uiu2HAmB5mff23AF4MN59PRRYkJBhQ63EsHWLMYkYAX5BE48oZS"],"enrUri":"enr:-L24QE3Oy8x1hSFYOefbAFt7Nnzer7RuEW-mOZugMcK4EHxnOkK5PPz6A9cpLf-6Xk_UbhFeTzCC3yDCfkxfCWK__8gCgmlkgnY0gmlwhKwSp-KKbXVsdGlhZGRyc5YACASsEqfiBl4oAAoErBKn4gZeKd0DgnJzhQADAQAAiXNlY3AyNTZrMaEC6KHOJr4VuIFAEUwpFFfWRQ3ttwTvtk95w4SeFUj5j7mDdGNwgl4og3VkcIJeKoV3YWt1MgE"}'
2025-02-08 03:06:55.758 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 03:06:55.758 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24103/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.239.129/tcp/49801/p2p/16Uiu2HAmPuGxnCPaPzwByQska4P5c8S9NxQKd9a7auddNSzFzWEw"]'
2025-02-08 03:06:55.798 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 03:06:55.809 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-08 03:06:55.809 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/lightpush_node1_2025-02-08_03-06-53__86984fb1-32bb-4056-a70b-98dc77e689f8__wakuorg_go-waku:latest.log
2025-02-08 03:06:55.809 DEBUG [src.node.waku_node] Starting Node...
2025-02-08 03:06:55.809 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-08 03:06:55.817 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-08 03:06:55.817 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.126.175
2025-02-08 03:06:55.818 DEBUG [src.node.docker_mananger] Generated ports ['43787', '43788', '43789', '43790', '43791']
2025-02-08 03:06:55.818 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-08 03:06:55.819 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-08 03:06:55.820 DEBUG [src.node.waku_node] Using volumes []
2025-02-08 03:06:55.820 DEBUG [src.node.docker_mananger] docker run -i -t -p 43787:43787 -p 43788:43788 -p 43789:43789 -p 43790:43790 -p 43791:43791 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=43789 --rest-port=43787 --tcp-port=43788 --discv5-udp-port=43790 --rest-address=0.0.0.0 --nat=extip:172.18.126.175 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e4d996ada170a66e235a1f0528cf1e2ddfd72a85dec6d42d0b5fcc70057cc5ed --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QNHzuOEnts5rjO9vvR4BPFb4L0A9lbtN0pbPBCwmgtxsCB6eSi4im64_gn_jipD2GELm5B-FvpjlcGi7oWmlq9QCgmlkgnY0gmlwhKwS74GKbXVsdGlhZGRyc5YACASsEu-BBsKJAAoErBLvgQbCit0DgnJzhQADAQAAiXNlY3AyNTZrMaEDpxl4fKStay279mMOE9Da9W2nMJwi-I25PMuYkbqkl2SDdGNwgsKJg3VkcILCi4V3YWt1Mgk --lightpushnode=/ip4/172.18.239.129/tcp/49801/p2p/16Uiu2HAmPuGxnCPaPzwByQska4P5c8S9NxQKd9a7auddNSzFzWEw --lightpush=true --relay=false --pubsub-topic=/waku/2/rs/3/1
2025-02-08 03:06:56.048 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.126.175 waku f2282f69b7d95183f8ed2739037f6cbf5b7e2c8b1a06d89927aab12b81eebae5
2025-02-08 03:06:56.098 DEBUG [src.node.docker_mananger] Container started with ID f2282f69b7d9. Setting up logs at ./log/docker/lightpush_node1_2025-02-08_03-06-53__86984fb1-32bb-4056-a70b-98dc77e689f8__wakuorg_go-waku:latest.log
2025-02-08 03:06:56.098 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 43787
2025-02-08 03:06:56.098 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-08 03:06:57.099 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:43787/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:06:57.101 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QC8VnuZCqKx3evml7a7Y1qwINhlJ7nG7wiJH41HwMi-2S4UP02W-fRaYTeCMAzN4Bkjjh93il0hP2WE6bn16jXWGAZTjhkjegmlkgnY0gmlwhKwRAASCcnOFAAMBAAGJc2VjcDI1NmsxoQPxzMu5ssn2gAhpnLyZhnT2VdhxVdcLXLuMv5f0ae1LpoN0Y3CCqwyDdWRwgqsOhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/43788/p2p/16Uiu2HAmUvsjC2tuwynggc4mBPg3nt7yPZi9ApdhKRpBT1muR1cy","/ip4/127.0.0.1/tcp/43789/ws/p2p/16Uiu2HAmUvsjC2tuwynggc4mBPg3nt7yPZi9ApdhKRpBT1muR1cy","/ip4/172.17.0.4/tcp/43788/p2p/16Uiu2HAmUvsjC2tuwynggc4mBPg3nt7yPZi9ApdhKRpBT1muR1cy","/ip4/172.17.0.4/tcp/43789/ws/p2p/16Uiu2HAmUvsjC2tuwynggc4mBPg3nt7yPZi9ApdhKRpBT1muR1cy"]}'
2025-02-08 03:06:57.101 INFO [src.node.waku_node] REST service is ready !!
2025-02-08 03:06:57.102 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43787/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.239.129/tcp/49801/p2p/16Uiu2HAmPuGxnCPaPzwByQska4P5c8S9NxQKd9a7auddNSzFzWEw", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-08 03:06:57.104 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-08 03:06:57.104 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43787/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.167.226/tcp/24104/p2p/16Uiu2HAmB5mff23AF4MN59PRRYkJBhQ63EsHWLMYkYAX5BE48oZS", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-08 03:06:57.119 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-08 03:06:57.120 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:49800/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 03:06:57.130 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 03:06:57.130 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:24103/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-08 03:06:57.134 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-08 03:06:57.135 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:43787/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/1", "message": {"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": 1738984017135460352}}'
2025-02-08 03:06:57.144 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-08 03:06:57.145 DEBUG [src.libs.common] Sleeping for 0.5 seconds
2025-02-08 03:06:57.645 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:49800/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-08 03:06:57.648 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1738984017135460352,"ephemeral":false}]'
2025-02-08 03:06:57.648 DEBUG [src.libs.common] Sleeping for 5 seconds
2025-02-08 03:07:02.649 DEBUG [src.steps.metrics] Checking metric: libp2p_peers has 1
2025-02-08 03:07:02.653 DEBUG [src.steps.metrics] Found metric: libp2p_peers with value 2.0
2025-02-08 03:07:02.653 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_peers has 1
2025-02-08 03:07:02.656 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_peers with value 2.0
2025-02-08 03:07:02.657 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_topics has 1
2025-02-08 03:07:02.659 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_topics with value 2.0
2025-02-08 03:07:02.660 DEBUG [src.steps.metrics] Checking metric: libp2p_pubsub_subscriptions_total has 1
2025-02-08 03:07:02.663 DEBUG [src.steps.metrics] Found metric: libp2p_pubsub_subscriptions_total with value 2.0
2025-02-08 03:07:02.663 DEBUG [src.steps.metrics] Checking metric: waku_peer_store_size has 1
2025-02-08 03:07:02.666 DEBUG [src.steps.metrics] Found metric: waku_peer_store_size with value 2.0
2025-02-08 03:07:02.666 DEBUG [src.steps.metrics] Checking metric: waku_histogram_message_size_count has 1
2025-02-08 03:07:02.669 DEBUG [src.steps.metrics] Found metric: waku_histogram_message_size_count with value 1.0
2025-02-08 03:07:02.669 DEBUG [src.steps.metrics] Checking metric: waku_node_messages_total{type="relay"} has 1
2025-02-08 03:07:02.672 DEBUG [src.steps.metrics] Found metric: waku_node_messages_total{type="relay"} with value 1.0
2025-02-08 03:07:02.674 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-08 03:07:02.675 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-08 03:07:02.675 DEBUG [src.node.waku_node] Stopping container with id 7fb3c0a72cce
2025-02-08 03:07:03.259 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 03:07:03.259 DEBUG [src.node.waku_node] Stopping container with id a00a5037c038
2025-02-08 03:07:04.071 ERROR [src.node.docker_mananger] Max retries reached for container 7fb3c0a72cce. Exiting log stream.
2025-02-08 03:07:04.748 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 03:07:04.749 DEBUG [src.node.waku_node] Stopping container with id f2282f69b7d9
2025-02-08 03:07:05.228 DEBUG [src.node.waku_node] Container stopped.
2025-02-08 03:07:05.229 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-08 03:07:05.236 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 03:07:05.251 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-08 03:07:05.254 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
