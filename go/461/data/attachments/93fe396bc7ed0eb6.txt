2025-02-11 03:07:48.216 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 03:07:48.216 DEBUG [tests.conftest] Running test: test_publish_on_non_subscribed_pubsub_topic with id: 2025-02-11_03-07-48__63ed091a-0cdd-4ba0-9e69-8ca64ddd9e59
2025-02-11 03:07:48.216 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 03:07:48.216 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 03:07:48.217 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 03:07:48.223 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 03:07:48.223 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_03-07-48__63ed091a-0cdd-4ba0-9e69-8ca64ddd9e59__wakuorg_nwaku:latest.log
2025-02-11 03:07:48.223 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 03:07:48.223 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 03:07:48.224 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 03:07:48.225 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.158.28
2025-02-11 03:07:48.225 DEBUG [src.node.docker_mananger] Generated ports ['46094', '46095', '46096', '46097', '46098']
2025-02-11 03:07:48.225 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 03:07:48.225 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 03:07:48.225 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 03:07:48.225 DEBUG [src.node.docker_mananger] docker run -i -t -p 46094:46094 -p 46095:46095 -p 46096:46096 -p 46097:46097 -p 46098:46098 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46096 --rest-port=46094 --tcp-port=46095 --discv5-udp-port=46097 --rest-address=0.0.0.0 --nat=extip:172.18.158.28 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5ffe06798a749bdbb03fc262bcded31bfa97eeeafe494aeb4d876a0cb4de1ddb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46098 --metrics-logging=true --relay=true
2025-02-11 03:07:48.446 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.158.28 waku 9bc068847cbab74757b9f96cdedbd9397c1db4282f868530fda3afbdf1d34930
2025-02-11 03:07:48.492 DEBUG [src.node.docker_mananger] Container started with ID 9bc068847cba. Setting up logs at ./log/docker/node1_2025-02-11_03-07-48__63ed091a-0cdd-4ba0-9e69-8ca64ddd9e59__wakuorg_nwaku:latest.log
2025-02-11 03:07:48.493 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 46094
2025-02-11 03:07:48.493 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 03:07:48.514 ERROR [src.node.docker_mananger] Max retries reached for container 28c5d89ffde5. Exiting log stream.
2025-02-11 03:07:49.024 ERROR [src.node.docker_mananger] Max retries reached for container ce052376b57c. Exiting log stream.
2025-02-11 03:07:49.493 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46094/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:49.496 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 03:07:49.496 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 03:07:49.497 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46094/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:49.499 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.158.28/tcp/46095/p2p/16Uiu2HAkz1P76L6NHBxBgQHgCAaD6Vx6V5ZBour6XuMN9Y4YN55N","/ip4/172.18.158.28/tcp/46096/ws/p2p/16Uiu2HAkz1P76L6NHBxBgQHgCAaD6Vx6V5ZBour6XuMN9Y4YN55N"],"enrUri":"enr:-L24QMNJXgOxPOWQWaGk40BG49t8caVmTP9p8-gZHiHG1rfZCMKyngm6pWcQUTTwvH1BZUP4SVtzYTr-uIUIFvSNZ18CgmlkgnY0gmlwhKwSnhyKbXVsdGlhZGRyc5YACASsEp4cBrQPAAoErBKeHAa0EN0DgnJzhQADAQAAiXNlY3AyNTZrMaECRBFqYXJ12LyEvRcDN_VL5Qp4DDQbzkyxnAoZu_Jy82WDdGNwgrQPg3VkcIK0EYV3YWt1MgE"}'
2025-02-11 03:07:49.499 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 03:07:49.506 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 03:07:49.506 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_03-07-48__63ed091a-0cdd-4ba0-9e69-8ca64ddd9e59__wakuorg_go-waku:latest.log
2025-02-11 03:07:49.506 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 03:07:49.506 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 03:07:49.508 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 03:07:49.508 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.202.28
2025-02-11 03:07:49.508 DEBUG [src.node.docker_mananger] Generated ports ['12527', '12528', '12529', '12530', '12531']
2025-02-11 03:07:49.508 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 03:07:49.508 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 03:07:49.508 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 03:07:49.509 DEBUG [src.node.docker_mananger] docker run -i -t -p 12527:12527 -p 12528:12528 -p 12529:12529 -p 12530:12530 -p 12531:12531 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=12529 --rest-port=12527 --tcp-port=12528 --discv5-udp-port=12530 --rest-address=0.0.0.0 --nat=extip:172.18.202.28 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=8c5f69773a7f97ef8330e9bd5aef359ce4be7cfafa599da6b6a13f0a274e6d3d --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QMNJXgOxPOWQWaGk40BG49t8caVmTP9p8-gZHiHG1rfZCMKyngm6pWcQUTTwvH1BZUP4SVtzYTr-uIUIFvSNZ18CgmlkgnY0gmlwhKwSnhyKbXVsdGlhZGRyc5YACASsEp4cBrQPAAoErBKeHAa0EN0DgnJzhQADAQAAiXNlY3AyNTZrMaECRBFqYXJ12LyEvRcDN_VL5Qp4DDQbzkyxnAoZu_Jy82WDdGNwgrQPg3VkcIK0EYV3YWt1MgE
2025-02-11 03:07:49.736 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.202.28 waku 4c97ed5154c32870afdefde85bff3646e5035ad51c00e17138f378201f8e677d
2025-02-11 03:07:49.794 DEBUG [src.node.docker_mananger] Container started with ID 4c97ed5154c3. Setting up logs at ./log/docker/node2_2025-02-11_03-07-48__63ed091a-0cdd-4ba0-9e69-8ca64ddd9e59__wakuorg_go-waku:latest.log
2025-02-11 03:07:49.796 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 12527
2025-02-11 03:07:49.796 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 03:07:50.797 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12527/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:50.799 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QDmrEOpoYkSv391LgxCQ91WPhu2Zpx5FD-ARksS7XhzxIjWwiPlPFpPRgKRj8sNz0UDPPkHcdEZ_iTNeAoP2_q6GAZTy-i6XgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDNOkAdSiMaYnIe-OD77XwK9krGxJI3JI_uZ7lWTi6byiDdGNwgjDwg3VkcIIw8oV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/12528/p2p/16Uiu2HAmGDXcr9NVhd1eLhHLnx5GemGTLUR7BB6GonCptwt5hX7u","/ip4/127.0.0.1/tcp/12529/ws/p2p/16Uiu2HAmGDXcr9NVhd1eLhHLnx5GemGTLUR7BB6GonCptwt5hX7u","/ip4/172.17.0.3/tcp/12528/p2p/16Uiu2HAmGDXcr9NVhd1eLhHLnx5GemGTLUR7BB6GonCptwt5hX7u","/ip4/172.17.0.3/tcp/12529/ws/p2p/16Uiu2HAmGDXcr9NVhd1eLhHLnx5GemGTLUR7BB6GonCptwt5hX7u"]}'
2025-02-11 03:07:50.800 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 03:07:50.800 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12527/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.158.28/tcp/46095/p2p/16Uiu2HAkz1P76L6NHBxBgQHgCAaD6Vx6V5ZBour6XuMN9Y4YN55N", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 03:07:50.816 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 03:07:50.817 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 03:07:50.818 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46094/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 03:07:50.840 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 03:07:50.841 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:12527/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 03:07:50.844 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-11 03:07:50.845 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46094/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 03:07:50.859 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 03:07:50.859 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 03:07:50.960 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 03:07:50.960 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46094/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:50.963 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243270845315840,"ephemeral":false}]'
2025-02-11 03:07:50.964 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 03:07:50.965 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12527/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:50.966 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 03:07:51.967 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46094/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 03:07:51.972 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 03:07:51.973 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 03:07:52.073 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 03:07:52.073 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46094/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:52.076 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243271967544064,"ephemeral":false}]'
2025-02-11 03:07:52.077 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 03:07:52.078 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:12527/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:52.079 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243271967544064,"ephemeral":false}]'
2025-02-11 03:07:52.081 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 03:07:52.082 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46094/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 03:07:52.084 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:46094/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1000. Response content: b'Failed to publish: Node not subscribed to topic: /waku/2/rs/3/1000'
2025-02-11 03:07:52.087 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 03:07:52.088 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 03:07:52.088 DEBUG [src.node.waku_node] Stopping container with id 9bc068847cba
2025-02-11 03:07:52.674 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 03:07:52.675 DEBUG [src.node.waku_node] Stopping container with id 4c97ed5154c3
2025-02-11 03:07:53.194 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 03:07:53.196 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 03:07:53.202 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 03:07:53.205 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
