2025-02-11 03:07:37.626 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-11 03:07:37.628 DEBUG [tests.conftest] Running test: test_publish_with_valid_meta with id: 2025-02-11_03-07-37__b176c4ac-2f60-49d3-9a3b-2c00f43f6403
2025-02-11 03:07:37.628 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-11 03:07:37.628 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-11 03:07:37.629 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-11 03:07:37.636 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-11 03:07:37.636 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-11_03-07-37__b176c4ac-2f60-49d3-9a3b-2c00f43f6403__wakuorg_nwaku:latest.log
2025-02-11 03:07:37.636 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 03:07:37.636 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 03:07:37.637 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 03:07:37.637 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.209.5
2025-02-11 03:07:37.637 DEBUG [src.node.docker_mananger] Generated ports ['46902', '46903', '46904', '46905', '46906']
2025-02-11 03:07:37.638 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 03:07:37.638 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 03:07:37.638 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 03:07:37.638 DEBUG [src.node.docker_mananger] docker run -i -t -p 46902:46902 -p 46903:46903 -p 46904:46904 -p 46905:46905 -p 46906:46906 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=46904 --rest-port=46902 --tcp-port=46903 --discv5-udp-port=46905 --rest-address=0.0.0.0 --nat=extip:172.18.209.5 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=df0bbf99bb23083f5c0bd55c6ccadc523ec92484bba12ad3adfb8cbc3fe70bfb --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=46906 --metrics-logging=true --relay=true
2025-02-11 03:07:37.871 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.209.5 waku 5bbcc524913f0176910a1028db238ad8cd5e105503de1d211eadecae1ebe8632
2025-02-11 03:07:37.920 DEBUG [src.node.docker_mananger] Container started with ID 5bbcc524913f. Setting up logs at ./log/docker/node1_2025-02-11_03-07-37__b176c4ac-2f60-49d3-9a3b-2c00f43f6403__wakuorg_nwaku:latest.log
2025-02-11 03:07:37.921 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 46902
2025-02-11 03:07:37.921 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 03:07:37.942 ERROR [src.node.docker_mananger] Max retries reached for container 8bd432f5efdf. Exiting log stream.
2025-02-11 03:07:38.441 ERROR [src.node.docker_mananger] Max retries reached for container f86a05aaf16c. Exiting log stream.
2025-02-11 03:07:38.921 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46902/health" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:38.924 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-11 03:07:38.924 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-11 03:07:38.924 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46902/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:38.926 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.209.5/tcp/46903/p2p/16Uiu2HAm5sUvFDJCuSPfWXngz19soCSc8vC5i8yNAHhBmKkoKr4X","/ip4/172.18.209.5/tcp/46904/ws/p2p/16Uiu2HAm5sUvFDJCuSPfWXngz19soCSc8vC5i8yNAHhBmKkoKr4X"],"enrUri":"enr:-L24QCpRn-tJqYvQLtXYSmGPm-198CnCUKOCv9zuDRqRTAmaRPGweiU1NfZWCyh1t1aVx1H5N5FWi6NiXmUtVrRQZisCgmlkgnY0gmlwhKwS0QWKbXVsdGlhZGRyc5YACASsEtEFBrc3AAoErBLRBQa3ON0DgnJzhQADAQAAiXNlY3AyNTZrMaECmzF2oUgowvBN-EpmMZrsSuN0TlOMbaA0IxSgZt4MxsCDdGNwgrc3g3VkcIK3OYV3YWt1MgE"}'
2025-02-11 03:07:38.927 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 03:07:38.933 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-11 03:07:38.933 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-11_03-07-37__b176c4ac-2f60-49d3-9a3b-2c00f43f6403__wakuorg_go-waku:latest.log
2025-02-11 03:07:38.933 DEBUG [src.node.waku_node] Starting Node...
2025-02-11 03:07:38.933 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-11 03:07:38.934 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-11 03:07:38.935 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.3.121
2025-02-11 03:07:38.935 DEBUG [src.node.docker_mananger] Generated ports ['48328', '48329', '48330', '48331', '48332']
2025-02-11 03:07:38.935 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-11 03:07:38.935 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-11 03:07:38.935 DEBUG [src.node.waku_node] Using volumes []
2025-02-11 03:07:38.935 DEBUG [src.node.docker_mananger] docker run -i -t -p 48328:48328 -p 48329:48329 -p 48330:48330 -p 48331:48331 -p 48332:48332 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=48330 --rest-port=48328 --tcp-port=48329 --discv5-udp-port=48331 --rest-address=0.0.0.0 --nat=extip:172.18.3.121 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=5bb2fa1325e5df3717fbca235cc11a226c44fcc8438e1eb82fd9ecedc87472de --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QCpRn-tJqYvQLtXYSmGPm-198CnCUKOCv9zuDRqRTAmaRPGweiU1NfZWCyh1t1aVx1H5N5FWi6NiXmUtVrRQZisCgmlkgnY0gmlwhKwS0QWKbXVsdGlhZGRyc5YACASsEtEFBrc3AAoErBLRBQa3ON0DgnJzhQADAQAAiXNlY3AyNTZrMaECmzF2oUgowvBN-EpmMZrsSuN0TlOMbaA0IxSgZt4MxsCDdGNwgrc3g3VkcIK3OYV3YWt1MgE
2025-02-11 03:07:39.164 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.3.121 waku 560f94889c4f1fae92761d808e2b4a3c39dc752bba835e259e37163f8fca2906
2025-02-11 03:07:39.214 DEBUG [src.node.docker_mananger] Container started with ID 560f94889c4f. Setting up logs at ./log/docker/node2_2025-02-11_03-07-37__b176c4ac-2f60-49d3-9a3b-2c00f43f6403__wakuorg_go-waku:latest.log
2025-02-11 03:07:39.215 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 48328
2025-02-11 03:07:39.215 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-11 03:07:40.215 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48328/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:40.218 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QPsaQxlF0SblCiOfos7zg9DhI8nz2GrpmYDXCu4iVmJXNFa6oaoMSUKsEe5Atu4cdzhshPM7EWL0kKgF4dHN9LeGAZTy-gVOgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaEDyO727kREXAu0OskTfEuyRgLidA4_zruSlMAEgwSS9QmDdGNwgrzJg3VkcIK8y4V3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/48329/p2p/16Uiu2HAmSBMEPZLsDqHvno6zuMcWEHhs9FQtcoHMUZZTGw9rYR4L","/ip4/127.0.0.1/tcp/48330/ws/p2p/16Uiu2HAmSBMEPZLsDqHvno6zuMcWEHhs9FQtcoHMUZZTGw9rYR4L","/ip4/172.17.0.3/tcp/48329/p2p/16Uiu2HAmSBMEPZLsDqHvno6zuMcWEHhs9FQtcoHMUZZTGw9rYR4L","/ip4/172.17.0.3/tcp/48330/ws/p2p/16Uiu2HAmSBMEPZLsDqHvno6zuMcWEHhs9FQtcoHMUZZTGw9rYR4L"]}'
2025-02-11 03:07:40.218 INFO [src.node.waku_node] REST service is ready !!
2025-02-11 03:07:40.219 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48328/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.209.5/tcp/46903/p2p/16Uiu2HAm5sUvFDJCuSPfWXngz19soCSc8vC5i8yNAHhBmKkoKr4X", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-11 03:07:40.235 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 03:07:40.236 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-11 03:07:40.236 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46902/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 03:07:40.258 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 03:07:40.258 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:48328/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-11 03:07:40.260 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-11 03:07:40.262 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46902/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 03:07:40.273 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 03:07:40.274 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 03:07:40.374 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 03:07:40.374 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46902/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:40.377 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243260262122752,"ephemeral":false}]'
2025-02-11 03:07:40.378 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 03:07:40.378 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48328/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:40.380 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-11 03:07:41.381 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46902/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-11 03:07:41.386 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 03:07:41.386 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 03:07:41.486 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 03:07:41.486 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46902/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:41.488 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243261381201152,"ephemeral":false}]'
2025-02-11 03:07:41.490 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 03:07:41.490 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48328/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:41.491 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243261381201152,"ephemeral":false}]'
2025-02-11 03:07:41.493 INFO [src.steps.relay] WARM UP successful!!
2025-02-11 03:07:41.494 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:46902/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)', "meta": "UmVsYXkgd29ya3MhIQ=="}'
2025-02-11 03:07:41.498 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-11 03:07:41.498 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-11 03:07:41.599 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-11 03:07:41.599 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:46902/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:41.601 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243261494091008,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false}]'
2025-02-11 03:07:41.602 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-11 03:07:41.602 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:48328/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-11 03:07:41.604 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739243261494091008,"meta":"UmVsYXkgd29ya3MhIQ==","ephemeral":false}]'
2025-02-11 03:07:41.607 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-11 03:07:41.608 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-11 03:07:41.608 DEBUG [src.node.waku_node] Stopping container with id 5bbcc524913f
2025-02-11 03:07:42.158 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 03:07:42.159 DEBUG [src.node.waku_node] Stopping container with id 560f94889c4f
2025-02-11 03:07:42.657 DEBUG [src.node.waku_node] Container stopped.
2025-02-11 03:07:42.660 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-11 03:07:42.667 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-11 03:07:42.670 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
