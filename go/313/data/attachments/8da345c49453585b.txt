[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_publishing_node_restarts with id: 2024-10-18_03-26-01__455cd877-d8c8-4abe-9b80-5fd814eb096e
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.store:store.py:31 Running fixture setup: store_setup
[35mDEBUG   [0m src.steps.store:store.py:39 Running fixture setup: node_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/publishing_node1_2024-10-18_03-26-01__455cd877-d8c8-4abe-9b80-5fd814eb096e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.57.194
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['2871', '2872', '2873', '2874', '2875']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 2871:2871 -p 2872:2872 -p 2873:2873 -p 2874:2874 -p 2875:2875 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=2873 --rest-port=2871 --tcp-port=2872 --discv5-udp-port=2874 --rest-address=0.0.0.0 --nat=extip:172.18.57.194 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=c8fb0b0caebbc2d1bb8cfae4a0a17e1f8cbecc1bad83a2fab29e68d1dbb2be9a --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=2875 --metrics-logging=true --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.57.194 waku 5629c155a2f90e2b3549fdb4a4ef6e6d2af9e2c9508cbfaba4f82542f0235552
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 5629c155a2f9. Setting up logs at ./log/docker/publishing_node1_2024-10-18_03-26-01__455cd877-d8c8-4abe-9b80-5fd814eb096e__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 2871
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2871/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2871/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.57.194/tcp/2872/p2p/16Uiu2HAkwtFQX6pYsCAUuCRe3CBVAHdr3s3WGPE4tps8NrAEjUKF","/ip4/172.18.57.194/tcp/2873/ws/p2p/16Uiu2HAkwtFQX6pYsCAUuCRe3CBVAHdr3s3WGPE4tps8NrAEjUKF"],"enrUri":"enr:-LO4QMcL-oKbAMhVVGmaAvkFO1_UjbAiUut0kQ75H-S8lb69bBZn7fhk2hCgp9O7eHomJlppbv4krA6SzjnMiWXso-oBgmlkgnY0gmlwhKwSOcKKbXVsdGlhZGRyc4wACgSsEjnCBgs53QOCcnOFAAMBAACJc2VjcDI1NmsxoQIkhkUoIG8ZJMmynZvhnTLW3S_RTDnuA0XE7nZFACQLroN0Y3CCCziDdWRwggs6hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/store_node1_2024-10-18_03-26-01__455cd877-d8c8-4abe-9b80-5fd814eb096e__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.175.113
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['27058', '27059', '27060', '27061', '27062']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 27058:27058 -p 27059:27059 -p 27060:27060 -p 27061:27061 -p 27062:27062 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=27060 --rest-port=27058 --tcp-port=27059 --discv5-udp-port=27061 --rest-address=0.0.0.0 --nat=extip:172.18.175.113 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=e35e9ddd788c5fd1c1bfd77e3fd9cb7c840dee0e06f5dbc6c78e0c5fcdfde10d --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-LO4QMcL-oKbAMhVVGmaAvkFO1_UjbAiUut0kQ75H-S8lb69bBZn7fhk2hCgp9O7eHomJlppbv4krA6SzjnMiWXso-oBgmlkgnY0gmlwhKwSOcKKbXVsdGlhZGRyc4wACgSsEjnCBgs53QOCcnOFAAMBAACJc2VjcDI1NmsxoQIkhkUoIG8ZJMmynZvhnTLW3S_RTDnuA0XE7nZFACQLroN0Y3CCCziDdWRwggs6hXdha3UyAw --storenode=/ip4/172.18.57.194/tcp/2872/p2p/16Uiu2HAkwtFQX6pYsCAUuCRe3CBVAHdr3s3WGPE4tps8NrAEjUKF --store=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.175.113 waku 72c350f951808c678083e277b509acf785f798c7e6fc2d5f548c2889c1fc5ad1
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 72c350f95180. Setting up logs at ./log/docker/store_node1_2024-10-18_03-26-01__455cd877-d8c8-4abe-9b80-5fd814eb096e__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/go-waku:latest. REST: 27058
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27058/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QLb-yUS8Q4yPVZ4MvCEHdfgq2OS6gm-jaqMIf1SpV-5XWomJRQiqjrZ7TnBEgbdosidOncQzsu8Lg_xX6HFvZRGGAZKdqTH0gmlkgnY0gmlwhKwRAAqJc2VjcDI1NmsxoQPwDIz0BQI-yFMgsNSfLj-M9xP0rMkQu9jyILaGbNkHL4N0Y3CCabODdWRwgmm1hXdha3UyAw","listenAddresses":["/ip4/127.0.0.1/tcp/27059/p2p/16Uiu2HAmUp3JEQEPZYN9gXB26bE7zsirVpoPnmY2Gxqwn6z3Niox","/ip4/127.0.0.1/tcp/27060/ws/p2p/16Uiu2HAmUp3JEQEPZYN9gXB26bE7zsirVpoPnmY2Gxqwn6z3Niox","/ip4/172.17.0.10/tcp/27059/p2p/16Uiu2HAmUp3JEQEPZYN9gXB26bE7zsirVpoPnmY2Gxqwn6z3Niox","/ip4/172.17.0.10/tcp/27060/ws/p2p/16Uiu2HAmUp3JEQEPZYN9gXB26bE7zsirVpoPnmY2Gxqwn6z3Niox"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27058/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.57.194/tcp/2872/p2p/16Uiu2HAkwtFQX6pYsCAUuCRe3CBVAHdr3s3WGPE4tps8NrAEjUKF", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2871/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27058/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2871/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2871/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"/GI1pDp+c403UcbustJsdtkJ6eWLiYyWPyg/OSNyEkw="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27058/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"1f406202a3ca09573f9c0a4344a7464e45252d5d69077e9a98270bcaa27de4d2","status_code":200,"status_desc":"OK","messages":[{"message_hash":"/GI1pDp+c403UcbustJsdtkJ6eWLiYyWPyg/OSNyEkw="}]}'
[35mDEBUG   [0m src.node.waku_node:waku_node.py:244 Restarting container with id 5629c155a2f9
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2871/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2871/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.57.194/tcp/2872/p2p/16Uiu2HAkwtFQX6pYsCAUuCRe3CBVAHdr3s3WGPE4tps8NrAEjUKF","/ip4/172.18.57.194/tcp/2873/ws/p2p/16Uiu2HAkwtFQX6pYsCAUuCRe3CBVAHdr3s3WGPE4tps8NrAEjUKF"],"enrUri":"enr:-LO4QMcL-oKbAMhVVGmaAvkFO1_UjbAiUut0kQ75H-S8lb69bBZn7fhk2hCgp9O7eHomJlppbv4krA6SzjnMiWXso-oBgmlkgnY0gmlwhKwSOcKKbXVsdGlhZGRyc4wACgSsEjnCBgs53QOCcnOFAAMBAACJc2VjcDI1NmsxoQIkhkUoIG8ZJMmynZvhnTLW3S_RTDnuA0XE7nZFACQLroN0Y3CCCziDdWRwggs6hXdha3UyAw"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:27058/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.57.194/tcp/2872/p2p/16Uiu2HAkwtFQX6pYsCAUuCRe3CBVAHdr3s3WGPE4tps8NrAEjUKF", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2871/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.steps.store:store.py:132 Relaying message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:2871/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d '{"payload": "U3RvcmUgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.2 seconds
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/nwaku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2871/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"/GI1pDp+c403UcbustJsdtkJ6eWLiYyWPyg/OSNyEkw="},{"messageHash":"NC1Oryw6YSzkc6jjEWQj3KPGwBm8C4GDI47/eHE/7So="}]}'
[35mDEBUG   [0m src.steps.store:store.py:218 Checking that peer wakuorg/go-waku:latest can find the stored messages
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27058/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"7474551f0193f82c75fe26e77b02d9a4f140091f00639584b200b83b98091766","status_code":200,"status_desc":"OK","messages":[{"message_hash":"/GI1pDp+c403UcbustJsdtkJ6eWLiYyWPyg/OSNyEkw="},{"message_hash":"NC1Oryw6YSzkc6jjEWQj3KPGwBm8C4GDI47/eHE/7So="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:2871/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"requestId":"","statusCode":200,"statusDesc":"OK","messages":[{"messageHash":"/GI1pDp+c403UcbustJsdtkJ6eWLiYyWPyg/OSNyEkw="},{"messageHash":"NC1Oryw6YSzkc6jjEWQj3KPGwBm8C4GDI47/eHE/7So="}]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:27058/store/v3/messages?pubsubTopic=%2Fwaku%2F2%2Frs%2F3%2F0&contentTopics=%2Fmyapp%2F1%2Flatest%2Fproto&pageSize=5&ascending=true" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"request_id":"6cf137e424e8257977d0592cba8c4a2f40b2906504399860585e424570efd22c","status_code":200,"status_desc":"OK","messages":[{"message_hash":"/GI1pDp+c403UcbustJsdtkJ6eWLiYyWPyg/OSNyEkw="},{"message_hash":"NC1Oryw6YSzkc6jjEWQj3KPGwBm8C4GDI47/eHE/7So="}]}'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 5629c155a2f9
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 72c350f95180
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.