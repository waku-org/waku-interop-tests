2025-02-13 03:05:14.895 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 03:05:14.895 DEBUG [tests.conftest] Running test: test_filter_get_message_with_valid_timestamps with id: 2025-02-13_03-05-14__199e427c-713a-4a76-9f1e-24e91fcfe9c3
2025-02-13 03:05:14.896 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 03:05:14.896 DEBUG [src.steps.filter] Running fixture setup: filter_setup
2025-02-13 03:05:14.896 DEBUG [src.steps.filter] Running fixture setup: setup_main_relay_node
2025-02-13 03:05:14.904 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 03:05:14.905 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_03-05-14__199e427c-713a-4a76-9f1e-24e91fcfe9c3__wakuorg_nwaku:latest.log
2025-02-13 03:05:14.905 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 03:05:14.905 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 03:05:14.971 DEBUG [src.node.docker_mananger] Network waku created
2025-02-13 03:05:14.971 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.218.49
2025-02-13 03:05:14.972 DEBUG [src.node.docker_mananger] Generated ports ['59736', '59737', '59738', '59739', '59740']
2025-02-13 03:05:14.972 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 03:05:14.972 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 03:05:14.972 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 03:05:14.972 DEBUG [src.node.docker_mananger] docker run -i -t -p 59736:59736 -p 59737:59737 -p 59738:59738 -p 59739:59739 -p 59740:59740 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=59738 --rest-port=59736 --tcp-port=59737 --discv5-udp-port=59739 --rest-address=0.0.0.0 --nat=extip:172.18.218.49 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4ee31a095a0efabcbffc2eabb6ec2a940fd1d5b732ed513dcbeaf05904c5fd95 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=59740 --metrics-logging=true --relay=true --filter=true
2025-02-13 03:05:18.679 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.218.49 waku 7aa883f4a31854c2ff34474c02389de4186c3a710755ee4754d5846b4b80ea18
2025-02-13 03:05:18.725 DEBUG [src.node.docker_mananger] Container started with ID 7aa883f4a318. Setting up logs at ./log/docker/node1_2025-02-13_03-05-14__199e427c-713a-4a76-9f1e-24e91fcfe9c3__wakuorg_nwaku:latest.log
2025-02-13 03:05:18.726 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 59736
2025-02-13 03:05:18.726 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 03:05:19.727 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59736/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:19.731 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 03:05:19.731 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 03:05:19.731 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:59736/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:19.733 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.218.49/tcp/59737/p2p/16Uiu2HAmGxSZVvMHNEwDQdqHuw6cJ3AYjSiNJWU1wofDGpC2sDZX","/ip4/172.18.218.49/tcp/59738/ws/p2p/16Uiu2HAmGxSZVvMHNEwDQdqHuw6cJ3AYjSiNJWU1wofDGpC2sDZX"],"enrUri":"enr:-L24QHCdfr4bcBlDEpwglaoxa0tEBIzyeG6avFdTEpq2K4EqBkQRELXGB9bqvfr0rifdYxrKbYKKARN8k9b3nDERo7wCgmlkgnY0gmlwhKwS2jGKbXVsdGlhZGRyc5YACASsEtoxBulZAAoErBLaMQbpWt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDP-dB_bMJvo7p3SBJhtipgodGwNg08zXZinooGLo2rw6DdGNwgulZg3VkcILpW4V3YWt1MgU"}'
2025-02-13 03:05:19.734 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 03:05:19.734 DEBUG [src.steps.filter] Running fixture setup: setup_main_filter_node
2025-02-13 03:05:19.740 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-13 03:05:19.740 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_03-05-14__199e427c-713a-4a76-9f1e-24e91fcfe9c3__wakuorg_go-waku:latest.log
2025-02-13 03:05:19.740 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 03:05:19.741 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 03:05:19.742 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 03:05:19.742 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.16.244
2025-02-13 03:05:19.742 DEBUG [src.node.docker_mananger] Generated ports ['55426', '55427', '55428', '55429', '55430']
2025-02-13 03:05:19.742 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 03:05:19.743 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 03:05:19.743 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 03:05:19.743 DEBUG [src.node.docker_mananger] docker run -i -t -p 55426:55426 -p 55427:55427 -p 55428:55428 -p 55429:55429 -p 55430:55430 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=55428 --rest-port=55426 --tcp-port=55427 --discv5-udp-port=55429 --rest-address=0.0.0.0 --nat=extip:172.18.16.244 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=ba9c007e8d5acfbfbd7ddd5eea3ff8dc0de31fca04d6447d5a5bd58ae9085c1f --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=false --discv5-bootstrap-node=enr:-L24QHCdfr4bcBlDEpwglaoxa0tEBIzyeG6avFdTEpq2K4EqBkQRELXGB9bqvfr0rifdYxrKbYKKARN8k9b3nDERo7wCgmlkgnY0gmlwhKwS2jGKbXVsdGlhZGRyc5YACASsEtoxBulZAAoErBLaMQbpWt0DgnJzhQADAQAAiXNlY3AyNTZrMaEDP-dB_bMJvo7p3SBJhtipgodGwNg08zXZinooGLo2rw6DdGNwgulZg3VkcILpW4V3YWt1MgU --filternode=/ip4/172.18.218.49/tcp/59737/p2p/16Uiu2HAmGxSZVvMHNEwDQdqHuw6cJ3AYjSiNJWU1wofDGpC2sDZX --pubsub-topic=/waku/2/rs/3/1
2025-02-13 03:05:23.002 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.16.244 waku 9a03a944725b91522e8b1e82beb87ccef04915bf549abbdaf026d2c3b0c6a559
2025-02-13 03:05:23.063 DEBUG [src.node.docker_mananger] Container started with ID 9a03a944725b. Setting up logs at ./log/docker/node2_2025-02-13_03-05-14__199e427c-713a-4a76-9f1e-24e91fcfe9c3__wakuorg_go-waku:latest.log
2025-02-13 03:05:23.063 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 55426
2025-02-13 03:05:23.063 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 03:05:24.065 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.068 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QHxHVY0oNZdpvtUFzFR-cKMGzajMOj9kBABQo_hiRsb7R3-Hbn1hy6VgLSK3IccN1rLuws1YDT6tYMWo1Zw7PFyGAZT9RKlmgmlkgnY0gmlwhKwRAAOCcnOFAAMBAAGJc2VjcDI1NmsxoQM3imv8aod9ZFhILJLwX6z_vh4KonKgcoepzCW2XjvCHoN0Y3CC2IODdWRwgtiFhXdha3UygA","listenAddresses":["/ip4/127.0.0.1/tcp/55427/p2p/16Uiu2HAmGPoCG7aGEgSXadgshM54yzYmuy1Thi6wK6U7fC5A3rAH","/ip4/127.0.0.1/tcp/55428/ws/p2p/16Uiu2HAmGPoCG7aGEgSXadgshM54yzYmuy1Thi6wK6U7fC5A3rAH","/ip4/172.17.0.3/tcp/55427/p2p/16Uiu2HAmGPoCG7aGEgSXadgshM54yzYmuy1Thi6wK6U7fC5A3rAH","/ip4/172.17.0.3/tcp/55428/ws/p2p/16Uiu2HAmGPoCG7aGEgSXadgshM54yzYmuy1Thi6wK6U7fC5A3rAH"]}'
2025-02-13 03:05:24.068 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 03:05:24.069 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55426/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.218.49/tcp/59737/p2p/16Uiu2HAmGxSZVvMHNEwDQdqHuw6cJ3AYjSiNJWU1wofDGpC2sDZX", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-13 03:05:24.070 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-13 03:05:24.071 DEBUG [src.steps.filter] Running fixture setup: subscribe_main_nodes
2025-02-13 03:05:24.071 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 03:05:24.074 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.075 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:55426/filter/v2/subscriptions" -H "Content-Type: application/json" -d '{"requestId": "28f2386e-5212-44a0-8c58-22818023c4bf", "contentFilters": ["/test/1/waku-filter/proto"], "pubsubTopic": "/waku/2/rs/3/1"}'
2025-02-13 03:05:24.080 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"requestId":"28f2386e-5212-44a0-8c58-22818023c4bf","statusDesc":"OK"}'
2025-02-13 03:05:24.082 DEBUG [tests.filter.test_get_messages] Running test with timestamp Now
2025-02-13 03:05:24.082 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:05:24.089 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.089 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:05:24.189 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:05:24.189 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.191 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739415914408585984,"ephemeral":false}]'
2025-02-13 03:05:24.193 DEBUG [tests.filter.test_get_messages] Running test with timestamp Far future
2025-02-13 03:05:24.194 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:05:24.200 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.200 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:05:24.300 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:05:24.301 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.302 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":2054775914408572928,"ephemeral":false}]'
2025-02-13 03:05:24.304 DEBUG [tests.filter.test_get_messages] Running test with timestamp Recent past
2025-02-13 03:05:24.304 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:05:24.310 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.311 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:05:24.411 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:05:24.411 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.413 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739412314408572928,"ephemeral":false}]'
2025-02-13 03:05:24.414 DEBUG [tests.filter.test_get_messages] Running test with timestamp Near future
2025-02-13 03:05:24.414 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:05:24.421 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.421 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:05:24.521 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:05:24.522 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.523 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1739419514408572928,"ephemeral":false}]'
2025-02-13 03:05:24.525 DEBUG [tests.filter.test_get_messages] Running test with timestamp Positive number
2025-02-13 03:05:24.525 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:05:24.531 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.531 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:05:24.632 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:05:24.632 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.634 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1,"ephemeral":false}]'
2025-02-13 03:05:24.636 DEBUG [tests.filter.test_get_messages] Running test with timestamp Negative number
2025-02-13 03:05:24.636 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:05:24.642 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.643 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:05:24.743 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:05:24.743 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.745 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":-1,"ephemeral":false}]'
2025-02-13 03:05:24.747 DEBUG [tests.filter.test_get_messages] Running test with timestamp DST change
2025-02-13 03:05:24.747 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:59736/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "RmlsdGVyIHdvcmtzISE=", "contentTopic": "/test/1/waku-filter/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:05:24.753 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:05:24.753 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:05:24.853 DEBUG [src.steps.filter] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:05:24.854 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:55426/filter/v2/messages/%2Fwaku%2F2%2Frs%2F3%2F1/%2Ftest%2F1%2Fwaku-filter%2Fproto" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:05:24.855 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"RmlsdGVyIHdvcmtzISE=","contentTopic":"/test/1/waku-filter/proto","version":0,"timestamp":1583632800000000000,"ephemeral":false}]'
2025-02-13 03:05:24.858 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 03:05:24.859 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 03:05:24.859 DEBUG [src.node.waku_node] Stopping container with id 7aa883f4a318
2025-02-13 03:05:25.670 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 03:05:25.670 DEBUG [src.node.waku_node] Stopping container with id 9a03a944725b
2025-02-13 03:05:26.160 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 03:05:26.162 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 03:05:26.169 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 03:05:26.172 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
