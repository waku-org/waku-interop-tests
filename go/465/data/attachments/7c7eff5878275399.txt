2025-02-13 03:10:02.694 DEBUG [tests.conftest] Running fixture setup: test_id
2025-02-13 03:10:02.694 DEBUG [tests.conftest] Running test: test_publish_with_invalid_timestamps with id: 2025-02-13_03-10-02__a5883a97-b3f8-42b4-9030-6065dfd24776
2025-02-13 03:10:02.695 DEBUG [src.steps.common] Running fixture setup: common_setup
2025-02-13 03:10:02.695 DEBUG [src.steps.relay] Running fixture setup: relay_setup
2025-02-13 03:10:02.695 DEBUG [src.steps.relay] Running fixture setup: setup_main_relay_nodes
2025-02-13 03:10:02.701 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/nwaku:latest
2025-02-13 03:10:02.701 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node1_2025-02-13_03-10-02__a5883a97-b3f8-42b4-9030-6065dfd24776__wakuorg_nwaku:latest.log
2025-02-13 03:10:02.701 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 03:10:02.702 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 03:10:02.703 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 03:10:02.703 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.83.82
2025-02-13 03:10:02.703 DEBUG [src.node.docker_mananger] Generated ports ['20769', '20770', '20771', '20772', '20773']
2025-02-13 03:10:02.703 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 03:10:02.703 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 03:10:02.704 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 03:10:02.704 DEBUG [src.node.docker_mananger] docker run -i -t -p 20769:20769 -p 20770:20770 -p 20771:20771 -p 20772:20772 -p 20773:20773 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=20771 --rest-port=20769 --tcp-port=20770 --discv5-udp-port=20772 --rest-address=0.0.0.0 --nat=extip:172.18.83.82 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=4f5deb5bf3af22dfdaf8cfdeabc9a7e3e8f4cc6feabe10365ae06860ae100fff --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=20773 --metrics-logging=true --relay=true
2025-02-13 03:10:02.926 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.83.82 waku 305fcfe2a988334d1ceb1e84499ee30994be58749977895e7052b16103421495
2025-02-13 03:10:02.975 DEBUG [src.node.docker_mananger] Container started with ID 305fcfe2a988. Setting up logs at ./log/docker/node1_2025-02-13_03-10-02__a5883a97-b3f8-42b4-9030-6065dfd24776__wakuorg_nwaku:latest.log
2025-02-13 03:10:02.976 DEBUG [src.node.waku_node] Started container from image wakuorg/nwaku:latest. REST: 20769
2025-02-13 03:10:02.976 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 03:10:03.479 ERROR [src.node.docker_mananger] Max retries reached for container b24bd148e41f. Exiting log stream.
2025-02-13 03:10:03.976 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20769/health" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:10:03.979 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
2025-02-13 03:10:03.980 INFO [src.node.waku_node] Node protocols are initialized !!
2025-02-13 03:10:03.980 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20769/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:10:03.982 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.83.82/tcp/20770/p2p/16Uiu2HAmMMSMbvhj1a4iXynXuD4KGwGi3TJXjxivNFE1EVi1LbaZ","/ip4/172.18.83.82/tcp/20771/ws/p2p/16Uiu2HAmMMSMbvhj1a4iXynXuD4KGwGi3TJXjxivNFE1EVi1LbaZ"],"enrUri":"enr:-L24QFjQFebPutdFapAOTco7pXGrCuzyXfMRuZsS3hlkdJ-1bWbHLx9GRLK43qOopVP5tqRmGjZGLMoZQJsctaN474MCgmlkgnY0gmlwhKwSU1KKbXVsdGlhZGRyc5YACASsElNSBlEiAAoErBJTUgZRI90DgnJzhQADAQAAiXNlY3AyNTZrMaEDgToh1f-h_fdzo5oMifj4IsGKhWXDbuz47vzI_JIP53qDdGNwglEig3VkcIJRJIV3YWt1MgE"}'
2025-02-13 03:10:03.982 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 03:10:03.989 DEBUG [src.node.docker_mananger] Docker client initialized with image wakuorg/go-waku:latest
2025-02-13 03:10:03.989 DEBUG [src.node.waku_node] WakuNode instance initialized with log path ./log/docker/node2_2025-02-13_03-10-02__a5883a97-b3f8-42b4-9030-6065dfd24776__wakuorg_go-waku:latest.log
2025-02-13 03:10:03.989 DEBUG [src.node.waku_node] Starting Node...
2025-02-13 03:10:03.989 DEBUG [src.node.docker_mananger] Attempting to create or retrieve network waku
2025-02-13 03:10:03.990 DEBUG [src.node.docker_mananger] Network waku already exists
2025-02-13 03:10:03.990 DEBUG [src.node.docker_mananger] Generated random external IP 172.18.165.210
2025-02-13 03:10:03.991 DEBUG [src.node.docker_mananger] Generated ports ['19050', '19051', '19052', '19053', '19054']
2025-02-13 03:10:03.991 DEBUG [src.node.waku_node] RLN credentials were not set
2025-02-13 03:10:03.991 INFO [src.node.waku_node] RLN credentials not set or credential store not available, starting without RLN
2025-02-13 03:10:03.991 DEBUG [src.node.waku_node] Using volumes []
2025-02-13 03:10:03.991 DEBUG [src.node.docker_mananger] docker run -i -t -p 19050:19050 -p 19051:19051 -p 19052:19052 -p 19053:19053 -p 19054:19054 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=19052 --rest-port=19050 --tcp-port=19051 --discv5-udp-port=19053 --rest-address=0.0.0.0 --nat=extip:172.18.165.210 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=dd7aabceee8787685126c136fb6f6a1cdeababafc4f8f1f296cd1cfea50fee65 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-L24QFjQFebPutdFapAOTco7pXGrCuzyXfMRuZsS3hlkdJ-1bWbHLx9GRLK43qOopVP5tqRmGjZGLMoZQJsctaN474MCgmlkgnY0gmlwhKwSU1KKbXVsdGlhZGRyc5YACASsElNSBlEiAAoErBJTUgZRI90DgnJzhQADAQAAiXNlY3AyNTZrMaEDgToh1f-h_fdzo5oMifj4IsGKhWXDbuz47vzI_JIP53qDdGNwglEig3VkcIJRJIV3YWt1MgE
2025-02-13 03:10:04.243 DEBUG [src.node.docker_mananger] docker network connect --ip 172.18.165.210 waku 56af8df20343742488a33e70eac5e62065547120c306bd8e4f64efd527878d5d
2025-02-13 03:10:04.301 DEBUG [src.node.docker_mananger] Container started with ID 56af8df20343. Setting up logs at ./log/docker/node2_2025-02-13_03-10-02__a5883a97-b3f8-42b4-9030-6065dfd24776__wakuorg_go-waku:latest.log
2025-02-13 03:10:04.302 DEBUG [src.node.waku_node] Started container from image wakuorg/go-waku:latest. REST: 19050
2025-02-13 03:10:04.302 DEBUG [src.libs.common] Sleeping for 1 seconds
2025-02-13 03:10:05.303 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19050/debug/v1/info" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:10:05.305 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'{"enrUri":"enr:-J-4QKrAkjQ76UsMuCe3hIqUTjd7ecxOUeCTcw-gMlTN80D1FPKC95RFUqEbLwfxMYrVYsr94QkfjoKMjVss4Pj23zyGAZT9SPQAgmlkgnY0gmlwhKwRAAOCcnODAAMAiXNlY3AyNTZrMaECx1EIxbwZ1YvAimsr0_KeJBLFvySTKb6ZtiLIH2X-NW2DdGNwgkprg3VkcIJKbYV3YWt1MgE","listenAddresses":["/ip4/127.0.0.1/tcp/19051/p2p/16Uiu2HAm8qin8iWeq1oGbiZZYw5aBPZtevnsTPhpEawqqjNhexHi","/ip4/127.0.0.1/tcp/19052/ws/p2p/16Uiu2HAm8qin8iWeq1oGbiZZYw5aBPZtevnsTPhpEawqqjNhexHi","/ip4/172.17.0.3/tcp/19051/p2p/16Uiu2HAm8qin8iWeq1oGbiZZYw5aBPZtevnsTPhpEawqqjNhexHi","/ip4/172.17.0.3/tcp/19052/ws/p2p/16Uiu2HAm8qin8iWeq1oGbiZZYw5aBPZtevnsTPhpEawqqjNhexHi"]}'
2025-02-13 03:10:05.306 INFO [src.node.waku_node] REST service is ready !!
2025-02-13 03:10:05.306 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19050/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.83.82/tcp/20770/p2p/16Uiu2HAmMMSMbvhj1a4iXynXuD4KGwGi3TJXjxivNFE1EVi1LbaZ", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
2025-02-13 03:10:05.323 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-13 03:10:05.325 DEBUG [src.steps.relay] Running fixture setup: subscribe_main_relay_nodes
2025-02-13 03:10:05.325 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 03:10:05.347 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:10:05.347 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:19050/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/1"]'
2025-02-13 03:10:05.349 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'true'
2025-02-13 03:10:05.352 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:05.363 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:10:05.363 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:10:05.464 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-13 03:10:05.464 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:10:05.467 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739416205352653824,"ephemeral":false}]'
2025-02-13 03:10:05.468 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:10:05.468 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19050/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:10:05.470 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'null'
2025-02-13 03:10:06.471 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.476 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'OK'
2025-02-13 03:10:06.476 DEBUG [src.libs.common] Sleeping for 0.1 seconds
2025-02-13 03:10:06.576 DEBUG [src.steps.relay] Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
2025-02-13 03:10:06.576 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:10:06.579 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739416206471030272,"ephemeral":false}]'
2025-02-13 03:10:06.581 DEBUG [src.steps.relay] Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
2025-02-13 03:10:06.581 INFO [src.node.api_clients.base_client] curl -v -X GET "http://127.0.0.1:19050/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d 'None'
2025-02-13 03:10:06.582 INFO [src.node.api_clients.base_client] Response status code: 200. Response content: b'[{"payload":"UmVsYXkgd29ya3MhIQ==","contentTopic":"/test/1/waku-relay/proto","version":0,"timestamp":1739416206471030272,"ephemeral":false}]'
2025-02-13 03:10:06.584 INFO [src.steps.relay] WARM UP successful!!
2025-02-13 03:10:06.585 DEBUG [tests.relay.test_publish] Running test with timestamp Timestamp as string number
2025-02-13 03:10:06.585 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.587 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 03:10:06.588 DEBUG [tests.relay.test_publish] Running test with timestamp Invalid large number
2025-02-13 03:10:06.589 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.591 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 03:10:06.592 DEBUG [tests.relay.test_publish] Running test with timestamp Float number
2025-02-13 03:10:06.592 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.594 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 03:10:06.595 DEBUG [tests.relay.test_publish] Running test with timestamp Array instead of timestamp
2025-02-13 03:10:06.595 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.598 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 03:10:06.598 DEBUG [tests.relay.test_publish] Running test with timestamp Object instead of timestamp
2025-02-13 03:10:06.599 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.601 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 03:10:06.601 DEBUG [tests.relay.test_publish] Running test with timestamp ISO 8601 timestamp
2025-02-13 03:10:06.602 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.604 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 03:10:06.604 DEBUG [tests.relay.test_publish] Running test with timestamp Missing
2025-02-13 03:10:06.605 INFO [src.node.api_clients.base_client] curl -v -X POST "http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1" -H "Content-Type: application/json" -d '{"payload": "UmVsYXkgd29ya3MhIQ==", "contentTopic": "/test/1/waku-relay/proto", "timestamp": '$(date +%s%N)'}'
2025-02-13 03:10:06.607 ERROR [src.node.api_clients.base_client] HTTP error occurred: 400 Client Error: Bad Request for url: http://127.0.0.1:20769/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F1. Response content: b'Invalid content body, could not decode. Unable to deserialize data'
2025-02-13 03:10:06.609 DEBUG [tests.conftest] Running fixture teardown: test_setup
2025-02-13 03:10:06.610 DEBUG [tests.conftest] Running fixture teardown: close_open_nodes
2025-02-13 03:10:06.610 DEBUG [src.node.waku_node] Stopping container with id 305fcfe2a988
2025-02-13 03:10:07.155 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 03:10:07.155 DEBUG [src.node.waku_node] Stopping container with id 56af8df20343
2025-02-13 03:10:07.639 DEBUG [src.node.waku_node] Container stopped.
2025-02-13 03:10:07.642 DEBUG [tests.conftest] Running fixture teardown: check_waku_log_errors
2025-02-13 03:10:07.649 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
2025-02-13 03:10:07.653 DEBUG [src.node.docker_mananger] No errors found in the waku logs.
