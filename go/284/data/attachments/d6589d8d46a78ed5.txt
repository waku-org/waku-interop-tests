[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_2_nodes_different_cluster_same_shard with id: 2024-09-19_03-22-55__f51e844a-86cf-42ab-bc21-374fb7e3791c
[35mDEBUG   [0m src.steps.common:common.py:17 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.relay:relay.py:28 Running fixture setup: relay_setup
[35mDEBUG   [0m src.steps.sharding:sharding.py:29 Running fixture setup: sharding_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node1_2024-09-19_03-22-55__f51e844a-86cf-42ab-bc21-374fb7e3791c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.211.149
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['62549', '62550', '62551', '62552', '62553']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 2
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 62549:62549 -p 62550:62550 -p 62551:62551 -p 62552:62552 -p 62553:62553 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=62551 --rest-port=62549 --tcp-port=62550 --discv5-udp-port=62552 --rest-address=0.0.0.0 --nat=extip:172.18.211.149 --peer-exchange=true --discv5-discovery=true --cluster-id=2 --nodekey=26ceb74f2ce2669ed2f94cfcafde8824da1210faa3eccc1ebfbeccff3313afb5 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=62553 --metrics-logging=true --relay=true --filter=true --pubsub-topic=/waku/2/rs/2/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.211.149 waku 38f755bc26d134457d66c6fba58c1e8fde2cf66c80e58c226e05b9c3cc9467b3
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 38f755bc26d1. Setting up logs at ./log/docker/node1_2024-09-19_03-22-55__f51e844a-86cf-42ab-bc21-374fb7e3791c__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/nwaku:latest. REST: 62549
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62549/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:277 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62549/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.211.149/tcp/62550/p2p/16Uiu2HAmKHqHUnBhFChs2CHSNtTfRk5QSKE4C52RodVwCP3K2qRp","/ip4/172.18.211.149/tcp/62551/ws/p2p/16Uiu2HAmKHqHUnBhFChs2CHSNtTfRk5QSKE4C52RodVwCP3K2qRp"],"enrUri":"enr:-LO4QFA1qHNpHy3LCCrsOh71mmQ7pvUksCO3uV0IYxhQRC6dAcnBOk9uWEp5zgTlMV3N1v8HWTN5d38hhXdhqs7HkbIBgmlkgnY0gmlwhKwS05WKbXVsdGlhZGRyc4wACgSsEtOVBvRX3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNillxi4M7FRa2mydyPeieTXvkGEvqAZM6pUVlTr97X54N0Y3CC9FaDdWRwgvRYhXdha3UyBQ"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:18 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/node2_2024-09-19_03-22-55__f51e844a-86cf-42ab-bc21-374fb7e3791c__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:21 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:24 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:81 Generated random external IP 172.18.111.47
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:74 Generated ports ['36089', '36090', '36091', '36092', '36093']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:72 Cluster id was resolved to: 4
[35mDEBUG   [0m src.node.waku_node:waku_node.py:434 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:163 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:165 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:48 docker run -i -t -p 36089:36089 -p 36090:36090 -p 36091:36091 -p 36092:36092 -p 36093:36093 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=36091 --rest-port=36089 --tcp-port=36090 --discv5-udp-port=36092 --rest-address=0.0.0.0 --nat=extip:172.18.111.47 --peer-exchange=true --discv5-discovery=true --cluster-id=4 --nodekey=be9a7d29c7a7e80893fc47ccecda3654f6fba421f9cdf8edba329ca8cb6e8dd2 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --relay=true --discv5-bootstrap-node=enr:-LO4QFA1qHNpHy3LCCrsOh71mmQ7pvUksCO3uV0IYxhQRC6dAcnBOk9uWEp5zgTlMV3N1v8HWTN5d38hhXdhqs7HkbIBgmlkgnY0gmlwhKwS05WKbXVsdGlhZGRyc4wACgSsEtOVBvRX3QOCcnOFAAIBAACJc2VjcDI1NmsxoQNillxi4M7FRa2mydyPeieTXvkGEvqAZM6pUVlTr97X54N0Y3CC9FaDdWRwgvRYhXdha3UyBQ --pubsub-topic=/waku/2/rs/4/0
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:54 docker network connect --ip 172.18.111.47 waku 422177fa5885ff85b2b2a523d0739bc5bcad1a3e1c82ab1b362aa7686955e2ec
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:57 Container started with ID 422177fa5885. Setting up logs at ./log/docker/node2_2024-09-19_03-22-55__f51e844a-86cf-42ab-bc21-374fb7e3791c__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:177 Started container from image wakuorg/go-waku:latest. REST: 36089
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36089/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-KG4QBQxFfzGF8989RiUeCtaxB_QDLzWqkSF0bWjyNRCsDPdPMkgfE16IA0ZFdHzre-u5Dfk8-7vAuhjTBI8R9hmVEaGAZIITewHgmlkgnY0gmlwhKwRAAiCcnOFAAQBAACJc2VjcDI1NmsxoQPUGGWJYSw_-eUNgMHyTcujc1at54A_f8A3kK6C5aUA7oN0Y3CCjPqDdWRwgoz8hXdha3UyAQ","listenAddresses":["/ip4/127.0.0.1/tcp/36090/p2p/16Uiu2HAmSvvMn7VXheKCgcF8gnHDST79Zupu1Ev6ZGZJfDiwuviH","/ip4/127.0.0.1/tcp/36091/ws/p2p/16Uiu2HAmSvvMn7VXheKCgcF8gnHDST79Zupu1Ev6ZGZJfDiwuviH","/ip4/172.17.0.8/tcp/36090/p2p/16Uiu2HAmSvvMn7VXheKCgcF8gnHDST79Zupu1Ev6ZGZJfDiwuviH","/ip4/172.17.0.8/tcp/36091/ws/p2p/16Uiu2HAmSvvMn7VXheKCgcF8gnHDST79Zupu1Ev6ZGZJfDiwuviH"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:282 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36089/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.211.149/tcp/62550/p2p/16Uiu2HAmKHqHUnBhFChs2CHSNtTfRk5QSKE4C52RodVwCP3K2qRp", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62549/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/2/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:36089/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/4/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:62549/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d '{"payload": "U2hhcmRpbmcgd29ya3MhIQ==", "contentTopic": "/myapp/1/latest/proto", "timestamp": '$(date +%s%N)'}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_1:wakuorg/nwaku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:62549/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"U2hhcmRpbmcgd29ya3MhIQ==","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1726716178442989312,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.sharding:sharding.py:157 Checking that peer NODE_2:wakuorg/go-waku:latest can find the published message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:36089/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0" -H "Content-Type: application/json" -d 'None'
[31m[1mERROR   [0m src.node.api_clients.base_client:base_client.py:16 HTTP error occurred: 404 Client Error: Not Found for url: http://127.0.0.1:36089/relay/v1/messages/%2Fwaku%2F2%2Frs%2F2%2F0. Response content: b'no subscription found for pubsubTopic'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 38f755bc26d1
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:221 Stopping container with id 422177fa5885
[35mDEBUG   [0m src.node.waku_node:waku_node.py:228 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:117 No errors found in the waku logs.