[35mDEBUG   [0m tests.conftest:conftest.py:51 Running fixture setup: test_id
[35mDEBUG   [0m tests.conftest:conftest.py:57 Running test: test_light_push_with_ephemeral with id: 2024-11-18_10-09-20__3e91e5c4-d94e-4d07-aa66-da1676e9c21f
[35mDEBUG   [0m src.steps.common:common.py:18 Running fixture setup: common_setup
[35mDEBUG   [0m src.steps.light_push:light_push.py:28 Running fixture setup: light_push_setup
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node1_2024-11-18_10-09-20__3e91e5c4-d94e-4d07-aa66-da1676e9c21f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.112.186
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['21626', '21627', '21628', '21629', '21630']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 21626:21626 -p 21627:21627 -p 21628:21628 -p 21629:21629 -p 21630:21630 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=21628 --rest-port=21626 --tcp-port=21627 --discv5-udp-port=21629 --rest-address=0.0.0.0 --nat=extip:172.18.112.186 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=efcc9881f93aa0c2b0ccd368f87fc8f2a9bff39d1bc527dbff25100a410c2ec7 --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=21630 --metrics-logging=true --lightpush=true --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.112.186 waku a4c485b2636ebf4a7068c731dde4a7837111051e08f03435afcb47939ab97eca
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID a4c485b2636e. Setting up logs at ./log/docker/receiving_node1_2024-11-18_10-09-20__3e91e5c4-d94e-4d07-aa66-da1676e9c21f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 21626
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 735f68118fd3. Exiting log stream.
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21626/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21626/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.112.186/tcp/21627/p2p/16Uiu2HAmA9bT8CtHts4gYkg3rs71nKz5SMxu72kzh5ZaZdhXBzEr","/ip4/172.18.112.186/tcp/21628/ws/p2p/16Uiu2HAmA9bT8CtHts4gYkg3rs71nKz5SMxu72kzh5ZaZdhXBzEr"],"enrUri":"enr:-L24QA5qXAAAJ6IK29bwMSrno_8CuV7lWvsCblK4nAcWarpPcdu5LsRa0LbpimUHD3hzDzwhfgvAYufA4JvcGoeIhYwCgmlkgnY0gmlwhKwScLqKbXVsdGlhZGRyc5YACASsEnC6BlR7AAoErBJwugZUfN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC2sDj5-MVzJUVjnhY6QmJ5ugO-BpSuiQYOBgslk8OkJeDdGNwglR7g3VkcIJUfYV3YWt1Mgk"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/nwaku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/receiving_node2_2024-11-18_10-09-20__3e91e5c4-d94e-4d07-aa66-da1676e9c21f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.18.165
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['48109', '48110', '48111', '48112', '48113']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 48109:48109 -p 48110:48110 -p 48111:48111 -p 48112:48112 -p 48113:48113 wakuorg/nwaku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=TRACE --rest-relay-cache-capacity=100 --websocket-port=48111 --rest-port=48109 --tcp-port=48110 --discv5-udp-port=48112 --rest-address=0.0.0.0 --nat=extip:172.18.18.165 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7fa13c5dc76bf97a9d46de082e7d6d6441afc3df5552de3eff338c7ba7a7ff7c --shard=0 --metrics-server=true --metrics-server-address=0.0.0.0 --metrics-server-port=48113 --metrics-logging=true --lightpush=false --relay=true
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.18.165 waku 337f5a394e3b11a556729795ff66bf48bdc752ee9a85998c3b02b522702aea59
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID 337f5a394e3b. Setting up logs at ./log/docker/receiving_node2_2024-11-18_10-09-20__3e91e5c4-d94e-4d07-aa66-da1676e9c21f__wakuorg_nwaku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/nwaku:latest. REST: 48109
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48109/health" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"nodeHealth":"Ready","protocolsHealth":[]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:279 Node protocols are initialized !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48109/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"listenAddresses":["/ip4/172.18.18.165/tcp/48110/p2p/16Uiu2HAm1cs3EbSTkm1h6Lz6cF1KBx3eZx3xSwwurMQoMQWbLntA","/ip4/172.18.18.165/tcp/48111/ws/p2p/16Uiu2HAm1cs3EbSTkm1h6Lz6cF1KBx3eZx3xSwwurMQoMQWbLntA"],"enrUri":"enr:-L24QMDVssyvmWzKH6LQtJKath3y_MQfmqu27pgUGCu3E921dGZ-vpGNrplX6dRNsFD-U62LpYG9NQMJI7GTozdM-FECgmlkgnY0gmlwhKwSEqWKbXVsdGlhZGRyc5YACASsEhKlBrvuAAoErBISpQa7790DgnJzhQADAQAAiXNlY3AyNTZrMaECXAQD6jhO-kdA72mwzRIYf3fV_oZC_uJjK_M-9xV3GOODdGNwgrvug3VkcIK78IV3YWt1MgE"}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48109/admin/v1/peers" -H "Content-Type: application/json" -d '["/ip4/172.18.112.186/tcp/21627/p2p/16Uiu2HAmA9bT8CtHts4gYkg3rs71nKz5SMxu72kzh5ZaZdhXBzEr"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:19 Docker client initialized with image wakuorg/go-waku:latest
[35mDEBUG   [0m src.node.waku_node:waku_node.py:85 WakuNode instance initialized with log path ./log/docker/lightpush_node1_2024-11-18_10-09-20__3e91e5c4-d94e-4d07-aa66-da1676e9c21f__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:89 Starting Node...
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:22 Attempting to create or retrieve network waku
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:25 Network waku already exists
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:108 Generated random external IP 172.18.80.58
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:101 Generated ports ['20771', '20772', '20773', '20774', '20775']
[35mDEBUG   [0m src.node.waku_node:waku_node.py:436 RLN credentials were not set
[32mINFO    [0m src.node.waku_node:waku_node.py:165 RLN credentials not set or credential store not available, starting without RLN
[35mDEBUG   [0m src.node.waku_node:waku_node.py:167 Using volumes []
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:49 docker run -i -t -p 20771:20771 -p 20772:20772 -p 20773:20773 -p 20774:20774 -p 20775:20775 wakuorg/go-waku:latest --listen-address=0.0.0.0 --rest=true --rest-admin=true --websocket-support=true --log-level=DEBUG --rest-relay-cache-capacity=100 --websocket-port=20773 --rest-port=20771 --tcp-port=20772 --discv5-udp-port=20774 --rest-address=0.0.0.0 --nat=extip:172.18.80.58 --peer-exchange=true --discv5-discovery=true --cluster-id=3 --nodekey=7f614acb47ad61ca5db98c87cefabd60adcb25bdcb0fecc17efc7212b05ad5e2 --min-relay-peers-to-publish=1 --rest-filter-cache-capacity=50 --peer-store-capacity=10 --discv5-bootstrap-node=enr:-L24QA5qXAAAJ6IK29bwMSrno_8CuV7lWvsCblK4nAcWarpPcdu5LsRa0LbpimUHD3hzDzwhfgvAYufA4JvcGoeIhYwCgmlkgnY0gmlwhKwScLqKbXVsdGlhZGRyc5YACASsEnC6BlR7AAoErBJwugZUfN0DgnJzhQADAQAAiXNlY3AyNTZrMaEC2sDj5-MVzJUVjnhY6QmJ5ugO-BpSuiQYOBgslk8OkJeDdGNwglR7g3VkcIJUfYV3YWt1Mgk --lightpushnode=/ip4/172.18.112.186/tcp/21627/p2p/16Uiu2HAmA9bT8CtHts4gYkg3rs71nKz5SMxu72kzh5ZaZdhXBzEr --lightpush=true --relay=false
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:55 docker network connect --ip 172.18.80.58 waku c34cc51ec94a71f5c0db7e9c597d9a077a5372b39f994678bb31bc3c66739ca6
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:58 Container started with ID c34cc51ec94a. Setting up logs at ./log/docker/lightpush_node1_2024-11-18_10-09-20__3e91e5c4-d94e-4d07-aa66-da1676e9c21f__wakuorg_go-waku:latest.log
[35mDEBUG   [0m src.node.waku_node:waku_node.py:179 Started container from image wakuorg/go-waku:latest. REST: 20771
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 1 seconds
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:20771/debug/v1/info" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'{"enrUri":"enr:-Ji4QMA3lHi4sOju9PhhEwtLfjBcagBMvoOkkEXRpbcUhUUffB1U9nkfCP1vbf2C3w5BUIX7Wuy1ixHWf6UWXjxnsKWGAZM-v5ipgmlkgnY0gmlwhKwRAAKJc2VjcDI1NmsxoQIzfCgbzspkBOml7JUAnH_LK5CvZsVWLK7w2rXr0Vp-EYN0Y3CCUSSDdWRwglEmhXdha3UyCA","listenAddresses":["/ip4/127.0.0.1/tcp/20772/p2p/16Uiu2HAkxteaSZFxwwiiMRUgPStoqTXJpUsgnFhZoGLWyUmYkdck","/ip4/127.0.0.1/tcp/20773/ws/p2p/16Uiu2HAkxteaSZFxwwiiMRUgPStoqTXJpUsgnFhZoGLWyUmYkdck","/ip4/172.17.0.2/tcp/20772/p2p/16Uiu2HAkxteaSZFxwwiiMRUgPStoqTXJpUsgnFhZoGLWyUmYkdck","/ip4/172.17.0.2/tcp/20773/ws/p2p/16Uiu2HAkxteaSZFxwwiiMRUgPStoqTXJpUsgnFhZoGLWyUmYkdck"]}'
[32mINFO    [0m src.node.waku_node:waku_node.py:284 REST service is ready !!
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20771/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.112.186/tcp/21627/p2p/16Uiu2HAmA9bT8CtHts4gYkg3rs71nKz5SMxu72kzh5ZaZdhXBzEr", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20771/admin/v1/peers" -H "Content-Type: application/json" -d '{"multiaddr": "/ip4/172.18.18.165/tcp/48110/p2p/16Uiu2HAm1cs3EbSTkm1h6Lz6cF1KBx3eZx3xSwwurMQoMQWbLntA", "protocols": ["/vac/waku/relay/2.0.0"], "shards": [0, 1, 2, 3, 4, 5, 6, 7, 8]}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'null'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:21626/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:48109/relay/v1/subscriptions" -H "Content-Type: application/json" -d '["/waku/2/rs/3/0"]'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'OK'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral True
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20771/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1731924565221826560, "ephemeral": true}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21626/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731924565221826560,"ephemeral":true}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48109/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731924565221826560,"ephemeral":true}]'
[35mDEBUG   [0m tests.light_push.test_publish:test_publish.py:214 Running test with Ephemeral False
[35mDEBUG   [0m src.steps.light_push:light_push.py:121 Lightpushing message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X POST "http://127.0.0.1:20771/lightpush/v1/message" -H "Content-Type: application/json" -d '{"pubsubTopic": "/waku/2/rs/3/0", "message": {"payload": "TGlnaHQgcHVzaCB3b3JrcyEh", "contentTopic": "/myapp/1/latest/proto", "timestamp": 1731924565337710848, "ephemeral": false}}'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'true'
[35mDEBUG   [0m src.libs.common:common.py:35 Sleeping for 0.1 seconds
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_1:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:21626/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731924565337710848,"ephemeral":false}]'
[35mDEBUG   [0m src.steps.light_push:light_push.py:125 Checking that peer NODE_2:wakuorg/nwaku:latest can find the lightpushed message
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:37 curl -v -X GET "http://127.0.0.1:48109/relay/v1/messages/%2Fwaku%2F2%2Frs%2F3%2F0" -H "Content-Type: application/json" -d 'None'
[32mINFO    [0m src.node.api_clients.base_client:base_client.py:22 Response status code: 200. Response content: b'[{"payload":"TGlnaHQgcHVzaCB3b3JrcyEh","contentTopic":"/myapp/1/latest/proto","version":0,"timestamp":1731924565337710848,"ephemeral":false}]'
[35mDEBUG   [0m tests.conftest:conftest.py:59 Running fixture teardown: test_setup
[35mDEBUG   [0m tests.conftest:conftest.py:83 Running fixture teardown: close_open_nodes
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id a4c485b2636e
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id 337f5a394e3b
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container a4c485b2636e. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:223 Stopping container with id c34cc51ec94a
[31m[1mERROR   [0m src.node.docker_mananger:docker_mananger.py:89 Max retries reached for container 337f5a394e3b. Exiting log stream.
[35mDEBUG   [0m src.node.waku_node:waku_node.py:230 Container stopped.
[35mDEBUG   [0m tests.conftest:conftest.py:98 Running fixture teardown: check_waku_log_errors
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.
[35mDEBUG   [0m src.node.docker_mananger:docker_mananger.py:144 No errors found in the waku logs.