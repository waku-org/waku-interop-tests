{"uid":"14287cba5e9f9287","name":"test_filter_works_with_static_sharding","fullName":"tests.sharding.test_filter.TestFilterStaticSharding#test_filter_works_with_static_sharding","historyId":"afae3d866d7a1521f4498a67a21af305","time":{"start":1738120010151,"stop":1738120012761,"duration":2610},"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions with response: b'{\"requestId\":\"4ec768ac-952a-4aef-877a-08154c7bd467\",\"statusDesc\":\"subscription failed\"}'","statusTrace":"src/node/api_clients/base_client.py:14: in make_request\n    response.raise_for_status()\n/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/site-packages/requests/models.py:1021: in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nE   requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions\n\nDuring handling of the above exception, another exception occurred:\ntests/sharding/test_filter.py:17: in test_filter_works_with_static_sharding\n    self.subscribe_filter_node(self.node2, content_topics=[self.test_content_topic], pubsub_topic=self.test_pubsub_topic)\nsrc/steps/sharding.py:128: in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\nsrc/node/waku_node.py:358: in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\nsrc/node/api_clients/rest.py:68: in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\nsrc/node/api_clients/rest.py:16: in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\nsrc/node/api_clients/base_client.py:17: in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\nE   Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions with response: b'{\"requestId\":\"4ec768ac-952a-4aef-877a-08154c7bd467\",\"statusDesc\":\"subscription failed\"}'","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":2,"retriesStatusChange":true,"beforeStages":[{"name":"set_allure_env_variables","time":{"start":1738119787664,"stop":1738119787664,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"attach_logs_on_fail","time":{"start":1738120010149,"stop":1738120010150,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_setup","time":{"start":1738120010150,"stop":1738120010150,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"close_open_nodes","time":{"start":1738120010150,"stop":1738120010150,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"common_setup","time":{"start":1738120010150,"stop":1738120010150,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"check_waku_log_errors","time":{"start":1738120010150,"stop":1738120010150,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_id","time":{"start":1738120010150,"stop":1738120010150,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"relay_setup","time":{"start":1738120010151,"stop":1738120010151,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"sharding_setup","time":{"start":1738120010151,"stop":1738120010151,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions with response: b'{\"requestId\":\"4ec768ac-952a-4aef-877a-08154c7bd467\",\"statusDesc\":\"subscription failed\"}'","statusTrace":"src/node/api_clients/base_client.py:14: in make_request\n    response.raise_for_status()\n/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/site-packages/requests/models.py:1021: in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nE   requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions\n\nDuring handling of the above exception, another exception occurred:\ntests/sharding/test_filter.py:17: in test_filter_works_with_static_sharding\n    self.subscribe_filter_node(self.node2, content_topics=[self.test_content_topic], pubsub_topic=self.test_pubsub_topic)\nsrc/steps/sharding.py:128: in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\nsrc/node/waku_node.py:358: in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\nsrc/node/api_clients/rest.py:68: in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\nsrc/node/api_clients/rest.py:16: in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\nsrc/node/api_clients/base_client.py:17: in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\nE   Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions with response: b'{\"requestId\":\"4ec768ac-952a-4aef-877a-08154c7bd467\",\"statusDesc\":\"subscription failed\"}'","steps":[{"name":"setup_first_relay_node_with_filter","time":{"start":1738120010151,"stop":1738120011453,"duration":1302},"status":"passed","steps":[{"name":"setup_first_relay_node","time":{"start":1738120010151,"stop":1738120011453,"duration":1302},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"filter","value":"'true'"},{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"setup_second_node_as_filter","time":{"start":1738120011453,"stop":1738120012746,"duration":1293},"status":"passed","steps":[{"name":"add_node_peer","time":{"start":1738120012744,"stop":1738120012746,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"args","value":"(<tests.sharding.test_filter.TestFilterStaticSharding object at 0x7fc37567f710>, <src.node.waku_node.WakuNode object at 0x7fc37522f9b0>, ['/ip4/172.18.75.238/tcp/24738/p2p/16Uiu2HAmVSP28geqdtsHVhFMrqLWZfaGM6d4gWiWbe4AR4ep83Np'])"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"subscribe_first_relay_node","time":{"start":1738120012746,"stop":1738120012749,"duration":3},"status":"passed","steps":[{"name":"subscribe_relay_node","time":{"start":1738120012747,"stop":1738120012749,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"node","value":"<src.node.waku_node.WakuNode object at 0x7fc37511cd70>"},{"name":"content_topics","value":"None"},{"name":"pubsub_topics","value":"['/waku/2/rs/2/0']"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"content_topics","value":"None"},{"name":"pubsub_topics","value":"['/waku/2/rs/2/0']"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"subscribe_filter_node","time":{"start":1738120012750,"stop":1738120012759,"duration":9},"status":"broken","statusMessage":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:53574/filter/v2/subscriptions with response: b'{\"requestId\":\"4ec768ac-952a-4aef-877a-08154c7bd467\",\"statusDesc\":\"subscription failed\"}'\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/steps/sharding.py\", line 128, in subscribe_filter_node\n    node.set_filter_subscriptions(subscription)\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/waku_node.py\", line 358, in set_filter_subscriptions\n    return self._api.set_filter_subscriptions(subscription)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/rest.py\", line 68, in set_filter_subscriptions\n    set_subscriptions_response = self.rest_call(\"post\", \"filter/v2/subscriptions\", json.dumps(subscription))\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/rest.py\", line 16, in rest_call\n    return self.make_request(method, url, headers=headers, data=payload)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/waku-interop-tests/waku-interop-tests/src/node/api_clients/base_client.py\", line 17, in make_request\n    raise Exception(f\"Error: {http_err} with response: {response.content}\")\n","steps":[],"attachments":[],"parameters":[{"name":"node","value":"<src.node.waku_node.WakuNode object at 0x7fc37522f9b0>"},{"name":"content_topics","value":"['/myapp/1/latest/proto']"},{"name":"pubsub_topic","value":"'/waku/2/rs/2/0'"}],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"7686acc48401aa3e","name":"log","source":"7686acc48401aa3e.txt","type":"text/plain","size":34481}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":7,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"test_setup::0","time":{"start":1738120012792,"stop":1738120012792,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"close_open_nodes::0","time":{"start":1738120012793,"stop":1738120014258,"duration":1465},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"check_waku_log_errors::0","time":{"start":1738120014259,"stop":1738120014267,"duration":8},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"attach_logs_on_fail::0","time":{"start":1738120014267,"stop":1738120014268,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"34e8a493d7342173","name":"node2_2025-01-29_03-06-50__2f870331-a1fd-4424-9057-4017640805f0__wakuorg_go-waku:latest.log","source":"34e8a493d7342173.txt","type":"text/plain","size":57901},{"uid":"13401d420d6c8a5b","name":"node1_2025-01-29_03-06-50__2f870331-a1fd-4424-9057-4017640805f0__wakuorg_nwaku:latest.log","source":"13401d420d6c8a5b.txt","type":"text/plain","size":111324}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"set_allure_env_variables::0","time":{"start":1738120063597,"stop":1738120063597,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.sharding"},{"name":"suite","value":"test_filter"},{"name":"subSuite","value":"TestFilterStaticSharding"},{"name":"host","value":"fv-az1361-404"},{"name":"thread","value":"1920-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.sharding.test_filter"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"24214fddd817b7c5","status":"failed","statusDetails":"AssertionError: Peer NODE_2:wakuorg/go-waku:latest couldn't find any messages","time":{"start":1738120006044,"stop":1738120008763,"duration":2719}},{"uid":"f04a6f3cd2048533","status":"broken","statusDetails":"Exception: Error: 400 Client Error: Bad Request for url: http://127.0.0.1:52524/filter/v2/subscriptions with response: b'{\"requestId\":\"6ecfbfd3-e69c-493c-94d2-fe890bd327fe\",\"statusDesc\":\"subscription failed\"}'","time":{"start":1738120001914,"stop":1738120004525,"duration":2611}}],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":1,"skipped":0,"passed":71,"unknown":0,"total":72},"items":[{"uid":"a0a224834e2d9d2f","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/445//#testresult/a0a224834e2d9d2f","status":"passed","time":{"start":1738033439623,"stop":1738033442329,"duration":2706}},{"uid":"257a598527ee6db3","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/444//#testresult/257a598527ee6db3","status":"passed","time":{"start":1737947152919,"stop":1737947155626,"duration":2707}},{"uid":"71a52028394e140d","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/443//#testresult/71a52028394e140d","status":"passed","time":{"start":1737860712796,"stop":1737860715501,"duration":2705}},{"uid":"a6cde88db095ea29","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/442//#testresult/a6cde88db095ea29","status":"passed","time":{"start":1737774187122,"stop":1737774189839,"duration":2717}},{"uid":"18d270c7643f6c94","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/441//#testresult/18d270c7643f6c94","status":"passed","time":{"start":1737687877507,"stop":1737687880213,"duration":2706}},{"uid":"efce234f3276ecbc","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/440//#testresult/efce234f3276ecbc","status":"passed","time":{"start":1737601463232,"stop":1737601465925,"duration":2693}},{"uid":"36a7f9c3703b2e51","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/439//#testresult/36a7f9c3703b2e51","status":"passed","time":{"start":1737515147410,"stop":1737515150106,"duration":2696}},{"uid":"35ae1018a5d4630b","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/438//#testresult/35ae1018a5d4630b","status":"passed","time":{"start":1737428652784,"stop":1737428655477,"duration":2693}},{"uid":"3e4551f5b590dc68","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/437//#testresult/3e4551f5b590dc68","status":"passed","time":{"start":1737342351866,"stop":1737342354567,"duration":2701}},{"uid":"35e67014129caa7c","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/436//#testresult/35e67014129caa7c","status":"passed","time":{"start":1737256018010,"stop":1737256020714,"duration":2704}},{"uid":"aed5362b1b1be318","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/435//#testresult/aed5362b1b1be318","status":"passed","time":{"start":1737169447422,"stop":1737169450126,"duration":2704}},{"uid":"d952e830e639a29b","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/434//#testresult/d952e830e639a29b","status":"passed","time":{"start":1737083140164,"stop":1737083142887,"duration":2723}},{"uid":"edc29485bf31f334","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/433//#testresult/edc29485bf31f334","status":"passed","time":{"start":1736996655702,"stop":1736996658405,"duration":2703}},{"uid":"914fc7b920f78994","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/432//#testresult/914fc7b920f78994","status":"passed","time":{"start":1736910300394,"stop":1736910303088,"duration":2694}},{"uid":"69d7794bdda3a71c","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/431//#testresult/69d7794bdda3a71c","status":"passed","time":{"start":1736823843918,"stop":1736823846659,"duration":2741}},{"uid":"15b4f3059a9b7db6","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/430//#testresult/15b4f3059a9b7db6","status":"passed","time":{"start":1736737871193,"stop":1736737873904,"duration":2711}},{"uid":"e44bf3dfa1e2d196","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/429//#testresult/e44bf3dfa1e2d196","status":"passed","time":{"start":1736651521825,"stop":1736651524518,"duration":2693}},{"uid":"b4f554ee60a4d4ae","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/428//#testresult/b4f554ee60a4d4ae","status":"passed","time":{"start":1736564856217,"stop":1736564858937,"duration":2720}},{"uid":"6f5db0f151af57c9","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/427//#testresult/6f5db0f151af57c9","status":"passed","time":{"start":1736478570940,"stop":1736478573658,"duration":2718}},{"uid":"b0c7e85a972ab023","reportUrl":"https://waku-org.github.io/waku-interop-tests/go/426//#testresult/b0c7e85a972ab023","status":"passed","time":{"start":1736392798154,"stop":1736392800852,"duration":2698}}]},"tags":[]},"source":"14287cba5e9f9287.json","parameterValues":[]}